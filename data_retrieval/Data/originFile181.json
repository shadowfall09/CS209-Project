{"items":[{"tags":["java","android","android-camera2","android-camerax","textureview"],"comments":[{"owner":{"account_id":72095,"reputation":18817,"user_id":208273,"display_name":"Ryan M"},"score":1,"creation_date":1694740636,"post_id":77109113,"comment_id":135934459,"body_markdown":"Based on the original title, you&#39;re misreading the error. `previewView.getSurfaceTexture()` is returning null; not any attempt to find the View.  It&#39;s finding the TextureView successfully, so you need to instead figure out why `getSurfaceTexture()` is returning null (which I don&#39;t know the answer to, unfortunately, but hopefully that sets you in the right direction...).","body":"Based on the original title, you&#39;re misreading the error. <code>previewView.getSurfaceTexture()</code> is returning null; not any attempt to find the View.  It&#39;s finding the TextureView successfully, so you need to instead figure out why <code>getSurfaceTexture()</code> is returning null (which I don&#39;t know the answer to, unfortunately, but hopefully that sets you in the right direction...)."},{"owner":{"account_id":20366371,"reputation":55,"user_id":14939620,"display_name":"Matheus Fortunato Alves"},"score":0,"creation_date":1694776153,"post_id":77109113,"comment_id":135938934,"body_markdown":"Hey Ryan, thanks for clarification. You&#39;re right and actually Wang answer solved my problem of previewing the camera Image!","body":"Hey Ryan, thanks for clarification. You&#39;re right and actually Wang answer solved my problem of previewing the camera Image!"}],"answers":[{"tags":[],"owner":{"account_id":8299475,"reputation":151,"user_id":6238538,"display_name":"Wang Peiming"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1694745338,"creation_date":1694744082,"answer_id":77109267,"question_id":77109113,"body_markdown":"You should put `previewView.getSurfaceTexture()` into `onSurfaceTextureAvailable()` of `TextureView.SurfaceTextureListener`. \r\n\r\nFor example, replacing the original `onOpened(@NonNull CameraDevice cameraDevice)` with the following code can resolve it:\r\n\r\n```\r\n@Override\r\npublic void onOpened(@NonNull CameraDevice cameraDevice) {\r\n\tMainActivity.this.cameraDevice = cameraDevice;\r\n\tpreviewView.setSurfaceTextureListener(new TextureView.SurfaceTextureListener() {\r\n\t\t@Override\r\n\t\tpublic void onSurfaceTextureAvailable(@NonNull SurfaceTexture surface, int width, int height) {\r\n\t\t\tstartPreview();\r\n\t\t}\r\n\r\n\t\t@Override\r\n\t\tpublic void onSurfaceTextureSizeChanged(@NonNull SurfaceTexture surface, int width, int height) {\r\n\r\n\t\t}\r\n\r\n\t\t@Override\r\n\t\tpublic boolean onSurfaceTextureDestroyed(@NonNull SurfaceTexture surface) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t@Override\r\n\t\tpublic void onSurfaceTextureUpdated(@NonNull SurfaceTexture surface) {\r\n\r\n\t\t}\r\n\t});\r\n}\r\n```","title":"TextureView.getSurfaceTexture() returns null","body":"<p>You should put <code>previewView.getSurfaceTexture()</code> into <code>onSurfaceTextureAvailable()</code> of <code>TextureView.SurfaceTextureListener</code>.</p>\n<p>For example, replacing the original <code>onOpened(@NonNull CameraDevice cameraDevice)</code> with the following code can resolve it:</p>\n<pre><code>@Override\npublic void onOpened(@NonNull CameraDevice cameraDevice) {\n    MainActivity.this.cameraDevice = cameraDevice;\n    previewView.setSurfaceTextureListener(new TextureView.SurfaceTextureListener() {\n        @Override\n        public void onSurfaceTextureAvailable(@NonNull SurfaceTexture surface, int width, int height) {\n            startPreview();\n        }\n\n        @Override\n        public void onSurfaceTextureSizeChanged(@NonNull SurfaceTexture surface, int width, int height) {\n\n        }\n\n        @Override\n        public boolean onSurfaceTextureDestroyed(@NonNull SurfaceTexture surface) {\n            return false;\n        }\n\n        @Override\n        public void onSurfaceTextureUpdated(@NonNull SurfaceTexture surface) {\n\n        }\n    });\n}\n</code></pre>\n"}],"owner":{"account_id":20366371,"reputation":55,"user_id":14939620,"display_name":"Matheus Fortunato Alves"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":60,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77109267,"answer_count":1,"score":0,"last_activity_date":1694805625,"creation_date":1694740414,"question_id":77109113,"body_markdown":"I am trying to build a simple camera2 app to record videos and store on internal storage.\r\n\r\nSo on I have the following code: \r\n\r\n```\r\npackage com.example.newcameraapp;\r\n\r\nimport android.Manifest;\r\nimport android.annotation.SuppressLint;\r\nimport android.content.pm.PackageManager;\r\nimport android.graphics.SurfaceTexture;\r\nimport android.hardware.camera2.CameraAccessException;\r\nimport android.hardware.camera2.CameraCaptureSession;\r\nimport android.hardware.camera2.CameraCharacteristics;\r\nimport android.hardware.camera2.CameraDevice;\r\nimport android.hardware.camera2.CameraManager;\r\nimport android.hardware.camera2.CameraMetadata;\r\nimport android.hardware.camera2.CaptureRequest;\r\nimport android.hardware.camera2.TotalCaptureResult;\r\nimport android.media.MediaRecorder;\r\nimport android.os.Bundle;\r\nimport android.os.Environment;\r\nimport android.os.Handler;\r\nimport android.os.HandlerThread;\r\nimport android.util.Size;\r\nimport android.view.Surface;\r\nimport android.view.TextureView;\r\nimport android.view.View;\r\nimport android.widget.Button;\r\nimport android.widget.Toast;\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.app.ActivityCompat;\r\nimport androidx.core.content.ContextCompat;\r\n\r\nimport java.io.File;\r\nimport java.io.IOException;\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.ArrayList;\r\nimport java.util.Collections;\r\nimport java.util.Date;\r\nimport java.util.List;\r\nimport java.util.Locale;\r\n\r\npublic class MainActivity extends AppCompatActivity {\r\n\r\n    private static final int REQUEST_CAMERA_PERMISSION = 200;\r\n    private static final String[] REQUIRED_PERMISSIONS = {Manifest.permission.CAMERA, Manifest.permission.RECORD_AUDIO};\r\n\r\n    private CameraManager cameraManager;\r\n    private CameraDevice cameraDevice;\r\n    private Size videoSize;\r\n    private MediaRecorder mediaRecorder;\r\n    private CaptureRequest.Builder captureRequestBuilder;\r\n    private CameraCaptureSession cameraCaptureSession;\r\n    private String videoFilePath;\r\n    private boolean isRecording = false;\r\n\r\n    private HandlerThread backgroundThread;\r\n    private Handler backgroundHandler;\r\n\r\n    private TextureView previewView;\r\n\r\n    private static final int FIXED_FRAME_RATE = 30; // Fixed frame rate in frames per second\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_main);\r\n\r\n        previewView = findViewById(R.id.previewView);\r\n\r\n        Button recordButton = findViewById(R.id.recordButton);\r\n        recordButton.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                if (!isRecording) {\r\n                    startRecording();\r\n                } else {\r\n                    stopRecording();\r\n                }\r\n            }\r\n        });\r\n\r\n        if (allPermissionsGranted()) {\r\n            startCamera();\r\n        } else {\r\n            ActivityCompat.requestPermissions(this, REQUIRED_PERMISSIONS, REQUEST_CAMERA_PERMISSION);\r\n        }\r\n    }\r\n\r\n    @SuppressLint(&quot;MissingPermission&quot;)\r\n    private void startCamera() {\r\n        cameraManager = (CameraManager) getSystemService(CAMERA_SERVICE);\r\n        try {\r\n            String cameraId = cameraManager.getCameraIdList()[0]; // Use the first camera\r\n\r\n            CameraCharacteristics characteristics = cameraManager.getCameraCharacteristics(cameraId);\r\n            videoSize = chooseVideoSize(characteristics.get(CameraCharacteristics.SCALER_STREAM_CONFIGURATION_MAP).getOutputSizes(MediaRecorder.class));\r\n\r\n            cameraManager.openCamera(cameraId, new CameraDevice.StateCallback() {\r\n                @Override\r\n                public void onOpened(@NonNull CameraDevice cameraDevice) {\r\n                    MainActivity.this.cameraDevice = cameraDevice;\r\n                    startPreview();\r\n                }\r\n\r\n                @Override\r\n                public void onDisconnected(@NonNull CameraDevice cameraDevice) {\r\n                    cameraDevice.close();\r\n                    MainActivity.this.cameraDevice = null;\r\n                }\r\n\r\n                @Override\r\n                public void onError(@NonNull CameraDevice cameraDevice, int error) {\r\n                    cameraDevice.close();\r\n                    MainActivity.this.cameraDevice = null;\r\n                    // Handle camera error\r\n                }\r\n            }, null);\r\n\r\n        } catch (CameraAccessException e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n\r\n    private Size chooseVideoSize(Size[] choices) {\r\n        for (Size size : choices) {\r\n            if (size.getWidth() == 1920 &amp;&amp; size.getHeight() == 1080) {\r\n                return size;\r\n            }\r\n        }\r\n        return choices[choices.length - 1]; // Return the largest available size by default\r\n    }\r\n\r\n    private void startPreview() {\r\n        try {\r\n            closePreviewSession();\r\n            SurfaceTexture texture = previewView.getSurfaceTexture();\r\n            texture.setDefaultBufferSize(videoSize.getWidth(), videoSize.getHeight());\r\n            Surface previewSurface = new Surface(texture);\r\n\r\n            captureRequestBuilder = cameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_RECORD);\r\n            captureRequestBuilder.addTarget(previewSurface);\r\n\r\n            cameraDevice.createCaptureSession(Collections.singletonList(previewSurface), new CameraCaptureSession.StateCallback() {\r\n                @Override\r\n                public void onConfigured(@NonNull CameraCaptureSession session) {\r\n                    if (cameraDevice == null) {\r\n                        return;\r\n                    }\r\n\r\n                    cameraCaptureSession = session;\r\n                    updatePreview();\r\n                }\r\n\r\n                @Override\r\n                public void onConfigureFailed(@NonNull CameraCaptureSession session) {\r\n                    // Handle configuration failure\r\n                }\r\n            }, null);\r\n\r\n        } catch (CameraAccessException e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n\r\n    private void updatePreview() {\r\n        if (cameraDevice == null) {\r\n            return;\r\n        }\r\n\r\n        captureRequestBuilder.set(CaptureRequest.CONTROL_MODE, CameraMetadata.CONTROL_MODE_AUTO);\r\n\r\n        try {\r\n            cameraCaptureSession.setRepeatingRequest(captureRequestBuilder.build(), null, backgroundHandler);\r\n        } catch (CameraAccessException e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n\r\n    private void startRecording() {\r\n        if (cameraDevice == null || !previewView.isAvailable() || videoSize == null) {\r\n            return;\r\n        }\r\n\r\n        try {\r\n            closePreviewSession();\r\n            setUpMediaRecorder();\r\n\r\n            SurfaceTexture texture = previewView.getSurfaceTexture();\r\n            texture.setDefaultBufferSize(videoSize.getWidth(), videoSize.getHeight());\r\n            Surface previewSurface = new Surface(texture);\r\n\r\n            List&lt;Surface&gt; surfaces = new ArrayList&lt;&gt;();\r\n            surfaces.add(previewSurface);\r\n            surfaces.add(mediaRecorder.getSurface());\r\n\r\n            captureRequestBuilder = cameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_RECORD);\r\n            for (Surface surface : surfaces) {\r\n                captureRequestBuilder.addTarget(surface);\r\n            }\r\n\r\n            cameraDevice.createCaptureSession(surfaces, new CameraCaptureSession.StateCallback() {\r\n                @Override\r\n                public void onConfigured(@NonNull CameraCaptureSession session) {\r\n                    if (cameraDevice == null) {\r\n                        return;\r\n                    }\r\n\r\n                    cameraCaptureSession = session;\r\n                    updatePreview();\r\n\r\n                    runOnUiThread(new Runnable() {\r\n                        @Override\r\n                        public void run() {\r\n                            mediaRecorder.start();\r\n                            isRecording = true;\r\n                        }\r\n                    });\r\n                }\r\n\r\n                @Override\r\n                public void onConfigureFailed(@NonNull CameraCaptureSession session) {\r\n                    // Handle configuration failure\r\n                }\r\n            }, null);\r\n\r\n        } catch (CameraAccessException | IOException e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n\r\n    private void setUpMediaRecorder() throws IOException {\r\n        mediaRecorder = new MediaRecorder();\r\n        mediaRecorder.setVideoSource(MediaRecorder.VideoSource.SURFACE);\r\n        mediaRecorder.setAudioSource(MediaRecorder.AudioSource.MIC);\r\n        mediaRecorder.setOutputFormat(MediaRecorder.OutputFormat.MPEG_4);\r\n        mediaRecorder.setOutputFile(getOutputMediaFile());\r\n        mediaRecorder.setVideoEncodingBitRate(10000000); // Adjust as needed\r\n        mediaRecorder.setVideoFrameRate(FIXED_FRAME_RATE); // Set the fixed frame rate\r\n        mediaRecorder.setVideoSize(videoSize.getWidth(), videoSize.getHeight());\r\n        mediaRecorder.setVideoEncoder(MediaRecorder.VideoEncoder.H264);\r\n        mediaRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.AAC);\r\n        mediaRecorder.prepare();\r\n    }\r\n\r\n    private void closePreviewSession() {\r\n        if (cameraCaptureSession != null) {\r\n            cameraCaptureSession.close();\r\n            cameraCaptureSession = null;\r\n        }\r\n    }\r\n\r\n    private void stopRecording() {\r\n        if (isRecording) {\r\n            mediaRecorder.stop();\r\n            mediaRecorder.reset();\r\n            mediaRecorder.release();\r\n            mediaRecorder = null;\r\n            isRecording = false;\r\n            startPreview();\r\n        }\r\n    }\r\n\r\n    private String getOutputMediaFile() {\r\n        File mediaStorageDir = new File(Environment.getExternalStoragePublicDirectory(\r\n                Environment.DIRECTORY_DCIM), &quot;MyCameraApp&quot;);\r\n\r\n        if (!mediaStorageDir.exists()) {\r\n            if (!mediaStorageDir.mkdirs()) {\r\n                return null;\r\n            }\r\n        }\r\n\r\n        String timeStamp = new SimpleDateFormat(&quot;yyyyMMdd_HHmmss&quot;, Locale.getDefault()).format(new Date());\r\n        videoFilePath = mediaStorageDir.getPath() + File.separator + &quot;VID_&quot; + timeStamp + &quot;.mp4&quot;;\r\n        return videoFilePath;\r\n    }\r\n\r\n    private boolean allPermissionsGranted() {\r\n        for (String permission : REQUIRED_PERMISSIONS) {\r\n            if (ContextCompat.checkSelfPermission(this, permission) != PackageManager.PERMISSION_GRANTED) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n}\r\n ```\r\n\r\nlayout xml file: \r\n\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\r\n&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\r\n    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\r\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;\r\n    android:layout_width=&quot;match_parent&quot;\r\n    android:layout_height=&quot;match_parent&quot;\r\n    tools:context=&quot;.MainActivity&quot;&gt;\r\n\r\n    &lt;TextureView\r\n        android:id=&quot;@+id/previewView&quot;\r\n        android:layout_width=&quot;match_parent&quot;\r\n        android:layout_height=&quot;match_parent&quot;\r\n        /&gt;\r\n\r\n    &lt;Button\r\n        android:id=&quot;@+id/recordButton&quot;\r\n        android:layout_width=&quot;wrap_content&quot;\r\n        android:layout_height=&quot;wrap_content&quot;\r\n        android:text=&quot;Record&quot;\r\n        android:onClick=&quot;onClick&quot;\r\n        android:layout_alignParentBottom=&quot;true&quot;\r\n        android:layout_centerHorizontal=&quot;true&quot; /&gt;\r\n\r\n&lt;/RelativeLayout&gt;\r\n```\r\n\r\nAfter running the code (also checked all necessary permissions), following error occurs:\r\n```\r\nFATAL EXCEPTION: main\r\nProcess: com.example.newcameraapp, PID: 6357\r\njava.lang.NullPointerException: Attempt to invoke virtual method &#39;void android.graphics.SurfaceTexture.setDefaultBufferSize(int, int)&#39; on a null object reference\r\n    at com.example.newcameraapp.MainActivity.startPreview(MainActivity.java:136)\r\n    at com.example.newcameraapp.MainActivity.access$400(MainActivity.java:41)\r\n    at com.example.newcameraapp.MainActivity$2.onOpened(MainActivity.java:101)\r\n    at android.hardware.camera2.impl.CameraDeviceImpl$1.run(CameraDeviceImpl.java:151)\r\n    at android.os.Handler.handleCallback(Handler.java:938)\r\n    at android.os.Handler.dispatchMessage(Handler.java:99)\r\n    at android.os.Looper.loop(Looper.java:223)\r\n    at android.app.ActivityThread.main(ActivityThread.java:7656)\r\n    at java.lang.reflect.Method.invoke(Native Method)\r\n    at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:592)\r\n    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:947)\r\n```\r\n\r\nError is caused by ```texture.setDefaultBufferSize(videoSize.getWidth(), videoSize.getHeight());```\r\n\r\nMy layout xml seems correct and I called TextureView correctly too. \r\n\r\nCan someone help?\r\n\r\n\r\n\r\n\r\n","title":"TextureView.getSurfaceTexture() returns null","body":"<p>I am trying to build a simple camera2 app to record videos and store on internal storage.</p>\n<p>So on I have the following code:</p>\n<pre><code>package com.example.newcameraapp;\n\nimport android.Manifest;\nimport android.annotation.SuppressLint;\nimport android.content.pm.PackageManager;\nimport android.graphics.SurfaceTexture;\nimport android.hardware.camera2.CameraAccessException;\nimport android.hardware.camera2.CameraCaptureSession;\nimport android.hardware.camera2.CameraCharacteristics;\nimport android.hardware.camera2.CameraDevice;\nimport android.hardware.camera2.CameraManager;\nimport android.hardware.camera2.CameraMetadata;\nimport android.hardware.camera2.CaptureRequest;\nimport android.hardware.camera2.TotalCaptureResult;\nimport android.media.MediaRecorder;\nimport android.os.Bundle;\nimport android.os.Environment;\nimport android.os.Handler;\nimport android.os.HandlerThread;\nimport android.util.Size;\nimport android.view.Surface;\nimport android.view.TextureView;\nimport android.view.View;\nimport android.widget.Button;\nimport android.widget.Toast;\nimport androidx.annotation.NonNull;\nimport androidx.annotation.Nullable;\nimport androidx.appcompat.app.AppCompatActivity;\nimport androidx.core.app.ActivityCompat;\nimport androidx.core.content.ContextCompat;\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.text.SimpleDateFormat;\nimport java.util.ArrayList;\nimport java.util.Collections;\nimport java.util.Date;\nimport java.util.List;\nimport java.util.Locale;\n\npublic class MainActivity extends AppCompatActivity {\n\n    private static final int REQUEST_CAMERA_PERMISSION = 200;\n    private static final String[] REQUIRED_PERMISSIONS = {Manifest.permission.CAMERA, Manifest.permission.RECORD_AUDIO};\n\n    private CameraManager cameraManager;\n    private CameraDevice cameraDevice;\n    private Size videoSize;\n    private MediaRecorder mediaRecorder;\n    private CaptureRequest.Builder captureRequestBuilder;\n    private CameraCaptureSession cameraCaptureSession;\n    private String videoFilePath;\n    private boolean isRecording = false;\n\n    private HandlerThread backgroundThread;\n    private Handler backgroundHandler;\n\n    private TextureView previewView;\n\n    private static final int FIXED_FRAME_RATE = 30; // Fixed frame rate in frames per second\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n\n        previewView = findViewById(R.id.previewView);\n\n        Button recordButton = findViewById(R.id.recordButton);\n        recordButton.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View view) {\n                if (!isRecording) {\n                    startRecording();\n                } else {\n                    stopRecording();\n                }\n            }\n        });\n\n        if (allPermissionsGranted()) {\n            startCamera();\n        } else {\n            ActivityCompat.requestPermissions(this, REQUIRED_PERMISSIONS, REQUEST_CAMERA_PERMISSION);\n        }\n    }\n\n    @SuppressLint(&quot;MissingPermission&quot;)\n    private void startCamera() {\n        cameraManager = (CameraManager) getSystemService(CAMERA_SERVICE);\n        try {\n            String cameraId = cameraManager.getCameraIdList()[0]; // Use the first camera\n\n            CameraCharacteristics characteristics = cameraManager.getCameraCharacteristics(cameraId);\n            videoSize = chooseVideoSize(characteristics.get(CameraCharacteristics.SCALER_STREAM_CONFIGURATION_MAP).getOutputSizes(MediaRecorder.class));\n\n            cameraManager.openCamera(cameraId, new CameraDevice.StateCallback() {\n                @Override\n                public void onOpened(@NonNull CameraDevice cameraDevice) {\n                    MainActivity.this.cameraDevice = cameraDevice;\n                    startPreview();\n                }\n\n                @Override\n                public void onDisconnected(@NonNull CameraDevice cameraDevice) {\n                    cameraDevice.close();\n                    MainActivity.this.cameraDevice = null;\n                }\n\n                @Override\n                public void onError(@NonNull CameraDevice cameraDevice, int error) {\n                    cameraDevice.close();\n                    MainActivity.this.cameraDevice = null;\n                    // Handle camera error\n                }\n            }, null);\n\n        } catch (CameraAccessException e) {\n            e.printStackTrace();\n        }\n    }\n\n    private Size chooseVideoSize(Size[] choices) {\n        for (Size size : choices) {\n            if (size.getWidth() == 1920 &amp;&amp; size.getHeight() == 1080) {\n                return size;\n            }\n        }\n        return choices[choices.length - 1]; // Return the largest available size by default\n    }\n\n    private void startPreview() {\n        try {\n            closePreviewSession();\n            SurfaceTexture texture = previewView.getSurfaceTexture();\n            texture.setDefaultBufferSize(videoSize.getWidth(), videoSize.getHeight());\n            Surface previewSurface = new Surface(texture);\n\n            captureRequestBuilder = cameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_RECORD);\n            captureRequestBuilder.addTarget(previewSurface);\n\n            cameraDevice.createCaptureSession(Collections.singletonList(previewSurface), new CameraCaptureSession.StateCallback() {\n                @Override\n                public void onConfigured(@NonNull CameraCaptureSession session) {\n                    if (cameraDevice == null) {\n                        return;\n                    }\n\n                    cameraCaptureSession = session;\n                    updatePreview();\n                }\n\n                @Override\n                public void onConfigureFailed(@NonNull CameraCaptureSession session) {\n                    // Handle configuration failure\n                }\n            }, null);\n\n        } catch (CameraAccessException e) {\n            e.printStackTrace();\n        }\n    }\n\n    private void updatePreview() {\n        if (cameraDevice == null) {\n            return;\n        }\n\n        captureRequestBuilder.set(CaptureRequest.CONTROL_MODE, CameraMetadata.CONTROL_MODE_AUTO);\n\n        try {\n            cameraCaptureSession.setRepeatingRequest(captureRequestBuilder.build(), null, backgroundHandler);\n        } catch (CameraAccessException e) {\n            e.printStackTrace();\n        }\n    }\n\n    private void startRecording() {\n        if (cameraDevice == null || !previewView.isAvailable() || videoSize == null) {\n            return;\n        }\n\n        try {\n            closePreviewSession();\n            setUpMediaRecorder();\n\n            SurfaceTexture texture = previewView.getSurfaceTexture();\n            texture.setDefaultBufferSize(videoSize.getWidth(), videoSize.getHeight());\n            Surface previewSurface = new Surface(texture);\n\n            List&lt;Surface&gt; surfaces = new ArrayList&lt;&gt;();\n            surfaces.add(previewSurface);\n            surfaces.add(mediaRecorder.getSurface());\n\n            captureRequestBuilder = cameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_RECORD);\n            for (Surface surface : surfaces) {\n                captureRequestBuilder.addTarget(surface);\n            }\n\n            cameraDevice.createCaptureSession(surfaces, new CameraCaptureSession.StateCallback() {\n                @Override\n                public void onConfigured(@NonNull CameraCaptureSession session) {\n                    if (cameraDevice == null) {\n                        return;\n                    }\n\n                    cameraCaptureSession = session;\n                    updatePreview();\n\n                    runOnUiThread(new Runnable() {\n                        @Override\n                        public void run() {\n                            mediaRecorder.start();\n                            isRecording = true;\n                        }\n                    });\n                }\n\n                @Override\n                public void onConfigureFailed(@NonNull CameraCaptureSession session) {\n                    // Handle configuration failure\n                }\n            }, null);\n\n        } catch (CameraAccessException | IOException e) {\n            e.printStackTrace();\n        }\n    }\n\n    private void setUpMediaRecorder() throws IOException {\n        mediaRecorder = new MediaRecorder();\n        mediaRecorder.setVideoSource(MediaRecorder.VideoSource.SURFACE);\n        mediaRecorder.setAudioSource(MediaRecorder.AudioSource.MIC);\n        mediaRecorder.setOutputFormat(MediaRecorder.OutputFormat.MPEG_4);\n        mediaRecorder.setOutputFile(getOutputMediaFile());\n        mediaRecorder.setVideoEncodingBitRate(10000000); // Adjust as needed\n        mediaRecorder.setVideoFrameRate(FIXED_FRAME_RATE); // Set the fixed frame rate\n        mediaRecorder.setVideoSize(videoSize.getWidth(), videoSize.getHeight());\n        mediaRecorder.setVideoEncoder(MediaRecorder.VideoEncoder.H264);\n        mediaRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.AAC);\n        mediaRecorder.prepare();\n    }\n\n    private void closePreviewSession() {\n        if (cameraCaptureSession != null) {\n            cameraCaptureSession.close();\n            cameraCaptureSession = null;\n        }\n    }\n\n    private void stopRecording() {\n        if (isRecording) {\n            mediaRecorder.stop();\n            mediaRecorder.reset();\n            mediaRecorder.release();\n            mediaRecorder = null;\n            isRecording = false;\n            startPreview();\n        }\n    }\n\n    private String getOutputMediaFile() {\n        File mediaStorageDir = new File(Environment.getExternalStoragePublicDirectory(\n                Environment.DIRECTORY_DCIM), &quot;MyCameraApp&quot;);\n\n        if (!mediaStorageDir.exists()) {\n            if (!mediaStorageDir.mkdirs()) {\n                return null;\n            }\n        }\n\n        String timeStamp = new SimpleDateFormat(&quot;yyyyMMdd_HHmmss&quot;, Locale.getDefault()).format(new Date());\n        videoFilePath = mediaStorageDir.getPath() + File.separator + &quot;VID_&quot; + timeStamp + &quot;.mp4&quot;;\n        return videoFilePath;\n    }\n\n    private boolean allPermissionsGranted() {\n        for (String permission : REQUIRED_PERMISSIONS) {\n            if (ContextCompat.checkSelfPermission(this, permission) != PackageManager.PERMISSION_GRANTED) {\n                return false;\n            }\n        }\n        return true;\n    }\n}\n</code></pre>\n<p>layout xml file:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;match_parent&quot;\n    tools:context=&quot;.MainActivity&quot;&gt;\n\n    &lt;TextureView\n        android:id=&quot;@+id/previewView&quot;\n        android:layout_width=&quot;match_parent&quot;\n        android:layout_height=&quot;match_parent&quot;\n        /&gt;\n\n    &lt;Button\n        android:id=&quot;@+id/recordButton&quot;\n        android:layout_width=&quot;wrap_content&quot;\n        android:layout_height=&quot;wrap_content&quot;\n        android:text=&quot;Record&quot;\n        android:onClick=&quot;onClick&quot;\n        android:layout_alignParentBottom=&quot;true&quot;\n        android:layout_centerHorizontal=&quot;true&quot; /&gt;\n\n&lt;/RelativeLayout&gt;\n</code></pre>\n<p>After running the code (also checked all necessary permissions), following error occurs:</p>\n<pre><code>FATAL EXCEPTION: main\nProcess: com.example.newcameraapp, PID: 6357\njava.lang.NullPointerException: Attempt to invoke virtual method 'void android.graphics.SurfaceTexture.setDefaultBufferSize(int, int)' on a null object reference\n    at com.example.newcameraapp.MainActivity.startPreview(MainActivity.java:136)\n    at com.example.newcameraapp.MainActivity.access$400(MainActivity.java:41)\n    at com.example.newcameraapp.MainActivity$2.onOpened(MainActivity.java:101)\n    at android.hardware.camera2.impl.CameraDeviceImpl$1.run(CameraDeviceImpl.java:151)\n    at android.os.Handler.handleCallback(Handler.java:938)\n    at android.os.Handler.dispatchMessage(Handler.java:99)\n    at android.os.Looper.loop(Looper.java:223)\n    at android.app.ActivityThread.main(ActivityThread.java:7656)\n    at java.lang.reflect.Method.invoke(Native Method)\n    at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:592)\n    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:947)\n</code></pre>\n<p>Error is caused by <code>texture.setDefaultBufferSize(videoSize.getWidth(), videoSize.getHeight());</code></p>\n<p>My layout xml seems correct and I called TextureView correctly too.</p>\n<p>Can someone help?</p>\n"},{"tags":["java","android","drawerlayout","navigationview","ripple-effect"],"answers":[{"tags":[],"owner":{"account_id":16299235,"reputation":315,"user_id":11770758,"display_name":"Jaime Miranda Ramirez"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1694805611,"creation_date":1694805611,"answer_id":77114897,"question_id":77101577,"body_markdown":"After some more digging I was able to solve my problem by adding ```&lt;item name=&quot;colorControlHighlight&quot;&gt;@android:color/transparent&lt;/item&gt;``` in the ```themes.xml``` file. I also left the following parameters in the NavigationView in the xml:\r\n\r\n```\r\napp:itemBackground=&quot;@android:color/transparent&quot;\r\napp:itemRippleColor=&quot;@android:color/transparent&quot;\r\n```\r\nNow, there&#39;s no random ripple effect showing.","title":"Remove Ripple Effect from Drawer Layout Navigation View","body":"<p>After some more digging I was able to solve my problem by adding <code>&lt;item name=&quot;colorControlHighlight&quot;&gt;@android:color/transparent&lt;/item&gt;</code> in the <code>themes.xml</code> file. I also left the following parameters in the NavigationView in the xml:</p>\n<pre><code>app:itemBackground=&quot;@android:color/transparent&quot;\napp:itemRippleColor=&quot;@android:color/transparent&quot;\n</code></pre>\n<p>Now, there's no random ripple effect showing.</p>\n"}],"owner":{"account_id":16299235,"reputation":315,"user_id":11770758,"display_name":"Jaime Miranda Ramirez"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":44,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77114897,"answer_count":1,"score":0,"last_activity_date":1694805611,"creation_date":1694661460,"question_id":77101577,"body_markdown":"I&#39;m trying to remove [this](https://imgur.com/a/Zhqv1Dh) ripple effect from my Navigation View without any luck. I tried following the answers from [BottomNavigationView - Shadow and Ripple Effect](https://stackoverflow.com/questions/40316411/bottomnavigationview-shadow-and-ripple-effect) and [How to disable gray animation from center to edges on bottom navigation on tap](https://stackoverflow.com/questions/56157660/how-to-disable-gray-animation-from-center-to-edges-on-bottom-navigation-on-tap) question that I found on Stack and nothing worked for me. It&#39;s also a strange behavior that the ripple effect only happens sometimes, usually after 2 clicks on the Navigation Menu, this can be seen in the video.\r\n\r\nThis is my XML file:\r\n\r\n```\r\n&lt;androidx.drawerlayout.widget.DrawerLayout\r\n    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\r\n    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\r\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;\r\n    android:layout_width=&quot;match_parent&quot;\r\n    android:layout_height=&quot;match_parent&quot;\r\n    android:id=&quot;@+id/drawer_layout&quot;\r\n    tools:openDrawer=&quot;start&quot;\r\n    tools:context=&quot;.HomeActivity&quot;&gt;\r\n\r\n    &lt;com.google.android.material.navigation.NavigationView\r\n        android:layout_width=&quot;275dp&quot;\r\n        android:layout_height=&quot;match_parent&quot;\r\n        android:id=&quot;@+id/navigation_view&quot;\r\n        app:itemIconPadding=&quot;10dp&quot;\r\n        app:itemHorizontalPadding=&quot;20dp&quot;\r\n        android:layout_gravity=&quot;start&quot;\r\n        android:fontFamily=&quot;@font/exo&quot;\r\n        android:textStyle=&quot;bold&quot;\r\n        app:headerLayout=&quot;@layout/navigation_header&quot;\r\n        app:menu=&quot;@menu/navigation_menu&quot;\r\n        app:itemBackground=&quot;@android:color/transparent&quot;\r\n        app:itemRippleColor=&quot;@android:color/transparent&quot;\r\n        app:itemIconTint=&quot;@color/moroccan_blue&quot;\r\n        app:itemTextColor=&quot;@color/moroccan_blue&quot;\r\n        android:backgroundTint=&quot;@color/white&quot;\r\n        app:drawerLayoutCornerSize=&quot;20dp&quot;/&gt;\r\n\r\n&lt;/androidx.drawerlayout.widget.DrawerLayout&gt;\r\n```\r\n\r\nI tried adding ```app:itemBackground=&quot;@android:color/transparent&quot;``` and ```app:itemRippleColor=&quot;@android:color/transparent&quot;``` to solve this problem, but it didn&#39;t work. The former removed a gray ripple effect that it previously had and replaced it with the transparent ripple effect that was seen in the first 2 clicks of the Navigation Menu in the video. I already had the same behavior prior to adding those lines, the only difference was that the first 2 clicks were gray and the rest were the pink-ish color that appears in the video.","title":"Remove Ripple Effect from Drawer Layout Navigation View","body":"<p>I'm trying to remove <a href=\"https://imgur.com/a/Zhqv1Dh\" rel=\"nofollow noreferrer\">this</a> ripple effect from my Navigation View without any luck. I tried following the answers from <a href=\"https://stackoverflow.com/questions/40316411/bottomnavigationview-shadow-and-ripple-effect\">BottomNavigationView - Shadow and Ripple Effect</a> and <a href=\"https://stackoverflow.com/questions/56157660/how-to-disable-gray-animation-from-center-to-edges-on-bottom-navigation-on-tap\">How to disable gray animation from center to edges on bottom navigation on tap</a> question that I found on Stack and nothing worked for me. It's also a strange behavior that the ripple effect only happens sometimes, usually after 2 clicks on the Navigation Menu, this can be seen in the video.</p>\n<p>This is my XML file:</p>\n<pre><code>&lt;androidx.drawerlayout.widget.DrawerLayout\n    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;match_parent&quot;\n    android:id=&quot;@+id/drawer_layout&quot;\n    tools:openDrawer=&quot;start&quot;\n    tools:context=&quot;.HomeActivity&quot;&gt;\n\n    &lt;com.google.android.material.navigation.NavigationView\n        android:layout_width=&quot;275dp&quot;\n        android:layout_height=&quot;match_parent&quot;\n        android:id=&quot;@+id/navigation_view&quot;\n        app:itemIconPadding=&quot;10dp&quot;\n        app:itemHorizontalPadding=&quot;20dp&quot;\n        android:layout_gravity=&quot;start&quot;\n        android:fontFamily=&quot;@font/exo&quot;\n        android:textStyle=&quot;bold&quot;\n        app:headerLayout=&quot;@layout/navigation_header&quot;\n        app:menu=&quot;@menu/navigation_menu&quot;\n        app:itemBackground=&quot;@android:color/transparent&quot;\n        app:itemRippleColor=&quot;@android:color/transparent&quot;\n        app:itemIconTint=&quot;@color/moroccan_blue&quot;\n        app:itemTextColor=&quot;@color/moroccan_blue&quot;\n        android:backgroundTint=&quot;@color/white&quot;\n        app:drawerLayoutCornerSize=&quot;20dp&quot;/&gt;\n\n&lt;/androidx.drawerlayout.widget.DrawerLayout&gt;\n</code></pre>\n<p>I tried adding <code>app:itemBackground=&quot;@android:color/transparent&quot;</code> and <code>app:itemRippleColor=&quot;@android:color/transparent&quot;</code> to solve this problem, but it didn't work. The former removed a gray ripple effect that it previously had and replaced it with the transparent ripple effect that was seen in the first 2 clicks of the Navigation Menu in the video. I already had the same behavior prior to adding those lines, the only difference was that the first 2 clicks were gray and the rest were the pink-ish color that appears in the video.</p>\n"},{"tags":["java","inputstream","outputstream"],"comments":[{"owner":{"account_id":101585,"reputation":107721,"user_id":273200,"accept_rate":100,"display_name":"Bala R"},"score":5,"creation_date":1303737294,"post_id":5778658,"comment_id":6621551,"body_markdown":"See http://stackoverflow.com/questions/1225909/most-efficient-way-to-create-inputstream-from-outputstream","body":"See <a href=\"http://stackoverflow.com/questions/1225909/most-efficient-way-to-create-inputstream-from-outputstream\" title=\"most efficient way to create inputstream from outputstream\">stackoverflow.com/questions/1225909/&hellip;</a>"},{"owner":{"account_id":35502,"reputation":28362,"user_id":100565,"accept_rate":59,"display_name":"MeBigFatGuy"},"score":3,"creation_date":1303737430,"post_id":5778658,"comment_id":6621581,"body_markdown":"@c0mrade, the op wants something like IOUtils.copy, only in the other direction. When someone writes into an OutputStream, it becomes available for someone else to use in an InputStream. This is basically what PipedOutputStream/PipedInputStream do. Unfortunately the Piped streams can&#39;t be built from other streams.","body":"@c0mrade, the op wants something like IOUtils.copy, only in the other direction. When someone writes into an OutputStream, it becomes available for someone else to use in an InputStream. This is basically what PipedOutputStream/PipedInputStream do. Unfortunately the Piped streams can&#39;t be built from other streams."},{"owner":{"account_id":242438,"reputation":17413,"user_id":513956,"accept_rate":77,"display_name":"Waypoint"},"score":0,"creation_date":1303737546,"post_id":5778658,"comment_id":6621600,"body_markdown":"so the PipedOutputStream/PipedInputStream is the solution?","body":"so the PipedOutputStream/PipedInputStream is the solution?"},{"owner":{"account_id":35502,"reputation":28362,"user_id":100565,"accept_rate":59,"display_name":"MeBigFatGuy"},"score":0,"creation_date":1303738815,"post_id":5778658,"comment_id":6621844,"body_markdown":"Basically in order for PipedStreams to work in your case, your OutputStream would need to be constructed like `new YourOutputStream(thePipedOutputStream)` and `new YourInputStream(thePipedInputStream)` which probably is not the way your stream works. So I don&#39;t think this is the solution.","body":"Basically in order for PipedStreams to work in your case, your OutputStream would need to be constructed like <code>new YourOutputStream(thePipedOutputStream)</code> and <code>new YourInputStream(thePipedInputStream)</code> which probably is not the way your stream works. So I don&#39;t think this is the solution."}],"answers":[{"tags":[],"owner":{"account_id":152811,"reputation":3137,"user_id":367591,"accept_rate":62,"display_name":"Java Drinker"},"down_vote_count":25,"up_vote_count":145,"is_accepted":true,"score":120,"last_activity_date":1522267215,"creation_date":1303738611,"answer_id":5778863,"question_id":5778658,"body_markdown":"An `OutputStream` is one where you write data to. If some module exposes an `OutputStream`, the expectation is that there is something reading at the other end.\r\n\r\nSomething that exposes an `InputStream`, on the other hand, is indicating that you will need to listen to this stream, and there will be data that you can read. \r\n\r\nSo it is possible to connect an `InputStream` to an `OutputStream`\r\n\r\n`InputStream----read---&gt; intermediateBytes[n] ----write----&gt; OutputStream`\r\n\r\nAs someone metioned, this is what the `copy()` method from [IOUtils][1] lets you do. It does not make sense to go the other way... hopefully this makes some sense\r\n\r\n**UPDATE:**\r\n\r\nOf course the more I think of this, the more I can see how this actually would be a requirement. I know some of the comments mentioned `Piped` input/ouput streams, but there is another possibility.\r\n\r\nIf the output stream that is exposed is a `ByteArrayOutputStream`, then you can always get the full contents by calling the `toByteArray()` method. Then you can create an input stream wrapper by using the `ByteArrayInputStream` sub-class. These two are pseudo-streams, they both basically just wrap an array of bytes. Using the streams this way, therefore, is technically possible, but to me it is still very strange...\r\n\r\n\r\n  [1]: http://commons.apache.org/proper/commons-io/javadocs/api-2.5/org/apache/commons/io/IOUtils.html","title":"How do I convert an OutputStream to an InputStream?","body":"<p>An <code>OutputStream</code> is one where you write data to. If some module exposes an <code>OutputStream</code>, the expectation is that there is something reading at the other end.</p>\n\n<p>Something that exposes an <code>InputStream</code>, on the other hand, is indicating that you will need to listen to this stream, and there will be data that you can read. </p>\n\n<p>So it is possible to connect an <code>InputStream</code> to an <code>OutputStream</code></p>\n\n<p><code>InputStream----read---&gt; intermediateBytes[n] ----write----&gt; OutputStream</code></p>\n\n<p>As someone metioned, this is what the <code>copy()</code> method from <a href=\"http://commons.apache.org/proper/commons-io/javadocs/api-2.5/org/apache/commons/io/IOUtils.html\" rel=\"noreferrer\">IOUtils</a> lets you do. It does not make sense to go the other way... hopefully this makes some sense</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Of course the more I think of this, the more I can see how this actually would be a requirement. I know some of the comments mentioned <code>Piped</code> input/ouput streams, but there is another possibility.</p>\n\n<p>If the output stream that is exposed is a <code>ByteArrayOutputStream</code>, then you can always get the full contents by calling the <code>toByteArray()</code> method. Then you can create an input stream wrapper by using the <code>ByteArrayInputStream</code> sub-class. These two are pseudo-streams, they both basically just wrap an array of bytes. Using the streams this way, therefore, is technically possible, but to me it is still very strange...</p>\n"},{"tags":[],"owner":{"account_id":18732,"reputation":17409,"user_id":43217,"accept_rate":82,"display_name":"mckamey"},"down_vote_count":2,"up_vote_count":21,"is_accepted":false,"score":19,"last_activity_date":1442573240,"creation_date":1338058380,"answer_id":10768914,"question_id":5778658,"body_markdown":"You will need an intermediate class which will buffer between. Each time `InputStream.read(byte[]...)` is called, the buffering class will fill the passed in byte array with the next chunk passed in from `OutputStream.write(byte[]...)`. Since the sizes of the chunks may not be the same, the adapter class will need to store a certain amount until it has enough to fill the read buffer and/or be able to store up any buffer overflow.\r\n\r\nThis article has a nice breakdown of a few different approaches to this problem:\r\n\r\nhttp://blog.ostermiller.org/convert-java-outputstream-inputstream\r\n","title":"How do I convert an OutputStream to an InputStream?","body":"<p>You will need an intermediate class which will buffer between. Each time <code>InputStream.read(byte[]...)</code> is called, the buffering class will fill the passed in byte array with the next chunk passed in from <code>OutputStream.write(byte[]...)</code>. Since the sizes of the chunks may not be the same, the adapter class will need to store a certain amount until it has enough to fill the read buffer and/or be able to store up any buffer overflow.</p>\n\n<p>This article has a nice breakdown of a few different approaches to this problem:</p>\n\n<p><a href=\"http://blog.ostermiller.org/convert-java-outputstream-inputstream\" rel=\"noreferrer\">http://blog.ostermiller.org/convert-java-outputstream-inputstream</a></p>\n"},{"tags":[],"owner":{"account_id":467725,"reputation":19389,"user_id":873282,"accept_rate":55,"display_name":"koppor"},"down_vote_count":2,"up_vote_count":21,"is_accepted":false,"score":19,"last_activity_date":1597640272,"creation_date":1370560755,"answer_id":16973800,"question_id":5778658,"body_markdown":"The [easystream](http://io-tools.sourceforge.net/easystream/index.html) open source library has direct support to convert an OutputStream to an InputStream: http://io-tools.sourceforge.net/easystream/tutorial/tutorial.html\r\n\r\n```java\r\n// create conversion\r\nfinal OutputStreamToInputStream&lt;Void&gt; out = new OutputStreamToInputStream&lt;Void&gt;() {\r\n    @Override\r\n    protected Void doRead(final InputStream in) throws Exception {\r\n           LibraryClass2.processDataFromInputStream(in);\r\n           return null;\r\n        }\r\n    };\r\ntry {   \r\n     LibraryClass1.writeDataToTheOutputStream(out);\r\n} finally {\r\n     // don&#39;t miss the close (or a thread would not terminate correctly).\r\n     out.close();\r\n}\r\n```\r\n\r\nThey also list other options: http://io-tools.sourceforge.net/easystream/outputstream_to_inputstream/implementations.html\r\n\r\n* Write the data the data into a memory buffer (ByteArrayOutputStream) get the byteArray and read it again with a ByteArrayInputStream. This is the best approach if you&#39;re sure your data fits into memory.\r\n* Copy your data to a temporary file and read it back.\r\n* Use pipes: this is the best approach both for memory usage and speed (you can take full advantage of the multi-core processors) and also the standard solution offered by Sun.\r\n* Use InputStreamFromOutputStream and OutputStreamToInputStream from the easystream library.","title":"How do I convert an OutputStream to an InputStream?","body":"<p>The <a href=\"http://io-tools.sourceforge.net/easystream/index.html\" rel=\"nofollow noreferrer\">easystream</a> open source library has direct support to convert an OutputStream to an InputStream: <a href=\"http://io-tools.sourceforge.net/easystream/tutorial/tutorial.html\" rel=\"nofollow noreferrer\">http://io-tools.sourceforge.net/easystream/tutorial/tutorial.html</a></p>\n<pre class=\"lang-java prettyprint-override\"><code>// create conversion\nfinal OutputStreamToInputStream&lt;Void&gt; out = new OutputStreamToInputStream&lt;Void&gt;() {\n    @Override\n    protected Void doRead(final InputStream in) throws Exception {\n           LibraryClass2.processDataFromInputStream(in);\n           return null;\n        }\n    };\ntry {   \n     LibraryClass1.writeDataToTheOutputStream(out);\n} finally {\n     // don't miss the close (or a thread would not terminate correctly).\n     out.close();\n}\n</code></pre>\n<p>They also list other options: <a href=\"http://io-tools.sourceforge.net/easystream/outputstream_to_inputstream/implementations.html\" rel=\"nofollow noreferrer\">http://io-tools.sourceforge.net/easystream/outputstream_to_inputstream/implementations.html</a></p>\n<ul>\n<li>Write the data the data into a memory buffer (ByteArrayOutputStream) get the byteArray and read it again with a ByteArrayInputStream. This is the best approach if you're sure your data fits into memory.</li>\n<li>Copy your data to a temporary file and read it back.</li>\n<li>Use pipes: this is the best approach both for memory usage and speed (you can take full advantage of the multi-core processors) and also the standard solution offered by Sun.</li>\n<li>Use InputStreamFromOutputStream and OutputStreamToInputStream from the easystream library.</li>\n</ul>\n"},{"tags":[],"owner":{"account_id":1587590,"reputation":3668,"user_id":1471588,"display_name":"Michael Wyraz"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1381524511,"creation_date":1381524511,"answer_id":19326998,"question_id":5778658,"body_markdown":"If you want to make an OutputStream from an InputStream there is one basic problem. A method writing to an OutputStream blocks until it is done. So the result is available when the writing method is finished. This has 2 consequences:\r\n\r\n1. If you use only one thread, you need to wait until everything is written (so you need to store the stream&#39;s data in memory or disk).\r\n2. If you want to access the data before it is finished, you need a second thread.\r\n\r\n\r\nVariant 1 can be implemented using byte arrays or filed.\r\nVariant 1 can be implemented using pipies (either directly or with extra abstraction - e.g. RingBuffer or the google lib from the other comment).\r\n\r\nIndeed with standard java there is no other way to solve the problem. Each solution is an implementataion of one of these.\r\n\r\nThere is one concept called &quot;continuation&quot; (see [wikipedia][1] for details). In this case basically this means:\r\n\r\n- there is a special output stream that expects a certain amount of data\r\n- if the ammount is reached, the stream gives control to it&#39;s counterpart which is a special input stream\r\n- the input stream makes the amount of data available until it is read, after that, it passes back the control to the output stream\r\n\r\nWhile some languages have this concept built in, for java you need some &quot;magic&quot;. For example &quot;commons-javaflow&quot; from apache implements such for java. The disadvantage is that this requires some special bytecode modifications at build time. So it would make sense to put all the stuff in an extra library whith custom build scripts.\r\n\r\n\r\n  [1]: http://en.wikipedia.org/wiki/Continuation","title":"How do I convert an OutputStream to an InputStream?","body":"<p>If you want to make an OutputStream from an InputStream there is one basic problem. A method writing to an OutputStream blocks until it is done. So the result is available when the writing method is finished. This has 2 consequences:</p>\n\n<ol>\n<li>If you use only one thread, you need to wait until everything is written (so you need to store the stream's data in memory or disk).</li>\n<li>If you want to access the data before it is finished, you need a second thread.</li>\n</ol>\n\n<p>Variant 1 can be implemented using byte arrays or filed.\nVariant 1 can be implemented using pipies (either directly or with extra abstraction - e.g. RingBuffer or the google lib from the other comment).</p>\n\n<p>Indeed with standard java there is no other way to solve the problem. Each solution is an implementataion of one of these.</p>\n\n<p>There is one concept called \"continuation\" (see <a href=\"http://en.wikipedia.org/wiki/Continuation\" rel=\"nofollow\">wikipedia</a> for details). In this case basically this means:</p>\n\n<ul>\n<li>there is a special output stream that expects a certain amount of data</li>\n<li>if the ammount is reached, the stream gives control to it's counterpart which is a special input stream</li>\n<li>the input stream makes the amount of data available until it is read, after that, it passes back the control to the output stream</li>\n</ul>\n\n<p>While some languages have this concept built in, for java you need some \"magic\". For example \"commons-javaflow\" from apache implements such for java. The disadvantage is that this requires some special bytecode modifications at build time. So it would make sense to put all the stuff in an extra library whith custom build scripts.</p>\n"},{"tags":[],"owner":{"account_id":3209691,"reputation":3,"user_id":2709915,"display_name":"Manu"},"down_vote_count":4,"up_vote_count":1,"is_accepted":false,"score":-3,"last_activity_date":1694805601,"creation_date":1381827662,"answer_id":19377148,"question_id":5778658,"body_markdown":"Updated post:\r\n\r\nEssentially these are the basic 3 steps what we have to do:\r\n\r\n        // Sample data\r\n        String data = &quot;Foo! Bar!!&quot;;\r\n\r\n        // 1. Write the data to a ByteArrayOutputStream\r\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\r\n        try (OutputStream os = baos) {\r\n            os.write(data.getBytes());\r\n        }\r\n\r\n        // 2. Convert the ByteArrayOutputStream to a byte array\r\n        byte[] bytes = baos.toByteArray();\r\n\r\n        // 3. Use the byte array to create a ByteArrayInputStream\r\n        try (InputStream is = new ByteArrayInputStream(bytes)) {\r\n            int byteRead;\r\n            while ((byteRead = is.read()) != -1) {\r\n                System.out.print((char) byteRead);\r\n            }\r\n        }\r\n\r\nNOTE: This approach is simple and effective for in-memory operations. However, be cautious about memory consumption if you&#39;re dealing with large amounts of data, since the entire data will be kept in memory twice (once in the ByteArrayOutputStream and once in the byte array). If you&#39;re handling large streams, you might want to consider using a temporary file or another mechanism that doesn&#39;t rely on keeping everything in memory.","title":"How do I convert an OutputStream to an InputStream?","body":"<p>Updated post:</p>\n<p>Essentially these are the basic 3 steps what we have to do:</p>\n<pre><code>    // Sample data\n    String data = &quot;Foo! Bar!!&quot;;\n\n    // 1. Write the data to a ByteArrayOutputStream\n    ByteArrayOutputStream baos = new ByteArrayOutputStream();\n    try (OutputStream os = baos) {\n        os.write(data.getBytes());\n    }\n\n    // 2. Convert the ByteArrayOutputStream to a byte array\n    byte[] bytes = baos.toByteArray();\n\n    // 3. Use the byte array to create a ByteArrayInputStream\n    try (InputStream is = new ByteArrayInputStream(bytes)) {\n        int byteRead;\n        while ((byteRead = is.read()) != -1) {\n            System.out.print((char) byteRead);\n        }\n    }\n</code></pre>\n<p>NOTE: This approach is simple and effective for in-memory operations. However, be cautious about memory consumption if you're dealing with large amounts of data, since the entire data will be kept in memory twice (once in the ByteArrayOutputStream and once in the byte array). If you're handling large streams, you might want to consider using a temporary file or another mechanism that doesn't rely on keeping everything in memory.</p>\n"},{"tags":[],"owner":{"account_id":3714183,"reputation":503,"user_id":3090788,"display_name":"BorutT"},"down_vote_count":4,"up_vote_count":50,"is_accepted":false,"score":46,"last_activity_date":1459759221,"creation_date":1399538155,"answer_id":23536722,"question_id":5778658,"body_markdown":"As input and output streams are just start and end point, the solution is to temporary store data in byte array. So you must create intermediate `ByteArrayOutputStream`, from which you create `byte[]` that is used as input for new `ByteArrayInputStream`. \r\n\r\n    public void doTwoThingsWithStream(InputStream inStream, OutputStream outStream){ \r\n      //create temporary bayte array output stream\r\n      ByteArrayOutputStream baos = new ByteArrayOutputStream();\r\n      doFirstThing(inStream, baos);\r\n      //create input stream from baos\r\n      InputStream isFromFirstData = new ByteArrayInputStream(baos.toByteArray()); \r\n      doSecondThing(isFromFirstData, outStream);\r\n    }\r\n\r\nHope it helps.","title":"How do I convert an OutputStream to an InputStream?","body":"<p>As input and output streams are just start and end point, the solution is to temporary store data in byte array. So you must create intermediate <code>ByteArrayOutputStream</code>, from which you create <code>byte[]</code> that is used as input for new <code>ByteArrayInputStream</code>. </p>\n\n<pre><code>public void doTwoThingsWithStream(InputStream inStream, OutputStream outStream){ \n  //create temporary bayte array output stream\n  ByteArrayOutputStream baos = new ByteArrayOutputStream();\n  doFirstThing(inStream, baos);\n  //create input stream from baos\n  InputStream isFromFirstData = new ByteArrayInputStream(baos.toByteArray()); \n  doSecondThing(isFromFirstData, outStream);\n}\n</code></pre>\n\n<p>Hope it helps.</p>\n"},{"tags":[],"owner":{"account_id":1922510,"reputation":6870,"user_id":1733644,"display_name":"mikeho"},"down_vote_count":0,"up_vote_count":285,"is_accepted":false,"score":285,"last_activity_date":1671775519,"creation_date":1401121241,"answer_id":23874232,"question_id":5778658,"body_markdown":"There seem to be many links and other such stuff, but no actual code using pipes. The advantage of using [`java.io.PipedInputStream`][1] and [`java.io.PipedOutputStream`][2] is that there is no additional consumption of memory. `ByteArrayOutputStream.toByteArray()` returns a copy of the original buffer, so that means that whatever you have in memory, you now have two copies of it. Then writing to an `InputStream` means you now have three copies of the data.\r\n\r\nThe code using `lambdas` (hat-tip to @John Manko from the comments):\r\n```\r\nPipedInputStream in = new PipedInputStream();\r\nfinal PipedOutputStream out = new PipedOutputStream(in);\r\n// in a background thread, write the given output stream to the\r\n// PipedOutputStream for consumption\r\nnew Thread(() -&gt; {originalOutputStream.writeTo(out);}).start();\r\n```\r\n\r\nOne thing that @John Manko noted is that in certain cases, when you don&#39;t have control of the creation of the _OutputStream_, you may end up in a situation where the creator may clean up the _OutputStream_ object prematurely. If you are getting the `ClosedPipeException`, then you should try inverting the constructors:\r\n```\r\nPipedInputStream in = new PipedInputStream(out);\r\nnew Thread(() -&gt; {originalOutputStream.writeTo(out);}).start();\r\n```\r\nNote you can invert the constructors for the examples below too.\r\n\r\nThanks also to @AlexK for correcting me with starting a `Thread` instead of just kicking off a `Runnable`.\r\n\r\n---------------------\r\n\r\nThe code using `try-with-resources`:\r\n```\r\n// take the copy of the stream and re-write it to an InputStream\r\nPipedInputStream in = new PipedInputStream();\r\n    new Thread(new Runnable() {\r\n        public void run () {\r\n            // try-with-resources here\r\n            // putting the try block outside the Thread will cause the\r\n            // PipedOutputStream resource to close before the Runnable finishes\r\n            try (final PipedOutputStream out = new PipedOutputStream(in)) {\r\n                // write the original OutputStream to the PipedOutputStream\r\n                // note that in order for the below method to work, you need\r\n                // to ensure that the data has finished writing to the\r\n                // ByteArrayOutputStream\r\n                originalByteArrayOutputStream.writeTo(out);\r\n            }\r\n            catch (IOException e) {\r\n                // logging and exception handling should go here\r\n            }\r\n        }\r\n    }).start();\r\n```\r\n\r\n--------------------------\r\n\r\nThe original code I wrote:\r\n\r\n    // take the copy of the stream and re-write it to an InputStream\r\n    PipedInputStream in = new PipedInputStream();\r\n    final PipedOutputStream out = new PipedOutputStream(in);\r\n    new Thread(new Runnable() {\r\n        public void run () {\r\n            try {\r\n                // write the original OutputStream to the PipedOutputStream\r\n                // note that in order for the below method to work, you need\r\n                // to ensure that the data has finished writing to the\r\n                // ByteArrayOutputStream\r\n                originalByteArrayOutputStream.writeTo(out);\r\n            }\r\n            catch (IOException e) {\r\n                // logging and exception handling should go here\r\n            }\r\n            finally {\r\n                // close the PipedOutputStream here because we&#39;re done writing data\r\n                // once this thread has completed its run\r\n                if (out != null) {\r\n                    // close the PipedOutputStream cleanly\r\n                    out.close();\r\n                }\r\n            }   \r\n        }\r\n    }).start();\r\n\r\nThis code assumes that the `originalByteArrayOutputStream ` is a `ByteArrayOutputStream` as it is usually the only usable output stream, unless you&#39;re writing to a file. The great thing about this is that since it&#39;s in a separate thread, it also is working in parallel, so whatever is consuming your input stream will be streaming out of your old output stream too. That is beneficial because the buffer can remain smaller and you&#39;ll have less latency and less memory usage.\r\n\r\nIf you don&#39;t have a `ByteArrayOutputStream`, then instead of using `writeTo()`, you will have to use one of the `write()` methods in the `java.io.OutputStream` class or one of the other methods available in a subclass.\r\n\r\n  [1]: https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/PipedInputStream.html\r\n  [2]: https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/PipedOutputStream.html","title":"How do I convert an OutputStream to an InputStream?","body":"<p>There seem to be many links and other such stuff, but no actual code using pipes. The advantage of using <a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/PipedInputStream.html\" rel=\"noreferrer\"><code>java.io.PipedInputStream</code></a> and <a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/PipedOutputStream.html\" rel=\"noreferrer\"><code>java.io.PipedOutputStream</code></a> is that there is no additional consumption of memory. <code>ByteArrayOutputStream.toByteArray()</code> returns a copy of the original buffer, so that means that whatever you have in memory, you now have two copies of it. Then writing to an <code>InputStream</code> means you now have three copies of the data.</p>\n<p>The code using <code>lambdas</code> (hat-tip to @John Manko from the comments):</p>\n<pre><code>PipedInputStream in = new PipedInputStream();\nfinal PipedOutputStream out = new PipedOutputStream(in);\n// in a background thread, write the given output stream to the\n// PipedOutputStream for consumption\nnew Thread(() -&gt; {originalOutputStream.writeTo(out);}).start();\n</code></pre>\n<p>One thing that @John Manko noted is that in certain cases, when you don't have control of the creation of the <em>OutputStream</em>, you may end up in a situation where the creator may clean up the <em>OutputStream</em> object prematurely. If you are getting the <code>ClosedPipeException</code>, then you should try inverting the constructors:</p>\n<pre><code>PipedInputStream in = new PipedInputStream(out);\nnew Thread(() -&gt; {originalOutputStream.writeTo(out);}).start();\n</code></pre>\n<p>Note you can invert the constructors for the examples below too.</p>\n<p>Thanks also to @AlexK for correcting me with starting a <code>Thread</code> instead of just kicking off a <code>Runnable</code>.</p>\n<hr />\n<p>The code using <code>try-with-resources</code>:</p>\n<pre><code>// take the copy of the stream and re-write it to an InputStream\nPipedInputStream in = new PipedInputStream();\n    new Thread(new Runnable() {\n        public void run () {\n            // try-with-resources here\n            // putting the try block outside the Thread will cause the\n            // PipedOutputStream resource to close before the Runnable finishes\n            try (final PipedOutputStream out = new PipedOutputStream(in)) {\n                // write the original OutputStream to the PipedOutputStream\n                // note that in order for the below method to work, you need\n                // to ensure that the data has finished writing to the\n                // ByteArrayOutputStream\n                originalByteArrayOutputStream.writeTo(out);\n            }\n            catch (IOException e) {\n                // logging and exception handling should go here\n            }\n        }\n    }).start();\n</code></pre>\n<hr />\n<p>The original code I wrote:</p>\n<pre><code>// take the copy of the stream and re-write it to an InputStream\nPipedInputStream in = new PipedInputStream();\nfinal PipedOutputStream out = new PipedOutputStream(in);\nnew Thread(new Runnable() {\n    public void run () {\n        try {\n            // write the original OutputStream to the PipedOutputStream\n            // note that in order for the below method to work, you need\n            // to ensure that the data has finished writing to the\n            // ByteArrayOutputStream\n            originalByteArrayOutputStream.writeTo(out);\n        }\n        catch (IOException e) {\n            // logging and exception handling should go here\n        }\n        finally {\n            // close the PipedOutputStream here because we're done writing data\n            // once this thread has completed its run\n            if (out != null) {\n                // close the PipedOutputStream cleanly\n                out.close();\n            }\n        }   \n    }\n}).start();\n</code></pre>\n<p>This code assumes that the <code>originalByteArrayOutputStream </code> is a <code>ByteArrayOutputStream</code> as it is usually the only usable output stream, unless you're writing to a file. The great thing about this is that since it's in a separate thread, it also is working in parallel, so whatever is consuming your input stream will be streaming out of your old output stream too. That is beneficial because the buffer can remain smaller and you'll have less latency and less memory usage.</p>\n<p>If you don't have a <code>ByteArrayOutputStream</code>, then instead of using <code>writeTo()</code>, you will have to use one of the <code>write()</code> methods in the <code>java.io.OutputStream</code> class or one of the other methods available in a subclass.</p>\n"},{"tags":[],"owner":{"account_id":197685,"reputation":4628,"user_id":441907,"accept_rate":100,"display_name":"Nick Russler"},"down_vote_count":2,"up_vote_count":16,"is_accepted":false,"score":14,"last_activity_date":1467986488,"creation_date":1409860670,"answer_id":25673997,"question_id":5778658,"body_markdown":"I encountered the same problem with converting a `ByteArrayOutputStream` to a `ByteArrayInputStream` and solved it by using a derived class from `ByteArrayOutputStream` which is able to return a `ByteArrayInputStream` that is initialized with the internal buffer of the `ByteArrayOutputStream`. This way no additional memory is used and the &#39;conversion&#39; is very fast:\r\n\r\n    package info.whitebyte.utils;\r\n    import java.io.ByteArrayInputStream;\r\n    import java.io.ByteArrayOutputStream;\r\n    \r\n    /**\r\n     * This class extends the ByteArrayOutputStream by \r\n     * providing a method that returns a new ByteArrayInputStream\r\n     * which uses the internal byte array buffer. This buffer\r\n     * is not copied, so no additional memory is used. After\r\n     * creating the ByteArrayInputStream the instance of the\r\n     * ByteArrayInOutStream can not be used anymore.\r\n     * &lt;p&gt;\r\n     * The ByteArrayInputStream can be retrieved using &lt;code&gt;getInputStream()&lt;/code&gt;.\r\n     * @author Nick Russler\r\n     */\r\n    public class ByteArrayInOutStream extends ByteArrayOutputStream {\r\n        /**\r\n         * Creates a new ByteArrayInOutStream. The buffer capacity is\r\n         * initially 32 bytes, though its size increases if necessary.\r\n         */\r\n    \tpublic ByteArrayInOutStream() {\r\n    \t\tsuper();\r\n    \t}\r\n    \t\r\n        /**\r\n         * Creates a new ByteArrayInOutStream, with a buffer capacity of\r\n         * the specified size, in bytes.\r\n         *\r\n         * @param   size   the initial size.\r\n         * @exception  IllegalArgumentException if size is negative.\r\n         */\r\n    \tpublic ByteArrayInOutStream(int size) {\r\n    \t\tsuper(size);\r\n    \t}\r\n    \r\n    \t/**\r\n    \t * Creates a new ByteArrayInputStream that uses the internal byte array buffer \r\n    \t * of this ByteArrayInOutStream instance as its buffer array. The initial value \r\n    \t * of pos is set to zero and the initial value of count is the number of bytes \r\n    \t * that can be read from the byte array. The buffer array is not copied. This \r\n    \t * instance of ByteArrayInOutStream can not be used anymore after calling this\r\n    \t * method.\r\n    \t * @return the ByteArrayInputStream instance\r\n    \t */\r\n    \tpublic ByteArrayInputStream getInputStream() {\r\n    \t\t// create new ByteArrayInputStream that respects the current count\r\n    \t\tByteArrayInputStream in = new ByteArrayInputStream(this.buf, 0, this.count);\r\n    \t\t\r\n    \t\t// set the buffer of the ByteArrayOutputStream \r\n    \t\t// to null so it can&#39;t be altered anymore\r\n    \t\tthis.buf = null;\r\n    \t\t\r\n    \t\treturn in;\r\n    \t}\r\n    }\r\n\r\nI put the stuff on github: https://github.com/nickrussler/ByteArrayInOutStream","title":"How do I convert an OutputStream to an InputStream?","body":"<p>I encountered the same problem with converting a <code>ByteArrayOutputStream</code> to a <code>ByteArrayInputStream</code> and solved it by using a derived class from <code>ByteArrayOutputStream</code> which is able to return a <code>ByteArrayInputStream</code> that is initialized with the internal buffer of the <code>ByteArrayOutputStream</code>. This way no additional memory is used and the 'conversion' is very fast:</p>\n\n<pre><code>package info.whitebyte.utils;\nimport java.io.ByteArrayInputStream;\nimport java.io.ByteArrayOutputStream;\n\n/**\n * This class extends the ByteArrayOutputStream by \n * providing a method that returns a new ByteArrayInputStream\n * which uses the internal byte array buffer. This buffer\n * is not copied, so no additional memory is used. After\n * creating the ByteArrayInputStream the instance of the\n * ByteArrayInOutStream can not be used anymore.\n * &lt;p&gt;\n * The ByteArrayInputStream can be retrieved using &lt;code&gt;getInputStream()&lt;/code&gt;.\n * @author Nick Russler\n */\npublic class ByteArrayInOutStream extends ByteArrayOutputStream {\n    /**\n     * Creates a new ByteArrayInOutStream. The buffer capacity is\n     * initially 32 bytes, though its size increases if necessary.\n     */\n    public ByteArrayInOutStream() {\n        super();\n    }\n\n    /**\n     * Creates a new ByteArrayInOutStream, with a buffer capacity of\n     * the specified size, in bytes.\n     *\n     * @param   size   the initial size.\n     * @exception  IllegalArgumentException if size is negative.\n     */\n    public ByteArrayInOutStream(int size) {\n        super(size);\n    }\n\n    /**\n     * Creates a new ByteArrayInputStream that uses the internal byte array buffer \n     * of this ByteArrayInOutStream instance as its buffer array. The initial value \n     * of pos is set to zero and the initial value of count is the number of bytes \n     * that can be read from the byte array. The buffer array is not copied. This \n     * instance of ByteArrayInOutStream can not be used anymore after calling this\n     * method.\n     * @return the ByteArrayInputStream instance\n     */\n    public ByteArrayInputStream getInputStream() {\n        // create new ByteArrayInputStream that respects the current count\n        ByteArrayInputStream in = new ByteArrayInputStream(this.buf, 0, this.count);\n\n        // set the buffer of the ByteArrayOutputStream \n        // to null so it can't be altered anymore\n        this.buf = null;\n\n        return in;\n    }\n}\n</code></pre>\n\n<p>I put the stuff on github: <a href=\"https://github.com/nickrussler/ByteArrayInOutStream\" rel=\"noreferrer\">https://github.com/nickrussler/ByteArrayInOutStream</a></p>\n"},{"tags":[],"owner":{"account_id":2735009,"reputation":4764,"user_id":2357869,"accept_rate":33,"display_name":"Vijay"},"down_vote_count":8,"up_vote_count":36,"is_accepted":false,"score":28,"last_activity_date":1485501227,"creation_date":1485501227,"answer_id":41888647,"question_id":5778658,"body_markdown":"    ByteArrayOutputStream buffer = (ByteArrayOutputStream) aOutputStream;\r\n    byte[] bytes = buffer.toByteArray();\r\n    InputStream inputStream = new ByteArrayInputStream(bytes);","title":"How do I convert an OutputStream to an InputStream?","body":"<pre><code>ByteArrayOutputStream buffer = (ByteArrayOutputStream) aOutputStream;\nbyte[] bytes = buffer.toByteArray();\nInputStream inputStream = new ByteArrayInputStream(bytes);\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2771202,"reputation":147,"user_id":2385774,"display_name":"Ranjit Aneesh"},"down_vote_count":2,"up_vote_count":0,"is_accepted":false,"score":-2,"last_activity_date":1498028230,"creation_date":1493109020,"answer_id":43605439,"question_id":5778658,"body_markdown":"Though you cannot convert an OutputStream to an InputStream, java provides a way using PipedOutputStream and PipedInputStream that you can have data written to a  PipedOutputStream to become available through an associated PipedInputStream. &lt;br/&gt; Sometime back I faced a similar situation when dealing with third party libraries that required an InputStream instance to be passed to them instead of an OutputStream instance.&lt;br/&gt; The way I fixed this issue is to use the PipedInputStream and PipedOutputStream. &lt;br/&gt;By the way they are tricky to use and you must use multithreading to achieve what you want. I recently published an implementation on github which you can use. &lt;br/&gt;Here is the [link][1] . You can go through the wiki to understand how to use it.\r\n\r\n\r\n  [1]: https://github.com/ranjitaneesh/io/blob/master/Pipe.java","title":"How do I convert an OutputStream to an InputStream?","body":"<p>Though you cannot convert an OutputStream to an InputStream, java provides a way using PipedOutputStream and PipedInputStream that you can have data written to a  PipedOutputStream to become available through an associated PipedInputStream. <br/> Sometime back I faced a similar situation when dealing with third party libraries that required an InputStream instance to be passed to them instead of an OutputStream instance.<br/> The way I fixed this issue is to use the PipedInputStream and PipedOutputStream. <br/>By the way they are tricky to use and you must use multithreading to achieve what you want. I recently published an implementation on github which you can use. <br/>Here is the <a href=\"https://github.com/ranjitaneesh/io/blob/master/Pipe.java\" rel=\"nofollow noreferrer\">link</a> . You can go through the wiki to understand how to use it.</p>\n"},{"tags":[],"owner":{"account_id":12129802,"reputation":175,"user_id":8857216,"display_name":"Luc Vaillant"},"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1523382967,"creation_date":1523380564,"answer_id":49759486,"question_id":5778658,"body_markdown":"From my point of view, java.io.PipedInputStream/java.io.PipedOutputStream is the best option to considere. In some situations you may want to use ByteArrayInputStream/ByteArrayOutputStream. The problem is that you need to duplicate the buffer to convert a ByteArrayOutputStream to a ByteArrayInputStream. Also ByteArrayOutpuStream/ByteArrayInputStream are limited to 2GB. Here is an OutpuStream/InputStream implementation I wrote to bypass ByteArrayOutputStream/ByteArrayInputStream limitations (Scala code, but easily understandable for java developpers):\r\n\r\n    import java.io.{IOException, InputStream, OutputStream}\r\n    \r\n    import scala.annotation.tailrec\r\n    \r\n    /** Acts as a replacement for ByteArrayOutputStream\r\n      *\r\n      */\r\n    class HugeMemoryOutputStream(capacity: Long) extends OutputStream {\r\n      private val PAGE_SIZE: Int = 1024000\r\n      private val ALLOC_STEP: Int = 1024\r\n    \r\n      /** Pages array\r\n        *\r\n        */\r\n      private var streamBuffers: Array[Array[Byte]] = Array.empty[Array[Byte]]\r\n    \r\n      /** Allocated pages count\r\n        *\r\n        */\r\n      private var pageCount: Int = 0\r\n    \r\n      /** Allocated bytes count\r\n        *\r\n        */\r\n      private var allocatedBytes: Long = 0\r\n    \r\n      /** Current position in stream\r\n        *\r\n        */\r\n      private var position: Long = 0\r\n    \r\n      /** Stream length\r\n        *\r\n        */\r\n      private var length: Long = 0\r\n    \r\n      allocSpaceIfNeeded(capacity)\r\n    \r\n      /** Gets page count based on given length\r\n        *\r\n        * @param length   Buffer length\r\n        * @return         Page count to hold the specified amount of data\r\n        */\r\n      private def getPageCount(length: Long) = {\r\n        var pageCount = (length / PAGE_SIZE).toInt + 1\r\n    \r\n        if ((length % PAGE_SIZE) == 0) {\r\n          pageCount -= 1\r\n        }\r\n    \r\n        pageCount\r\n      }\r\n    \r\n      /** Extends pages array\r\n        *\r\n        */\r\n      private def extendPages(): Unit = {\r\n        if (streamBuffers.isEmpty) {\r\n          streamBuffers = new Array[Array[Byte]](ALLOC_STEP)\r\n        }\r\n        else {\r\n          val newStreamBuffers = new Array[Array[Byte]](streamBuffers.length + ALLOC_STEP)\r\n          Array.copy(streamBuffers, 0, newStreamBuffers, 0, streamBuffers.length)\r\n          streamBuffers = newStreamBuffers\r\n        }\r\n    \r\n        pageCount = streamBuffers.length\r\n      }\r\n    \r\n      /** Ensures buffers are bug enough to hold specified amount of data\r\n        *\r\n        * @param value  Amount of data\r\n        */\r\n      private def allocSpaceIfNeeded(value: Long): Unit = {\r\n        @tailrec\r\n        def allocSpaceIfNeededIter(value: Long): Unit = {\r\n          val currentPageCount = getPageCount(allocatedBytes)\r\n          val neededPageCount = getPageCount(value)\r\n    \r\n          if (currentPageCount &lt; neededPageCount) {\r\n            if (currentPageCount == pageCount) extendPages()\r\n    \r\n            streamBuffers(currentPageCount) = new Array[Byte](PAGE_SIZE)\r\n            allocatedBytes = (currentPageCount + 1).toLong * PAGE_SIZE\r\n    \r\n            allocSpaceIfNeededIter(value)\r\n          }\r\n        }\r\n    \r\n        if (value &lt; 0) throw new Error(&quot;AllocSpaceIfNeeded &lt; 0&quot;)\r\n        if (value &gt; 0) {\r\n          allocSpaceIfNeededIter(value)\r\n    \r\n          length = Math.max(value, length)\r\n          if (position &gt; length) position = length\r\n        }\r\n      }\r\n    \r\n      /**\r\n        * Writes the specified byte to this output stream. The general\r\n        * contract for &lt;code&gt;write&lt;/code&gt; is that one byte is written\r\n        * to the output stream. The byte to be written is the eight\r\n        * low-order bits of the argument &lt;code&gt;b&lt;/code&gt;. The 24\r\n        * high-order bits of &lt;code&gt;b&lt;/code&gt; are ignored.\r\n        * &lt;p&gt;\r\n        * Subclasses of &lt;code&gt;OutputStream&lt;/code&gt; must provide an\r\n        * implementation for this method.\r\n        *\r\n        * @param      b the &lt;code&gt;byte&lt;/code&gt;.\r\n        */\r\n      @throws[IOException]\r\n      override def write(b: Int): Unit = {\r\n        val buffer: Array[Byte] = new Array[Byte](1)\r\n    \r\n        buffer(0) = b.toByte\r\n    \r\n        write(buffer)\r\n      }\r\n    \r\n      /**\r\n        * Writes &lt;code&gt;len&lt;/code&gt; bytes from the specified byte array\r\n        * starting at offset &lt;code&gt;off&lt;/code&gt; to this output stream.\r\n        * The general contract for &lt;code&gt;write(b, off, len)&lt;/code&gt; is that\r\n        * some of the bytes in the array &lt;code&gt;b&lt;/code&gt; are written to the\r\n        * output stream in order; element &lt;code&gt;b[off]&lt;/code&gt; is the first\r\n        * byte written and &lt;code&gt;b[off+len-1]&lt;/code&gt; is the last byte written\r\n        * by this operation.\r\n        * &lt;p&gt;\r\n        * The &lt;code&gt;write&lt;/code&gt; method of &lt;code&gt;OutputStream&lt;/code&gt; calls\r\n        * the write method of one argument on each of the bytes to be\r\n        * written out. Subclasses are encouraged to override this method and\r\n        * provide a more efficient implementation.\r\n        * &lt;p&gt;\r\n        * If &lt;code&gt;b&lt;/code&gt; is &lt;code&gt;null&lt;/code&gt;, a\r\n        * &lt;code&gt;NullPointerException&lt;/code&gt; is thrown.\r\n        * &lt;p&gt;\r\n        * If &lt;code&gt;off&lt;/code&gt; is negative, or &lt;code&gt;len&lt;/code&gt; is negative, or\r\n        * &lt;code&gt;off+len&lt;/code&gt; is greater than the length of the array\r\n        * &lt;code&gt;b&lt;/code&gt;, then an &lt;tt&gt;IndexOutOfBoundsException&lt;/tt&gt; is thrown.\r\n        *\r\n        * @param      b   the data.\r\n        * @param      off the start offset in the data.\r\n        * @param      len the number of bytes to write.\r\n        */\r\n      @throws[IOException]\r\n      override def write(b: Array[Byte], off: Int, len: Int): Unit = {\r\n        @tailrec\r\n        def writeIter(b: Array[Byte], off: Int, len: Int): Unit = {\r\n          val currentPage: Int = (position / PAGE_SIZE).toInt\r\n          val currentOffset: Int = (position % PAGE_SIZE).toInt\r\n    \r\n          if (len != 0) {\r\n            val currentLength: Int = Math.min(PAGE_SIZE - currentOffset, len)\r\n            Array.copy(b, off, streamBuffers(currentPage), currentOffset, currentLength)\r\n    \r\n            position += currentLength\r\n    \r\n            writeIter(b, off + currentLength, len - currentLength)\r\n          }\r\n        }\r\n    \r\n        allocSpaceIfNeeded(position + len)\r\n        writeIter(b, off, len)\r\n      }\r\n    \r\n      /** Gets an InputStream that points to HugeMemoryOutputStream buffer\r\n        *\r\n        * @return InputStream\r\n        */\r\n      def asInputStream(): InputStream = {\r\n        new HugeMemoryInputStream(streamBuffers, length)\r\n      }\r\n    \r\n      private class HugeMemoryInputStream(streamBuffers: Array[Array[Byte]], val length: Long) extends InputStream {\r\n        /** Current position in stream\r\n          *\r\n          */\r\n        private var position: Long = 0\r\n    \r\n        /**\r\n          * Reads the next byte of data from the input stream. The value byte is\r\n          * returned as an &lt;code&gt;int&lt;/code&gt; in the range &lt;code&gt;0&lt;/code&gt; to\r\n          * &lt;code&gt;255&lt;/code&gt;. If no byte is available because the end of the stream\r\n          * has been reached, the value &lt;code&gt;-1&lt;/code&gt; is returned. This method\r\n          * blocks until input data is available, the end of the stream is detected,\r\n          * or an exception is thrown.\r\n          *\r\n          * &lt;p&gt; A subclass must provide an implementation of this method.\r\n          *\r\n          * @return the next byte of data, or &lt;code&gt;-1&lt;/code&gt; if the end of the\r\n          *         stream is reached.\r\n          */\r\n        @throws[IOException]\r\n        def read: Int = {\r\n          val buffer: Array[Byte] = new Array[Byte](1)\r\n    \r\n          if (read(buffer) == 0) throw new Error(&quot;End of stream&quot;)\r\n          else buffer(0)\r\n        }\r\n    \r\n        /**\r\n          * Reads up to &lt;code&gt;len&lt;/code&gt; bytes of data from the input stream into\r\n          * an array of bytes.  An attempt is made to read as many as\r\n          * &lt;code&gt;len&lt;/code&gt; bytes, but a smaller number may be read.\r\n          * The number of bytes actually read is returned as an integer.\r\n          *\r\n          * &lt;p&gt; This method blocks until input data is available, end of file is\r\n          * detected, or an exception is thrown.\r\n          *\r\n          * &lt;p&gt; If &lt;code&gt;len&lt;/code&gt; is zero, then no bytes are read and\r\n          * &lt;code&gt;0&lt;/code&gt; is returned; otherwise, there is an attempt to read at\r\n          * least one byte. If no byte is available because the stream is at end of\r\n          * file, the value &lt;code&gt;-1&lt;/code&gt; is returned; otherwise, at least one\r\n          * byte is read and stored into &lt;code&gt;b&lt;/code&gt;.\r\n          *\r\n          * &lt;p&gt; The first byte read is stored into element &lt;code&gt;b[off]&lt;/code&gt;, the\r\n          * next one into &lt;code&gt;b[off+1]&lt;/code&gt;, and so on. The number of bytes read\r\n          * is, at most, equal to &lt;code&gt;len&lt;/code&gt;. Let &lt;i&gt;k&lt;/i&gt; be the number of\r\n          * bytes actually read; these bytes will be stored in elements\r\n          * &lt;code&gt;b[off]&lt;/code&gt; through &lt;code&gt;b[off+&lt;/code&gt;&lt;i&gt;k&lt;/i&gt;&lt;code&gt;-1]&lt;/code&gt;,\r\n          * leaving elements &lt;code&gt;b[off+&lt;/code&gt;&lt;i&gt;k&lt;/i&gt;&lt;code&gt;]&lt;/code&gt; through\r\n          * &lt;code&gt;b[off+len-1]&lt;/code&gt; unaffected.\r\n          *\r\n          * &lt;p&gt; In every case, elements &lt;code&gt;b[0]&lt;/code&gt; through\r\n          * &lt;code&gt;b[off]&lt;/code&gt; and elements &lt;code&gt;b[off+len]&lt;/code&gt; through\r\n          * &lt;code&gt;b[b.length-1]&lt;/code&gt; are unaffected.\r\n          *\r\n          * &lt;p&gt; The &lt;code&gt;read(b,&lt;/code&gt; &lt;code&gt;off,&lt;/code&gt; &lt;code&gt;len)&lt;/code&gt; method\r\n          * for class &lt;code&gt;InputStream&lt;/code&gt; simply calls the method\r\n          * &lt;code&gt;read()&lt;/code&gt; repeatedly. If the first such call results in an\r\n          * &lt;code&gt;IOException&lt;/code&gt;, that exception is returned from the call to\r\n          * the &lt;code&gt;read(b,&lt;/code&gt; &lt;code&gt;off,&lt;/code&gt; &lt;code&gt;len)&lt;/code&gt; method.  If\r\n          * any subsequent call to &lt;code&gt;read()&lt;/code&gt; results in a\r\n          * &lt;code&gt;IOException&lt;/code&gt;, the exception is caught and treated as if it\r\n          * were end of file; the bytes read up to that point are stored into\r\n          * &lt;code&gt;b&lt;/code&gt; and the number of bytes read before the exception\r\n          * occurred is returned. The default implementation of this method blocks\r\n          * until the requested amount of input data &lt;code&gt;len&lt;/code&gt; has been read,\r\n          * end of file is detected, or an exception is thrown. Subclasses are encouraged\r\n          * to provide a more efficient implementation of this method.\r\n          *\r\n          * @param      b   the buffer into which the data is read.\r\n          * @param      off the start offset in array &lt;code&gt;b&lt;/code&gt;\r\n          *                 at which the data is written.\r\n          * @param      len the maximum number of bytes to read.\r\n          * @return the total number of bytes read into the buffer, or\r\n          *         &lt;code&gt;-1&lt;/code&gt; if there is no more data because the end of\r\n          *         the stream has been reached.\r\n          * @see java.io.InputStream#read()\r\n          */\r\n        @throws[IOException]\r\n        override def read(b: Array[Byte], off: Int, len: Int): Int = {\r\n          @tailrec\r\n          def readIter(acc: Int, b: Array[Byte], off: Int, len: Int): Int = {\r\n            val currentPage: Int = (position / PAGE_SIZE).toInt\r\n            val currentOffset: Int = (position % PAGE_SIZE).toInt\r\n    \r\n            val count: Int = Math.min(len, length - position).toInt\r\n    \r\n            if (count == 0 || position &gt;= length) acc\r\n            else {\r\n              val currentLength = Math.min(PAGE_SIZE - currentOffset, count)\r\n              Array.copy(streamBuffers(currentPage), currentOffset, b, off, currentLength)\r\n    \r\n              position += currentLength\r\n    \r\n              readIter(acc + currentLength, b, off + currentLength, len - currentLength)\r\n            }\r\n          }\r\n    \r\n          readIter(0, b, off, len)\r\n        }\r\n    \r\n        /**\r\n          * Skips over and discards &lt;code&gt;n&lt;/code&gt; bytes of data from this input\r\n          * stream. The &lt;code&gt;skip&lt;/code&gt; method may, for a variety of reasons, end\r\n          * up skipping over some smaller number of bytes, possibly &lt;code&gt;0&lt;/code&gt;.\r\n          * This may result from any of a number of conditions; reaching end of file\r\n          * before &lt;code&gt;n&lt;/code&gt; bytes have been skipped is only one possibility.\r\n          * The actual number of bytes skipped is returned. If &lt;code&gt;n&lt;/code&gt; is\r\n          * negative, the &lt;code&gt;skip&lt;/code&gt; method for class &lt;code&gt;InputStream&lt;/code&gt; always\r\n          * returns 0, and no bytes are skipped. Subclasses may handle the negative\r\n          * value differently.\r\n          *\r\n          * The &lt;code&gt;skip&lt;/code&gt; method of this class creates a\r\n          * byte array and then repeatedly reads into it until &lt;code&gt;n&lt;/code&gt; bytes\r\n          * have been read or the end of the stream has been reached. Subclasses are\r\n          * encouraged to provide a more efficient implementation of this method.\r\n          * For instance, the implementation may depend on the ability to seek.\r\n          *\r\n          * @param      n the number of bytes to be skipped.\r\n          * @return the actual number of bytes skipped.\r\n          */\r\n        @throws[IOException]\r\n        override def skip(n: Long): Long = {\r\n          if (n &lt; 0) 0\r\n          else {\r\n            position = Math.min(position + n, length)\r\n            length - position\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n**Easy to use, no buffer duplication, no 2GB memory limit**\r\n\r\n    val out: HugeMemoryOutputStream = new HugeMemoryOutputStream(initialCapacity /*may be 0*/)\r\n\r\n    out.write(...)\r\n    ...\r\n\r\n    val in1: InputStream = out.asInputStream()\r\n\r\n    in1.read(...)\r\n    ...\r\n\r\n    val in2: InputStream = out.asInputStream()\r\n\r\n    in2.read(...)\r\n    ...\r\n","title":"How do I convert an OutputStream to an InputStream?","body":"<p>From my point of view, java.io.PipedInputStream/java.io.PipedOutputStream is the best option to considere. In some situations you may want to use ByteArrayInputStream/ByteArrayOutputStream. The problem is that you need to duplicate the buffer to convert a ByteArrayOutputStream to a ByteArrayInputStream. Also ByteArrayOutpuStream/ByteArrayInputStream are limited to 2GB. Here is an OutpuStream/InputStream implementation I wrote to bypass ByteArrayOutputStream/ByteArrayInputStream limitations (Scala code, but easily understandable for java developpers):</p>\n\n<pre><code>import java.io.{IOException, InputStream, OutputStream}\n\nimport scala.annotation.tailrec\n\n/** Acts as a replacement for ByteArrayOutputStream\n  *\n  */\nclass HugeMemoryOutputStream(capacity: Long) extends OutputStream {\n  private val PAGE_SIZE: Int = 1024000\n  private val ALLOC_STEP: Int = 1024\n\n  /** Pages array\n    *\n    */\n  private var streamBuffers: Array[Array[Byte]] = Array.empty[Array[Byte]]\n\n  /** Allocated pages count\n    *\n    */\n  private var pageCount: Int = 0\n\n  /** Allocated bytes count\n    *\n    */\n  private var allocatedBytes: Long = 0\n\n  /** Current position in stream\n    *\n    */\n  private var position: Long = 0\n\n  /** Stream length\n    *\n    */\n  private var length: Long = 0\n\n  allocSpaceIfNeeded(capacity)\n\n  /** Gets page count based on given length\n    *\n    * @param length   Buffer length\n    * @return         Page count to hold the specified amount of data\n    */\n  private def getPageCount(length: Long) = {\n    var pageCount = (length / PAGE_SIZE).toInt + 1\n\n    if ((length % PAGE_SIZE) == 0) {\n      pageCount -= 1\n    }\n\n    pageCount\n  }\n\n  /** Extends pages array\n    *\n    */\n  private def extendPages(): Unit = {\n    if (streamBuffers.isEmpty) {\n      streamBuffers = new Array[Array[Byte]](ALLOC_STEP)\n    }\n    else {\n      val newStreamBuffers = new Array[Array[Byte]](streamBuffers.length + ALLOC_STEP)\n      Array.copy(streamBuffers, 0, newStreamBuffers, 0, streamBuffers.length)\n      streamBuffers = newStreamBuffers\n    }\n\n    pageCount = streamBuffers.length\n  }\n\n  /** Ensures buffers are bug enough to hold specified amount of data\n    *\n    * @param value  Amount of data\n    */\n  private def allocSpaceIfNeeded(value: Long): Unit = {\n    @tailrec\n    def allocSpaceIfNeededIter(value: Long): Unit = {\n      val currentPageCount = getPageCount(allocatedBytes)\n      val neededPageCount = getPageCount(value)\n\n      if (currentPageCount &lt; neededPageCount) {\n        if (currentPageCount == pageCount) extendPages()\n\n        streamBuffers(currentPageCount) = new Array[Byte](PAGE_SIZE)\n        allocatedBytes = (currentPageCount + 1).toLong * PAGE_SIZE\n\n        allocSpaceIfNeededIter(value)\n      }\n    }\n\n    if (value &lt; 0) throw new Error(\"AllocSpaceIfNeeded &lt; 0\")\n    if (value &gt; 0) {\n      allocSpaceIfNeededIter(value)\n\n      length = Math.max(value, length)\n      if (position &gt; length) position = length\n    }\n  }\n\n  /**\n    * Writes the specified byte to this output stream. The general\n    * contract for &lt;code&gt;write&lt;/code&gt; is that one byte is written\n    * to the output stream. The byte to be written is the eight\n    * low-order bits of the argument &lt;code&gt;b&lt;/code&gt;. The 24\n    * high-order bits of &lt;code&gt;b&lt;/code&gt; are ignored.\n    * &lt;p&gt;\n    * Subclasses of &lt;code&gt;OutputStream&lt;/code&gt; must provide an\n    * implementation for this method.\n    *\n    * @param      b the &lt;code&gt;byte&lt;/code&gt;.\n    */\n  @throws[IOException]\n  override def write(b: Int): Unit = {\n    val buffer: Array[Byte] = new Array[Byte](1)\n\n    buffer(0) = b.toByte\n\n    write(buffer)\n  }\n\n  /**\n    * Writes &lt;code&gt;len&lt;/code&gt; bytes from the specified byte array\n    * starting at offset &lt;code&gt;off&lt;/code&gt; to this output stream.\n    * The general contract for &lt;code&gt;write(b, off, len)&lt;/code&gt; is that\n    * some of the bytes in the array &lt;code&gt;b&lt;/code&gt; are written to the\n    * output stream in order; element &lt;code&gt;b[off]&lt;/code&gt; is the first\n    * byte written and &lt;code&gt;b[off+len-1]&lt;/code&gt; is the last byte written\n    * by this operation.\n    * &lt;p&gt;\n    * The &lt;code&gt;write&lt;/code&gt; method of &lt;code&gt;OutputStream&lt;/code&gt; calls\n    * the write method of one argument on each of the bytes to be\n    * written out. Subclasses are encouraged to override this method and\n    * provide a more efficient implementation.\n    * &lt;p&gt;\n    * If &lt;code&gt;b&lt;/code&gt; is &lt;code&gt;null&lt;/code&gt;, a\n    * &lt;code&gt;NullPointerException&lt;/code&gt; is thrown.\n    * &lt;p&gt;\n    * If &lt;code&gt;off&lt;/code&gt; is negative, or &lt;code&gt;len&lt;/code&gt; is negative, or\n    * &lt;code&gt;off+len&lt;/code&gt; is greater than the length of the array\n    * &lt;code&gt;b&lt;/code&gt;, then an &lt;tt&gt;IndexOutOfBoundsException&lt;/tt&gt; is thrown.\n    *\n    * @param      b   the data.\n    * @param      off the start offset in the data.\n    * @param      len the number of bytes to write.\n    */\n  @throws[IOException]\n  override def write(b: Array[Byte], off: Int, len: Int): Unit = {\n    @tailrec\n    def writeIter(b: Array[Byte], off: Int, len: Int): Unit = {\n      val currentPage: Int = (position / PAGE_SIZE).toInt\n      val currentOffset: Int = (position % PAGE_SIZE).toInt\n\n      if (len != 0) {\n        val currentLength: Int = Math.min(PAGE_SIZE - currentOffset, len)\n        Array.copy(b, off, streamBuffers(currentPage), currentOffset, currentLength)\n\n        position += currentLength\n\n        writeIter(b, off + currentLength, len - currentLength)\n      }\n    }\n\n    allocSpaceIfNeeded(position + len)\n    writeIter(b, off, len)\n  }\n\n  /** Gets an InputStream that points to HugeMemoryOutputStream buffer\n    *\n    * @return InputStream\n    */\n  def asInputStream(): InputStream = {\n    new HugeMemoryInputStream(streamBuffers, length)\n  }\n\n  private class HugeMemoryInputStream(streamBuffers: Array[Array[Byte]], val length: Long) extends InputStream {\n    /** Current position in stream\n      *\n      */\n    private var position: Long = 0\n\n    /**\n      * Reads the next byte of data from the input stream. The value byte is\n      * returned as an &lt;code&gt;int&lt;/code&gt; in the range &lt;code&gt;0&lt;/code&gt; to\n      * &lt;code&gt;255&lt;/code&gt;. If no byte is available because the end of the stream\n      * has been reached, the value &lt;code&gt;-1&lt;/code&gt; is returned. This method\n      * blocks until input data is available, the end of the stream is detected,\n      * or an exception is thrown.\n      *\n      * &lt;p&gt; A subclass must provide an implementation of this method.\n      *\n      * @return the next byte of data, or &lt;code&gt;-1&lt;/code&gt; if the end of the\n      *         stream is reached.\n      */\n    @throws[IOException]\n    def read: Int = {\n      val buffer: Array[Byte] = new Array[Byte](1)\n\n      if (read(buffer) == 0) throw new Error(\"End of stream\")\n      else buffer(0)\n    }\n\n    /**\n      * Reads up to &lt;code&gt;len&lt;/code&gt; bytes of data from the input stream into\n      * an array of bytes.  An attempt is made to read as many as\n      * &lt;code&gt;len&lt;/code&gt; bytes, but a smaller number may be read.\n      * The number of bytes actually read is returned as an integer.\n      *\n      * &lt;p&gt; This method blocks until input data is available, end of file is\n      * detected, or an exception is thrown.\n      *\n      * &lt;p&gt; If &lt;code&gt;len&lt;/code&gt; is zero, then no bytes are read and\n      * &lt;code&gt;0&lt;/code&gt; is returned; otherwise, there is an attempt to read at\n      * least one byte. If no byte is available because the stream is at end of\n      * file, the value &lt;code&gt;-1&lt;/code&gt; is returned; otherwise, at least one\n      * byte is read and stored into &lt;code&gt;b&lt;/code&gt;.\n      *\n      * &lt;p&gt; The first byte read is stored into element &lt;code&gt;b[off]&lt;/code&gt;, the\n      * next one into &lt;code&gt;b[off+1]&lt;/code&gt;, and so on. The number of bytes read\n      * is, at most, equal to &lt;code&gt;len&lt;/code&gt;. Let &lt;i&gt;k&lt;/i&gt; be the number of\n      * bytes actually read; these bytes will be stored in elements\n      * &lt;code&gt;b[off]&lt;/code&gt; through &lt;code&gt;b[off+&lt;/code&gt;&lt;i&gt;k&lt;/i&gt;&lt;code&gt;-1]&lt;/code&gt;,\n      * leaving elements &lt;code&gt;b[off+&lt;/code&gt;&lt;i&gt;k&lt;/i&gt;&lt;code&gt;]&lt;/code&gt; through\n      * &lt;code&gt;b[off+len-1]&lt;/code&gt; unaffected.\n      *\n      * &lt;p&gt; In every case, elements &lt;code&gt;b[0]&lt;/code&gt; through\n      * &lt;code&gt;b[off]&lt;/code&gt; and elements &lt;code&gt;b[off+len]&lt;/code&gt; through\n      * &lt;code&gt;b[b.length-1]&lt;/code&gt; are unaffected.\n      *\n      * &lt;p&gt; The &lt;code&gt;read(b,&lt;/code&gt; &lt;code&gt;off,&lt;/code&gt; &lt;code&gt;len)&lt;/code&gt; method\n      * for class &lt;code&gt;InputStream&lt;/code&gt; simply calls the method\n      * &lt;code&gt;read()&lt;/code&gt; repeatedly. If the first such call results in an\n      * &lt;code&gt;IOException&lt;/code&gt;, that exception is returned from the call to\n      * the &lt;code&gt;read(b,&lt;/code&gt; &lt;code&gt;off,&lt;/code&gt; &lt;code&gt;len)&lt;/code&gt; method.  If\n      * any subsequent call to &lt;code&gt;read()&lt;/code&gt; results in a\n      * &lt;code&gt;IOException&lt;/code&gt;, the exception is caught and treated as if it\n      * were end of file; the bytes read up to that point are stored into\n      * &lt;code&gt;b&lt;/code&gt; and the number of bytes read before the exception\n      * occurred is returned. The default implementation of this method blocks\n      * until the requested amount of input data &lt;code&gt;len&lt;/code&gt; has been read,\n      * end of file is detected, or an exception is thrown. Subclasses are encouraged\n      * to provide a more efficient implementation of this method.\n      *\n      * @param      b   the buffer into which the data is read.\n      * @param      off the start offset in array &lt;code&gt;b&lt;/code&gt;\n      *                 at which the data is written.\n      * @param      len the maximum number of bytes to read.\n      * @return the total number of bytes read into the buffer, or\n      *         &lt;code&gt;-1&lt;/code&gt; if there is no more data because the end of\n      *         the stream has been reached.\n      * @see java.io.InputStream#read()\n      */\n    @throws[IOException]\n    override def read(b: Array[Byte], off: Int, len: Int): Int = {\n      @tailrec\n      def readIter(acc: Int, b: Array[Byte], off: Int, len: Int): Int = {\n        val currentPage: Int = (position / PAGE_SIZE).toInt\n        val currentOffset: Int = (position % PAGE_SIZE).toInt\n\n        val count: Int = Math.min(len, length - position).toInt\n\n        if (count == 0 || position &gt;= length) acc\n        else {\n          val currentLength = Math.min(PAGE_SIZE - currentOffset, count)\n          Array.copy(streamBuffers(currentPage), currentOffset, b, off, currentLength)\n\n          position += currentLength\n\n          readIter(acc + currentLength, b, off + currentLength, len - currentLength)\n        }\n      }\n\n      readIter(0, b, off, len)\n    }\n\n    /**\n      * Skips over and discards &lt;code&gt;n&lt;/code&gt; bytes of data from this input\n      * stream. The &lt;code&gt;skip&lt;/code&gt; method may, for a variety of reasons, end\n      * up skipping over some smaller number of bytes, possibly &lt;code&gt;0&lt;/code&gt;.\n      * This may result from any of a number of conditions; reaching end of file\n      * before &lt;code&gt;n&lt;/code&gt; bytes have been skipped is only one possibility.\n      * The actual number of bytes skipped is returned. If &lt;code&gt;n&lt;/code&gt; is\n      * negative, the &lt;code&gt;skip&lt;/code&gt; method for class &lt;code&gt;InputStream&lt;/code&gt; always\n      * returns 0, and no bytes are skipped. Subclasses may handle the negative\n      * value differently.\n      *\n      * The &lt;code&gt;skip&lt;/code&gt; method of this class creates a\n      * byte array and then repeatedly reads into it until &lt;code&gt;n&lt;/code&gt; bytes\n      * have been read or the end of the stream has been reached. Subclasses are\n      * encouraged to provide a more efficient implementation of this method.\n      * For instance, the implementation may depend on the ability to seek.\n      *\n      * @param      n the number of bytes to be skipped.\n      * @return the actual number of bytes skipped.\n      */\n    @throws[IOException]\n    override def skip(n: Long): Long = {\n      if (n &lt; 0) 0\n      else {\n        position = Math.min(position + n, length)\n        length - position\n      }\n    }\n  }\n}\n</code></pre>\n\n<p><strong>Easy to use, no buffer duplication, no 2GB memory limit</strong></p>\n\n<pre><code>val out: HugeMemoryOutputStream = new HugeMemoryOutputStream(initialCapacity /*may be 0*/)\n\nout.write(...)\n...\n\nval in1: InputStream = out.asInputStream()\n\nin1.read(...)\n...\n\nval in2: InputStream = out.asInputStream()\n\nin2.read(...)\n...\n</code></pre>\n"},{"tags":[],"owner":{"account_id":216605,"reputation":11967,"user_id":471955,"accept_rate":0,"display_name":"Dave Moten"},"down_vote_count":2,"up_vote_count":3,"is_accepted":false,"score":1,"last_activity_date":1524703382,"creation_date":1524703382,"answer_id":50033197,"question_id":5778658,"body_markdown":"The library [*io-extras*][1] may be useful. For example if you want to gzip an `InputStream` using `GZIPOutputStream` and you want it to happen *synchronously* (using the default buffer size of 8192):\r\n\r\n    InputStream is = ...\r\n    InputStream gz = IOUtil.pipe(is, o -&gt; new GZIPOutputStream(o));\r\n\r\nNote that the library has 100% unit test coverage (for what that&#39;s worth of course!) and is on Maven Central. The Maven dependency is:\r\n\r\n    &lt;dependency&gt;\r\n      &lt;groupId&gt;com.github.davidmoten&lt;/groupId&gt;\r\n      &lt;artifactId&gt;io-extras&lt;/artifactId&gt;\r\n      &lt;version&gt;0.1&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n\r\nBe sure to check for a later version.\r\n\r\n\r\n  [1]: https://github.com/davidmoten/io-extras\r\n\r\n","title":"How do I convert an OutputStream to an InputStream?","body":"<p>The library <a href=\"https://github.com/davidmoten/io-extras\" rel=\"nofollow noreferrer\"><em>io-extras</em></a> may be useful. For example if you want to gzip an <code>InputStream</code> using <code>GZIPOutputStream</code> and you want it to happen <em>synchronously</em> (using the default buffer size of 8192):</p>\n\n<pre><code>InputStream is = ...\nInputStream gz = IOUtil.pipe(is, o -&gt; new GZIPOutputStream(o));\n</code></pre>\n\n<p>Note that the library has 100% unit test coverage (for what that's worth of course!) and is on Maven Central. The Maven dependency is:</p>\n\n<pre><code>&lt;dependency&gt;\n  &lt;groupId&gt;com.github.davidmoten&lt;/groupId&gt;\n  &lt;artifactId&gt;io-extras&lt;/artifactId&gt;\n  &lt;version&gt;0.1&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n\n<p>Be sure to check for a later version.</p>\n"},{"tags":[],"owner":{"account_id":5705055,"reputation":1872,"user_id":4508899,"accept_rate":75,"display_name":"Jonas_Hess"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1670506255,"creation_date":1670503881,"answer_id":74730588,"question_id":5778658,"body_markdown":"As some here have answered already, there is no efficient way to just ‘convert’ an OutputStream to an InputStream.  The trick to solve a problem like yours is to execute all code that requires the OutputStream into its own thread.  By using piped streams, we can then transfer the data out of the created thread over into an InputStream.\r\n\r\n\r\n**Example usage:**\r\n\r\n    public static InputStream downloadFileAsStream(final String uriString) throws IOException {\r\n            final InputStream inputStream = runInOwnThreadWithPipedStreams((outputStream) -&gt; {\r\n                try {\r\n                    downloadUriToStream(uriString, outputStream);\r\n                } catch (final Exception e) {\r\n                    LOGGER.error(&quot;Download of uri &#39;{}&#39; has failed&quot;, uriString, e);\r\n                }\r\n            });\r\n            return inputStream;\r\n        }\r\n\r\n\r\n\r\n**Helper function:**\r\n\r\n    public static InputStream runInOwnThreadWithPipedStreams(\r\n                final Consumer&lt;OutputStream&gt; outputStreamConsumer) throws IOException {\r\n            final PipedInputStream inputStream = new PipedInputStream();\r\n            final PipedOutputStream outputStream = new PipedOutputStream(inputStream);\r\n            new Thread(new Runnable() {\r\n                public void run() {\r\n                    try {\r\n                        outputStreamConsumer.accept(outputStream);\r\n                    } finally {\r\n                        try {\r\n                            outputStream.close();\r\n                        } catch (final IOException e) {\r\n                            LOGGER.error(&quot;Closing outputStream has failed. &quot;, e);\r\n                        }\r\n                    }\r\n                }\r\n            }).start();\r\n            return inputStream;\r\n        }\r\n\r\n**Unit Test:**\r\n\r\n    @Test\r\n    void testRunInOwnThreadWithPipedStreams() throws IOException {\r\n    \r\n        final InputStream inputStream = LoadFileUtil.runInOwnThreadWithPipedStreams((OutputStream outputStream) -&gt; {\r\n            try {\r\n                IOUtils.copy(IOUtils.toInputStream(&quot;Hello World&quot;, StandardCharsets.UTF_8), outputStream);\r\n            } catch (final IOException e) {\r\n                LoggerFactory.getLogger(LoadFileUtilTest.class).error(e.getMessage(), e);\r\n            }\r\n        });\r\n    \r\n        final String actualResult = IOUtils.toString(inputStream, StandardCharsets.UTF_8);\r\n        Assertions.assertEquals(&quot;Hello World&quot;, actualResult);\r\n    }","title":"How do I convert an OutputStream to an InputStream?","body":"<p>As some here have answered already, there is no efficient way to just ‘convert’ an OutputStream to an InputStream.  The trick to solve a problem like yours is to execute all code that requires the OutputStream into its own thread.  By using piped streams, we can then transfer the data out of the created thread over into an InputStream.</p>\n<p><strong>Example usage:</strong></p>\n<pre><code>public static InputStream downloadFileAsStream(final String uriString) throws IOException {\n        final InputStream inputStream = runInOwnThreadWithPipedStreams((outputStream) -&gt; {\n            try {\n                downloadUriToStream(uriString, outputStream);\n            } catch (final Exception e) {\n                LOGGER.error(&quot;Download of uri '{}' has failed&quot;, uriString, e);\n            }\n        });\n        return inputStream;\n    }\n</code></pre>\n<p><strong>Helper function:</strong></p>\n<pre><code>public static InputStream runInOwnThreadWithPipedStreams(\n            final Consumer&lt;OutputStream&gt; outputStreamConsumer) throws IOException {\n        final PipedInputStream inputStream = new PipedInputStream();\n        final PipedOutputStream outputStream = new PipedOutputStream(inputStream);\n        new Thread(new Runnable() {\n            public void run() {\n                try {\n                    outputStreamConsumer.accept(outputStream);\n                } finally {\n                    try {\n                        outputStream.close();\n                    } catch (final IOException e) {\n                        LOGGER.error(&quot;Closing outputStream has failed. &quot;, e);\n                    }\n                }\n            }\n        }).start();\n        return inputStream;\n    }\n</code></pre>\n<p><strong>Unit Test:</strong></p>\n<pre><code>@Test\nvoid testRunInOwnThreadWithPipedStreams() throws IOException {\n\n    final InputStream inputStream = LoadFileUtil.runInOwnThreadWithPipedStreams((OutputStream outputStream) -&gt; {\n        try {\n            IOUtils.copy(IOUtils.toInputStream(&quot;Hello World&quot;, StandardCharsets.UTF_8), outputStream);\n        } catch (final IOException e) {\n            LoggerFactory.getLogger(LoadFileUtilTest.class).error(e.getMessage(), e);\n        }\n    });\n\n    final String actualResult = IOUtils.toString(inputStream, StandardCharsets.UTF_8);\n    Assertions.assertEquals(&quot;Hello World&quot;, actualResult);\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1262646,"reputation":2597,"user_id":1220560,"display_name":"morgwai"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1688363793,"creation_date":1686262541,"answer_id":76436035,"question_id":5778658,"body_markdown":"In cases when your data is not very big, is **produced without any blocking operations and its overall size can be reasonably accurately estimated**, creating an additional thread for `PipedStream`s may be an unnecessary overhead. Using `ByteArrayStream`s the &quot;normal&quot; way, results in an unnecessary buffer copying in [ByteArrayOutputStream.toByteArray()](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/ByteArrayOutputStream.html#toByteArray()), but there&#39;s a trick to avoid it: the underlying buffer of `ByteArrayOutputStream` is a [protected field](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/ByteArrayOutputStream.html#buf) (meaning it&#39;s a part of Java&#39;s documented API and will not change), so you can create a simple subclass that gives you an access to it:\r\n```java\r\npublic class NoCopyByteArrayOutputStream extends ByteArrayOutputStream {\r\n  public byte[] getBuffer() { return buf; }\r\n  public NoCopyByteArrayOutputStream(int initialSize) { super(initialSize); }\r\n}\r\n```\r\nAfter that you can proceed in a similar way like with standard `ByteArrayStream`s:\r\n```java\r\nfinal var outputBytes = new NoCopyByteArrayOutputStream(estimatedSize);\r\n// produce data and output it to outputBytes here...\r\n\r\nfinal var inputBytes = new ByteArrayInputStream(\r\n        outputBytes.getBuffer(), 0, outputBytes.size())\r\n// consume data from inputBytes here...\r\n```\r\nNote that the buffer may be bigger, than the number of bytes that were actually written to `outputBytes` output stream, hence the the 3-param constructor [ByteArrayInputStream(bytes, offset, length)](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/ByteArrayInputStream.html#%3Cinit%3E(byte%5B%5D,int,int)) must be used and `length` value obtained from `outputBytes`&#39;s size.\r\n\r\nRemember that if your data production process involves any blocking operations (like network I/O or even reading from a local file), you should **definitely** use `PipedStream`s (as described in [the other answer](https://stackoverflow.com/a/23874232/1220560)) to not delay unnecessarily partial data consumption from `inputBytes`.  \r\nSecondly, if you heavily underestimate the amount of data and pass significantly too low `initialSize` to the constructor of `NoCopyByteArrayOutputStream`, it will also have **significant performance consequences** due to repeated buffer extending, which involves copying of the whole data that was written up till the given point (hence the paramless constructor was not provided, as it doesn&#39;t make sense to use this class if the data size cannot be estimated with a reasonable accuracy).  \r\nFinally, if the data passed between streams is big, then `PipedStream`s will usually be much more efficient in terms of memory, provided that the reading thread does not get blocked too much and generally reads the data &quot;on the fly&quot; as soon as it appears.","title":"How do I convert an OutputStream to an InputStream?","body":"<p>In cases when your data is not very big, is <strong>produced without any blocking operations and its overall size can be reasonably accurately estimated</strong>, creating an additional thread for <code>PipedStream</code>s may be an unnecessary overhead. Using <code>ByteArrayStream</code>s the &quot;normal&quot; way, results in an unnecessary buffer copying in <a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/ByteArrayOutputStream.html#toByteArray()\" rel=\"nofollow noreferrer\">ByteArrayOutputStream.toByteArray()</a>, but there's a trick to avoid it: the underlying buffer of <code>ByteArrayOutputStream</code> is a <a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/ByteArrayOutputStream.html#buf\" rel=\"nofollow noreferrer\">protected field</a> (meaning it's a part of Java's documented API and will not change), so you can create a simple subclass that gives you an access to it:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class NoCopyByteArrayOutputStream extends ByteArrayOutputStream {\n  public byte[] getBuffer() { return buf; }\n  public NoCopyByteArrayOutputStream(int initialSize) { super(initialSize); }\n}\n</code></pre>\n<p>After that you can proceed in a similar way like with standard <code>ByteArrayStream</code>s:</p>\n<pre class=\"lang-java prettyprint-override\"><code>final var outputBytes = new NoCopyByteArrayOutputStream(estimatedSize);\n// produce data and output it to outputBytes here...\n\nfinal var inputBytes = new ByteArrayInputStream(\n        outputBytes.getBuffer(), 0, outputBytes.size())\n// consume data from inputBytes here...\n</code></pre>\n<p>Note that the buffer may be bigger, than the number of bytes that were actually written to <code>outputBytes</code> output stream, hence the the 3-param constructor <a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/ByteArrayInputStream.html#%3Cinit%3E(byte%5B%5D,int,int)\" rel=\"nofollow noreferrer\">ByteArrayInputStream(bytes, offset, length)</a> must be used and <code>length</code> value obtained from <code>outputBytes</code>'s size.</p>\n<p>Remember that if your data production process involves any blocking operations (like network I/O or even reading from a local file), you should <strong>definitely</strong> use <code>PipedStream</code>s (as described in <a href=\"https://stackoverflow.com/a/23874232/1220560\">the other answer</a>) to not delay unnecessarily partial data consumption from <code>inputBytes</code>.<br />\nSecondly, if you heavily underestimate the amount of data and pass significantly too low <code>initialSize</code> to the constructor of <code>NoCopyByteArrayOutputStream</code>, it will also have <strong>significant performance consequences</strong> due to repeated buffer extending, which involves copying of the whole data that was written up till the given point (hence the paramless constructor was not provided, as it doesn't make sense to use this class if the data size cannot be estimated with a reasonable accuracy).<br />\nFinally, if the data passed between streams is big, then <code>PipedStream</code>s will usually be much more efficient in terms of memory, provided that the reading thread does not get blocked too much and generally reads the data &quot;on the fly&quot; as soon as it appears.</p>\n"}],"owner":{"account_id":242438,"reputation":17413,"user_id":513956,"accept_rate":77,"display_name":"Waypoint"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":446051,"favorite_count":0,"down_vote_count":1,"up_vote_count":420,"accepted_answer_id":5778863,"answer_count":14,"score":419,"last_activity_date":1694805601,"creation_date":1303737117,"question_id":5778658,"body_markdown":"I am on the stage of development where I have two modules and from one I got output as a `OutputStream`, and a second one which accepts only `InputStream`.\r\n\r\nDo you know how to convert `OutputStream` to `InputStream` (not vice versa, I mean really this way) so that I am able to connect these two parts?\r\n","title":"How do I convert an OutputStream to an InputStream?","body":"<p>I am on the stage of development where I have two modules and from one I got output as a <code>OutputStream</code>, and a second one which accepts only <code>InputStream</code>.</p>\n<p>Do you know how to convert <code>OutputStream</code> to <code>InputStream</code> (not vice versa, I mean really this way) so that I am able to connect these two parts?</p>\n"},{"tags":["java","random","secure-random"],"answers":[{"tags":[],"owner":{"account_id":8584600,"reputation":801,"user_id":6431178,"accept_rate":50,"display_name":"Marco A. Hernandez"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1468335980,"creation_date":1468335980,"answer_id":38332674,"question_id":38331113,"body_markdown":"The constructor \r\n\r\n    protected SecureRandom(SecureRandomSpi secureRandomSpi, Provider provider) \r\n\r\nis protected, you shouldn&#39;t use it. Use instead \r\n\r\n    public static SecureRandom getInstance(String algorithm)\r\n\r\nIf you have defined your own algorithm you must Create a Provider and register it so when you specify the name of the algorithm, the jre can find it. But you probably want to use a existig one.\r\n\r\nHowever, if you have created your own crypto algorithm just use it instead of encapsulate into SecureRandom API. If its good enought sure some Provider will pay to you to add it to its API ;D","title":"SecureRandom custom algorithm","body":"<p>The constructor </p>\n\n<pre><code>protected SecureRandom(SecureRandomSpi secureRandomSpi, Provider provider) \n</code></pre>\n\n<p>is protected, you shouldn't use it. Use instead </p>\n\n<pre><code>public static SecureRandom getInstance(String algorithm)\n</code></pre>\n\n<p>If you have defined your own algorithm you must Create a Provider and register it so when you specify the name of the algorithm, the jre can find it. But you probably want to use a existig one.</p>\n\n<p>However, if you have created your own crypto algorithm just use it instead of encapsulate into SecureRandom API. If its good enought sure some Provider will pay to you to add it to its API ;D</p>\n"},{"tags":[],"owner":{"account_id":13060408,"reputation":707,"user_id":9437799,"display_name":"Sam Ginrich"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694805599,"creation_date":1694805599,"answer_id":77114894,"question_id":38331113,"body_markdown":"Late answer: **Yes** it is possible.\r\n\r\nFirst I want to note, that I see a real usecase for having a custom random generator:\r\n\r\n 1. Providers of random generators have not had best press, e.g. [...paid RSA to make flawed crypto algorithm the default][1]. From this (story true of not true, intended or not) there should not be a blind trust decision in any provider. Flaws of single random generators may be elimintated by combining several generators from independent sources; e.g. *Random.org* might be conisdered as second source or a generator coming from an different algebraic class of pseudo random algorithms.\r\n 2. The regular procedure to integrate a random generator into a Java Runtime Environment is developping Provider + Algorithm class and getting it certified + system administration; a huge effort with additional constraints in context of *just* doing some testing. \r\n\r\n\r\nHere is an example with a SecureRandom subclass.\r\n\r\n    import java.security.NoSuchAlgorithmException;\r\n    import java.security.SecureRandom;\r\n    import java.security.SecureRandomSpi;\r\n    import java.util.Arrays;\r\n    \r\n    /**\r\n     * Combine several SecureRandom Generators\r\n     * \r\n     * @author Sam Ginrich\r\n     *\r\n     */\r\n    public class CombinedRnd extends SecureRandom\r\n    {\r\n    \r\n    \tprivate static class CombiSpi extends SecureRandomSpi\r\n    \t{\r\n    \r\n    \t\tCombiSpi(SecureRandom[] parts)\r\n    \t\t{\r\n    \t\t\tthis.parts = parts;\r\n    \t\t}\r\n    \r\n    \t\t@Override\r\n    \t\tprotected void engineSetSeed(byte[] seed)\r\n    \t\t{\r\n    \t\t\tparts[0].setSeed(seed);\r\n    \t\t}\r\n    \r\n    \t\t@Override\r\n    \t\tprotected void engineNextBytes(byte[] bytes)\r\n    \t\t{\r\n    \t\t\tArrays.fill(bytes, (byte) 0);\r\n    \t\t\tint len = bytes.length;\r\n    \t\t\tbyte[] buf = new byte[len];\r\n    \t\t\tfor (SecureRandom r : parts)\r\n    \t\t\t{\r\n    \t\t\t\tr.nextBytes(buf);\r\n    \t\t\t\tfor (int j = 0; j &lt; len; j++)\r\n    \t\t\t\t{\r\n    \t\t\t\t\tbytes[j] ^= buf[j];\r\n    \t\t\t\t}\r\n    \t\t\t}\r\n    \t\t}\r\n    \r\n    \t\t@Override\r\n    \t\tprotected byte[] engineGenerateSeed(int numBytes)\r\n    \t\t{\r\n    \t\t\treturn null;\r\n    \t\t}\r\n    \r\n    \t\tSecureRandom[] parts;\r\n    \r\n    \t\tprivate static final long serialVersionUID = -487720505474870937L;\r\n    \r\n    \t}\r\n    \r\n    \tpublic CombinedRnd(SecureRandom... parts)\r\n    \t{\r\n    \t\tsuper(createSPI(parts), null);\r\n    \t}\r\n    \r\n    \tstatic SecureRandomSpi createSPI(SecureRandom[] parts)\r\n    \t{\r\n    \t\treturn new CombiSpi(parts);\r\n    \t}\r\n    \r\n    \tpublic static void main(String... args) throws NoSuchAlgorithmException\r\n    \t{\r\n    \t\tSecureRandom[] sources = { SecureRandom.getInstance(&quot;SHA1PRNG&quot;), SecureRandom.getInstance(&quot;Windows-PRNG&quot;) };\r\n    \t\tCombinedRnd secRnd = new CombinedRnd(sources);\r\n\r\n    \t\tbyte[] rndBytes = new byte[17];\r\n    \t\tsecRnd.nextBytes(rndBytes);\r\n\r\n    \t\tfor (byte r : rndBytes)\r\n    \t\t{\r\n    \t\t\tSystem.out.print(String.format(&quot;%02x &quot;, r &amp; 0xFF));\r\n    \t\t}\r\n    \t\tSystem.out.println();\r\n    \t}\r\n    \r\n    \tprivate static final long serialVersionUID = -7550189683373026294L;\r\n    \r\n    }\r\n\r\n  [1]: https://arstechnica.com/information-technology/2013/12/report-nsa-paid-rsa-to-make-flawed-crypto-algorithm-the-default/\r\n\r\n","title":"SecureRandom custom algorithm","body":"<p>Late answer: <strong>Yes</strong> it is possible.</p>\n<p>First I want to note, that I see a real usecase for having a custom random generator:</p>\n<ol>\n<li>Providers of random generators have not had best press, e.g. <a href=\"https://arstechnica.com/information-technology/2013/12/report-nsa-paid-rsa-to-make-flawed-crypto-algorithm-the-default/\" rel=\"nofollow noreferrer\">...paid RSA to make flawed crypto algorithm the default</a>. From this (story true of not true, intended or not) there should not be a blind trust decision in any provider. Flaws of single random generators may be elimintated by combining several generators from independent sources; e.g. <em>Random.org</em> might be conisdered as second source or a generator coming from an different algebraic class of pseudo random algorithms.</li>\n<li>The regular procedure to integrate a random generator into a Java Runtime Environment is developping Provider + Algorithm class and getting it certified + system administration; a huge effort with additional constraints in context of <em>just</em> doing some testing.</li>\n</ol>\n<p>Here is an example with a SecureRandom subclass.</p>\n<pre><code>import java.security.NoSuchAlgorithmException;\nimport java.security.SecureRandom;\nimport java.security.SecureRandomSpi;\nimport java.util.Arrays;\n\n/**\n * Combine several SecureRandom Generators\n * \n * @author Sam Ginrich\n *\n */\npublic class CombinedRnd extends SecureRandom\n{\n\n    private static class CombiSpi extends SecureRandomSpi\n    {\n\n        CombiSpi(SecureRandom[] parts)\n        {\n            this.parts = parts;\n        }\n\n        @Override\n        protected void engineSetSeed(byte[] seed)\n        {\n            parts[0].setSeed(seed);\n        }\n\n        @Override\n        protected void engineNextBytes(byte[] bytes)\n        {\n            Arrays.fill(bytes, (byte) 0);\n            int len = bytes.length;\n            byte[] buf = new byte[len];\n            for (SecureRandom r : parts)\n            {\n                r.nextBytes(buf);\n                for (int j = 0; j &lt; len; j++)\n                {\n                    bytes[j] ^= buf[j];\n                }\n            }\n        }\n\n        @Override\n        protected byte[] engineGenerateSeed(int numBytes)\n        {\n            return null;\n        }\n\n        SecureRandom[] parts;\n\n        private static final long serialVersionUID = -487720505474870937L;\n\n    }\n\n    public CombinedRnd(SecureRandom... parts)\n    {\n        super(createSPI(parts), null);\n    }\n\n    static SecureRandomSpi createSPI(SecureRandom[] parts)\n    {\n        return new CombiSpi(parts);\n    }\n\n    public static void main(String... args) throws NoSuchAlgorithmException\n    {\n        SecureRandom[] sources = { SecureRandom.getInstance(&quot;SHA1PRNG&quot;), SecureRandom.getInstance(&quot;Windows-PRNG&quot;) };\n        CombinedRnd secRnd = new CombinedRnd(sources);\n\n        byte[] rndBytes = new byte[17];\n        secRnd.nextBytes(rndBytes);\n\n        for (byte r : rndBytes)\n        {\n            System.out.print(String.format(&quot;%02x &quot;, r &amp; 0xFF));\n        }\n        System.out.println();\n    }\n\n    private static final long serialVersionUID = -7550189683373026294L;\n\n}\n</code></pre>\n"}],"owner":{"account_id":1192771,"reputation":887,"user_id":1165190,"accept_rate":82,"display_name":"Alvins"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":998,"favorite_count":0,"down_vote_count":0,"up_vote_count":4,"answer_count":2,"score":4,"last_activity_date":1694805599,"creation_date":1468332102,"question_id":38331113,"body_markdown":"For testing purpose I need to use `SecureRandom` with a custom algorithm. How is it possible?\r\n\r\nI think I have to subclass `SecureRandom` and provide a `SecureRandomSpi` custom implementation:\r\n\r\n     167:   /**\r\n     168:      A constructor for SecureRandom. It constructs a new \r\n     169:      SecureRandom using the specified SecureRandomSpi from\r\n     170:      the specified security provier. \r\n     171: \r\n     172:      @param secureRandomSpi A SecureRandomSpi class\r\n     173:      @param provider A Provider class\r\n     174:    */\r\n     175:   protected SecureRandom(SecureRandomSpi secureRandomSpi, Provider provider)\r\n     176:   {\r\n     177:     this(secureRandomSpi, provider, &quot;unknown&quot;);\r\n     178:   }\r\n\r\nIs there a simple way or can anyone provide ad example?","title":"SecureRandom custom algorithm","body":"<p>For testing purpose I need to use <code>SecureRandom</code> with a custom algorithm. How is it possible?</p>\n\n<p>I think I have to subclass <code>SecureRandom</code> and provide a <code>SecureRandomSpi</code> custom implementation:</p>\n\n<pre><code> 167:   /**\n 168:      A constructor for SecureRandom. It constructs a new \n 169:      SecureRandom using the specified SecureRandomSpi from\n 170:      the specified security provier. \n 171: \n 172:      @param secureRandomSpi A SecureRandomSpi class\n 173:      @param provider A Provider class\n 174:    */\n 175:   protected SecureRandom(SecureRandomSpi secureRandomSpi, Provider provider)\n 176:   {\n 177:     this(secureRandomSpi, provider, \"unknown\");\n 178:   }\n</code></pre>\n\n<p>Is there a simple way or can anyone provide ad example?</p>\n"},{"tags":["java","cxf"],"comments":[{"owner":{"account_id":3391382,"reputation":3687,"user_id":2846138,"display_name":"cyberbrain"},"score":0,"creation_date":1694756905,"post_id":77109860,"comment_id":135935639,"body_markdown":"Which XML are you deserializing that triggers the exception? Please add it to the question.","body":"Which XML are you deserializing that triggers the exception? Please add it to the question."}],"owner":{"account_id":18578317,"reputation":21,"user_id":13538395,"display_name":"Stackforumuser"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":15,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694804838,"creation_date":1694756216,"question_id":77109860,"body_markdown":"Application A provides the SOAP service endpoint and Application B is the consumer. Application A sends a response ProdDTO\r\n\r\n    class ProdDTO {\r\n        private String a1;\r\n        private String h1;\r\n        private String t1;\r\n    }\r\n\r\nThe consumer is using the following plugin to generate sources from the WSDL\r\n\r\n    &lt;plugin&gt;\r\n    &lt;groupId&gt;org.apache.cxf&lt;/groupId&gt;\r\n    &lt;artifactId&gt;cxf-codegen-plugin&lt;/artifactId&gt;\r\n    &lt;configuration&gt;\r\n    \r\n    &lt;wsdlOptions&gt;\r\n    \t&lt;wsdlOption&gt;\r\n    \t\t&lt;wsdl&gt;wsdl2022&lt;/wsdl&gt;\r\n    \t&lt;/wsdlOption&gt;\r\n    &lt;/wsdloptions&gt;\r\n\r\nThe consumer has been using WSDL since 2022. The generated DTO looks like\r\n\r\n    @XmlAccessorType(XmlAccessType.FIELD)\r\n    @XmlType(name = &quot;prodDTO&quot;, propOrder = { &quot;a1&quot;,&quot;h1&quot;,&quot;t1&quot; })\r\n    public class ProdDTO\r\n    {\r\n        protected String a1;\r\n        protected String h1;\r\n        protected String t1;\r\n    }\r\n      \r\n\r\n Application A added fields to ProdDTO since then\r\n\r\n    private String c1;\r\n    private string s1;\r\n\r\nand there was no issue from the consumer.\r\n\r\nApplication A added recently the below field to ProdDTO\r\n\r\n    private String z1;\r\n\r\nNow the consumer throws error::\r\n```\r\njavax.xml.ws.soap.SOAPFaultException: Unmarshalling Error: unexpected element (uri:&quot;&quot;, local:&quot;z1&quot;).\r\n Expected elements are &lt;{}a1&gt;,&lt;{}h1&gt;,&lt;{}t1&gt;\r\n```\r\nWhy &quot;z1&quot; field raise an error but &quot;c1&quot; and &quot;s1&quot; did not? Does it have to do with propOrder? How do we resolve the issue? The consumer has some restrictions right now and is reluctant to change the code. So what can be done in Application A to resolve this issue? Thanks in advance for any help\r\n\r\n","title":"CXF Unmarshalling error: Unexpected Element","body":"<p>Application A provides the SOAP service endpoint and Application B is the consumer. Application A sends a response ProdDTO</p>\n<pre><code>class ProdDTO {\n    private String a1;\n    private String h1;\n    private String t1;\n}\n</code></pre>\n<p>The consumer is using the following plugin to generate sources from the WSDL</p>\n<pre><code>&lt;plugin&gt;\n&lt;groupId&gt;org.apache.cxf&lt;/groupId&gt;\n&lt;artifactId&gt;cxf-codegen-plugin&lt;/artifactId&gt;\n&lt;configuration&gt;\n\n&lt;wsdlOptions&gt;\n    &lt;wsdlOption&gt;\n        &lt;wsdl&gt;wsdl2022&lt;/wsdl&gt;\n    &lt;/wsdlOption&gt;\n&lt;/wsdloptions&gt;\n</code></pre>\n<p>The consumer has been using WSDL since 2022. The generated DTO looks like</p>\n<pre><code>@XmlAccessorType(XmlAccessType.FIELD)\n@XmlType(name = &quot;prodDTO&quot;, propOrder = { &quot;a1&quot;,&quot;h1&quot;,&quot;t1&quot; })\npublic class ProdDTO\n{\n    protected String a1;\n    protected String h1;\n    protected String t1;\n}\n  \n</code></pre>\n<p>Application A added fields to ProdDTO since then</p>\n<pre><code>private String c1;\nprivate string s1;\n</code></pre>\n<p>and there was no issue from the consumer.</p>\n<p>Application A added recently the below field to ProdDTO</p>\n<pre><code>private String z1;\n</code></pre>\n<p>Now the consumer throws error::</p>\n<pre><code>javax.xml.ws.soap.SOAPFaultException: Unmarshalling Error: unexpected element (uri:&quot;&quot;, local:&quot;z1&quot;).\n Expected elements are &lt;{}a1&gt;,&lt;{}h1&gt;,&lt;{}t1&gt;\n</code></pre>\n<p>Why &quot;z1&quot; field raise an error but &quot;c1&quot; and &quot;s1&quot; did not? Does it have to do with propOrder? How do we resolve the issue? The consumer has some restrictions right now and is reluctant to change the code. So what can be done in Application A to resolve this issue? Thanks in advance for any help</p>\n"},{"tags":["java","calendar"],"comments":[{"owner":{"account_id":1441481,"reputation":10825,"user_id":1361506,"display_name":"azurefrog"},"score":0,"creation_date":1400795275,"post_id":23817522,"comment_id":36641723,"body_markdown":"If it&#39;s truly an optional field, why do you have places all over your code trying to pull the value out?  Just encapsulate the behavior into the owning class with a decent default when the calendar isn&#39;t set, and get rid of `getCal()`.","body":"If it&#39;s truly an optional field, why do you have places all over your code trying to pull the value out?  Just encapsulate the behavior into the owning class with a decent default when the calendar isn&#39;t set, and get rid of <code>getCal()</code>."},{"owner":{"account_id":1869831,"reputation":4089,"user_id":1692341,"accept_rate":90,"display_name":"Steffen"},"score":0,"creation_date":1400795289,"post_id":23817522,"comment_id":36641729,"body_markdown":"https://stackoverflow.com/questions/271526/avoiding-null-statements-in-java","body":"<a href=\"https://stackoverflow.com/questions/271526/avoiding-null-statements-in-java\" title=\"avoiding null statements in java\">stackoverflow.com/questions/271526/&hellip;</a>"}],"answers":[{"tags":[],"owner":{"account_id":1218491,"reputation":1431,"user_id":1185614,"display_name":"lpratlong"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1400795806,"creation_date":1400795086,"answer_id":23817573,"question_id":23817522,"body_markdown":"If `setCal` is not called and so if `cal` is not set, why do you want to send other thing than `null` ?\r\n`null` is the best thing to return in this case. Null is also a value, which give an indication to the developper.\r\nAnd, because developpers don&#39;t know that your `getCal` can&#39;t return null, they will check for null even if you never return null (I assume that for getter and setter, developpers don&#39;t read javadoc).\r\n\r\nMaybe you can send a new instance of default Calendar. But default value is the current date, so I don&#39;t think it&#39;s a good idea since it does not represent the fact that the Calendar has not been set.\r\n\r\nOr you can throw an exception... but do not abuse of Exception. Exception are designed to defined error or bad behavior, not to simplify functionnal checks.\r\nHowever, to protect the `setCal` method of null value, here you can throw an `IllegalArgumentException` if user set null value.","title":"Calendar Null Object","body":"<p>If <code>setCal</code> is not called and so if <code>cal</code> is not set, why do you want to send other thing than <code>null</code> ?\n<code>null</code> is the best thing to return in this case. Null is also a value, which give an indication to the developper.\nAnd, because developpers don't know that your <code>getCal</code> can't return null, they will check for null even if you never return null (I assume that for getter and setter, developpers don't read javadoc).</p>\n\n<p>Maybe you can send a new instance of default Calendar. But default value is the current date, so I don't think it's a good idea since it does not represent the fact that the Calendar has not been set.</p>\n\n<p>Or you can throw an exception... but do not abuse of Exception. Exception are designed to defined error or bad behavior, not to simplify functionnal checks.\nHowever, to protect the <code>setCal</code> method of null value, here you can throw an <code>IllegalArgumentException</code> if user set null value.</p>\n"},{"tags":[],"owner":{"account_id":3527115,"reputation":415,"user_id":2947886,"display_name":"A. Agarwal"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1400795307,"creation_date":1400795307,"answer_id":23817623,"question_id":23817522,"body_markdown":"would something like this fix your problem ?\r\n\r\n    public Calendar getCal() {\r\n        if (cal != null)\r\n            return cal;\r\n        return Calendar.getInstance(); // to be returned when cal is null\r\n    }","title":"Calendar Null Object","body":"<p>would something like this fix your problem ?</p>\n\n<pre><code>public Calendar getCal() {\n    if (cal != null)\n        return cal;\n    return Calendar.getInstance(); // to be returned when cal is null\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":438405,"reputation":6101,"user_id":826657,"accept_rate":91,"display_name":"Rachit Mishra"},"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1400795312,"creation_date":1400795312,"answer_id":23817626,"question_id":23817522,"body_markdown":"Returning null and null checks are best bet here, other wise, what you may do is \r\n\r\nInitialize the Calendar to today, if that fits your scenario.\r\n\r\nor \r\n\r\nThrow an exception and ask to set the Calendar.","title":"Calendar Null Object","body":"<p>Returning null and null checks are best bet here, other wise, what you may do is </p>\n\n<p>Initialize the Calendar to today, if that fits your scenario.</p>\n\n<p>or </p>\n\n<p>Throw an exception and ask to set the Calendar.</p>\n"},{"tags":[],"owner":{"account_id":1908808,"reputation":1499,"user_id":1723135,"display_name":"jurassix"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1400795397,"creation_date":1400795397,"answer_id":23817648,"question_id":23817522,"body_markdown":"Just add a default value to the property:\r\n\r\n    private Calendar cal = Calendar.getInstance();","title":"Calendar Null Object","body":"<p>Just add a default value to the property:</p>\n\n<pre><code>private Calendar cal = Calendar.getInstance();\n</code></pre>\n"},{"tags":[],"owner":{"account_id":3433587,"reputation":13,"user_id":2877228,"display_name":"user2877228"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1400797139,"creation_date":1400797139,"answer_id":23817998,"question_id":23817522,"body_markdown":"If you are against doing checks for null all over your code, you could implement something like this:\r\n\r\n        public boolean hasCal(){\r\n            if(this.cal == null){\r\n                return false;\r\n            }\r\n            return true;\r\n        }\r\n\r\nThis would make your code more readable, but you would still have to have `getCal()` return something even if the `Test` object does not have one, and returning `null` seems to be the best option in this case.\r\n\r\n","title":"Calendar Null Object","body":"<p>If you are against doing checks for null all over your code, you could implement something like this:</p>\n\n<pre><code>    public boolean hasCal(){\n        if(this.cal == null){\n            return false;\n        }\n        return true;\n    }\n</code></pre>\n\n<p>This would make your code more readable, but you would still have to have <code>getCal()</code> return something even if the <code>Test</code> object does not have one, and returning <code>null</code> seems to be the best option in this case.</p>\n"},{"tags":[],"owner":{"account_id":4132913,"reputation":132,"user_id":3390291,"display_name":"Firas Moalla"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1400797196,"creation_date":1400797196,"answer_id":23818012,"question_id":23817522,"body_markdown":"The context of your code is not clear, returning null can be advantageous depending on the context. But in general, when you&#39;re trying to say &quot;I have no information to give back&quot;, then returning null clearly shows it. Additionally it makes it easier for others to observe that.\r\n\r\n&gt;is there any option rather than returning null.\r\n\r\nIn fact, there are many other ways; it depends on the context. An alternative example is the &#39;[Option Pattern](http://en.wikipedia.org/wiki/Option_type)&#39;. Which its idea relies on encapsulating an optional value; either None or the original data. This way you could return a meaningful value (which is heavily used in Haskell, and to some extent Scala). Although, it should be done with care as returning an encapsulation that indicates &#39;empty&#39; may not be noticed unless carefully documented and agreed with as a convention (with your team for instance).","title":"Calendar Null Object","body":"<p>The context of your code is not clear, returning null can be advantageous depending on the context. But in general, when you're trying to say \"I have no information to give back\", then returning null clearly shows it. Additionally it makes it easier for others to observe that.</p>\n\n<blockquote>\n  <p>is there any option rather than returning null.</p>\n</blockquote>\n\n<p>In fact, there are many other ways; it depends on the context. An alternative example is the '<a href=\"http://en.wikipedia.org/wiki/Option_type\" rel=\"nofollow\">Option Pattern</a>'. Which its idea relies on encapsulating an optional value; either None or the original data. This way you could return a meaningful value (which is heavily used in Haskell, and to some extent Scala). Although, it should be done with care as returning an encapsulation that indicates 'empty' may not be noticed unless carefully documented and agreed with as a convention (with your team for instance).</p>\n"}],"owner":{"account_id":788725,"reputation":2193,"user_id":856951,"accept_rate":56,"display_name":"vjk"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":9570,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":6,"score":0,"last_activity_date":1694804761,"creation_date":1400794836,"question_id":23817522,"body_markdown":"    public class Test {\r\n        \r\n        //required fields\r\n        private String str1;\r\n        private String str2;\r\n        \r\n        //optional\r\n        private Calendar cal;\r\n        \r\n        public Test(String a, String b){\r\n            str1 = a;\r\n            str2 = b;\r\n        }\r\n        \r\n        //getter for str1 and str2\r\n        \r\n        public void setCal(Calendar cal){\r\n            this.cal = cal;\r\n        }\r\n        \r\n        public Calendar getCal() {\r\n            return cal;\r\n        }\r\n    }\r\n\r\nI have a class like this where the calendar object is optional. If setCal() is not called and some one calls the getCal() method, is there any option rather than returning null. If a null is returned then I have to do null checks every where. Is there any class that extends calendar without doing anything like Null Object Pattern.\r\n\r\nWhats the best option over here when getCal() is called?","title":"Calendar Null Object","body":"<pre><code>public class Test {\n\n    //required fields\n    private String str1;\n    private String str2;\n\n    //optional\n    private Calendar cal;\n\n    public Test(String a, String b){\n        str1 = a;\n        str2 = b;\n    }\n\n    //getter for str1 and str2\n\n    public void setCal(Calendar cal){\n        this.cal = cal;\n    }\n\n    public Calendar getCal() {\n        return cal;\n    }\n}\n</code></pre>\n\n<p>I have a class like this where the calendar object is optional. If setCal() is not called and some one calls the getCal() method, is there any option rather than returning null. If a null is returned then I have to do null checks every where. Is there any class that extends calendar without doing anything like Null Object Pattern.</p>\n\n<p>Whats the best option over here when getCal() is called?</p>\n"},{"tags":["java","selenium","azure-devops","cucumber","cucumber-java"],"answers":[{"tags":[],"owner":{"account_id":16448039,"reputation":28229,"user_id":11882186,"display_name":"Levi Lu-MSFT"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1597311593,"creation_date":1597311593,"answer_id":63392320,"question_id":63374449,"body_markdown":"I afraid there is not a plugin available to show the screenshot in azure report currently. For the screenshot is generated in the .html cucumber report. And azure devops doesnot support publishing generic HTML in build/release pipeline. \r\n\r\nI guess the test result you saw is under the **Tests** tab of the azure pipeline build result page. And it is the xml format report which has been published to azure devops, not the html report which contains the screenshots.  \r\n\r\nThere is [feature request][1] regarding this issue which has been submitted to microsoft develop team. You can go vote on it or create one of your own.\r\n\r\nAs a workaround, you can use the [publish build artifacts task][2] to publish the screenshots as artifacts of the pipeline.\r\n\r\n    steps:\r\n    - task: PublishBuildArtifacts@1\r\n      displayName: &#39;Publish Artifact: TestScreenshots&#39;\r\n      inputs:\r\n        PathtoPublish: &#39;$(System.defaultworkingdirectory)/target/home-page-html&#39; #path to the test result folder(ie. html:target/home-page-html)\r\n        ArtifactName: TestScreenshots\r\n\r\n\r\nThen you can get the screenshots from the build **Summary** page, See below: \r\n\r\nIf the screenshots reside in multiple test result folders. You can use [copy files task][3] to copy the screenshots to a place and then publish to build artifacts.\r\n\r\n[![enter image description here][4]][4] \r\n\r\n\r\n  [1]: https://developercommunity.visualstudio.com/idea/491426/support-for-generic-html-publishing-inside-build-a.html\r\n  [2]: https://learn.microsoft.com/en-us/azure/devops/pipelines/tasks/utility/publish-build-artifacts?view=azure-devops\r\n  [3]: https://learn.microsoft.com/en-us/azure/devops/pipelines/tasks/utility/copy-files?view=azure-devops&amp;tabs=yaml\r\n  [4]: https://i.stack.imgur.com/7rdkO.png","title":"How to attach screenshot to azure report for selenium java cucumber","body":"<p>I afraid there is not a plugin available to show the screenshot in azure report currently. For the screenshot is generated in the .html cucumber report. And azure devops doesnot support publishing generic HTML in build/release pipeline.</p>\n<p>I guess the test result you saw is under the <strong>Tests</strong> tab of the azure pipeline build result page. And it is the xml format report which has been published to azure devops, not the html report which contains the screenshots.</p>\n<p>There is <a href=\"https://developercommunity.visualstudio.com/idea/491426/support-for-generic-html-publishing-inside-build-a.html\" rel=\"nofollow noreferrer\">feature request</a> regarding this issue which has been submitted to microsoft develop team. You can go vote on it or create one of your own.</p>\n<p>As a workaround, you can use the <a href=\"https://learn.microsoft.com/en-us/azure/devops/pipelines/tasks/utility/publish-build-artifacts?view=azure-devops\" rel=\"nofollow noreferrer\">publish build artifacts task</a> to publish the screenshots as artifacts of the pipeline.</p>\n<pre><code>steps:\n- task: PublishBuildArtifacts@1\n  displayName: 'Publish Artifact: TestScreenshots'\n  inputs:\n    PathtoPublish: '$(System.defaultworkingdirectory)/target/home-page-html' #path to the test result folder(ie. html:target/home-page-html)\n    ArtifactName: TestScreenshots\n</code></pre>\n<p>Then you can get the screenshots from the build <strong>Summary</strong> page, See below:</p>\n<p>If the screenshots reside in multiple test result folders. You can use <a href=\"https://learn.microsoft.com/en-us/azure/devops/pipelines/tasks/utility/copy-files?view=azure-devops&amp;tabs=yaml\" rel=\"nofollow noreferrer\">copy files task</a> to copy the screenshots to a place and then publish to build artifacts.</p>\n<p><a href=\"https://i.stack.imgur.com/7rdkO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7rdkO.png\" alt=\"enter image description here\" /></a></p>\n"},{"tags":[],"owner":{"account_id":29455322,"reputation":1,"user_id":22571325,"display_name":"susanE"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694804203,"creation_date":1694804203,"answer_id":77114776,"question_id":63374449,"body_markdown":"For a while now, you have been say that there is currently no way to include screenshots (or user comments) in the test plan report pdf.  The fact that people keep asking this question should show you that SUCH FUNCTIONALITY IS NEEDED!  Many, many businesses that answer to regulatory bodies MUST be able to produce test results ON PAPER that include screenshots and user comments.  As it currently is, when someone asks me about the Azure testing module, I have to say that it might be good if we could do something about the reports.  But since we cannot, I cannot recommend Azure DevOps at all.\r\n","title":"How to attach screenshot to azure report for selenium java cucumber","body":"<p>For a while now, you have been say that there is currently no way to include screenshots (or user comments) in the test plan report pdf.  The fact that people keep asking this question should show you that SUCH FUNCTIONALITY IS NEEDED!  Many, many businesses that answer to regulatory bodies MUST be able to produce test results ON PAPER that include screenshots and user comments.  As it currently is, when someone asks me about the Azure testing module, I have to say that it might be good if we could do something about the reports.  But since we cannot, I cannot recommend Azure DevOps at all.</p>\n"}],"owner":{"account_id":13116828,"reputation":35,"user_id":9475724,"display_name":"abhilash mt"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1587,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":63392320,"answer_count":2,"score":0,"last_activity_date":1694804203,"creation_date":1597227380,"question_id":63374449,"body_markdown":"I am running my selenium java test suit in azure devops, after the execution i am able to see the result, but there is no attachment of failed screenshots. But when i run it in the local machine the cucumber report which is generating contains the screenshot.\r\n\r\nBelow is the code i have used to attach screenshot\r\n```\r\n@AfterStep\r\n\tpublic void embedScreenshot(Scenario scenario) throws Exception {\r\n\t\tif (scenario.isFailed()) {\r\n\t\t\ttry {\r\n\t\t\t\tbyte[] scrFile = ((TakesScreenshot) driver).getScreenshotAs(OutputType.BYTES);\r\n\t\t\t\tscenario.embed(scrFile, &quot;image/png&quot;);\r\n\t\t\t} catch (WebDriverException somePlatformsDontSupportScreenshots) {\r\n\t\t\t\tSystem.err.println(somePlatformsDontSupportScreenshots.getMessage());\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n```\r\n\r\nIs there any plugin or anything else i can use to show the failed screenshot in the azure report?","title":"How to attach screenshot to azure report for selenium java cucumber","body":"<p>I am running my selenium java test suit in azure devops, after the execution i am able to see the result, but there is no attachment of failed screenshots. But when i run it in the local machine the cucumber report which is generating contains the screenshot.</p>\n<p>Below is the code i have used to attach screenshot</p>\n<pre><code>@AfterStep\n    public void embedScreenshot(Scenario scenario) throws Exception {\n        if (scenario.isFailed()) {\n            try {\n                byte[] scrFile = ((TakesScreenshot) driver).getScreenshotAs(OutputType.BYTES);\n                scenario.embed(scrFile, &quot;image/png&quot;);\n            } catch (WebDriverException somePlatformsDontSupportScreenshots) {\n                System.err.println(somePlatformsDontSupportScreenshots.getMessage());\n            }\n        }\n    }\n</code></pre>\n<p>Is there any plugin or anything else i can use to show the failed screenshot in the azure report?</p>\n"},{"tags":["java","oracle","hibernate","wildfly","wildfly-27"],"comments":[{"owner":{"account_id":1491171,"reputation":3291,"user_id":1398228,"display_name":"ehsavoie"},"score":0,"creation_date":1694764253,"post_id":77107921,"comment_id":135936779,"body_markdown":"How do you access the driver ?","body":"How do you access the driver ?"},{"owner":{"account_id":10118761,"reputation":11,"user_id":7476497,"display_name":"Emerson Diego"},"score":0,"creation_date":1694777488,"post_id":77107921,"comment_id":135939136,"body_markdown":"The application access the database by datasource in wildfly. And wildfly connects to database by driver in localized in a specific folder of wildfly","body":"The application access the database by datasource in wildfly. And wildfly connects to database by driver in localized in a specific folder of wildfly"},{"owner":{"account_id":51161,"reputation":17015,"user_id":152794,"display_name":"James R. Perkins"},"score":0,"creation_date":1694885849,"post_id":77107921,"comment_id":135951521,"body_markdown":"Are you using the Jakarta EE 10 version of the driver?","body":"Are you using the Jakarta EE 10 version of the driver?"}],"answers":[{"tags":[],"owner":{"account_id":938600,"reputation":566,"user_id":967088,"display_name":"Will Tatam"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694803761,"creation_date":1694803761,"answer_id":77114748,"question_id":77107921,"body_markdown":"You need to change the manifest of your deployment artifact to expose that module to your applications classpath","title":"WildFly 27.0.0.Final and Oracle driver classes are inaccessible","body":"<p>You need to change the manifest of your deployment artifact to expose that module to your applications classpath</p>\n"}],"owner":{"account_id":10118761,"reputation":11,"user_id":7476497,"display_name":"Emerson Diego"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":127,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1694803761,"creation_date":1694720301,"question_id":77107921,"body_markdown":"After migrating an application from WildFly 21 to WildFly 27, I am encountering the following error when deploying the application:\r\n\r\nOracle JDBC driver classes are inaccessible and thus, certain DDL types like ARRAY can not be used!\r\n\r\nIt&#39;s indeed strange because the driver is located in modules\\system\\layers\\base, and when I access the WildFly administrative interface and perform a connection test for the datasource, it succeeds. The error only occurs when I deploy the application.\r\n\r\nHas anyone encountered this issue before and could help?","title":"WildFly 27.0.0.Final and Oracle driver classes are inaccessible","body":"<p>After migrating an application from WildFly 21 to WildFly 27, I am encountering the following error when deploying the application:</p>\n<p>Oracle JDBC driver classes are inaccessible and thus, certain DDL types like ARRAY can not be used!</p>\n<p>It's indeed strange because the driver is located in modules\\system\\layers\\base, and when I access the WildFly administrative interface and perform a connection test for the datasource, it succeeds. The error only occurs when I deploy the application.</p>\n<p>Has anyone encountered this issue before and could help?</p>\n"},{"tags":["java","visual-studio-code","silent"],"answers":[{"tags":[],"owner":{"account_id":1960454,"reputation":44539,"user_id":1762224,"accept_rate":61,"display_name":"Mr. Polywhirl"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694803566,"creation_date":1694800032,"answer_id":77114451,"question_id":77114247,"body_markdown":"If already have VS Code installed, you can install extensions [via the command line](https://stackoverflow.com/questions/34286515/how-to-install-visual-studio-code-extensions-from-command-line):\r\n\r\n```shell\r\n# Install the Java Language Pack\r\ncode --install-extension vscjava.vscode-java-pack\r\n```\r\n\r\nHere are the extensions included in the Java Language pack:\r\n\r\n| Name | Identifier | Included |\r\n|-|-|-|\r\n| [Extension Pack for Java][1] | `vscjava.vscode-java-pack` | N/A |\r\n| [Language Support for Java™ by Red Hat][2] | `redhat.java` | Yes |\r\n| [Debugger for Java][3] | `vscjava.vscode-java-debug` | Yes |\r\n| [Test Runner for Java][4] | `vscjava.vscode-java-test` | Yes |\r\n| [Maven for Java][5] | `vscjava.vscode-maven` | Yes |\r\n| [Project Manager for Java][6] | `vscjava.vscode-java-dependency` | Yes |\r\n| [IntelliCode][7] | `visualstudioexptteam.vscodeintellicode` | Yes |\r\n\r\nRecommended:\r\n\r\n| Name | Identifier\r\n|-|-|\r\n| [Spring Boot Extension Pack][8] | `vmware.vscode-boot-dev-pack` |\r\n| [Gradle for Java][9] | `vscjava.vscode-gradle` |\r\n| [Community Server Connectors][10] _(for Apache Felix, Karaf, Tomcat, Jetty, etc.)_ | `redhat.vscode-community-server-connector` |\r\n| [Server Connector][11] _(Red Hat Servers, for example Wildfly)_ | `redhat.vscode-server-connector` |\r\n| [Extension Pack for MicroProfile][12] | `MicroProfile-Community.vscode-microprofile-pack` |\r\n| [CheckStyle][13] | `shengchen.vscode-checkstyle` |\r\n| [SonarLint][14] | `SonarSource.sonarlint-vscode` |\r\n\r\nOther noteworthy extensions:\r\n\r\n| Name | Identifier |\r\n|-|-|\r\n| [Java Code Generators][15] | `sohibe.java-generate-setters-getters` |\r\n\r\n\r\n  [1]: https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-java-pack\r\n  [2]: https://marketplace.visualstudio.com/items?itemName=redhat.java\r\n  [3]: https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-java-debug\r\n  [4]: https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-java-test\r\n  [5]: https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-maven\r\n  [6]: https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-java-dependency\r\n  [7]: https://marketplace.visualstudio.com/items?itemName=VisualStudioExptTeam.vscodeintellicode\r\n  [8]: https://marketplace.visualstudio.com/items?itemName=vmware.vscode-boot-dev-pack\r\n  [9]: https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-gradle\r\n  [10]: https://marketplace.visualstudio.com/items?itemName=redhat.vscode-community-server-connector\r\n  [11]: https://marketplace.visualstudio.com/items?itemName=redhat.vscode-server-connector\r\n  [12]: https://marketplace.visualstudio.com/items?itemName=MicroProfile-Community.vscode-microprofile-pack\r\n  [13]: https://marketplace.visualstudio.com/items?itemName=shengchen.vscode-checkstyle\r\n  [14]: https://marketplace.visualstudio.com/items?itemName=SonarSource.sonarlint-vscode\r\n  [15]: https://marketplace.visualstudio.com/items?itemName=sohibe.java-generate-setters-getters","title":"Coding Pack for Java - Silent install?","body":"<p>If already have VS Code installed, you can install extensions <a href=\"https://stackoverflow.com/questions/34286515/how-to-install-visual-studio-code-extensions-from-command-line\">via the command line</a>:</p>\n<pre class=\"lang-bash prettyprint-override\"><code># Install the Java Language Pack\ncode --install-extension vscjava.vscode-java-pack\n</code></pre>\n<p>Here are the extensions included in the Java Language pack:</p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>Name</th>\n<th>Identifier</th>\n<th>Included</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-java-pack\" rel=\"nofollow noreferrer\">Extension Pack for Java</a></td>\n<td><code>vscjava.vscode-java-pack</code></td>\n<td>N/A</td>\n</tr>\n<tr>\n<td><a href=\"https://marketplace.visualstudio.com/items?itemName=redhat.java\" rel=\"nofollow noreferrer\">Language Support for Java™ by Red Hat</a></td>\n<td><code>redhat.java</code></td>\n<td>Yes</td>\n</tr>\n<tr>\n<td><a href=\"https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-java-debug\" rel=\"nofollow noreferrer\">Debugger for Java</a></td>\n<td><code>vscjava.vscode-java-debug</code></td>\n<td>Yes</td>\n</tr>\n<tr>\n<td><a href=\"https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-java-test\" rel=\"nofollow noreferrer\">Test Runner for Java</a></td>\n<td><code>vscjava.vscode-java-test</code></td>\n<td>Yes</td>\n</tr>\n<tr>\n<td><a href=\"https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-maven\" rel=\"nofollow noreferrer\">Maven for Java</a></td>\n<td><code>vscjava.vscode-maven</code></td>\n<td>Yes</td>\n</tr>\n<tr>\n<td><a href=\"https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-java-dependency\" rel=\"nofollow noreferrer\">Project Manager for Java</a></td>\n<td><code>vscjava.vscode-java-dependency</code></td>\n<td>Yes</td>\n</tr>\n<tr>\n<td><a href=\"https://marketplace.visualstudio.com/items?itemName=VisualStudioExptTeam.vscodeintellicode\" rel=\"nofollow noreferrer\">IntelliCode</a></td>\n<td><code>visualstudioexptteam.vscodeintellicode</code></td>\n<td>Yes</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>Recommended:</p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>Name</th>\n<th>Identifier</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"https://marketplace.visualstudio.com/items?itemName=vmware.vscode-boot-dev-pack\" rel=\"nofollow noreferrer\">Spring Boot Extension Pack</a></td>\n<td><code>vmware.vscode-boot-dev-pack</code></td>\n</tr>\n<tr>\n<td><a href=\"https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-gradle\" rel=\"nofollow noreferrer\">Gradle for Java</a></td>\n<td><code>vscjava.vscode-gradle</code></td>\n</tr>\n<tr>\n<td><a href=\"https://marketplace.visualstudio.com/items?itemName=redhat.vscode-community-server-connector\" rel=\"nofollow noreferrer\">Community Server Connectors</a> <em>(for Apache Felix, Karaf, Tomcat, Jetty, etc.)</em></td>\n<td><code>redhat.vscode-community-server-connector</code></td>\n</tr>\n<tr>\n<td><a href=\"https://marketplace.visualstudio.com/items?itemName=redhat.vscode-server-connector\" rel=\"nofollow noreferrer\">Server Connector</a> <em>(Red Hat Servers, for example Wildfly)</em></td>\n<td><code>redhat.vscode-server-connector</code></td>\n</tr>\n<tr>\n<td><a href=\"https://marketplace.visualstudio.com/items?itemName=MicroProfile-Community.vscode-microprofile-pack\" rel=\"nofollow noreferrer\">Extension Pack for MicroProfile</a></td>\n<td><code>MicroProfile-Community.vscode-microprofile-pack</code></td>\n</tr>\n<tr>\n<td><a href=\"https://marketplace.visualstudio.com/items?itemName=shengchen.vscode-checkstyle\" rel=\"nofollow noreferrer\">CheckStyle</a></td>\n<td><code>shengchen.vscode-checkstyle</code></td>\n</tr>\n<tr>\n<td><a href=\"https://marketplace.visualstudio.com/items?itemName=SonarSource.sonarlint-vscode\" rel=\"nofollow noreferrer\">SonarLint</a></td>\n<td><code>SonarSource.sonarlint-vscode</code></td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>Other noteworthy extensions:</p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>Name</th>\n<th>Identifier</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"https://marketplace.visualstudio.com/items?itemName=sohibe.java-generate-setters-getters\" rel=\"nofollow noreferrer\">Java Code Generators</a></td>\n<td><code>sohibe.java-generate-setters-getters</code></td>\n</tr>\n</tbody>\n</table>\n</div>"}],"owner":{"account_id":29454670,"reputation":9,"user_id":22570808,"display_name":"Warthog"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":107,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"closed_date":1695016990,"answer_count":1,"score":0,"last_activity_date":1694803566,"creation_date":1694797866,"question_id":77114247,"body_markdown":"Is there a Windows silent install for the Coding Pack for Java? I have JavaCodingPack-0.4.1.exe and I have tried /? to no avail and tried various other switches. Trying to get this together for a class of coders.\r\n\r\nhttps://code.visualstudio.com/docs/languages/java\r\n\r\nThere was no silent installation I could see.","title":"Coding Pack for Java - Silent install?","body":"<p>Is there a Windows silent install for the Coding Pack for Java? I have JavaCodingPack-0.4.1.exe and I have tried /? to no avail and tried various other switches. Trying to get this together for a class of coders.</p>\n<p><a href=\"https://code.visualstudio.com/docs/languages/java\" rel=\"nofollow noreferrer\">https://code.visualstudio.com/docs/languages/java</a></p>\n<p>There was no silent installation I could see.</p>\n"},{"tags":["java","android"],"comments":[{"owner":{"account_id":1607232,"reputation":198,"user_id":1487078,"display_name":"vivek"},"score":0,"creation_date":1396879266,"post_id":22914536,"comment_id":34974097,"body_markdown":"is your thread running? \nYou havent called \n   androidDisplay.start();\nmethod in your code","body":"is your thread running?  You havent called     androidDisplay.start(); method in your code"},{"owner":{"account_id":1290116,"reputation":6044,"user_id":1242380,"accept_rate":89,"display_name":"Neil Townsend"},"score":0,"creation_date":1396879417,"post_id":22914536,"comment_id":34974193,"body_markdown":"Have you put any logging statements in onResume to verify that it isn&#39;t being called?","body":"Have you put any logging statements in onResume to verify that it isn&#39;t being called?"},{"owner":{"account_id":3277574,"reputation":167,"user_id":2759103,"accept_rate":62,"display_name":"2851999"},"score":0,"creation_date":1396879417,"post_id":22914536,"comment_id":34974194,"body_markdown":"Yes, in the AndroidDisplay class I use \t\tthis.androidGameThread.setRunning(true);\nthis.androidGameThread.start();","body":"Yes, in the AndroidDisplay class I use \t\tthis.androidGameThread.setRunning(true); this.androidGameThread.start();"},{"owner":{"account_id":3277574,"reputation":167,"user_id":2759103,"accept_rate":62,"display_name":"2851999"},"score":0,"creation_date":1396879473,"post_id":22914536,"comment_id":34974239,"body_markdown":"I have tried putting a log there, that is why I think it isn&#39;t being called.","body":"I have tried putting a log there, that is why I think it isn&#39;t being called."},{"owner":{"account_id":1607232,"reputation":198,"user_id":1487078,"display_name":"vivek"},"score":0,"creation_date":1396879886,"post_id":22914536,"comment_id":34974562,"body_markdown":"Also, can you explain the overloading of onCreate() Method of your Activity?\nCorrect me if i am wrong . I think when the Activity is created \nActivity.onCreate(Bundle bun) is called . And this method doesn&#39;t creates any thread .","body":"Also, can you explain the overloading of onCreate() Method of your Activity? Correct me if i am wrong . I think when the Activity is created  Activity.onCreate(Bundle bun) is called . And this method doesn&#39;t creates any thread ."},{"owner":{"account_id":3277574,"reputation":167,"user_id":2759103,"accept_rate":62,"display_name":"2851999"},"score":0,"creation_date":1396880258,"post_id":22914536,"comment_id":34974842,"body_markdown":"I have got two methods, onCreate(Bundle savedInstanceState) and the other is onCreate(BaseGame androidGame, Bundle savedInstanceState), I have one class that extends the AndroidActivity shown above and the onCreate(Bundle savedInstanceState) is called by Android, then in this method that is overridden, I call the other one and pass an instance of BaseGame to it and therefore calls the other method. So in the test I have made I am using within the overridden onCreate(Bundle savedInstanceState) method the code: this.onCreate(new FileTest() ,  savedInstanceState);","body":"I have got two methods, onCreate(Bundle savedInstanceState) and the other is onCreate(BaseGame androidGame, Bundle savedInstanceState), I have one class that extends the AndroidActivity shown above and the onCreate(Bundle savedInstanceState) is called by Android, then in this method that is overridden, I call the other one and pass an instance of BaseGame to it and therefore calls the other method. So in the test I have made I am using within the overridden onCreate(Bundle savedInstanceState) method the code: this.onCreate(new FileTest() ,  savedInstanceState);"},{"owner":{"account_id":1607232,"reputation":198,"user_id":1487078,"display_name":"vivek"},"score":0,"creation_date":1396881391,"post_id":22914536,"comment_id":34975686,"body_markdown":"can you add full code of your testing class ?","body":"can you add full code of your testing class ?"},{"owner":{"account_id":1607232,"reputation":198,"user_id":1487078,"display_name":"vivek"},"score":0,"creation_date":1396881877,"post_id":22914536,"comment_id":34976079,"body_markdown":"this.onCreate(new FileTest() ,  savedInstanceState);\n will call \n     oncreateMethod( BaseGame androidGame , Bundle savedInstanceState) \n\nOF YOUR TESTING CLASS","body":"this.onCreate(new FileTest() ,  savedInstanceState);  will call       oncreateMethod( BaseGame androidGame , Bundle savedInstanceState)   OF YOUR TESTING CLASS"},{"owner":{"account_id":3277574,"reputation":167,"user_id":2759103,"accept_rate":62,"display_name":"2851999"},"score":0,"creation_date":1396882302,"post_id":22914536,"comment_id":34976377,"body_markdown":"Yes, I have a class called MainActivity that extends AndroidActivity and FileTest which extends BaseGame, they are separate classes. I have tested it and it does work as expected until, I go away from the app and then go back to it.","body":"Yes, I have a class called MainActivity that extends AndroidActivity and FileTest which extends BaseGame, they are separate classes. I have tested it and it does work as expected until, I go away from the app and then go back to it."},{"owner":{"account_id":3277574,"reputation":167,"user_id":2759103,"accept_rate":62,"display_name":"2851999"},"score":0,"creation_date":1396882712,"post_id":22914536,"comment_id":34976707,"body_markdown":"Quick update, tested again, it does work when turning the screen off and on, and when going away from the app it eventually says that it is not responding as if the thread never restarted.","body":"Quick update, tested again, it does work when turning the screen off and on, and when going away from the app it eventually says that it is not responding as if the thread never restarted."}],"answers":[{"tags":[],"owner":{"account_id":1607232,"reputation":198,"user_id":1487078,"display_name":"vivek"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1396880127,"creation_date":1396880127,"answer_id":22915014,"question_id":22914536,"body_markdown":"Possibly issue could me method overloading of Activity.onCreate() Method. \r\n     \r\n     protected void onCreate(Bundle savedInstanceState) \r\nThis method (which will be called when activity is created.) doesn&#39;t create any thread .\r\n\r\nI dont know if following method will be called when activity is created\r\n     \r\n     protected void onCreate(BaseGame androidGame , Bundle savedInstanceState)\r\n\r\n\r\n","title":"Android onResume() not being called","body":"<p>Possibly issue could me method overloading of Activity.onCreate() Method. </p>\n\n<pre><code> protected void onCreate(Bundle savedInstanceState) \n</code></pre>\n\n<p>This method (which will be called when activity is created.) doesn't create any thread .</p>\n\n<p>I dont know if following method will be called when activity is created</p>\n\n<pre><code> protected void onCreate(BaseGame androidGame , Bundle savedInstanceState)\n</code></pre>\n"},{"tags":[],"owner":{"account_id":3277574,"reputation":167,"user_id":2759103,"accept_rate":62,"display_name":"2851999"},"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1446027034,"creation_date":1396890005,"answer_id":22918643,"question_id":22914536,"body_markdown":"Thank you everyone :)\r\nI have spent the whole day trying to fix this issue and I have just fixed the problem.\r\n\r\nI found this https://stackoverflow.com/questions/5689316/android-onresume-not-called?rq=1, and then I added some calls to Log.d() to try and figure out what was happening. By adding them to each method in AndroidDisplay and AndroidActvity, I noticed that when I turned the screen off and on, I had the output: &#39;ACTIVITY PAUSED&#39;, &#39;ACTIVITY STOPPED&#39;, &#39;ACTIVITY RESTARTED&#39;, and &#39;ACTIVITY RESUMED&#39; which was what I had expected, then when clicking on the menu button, there was an extra output, &#39;SURFACE DESTROYED&#39; and so I changed AndroidDisplay, to stop the thread from stopping when the surface was destroyed so I moved that code into a method called stopThread() and then I found that I had a problem with the fact that I was re-creating the same thread twice because of the surfaceCreated() method in AndroidDisplay, so then I made an if statement before calling androidGameThread.start() which used androidGameThread.isAlive() therefore fixing this issue.\r\n\r\nNew AndroidDisplay code:\r\n    \r\n    package org.simplecorporation.myengine.core.android;\r\n\r\n    import org.simplecorporation.myengine.core.Settings;\r\n    import org.simplecorporation.myengine.core.game.BaseGame;\r\n    import org.simplecorporation.myengine.core.input.InputManager;\r\n    import org.simplecorporation.myengine.utils.ScreenUtils;\r\n\r\n    import android.app.Activity;\r\n    import android.graphics.Paint;\r\n    import android.view.SurfaceHolder;\r\n    import android.view.SurfaceView;\r\n\r\n    public class AndroidDisplay extends SurfaceView implements SurfaceHolder.Callback {\r\n\t\r\n\t/* The android game */\r\n\tpublic BaseGame androidGame;\r\n\t\r\n\t/* The android game thread */\r\n\tpublic AndroidGameThread androidGameThread;\r\n\t\r\n\t/* The boolean that states whether this has been created */\r\n\tpublic boolean created;\r\n\t\r\n\t/* The constructor */\r\n\tpublic AndroidDisplay(Activity gameActivity , BaseGame androidGame) {\r\n\t\t//Call the super constructor\r\n\t\tsuper(gameActivity);\r\n\t\t\r\n\t\t//Add the callback\r\n\t\tthis.getHolder().addCallback(this);\r\n\t\t\r\n\t\t//Set the game activity in the AndroidStore\r\n\t\tAndroidStore.gameActivity = gameActivity;\r\n\t\t\r\n\t\t//Set the android game\r\n\t\tthis.androidGame = androidGame;\r\n\t\t\r\n\t\t//Create the android game thread\r\n\t\tthis.androidGameThread = new AndroidGameThread(this.getHolder(), this.androidGame, this);\r\n\t\t\r\n\t\t//Set created to false\r\n\t\tthis.created = false;\r\n\t\t\r\n\t\t//Set the surface view focusable\r\n\t\tthis.setFocusable(true);\r\n\t}\r\n\t\r\n\t/* Called when the surface is created */\r\n\tpublic void surfaceCreated(SurfaceHolder surfaceHolder) {\r\n\t\t//Set created to true\r\n\t\tthis.created = true;\r\n\t\t//Create the input\r\n\t\tInputManager.create();\r\n\t\t//Set the size of the screen in the settings if full screen\r\n\t\tif (Settings.Window.Fullscreen) {\r\n\t\t\tSettings.Window.Size.Width = ScreenUtils.getScreenWidth();\r\n\t\t\tSettings.Window.Size.Height = ScreenUtils.getScreenHeight();\r\n\t\t} else {\r\n\t\t\t//Set the size of the screen in the settings\r\n\t\t\tSettings.Window.Size.Width = this.getWidth();\r\n\t\t\tSettings.Window.Size.Height = this.getHeight();\r\n\t\t}\r\n\t\t//Set the game resources\r\n\t\tAndroidStore.gameResources = this.getResources();\r\n\t\t//Create the game\r\n\t\tthis.androidGame.gameCreated();\r\n\t\t//Create the paint object\r\n\t\tAndroidStore.gamePaint = new Paint();\r\n\t\t//Start the android game thread if it has not already started\r\n\t\tthis.androidGameThread.setRunning(true);\r\n\t\tif (! this.androidGameThread.isAlive())\r\n\t\t\tthis.androidGameThread.start();\r\n\t}\r\n\t\r\n\t/* Called when the surface is changed */\r\n\tpublic void surfaceChanged(SurfaceHolder surfaceHolder , int format , int width , int height) {\r\n\t\t//Set the size of the screen in the settings\r\n\t\tSettings.Window.Size.Width = ScreenUtils.getScreenWidth();\r\n\t\tSettings.Window.Size.Height = ScreenUtils.getScreenHeight();\r\n\t\t//Reassign the surface holder\r\n\t\tthis.androidGameThread.surfaceHolder = surfaceHolder;\r\n\t}\r\n\t\r\n\t/* Called when the surface is destroyed */\r\n\tpublic void surfaceDestroyed(SurfaceHolder surfaceHolder) {\r\n\t\t//Set created to false\r\n\t\tthis.created = false;\r\n\t}\r\n\t\r\n\t/* The method used to stop the thread */\r\n\tpublic void stopThread() {\r\n\t\t//Should the loop continue\r\n\t\tboolean retry = true;\r\n\t\twhile(retry) {\r\n\t\t\t//Try and catch statement\r\n\t\t\ttry {\r\n\t\t\t\t//Stop the game\r\n\t\t\t\tthis.androidGame.gameStopped();\r\n\t\t\t\t//Close the game\r\n\t\t\t\tthis.androidGame.gameClosing();\r\n\t\t\t\t//Join the thread\r\n\t\t\t\tthis.androidGameThread.join();\r\n\t\t\t\t//Stop the while loop\r\n\t\t\t\tretry = false;\r\n\t\t\t} catch (InterruptedException e) {\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n    }","title":"Android onResume() not being called","body":"<p>Thank you everyone :)\nI have spent the whole day trying to fix this issue and I have just fixed the problem.</p>\n\n<p>I found this <a href=\"https://stackoverflow.com/questions/5689316/android-onresume-not-called?rq=1\">Android onResume not called</a>, and then I added some calls to Log.d() to try and figure out what was happening. By adding them to each method in AndroidDisplay and AndroidActvity, I noticed that when I turned the screen off and on, I had the output: 'ACTIVITY PAUSED', 'ACTIVITY STOPPED', 'ACTIVITY RESTARTED', and 'ACTIVITY RESUMED' which was what I had expected, then when clicking on the menu button, there was an extra output, 'SURFACE DESTROYED' and so I changed AndroidDisplay, to stop the thread from stopping when the surface was destroyed so I moved that code into a method called stopThread() and then I found that I had a problem with the fact that I was re-creating the same thread twice because of the surfaceCreated() method in AndroidDisplay, so then I made an if statement before calling androidGameThread.start() which used androidGameThread.isAlive() therefore fixing this issue.</p>\n\n<p>New AndroidDisplay code:</p>\n\n<pre><code>package org.simplecorporation.myengine.core.android;\n\nimport org.simplecorporation.myengine.core.Settings;\nimport org.simplecorporation.myengine.core.game.BaseGame;\nimport org.simplecorporation.myengine.core.input.InputManager;\nimport org.simplecorporation.myengine.utils.ScreenUtils;\n\nimport android.app.Activity;\nimport android.graphics.Paint;\nimport android.view.SurfaceHolder;\nimport android.view.SurfaceView;\n\npublic class AndroidDisplay extends SurfaceView implements SurfaceHolder.Callback {\n\n/* The android game */\npublic BaseGame androidGame;\n\n/* The android game thread */\npublic AndroidGameThread androidGameThread;\n\n/* The boolean that states whether this has been created */\npublic boolean created;\n\n/* The constructor */\npublic AndroidDisplay(Activity gameActivity , BaseGame androidGame) {\n    //Call the super constructor\n    super(gameActivity);\n\n    //Add the callback\n    this.getHolder().addCallback(this);\n\n    //Set the game activity in the AndroidStore\n    AndroidStore.gameActivity = gameActivity;\n\n    //Set the android game\n    this.androidGame = androidGame;\n\n    //Create the android game thread\n    this.androidGameThread = new AndroidGameThread(this.getHolder(), this.androidGame, this);\n\n    //Set created to false\n    this.created = false;\n\n    //Set the surface view focusable\n    this.setFocusable(true);\n}\n\n/* Called when the surface is created */\npublic void surfaceCreated(SurfaceHolder surfaceHolder) {\n    //Set created to true\n    this.created = true;\n    //Create the input\n    InputManager.create();\n    //Set the size of the screen in the settings if full screen\n    if (Settings.Window.Fullscreen) {\n        Settings.Window.Size.Width = ScreenUtils.getScreenWidth();\n        Settings.Window.Size.Height = ScreenUtils.getScreenHeight();\n    } else {\n        //Set the size of the screen in the settings\n        Settings.Window.Size.Width = this.getWidth();\n        Settings.Window.Size.Height = this.getHeight();\n    }\n    //Set the game resources\n    AndroidStore.gameResources = this.getResources();\n    //Create the game\n    this.androidGame.gameCreated();\n    //Create the paint object\n    AndroidStore.gamePaint = new Paint();\n    //Start the android game thread if it has not already started\n    this.androidGameThread.setRunning(true);\n    if (! this.androidGameThread.isAlive())\n        this.androidGameThread.start();\n}\n\n/* Called when the surface is changed */\npublic void surfaceChanged(SurfaceHolder surfaceHolder , int format , int width , int height) {\n    //Set the size of the screen in the settings\n    Settings.Window.Size.Width = ScreenUtils.getScreenWidth();\n    Settings.Window.Size.Height = ScreenUtils.getScreenHeight();\n    //Reassign the surface holder\n    this.androidGameThread.surfaceHolder = surfaceHolder;\n}\n\n/* Called when the surface is destroyed */\npublic void surfaceDestroyed(SurfaceHolder surfaceHolder) {\n    //Set created to false\n    this.created = false;\n}\n\n/* The method used to stop the thread */\npublic void stopThread() {\n    //Should the loop continue\n    boolean retry = true;\n    while(retry) {\n        //Try and catch statement\n        try {\n            //Stop the game\n            this.androidGame.gameStopped();\n            //Close the game\n            this.androidGame.gameClosing();\n            //Join the thread\n            this.androidGameThread.join();\n            //Stop the while loop\n            retry = false;\n        } catch (InterruptedException e) {\n\n        }\n    }\n}\n\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":11905400,"reputation":1028,"user_id":8712102,"display_name":"HandyPawan"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1549702427,"creation_date":1549692210,"answer_id":54603695,"question_id":22914536,"body_markdown":"In Manifest, use this in launcher activity\r\n\r\n    android:noHistory=&quot;false&quot;\r\n","title":"Android onResume() not being called","body":"<p>In Manifest, use this in launcher activity</p>\n\n<pre><code>android:noHistory=\"false\"\n</code></pre>\n"}],"owner":{"account_id":3277574,"reputation":167,"user_id":2759103,"accept_rate":62,"display_name":"2851999"},"comment_count":10,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":14409,"favorite_count":0,"down_vote_count":0,"up_vote_count":7,"accepted_answer_id":22918643,"answer_count":3,"score":7,"last_activity_date":1694803228,"creation_date":1396878856,"question_id":22914536,"body_markdown":"for a while I have been creating a game engine that works on Android using Java. Unfortunately I have this problem where the onResume() method does&#39;t appear to be called. I am using a Thread to run everything, and when I minimise the app and then go back on the app, it just gives me a blank, black screen. But it DOES work when I turn the screen off and on again.\r\n\r\nThe code that I am using for the activity:\r\n     \r\n     package org.simplecorporation.myengine.core.android;\r\n     \r\n     import org.simplecorporation.myengine.core.Settings;\r\n     import org.simplecorporation.myengine.core.android.input.AndroidInput;\r\n     import org.simplecorporation.myengine.core.game.BaseGame;\r\n     \r\n     import android.app.Activity;\r\n     import android.content.pm.ActivityInfo;\r\n     import android.os.Bundle;\r\n     import android.view.MotionEvent;\r\n     import android.view.Window;\r\n     import android.view.WindowManager;\r\n     \r\n     public abstract class AndroidActivity extends Activity {\r\n\t\r\n\t/* The abstract methods*/\r\n\tpublic abstract void activityCreated();\r\n\tpublic abstract void activityPaused();\r\n\tpublic abstract void activityResumed();\r\n\tpublic abstract void activityStopped();\r\n\tpublic abstract void activityRestarted();\r\n\tpublic abstract void activityDestroy();\r\n\t\r\n\t/* The android display */\r\n\tpublic AndroidDisplay androidDisplay;\r\n\t\r\n\t/* The onCreate method */\r\n\tprotected void onCreate(Bundle savedInstanceState) {\r\n\t\tsuper.onCreate(savedInstanceState);\r\n\t\t//Set the title\r\n\t\tthis.setTitle(Settings.Window.Title);\r\n\t\t//Check the orientation and set it\r\n\t\tif (AndroidSettings.ScreenOrientation == AndroidSettings.SCREEN_ORIENTATION_PORTRAIT)\r\n\t\t\tthis.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);\r\n\t\telse if (AndroidSettings.ScreenOrientation == AndroidSettings.SCREEN_ORIENTATION_LANDSCAPE)\r\n\t\t\tthis.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);\r\n\t\t//Check if the activity should be fullscreen\r\n\t\tif (Settings.Window.Fullscreen) {\r\n\t\t\t//Get rid of the title bar\r\n\t\t\tthis.getWindow().requestFeature(Window.FEATURE_NO_TITLE);\r\n\t\t\t//Make the activity fullscreen\r\n\t\t\tthis.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN , WindowManager.LayoutParams.FLAG_FULLSCREEN);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/* The onCreate method */\r\n\tprotected void onCreate(BaseGame androidGame , Bundle savedInstanceState) {\r\n\t\tsuper.onCreate(savedInstanceState);\r\n\t\t//Set the title\r\n\t\tthis.setTitle(Settings.Window.Title);\r\n\t\t//Check the orientation and set it\r\n\t\tif (AndroidSettings.ScreenOrientation == AndroidSettings.SCREEN_ORIENTATION_PORTRAIT)\r\n\t\t\tthis.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);\r\n\t\telse if (AndroidSettings.ScreenOrientation == AndroidSettings.SCREEN_ORIENTATION_LANDSCAPE)\r\n\t\t\tthis.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);\r\n\t\t//Check if the activity should be fullscreen\r\n\t\tif (Settings.Window.Fullscreen) {\r\n\t\t\t//Get rid of the title bar\r\n\t\t\tthis.getWindow().requestFeature(Window.FEATURE_NO_TITLE);\r\n\t\t\t//Make the activity fullscreen\r\n\t\t\tthis.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN , WindowManager.LayoutParams.FLAG_FULLSCREEN);\r\n\t\t}\r\n\t\t//Create the display\r\n\t\tandroidDisplay = new AndroidDisplay(this , androidGame);\r\n\t\t//Set the content view\r\n\t\tthis.setContentView(androidDisplay);\r\n\t\t//Call the activity create method\r\n\t\tthis.activityCreated();\r\n\t}\r\n\t\r\n\t/* Called when the activity is paused */\r\n\tpublic void onPause() {\r\n\t\tsuper.onPause();\r\n\t\t//Pause the thread\r\n\t\tthis.androidDisplay.androidGameThread.paused = true;\r\n\t\t//Call the method\r\n\t\tthis.activityPaused();\r\n\t}\r\n\t\r\n\t/* Called when the activity is resumed */\r\n\tpublic void onResume() {\r\n\t\tsuper.onResume();\r\n\t\t//Resume the thread\r\n\t\tthis.androidDisplay.androidGameThread.paused = false;\r\n\t\t//Call the method\r\n\t\tthis.activityResumed();\r\n\t}\r\n\t\r\n\t/* Called when the activity is stopped */\r\n\tpublic void onStop() {\r\n\t\tsuper.onStop();\r\n\t\t//Call the method\r\n\t\tthis.activityStopped();\r\n\t}\r\n\t\r\n\t/* Called when the activity is restarted */\r\n\tpublic void onRestart() {\r\n\t\tsuper.onRestart();\r\n\t\t//Call the method\r\n\t\tthis.activityRestarted();\r\n\t}\r\n\t\r\n\t/* Called when the activity is destroyed */\r\n\tpublic void onDestroy() {\r\n\t\tsuper.onDestroy();\r\n\t\t//Call the method\r\n\t\tthis.activityDestroy();\r\n\t\t//Destroy\r\n\t\tthis.finish();\r\n\t}\r\n     }\r\n\r\nThe code that I am using for the thread:\r\n    \r\n    package org.simplecorporation.myengine.core.android;\r\n\r\n    import org.simplecorporation.myengine.core.game.BaseGame;\r\n    import org.simplecorporation.myengine.core.input.InputManager;\r\n\r\n    import android.util.Log;\r\n    import android.view.SurfaceHolder;\r\n\r\n    public class AndroidGameThread extends Thread {\r\n\t\r\n\t/* Is the thread running */\r\n\tpublic boolean running;\r\n\t\r\n\t/* Is the thread paused */\r\n\tpublic boolean paused;\r\n\t\r\n\t/* The surface holder */\r\n\tpublic SurfaceHolder surfaceHolder;\r\n\t\r\n\t/* The android game */\r\n\tpublic BaseGame androidGame;\r\n\t\r\n\t/* The constructor */\r\n\tpublic AndroidGameThread(SurfaceHolder surfaceHolder , BaseGame androidGame) {\r\n\t\t//Set running to false\r\n\t\tthis.running = false;\r\n\t\t//Set paused to false\r\n\t\tthis.paused = false;\r\n\t\t//Assign the surface holder\r\n\t\tthis.surfaceHolder = surfaceHolder;\r\n\t\t//Assign the android game\r\n\t\tthis.androidGame = androidGame;\r\n\t}\r\n\t\r\n\t/* The method to set the running variable */\r\n\tpublic void setRunning(boolean running) {\r\n\t\tthis.running = running;\r\n\t}\r\n\t\r\n\t/* Returns whether the thread is running */\r\n\tpublic boolean isRunning() {\r\n\t\treturn this.running;\r\n\t}\r\n\t\r\n\t/* The run method */\r\n\tpublic void run() {\r\n\t\t//Start the game\r\n\t\tthis.androidGame.create();\r\n\t\t//Run while the variable running is true\r\n\t\twhile (running) {\r\n\t\t\t//Check if the thread is paused\r\n\t\t\tif (! this.paused) {\r\n\t\t\t\t//Check the input\r\n\t\t\t\tInputManager.checkInput();\r\n\t\t\t\t//Set the game canvas to null\r\n\t\t\t\tAndroidStore.gameCanvas = null;\r\n\t\t\t\t//Try statement\r\n\t\t\t\ttry {\r\n\t\t\t\t\t//Set the game canvas\r\n\t\t\t\t\tAndroidStore.gameCanvas = this.surfaceHolder.lockCanvas();\r\n\t\t\t\t\tsynchronized (this.surfaceHolder) {\r\n\t\t\t\t\t\t//Update/Render the game\r\n\t\t\t\t\t\tthis.androidGame.tick();\r\n\t\t\t\t\t}\r\n\t\t\t\t} finally {\r\n\t\t\t\t\t//Check that the canvas isn&#39;t null\r\n\t\t\t\t\tif (AndroidStore.gameCanvas != null) {\r\n\t\t\t\t\t\tthis.surfaceHolder.unlockCanvasAndPost(AndroidStore.gameCanvas);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n    }\r\n\r\nAlso, to start the thread I use\r\n    \r\n    import org.simplecorporation.myengine.core.Settings;\r\n    import org.simplecorporation.myengine.core.game.BaseGame;\r\n    import org.simplecorporation.myengine.core.input.InputManager;\r\n    import org.simplecorporation.myengine.utils.ScreenUtils;\r\n    \r\n    import android.app.Activity;\r\n    import android.graphics.Paint;\r\n    import android.view.SurfaceHolder;\r\n    import android.view.SurfaceView;\r\n\r\n    public class AndroidDisplay extends SurfaceView implements SurfaceHolder.Callback {\r\n\t\r\n\t/* The android game */\r\n\tpublic BaseGame androidGame;\r\n\t\r\n\t/* The android game thread */\r\n\tpublic AndroidGameThread androidGameThread;\r\n\t\r\n\t/* The constructor */\r\n\tpublic AndroidDisplay(Activity gameActivity , BaseGame androidGame) {\r\n\t\t//Call the super constructor\r\n\t\tsuper(gameActivity);\r\n\t\t\r\n\t\t//Add the callback\r\n\t\tthis.getHolder().addCallback(this);\r\n\t\t\r\n\t\t//Set the game activity in the AndroidStore\r\n\t\tAndroidStore.gameActivity = gameActivity;\r\n\t\t\r\n\t\t//Set the android game\r\n\t\tthis.androidGame = androidGame;\r\n\t\t\r\n\t\t//Create the android game thread\r\n\t\tthis.androidGameThread = new AndroidGameThread(this.getHolder(), this.androidGame);\r\n\t\t\r\n\t\t//Set the surface view focusable\r\n\t\tthis.setFocusable(true);\r\n\t}\r\n\t\r\n\t/* Called when the surface is created */\r\n\tpublic void surfaceCreated(SurfaceHolder surfaceHolder) {\r\n\t\t//Create the input\r\n\t\tInputManager.create();\r\n\t\t//Set the size of the screen in the settings if full screen\r\n\t\tif (Settings.Window.Fullscreen) {\r\n\t\t\tSettings.Window.Size.Width = ScreenUtils.getScreenWidth();\r\n\t\t\tSettings.Window.Size.Height = ScreenUtils.getScreenHeight();\r\n\t\t} else {\r\n\t\t\t//Set the size of the screen in the settings\r\n\t\t\tSettings.Window.Size.Width = this.getWidth();\r\n\t\t\tSettings.Window.Size.Height = this.getHeight();\r\n\t\t}\r\n\t\t//Set the game resources\r\n\t\tAndroidStore.gameResources = this.getResources();\r\n\t\t//Create the game\r\n\t\tthis.androidGame.gameCreated();\r\n\t\t//Create the paint object\r\n\t\tAndroidStore.gamePaint = new Paint();\r\n\t\t//Start the android game thread\r\n\t\tthis.androidGameThread.setRunning(true);\r\n\t\tthis.androidGameThread.start();\r\n\t}\r\n\t\r\n\t/* Called when the surface is changed */\r\n\tpublic void surfaceChanged(SurfaceHolder surfaceHolder , int format , int width , int height) {\r\n\t\t//Set the size of the screen in the settings\r\n\t\tSettings.Window.Size.Width = ScreenUtils.getScreenWidth();\r\n\t\tSettings.Window.Size.Height = ScreenUtils.getScreenHeight();\r\n\t}\r\n\t\r\n\t/* Called when the surface is destroyed */\r\n\tpublic void surfaceDestroyed(SurfaceHolder surfaceHolder) {\r\n\t\t//Should the loop continue\r\n\t\tboolean retry = true;\r\n\t\twhile(retry) {\r\n\t\t\t//Try and catch statement\r\n\t\t\ttry {\r\n\t\t\t\t//Stop the game\r\n\t\t\t\tthis.androidGame.gameStopped();\r\n\t\t\t\t//Close the game\r\n\t\t\t\tthis.androidGame.gameClosing();\r\n\t\t\t\t//Join the thread\r\n\t\t\t\tthis.androidGameThread.join();\r\n\t\t\t\t//Stop the while loop\r\n\t\t\t\tretry = false;\r\n\t\t\t} catch (InterruptedException e) {\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n    }\r\n\r\nTo run all of this I have a class that &#39;extends&#39; AndroidActvity and uses the following method:\r\n\r\n\tprotected void onCreate(Bundle savedInstanceState) {\r\n\t\tSettings.Window.Title = &quot;MyEngine Android Tests&quot;;\r\n\t\tSettings.Android = true;\r\n\t\tSettings.Video.OpenGL = false;\r\n\t\tSettings.Audio.SoundEffectVolume = 10;\r\n\t\tAndroidSettings.ScreenOrientation = 1;\r\n\t\tSettings.Window.Fullscreen = true;\r\n\t\tthis.onCreate(new FileTest() ,  savedInstanceState);\r\n\t}\r\n\r\nThe testing class:\r\n    \r\n    import org.simplecorporation.myengine.core.Settings;\r\n    import org.simplecorporation.myengine.core.android.AndroidActivity;\r\n    import org.simplecorporation.myengine.core.android.AndroidSettings;\r\n    \r\n    import android.os.Bundle;\r\n    import android.util.Log;\r\n\r\n    public class MainActivity extends AndroidActivity {\r\n\r\n\tprotected void onCreate(Bundle savedInstanceState) {\r\n\t\tSettings.Window.Title = &quot;MyEngine Android Tests&quot;;\r\n\t\tSettings.Android = true;\r\n\t\tSettings.Video.OpenGL = false;\r\n\t\tSettings.Audio.SoundEffectVolume = 10;\r\n\t\tAndroidSettings.ScreenOrientation = 1;\r\n\t\tSettings.Window.Fullscreen = true;\r\n\t\tthis.onCreate(new FileTest() ,  savedInstanceState);\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void activityCreated() {\r\n\t\t// TODO Auto-generated method stub\r\n\t\t\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void activityPaused() {\r\n\t\t// TODO Auto-generated method stub\r\n\t\tLog.d(&quot;HELLO&quot;, &quot;I HAVE BEEN PAUSED&quot;);\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void activityResumed() {\r\n\t\t// TODO Auto-generated method stub\r\n\t\tLog.d(&quot;HELLO&quot;, &quot;I HAVE BEEN RESUMED&quot;);\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void activityStopped() {\r\n\t\t// TODO Auto-generated method stub\r\n\t\tLog.d(&quot;HELLO&quot;, &quot;I HAVE BEEN STOPPED&quot;);\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void activityRestarted() {\r\n\t\t// TODO Auto-generated method stub\r\n\t\tLog.d(&quot;HELLO&quot;, &quot;I HAVE BEEN RESTARTED&quot;);\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void activityDestroy() {\r\n\t\t// TODO Auto-generated method stub\r\n\t\tLog.d(&quot;HELLO&quot;, &quot;I HAVE BEEN DESTROYED&quot;);\r\n\t}\r\n\r\n    }\r\n\r\nFileTest:\r\n    \r\n    package com.simplecorporation.myengine.android.tests;\r\n\r\n    import java.util.List;\r\n\r\n    import org.simplecorporation.myengine.core.Settings;\r\n    import org.simplecorporation.myengine.core.audio.clip.AndroidAudio;\r\n    import org.simplecorporation.myengine.core.game.BaseGame;\r\n    import org.simplecorporation.myengine.core.game2d.entity.ImageEntity2D;\r\n    import org.simplecorporation.myengine.core.gui.GUIButton;\r\n    import org.simplecorporation.myengine.core.gui.GUICheckBox;\r\n    import org.simplecorporation.myengine.core.gui.GUIRenderer;\r\n    import org.simplecorporation.myengine.core.gui.GUIScrollBar;\r\n    import org.simplecorporation.myengine.core.gui.GUISlider;\r\n    import org.simplecorporation.myengine.core.gui.GUITextDisplayArea;\r\n    import org.simplecorporation.myengine.core.gui.font.GUIFont;\r\n    import org.simplecorporation.myengine.core.gui.font.bitmap.BitmapFont;\r\n    import org.simplecorporation.myengine.core.image.Image;\r\n    import org.simplecorporation.myengine.core.input.event.TouchEvent;\r\n    import org.simplecorporation.myengine.core.render.basic.BasicRenderer;\r\n    import org.simplecorporation.myengine.core.render.colour.Colour;\r\n    import org.simplecorporation.myengine.utils.AndroidFileUtils;\r\n    import org.simplecorporation.myengine.utils.ArrayUtils;\r\n    import org.simplecorporation.myengine.utils.FileUtils;\r\n    import org.simplecorporation.myengine.utils.font.FontUtils;\r\n    \r\n    import android.os.Environment;\r\n    import android.util.Log;\r\n\r\n    public class FileTest extends BaseGame {\r\n\t\r\n\tpublic ImageEntity2D image;\r\n\tpublic Colour colour;\r\n\tpublic GUIButton button;\r\n\tpublic GUICheckBox checkBox;\r\n\tpublic AndroidAudio audio;\r\n\tpublic GUIFont bitmapFont;\r\n\tpublic GUIScrollBar scrollBar;\r\n\t\r\n\tpublic GUIScrollBar verticalslider;\r\n\tpublic GUIScrollBar horizontalslider;\r\n\tpublic GUITextDisplayArea textDisplayArea;\r\n\t\r\n\tpublic FileTest() {\r\n\t\tcreateGame();\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void gameCreated() {\r\n\t\t// TODO Auto-generated method stub\r\n\t\timage = new ImageEntity2D(new Image(R.drawable.menubutton));\r\n\t\timage.position.x = 200;\r\n\t\timage.position.y = 200;\r\n\t\timage.width = 200;\r\n\t\timage.height = 60;\r\n\t\timage.rotationVelocity = 1;\r\n\t\tcolour = new Colour(0d, 0d, 0d, 1d);\r\n\t\tbutton = new GUIButton(&quot;AndroidGUIButton&quot; , &quot;Click Me&quot; , new GUIRenderer(new Colour[] {\r\n\t\t\t\tColour.LIGHT_BLUE , Colour.ORANGE , Colour.BLUE\r\n\t\t} , FontUtils.buildGUIFont(&quot;Arial&quot; , Colour.WHITE , 46f)));\r\n\t\tbutton.position.x = 300;\r\n\t\tbutton.position.y = 200;\r\n\t\tbutton.width = 300;\r\n\t\tbutton.height = 60;\r\n\t\tbutton.visible = true;\r\n\t\t\r\n\t\tcheckBox = new GUICheckBox(&quot;AndroidCheckBox&quot; , new GUIRenderer(new Colour[] { Colour.WHITE , Colour.BLUE }));\r\n\t\tcheckBox.position.x = 500;\r\n\t\tcheckBox.position.y = 300;\r\n\t\tcheckBox.width = 100;\r\n\t\tcheckBox.height = 100;\r\n\t\tcheckBox.visible = true;\r\n\t\t\r\n\t\tbitmapFont = new GUIFont(new BitmapFont(new Image(R.drawable.test) , 40, 16));\r\n\t\t\r\n\t\tGUIButton verticalsliderButton = new GUIButton(&quot;Button2&quot; , &quot;&quot; , new GUIRenderer(new Colour[] {\r\n\t\t\t\tColour.ORANGE ,\r\n\t\t\t\tColour.LIGHT_BLUE ,\r\n\t\t\t\tColour.BLUE\r\n\t\t} , FontUtils.buildGUIFont(&quot;Segoe UI&quot; , Colour.WHITE , 20f)));\r\n\t\tverticalsliderButton.width = 100;\r\n\t\tverticalsliderButton.height = 20;\r\n\t\tverticalsliderButton.visible = true;\r\n\t\t\r\n\t\tverticalslider = new GUIScrollBar(&quot;Slider1&quot; , verticalsliderButton , GUISlider.DIRECTION_VERTICAL , 1, new GUIRenderer(new Colour[] { Colour.RED }));\r\n\t\t\r\n\t\tverticalslider.visible = true;\r\n\t\tverticalslider.position.x = 200;\r\n\t\tverticalslider.position.y = 200;\r\n\t\tverticalslider.width = 30;\r\n\t\tverticalslider.height = 100;\r\n\t\t\r\n\t\tGUIButton horizontalsliderButton = new GUIButton(&quot;Button2&quot; , &quot;&quot; , new GUIRenderer(new Colour[] {\r\n\t\t\t\tColour.ORANGE ,\r\n\t\t\t\tColour.LIGHT_BLUE ,\r\n\t\t\t\tColour.BLUE\r\n\t\t} , FontUtils.buildGUIFont(&quot;Segoe UI&quot; , Colour.WHITE , 20f)));\r\n\t\thorizontalsliderButton.width = 20;\r\n\t\thorizontalsliderButton.height = 100;\r\n\t\thorizontalsliderButton.visible = true;\r\n\t\t\r\n\t\thorizontalslider = new GUIScrollBar(&quot;Slider2&quot; , horizontalsliderButton , GUISlider.DIRECTION_HORIZONTAL , 1, new GUIRenderer(new Colour[] { Colour.RED }));\r\n\t\t\r\n\t\thorizontalslider.visible = true;\r\n\t\thorizontalslider.position.x = 300;\r\n\t\thorizontalslider.position.y = 300;\r\n\t\thorizontalslider.width = 100;\r\n\t\thorizontalslider.height = 30;\r\n\t\t\r\n\t\taudio = new AndroidAudio(R.raw.encode , false , false);\r\n\t\t\r\n\t\tList&lt;String&gt; text = ArrayUtils.toStringList(new String[] {\r\n\t\t\t\t&quot;Hello, this test application was made using MyEngine &quot; + Settings.EngineVersion,\r\n\t\t\t\t&quot;with the build &quot; + Settings.EngineBuild + &quot;. Below this message you should find&quot;,\r\n\t\t\t\t&quot;a bitmap font:&quot;\r\n\t\t});\r\n\t\tthis.textDisplayArea = new GUITextDisplayArea(&quot;TextArea&quot;, text, FontUtils.buildGUIFont(&quot;Arial&quot; , Colour.WHITE , 40f), Settings.Window.Size.Width);\r\n\t\tthis.textDisplayArea.position.x = 0;\r\n\t\tthis.textDisplayArea.position.y = 500;\r\n\t\tthis.textDisplayArea.visible = true;\r\n\t\t\r\n\t\tAndroidFileUtils.writeToInternalStorage(&quot;hello.txt&quot;, ArrayUtils.toStringList(new String[] {\r\n\t\t\t\t&quot;Hello World, From hello.txt&quot;\r\n\t\t}));\r\n\t\tthis.textDisplayArea.setText(AndroidFileUtils.readFromInternalStorage(&quot;hello.txt&quot;));\r\n\t\t\r\n\t\tAndroidFileUtils.writeToExternalStorage(&quot;hello.txt&quot;, ArrayUtils.toStringList(new String[] {\r\n\t\t\t\t&quot;Hello World, From hello.txt in an External Storage file :)&quot;\r\n\t\t}));\r\n\t\t\r\n\t\tthis.textDisplayArea.setText(FileUtils.read(&quot;eclipse.txt&quot;, false));\r\n\t\t\r\n\t\tLog.d(&quot;HELLO&quot;, &quot;&quot; + AndroidFileUtils.isExternalStorageWritable() + &quot; &quot; + Environment.getExternalStorageDirectory());\r\n\t}\r\n\t\r\n\tpublic void gameRender() {\r\n\t\tBasicRenderer.setColour(colour);\r\n\t\tBasicRenderer.renderFilledRectangle(0 , 0 , Settings.Window.Size.Width , Settings.Window.Size.Height);\r\n\t\tBasicRenderer.setColour(Colour.BLUE);\r\n\t\tBasicRenderer.renderFilledRectangle(100 , 100 , 100 , 100);\r\n\t\tBasicRenderer.setColour(Colour.WHITE);\r\n\t\tverticalslider.render();\r\n\t\thorizontalslider.render();\r\n\t\timage.render();\r\n\t\tbutton.render();\r\n\t\tcheckBox.render();\r\n\t\ttextDisplayArea.render();\r\n\t\tBasicRenderer.setColour(Colour.WHITE);\r\n\t\tbitmapFont.render(&quot;This is a bitmap font :)&quot; , 10 , 700);\r\n\t}\r\n\t\r\n\tpublic void gameUpdate() {\r\n\t\tbutton.update();\r\n\t\tcheckBox.update();\r\n\t\timage.update();\r\n\t\tverticalslider.update();\r\n\t\thorizontalslider.update();\r\n\t\tif (button.clicked) {\r\n\t\t\tcolour = new Colour(0d , 0d , 0d , 1d);\r\n\t\t\taudio.play();\r\n\t\t}\r\n\t\ttextDisplayArea.update();\r\n\t}\r\n\t\r\n\tpublic void onTouch(TouchEvent e) {\r\n\t\tthis.colour = new Colour(this.colour.getR() + 0.01, this.colour.getG() + 0.01, this.colour.getB() + 0.01);\r\n\t}\r\n\t\r\n    }\r\n\r\nMany thanks in advance.","title":"Android onResume() not being called","body":"<p>for a while I have been creating a game engine that works on Android using Java. Unfortunately I have this problem where the onResume() method does't appear to be called. I am using a Thread to run everything, and when I minimise the app and then go back on the app, it just gives me a blank, black screen. But it DOES work when I turn the screen off and on again.</p>\n\n<p>The code that I am using for the activity:</p>\n\n<pre><code> package org.simplecorporation.myengine.core.android;\n\n import org.simplecorporation.myengine.core.Settings;\n import org.simplecorporation.myengine.core.android.input.AndroidInput;\n import org.simplecorporation.myengine.core.game.BaseGame;\n\n import android.app.Activity;\n import android.content.pm.ActivityInfo;\n import android.os.Bundle;\n import android.view.MotionEvent;\n import android.view.Window;\n import android.view.WindowManager;\n\n public abstract class AndroidActivity extends Activity {\n\n/* The abstract methods*/\npublic abstract void activityCreated();\npublic abstract void activityPaused();\npublic abstract void activityResumed();\npublic abstract void activityStopped();\npublic abstract void activityRestarted();\npublic abstract void activityDestroy();\n\n/* The android display */\npublic AndroidDisplay androidDisplay;\n\n/* The onCreate method */\nprotected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    //Set the title\n    this.setTitle(Settings.Window.Title);\n    //Check the orientation and set it\n    if (AndroidSettings.ScreenOrientation == AndroidSettings.SCREEN_ORIENTATION_PORTRAIT)\n        this.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);\n    else if (AndroidSettings.ScreenOrientation == AndroidSettings.SCREEN_ORIENTATION_LANDSCAPE)\n        this.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);\n    //Check if the activity should be fullscreen\n    if (Settings.Window.Fullscreen) {\n        //Get rid of the title bar\n        this.getWindow().requestFeature(Window.FEATURE_NO_TITLE);\n        //Make the activity fullscreen\n        this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN , WindowManager.LayoutParams.FLAG_FULLSCREEN);\n    }\n}\n\n/* The onCreate method */\nprotected void onCreate(BaseGame androidGame , Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    //Set the title\n    this.setTitle(Settings.Window.Title);\n    //Check the orientation and set it\n    if (AndroidSettings.ScreenOrientation == AndroidSettings.SCREEN_ORIENTATION_PORTRAIT)\n        this.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);\n    else if (AndroidSettings.ScreenOrientation == AndroidSettings.SCREEN_ORIENTATION_LANDSCAPE)\n        this.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);\n    //Check if the activity should be fullscreen\n    if (Settings.Window.Fullscreen) {\n        //Get rid of the title bar\n        this.getWindow().requestFeature(Window.FEATURE_NO_TITLE);\n        //Make the activity fullscreen\n        this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN , WindowManager.LayoutParams.FLAG_FULLSCREEN);\n    }\n    //Create the display\n    androidDisplay = new AndroidDisplay(this , androidGame);\n    //Set the content view\n    this.setContentView(androidDisplay);\n    //Call the activity create method\n    this.activityCreated();\n}\n\n/* Called when the activity is paused */\npublic void onPause() {\n    super.onPause();\n    //Pause the thread\n    this.androidDisplay.androidGameThread.paused = true;\n    //Call the method\n    this.activityPaused();\n}\n\n/* Called when the activity is resumed */\npublic void onResume() {\n    super.onResume();\n    //Resume the thread\n    this.androidDisplay.androidGameThread.paused = false;\n    //Call the method\n    this.activityResumed();\n}\n\n/* Called when the activity is stopped */\npublic void onStop() {\n    super.onStop();\n    //Call the method\n    this.activityStopped();\n}\n\n/* Called when the activity is restarted */\npublic void onRestart() {\n    super.onRestart();\n    //Call the method\n    this.activityRestarted();\n}\n\n/* Called when the activity is destroyed */\npublic void onDestroy() {\n    super.onDestroy();\n    //Call the method\n    this.activityDestroy();\n    //Destroy\n    this.finish();\n}\n }\n</code></pre>\n\n<p>The code that I am using for the thread:</p>\n\n<pre><code>package org.simplecorporation.myengine.core.android;\n\nimport org.simplecorporation.myengine.core.game.BaseGame;\nimport org.simplecorporation.myengine.core.input.InputManager;\n\nimport android.util.Log;\nimport android.view.SurfaceHolder;\n\npublic class AndroidGameThread extends Thread {\n\n/* Is the thread running */\npublic boolean running;\n\n/* Is the thread paused */\npublic boolean paused;\n\n/* The surface holder */\npublic SurfaceHolder surfaceHolder;\n\n/* The android game */\npublic BaseGame androidGame;\n\n/* The constructor */\npublic AndroidGameThread(SurfaceHolder surfaceHolder , BaseGame androidGame) {\n    //Set running to false\n    this.running = false;\n    //Set paused to false\n    this.paused = false;\n    //Assign the surface holder\n    this.surfaceHolder = surfaceHolder;\n    //Assign the android game\n    this.androidGame = androidGame;\n}\n\n/* The method to set the running variable */\npublic void setRunning(boolean running) {\n    this.running = running;\n}\n\n/* Returns whether the thread is running */\npublic boolean isRunning() {\n    return this.running;\n}\n\n/* The run method */\npublic void run() {\n    //Start the game\n    this.androidGame.create();\n    //Run while the variable running is true\n    while (running) {\n        //Check if the thread is paused\n        if (! this.paused) {\n            //Check the input\n            InputManager.checkInput();\n            //Set the game canvas to null\n            AndroidStore.gameCanvas = null;\n            //Try statement\n            try {\n                //Set the game canvas\n                AndroidStore.gameCanvas = this.surfaceHolder.lockCanvas();\n                synchronized (this.surfaceHolder) {\n                    //Update/Render the game\n                    this.androidGame.tick();\n                }\n            } finally {\n                //Check that the canvas isn't null\n                if (AndroidStore.gameCanvas != null) {\n                    this.surfaceHolder.unlockCanvasAndPost(AndroidStore.gameCanvas);\n                }\n            }\n        }\n    }\n}\n\n}\n</code></pre>\n\n<p>Also, to start the thread I use</p>\n\n<pre><code>import org.simplecorporation.myengine.core.Settings;\nimport org.simplecorporation.myengine.core.game.BaseGame;\nimport org.simplecorporation.myengine.core.input.InputManager;\nimport org.simplecorporation.myengine.utils.ScreenUtils;\n\nimport android.app.Activity;\nimport android.graphics.Paint;\nimport android.view.SurfaceHolder;\nimport android.view.SurfaceView;\n\npublic class AndroidDisplay extends SurfaceView implements SurfaceHolder.Callback {\n\n/* The android game */\npublic BaseGame androidGame;\n\n/* The android game thread */\npublic AndroidGameThread androidGameThread;\n\n/* The constructor */\npublic AndroidDisplay(Activity gameActivity , BaseGame androidGame) {\n    //Call the super constructor\n    super(gameActivity);\n\n    //Add the callback\n    this.getHolder().addCallback(this);\n\n    //Set the game activity in the AndroidStore\n    AndroidStore.gameActivity = gameActivity;\n\n    //Set the android game\n    this.androidGame = androidGame;\n\n    //Create the android game thread\n    this.androidGameThread = new AndroidGameThread(this.getHolder(), this.androidGame);\n\n    //Set the surface view focusable\n    this.setFocusable(true);\n}\n\n/* Called when the surface is created */\npublic void surfaceCreated(SurfaceHolder surfaceHolder) {\n    //Create the input\n    InputManager.create();\n    //Set the size of the screen in the settings if full screen\n    if (Settings.Window.Fullscreen) {\n        Settings.Window.Size.Width = ScreenUtils.getScreenWidth();\n        Settings.Window.Size.Height = ScreenUtils.getScreenHeight();\n    } else {\n        //Set the size of the screen in the settings\n        Settings.Window.Size.Width = this.getWidth();\n        Settings.Window.Size.Height = this.getHeight();\n    }\n    //Set the game resources\n    AndroidStore.gameResources = this.getResources();\n    //Create the game\n    this.androidGame.gameCreated();\n    //Create the paint object\n    AndroidStore.gamePaint = new Paint();\n    //Start the android game thread\n    this.androidGameThread.setRunning(true);\n    this.androidGameThread.start();\n}\n\n/* Called when the surface is changed */\npublic void surfaceChanged(SurfaceHolder surfaceHolder , int format , int width , int height) {\n    //Set the size of the screen in the settings\n    Settings.Window.Size.Width = ScreenUtils.getScreenWidth();\n    Settings.Window.Size.Height = ScreenUtils.getScreenHeight();\n}\n\n/* Called when the surface is destroyed */\npublic void surfaceDestroyed(SurfaceHolder surfaceHolder) {\n    //Should the loop continue\n    boolean retry = true;\n    while(retry) {\n        //Try and catch statement\n        try {\n            //Stop the game\n            this.androidGame.gameStopped();\n            //Close the game\n            this.androidGame.gameClosing();\n            //Join the thread\n            this.androidGameThread.join();\n            //Stop the while loop\n            retry = false;\n        } catch (InterruptedException e) {\n\n        }\n    }\n}\n\n}\n</code></pre>\n\n<p>To run all of this I have a class that 'extends' AndroidActvity and uses the following method:</p>\n\n<pre><code>protected void onCreate(Bundle savedInstanceState) {\n    Settings.Window.Title = \"MyEngine Android Tests\";\n    Settings.Android = true;\n    Settings.Video.OpenGL = false;\n    Settings.Audio.SoundEffectVolume = 10;\n    AndroidSettings.ScreenOrientation = 1;\n    Settings.Window.Fullscreen = true;\n    this.onCreate(new FileTest() ,  savedInstanceState);\n}\n</code></pre>\n\n<p>The testing class:</p>\n\n<pre><code>import org.simplecorporation.myengine.core.Settings;\nimport org.simplecorporation.myengine.core.android.AndroidActivity;\nimport org.simplecorporation.myengine.core.android.AndroidSettings;\n\nimport android.os.Bundle;\nimport android.util.Log;\n\npublic class MainActivity extends AndroidActivity {\n\nprotected void onCreate(Bundle savedInstanceState) {\n    Settings.Window.Title = \"MyEngine Android Tests\";\n    Settings.Android = true;\n    Settings.Video.OpenGL = false;\n    Settings.Audio.SoundEffectVolume = 10;\n    AndroidSettings.ScreenOrientation = 1;\n    Settings.Window.Fullscreen = true;\n    this.onCreate(new FileTest() ,  savedInstanceState);\n}\n\n@Override\npublic void activityCreated() {\n    // TODO Auto-generated method stub\n\n}\n\n@Override\npublic void activityPaused() {\n    // TODO Auto-generated method stub\n    Log.d(\"HELLO\", \"I HAVE BEEN PAUSED\");\n}\n\n@Override\npublic void activityResumed() {\n    // TODO Auto-generated method stub\n    Log.d(\"HELLO\", \"I HAVE BEEN RESUMED\");\n}\n\n@Override\npublic void activityStopped() {\n    // TODO Auto-generated method stub\n    Log.d(\"HELLO\", \"I HAVE BEEN STOPPED\");\n}\n\n@Override\npublic void activityRestarted() {\n    // TODO Auto-generated method stub\n    Log.d(\"HELLO\", \"I HAVE BEEN RESTARTED\");\n}\n\n@Override\npublic void activityDestroy() {\n    // TODO Auto-generated method stub\n    Log.d(\"HELLO\", \"I HAVE BEEN DESTROYED\");\n}\n\n}\n</code></pre>\n\n<p>FileTest:</p>\n\n<pre><code>package com.simplecorporation.myengine.android.tests;\n\nimport java.util.List;\n\nimport org.simplecorporation.myengine.core.Settings;\nimport org.simplecorporation.myengine.core.audio.clip.AndroidAudio;\nimport org.simplecorporation.myengine.core.game.BaseGame;\nimport org.simplecorporation.myengine.core.game2d.entity.ImageEntity2D;\nimport org.simplecorporation.myengine.core.gui.GUIButton;\nimport org.simplecorporation.myengine.core.gui.GUICheckBox;\nimport org.simplecorporation.myengine.core.gui.GUIRenderer;\nimport org.simplecorporation.myengine.core.gui.GUIScrollBar;\nimport org.simplecorporation.myengine.core.gui.GUISlider;\nimport org.simplecorporation.myengine.core.gui.GUITextDisplayArea;\nimport org.simplecorporation.myengine.core.gui.font.GUIFont;\nimport org.simplecorporation.myengine.core.gui.font.bitmap.BitmapFont;\nimport org.simplecorporation.myengine.core.image.Image;\nimport org.simplecorporation.myengine.core.input.event.TouchEvent;\nimport org.simplecorporation.myengine.core.render.basic.BasicRenderer;\nimport org.simplecorporation.myengine.core.render.colour.Colour;\nimport org.simplecorporation.myengine.utils.AndroidFileUtils;\nimport org.simplecorporation.myengine.utils.ArrayUtils;\nimport org.simplecorporation.myengine.utils.FileUtils;\nimport org.simplecorporation.myengine.utils.font.FontUtils;\n\nimport android.os.Environment;\nimport android.util.Log;\n\npublic class FileTest extends BaseGame {\n\npublic ImageEntity2D image;\npublic Colour colour;\npublic GUIButton button;\npublic GUICheckBox checkBox;\npublic AndroidAudio audio;\npublic GUIFont bitmapFont;\npublic GUIScrollBar scrollBar;\n\npublic GUIScrollBar verticalslider;\npublic GUIScrollBar horizontalslider;\npublic GUITextDisplayArea textDisplayArea;\n\npublic FileTest() {\n    createGame();\n}\n\n@Override\npublic void gameCreated() {\n    // TODO Auto-generated method stub\n    image = new ImageEntity2D(new Image(R.drawable.menubutton));\n    image.position.x = 200;\n    image.position.y = 200;\n    image.width = 200;\n    image.height = 60;\n    image.rotationVelocity = 1;\n    colour = new Colour(0d, 0d, 0d, 1d);\n    button = new GUIButton(\"AndroidGUIButton\" , \"Click Me\" , new GUIRenderer(new Colour[] {\n            Colour.LIGHT_BLUE , Colour.ORANGE , Colour.BLUE\n    } , FontUtils.buildGUIFont(\"Arial\" , Colour.WHITE , 46f)));\n    button.position.x = 300;\n    button.position.y = 200;\n    button.width = 300;\n    button.height = 60;\n    button.visible = true;\n\n    checkBox = new GUICheckBox(\"AndroidCheckBox\" , new GUIRenderer(new Colour[] { Colour.WHITE , Colour.BLUE }));\n    checkBox.position.x = 500;\n    checkBox.position.y = 300;\n    checkBox.width = 100;\n    checkBox.height = 100;\n    checkBox.visible = true;\n\n    bitmapFont = new GUIFont(new BitmapFont(new Image(R.drawable.test) , 40, 16));\n\n    GUIButton verticalsliderButton = new GUIButton(\"Button2\" , \"\" , new GUIRenderer(new Colour[] {\n            Colour.ORANGE ,\n            Colour.LIGHT_BLUE ,\n            Colour.BLUE\n    } , FontUtils.buildGUIFont(\"Segoe UI\" , Colour.WHITE , 20f)));\n    verticalsliderButton.width = 100;\n    verticalsliderButton.height = 20;\n    verticalsliderButton.visible = true;\n\n    verticalslider = new GUIScrollBar(\"Slider1\" , verticalsliderButton , GUISlider.DIRECTION_VERTICAL , 1, new GUIRenderer(new Colour[] { Colour.RED }));\n\n    verticalslider.visible = true;\n    verticalslider.position.x = 200;\n    verticalslider.position.y = 200;\n    verticalslider.width = 30;\n    verticalslider.height = 100;\n\n    GUIButton horizontalsliderButton = new GUIButton(\"Button2\" , \"\" , new GUIRenderer(new Colour[] {\n            Colour.ORANGE ,\n            Colour.LIGHT_BLUE ,\n            Colour.BLUE\n    } , FontUtils.buildGUIFont(\"Segoe UI\" , Colour.WHITE , 20f)));\n    horizontalsliderButton.width = 20;\n    horizontalsliderButton.height = 100;\n    horizontalsliderButton.visible = true;\n\n    horizontalslider = new GUIScrollBar(\"Slider2\" , horizontalsliderButton , GUISlider.DIRECTION_HORIZONTAL , 1, new GUIRenderer(new Colour[] { Colour.RED }));\n\n    horizontalslider.visible = true;\n    horizontalslider.position.x = 300;\n    horizontalslider.position.y = 300;\n    horizontalslider.width = 100;\n    horizontalslider.height = 30;\n\n    audio = new AndroidAudio(R.raw.encode , false , false);\n\n    List&lt;String&gt; text = ArrayUtils.toStringList(new String[] {\n            \"Hello, this test application was made using MyEngine \" + Settings.EngineVersion,\n            \"with the build \" + Settings.EngineBuild + \". Below this message you should find\",\n            \"a bitmap font:\"\n    });\n    this.textDisplayArea = new GUITextDisplayArea(\"TextArea\", text, FontUtils.buildGUIFont(\"Arial\" , Colour.WHITE , 40f), Settings.Window.Size.Width);\n    this.textDisplayArea.position.x = 0;\n    this.textDisplayArea.position.y = 500;\n    this.textDisplayArea.visible = true;\n\n    AndroidFileUtils.writeToInternalStorage(\"hello.txt\", ArrayUtils.toStringList(new String[] {\n            \"Hello World, From hello.txt\"\n    }));\n    this.textDisplayArea.setText(AndroidFileUtils.readFromInternalStorage(\"hello.txt\"));\n\n    AndroidFileUtils.writeToExternalStorage(\"hello.txt\", ArrayUtils.toStringList(new String[] {\n            \"Hello World, From hello.txt in an External Storage file :)\"\n    }));\n\n    this.textDisplayArea.setText(FileUtils.read(\"eclipse.txt\", false));\n\n    Log.d(\"HELLO\", \"\" + AndroidFileUtils.isExternalStorageWritable() + \" \" + Environment.getExternalStorageDirectory());\n}\n\npublic void gameRender() {\n    BasicRenderer.setColour(colour);\n    BasicRenderer.renderFilledRectangle(0 , 0 , Settings.Window.Size.Width , Settings.Window.Size.Height);\n    BasicRenderer.setColour(Colour.BLUE);\n    BasicRenderer.renderFilledRectangle(100 , 100 , 100 , 100);\n    BasicRenderer.setColour(Colour.WHITE);\n    verticalslider.render();\n    horizontalslider.render();\n    image.render();\n    button.render();\n    checkBox.render();\n    textDisplayArea.render();\n    BasicRenderer.setColour(Colour.WHITE);\n    bitmapFont.render(\"This is a bitmap font :)\" , 10 , 700);\n}\n\npublic void gameUpdate() {\n    button.update();\n    checkBox.update();\n    image.update();\n    verticalslider.update();\n    horizontalslider.update();\n    if (button.clicked) {\n        colour = new Colour(0d , 0d , 0d , 1d);\n        audio.play();\n    }\n    textDisplayArea.update();\n}\n\npublic void onTouch(TouchEvent e) {\n    this.colour = new Colour(this.colour.getR() + 0.01, this.colour.getG() + 0.01, this.colour.getB() + 0.01);\n}\n\n}\n</code></pre>\n\n<p>Many thanks in advance.</p>\n"},{"tags":["java","c","eclipse","dll"],"comments":[{"owner":{"account_id":7195741,"reputation":1,"user_id":6110094,"accept_rate":83,"display_name":"0___________"},"score":0,"creation_date":1694807433,"post_id":77114701,"comment_id":135944746,"body_markdown":"Go through it: https://rollbar.com/blog/java-unsatisfiedlinkerror-runtime-error/#","body":"Go through it: <a href=\"https://rollbar.com/blog/java-unsatisfiedlinkerror-runtime-error/#\" rel=\"nofollow noreferrer\">rollbar.com/blog/java-unsatisfiedlinkerror-runtime-error/#</a>"},{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":1,"creation_date":1694828792,"post_id":77114701,"comment_id":135946723,"body_markdown":"Please provide enough code so others can better understand or reproduce the problem.","body":"Please provide enough code so others can better understand or reproduce the problem."},{"owner":{"account_id":20798008,"reputation":181,"user_id":15274669,"display_name":"majixin"},"score":0,"creation_date":1695051227,"post_id":77114701,"comment_id":135969171,"body_markdown":"Without you posting some parts of your code, or the full message for the exception, it is practically impossible to deduce where/why it&#39;s going wrong.\n\nThat said, an ```UnsatisfiedLinkError``` is highly suggestive. You should have an interface class in your code that defines the functions in the C DLL. At runtime, if these mismatch, you will get an UnsatisfiedLinkError. However, you might also get this when the DLL cannot be found to be loaded. In the case of mismatches, it&#39;s not just the function names that should match, but the arguments once converted to Java type equivalents.","body":"Without you posting some parts of your code, or the full message for the exception, it is practically impossible to deduce where/why it&#39;s going wrong.  That said, an <code>UnsatisfiedLinkError</code> is highly suggestive. You should have an interface class in your code that defines the functions in the C DLL. At runtime, if these mismatch, you will get an UnsatisfiedLinkError. However, you might also get this when the DLL cannot be found to be loaded. In the case of mismatches, it&#39;s not just the function names that should match, but the arguments once converted to Java type equivalents."},{"owner":{"account_id":20798008,"reputation":181,"user_id":15274669,"display_name":"majixin"},"score":0,"creation_date":1695051444,"post_id":77114701,"comment_id":135969219,"body_markdown":"In addition to my earlier comment, but in regards to debugging, you mention the application has been around for years, so it is likely you are using JNA to load the DLL and should find ```Native.loadLibrary``` somewhere in your code. Ensure there&#39;s a try-catch around it and learn how DLL locations are resolved on your OS. It could be the DLL is not getting resolved. If it is, then you&#39;ve not correctly defined the additional functions in Java correctly, or you have but are still using an older DLL that doesn&#39;t have the implementation.","body":"In addition to my earlier comment, but in regards to debugging, you mention the application has been around for years, so it is likely you are using JNA to load the DLL and should find <code>Native.loadLibrary</code> somewhere in your code. Ensure there&#39;s a try-catch around it and learn how DLL locations are resolved on your OS. It could be the DLL is not getting resolved. If it is, then you&#39;ve not correctly defined the additional functions in Java correctly, or you have but are still using an older DLL that doesn&#39;t have the implementation."}],"owner":{"account_id":18246146,"reputation":11,"user_id":13282218,"display_name":"Bryan Van Dyke"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":40,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":0,"score":0,"last_activity_date":1694803165,"creation_date":1694803165,"question_id":77114701,"body_markdown":"I have a java application which spins off a c dll thread.  This has worked for years.  Now, I need to add an argument to the interface between java and the c dll.  I added the necessary additional arguments to both the java and c code.  I screwed up because now I get a UnsatisfiedLinkError when the c dll is supposed to be spun off.  I use eclipse development environment.  My question is:  how do I debug this error in eclipse?  \r\n\r\nThanks for your consideration.  \r\n\r\nCurrently, I put a break point in the java code where the c dll is spun off. At the break point, I was hoping to be able to interrogate what the java is looking for so I can find out where I made my mistake.  However, the eclipse go straight to UnsatisfiedLinkError with no opportunity that I can see to interrogate what it is looking for.  Is there any available tool, or part of Eclipse that I don&#39;t know about that can tell me what the java is looking for?","title":"debugging in eclipse the link between a java application and a c dll thread","body":"<p>I have a java application which spins off a c dll thread.  This has worked for years.  Now, I need to add an argument to the interface between java and the c dll.  I added the necessary additional arguments to both the java and c code.  I screwed up because now I get a UnsatisfiedLinkError when the c dll is supposed to be spun off.  I use eclipse development environment.  My question is:  how do I debug this error in eclipse?</p>\n<p>Thanks for your consideration.</p>\n<p>Currently, I put a break point in the java code where the c dll is spun off. At the break point, I was hoping to be able to interrogate what the java is looking for so I can find out where I made my mistake.  However, the eclipse go straight to UnsatisfiedLinkError with no opportunity that I can see to interrogate what it is looking for.  Is there any available tool, or part of Eclipse that I don't know about that can tell me what the java is looking for?</p>\n"},{"tags":["java","spring","mongodb","caching","ttl"],"comments":[{"owner":{"account_id":5979593,"reputation":139,"user_id":6059956,"display_name":"Vamsi"},"score":0,"creation_date":1694802900,"post_id":77102843,"comment_id":135944070,"body_markdown":"we don&#39;t have control over oAuth server, we are consuming the downstream service as a consumer app. And anyway I am able to figure this out using this mongo feature https://www.mongodb.com/docs/manual/tutorial/expire-data/#expire-documents-after-a-specified-number-of-seconds","body":"we don&#39;t have control over oAuth server, we are consuming the downstream service as a consumer app. And anyway I am able to figure this out using this mongo feature <a href=\"https://www.mongodb.com/docs/manual/tutorial/expire-data/#expire-documents-after-a-specified-number-of-seconds\" rel=\"nofollow noreferrer\">mongodb.com/docs/manual/tutorial/expire-data/&hellip;</a>"}],"answers":[{"tags":[],"owner":{"account_id":5979593,"reputation":139,"user_id":6059956,"display_name":"Vamsi"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1694803021,"creation_date":1694803021,"answer_id":77114690,"question_id":77102843,"body_markdown":"This can be worked out by setting Mongo TTL to &quot;0&quot; and set the expiry date to the TTL indexed Date field to make it expire at a specific time(at token expiry time).\r\nhttps://www.mongodb.com/docs/manual/tutorial/expire-data/#expire-documents-after-a-specified-number-of-seconds","title":"How do i efficiently store an OAuth token (TTL) without using in-memory cache in Java?","body":"<p>This can be worked out by setting Mongo TTL to &quot;0&quot; and set the expiry date to the TTL indexed Date field to make it expire at a specific time(at token expiry time).\n<a href=\"https://www.mongodb.com/docs/manual/tutorial/expire-data/#expire-documents-after-a-specified-number-of-seconds\" rel=\"nofollow noreferrer\">https://www.mongodb.com/docs/manual/tutorial/expire-data/#expire-documents-after-a-specified-number-of-seconds</a></p>\n"}],"owner":{"account_id":5979593,"reputation":139,"user_id":6059956,"display_name":"Vamsi"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":27,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77114690,"answer_count":1,"score":0,"last_activity_date":1694803021,"creation_date":1694678285,"question_id":77102843,"body_markdown":"I am using EHCache to store a dynamic TTL OAuth Token but I maintain multiple pods in Kubernetes and end up making multiple OAuth Token REST calls to get latest token and due to less traffic in Pods, the API performance(P90, P95) is getting bad.\r\n\r\nI tried to save OAuth token to MongoDB, but due to static TTL index, I can&#39;t dynamically create TTL index and even can&#39;t use expiry seconds to calculate based on current time, as it may cause concurrent threads ending up reading/writing the token simultaneously.\r\n\r\nLooking for a better design suggestions to handle dynamic oauth token management without using any In-Memory caches in Java environment. Looking for better solutions using programmatic approach with Java and MongoDB.","title":"How do i efficiently store an OAuth token (TTL) without using in-memory cache in Java?","body":"<p>I am using EHCache to store a dynamic TTL OAuth Token but I maintain multiple pods in Kubernetes and end up making multiple OAuth Token REST calls to get latest token and due to less traffic in Pods, the API performance(P90, P95) is getting bad.</p>\n<p>I tried to save OAuth token to MongoDB, but due to static TTL index, I can't dynamically create TTL index and even can't use expiry seconds to calculate based on current time, as it may cause concurrent threads ending up reading/writing the token simultaneously.</p>\n<p>Looking for a better design suggestions to handle dynamic oauth token management without using any In-Memory caches in Java environment. Looking for better solutions using programmatic approach with Java and MongoDB.</p>\n"},{"tags":["java","spring","spring-boot","design-patterns"],"comments":[{"owner":{"account_id":27243397,"reputation":1316,"user_id":20769158,"display_name":"scrhartley"},"score":0,"creation_date":1694807639,"post_id":77114608,"comment_id":135944782,"body_markdown":"The Spring team generally advocates constructor injection and has nothing against constructors. [This question](https://stackoverflow.com/questions/40620000/spring-autowire-on-properties-vs-constructor) covers constructor injection and this Spring doc [Constructor-based or setter-based DI](https://docs.spring.io/spring-framework/reference/core/beans/dependencies/factory-collaborators.html#beans-constructor-vs-setter-injection). People use @Autowired on fields due to laziness. Also: [@Autowired docs](https://docs.spring.io/spring-framework/reference/core/beans/annotation-config/autowired.html).","body":"The Spring team generally advocates constructor injection and has nothing against constructors. <a href=\"https://stackoverflow.com/questions/40620000/spring-autowire-on-properties-vs-constructor\">This question</a> covers constructor injection and this Spring doc <a href=\"https://docs.spring.io/spring-framework/reference/core/beans/dependencies/factory-collaborators.html#beans-constructor-vs-setter-injection\" rel=\"nofollow noreferrer\">Constructor-based or setter-based DI</a>. People use @Autowired on fields due to laziness. Also: <a href=\"https://docs.spring.io/spring-framework/reference/core/beans/annotation-config/autowired.html\" rel=\"nofollow noreferrer\">@Autowired docs</a>."}],"owner":{"account_id":6307461,"reputation":365,"user_id":4900133,"display_name":"enthusiast"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":29,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694801880,"creation_date":1694801880,"question_id":77114608,"body_markdown":"Below is the scenario where I need a solution.\r\nclass B is a generic solution where I need to inject different instances of C.\r\nA and X will call B and B will work with the corresponding instances of C.\r\n\r\nI need a List&lt;D&gt; as well autowired to class B, since B object is created using new operator its not possible, and I dont want to pass List&lt;D&gt; through constructor.\r\n\r\nWhat would be the ideal solution?\r\n\r\nI could have passed the C object in the b.method argument but thats not a good practise I presume.\r\n\r\n    @Bean(name=&quot;instance1&quot;)\r\n     public B createB() {\r\n     return new B(new C(&quot;value1&quot;));\r\n     }\r\n    \r\n    ---------------------\r\n    \r\n    @Bean(name=&quot;instance2&quot;)\r\n     public B createB() {\r\n     return new B(new C(&quot;value2&quot;));\r\n     }\r\n    \r\n    ---------------------\r\n    \r\n    public class A {\r\n    @Autowired\r\n    @Qualifier(&quot;instance1&quot;)\r\n    private B b;\r\n     \r\n    b.method();\r\n    \r\n    }\r\n    \r\n    ---------------------\r\n    \r\n    public class X {\r\n    @Autowired\r\n    @Qualifier(&quot;instance2&quot;)\r\n    private B b;\r\n     \r\n    b.method();\r\n    \r\n    }\r\n    \r\n    ---------------------\r\n    \r\n    public class B {\r\n    \r\n    @Autowired\r\n    private List&lt;D&gt; dList;\r\n    \r\n    B(C c) {\r\n    this.c = c;\r\n    }\r\n    c.method();\r\n    dList.forEach(d -&gt; //do something);\r\n    \r\n    }\r\n\r\n----------------------------\r\n","title":"Springboot dependency management design","body":"<p>Below is the scenario where I need a solution.\nclass B is a generic solution where I need to inject different instances of C.\nA and X will call B and B will work with the corresponding instances of C.</p>\n<p>I need a List as well autowired to class B, since B object is created using new operator its not possible, and I dont want to pass List through constructor.</p>\n<p>What would be the ideal solution?</p>\n<p>I could have passed the C object in the b.method argument but thats not a good practise I presume.</p>\n<pre><code>@Bean(name=&quot;instance1&quot;)\n public B createB() {\n return new B(new C(&quot;value1&quot;));\n }\n\n---------------------\n\n@Bean(name=&quot;instance2&quot;)\n public B createB() {\n return new B(new C(&quot;value2&quot;));\n }\n\n---------------------\n\npublic class A {\n@Autowired\n@Qualifier(&quot;instance1&quot;)\nprivate B b;\n \nb.method();\n\n}\n\n---------------------\n\npublic class X {\n@Autowired\n@Qualifier(&quot;instance2&quot;)\nprivate B b;\n \nb.method();\n\n}\n\n---------------------\n\npublic class B {\n\n@Autowired\nprivate List&lt;D&gt; dList;\n\nB(C c) {\nthis.c = c;\n}\nc.method();\ndList.forEach(d -&gt; //do something);\n\n}\n</code></pre>\n<hr />\n"},{"tags":["java","android","service","android-pendingintent"],"comments":[{"owner":{"account_id":6485263,"reputation":623,"user_id":5021056,"display_name":"ryankuck"},"score":0,"creation_date":1694814982,"post_id":77114489,"comment_id":135945798,"body_markdown":"Can you post the flow of data behavior that you expect, such as from the service to the activity or vice versa, and then note for us how far the data gets when you debug it and specify where exactly the data is not showing as expected?","body":"Can you post the flow of data behavior that you expect, such as from the service to the activity or vice versa, and then note for us how far the data gets when you debug it and specify where exactly the data is not showing as expected?"},{"owner":{"account_id":3366602,"reputation":611,"user_id":2827025,"display_name":"anemomylos"},"score":1,"creation_date":1694854417,"post_id":77114489,"comment_id":135948211,"body_markdown":"Do you request the runtime permissions? https://developer.android.com/develop/ui/views/notifications/notification-permission. \nDeclaring permissions in the manifest is not enough, you must also ask the user to enable them at runtime (when the application starts or the user selects to enable a feature).","body":"Do you request the runtime permissions? <a href=\"https://developer.android.com/develop/ui/views/notifications/notification-permission\" rel=\"nofollow noreferrer\">developer.android.com/develop/ui/views/notifications/&hellip;</a>.  Declaring permissions in the manifest is not enough, you must also ask the user to enable them at runtime (when the application starts or the user selects to enable a feature)."},{"owner":{"account_id":29454838,"reputation":11,"user_id":22570939,"display_name":"Nikollas Ohta"},"score":1,"creation_date":1694863153,"post_id":77114489,"comment_id":135949022,"body_markdown":"@ryankuck This is the flow I planned:\n\n1. With an intent, I start &quot;MyService&quot; in the &quot;MainActivity&quot; when the app is launched.\n2. When &quot;MyService&quot; starts, it reads the Light Sensor.\n3. After reading the data, it is shared with the &quot;MainActivity&quot; via SharedPreferences.\n4. In the &quot;MainActivity,&quot; I should access SharedPreferences and display it on the screen.\n5. Later, a function would be implemented to notify the user when there is a significant change in the Light Sensor.","body":"@ryankuck This is the flow I planned:  1. With an intent, I start &quot;MyService&quot; in the &quot;MainActivity&quot; when the app is launched. 2. When &quot;MyService&quot; starts, it reads the Light Sensor. 3. After reading the data, it is shared with the &quot;MainActivity&quot; via SharedPreferences. 4. In the &quot;MainActivity,&quot; I should access SharedPreferences and display it on the screen. 5. Later, a function would be implemented to notify the user when there is a significant change in the Light Sensor."},{"owner":{"account_id":29454838,"reputation":11,"user_id":22570939,"display_name":"Nikollas Ohta"},"score":1,"creation_date":1694864917,"post_id":77114489,"comment_id":135949195,"body_markdown":"@anemomylos thanks! I add the permission and updated `pendingIntent` with &quot;FLAG_IMMUTABLE&quot;. Working fine now.","body":"@anemomylos thanks! I add the permission and updated <code>pendingIntent</code> with &quot;FLAG_IMMUTABLE&quot;. Working fine now."}],"owner":{"account_id":29454838,"reputation":11,"user_id":22570939,"display_name":"Nikollas Ohta"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":29,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1694801437,"creation_date":1694800438,"question_id":77114489,"body_markdown":"I&#39;m making a simple light-sensor app, but as my title says, they never appear.\r\n\r\nIn my `manifest.xml`:\r\n\r\n```\r\n&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\r\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;\r\n\r\n    &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.POST_NOTIFICATIONS&quot; /&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot; /&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot; /&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot; /&gt;\r\n\r\n    &lt;application\r\n        android:allowBackup=&quot;true&quot;\r\n        android:icon=&quot;@mipmap/ic_launcher&quot;\r\n        android:label=&quot;@string/app_name&quot;\r\n        android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;\r\n        android:supportsRtl=&quot;true&quot;\r\n        android:theme=&quot;@style/Base.Theme.Lightsensorreader&quot;&gt;\r\n        &lt;activity android:name=&quot;.MainActivity&quot;\r\n            android:exported=&quot;true&quot;&gt;\r\n            &lt;intent-filter&gt;\r\n                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;\r\n\r\n                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;\r\n            &lt;/intent-filter&gt;\r\n        &lt;/activity&gt;\r\n        &lt;service\r\n            android:name=&quot;.MyService&quot;\r\n            android:enabled=&quot;true&quot;\r\n            android:exported=&quot;false&quot; /&gt;\r\n    &lt;/application&gt;\r\n\r\n&lt;/manifest&gt;\r\n```\r\n\r\nIn `MainActivity.java`, where I try to receive the data from MyService and put it on the screen:\r\n\r\n\r\n   \r\n```\r\nprivate TextView lightValueTextView;\r\nprivate SharedPreferences sharedPreferences;\r\n\r\n@Override\r\n     protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_main);\r\n\r\n        lightValueTextView = findViewById(R.id.lightValueTV);\r\n        sharedPreferences = PreferenceManager.getDefaultSharedPreferences(this);\r\n\r\n        Intent serviceIntent = new Intent(this, MyService.class);\r\n        startService(serviceIntent);\r\n    }\r\n\r\n    @Override\r\n    protected void onResume() {\r\n        super.onResume();\r\n\r\n        float lightValue = sharedPreferences.getFloat(&quot;light_value&quot;, 0);\r\n        lightValueTextView.setText(&quot;Light sensor value: &quot; + lightValue);\r\n    }\r\n```\r\n\r\nAnd finally the `MyService.java`, which contains the notification logic using PendingIntent and tries to use SharedPreferences.\r\n    \r\n```\r\nprivate SensorManager sensorManager;\r\n    private Sensor lightSensor;\r\n    private SharedPreferences sharedPreferences;\r\n    private SharedPreferences.Editor editor;\r\n\r\n    @Override\r\n    public void onCreate() {\r\n        super.onCreate();\r\n\r\n        sensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE);\r\n        lightSensor = sensorManager.getDefaultSensor(Sensor.TYPE_LIGHT);\r\n        sharedPreferences = PreferenceManager.getDefaultSharedPreferences(this);\r\n        editor = sharedPreferences.edit();\r\n\r\n        if (lightSensor != null) {\r\n            sensorManager.registerListener(this, lightSensor, SensorManager.SENSOR_DELAY_NORMAL);\r\n        }\r\n\r\n        createNotificationChannel();\r\n    }\r\n\r\n    @Override\r\n    public void onDestroy() {\r\n        super.onDestroy();\r\n        sensorManager.unregisterListener(this);\r\n    }\r\n\r\n    @Override\r\n    public void onSensorChanged(SensorEvent event) {\r\n        if (event.sensor.getType() == Sensor.TYPE_LIGHT) {\r\n            float lightValue = event.values[0];\r\n\r\n            editor.putFloat(&quot;light_value&quot;, lightValue);\r\n            editor.apply();\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public void onAccuracyChanged(Sensor sensor, int accuracy) {\r\n    }\r\n\r\n    @Override\r\n    public IBinder onBind(Intent intent) {\r\n        return new Binder();\r\n    }\r\n\r\n    private void createNotificationChannel() {\r\n        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {\r\n            String channelId = &quot;light_sensor_notification_channel&quot;;\r\n            String channelName = &quot;Light Sensor Notification Channel&quot;;\r\n            int importance = NotificationManager.IMPORTANCE_DEFAULT;\r\n            NotificationChannel channel = new NotificationChannel(channelId, channelName, importance);\r\n            channel.enableLights(true);\r\n            channel.setLightColor(Color.RED);\r\n\r\n            NotificationManager notificationManager = getSystemService(NotificationManager.class);\r\n            notificationManager.createNotificationChannel(channel);\r\n        }\r\n    }\r\n\r\n    private void sendNotification(String title, String message) {\r\n        Intent intent = new Intent(this, MainActivity.class);\r\n        PendingIntent pendingIntent = PendingIntent.getActivity(this, 0, intent, PendingIntent.FLAG_UPDATE_CURRENT);\r\n\r\n        NotificationCompat.Builder builder = new NotificationCompat.Builder(this, &quot;light_sensor_notification_channel&quot;)\r\n                .setSmallIcon(R.mipmap.ic_launcher)\r\n                .setContentTitle(title)\r\n                .setContentText(message)\r\n                .setContentIntent(pendingIntent)\r\n                .setAutoCancel(true);\r\n\r\n        NotificationManagerCompat notificationManager = NotificationManagerCompat.from(this);\r\n\r\n        notificationManager.notify(0, builder.build());\r\n    }\r\n```\r\n\r\n\r\n\r\nI have also tested the &quot;not deprecated&quot; methods of SharedPreferences. Any ideas?","title":"Android never sent notifications","body":"<p>I'm making a simple light-sensor app, but as my title says, they never appear.</p>\n<p>In my <code>manifest.xml</code>:</p>\n<pre><code>&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;\n\n    &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;\n    &lt;uses-permission android:name=&quot;android.permission.POST_NOTIFICATIONS&quot; /&gt;\n    &lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot; /&gt;\n    &lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot; /&gt;\n    &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;\n    &lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot; /&gt;\n\n    &lt;application\n        android:allowBackup=&quot;true&quot;\n        android:icon=&quot;@mipmap/ic_launcher&quot;\n        android:label=&quot;@string/app_name&quot;\n        android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;\n        android:supportsRtl=&quot;true&quot;\n        android:theme=&quot;@style/Base.Theme.Lightsensorreader&quot;&gt;\n        &lt;activity android:name=&quot;.MainActivity&quot;\n            android:exported=&quot;true&quot;&gt;\n            &lt;intent-filter&gt;\n                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;\n\n                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;\n            &lt;/intent-filter&gt;\n        &lt;/activity&gt;\n        &lt;service\n            android:name=&quot;.MyService&quot;\n            android:enabled=&quot;true&quot;\n            android:exported=&quot;false&quot; /&gt;\n    &lt;/application&gt;\n\n&lt;/manifest&gt;\n</code></pre>\n<p>In <code>MainActivity.java</code>, where I try to receive the data from MyService and put it on the screen:</p>\n<pre><code>private TextView lightValueTextView;\nprivate SharedPreferences sharedPreferences;\n\n@Override\n     protected void onCreate(@Nullable Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n\n        lightValueTextView = findViewById(R.id.lightValueTV);\n        sharedPreferences = PreferenceManager.getDefaultSharedPreferences(this);\n\n        Intent serviceIntent = new Intent(this, MyService.class);\n        startService(serviceIntent);\n    }\n\n    @Override\n    protected void onResume() {\n        super.onResume();\n\n        float lightValue = sharedPreferences.getFloat(&quot;light_value&quot;, 0);\n        lightValueTextView.setText(&quot;Light sensor value: &quot; + lightValue);\n    }\n</code></pre>\n<p>And finally the <code>MyService.java</code>, which contains the notification logic using PendingIntent and tries to use SharedPreferences.</p>\n<pre><code>private SensorManager sensorManager;\n    private Sensor lightSensor;\n    private SharedPreferences sharedPreferences;\n    private SharedPreferences.Editor editor;\n\n    @Override\n    public void onCreate() {\n        super.onCreate();\n\n        sensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE);\n        lightSensor = sensorManager.getDefaultSensor(Sensor.TYPE_LIGHT);\n        sharedPreferences = PreferenceManager.getDefaultSharedPreferences(this);\n        editor = sharedPreferences.edit();\n\n        if (lightSensor != null) {\n            sensorManager.registerListener(this, lightSensor, SensorManager.SENSOR_DELAY_NORMAL);\n        }\n\n        createNotificationChannel();\n    }\n\n    @Override\n    public void onDestroy() {\n        super.onDestroy();\n        sensorManager.unregisterListener(this);\n    }\n\n    @Override\n    public void onSensorChanged(SensorEvent event) {\n        if (event.sensor.getType() == Sensor.TYPE_LIGHT) {\n            float lightValue = event.values[0];\n\n            editor.putFloat(&quot;light_value&quot;, lightValue);\n            editor.apply();\n        }\n    }\n\n    @Override\n    public void onAccuracyChanged(Sensor sensor, int accuracy) {\n    }\n\n    @Override\n    public IBinder onBind(Intent intent) {\n        return new Binder();\n    }\n\n    private void createNotificationChannel() {\n        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {\n            String channelId = &quot;light_sensor_notification_channel&quot;;\n            String channelName = &quot;Light Sensor Notification Channel&quot;;\n            int importance = NotificationManager.IMPORTANCE_DEFAULT;\n            NotificationChannel channel = new NotificationChannel(channelId, channelName, importance);\n            channel.enableLights(true);\n            channel.setLightColor(Color.RED);\n\n            NotificationManager notificationManager = getSystemService(NotificationManager.class);\n            notificationManager.createNotificationChannel(channel);\n        }\n    }\n\n    private void sendNotification(String title, String message) {\n        Intent intent = new Intent(this, MainActivity.class);\n        PendingIntent pendingIntent = PendingIntent.getActivity(this, 0, intent, PendingIntent.FLAG_UPDATE_CURRENT);\n\n        NotificationCompat.Builder builder = new NotificationCompat.Builder(this, &quot;light_sensor_notification_channel&quot;)\n                .setSmallIcon(R.mipmap.ic_launcher)\n                .setContentTitle(title)\n                .setContentText(message)\n                .setContentIntent(pendingIntent)\n                .setAutoCancel(true);\n\n        NotificationManagerCompat notificationManager = NotificationManagerCompat.from(this);\n\n        notificationManager.notify(0, builder.build());\n    }\n</code></pre>\n<p>I have also tested the &quot;not deprecated&quot; methods of SharedPreferences. Any ideas?</p>\n"},{"tags":["java","multithreading"],"comments":[{"owner":{"account_id":465573,"reputation":192694,"user_id":869736,"accept_rate":82,"display_name":"Louis Wasserman"},"score":1,"creation_date":1694801490,"post_id":77114559,"comment_id":135943848,"body_markdown":"At a guess, you might need to set the fairness of the semaphores (e.g. `new Semaphore(1, true)`).","body":"At a guess, you might need to set the fairness of the semaphores (e.g. <code>new Semaphore(1, true)</code>)."},{"owner":{"account_id":2709823,"reputation":10716,"user_id":2338547,"display_name":"markspace"},"score":1,"creation_date":1694804248,"post_id":77114559,"comment_id":135944261,"body_markdown":"Is this an assignment?  Are you required or allowed to use the built-in class `Semaphore`?","body":"Is this an assignment?  Are you required or allowed to use the built-in class <code>Semaphore</code>?"},{"owner":{"account_id":2994830,"reputation":1,"user_id":2541560,"display_name":"Kayaman"},"score":0,"creation_date":1694804363,"post_id":77114559,"comment_id":135944282,"body_markdown":"Shouldn&#39;t the writer semaphore also have a permit initially? Otherwise there won&#39;t be a permit for the writer until all readers have finished and `writerSemaphore.release()` gives a permit allowing the writers to run.","body":"Shouldn&#39;t the writer semaphore also have a permit initially? Otherwise there won&#39;t be a permit for the writer until all readers have finished and <code>writerSemaphore.release()</code> gives a permit allowing the writers to run."}],"owner":{"account_id":3799294,"reputation":25,"user_id":3153356,"display_name":"user3153356"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":28,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694801317,"creation_date":1694801317,"question_id":77114559,"body_markdown":"I am new to multithreading and trying to solve the readers writers problem. Below the code which I have written.\r\n\r\n    public class ReaderWriterProblem implements Runnable {\r\n      \tSemaphore readerSemaphore;\r\n    \tSemaphore writerSemaphore;\r\n    \tstatic int currentReadingThreads = 0;\r\n    \r\n    \tpublic ReaderWriterProblem(Semaphore readerSemaphore, Semaphore writerSemaphore) {\r\n    \t\tthis.readerSemaphore = readerSemaphore;\r\n    \t\tthis.writerSemaphore = writerSemaphore;\r\n    \t}\r\n    \r\n    \tpublic void enterCriticalSection() throws InterruptedException {\r\n    \t\tif(!Thread.currentThread().getName().startWith(&quot;Reader&quot;)) {\r\n    \t\t\twriterSemaphore.acquire();\r\n    \t\t\t\r\n    \t\t\tSystem.out.println(Thread.currentThread().getName()+&quot; acquired lock&quot;);\r\n    \t\t\tThread.sleep(1000);\r\n    \t\t\t\r\n    \t\t\tSystem.out.println(Thread.currentThread().getName()+&quot; going to release lock&quot;);\r\n    \t\t\treaderSemaphore.release();\r\n    \t\t\twriterSemaphore.release();\r\n    \t\t}\r\n    \t\t\r\n    \t\tif(Thread.currentThread().getName().startWith(&quot;Reader&quot;)) {\r\n    \t\t\tif(currentReadingThreads == 0)\r\n    \t\t\t\treaderSemaphore.acquire();\r\n    \t\t\t\r\n    \t\t\tcurrentReadingThreads = currentReadingThreads + 1;\r\n    \t\t\t\r\n    \t\t\tSystem.out.println(Thread.currentThread().getName()+&quot; in critical section&quot;);\r\n    \t\t\tThread.sleep(1000);\r\n    \t\t\t\r\n    \t\t\tSystem.out.println(Thread.currentThread().getName()+&quot; going to leave critical section&quot;);\r\n    \t\t\tcurrentReadingThreads = currentReadingThreads - 1;\r\n    \r\n    \t\t\tif(currentReadingThreads == 0) {\r\n    \t\t\t\treaderSemaphore.release();\r\n    \t\t\t\twriterSemaphore.release();\r\n    \t\t\t}\r\n    \t\t}\r\n    \t}\r\n    \r\n    \t@Override\r\n    \tpublic void run() {\r\n    \t\ttry {\r\n    \t\t\tenterCriticalSection();\r\n    \t\t} catch(InterruptedException e) {\r\n    \t\t\te.printStackTrace();\r\n    \t\t}\r\n    \t}\r\n    \r\n    \tpublic static void main(String args[]) {\r\n    \t\tSemaphore readerSemaphore = new Semaphore(1);\r\n    \t\tSemaphore writerSemaphore = new Semaphore(0);\r\n    \t\t\r\n    \t\tint readerThreadCounter = 0, writerThreadCounter = 0;\r\n    \t\t\r\n    \t\tfor(int i = 0; i &lt; 10; i++) {\r\n    \t\t\tThread readerThread1 = new Thread(new ReaderWriterProblem(readerSemaphore, writerSemaphore), &quot;Reader Thread &quot;+readerThreadCounter);\r\n    \t\t\treaderThreadCounter = readerThreadCounter + 1;\r\n    \r\n    \t\t\tThread readerThread2 = new Thread(new ReaderWriterProblem(readerSemaphore, writerSemaphore), &quot;Reader Thread &quot;+readerThreadCounter);\r\n    \t\t\treaderThreadCounter = readerThreadCounter + 1;\r\n    \r\n    \t\t\tThread writerThread1 = new Thread(new ReaderWriterProblem(readerSemaphore, writerSemaphore), &quot;Writer Thread &quot;+readerThreadCounter);\r\n    \t\t\treaderThreadCounter = readerThreadCounter + 1;\r\n    \r\n    \t\t\tThread writerThread2 = new Thread(new ReaderWriterProblem(readerSemaphore, writerSemaphore), &quot;Writer Thread &quot;+readerThreadCounter);\r\n    \t\t\treaderThreadCounter = readerThreadCounter + 1;\r\n    \r\n    \t\t\tThread readerThread3 = new Thread(new ReaderWriterProblem(readerSemaphore, writerSemaphore), &quot;Reader Thread &quot;+readerThreadCounter);\r\n    \t\t\treaderThreadCounter = readerThreadCounter + 1;\r\n    \t\t\t\r\n    \t\t\treaderThread1.start();\r\n    \t\t\treaderThread2.start();\r\n    \t\t\twriterThread1.start();\r\n    \t\t\twriterThread2.start();\r\n    \t\t\treaderThread3.start();\r\n    \t\t}\r\n    \t}\r\n    }\r\n\r\nWhen I try to run the above implementation, the reader acquires the lock and executes first and at last all the writers thread acquires the lock. The writer thread doesn&#39;t execute in-between the reader threads. Could you please let me know what is the issue over here\r\n\r\nOutput below:\r\n\r\n    Reader Thread 0 is critical section\r\n    Reader Thread 6 is critical section\r\n    .\r\n    .\r\n    .\r\n    .\r\n    Reader Thread 0 is going to leave critical section\r\n    Reader Thread 6 is going to leave critical section\r\n    .\r\n    .\r\n    .\r\n    .\r\n    Writer Thread 0 acquired lock\r\n    Writer Thread 0 going to release lock\r\n    Writer Thread 1 acquired lock\r\n    Writer Thread 1 going to release lock\r\n    .\r\n    .\r\n    .\r\n    .\r\n    Writer Thread 19 acquired lock\r\n    Writer Thread 19 going to release lock\r\n\r\n\r\n","title":"Reader writer Multithreading implementation","body":"<p>I am new to multithreading and trying to solve the readers writers problem. Below the code which I have written.</p>\n<pre><code>public class ReaderWriterProblem implements Runnable {\n    Semaphore readerSemaphore;\n    Semaphore writerSemaphore;\n    static int currentReadingThreads = 0;\n\n    public ReaderWriterProblem(Semaphore readerSemaphore, Semaphore writerSemaphore) {\n        this.readerSemaphore = readerSemaphore;\n        this.writerSemaphore = writerSemaphore;\n    }\n\n    public void enterCriticalSection() throws InterruptedException {\n        if(!Thread.currentThread().getName().startWith(&quot;Reader&quot;)) {\n            writerSemaphore.acquire();\n            \n            System.out.println(Thread.currentThread().getName()+&quot; acquired lock&quot;);\n            Thread.sleep(1000);\n            \n            System.out.println(Thread.currentThread().getName()+&quot; going to release lock&quot;);\n            readerSemaphore.release();\n            writerSemaphore.release();\n        }\n        \n        if(Thread.currentThread().getName().startWith(&quot;Reader&quot;)) {\n            if(currentReadingThreads == 0)\n                readerSemaphore.acquire();\n            \n            currentReadingThreads = currentReadingThreads + 1;\n            \n            System.out.println(Thread.currentThread().getName()+&quot; in critical section&quot;);\n            Thread.sleep(1000);\n            \n            System.out.println(Thread.currentThread().getName()+&quot; going to leave critical section&quot;);\n            currentReadingThreads = currentReadingThreads - 1;\n\n            if(currentReadingThreads == 0) {\n                readerSemaphore.release();\n                writerSemaphore.release();\n            }\n        }\n    }\n\n    @Override\n    public void run() {\n        try {\n            enterCriticalSection();\n        } catch(InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n\n    public static void main(String args[]) {\n        Semaphore readerSemaphore = new Semaphore(1);\n        Semaphore writerSemaphore = new Semaphore(0);\n        \n        int readerThreadCounter = 0, writerThreadCounter = 0;\n        \n        for(int i = 0; i &lt; 10; i++) {\n            Thread readerThread1 = new Thread(new ReaderWriterProblem(readerSemaphore, writerSemaphore), &quot;Reader Thread &quot;+readerThreadCounter);\n            readerThreadCounter = readerThreadCounter + 1;\n\n            Thread readerThread2 = new Thread(new ReaderWriterProblem(readerSemaphore, writerSemaphore), &quot;Reader Thread &quot;+readerThreadCounter);\n            readerThreadCounter = readerThreadCounter + 1;\n\n            Thread writerThread1 = new Thread(new ReaderWriterProblem(readerSemaphore, writerSemaphore), &quot;Writer Thread &quot;+readerThreadCounter);\n            readerThreadCounter = readerThreadCounter + 1;\n\n            Thread writerThread2 = new Thread(new ReaderWriterProblem(readerSemaphore, writerSemaphore), &quot;Writer Thread &quot;+readerThreadCounter);\n            readerThreadCounter = readerThreadCounter + 1;\n\n            Thread readerThread3 = new Thread(new ReaderWriterProblem(readerSemaphore, writerSemaphore), &quot;Reader Thread &quot;+readerThreadCounter);\n            readerThreadCounter = readerThreadCounter + 1;\n            \n            readerThread1.start();\n            readerThread2.start();\n            writerThread1.start();\n            writerThread2.start();\n            readerThread3.start();\n        }\n    }\n}\n</code></pre>\n<p>When I try to run the above implementation, the reader acquires the lock and executes first and at last all the writers thread acquires the lock. The writer thread doesn't execute in-between the reader threads. Could you please let me know what is the issue over here</p>\n<p>Output below:</p>\n<pre><code>Reader Thread 0 is critical section\nReader Thread 6 is critical section\n.\n.\n.\n.\nReader Thread 0 is going to leave critical section\nReader Thread 6 is going to leave critical section\n.\n.\n.\n.\nWriter Thread 0 acquired lock\nWriter Thread 0 going to release lock\nWriter Thread 1 acquired lock\nWriter Thread 1 going to release lock\n.\n.\n.\n.\nWriter Thread 19 acquired lock\nWriter Thread 19 going to release lock\n</code></pre>\n"},{"tags":["java","eclipse","testng"],"comments":[{"owner":{"account_id":80593,"reputation":6741,"user_id":227804,"display_name":"lschin"},"score":0,"creation_date":1369209149,"post_id":16684281,"comment_id":24013031,"body_markdown":"Check you project build path","body":"Check you project build path"},{"owner":{"account_id":471893,"reputation":8441,"user_id":879977,"display_name":"niharika_neo"},"score":0,"creation_date":1369216277,"post_id":16684281,"comment_id":24016728,"body_markdown":"no screenshot attached","body":"no screenshot attached"}],"answers":[{"tags":[],"owner":{"account_id":1454798,"reputation":2552,"user_id":1394020,"accept_rate":88,"display_name":"Korey Hinton"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1369404304,"creation_date":1369404304,"answer_id":16736870,"question_id":16684281,"body_markdown":"Make sure you are importing annotations.\r\n\r\n     import org.testng.annotations.*;","title":"@Test Annotation in TestNG is not working in Eclipse","body":"<p>Make sure you are importing annotations.</p>\n\n<pre><code> import org.testng.annotations.*;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2799595,"reputation":195,"user_id":2408070,"accept_rate":50,"display_name":"user2408070"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1422438363,"creation_date":1369659388,"answer_id":16773727,"question_id":16684281,"body_markdown":"Thanks for all your answers and help. I got the mistake what I am doing:\r\n\r\nI am just leaving by writing `@Test` annotation. Instead if I write the annotation along with function this error is not coming. For e.g. \r\n\r\n    @Test \r\n    public void sampletest() { }\r\n\r\nthen the error which I am facing won&#39;t come.","title":"@Test Annotation in TestNG is not working in Eclipse","body":"<p>Thanks for all your answers and help. I got the mistake what I am doing:</p>\n\n<p>I am just leaving by writing <code>@Test</code> annotation. Instead if I write the annotation along with function this error is not coming. For e.g. </p>\n\n<pre><code>@Test \npublic void sampletest() { }\n</code></pre>\n\n<p>then the error which I am facing won't come.</p>\n"},{"tags":[],"owner":{"account_id":6385180,"reputation":148,"user_id":4953343,"accept_rate":75,"display_name":"vgm"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1446733133,"creation_date":1446733133,"answer_id":33546900,"question_id":16684281,"body_markdown":"For any future visitors, I was also able to fix this issue by making the test method public.","title":"@Test Annotation in TestNG is not working in Eclipse","body":"<p>For any future visitors, I was also able to fix this issue by making the test method public.</p>\n"},{"tags":[],"owner":{"account_id":15545023,"reputation":1,"user_id":11214553,"display_name":"sam"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1552778470,"creation_date":1552778470,"answer_id":55202479,"question_id":16684281,"body_markdown":"testng annotations not working.\r\n\r\nInclusion of the following (post by Korey Hinton) helped.\r\n import org.testng.annotations.*; - \r\n","title":"@Test Annotation in TestNG is not working in Eclipse","body":"<p>testng annotations not working.</p>\n\n<p>Inclusion of the following (post by Korey Hinton) helped.\n import org.testng.annotations.*; - </p>\n"},{"tags":[],"owner":{"account_id":22177465,"reputation":1,"user_id":16421756,"display_name":"surabhi joshi"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1625943215,"creation_date":1625943215,"answer_id":68330730,"question_id":16684281,"body_markdown":"TestNG only picks the Files with &#39;test&#39; in the file Name or Public Class.\r\nFor Eg : the File name is App.java it won&#39;t run the @Test method but if we rename the file to AppTest it runs.\r\n","title":"@Test Annotation in TestNG is not working in Eclipse","body":"<p>TestNG only picks the Files with 'test' in the file Name or Public Class.\nFor Eg : the File name is App.java it won't run the @Test method but if we rename the file to AppTest it runs.</p>\n"}],"owner":{"account_id":2799595,"reputation":195,"user_id":2408070,"accept_rate":50,"display_name":"user2408070"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":8565,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":5,"score":0,"last_activity_date":1694801175,"creation_date":1369201421,"question_id":16684281,"body_markdown":"I have installed TestNG(ver:6.8.6.20130517_2218) in Eclipse (Ver: 1.4.2.20120213-0813) on Windows7(64bit). I verified that TestNG is successfully installed\r\n\r\nWhen I write @Test in one of the sample jave file that I created, Annotation(@Test) is not resolved. It is giving Syntax error.What could be the issue? Please see the attached screenshot for more details\r\n\r\n\r\n  [1]: http://i.stack.imgur.com/ULVix.jpg","title":"@Test Annotation in TestNG is not working in Eclipse","body":"<p>I have installed TestNG(ver:6.8.6.20130517_2218) in Eclipse (Ver: 1.4.2.20120213-0813) on Windows7(64bit). I verified that TestNG is successfully installed</p>\n\n<p>When I write @Test in one of the sample jave file that I created, Annotation(@Test) is not resolved. It is giving Syntax error.What could be the issue? Please see the attached screenshot for more details</p>\n"},{"tags":["java","cors","quarkus","quarkus-reactive"],"comments":[{"owner":{"account_id":1152519,"reputation":733,"user_id":1133928,"display_name":"Sergey Beryozkin"},"score":0,"creation_date":1694778324,"post_id":77109186,"comment_id":135939304,"body_markdown":"We&#39;ve opened a simple PR to log them: https://github.com/quarkusio/quarkus/pull/35959, note in some cases it is already logged, example: https://github.com/quarkusio/quarkus/blob/main/extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/cors/CORSFilter.java#L257, but it will be more complete now","body":"We&#39;ve opened a simple PR to log them: <a href=\"https://github.com/quarkusio/quarkus/pull/35959\" rel=\"nofollow noreferrer\">github.com/quarkusio/quarkus/pull/35959</a>, note in some cases it is already logged, example: <a href=\"https://github.com/quarkusio/quarkus/blob/main/extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/cors/CORSFilter.java#L257\" rel=\"nofollow noreferrer\">github.com/quarkusio/quarkus/blob/main/extensions/vertx-http&zwnj;&#8203;/&hellip;</a>, but it will be more complete now"},{"owner":{"account_id":400908,"reputation":3710,"user_id":767160,"accept_rate":78,"display_name":"gian1200"},"score":0,"creation_date":1694788137,"post_id":77109186,"comment_id":135941385,"body_markdown":"I forgot to mention that I&#39;m using 2.16.10, and I understand that I will need to update to v3 to get the PR changes.\nTo enable the current logs I should do something like `quarkus.log.category.&quot;io.quarkus.vertx.http.runtime.cors.CORSFilter&quot;.level=DEBUG`, right?","body":"I forgot to mention that I&#39;m using 2.16.10, and I understand that I will need to update to v3 to get the PR changes. To enable the current logs I should do something like <code>quarkus.log.category.&quot;io.quarkus.vertx.http.runtime.cors.COR&zwnj;&#8203;SFilter&quot;.level=DEBUG</code>&zwnj;&#8203;, right?"},{"owner":{"account_id":1152519,"reputation":733,"user_id":1133928,"display_name":"Sergey Beryozkin"},"score":0,"creation_date":1694971236,"post_id":77109186,"comment_id":135958484,"body_markdown":"I&#39;ve added a backport to 2.16 label as well","body":"I&#39;ve added a backport to 2.16 label as well"}],"owner":{"account_id":400908,"reputation":3710,"user_id":767160,"accept_rate":78,"display_name":"gian1200"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":68,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694801047,"creation_date":1694742262,"question_id":77109186,"body_markdown":"I currently have an app that has CORS properly configured. https://quarkus.io/guides/http-reference#cors-filter\r\n\r\nIt is currently responding 403 for a small amount of requests. However, I&#39;m unable to identify the origin of those requests. Is there a way to log the origin only when CORS validation fails (and not always)?\r\n\r\nQuarkus 2.16.10\r\n\r\n","title":"How to log CORS origin fails with Quarkus","body":"<p>I currently have an app that has CORS properly configured. <a href=\"https://quarkus.io/guides/http-reference#cors-filter\" rel=\"nofollow noreferrer\">https://quarkus.io/guides/http-reference#cors-filter</a></p>\n<p>It is currently responding 403 for a small amount of requests. However, I'm unable to identify the origin of those requests. Is there a way to log the origin only when CORS validation fails (and not always)?</p>\n<p>Quarkus 2.16.10</p>\n"},{"tags":["java","android"],"owner":{"account_id":387159,"reputation":1091,"user_id":745347,"accept_rate":51,"display_name":"E_Blue"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":246,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"answer_count":0,"score":3,"last_activity_date":1694800283,"creation_date":1694798378,"question_id":77114279,"body_markdown":"I&#39;m updating an App in Android Studio (Giraffe) and getting this error many times\r\n\r\n**Duplicate class androidx.annotation.AnimRes found in modules annotation-1.3.0 (androidx.annotation:annotation:1.3.0) and jetified-annotation-jvm-1.7.0 (androidx.annotation:annotation-jvm:1.7.0)**\r\n\r\nI tried a lot of different approaches to solve this but none worked.\r\n\r\nI tried this\r\n\r\nhttps://developer.android.com/build/dependencies#view-dependency-tree\r\n\r\nWhich created more errors.\r\n\r\nAlso this\r\nhttps://stackoverflow.com/questions/72921553/error-building-android-duplicate-class-androidx-annotation-animres-found-in-mod\r\n\r\nhttps://stackoverflow.com/questions/55909804/duplicate-class-android-support-v4-app-inotificationsidechannel-found-in-modules\r\n\r\nhttps://stackoverflow.com/questions/72480174/android-duplicate-class-found-in-modules-jetified-play-services-measurement-and\r\n\r\nhttps://stackoverflow.com/questions/55756647/duplicate-classes-from-androidx-and-com-android-support\r\n\r\nMy gradle.properties has this lines.\r\n\r\n    android.defaults.buildfeatures.buildconfig=true\r\n    android.enableJetifier=true\r\n    android.nonFinalResIds=false\r\n    android.nonTransitiveRClass=false\r\n    android.useAndroidX=true\r\n    org.gradle.jvmargs=-Xmx1536m\r\n\r\nI&#39;m not using Kotlin I only use JAVA; so I deleted this line in build.gradle.app\r\n\r\n    apply plugin: &#39;kotlin-android&#39;\r\n\r\nEdit:\r\nI found this on the build gradle, Should I change the classpath? What should I write?\r\n\r\n    dependencies {\r\n            classpath &#39;com.android.tools.build:gradle:8.1.1&#39;\r\n            //classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version&quot;\r\n    \r\n            // NOTE: Do not place your application dependencies here; they belong\r\n            // in the individual module build.gradle files\r\n        }","title":"Duplicate class androidx.annotation.AnimRes","body":"<p>I'm updating an App in Android Studio (Giraffe) and getting this error many times</p>\n<p><strong>Duplicate class androidx.annotation.AnimRes found in modules annotation-1.3.0 (androidx.annotation:annotation:1.3.0) and jetified-annotation-jvm-1.7.0 (androidx.annotation:annotation-jvm:1.7.0)</strong></p>\n<p>I tried a lot of different approaches to solve this but none worked.</p>\n<p>I tried this</p>\n<p><a href=\"https://developer.android.com/build/dependencies#view-dependency-tree\" rel=\"nofollow noreferrer\">https://developer.android.com/build/dependencies#view-dependency-tree</a></p>\n<p>Which created more errors.</p>\n<p>Also this\n<a href=\"https://stackoverflow.com/questions/72921553/error-building-android-duplicate-class-androidx-annotation-animres-found-in-mod\">Error building android: Duplicate class androidx.annotation.AnimRes found in modules annotation-1.3.0 - Unity 2019.4.40f1</a></p>\n<p><a href=\"https://stackoverflow.com/questions/55909804/duplicate-class-android-support-v4-app-inotificationsidechannel-found-in-modules\">Duplicate class android.support.v4.app.INotificationSideChannel found in modules classes?</a></p>\n<p><a href=\"https://stackoverflow.com/questions/72480174/android-duplicate-class-found-in-modules-jetified-play-services-measurement-and\">Android: Duplicate class found in modules jetified-play-services-measurement and jetified-play-services-measurement-impl</a></p>\n<p><a href=\"https://stackoverflow.com/questions/55756647/duplicate-classes-from-androidx-and-com-android-support\">Duplicate classes from androidx and com.android.support</a></p>\n<p>My gradle.properties has this lines.</p>\n<pre><code>android.defaults.buildfeatures.buildconfig=true\nandroid.enableJetifier=true\nandroid.nonFinalResIds=false\nandroid.nonTransitiveRClass=false\nandroid.useAndroidX=true\norg.gradle.jvmargs=-Xmx1536m\n</code></pre>\n<p>I'm not using Kotlin I only use JAVA; so I deleted this line in build.gradle.app</p>\n<pre><code>apply plugin: 'kotlin-android'\n</code></pre>\n<p>Edit:\nI found this on the build gradle, Should I change the classpath? What should I write?</p>\n<pre><code>dependencies {\n        classpath 'com.android.tools.build:gradle:8.1.1'\n        //classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version&quot;\n\n        // NOTE: Do not place your application dependencies here; they belong\n        // in the individual module build.gradle files\n    }\n</code></pre>\n"},{"tags":["java","mocking","mockito"],"answers":[{"tags":[],"owner":{"account_id":39208,"reputation":251240,"user_id":112968,"accept_rate":68,"display_name":"knittl"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1694799972,"creation_date":1694799972,"answer_id":77114443,"question_id":77114005,"body_markdown":"```\r\n\r\n@Test\r\npublic void testExecute_numberOfTimes() {\r\n    int maxIterations = 5;\r\n    TerminatorListener terminator = new TestTerminator(maxIterations);\r\n\r\n    given(provider.readScenarios()).willReturn(prepareScenarioList());\r\n\r\n    listener.execute(handler, terminator);\r\n\r\n    verify(handler, times(maxIterations)).onScenarioReceived(any(Scenario.class));\r\n}\r\n\r\n@AfterEach\r\nvoid tearDown() {\r\n    verifyNoMoreInteractions(provider);\r\n    verifyNoMoreInteractions(handler);\r\n}\r\n```\r\n\r\nYou are never calling `verify` on your provider. Therefore, there are still unverified interactions and `verifyNoMoreInteractions` will trip.\r\n\r\nYou must verify _all_ interactions of your provider:\r\n\r\n```\r\ngiven(provider.readScenarios()).willReturn(prepareScenarioList());\r\n\r\nlistener.execute(handler, terminator);\r\n\r\nverify(handler, times(maxIterations)).onScenarioReceived(any(Scenario.class));\r\nverify(provider).readScenarios();\r\n```","title":"NoInteractionsWanted exception","body":"<pre><code>\n@Test\npublic void testExecute_numberOfTimes() {\n    int maxIterations = 5;\n    TerminatorListener terminator = new TestTerminator(maxIterations);\n\n    given(provider.readScenarios()).willReturn(prepareScenarioList());\n\n    listener.execute(handler, terminator);\n\n    verify(handler, times(maxIterations)).onScenarioReceived(any(Scenario.class));\n}\n\n@AfterEach\nvoid tearDown() {\n    verifyNoMoreInteractions(provider);\n    verifyNoMoreInteractions(handler);\n}\n</code></pre>\n<p>You are never calling <code>verify</code> on your provider. Therefore, there are still unverified interactions and <code>verifyNoMoreInteractions</code> will trip.</p>\n<p>You must verify <em>all</em> interactions of your provider:</p>\n<pre><code>given(provider.readScenarios()).willReturn(prepareScenarioList());\n\nlistener.execute(handler, terminator);\n\nverify(handler, times(maxIterations)).onScenarioReceived(any(Scenario.class));\nverify(provider).readScenarios();\n</code></pre>\n"}],"owner":{"account_id":22342718,"reputation":77,"user_id":16562270,"display_name":"Yurii"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":29,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77114443,"answer_count":1,"score":0,"last_activity_date":1694799972,"creation_date":1694795290,"question_id":77114005,"body_markdown":"I&#39;m writing test for my Service written in pure Java that will later migrate to Spring boot. This class just reads several scenarios from json and does infinite loop handling each scenario every time with interface *ScenarioHandler*:\r\n\r\n```java\r\n@Override\r\npublic void execute(ScenarioHandler handler) {\r\n    execute(handler, () -&gt; false);\r\n}\r\n\r\npublic void execute(ScenarioHandler handler, TerminatorListener terminator) {\r\n    List&lt;Scenario&gt; scenarioList = provider.readScenarios();\r\n    validateScenarios(scenarioList);\r\n    listen(scenarioList, handler, terminator);\r\n}\r\n\r\nprivate void listen(List&lt;Scenario&gt; scenarioList, ScenarioHandler handler, TerminatorListener terminator) {\r\n    int currentIndex = 0;\r\n    while (!terminator.shouldTerminate()) {\r\n        Scenario scenario = scenarioList.get(currentIndex);\r\n        handler.onScenarioReceived(scenario);\r\n        currentIndex = (currentIndex + 1) % scenarioList.size();\r\n        sleep();\r\n    }\r\n}\r\n```\r\n\r\nHere I&#39;ve done method overloading to be able perform the testing.\r\nI get a org.Mockito.exception.verifications.NoInteractionWanted exception, with this stack trace:\r\n\r\n```none\r\nNo interactions wanted here:\r\n-&gt; at executor.service.service.ScenarioSourceListenerTest.tearDown(ScenarioSourceListenerTest.java:65)\r\nBut found this interaction on mock &#39;scenarioProvider&#39;:\r\n-&gt; at executor.service.service.impl.ScenarioSourceListenerImpl.execute(ScenarioSourceListenerImpl.java:30)\r\nActually, above is the only interaction with this mock.\r\n```\r\n\r\nMy test is provided here:\r\n\r\n```java\r\nprivate ScenarioProvider provider;\r\n\r\nprivate ScenarioHandler handler;\r\n\r\n@BeforeEach\r\npublic void setUp() {\r\n    provider = mock(ScenarioProvider.class);\r\n    handler = mock(ScenarioHandler.class);\r\n    listener = new ScenarioSourceListenerImpl(provider);\r\n}\r\n\r\n@Test\r\npublic void testExecute_numberOfTimes() {\r\n    int maxIterations = 5;\r\n    TerminatorListener terminator = new TestTerminator(maxIterations);\r\n\r\n    given(provider.readScenarios()).willReturn(prepareScenarioList());\r\n\r\n    listener.execute(handler, terminator);\r\n\r\n    verify(handler, times(maxIterations)).onScenarioReceived(any(Scenario.class));\r\n}\r\n\r\n@AfterEach\r\nvoid tearDown() {\r\n    verifyNoMoreInteractions(provider);\r\n    verifyNoMoreInteractions(handler);\r\n}\r\n\r\nprivate class TestTerminator implements TerminatorListener {\r\n    private int maxIterations;\r\n    private int currentIteration = 0;\r\n\r\n    public TestTerminator(int maxIterations) {\r\n        this.maxIterations = maxIterations;\r\n    }\r\n\r\n    @Override\r\n    public boolean shouldTerminate() {\r\n        currentIteration++;\r\n        return currentIteration &gt; maxIterations;\r\n    }\r\n}\r\n```\r\n\r\nWhere possibly can be another interaction with my provider?","title":"NoInteractionsWanted exception","body":"<p>I'm writing test for my Service written in pure Java that will later migrate to Spring boot. This class just reads several scenarios from json and does infinite loop handling each scenario every time with interface <em>ScenarioHandler</em>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Override\npublic void execute(ScenarioHandler handler) {\n    execute(handler, () -&gt; false);\n}\n\npublic void execute(ScenarioHandler handler, TerminatorListener terminator) {\n    List&lt;Scenario&gt; scenarioList = provider.readScenarios();\n    validateScenarios(scenarioList);\n    listen(scenarioList, handler, terminator);\n}\n\nprivate void listen(List&lt;Scenario&gt; scenarioList, ScenarioHandler handler, TerminatorListener terminator) {\n    int currentIndex = 0;\n    while (!terminator.shouldTerminate()) {\n        Scenario scenario = scenarioList.get(currentIndex);\n        handler.onScenarioReceived(scenario);\n        currentIndex = (currentIndex + 1) % scenarioList.size();\n        sleep();\n    }\n}\n</code></pre>\n<p>Here I've done method overloading to be able perform the testing.\nI get a org.Mockito.exception.verifications.NoInteractionWanted exception, with this stack trace:</p>\n<pre class=\"lang-none prettyprint-override\"><code>No interactions wanted here:\n-&gt; at executor.service.service.ScenarioSourceListenerTest.tearDown(ScenarioSourceListenerTest.java:65)\nBut found this interaction on mock 'scenarioProvider':\n-&gt; at executor.service.service.impl.ScenarioSourceListenerImpl.execute(ScenarioSourceListenerImpl.java:30)\nActually, above is the only interaction with this mock.\n</code></pre>\n<p>My test is provided here:</p>\n<pre class=\"lang-java prettyprint-override\"><code>private ScenarioProvider provider;\n\nprivate ScenarioHandler handler;\n\n@BeforeEach\npublic void setUp() {\n    provider = mock(ScenarioProvider.class);\n    handler = mock(ScenarioHandler.class);\n    listener = new ScenarioSourceListenerImpl(provider);\n}\n\n@Test\npublic void testExecute_numberOfTimes() {\n    int maxIterations = 5;\n    TerminatorListener terminator = new TestTerminator(maxIterations);\n\n    given(provider.readScenarios()).willReturn(prepareScenarioList());\n\n    listener.execute(handler, terminator);\n\n    verify(handler, times(maxIterations)).onScenarioReceived(any(Scenario.class));\n}\n\n@AfterEach\nvoid tearDown() {\n    verifyNoMoreInteractions(provider);\n    verifyNoMoreInteractions(handler);\n}\n\nprivate class TestTerminator implements TerminatorListener {\n    private int maxIterations;\n    private int currentIteration = 0;\n\n    public TestTerminator(int maxIterations) {\n        this.maxIterations = maxIterations;\n    }\n\n    @Override\n    public boolean shouldTerminate() {\n        currentIteration++;\n        return currentIteration &gt; maxIterations;\n    }\n}\n</code></pre>\n<p>Where possibly can be another interaction with my provider?</p>\n"},{"tags":["java","android","kotlin","zip","zipoutputstream"],"comments":[{"owner":{"account_id":16768304,"reputation":8503,"user_id":12121419,"display_name":"blackapps"},"score":0,"creation_date":1694802440,"post_id":77114430,"comment_id":135943998,"body_markdown":"`Trying to extract them on macOS fails.` So on an Android device all is ok?","body":"<code>Trying to extract them on macOS fails.</code> So on an Android device all is ok?"},{"owner":{"account_id":16768304,"reputation":8503,"user_id":12121419,"display_name":"blackapps"},"score":0,"creation_date":1694802532,"post_id":77114430,"comment_id":135944011,"body_markdown":"I see no .docx files in that paragraph folder.","body":"I see no .docx files in that paragraph folder."},{"owner":{"account_id":202054,"reputation":23899,"user_id":448875,"display_name":"broot"},"score":0,"creation_date":1694810518,"post_id":77114430,"comment_id":135945173,"body_markdown":"Sounds like this is not at all a problem with zip (IntelliJ properly opens it and it works for other formats than docx), but with the contents of the zip maybe?","body":"Sounds like this is not at all a problem with zip (IntelliJ properly opens it and it works for other formats than docx), but with the contents of the zip maybe?"},{"owner":{"account_id":6880272,"reputation":71,"user_id":5287272,"display_name":"Genealogy"},"score":0,"creation_date":1694811020,"post_id":77114430,"comment_id":135945248,"body_markdown":"@blackapps - No, it&#39;s an invalid file too. The paragraph folder is the raw folder which needs to be compressed to e.g. test.docx or test.zip (makes no difference) using the &quot;zip&quot; function above. This results in a corrupted file. It could have to do with the fact the paragraph folder owns files without file name and having just a dot ending (see _rels/.rels).","body":"@blackapps - No, it&#39;s an invalid file too. The paragraph folder is the raw folder which needs to be compressed to e.g. test.docx or test.zip (makes no difference) using the &quot;zip&quot; function above. This results in a corrupted file. It could have to do with the fact the paragraph folder owns files without file name and having just a dot ending (see _rels/.rels)."},{"owner":{"account_id":6880272,"reputation":71,"user_id":5287272,"display_name":"Genealogy"},"score":0,"creation_date":1694811224,"post_id":77114430,"comment_id":135945284,"body_markdown":"@broot - No, the raw docx folder structure is definitely valid. I&#39;ve done this for a desktop app in another programming language and with the same paragraph folder and it works as expected.","body":"@broot - No, the raw docx folder structure is definitely valid. I&#39;ve done this for a desktop app in another programming language and with the same paragraph folder and it works as expected."}],"owner":{"account_id":6880272,"reputation":71,"user_id":5287272,"display_name":"Genealogy"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":56,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694799805,"creation_date":1694799805,"question_id":77114430,"body_markdown":"I use `ZipOutputStream` to compress the content of a folder into a Zip file. Below is my working code. But it creates corrupt DOCX files. Trying to extract them on macOS fails.\r\n\r\n```kotlin\r\nprivate const val DEFAULT_BUFFER_SIZE = 1024 * 4\r\n\r\nfun zip(source: String?, destination: String?, contentsOnly: Boolean, compression: Int) {\r\n\ttry {\r\n\t\tval zipOut = ZipOutputStream(FileOutputStream(destination))\r\n\t\tval srcFile = File(source)\r\n\r\n\t\t// Compression Level\r\n\t\tval compressionLevel: Int = when(compression) {\r\n\t\t\t 0 -&gt; Deflater.DEFAULT_COMPRESSION\r\n\t\t\t 1 -&gt; Deflater.NO_COMPRESSION\r\n\t\t\t 2 -&gt; Deflater.BEST_SPEED\r\n\t\t\t 3 -&gt; Deflater.BEST_COMPRESSION\r\n\t\t\telse -&gt; {\r\n\t\t\t\tDeflater.DEFAULT_COMPRESSION\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tzipOut.setLevel(compressionLevel)\r\n\t\tzipOut.setMethod(ZipOutputStream.DEFLATED)\r\n\r\n\t\tif (contentsOnly &amp;&amp; srcFile.isDirectory) {\r\n\t\t\tfor (fileName in srcFile.list()) {\r\n\t\t\t\taddToZip(&quot;&quot;, source + File.separator + fileName, zipOut)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (source != null) {\r\n\t\t\t\taddToZip(&quot;&quot;, source, zipOut)\r\n\t\t\t}\r\n\t\t}\r\n\t\tzipOut.flush()\r\n\t\tzipOut.finish()\r\n\t\tzipOut.close()\r\n\t\tprintln(&quot;Successfully created $destination&quot;)\r\n\t} catch (error: Exception) {\r\n\t\tprintln(&quot;Failed&quot;)\r\n\t}\r\n}\r\n\r\nprivate fun addToZip(path: String, srcFile: String, zipOut: ZipOutputStream) {\r\n\tval file = File(srcFile)\r\n\tval filePath = if (&quot;&quot; == path) file.name else path + File.separator + file.name\r\n\tif (file.isDirectory) {\r\n\t\tfor (fileName in file.list()) {\r\n\t\t\taddToZip(filePath, srcFile + File.separator + fileName, zipOut)\r\n\t\t}\r\n\t} else {\r\n\t\tzipOut.putNextEntry(ZipEntry(filePath))\r\n\t\tval `in` = FileInputStream(srcFile)\r\n\t\tval buffer = ByteArray(DEFAULT_BUFFER_SIZE)\r\n\t\tvar len: Int\r\n\t\twhile (`in`.read(buffer).also { len = it } != -1) {\r\n\t\t\tzipOut.write(buffer, 0, len)\r\n\t\t}\r\n\t}\r\n}\r\n```\r\nI use the code e.g. to compress the folder **&quot;paragraph&quot;**, which you can find here: https://github.com/stiv-yakovenko/toptal-docx/tree/master/paragraph. The Zip file is generated, I can view the Structure inside Android Studio, but if I try to extract it, I get the message the file is corrupt. Compress other folders, which are not based on OfficeOpenXml (*.docx*, *.xsxl* etc.) works fine.","title":"Corrupt Zip file using ZipOutputStream to create DOCX file","body":"<p>I use <code>ZipOutputStream</code> to compress the content of a folder into a Zip file. Below is my working code. But it creates corrupt DOCX files. Trying to extract them on macOS fails.</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>private const val DEFAULT_BUFFER_SIZE = 1024 * 4\n\nfun zip(source: String?, destination: String?, contentsOnly: Boolean, compression: Int) {\n    try {\n        val zipOut = ZipOutputStream(FileOutputStream(destination))\n        val srcFile = File(source)\n\n        // Compression Level\n        val compressionLevel: Int = when(compression) {\n             0 -&gt; Deflater.DEFAULT_COMPRESSION\n             1 -&gt; Deflater.NO_COMPRESSION\n             2 -&gt; Deflater.BEST_SPEED\n             3 -&gt; Deflater.BEST_COMPRESSION\n            else -&gt; {\n                Deflater.DEFAULT_COMPRESSION\n            }\n        }\n\n        zipOut.setLevel(compressionLevel)\n        zipOut.setMethod(ZipOutputStream.DEFLATED)\n\n        if (contentsOnly &amp;&amp; srcFile.isDirectory) {\n            for (fileName in srcFile.list()) {\n                addToZip(&quot;&quot;, source + File.separator + fileName, zipOut)\n            }\n        } else {\n            if (source != null) {\n                addToZip(&quot;&quot;, source, zipOut)\n            }\n        }\n        zipOut.flush()\n        zipOut.finish()\n        zipOut.close()\n        println(&quot;Successfully created $destination&quot;)\n    } catch (error: Exception) {\n        println(&quot;Failed&quot;)\n    }\n}\n\nprivate fun addToZip(path: String, srcFile: String, zipOut: ZipOutputStream) {\n    val file = File(srcFile)\n    val filePath = if (&quot;&quot; == path) file.name else path + File.separator + file.name\n    if (file.isDirectory) {\n        for (fileName in file.list()) {\n            addToZip(filePath, srcFile + File.separator + fileName, zipOut)\n        }\n    } else {\n        zipOut.putNextEntry(ZipEntry(filePath))\n        val `in` = FileInputStream(srcFile)\n        val buffer = ByteArray(DEFAULT_BUFFER_SIZE)\n        var len: Int\n        while (`in`.read(buffer).also { len = it } != -1) {\n            zipOut.write(buffer, 0, len)\n        }\n    }\n}\n</code></pre>\n<p>I use the code e.g. to compress the folder <strong>&quot;paragraph&quot;</strong>, which you can find here: <a href=\"https://github.com/stiv-yakovenko/toptal-docx/tree/master/paragraph\" rel=\"nofollow noreferrer\">https://github.com/stiv-yakovenko/toptal-docx/tree/master/paragraph</a>. The Zip file is generated, I can view the Structure inside Android Studio, but if I try to extract it, I get the message the file is corrupt. Compress other folders, which are not based on OfficeOpenXml (<em>.docx</em>, <em>.xsxl</em> etc.) works fine.</p>\n"},{"tags":["java","object","reference","save","load"],"comments":[{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":3,"creation_date":1694788702,"post_id":77113188,"comment_id":135941493,"body_markdown":"If by &quot;*save file and load it up*&quot;, you mean that you save the file to the disk via serialization and then convert it back to a Java object using deserialization, then depending on how you de/serialized it, you may no longer have the same object reference. If you don&#39;t have the same object reference, then your rule no longer applies.","body":"If by &quot;<i>save file and load it up</i>&quot;, you mean that you save the file to the disk via serialization and then convert it back to a Java object using deserialization, then depending on how you de/serialized it, you may no longer have the same object reference. If you don&#39;t have the same object reference, then your rule no longer applies."},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":1,"creation_date":1694788992,"post_id":77113188,"comment_id":135941553,"body_markdown":"In order for us to help you, you are going to have to give details about how you are saving and loading up these objects. Otherwise, we don&#39;t have enough info to work with.","body":"In order for us to help you, you are going to have to give details about how you are saving and loading up these objects. Otherwise, we don&#39;t have enough info to work with."},{"owner":{"account_id":28598126,"reputation":11,"user_id":21895711,"display_name":"Ellie"},"score":0,"creation_date":1694789691,"post_id":77113188,"comment_id":135941705,"body_markdown":"I have added code and noticed that only changes are made to productList not to templist, I think the main issue is the writeObject of orderList but I really dont know how to fix this","body":"I have added code and noticed that only changes are made to productList not to templist, I think the main issue is the writeObject of orderList but I really dont know how to fix this"},{"owner":{"account_id":265649,"reputation":53086,"user_id":552759,"display_name":"jtahlborn"},"score":0,"creation_date":1694790899,"post_id":77113188,"comment_id":135941960,"body_markdown":"correct, when you load productList, you need to update templist to contain the same objects from productList (since they are now new objects).  however, since you haven&#39;t shown templist or anything related to it, it&#39;s hard to give more specific guidance than that.","body":"correct, when you load productList, you need to update templist to contain the same objects from productList (since they are now new objects).  however, since you haven&#39;t shown templist or anything related to it, it&#39;s hard to give more specific guidance than that."},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1694797572,"post_id":77113188,"comment_id":135943183,"body_markdown":"Now that you have added code, I can answer your question. One moment.","body":"Now that you have added code, I can answer your question. One moment."}],"answers":[{"tags":[],"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694799558,"creation_date":1694797759,"answer_id":77114237,"question_id":77113188,"body_markdown":"The reason why your code is only updating one list and not both of them is because you are attempting to serialize them ***separately***.\r\n\r\nYou have taken an ecosystem where one list depends on the other, but you are serializing both lists ***separately***. That&#39;s like cutting a cake in half, storing each half separately, and then trying to put both halves back together later on. That won&#39;t fly.\r\n\r\nIf you want this to work, you must place ***BOTH*** lists into a single object, and then serialize that object. That is what will allow the relationship to be maintained.\r\n\r\nAlternatively, you can try and manually create the relationship yourself, but that would be painful.\r\n\r\nAs a side note though, I notice that you are using basic Java serialization. Please note that basic Java serialization is a persnickety beast that can cause millions of security holes. Be mindful of that when using it. There are better tools available, rather than just using naked Java serialization.\r\n\r\n**EDIT** - To further demonstrate the point, here is an example.\r\n\r\n```java\r\nrecord Child(String name) implements Serializable {}\r\nrecord Parent(Child one, Child two) implements Serializable {}\r\n\r\nChild child = new Child(&quot;Charles&quot;);\r\nParent parent = new Parent(child, child);\r\n\r\ntry (FileOutputStream fileOutputStream = new FileOutputStream(&quot;out&quot;)) \r\n{\r\n\r\n    var objectOutputStream = new ObjectOutputStream(fileOutputStream); \r\n        \r\n    objectOutputStream.writeObject(parent);\r\n\r\n    objectOutputStream.close();\r\n\r\n}\r\n\r\ncatch (IOException e) \r\n{\r\n\r\n    throw new RuntimeException(e);\r\n\r\n}\r\n\r\ntry (\r\n        var fileInputStream = new FileInputStream(&quot;out&quot;);\r\n        var objectInputStream = new ObjectInputStream(fileInputStream)\r\n)\r\n{\r\n        \r\n    Parent idk = (Parent) objectInputStream.readObject();\r\n    System.out.println(idk);\r\n    System.out.println(idk.one() == idk.two());\r\n        \r\n    objectInputStream.close();\r\n    fileInputStream.close();\r\n\r\n}\r\n\r\ncatch (Exception e)\r\n{\r\n\r\n        throw new RuntimeException(e);\r\n\r\n}\r\n```","title":"Java reference semantic and saving/loading object files","body":"<p>The reason why your code is only updating one list and not both of them is because you are attempting to serialize them <em><strong>separately</strong></em>.</p>\n<p>You have taken an ecosystem where one list depends on the other, but you are serializing both lists <em><strong>separately</strong></em>. That's like cutting a cake in half, storing each half separately, and then trying to put both halves back together later on. That won't fly.</p>\n<p>If you want this to work, you must place <em><strong>BOTH</strong></em> lists into a single object, and then serialize that object. That is what will allow the relationship to be maintained.</p>\n<p>Alternatively, you can try and manually create the relationship yourself, but that would be painful.</p>\n<p>As a side note though, I notice that you are using basic Java serialization. Please note that basic Java serialization is a persnickety beast that can cause millions of security holes. Be mindful of that when using it. There are better tools available, rather than just using naked Java serialization.</p>\n<p><strong>EDIT</strong> - To further demonstrate the point, here is an example.</p>\n<pre class=\"lang-java prettyprint-override\"><code>record Child(String name) implements Serializable {}\nrecord Parent(Child one, Child two) implements Serializable {}\n\nChild child = new Child(&quot;Charles&quot;);\nParent parent = new Parent(child, child);\n\ntry (FileOutputStream fileOutputStream = new FileOutputStream(&quot;out&quot;)) \n{\n\n    var objectOutputStream = new ObjectOutputStream(fileOutputStream); \n        \n    objectOutputStream.writeObject(parent);\n\n    objectOutputStream.close();\n\n}\n\ncatch (IOException e) \n{\n\n    throw new RuntimeException(e);\n\n}\n\ntry (\n        var fileInputStream = new FileInputStream(&quot;out&quot;);\n        var objectInputStream = new ObjectInputStream(fileInputStream)\n)\n{\n        \n    Parent idk = (Parent) objectInputStream.readObject();\n    System.out.println(idk);\n    System.out.println(idk.one() == idk.two());\n        \n    objectInputStream.close();\n    fileInputStream.close();\n\n}\n\ncatch (Exception e)\n{\n\n        throw new RuntimeException(e);\n\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":23740623,"reputation":1,"user_id":17758716,"display_name":"Reilas"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1694797816,"creation_date":1694797816,"answer_id":77114242,"question_id":77113188,"body_markdown":"&gt; _&quot;... Is there any way that when I save the file and load it up, the connection between object and the reference in templist still connected. ...&quot;_\r\n\r\nNo, the _[readObject](https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/ObjectInputStream.html#readObject())_ method will return new objects.\r\n\r\n_[ObjectInputStream (Java SE 20 &amp;amp; JDK 20)](https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/ObjectInputStream.html)_,\r\n\r\n&gt; _&quot;... Reading an object is analogous to running the constructors of a new object. Memory is allocated for the object and initialized to zero (NULL). ...&quot;_\r\n\r\nHere are a few recommendations for your code.\r\n\r\n- Use a _try-with-resources_ statement for the _ObjectOutputStream_ objects as well.\r\n- You can cast to _ArrayList_, the _type_ would be unnecessary here.\r\n","title":"Java reference semantic and saving/loading object files","body":"<blockquote>\n<p><em>&quot;... Is there any way that when I save the file and load it up, the connection between object and the reference in templist still connected. ...&quot;</em></p>\n</blockquote>\n<p>No, the <em><a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/ObjectInputStream.html#readObject()\" rel=\"nofollow noreferrer\">readObject</a></em> method will return new objects.</p>\n<p><em><a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/ObjectInputStream.html\" rel=\"nofollow noreferrer\">ObjectInputStream (Java SE 20 &amp; JDK 20)</a></em>,</p>\n<blockquote>\n<p><em>&quot;... Reading an object is analogous to running the constructors of a new object. Memory is allocated for the object and initialized to zero (NULL). ...&quot;</em></p>\n</blockquote>\n<p>Here are a few recommendations for your code.</p>\n<ul>\n<li>Use a <em>try-with-resources</em> statement for the <em>ObjectOutputStream</em> objects as well.</li>\n<li>You can cast to <em>ArrayList</em>, the <em>type</em> would be unnecessary here.</li>\n</ul>\n"}],"owner":{"account_id":28598126,"reputation":11,"user_id":21895711,"display_name":"Ellie"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":58,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":2,"score":1,"last_activity_date":1694799558,"creation_date":1694787960,"question_id":77113188,"body_markdown":"I learn that in Java, when you add object to list, you only add references so if you modify object, all lists that have the reference will change\r\n\r\nSay that I have an **ArrayList\\&lt;Product\\&gt; productList** holds 5 objects of type **Product**. **ArrayList\\&lt;Order\\&gt; orderList** holds an **ArrayList\\&lt;Product\\&gt; templist** which holds, say, 4 objects productList is holding. \r\n\r\nThe problem is that when I save file and load it up, I try to modify the object but no changes made templist inside orderList. Is there any way that when I save the file and load it up, the connection between object and the reference in templist still connected.\r\n\r\nI have tried write object one by one and write the entire list but nothing work\r\n\r\n    String productFile = &quot;product.dat&quot;;\r\n    public void loadProductFile() {\r\n        try (FileInputStream fileInputStream = new FileInputStream(productFile);\r\n             ObjectInputStream objectInputStream = new ObjectInputStream(fileInputStream)) {\r\n            \r\n            productList = (ArrayList&lt;Product&gt;) objectInputStream.readObject();\r\n            System.out.println(&quot;Product.dat file is loaded&quot;);\r\n            \r\n            objectInputStream.close();\r\n            fileInputStream.close();\r\n        } catch (IOException | ClassNotFoundException e) {\r\n            System.out.println(&quot;An error occurs during input or output operations.&quot;);\r\n        }\r\n    }\r\n    public void writeProductFile() {\r\n        try (FileOutputStream fileOutputStream = new FileOutputStream(productFile)) {\r\n            ObjectOutputStream objectOutputStream = new ObjectOutputStream(fileOutputStream); \r\n            \r\n            objectOutputStream.writeObject(productList);\r\n            System.out.println(&quot;Write to &quot; + productFile + &quot; file successfuly&quot;);\r\n\r\n            objectOutputStream.close();\r\n        } catch (IOException e) {\r\n            System.out.println(&quot;An error occurs during input or output operations.&quot;);\r\n        }\r\n    }\r\n    \r\n    \r\n    String warehouseFile = &quot;warehouse.dat&quot;;\r\n    public void loadWarehouseFile() {\r\n    try (FileInputStream fileInputStream = new FileInputStream(warehouseFile);\r\n         ObjectInputStream objectInputStream = new ObjectInputStream(fileInputStream)) {\r\n\r\n            orderList = (ArrayList&lt;Order&gt;) objectInputStream.readObject();\r\n\r\n            System.out.println(&quot;Warehouse.dat file is loaded&quot;);\r\n\r\n        } catch (IOException | ClassNotFoundException e) {\r\n            System.out.println(&quot;File not found&quot;);\r\n        }\r\n    }\r\n\r\n    public void writeWarehouseFile() {\r\n        try (FileOutputStream fileOutputStream = new FileOutputStream(warehouseFile)) {\r\n            ObjectOutputStream objectOutputStream = new ObjectOutputStream(fileOutputStream);\r\n            \r\n            objectOutputStream.writeObject(orderList);\r\n            System.out.println(&quot;Write to &quot; + warehouseFile + &quot; file successfully&quot;);\r\n\r\n            objectOutputStream.close();\r\n        } catch (IOException e) {\r\n            System.out.println(&quot;An error occurs during input or output operations.&quot;);\r\n        }\r\n    }","title":"Java reference semantic and saving/loading object files","body":"<p>I learn that in Java, when you add object to list, you only add references so if you modify object, all lists that have the reference will change</p>\n<p>Say that I have an <strong>ArrayList&lt;Product&gt; productList</strong> holds 5 objects of type <strong>Product</strong>. <strong>ArrayList&lt;Order&gt; orderList</strong> holds an <strong>ArrayList&lt;Product&gt; templist</strong> which holds, say, 4 objects productList is holding.</p>\n<p>The problem is that when I save file and load it up, I try to modify the object but no changes made templist inside orderList. Is there any way that when I save the file and load it up, the connection between object and the reference in templist still connected.</p>\n<p>I have tried write object one by one and write the entire list but nothing work</p>\n<pre><code>String productFile = &quot;product.dat&quot;;\npublic void loadProductFile() {\n    try (FileInputStream fileInputStream = new FileInputStream(productFile);\n         ObjectInputStream objectInputStream = new ObjectInputStream(fileInputStream)) {\n        \n        productList = (ArrayList&lt;Product&gt;) objectInputStream.readObject();\n        System.out.println(&quot;Product.dat file is loaded&quot;);\n        \n        objectInputStream.close();\n        fileInputStream.close();\n    } catch (IOException | ClassNotFoundException e) {\n        System.out.println(&quot;An error occurs during input or output operations.&quot;);\n    }\n}\npublic void writeProductFile() {\n    try (FileOutputStream fileOutputStream = new FileOutputStream(productFile)) {\n        ObjectOutputStream objectOutputStream = new ObjectOutputStream(fileOutputStream); \n        \n        objectOutputStream.writeObject(productList);\n        System.out.println(&quot;Write to &quot; + productFile + &quot; file successfuly&quot;);\n\n        objectOutputStream.close();\n    } catch (IOException e) {\n        System.out.println(&quot;An error occurs during input or output operations.&quot;);\n    }\n}\n\n\nString warehouseFile = &quot;warehouse.dat&quot;;\npublic void loadWarehouseFile() {\ntry (FileInputStream fileInputStream = new FileInputStream(warehouseFile);\n     ObjectInputStream objectInputStream = new ObjectInputStream(fileInputStream)) {\n\n        orderList = (ArrayList&lt;Order&gt;) objectInputStream.readObject();\n\n        System.out.println(&quot;Warehouse.dat file is loaded&quot;);\n\n    } catch (IOException | ClassNotFoundException e) {\n        System.out.println(&quot;File not found&quot;);\n    }\n}\n\npublic void writeWarehouseFile() {\n    try (FileOutputStream fileOutputStream = new FileOutputStream(warehouseFile)) {\n        ObjectOutputStream objectOutputStream = new ObjectOutputStream(fileOutputStream);\n        \n        objectOutputStream.writeObject(orderList);\n        System.out.println(&quot;Write to &quot; + warehouseFile + &quot; file successfully&quot;);\n\n        objectOutputStream.close();\n    } catch (IOException e) {\n        System.out.println(&quot;An error occurs during input or output operations.&quot;);\n    }\n}\n</code></pre>\n"},{"tags":["java","android","android-room"],"answers":[{"tags":[],"owner":{"account_id":14327066,"reputation":141,"user_id":10348872,"display_name":"Shovel_Knight"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694784214,"creation_date":1694784214,"answer_id":77112739,"question_id":77112648,"body_markdown":"I believe Android simply does not implement the `StringConcatFactory` interface. In general Android&#39;s support for Java language features seems to be frozen somewhere around Java 8. I definitely would not recommend using any language features or new additions to the class library from Java 9+ in Android applications. ","title":"Android Fatal Error: Unable to find method makeConcatWithConstants","body":"<p>I believe Android simply does not implement the <code>StringConcatFactory</code> interface. In general Android's support for Java language features seems to be frozen somewhere around Java 8. I definitely would not recommend using any language features or new additions to the class library from Java 9+ in Android applications.</p>\n"},{"tags":[],"owner":{"account_id":2818537,"reputation":1285,"user_id":2422905,"accept_rate":60,"display_name":"adsamcik"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1694799406,"creation_date":1694799406,"answer_id":77114395,"question_id":77112648,"body_markdown":"Since this issue has only affected Java code generated by Room I managed to &quot;solve it&quot; by using the new &quot;Kotlin CodeGen&quot; feature of Room which has been introduced in version 2.6 (currently in beta).\r\n\r\n&gt; Kotlin code generation(or “Kotlin CodeGen”) can now be enabled in Room\r\n&gt; (4297ec0). To turn on Kotlin CodeGen in Room, add the\r\n&gt; room.generateKotlin option name to your processor options for KSP. For\r\n&gt; more details on how to pass processor options for KSP, see the KSP\r\n&gt; documentation.\r\n\r\n\r\nI have not managed to find out what was the root cause.","title":"Android Fatal Error: Unable to find method makeConcatWithConstants","body":"<p>Since this issue has only affected Java code generated by Room I managed to &quot;solve it&quot; by using the new &quot;Kotlin CodeGen&quot; feature of Room which has been introduced in version 2.6 (currently in beta).</p>\n<blockquote>\n<p>Kotlin code generation(or “Kotlin CodeGen”) can now be enabled in Room\n(4297ec0). To turn on Kotlin CodeGen in Room, add the\nroom.generateKotlin option name to your processor options for KSP. For\nmore details on how to pass processor options for KSP, see the KSP\ndocumentation.</p>\n</blockquote>\n<p>I have not managed to find out what was the root cause.</p>\n"}],"owner":{"account_id":2818537,"reputation":1285,"user_id":2422905,"accept_rate":60,"display_name":"adsamcik"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":106,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77114395,"answer_count":2,"score":0,"last_activity_date":1694799406,"creation_date":1694783307,"question_id":77112648,"body_markdown":"I have been trying to solve this error and so far I was unable to find the cause. Most threads say that I need to upgrade to JDK 11+. I upgraded the whole project to 17 and it still throws this error. This code is generated by Room code generation, so there is not really anything I can do to easily change it a be done with it.\r\n\r\nI am using Android Gradle 8.1.1 which complaints anyway if there is anything below Java 17.\r\n\r\n    AppDatabase_Impl.java:166: error: cannot find symbol\r\n    \r\n                      + &quot; Found:\\n&quot; + _existingLocationData);\r\n                                      ^\r\n      symbol:   method makeConcatWithConstants(Lookup,String,MethodType,String)\r\n      location: interface StringConcatFactory\r\n\r\nI would really appreciate if anyone would lend a hand with this.\r\n    1 error\r\n    Fatal Error: Unable to find method makeConcatWithConstants\r\n\r\nedit: Added extra context where the issue is reported\r\n\r\n    return new RoomOpenHelper.ValidationResult(false, &quot;location_data(package.data.DatabaseLocation).\\n&quot;\r\n                  + &quot; Expected:\\n&quot; + _infoLocationData + &quot;\\n&quot;\r\n                  + &quot; Found:\\n&quot; + _existingLocationData);","title":"Android Fatal Error: Unable to find method makeConcatWithConstants","body":"<p>I have been trying to solve this error and so far I was unable to find the cause. Most threads say that I need to upgrade to JDK 11+. I upgraded the whole project to 17 and it still throws this error. This code is generated by Room code generation, so there is not really anything I can do to easily change it a be done with it.</p>\n<p>I am using Android Gradle 8.1.1 which complaints anyway if there is anything below Java 17.</p>\n<pre><code>AppDatabase_Impl.java:166: error: cannot find symbol\n\n                  + &quot; Found:\\n&quot; + _existingLocationData);\n                                  ^\n  symbol:   method makeConcatWithConstants(Lookup,String,MethodType,String)\n  location: interface StringConcatFactory\n</code></pre>\n<p>I would really appreciate if anyone would lend a hand with this.\n1 error\nFatal Error: Unable to find method makeConcatWithConstants</p>\n<p>edit: Added extra context where the issue is reported</p>\n<pre><code>return new RoomOpenHelper.ValidationResult(false, &quot;location_data(package.data.DatabaseLocation).\\n&quot;\n              + &quot; Expected:\\n&quot; + _infoLocationData + &quot;\\n&quot;\n              + &quot; Found:\\n&quot; + _existingLocationData);\n</code></pre>\n"},{"tags":["java","utf-8","emoji"],"comments":[{"owner":{"account_id":2053598,"reputation":41316,"user_id":1831987,"display_name":"VGR"},"score":0,"creation_date":1694798609,"post_id":77114203,"comment_id":135943360,"body_markdown":"Interestingly, your question shows a single pilot emoji in my browser.  I’m guessing you meant to say that the log shows &#129489;✈️.  This suggests that your string is correct;  the problem lies with how you are viewing the log.  Not all editors and text viewers are aware of the full set of Unicode emoji sequences.","body":"Interestingly, your question shows a single pilot emoji in my browser.  I’m guessing you meant to say that the log shows 🧑✈️.  This suggests that your string is correct;  the problem lies with how you are viewing the log.  Not all editors and text viewers are aware of the full set of Unicode emoji sequences."},{"owner":{"account_id":9008386,"reputation":83,"user_id":6714057,"display_name":"Long"},"score":0,"creation_date":1694799169,"post_id":77114203,"comment_id":135943454,"body_markdown":"not only the logs, but when I tried to generate image using Graphics2D, the image also contains 2 emojj instead of 1 noto image.","body":"not only the logs, but when I tried to generate image using Graphics2D, the image also contains 2 emojj instead of 1 noto image."},{"owner":{"account_id":2053598,"reputation":41316,"user_id":1831987,"display_name":"VGR"},"score":0,"creation_date":1694801246,"post_id":77114203,"comment_id":135943816,"body_markdown":"I’m nearly certain that the Java 2D renderer recognizes few, if any, Unicode emoji sequences.  Though I’m not sure to what extent such rendering is the font’s responsibility.","body":"I’m nearly certain that the Java 2D renderer recognizes few, if any, Unicode emoji sequences.  Though I’m not sure to what extent such rendering is the font’s responsibility."},{"owner":{"account_id":3211603,"reputation":289297,"user_id":2711488,"display_name":"Holger"},"score":1,"creation_date":1695228715,"post_id":77114203,"comment_id":135997590,"body_markdown":"Java can handle supplementary characters since Java&#160;5. Your emoji, however, consists of two codepoints combined with a zero-width-joiner, followed by a variant selector. Software only understanding 16 bit characters would say that this string has five chars (as `string.length()` would do), but `string.codePointCount(0, string.length())` will correctly tell you that there are four codepoints. Whereas `new Scanner(&quot;\\uD83E\\uDDD1\\u200D\\u2708\\uFE0F&quot;) .findAll(&quot;\\\\X&quot;).count()` will tell you whether it is recognized as one logical character (it is with Java&#160;13 and newer). The font also matters, though","body":"Java can handle supplementary characters since Java 5. Your emoji, however, consists of two codepoints combined with a zero-width-joiner, followed by a variant selector. Software only understanding 16 bit characters would say that this string has five chars (as <code>string.length()</code> would do), but <code>string.codePointCount(0, string.length())</code> will correctly tell you that there are four codepoints. Whereas <code>new Scanner(&quot;\\uD83E\\uDDD1\\u200D\\u2708\\uFE0F&quot;) .findAll(&quot;\\\\X&quot;).count()</code> will tell you whether it is recognized as one logical character (it is with Java 13 and newer). The font also matters, though"},{"owner":{"account_id":9008386,"reputation":83,"user_id":6714057,"display_name":"Long"},"score":0,"creation_date":1695795227,"post_id":77114203,"comment_id":136070222,"body_markdown":"The problem is my project using java 8 now. Do I need to upgrade java to 13 or higher to make it work?","body":"The problem is my project using java 8 now. Do I need to upgrade java to 13 or higher to make it work?"}],"owner":{"account_id":9008386,"reputation":83,"user_id":6714057,"display_name":"Long"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":41,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694799298,"creation_date":1694797471,"question_id":77114203,"body_markdown":"Currently, when I try to print/log/generate image with code on\r\n https://emojiterra.com/pilot/ \r\nfor noto image:\r\n\\\\uD83E\\\\uDDD1\\\\u200D\\\\u2708\\\\uFE0F. \r\nIt always show 2 emoji: &#129489;‍✈️ instead of 1 emoji for noto. [![enter image description here](https://i.stack.imgur.com/1FPj2.png)](https://i.stack.imgur.com/1FPj2.png)\r\n\r\n\r\nlog.info(&quot;\\uD83E\\uDDD1\\u200D\\u2708\\uFE0F&quot;) always display &#129489;‍✈️\r\n\r\nWhen using Graphics2D, it generate image like this:\r\n[![enter image description here][1]][1]\r\nI guess the issue happen is because java only support 16-bit characters, and noto emoji is a 32-bit.\r\n\r\nIs there a way that I can print/generate image with 32-bit emoji in java?\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/s0YP5.png","title":"Image generation with Emoji issue on Java","body":"<p>Currently, when I try to print/log/generate image with code on\n<a href=\"https://emojiterra.com/pilot/\" rel=\"nofollow noreferrer\">https://emojiterra.com/pilot/</a>\nfor noto image:\n\\uD83E\\uDDD1\\u200D\\u2708\\uFE0F.\nIt always show 2 emoji: 🧑‍✈️ instead of 1 emoji for noto. <a href=\"https://i.stack.imgur.com/1FPj2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1FPj2.png\" alt=\"enter image description here\" /></a></p>\n<p>log.info(&quot;\\uD83E\\uDDD1\\u200D\\u2708\\uFE0F&quot;) always display 🧑‍✈️</p>\n<p>When using Graphics2D, it generate image like this:\n<a href=\"https://i.stack.imgur.com/s0YP5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s0YP5.png\" alt=\"enter image description here\" /></a>\nI guess the issue happen is because java only support 16-bit characters, and noto emoji is a 32-bit.</p>\n<p>Is there a way that I can print/generate image with 32-bit emoji in java?</p>\n"},{"tags":["java","amazon-web-services","spring-boot","amazon-s3"],"answers":[{"tags":[],"owner":{"account_id":1540816,"reputation":10259,"user_id":1435543,"display_name":"smac2020"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1694799114,"creation_date":1694774260,"answer_id":77111668,"question_id":77108562,"body_markdown":"Your code base is very old and is not best practice. Instead of using V1, you should be using the lastest ***AWS S3 Java V2*** libs and use [Async calls][1] (non blocking). I will provide you a path to best practice S3 Java code. \r\n\r\n\r\nTo upload content to S3, strongly consider using the [AWS Transfer Manager][2].\r\n\r\nFor example, assume you want to upload a stream (binary data that is mp3 for example). In your example, that seems to be what you are attempting to do.\r\n\r\nYou can use this Async way with Transfer Manager to efficienty upload a data stream. Its very clean and represents best practice. \r\n\r\n\r\n    package org.example;\r\n    \r\n    import software.amazon.awssdk.core.async.AsyncRequestBody;\r\n    import software.amazon.awssdk.core.async.BlockingInputStreamAsyncRequestBody;\r\n    import software.amazon.awssdk.regions.Region;\r\n    import software.amazon.awssdk.services.s3.S3AsyncClient;\r\n    import software.amazon.awssdk.services.s3.model.S3Exception;\r\n    import software.amazon.awssdk.transfer.s3.S3TransferManager;\r\n    import software.amazon.awssdk.transfer.s3.model.Upload;\r\n    import java.io.FileInputStream;\r\n    import java.io.IOException;\r\n    import java.io.InputStream;\r\n    \r\n    \r\n    \r\n    public class Main {\r\n    \r\n        private static S3AsyncClient s3AsyncClient;\r\n    \r\n        private static synchronized S3AsyncClient getS3AsyncClient() {\r\n            if (s3AsyncClient == null) {\r\n                s3AsyncClient = S3AsyncClient.crtBuilder()\r\n                    .region(Region.US_EAST_1)\r\n                    .build();\r\n            }\r\n            return s3AsyncClient;\r\n        }\r\n        public static void main(String[] args) throws IOException {\r\n    \r\n    \r\n            System.out.println(&quot;This shows how to use the S3TransferManager to upload a file to S3!&quot;);\r\n            InputStream is = new FileInputStream(&quot;C:\\\\AWS\\\\output.mp3&quot;);\r\n    \r\n            String key = putAudio(is, &quot;scottpolicytestbucket2&quot;, &quot;output.mp3&quot;);\r\n            System.out.println(key + &quot; has been uploaded to S3!&quot;);\r\n    \r\n        }\r\n    \r\n        public static String putAudio(InputStream is, String bucketName, String key) throws S3Exception, IOException {\r\n            try {\r\n                S3TransferManager transferManager = S3TransferManager.builder()\r\n                    .s3Client(getS3AsyncClient())\r\n                    .build();\r\n    \r\n                BlockingInputStreamAsyncRequestBody body = AsyncRequestBody.forBlockingInputStream(null); // &#39;null&#39; indicates a stream will be provided later.\r\n                Upload upload = transferManager.upload(builder -&gt; builder\r\n                    .requestBody(body)\r\n                    .putObjectRequest(req -&gt; req.bucket(bucketName).key(key))\r\n                    .build());\r\n    \r\n                body.writeInputStream(is);\r\n                upload.completionFuture().join();\r\n                return key;\r\n    \r\n            } catch (S3Exception e) {\r\n                System.err.println(e.getMessage());\r\n                throw e;\r\n            }\r\n        }\r\n    }\r\n\r\nYou can find more examples for Transfer Manager in AWS Code Repo Github here: \r\n\r\nhttps://github.com/awsdocs/aws-doc-sdk-examples/tree/main/javav2/example_code/s3/src/main/java/com/example/s3/transfermanager\r\n\r\n\r\n**Update**\r\n\r\nHere is a full example POM that works. \r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n    &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\r\n             xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n             xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n        &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n    \r\n        &lt;groupId&gt;org.example&lt;/groupId&gt;\r\n        &lt;artifactId&gt;S3MavenTransferManager&lt;/artifactId&gt;\r\n        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\r\n    \r\n        &lt;properties&gt;\r\n            &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;\r\n            &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;\r\n            &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\r\n        &lt;/properties&gt;\r\n    \r\n        &lt;dependencyManagement&gt;\r\n            &lt;dependencies&gt;\r\n                &lt;dependency&gt;\r\n                    &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\r\n                    &lt;artifactId&gt;bom&lt;/artifactId&gt;\r\n                    &lt;version&gt;2.20.45&lt;/version&gt;\r\n                    &lt;type&gt;pom&lt;/type&gt;\r\n                    &lt;scope&gt;import&lt;/scope&gt;\r\n                &lt;/dependency&gt;\r\n                &lt;dependency&gt;\r\n                    &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\r\n                    &lt;artifactId&gt;log4j-bom&lt;/artifactId&gt;\r\n                    &lt;version&gt;2.19.0&lt;/version&gt;\r\n                    &lt;type&gt;pom&lt;/type&gt;\r\n                    &lt;scope&gt;import&lt;/scope&gt;\r\n                &lt;/dependency&gt;\r\n            &lt;/dependencies&gt;\r\n        &lt;/dependencyManagement&gt;\r\n        &lt;dependencies&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\r\n                &lt;artifactId&gt;dynamodb&lt;/artifactId&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;commons-logging&lt;/groupId&gt;\r\n                &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;\r\n                &lt;version&gt;1.2&lt;/version&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\r\n                &lt;artifactId&gt;apache-client&lt;/artifactId&gt;\r\n                &lt;exclusions&gt;\r\n                    &lt;exclusion&gt;\r\n                        &lt;groupId&gt;commons-logging&lt;/groupId&gt;\r\n                        &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;\r\n                    &lt;/exclusion&gt;\r\n                &lt;/exclusions&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\r\n                &lt;artifactId&gt;s3&lt;/artifactId&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;software.amazon.awssdk.crt&lt;/groupId&gt;\r\n                &lt;artifactId&gt;aws-crt&lt;/artifactId&gt;\r\n                &lt;version&gt;0.25.1&lt;/version&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\r\n                &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\r\n                &lt;artifactId&gt;log4j-api&lt;/artifactId&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\r\n                &lt;artifactId&gt;log4j-slf4j2-impl&lt;/artifactId&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\r\n                &lt;artifactId&gt;log4j-1.2-api&lt;/artifactId&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;com.amazonaws&lt;/groupId&gt;\r\n                &lt;artifactId&gt;aws-lambda-java-events&lt;/artifactId&gt;\r\n                &lt;version&gt;3.11.1&lt;/version&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\r\n                &lt;artifactId&gt;textract&lt;/artifactId&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\r\n                &lt;artifactId&gt;s3control&lt;/artifactId&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;com.amazonaws&lt;/groupId&gt;\r\n                &lt;artifactId&gt;aws-lambda-java-core&lt;/artifactId&gt;\r\n                &lt;version&gt;1.2.2&lt;/version&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\r\n                &lt;artifactId&gt;translate&lt;/artifactId&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\r\n                &lt;artifactId&gt;comprehend&lt;/artifactId&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;org.json&lt;/groupId&gt;\r\n                &lt;artifactId&gt;json&lt;/artifactId&gt;\r\n                &lt;version&gt;20230227&lt;/version&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\r\n                &lt;artifactId&gt;polly&lt;/artifactId&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;org.apache.maven.surefire&lt;/groupId&gt;\r\n                &lt;artifactId&gt;surefire-booter&lt;/artifactId&gt;\r\n                &lt;version&gt;3.0.0-M3&lt;/version&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\r\n                &lt;artifactId&gt;lambda&lt;/artifactId&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;commons-io&lt;/groupId&gt;\r\n                &lt;artifactId&gt;commons-io&lt;/artifactId&gt;\r\n                &lt;version&gt;2.7&lt;/version&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\r\n                &lt;artifactId&gt;s3-transfer-manager&lt;/artifactId&gt;\r\n                &lt;version&gt;2.20.26&lt;/version&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\r\n                &lt;artifactId&gt;junit-jupiter-engine&lt;/artifactId&gt;\r\n                &lt;version&gt;5.9.0&lt;/version&gt;\r\n                &lt;scope&gt;test&lt;/scope&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;com.googlecode.json-simple&lt;/groupId&gt;\r\n                &lt;artifactId&gt;json-simple&lt;/artifactId&gt;\r\n                &lt;version&gt;1.1&lt;/version&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\r\n                &lt;artifactId&gt;junit-jupiter-api&lt;/artifactId&gt;\r\n                &lt;version&gt;5.9.0&lt;/version&gt;\r\n                &lt;scope&gt;test&lt;/scope&gt;\r\n            &lt;/dependency&gt;\r\n        &lt;/dependencies&gt;\r\n        &lt;build&gt;\r\n            &lt;plugins&gt;\r\n                &lt;plugin&gt;\r\n                    &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;\r\n                    &lt;version&gt;2.22.2&lt;/version&gt;\r\n                &lt;/plugin&gt;\r\n                &lt;plugin&gt;\r\n                    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n                    &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;\r\n                    &lt;version&gt;3.3.0&lt;/version&gt;\r\n                    &lt;configuration&gt;\r\n                        &lt;createDependencyReducedPom&gt;false&lt;/createDependencyReducedPom&gt;\r\n                    &lt;/configuration&gt;\r\n                    &lt;executions&gt;\r\n                        &lt;execution&gt;\r\n                            &lt;phase&gt;package&lt;/phase&gt;\r\n                            &lt;goals&gt;\r\n                                &lt;goal&gt;shade&lt;/goal&gt;\r\n                            &lt;/goals&gt;\r\n                        &lt;/execution&gt;\r\n                    &lt;/executions&gt;\r\n                &lt;/plugin&gt;\r\n            &lt;/plugins&gt;\r\n        &lt;/build&gt;\r\n    &lt;/project&gt;\r\n\r\n\r\n  [1]: https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/asynchronous.html\r\n  [2]: https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/transfer-manager.html","title":"AWS S3Client putObject() Exception: Connection Pool Time Out","body":"<p>Your code base is very old and is not best practice. Instead of using V1, you should be using the lastest <em><strong>AWS S3 Java V2</strong></em> libs and use <a href=\"https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/asynchronous.html\" rel=\"nofollow noreferrer\">Async calls</a> (non blocking). I will provide you a path to best practice S3 Java code.</p>\n<p>To upload content to S3, strongly consider using the <a href=\"https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/transfer-manager.html\" rel=\"nofollow noreferrer\">AWS Transfer Manager</a>.</p>\n<p>For example, assume you want to upload a stream (binary data that is mp3 for example). In your example, that seems to be what you are attempting to do.</p>\n<p>You can use this Async way with Transfer Manager to efficienty upload a data stream. Its very clean and represents best practice.</p>\n<pre><code>package org.example;\n\nimport software.amazon.awssdk.core.async.AsyncRequestBody;\nimport software.amazon.awssdk.core.async.BlockingInputStreamAsyncRequestBody;\nimport software.amazon.awssdk.regions.Region;\nimport software.amazon.awssdk.services.s3.S3AsyncClient;\nimport software.amazon.awssdk.services.s3.model.S3Exception;\nimport software.amazon.awssdk.transfer.s3.S3TransferManager;\nimport software.amazon.awssdk.transfer.s3.model.Upload;\nimport java.io.FileInputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\n\n\n\npublic class Main {\n\n    private static S3AsyncClient s3AsyncClient;\n\n    private static synchronized S3AsyncClient getS3AsyncClient() {\n        if (s3AsyncClient == null) {\n            s3AsyncClient = S3AsyncClient.crtBuilder()\n                .region(Region.US_EAST_1)\n                .build();\n        }\n        return s3AsyncClient;\n    }\n    public static void main(String[] args) throws IOException {\n\n\n        System.out.println(&quot;This shows how to use the S3TransferManager to upload a file to S3!&quot;);\n        InputStream is = new FileInputStream(&quot;C:\\\\AWS\\\\output.mp3&quot;);\n\n        String key = putAudio(is, &quot;scottpolicytestbucket2&quot;, &quot;output.mp3&quot;);\n        System.out.println(key + &quot; has been uploaded to S3!&quot;);\n\n    }\n\n    public static String putAudio(InputStream is, String bucketName, String key) throws S3Exception, IOException {\n        try {\n            S3TransferManager transferManager = S3TransferManager.builder()\n                .s3Client(getS3AsyncClient())\n                .build();\n\n            BlockingInputStreamAsyncRequestBody body = AsyncRequestBody.forBlockingInputStream(null); // 'null' indicates a stream will be provided later.\n            Upload upload = transferManager.upload(builder -&gt; builder\n                .requestBody(body)\n                .putObjectRequest(req -&gt; req.bucket(bucketName).key(key))\n                .build());\n\n            body.writeInputStream(is);\n            upload.completionFuture().join();\n            return key;\n\n        } catch (S3Exception e) {\n            System.err.println(e.getMessage());\n            throw e;\n        }\n    }\n}\n</code></pre>\n<p>You can find more examples for Transfer Manager in AWS Code Repo Github here:</p>\n<p><a href=\"https://github.com/awsdocs/aws-doc-sdk-examples/tree/main/javav2/example_code/s3/src/main/java/com/example/s3/transfermanager\" rel=\"nofollow noreferrer\">https://github.com/awsdocs/aws-doc-sdk-examples/tree/main/javav2/example_code/s3/src/main/java/com/example/s3/transfermanager</a></p>\n<p><strong>Update</strong></p>\n<p>Here is a full example POM that works.</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\n         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;groupId&gt;org.example&lt;/groupId&gt;\n    &lt;artifactId&gt;S3MavenTransferManager&lt;/artifactId&gt;\n    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n\n    &lt;properties&gt;\n        &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;\n        &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n    &lt;/properties&gt;\n\n    &lt;dependencyManagement&gt;\n        &lt;dependencies&gt;\n            &lt;dependency&gt;\n                &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n                &lt;artifactId&gt;bom&lt;/artifactId&gt;\n                &lt;version&gt;2.20.45&lt;/version&gt;\n                &lt;type&gt;pom&lt;/type&gt;\n                &lt;scope&gt;import&lt;/scope&gt;\n            &lt;/dependency&gt;\n            &lt;dependency&gt;\n                &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n                &lt;artifactId&gt;log4j-bom&lt;/artifactId&gt;\n                &lt;version&gt;2.19.0&lt;/version&gt;\n                &lt;type&gt;pom&lt;/type&gt;\n                &lt;scope&gt;import&lt;/scope&gt;\n            &lt;/dependency&gt;\n        &lt;/dependencies&gt;\n    &lt;/dependencyManagement&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n            &lt;artifactId&gt;dynamodb&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;commons-logging&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;\n            &lt;version&gt;1.2&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n            &lt;artifactId&gt;apache-client&lt;/artifactId&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;commons-logging&lt;/groupId&gt;\n                    &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n            &lt;artifactId&gt;s3&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;software.amazon.awssdk.crt&lt;/groupId&gt;\n            &lt;artifactId&gt;aws-crt&lt;/artifactId&gt;\n            &lt;version&gt;0.25.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n            &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n            &lt;artifactId&gt;log4j-api&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n            &lt;artifactId&gt;log4j-slf4j2-impl&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n            &lt;artifactId&gt;log4j-1.2-api&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.amazonaws&lt;/groupId&gt;\n            &lt;artifactId&gt;aws-lambda-java-events&lt;/artifactId&gt;\n            &lt;version&gt;3.11.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n            &lt;artifactId&gt;textract&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n            &lt;artifactId&gt;s3control&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.amazonaws&lt;/groupId&gt;\n            &lt;artifactId&gt;aws-lambda-java-core&lt;/artifactId&gt;\n            &lt;version&gt;1.2.2&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n            &lt;artifactId&gt;translate&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n            &lt;artifactId&gt;comprehend&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.json&lt;/groupId&gt;\n            &lt;artifactId&gt;json&lt;/artifactId&gt;\n            &lt;version&gt;20230227&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n            &lt;artifactId&gt;polly&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.maven.surefire&lt;/groupId&gt;\n            &lt;artifactId&gt;surefire-booter&lt;/artifactId&gt;\n            &lt;version&gt;3.0.0-M3&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n            &lt;artifactId&gt;lambda&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;commons-io&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-io&lt;/artifactId&gt;\n            &lt;version&gt;2.7&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n            &lt;artifactId&gt;s3-transfer-manager&lt;/artifactId&gt;\n            &lt;version&gt;2.20.26&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\n            &lt;artifactId&gt;junit-jupiter-engine&lt;/artifactId&gt;\n            &lt;version&gt;5.9.0&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.googlecode.json-simple&lt;/groupId&gt;\n            &lt;artifactId&gt;json-simple&lt;/artifactId&gt;\n            &lt;version&gt;1.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\n            &lt;artifactId&gt;junit-jupiter-api&lt;/artifactId&gt;\n            &lt;version&gt;5.9.0&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;\n                &lt;version&gt;2.22.2&lt;/version&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.3.0&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;createDependencyReducedPom&gt;false&lt;/createDependencyReducedPom&gt;\n                &lt;/configuration&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;phase&gt;package&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;shade&lt;/goal&gt;\n                        &lt;/goals&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n&lt;/project&gt;\n</code></pre>\n"}],"owner":{"account_id":22107235,"reputation":5,"user_id":16362635,"display_name":"Mohamed E."},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":179,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77111668,"answer_count":1,"score":0,"last_activity_date":1694799114,"creation_date":1694728151,"question_id":77108562,"body_markdown":"I am seeing this stack trace in my spring boot project some time after I deploy to my servers. Everytime I restart Spring boot, the error disappears then reappears after a while:\r\n\r\n```\r\nCaused by: org.apache.http.conn.ConnectionPoolTimeoutException: Timeout waiting for connection from pool\r\n        at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.leaseConnection(PoolingHttpClientConnectionManager.java:316)\r\n        at org.apache.http.impl.conn.PoolingHttpClientConnectionManager$1.get(PoolingHttpClientConnectionManager.java:282)\r\n        at jdk.internal.reflect.GeneratedMethodAccessor51.invoke(Unknown Source)\r\n        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.base/java.lang.reflect.Method.invoke(Method.java:568)\r\n        at com.amazonaws.http.conn.ClientConnectionRequestFactory$Handler.invoke(ClientConnectionRequestFactory.java:70)\r\n        at com.amazonaws.http.conn.$Proxy130.get(Unknown Source)\r\n        at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:190)\r\n        at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:186)\r\n        at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:185)\r\n        at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:83)\r\n        at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:56)\r\n        at com.amazonaws.http.apache.client.impl.SdkHttpClient.execute(SdkHttpClient.java:72)\r\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeOneRequest(AmazonHttpClient.java:1346)\r\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1157)\r\n        ... 73 more\r\n```\r\n\r\nI suspect some client of leakage is happening where connections are not being released after being used. Here is how I am setting up my S3Client object:\r\n\r\n```\r\n@Bean\r\npublic AmazonS3 amazonS3Client(){\r\n    // Create a ClientConfiguration object to configure the S3 client\r\n    ClientConfiguration clientConfig = new ClientConfiguration();\r\n\r\n    // Set the maximum number of open HTTP connections (connection pool size)\r\n    clientConfig.setMaxConnections(500); // Set your desired pool size here\r\n    clientConfig.setConnectionTimeout(10000); // 15 seconds\r\n\r\n    Regions clientRegion = Regions.US_EAST_1;\r\n\r\n    AppConfig config = appConfigRepository.findAll().get(0);\r\n\r\n    String accessKey = config.getAmazonS3AccessKey();\r\n    String secretKey = config.getAmazonS3SecretKey();\r\n\r\n    //This code expects that you have AWS credentials set up per:\r\n    // https://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/setup-credentials.html\r\n    // Create AWS Basic Credentials\r\n    BasicAWSCredentials credentials = new BasicAWSCredentials(accessKey, secretKey);\r\n\r\n    // Configure the S3 client builder\r\n    AmazonS3ClientBuilder clientBuilder = AmazonS3ClientBuilder.standard()\r\n            .withCredentials(new AWSStaticCredentialsProvider(credentials))\r\n            .withClientConfiguration(clientConfig)\r\n            .withRegion(clientRegion);\r\n\r\n    // Build the S3 client\r\n    return clientBuilder.build();\r\n}\r\n```\r\n\r\nI then use this one object to upload images using the putObject method here:\r\n\r\n```\r\ntry (ByteArrayInputStream inputStream = new ByteArrayInputStream(imageBytes)) {\r\n    s3Client.putObject(bucketName, imagePath, inputStream, metadata);\r\n}\r\n```\r\n\r\nI tried increasing the size of the connection pool from the default (I believe it was 50) to 500. This had the effect of increasing the time it takes from restarting my spring boot project to the exception occurring. I also tried using a try with resources block incase somehow leaking my byteArray was an issue - this had no effect.","title":"AWS S3Client putObject() Exception: Connection Pool Time Out","body":"<p>I am seeing this stack trace in my spring boot project some time after I deploy to my servers. Everytime I restart Spring boot, the error disappears then reappears after a while:</p>\n<pre><code>Caused by: org.apache.http.conn.ConnectionPoolTimeoutException: Timeout waiting for connection from pool\n        at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.leaseConnection(PoolingHttpClientConnectionManager.java:316)\n        at org.apache.http.impl.conn.PoolingHttpClientConnectionManager$1.get(PoolingHttpClientConnectionManager.java:282)\n        at jdk.internal.reflect.GeneratedMethodAccessor51.invoke(Unknown Source)\n        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.base/java.lang.reflect.Method.invoke(Method.java:568)\n        at com.amazonaws.http.conn.ClientConnectionRequestFactory$Handler.invoke(ClientConnectionRequestFactory.java:70)\n        at com.amazonaws.http.conn.$Proxy130.get(Unknown Source)\n        at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:190)\n        at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:186)\n        at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:185)\n        at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:83)\n        at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:56)\n        at com.amazonaws.http.apache.client.impl.SdkHttpClient.execute(SdkHttpClient.java:72)\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeOneRequest(AmazonHttpClient.java:1346)\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1157)\n        ... 73 more\n</code></pre>\n<p>I suspect some client of leakage is happening where connections are not being released after being used. Here is how I am setting up my S3Client object:</p>\n<pre><code>@Bean\npublic AmazonS3 amazonS3Client(){\n    // Create a ClientConfiguration object to configure the S3 client\n    ClientConfiguration clientConfig = new ClientConfiguration();\n\n    // Set the maximum number of open HTTP connections (connection pool size)\n    clientConfig.setMaxConnections(500); // Set your desired pool size here\n    clientConfig.setConnectionTimeout(10000); // 15 seconds\n\n    Regions clientRegion = Regions.US_EAST_1;\n\n    AppConfig config = appConfigRepository.findAll().get(0);\n\n    String accessKey = config.getAmazonS3AccessKey();\n    String secretKey = config.getAmazonS3SecretKey();\n\n    //This code expects that you have AWS credentials set up per:\n    // https://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/setup-credentials.html\n    // Create AWS Basic Credentials\n    BasicAWSCredentials credentials = new BasicAWSCredentials(accessKey, secretKey);\n\n    // Configure the S3 client builder\n    AmazonS3ClientBuilder clientBuilder = AmazonS3ClientBuilder.standard()\n            .withCredentials(new AWSStaticCredentialsProvider(credentials))\n            .withClientConfiguration(clientConfig)\n            .withRegion(clientRegion);\n\n    // Build the S3 client\n    return clientBuilder.build();\n}\n</code></pre>\n<p>I then use this one object to upload images using the putObject method here:</p>\n<pre><code>try (ByteArrayInputStream inputStream = new ByteArrayInputStream(imageBytes)) {\n    s3Client.putObject(bucketName, imagePath, inputStream, metadata);\n}\n</code></pre>\n<p>I tried increasing the size of the connection pool from the default (I believe it was 50) to 500. This had the effect of increasing the time it takes from restarting my spring boot project to the exception occurring. I also tried using a try with resources block incase somehow leaking my byteArray was an issue - this had no effect.</p>\n"},{"tags":["java","garbage-collection"],"comments":[{"owner":{"account_id":8532578,"reputation":39898,"user_id":6395627,"display_name":"Slaw"},"score":3,"creation_date":1694732547,"post_id":77108762,"comment_id":135933846,"body_markdown":"In this case, the `Runnable` lambda is capturing `this` (a reference to the `State` object). It is a strong reference.","body":"In this case, the <code>Runnable</code> lambda is capturing <code>this</code> (a reference to the <code>State</code> object). It is a strong reference."},{"owner":{"account_id":27243397,"reputation":1316,"user_id":20769158,"display_name":"scrhartley"},"score":0,"creation_date":1694732727,"post_id":77108762,"comment_id":135933860,"body_markdown":"@Slaw I don&#39;t think the Runnable is capturing `this`, it&#39;s just creating a copy of `x`. As `x` is a primitive, that&#39;s a copy of the value. If `x` wasn&#39;t a primitive, it would be a copy of the reference.","body":"@Slaw I don&#39;t think the Runnable is capturing <code>this</code>, it&#39;s just creating a copy of <code>x</code>. As <code>x</code> is a primitive, that&#39;s a copy of the value. If <code>x</code> wasn&#39;t a primitive, it would be a copy of the reference."},{"owner":{"account_id":27243397,"reputation":1316,"user_id":20769158,"display_name":"scrhartley"},"score":0,"creation_date":1694733192,"post_id":77108762,"comment_id":135933908,"body_markdown":"See here for the explanation about value copying with lambdas: https://blogs.oracle.com/javamagazine/post/java-lambda-local-variable-closure","body":"See here for the explanation about value copying with lambdas: <a href=\"https://blogs.oracle.com/javamagazine/post/java-lambda-local-variable-closure\" rel=\"nofollow noreferrer\">blogs.oracle.com/javamagazine/post/&hellip;</a>"},{"owner":{"account_id":1691630,"reputation":49583,"user_id":1553851,"accept_rate":73,"display_name":"shmosel"},"score":1,"creation_date":1694734494,"post_id":77108762,"comment_id":135934009,"body_markdown":"@scrhartley No, it&#39;s capturing `this`. You can test by modifying `x` after the lambda creation.","body":"@scrhartley No, it&#39;s capturing <code>this</code>. You can test by modifying <code>x</code> after the lambda creation."},{"owner":{"account_id":14357,"reputation":9128,"user_id":29470,"display_name":"Tim Moore"},"score":0,"creation_date":1694734629,"post_id":77108762,"comment_id":135934023,"body_markdown":"@scrhartley that isn’t correct. The link you shared is referring to local variables, but this is an instance variable.","body":"@scrhartley that isn’t correct. The link you shared is referring to local variables, but this is an instance variable."},{"owner":{"account_id":27243397,"reputation":1316,"user_id":20769158,"display_name":"scrhartley"},"score":0,"creation_date":1694735222,"post_id":77108762,"comment_id":135934071,"body_markdown":"@shmosel Thanks for the correction.","body":"@shmosel Thanks for the correction."},{"owner":{"account_id":3211603,"reputation":289297,"user_id":2711488,"display_name":"Holger"},"score":1,"creation_date":1694768871,"post_id":77108762,"comment_id":135937602,"body_markdown":"As long as the code looks like shown in the question, i.e. `runnable` is never accessed, both, the `Runnable` and the captured `this` are eligible to garbage collection. See [Can java finalize an object when it is still in scope?](https://stackoverflow.com/a/24380219/2711488)","body":"As long as the code looks like shown in the question, i.e. <code>runnable</code> is never accessed, both, the <code>Runnable</code> and the captured <code>this</code> are eligible to garbage collection. See <a href=\"https://stackoverflow.com/a/24380219/2711488\">Can java finalize an object when it is still in scope?</a>"},{"owner":{"account_id":1343574,"reputation":1526,"user_id":1284735,"accept_rate":62,"display_name":"petabyte"},"score":0,"creation_date":1694798744,"post_id":77108762,"comment_id":135943378,"body_markdown":"@Holger I modified the script so that runnable is executed. Please take a look, could `state` be garbage collected in this case?","body":"@Holger I modified the script so that runnable is executed. Please take a look, could <code>state</code> be garbage collected in this case?"},{"owner":{"account_id":8532578,"reputation":39898,"user_id":6395627,"display_name":"Slaw"},"score":0,"creation_date":1694801925,"post_id":77108762,"comment_id":135943929,"body_markdown":"@petabyte As long as the `Runnable` instance is strongly referenced, so is the `State` instance. Just like normal. Now, in your code, you don&#39;t keep a reference of the `Runnable` anywhere except in a local variable, meaning once the method returns, the `Runnable` is eligible for GC (and thus the `State` object). That&#39;s obviously ignoring the fact the method in question is the main method, and you don&#39;t start any non-daemon threads, which means the JVM will terminate once it returns.","body":"@petabyte As long as the <code>Runnable</code> instance is strongly referenced, so is the <code>State</code> instance. Just like normal. Now, in your code, you don&#39;t keep a reference of the <code>Runnable</code> anywhere except in a local variable, meaning once the method returns, the <code>Runnable</code> is eligible for GC (and thus the <code>State</code> object). That&#39;s obviously ignoring the fact the method in question is the main method, and you don&#39;t start any non-daemon threads, which means the JVM will terminate once it returns."},{"owner":{"account_id":1343574,"reputation":1526,"user_id":1284735,"accept_rate":62,"display_name":"petabyte"},"score":0,"creation_date":1694804154,"post_id":77108762,"comment_id":135944249,"body_markdown":"@Slaw makes sense, thanks. In this case though, I see the lambda is capturing `this`, but why does it have to? If JVM knows that only `x` is required, could it just throw away everything else? I mean even just pointer to `x`","body":"@Slaw makes sense, thanks. In this case though, I see the lambda is capturing <code>this</code>, but why does it have to? If JVM knows that only <code>x</code> is required, could it just throw away everything else? I mean even just pointer to <code>x</code>"},{"owner":{"account_id":8532578,"reputation":39898,"user_id":6395627,"display_name":"Slaw"},"score":2,"creation_date":1694820888,"post_id":77108762,"comment_id":135946262,"body_markdown":"Because `x` is a field, and so it needs a reference to `this` so that it can always get the most up-to-date value. I suppose it&#39;s possible that JIT might optimize that by copying `x` if it were `final` or if JIT determines it&#39;s never modified, but I have no idea if that happens. Now, if you&#39;re asking why the JVM can&#39;t just keep a direct pointer to `x` instead of via `this`, well I would say in that scenario, if the `State` instance is GC&#39;d, then what happens to `x`? The `x` field value is part of the object memory that&#39;s just been reclaimed (making `x` meaningless).","body":"Because <code>x</code> is a field, and so it needs a reference to <code>this</code> so that it can always get the most up-to-date value. I suppose it&#39;s possible that JIT might optimize that by copying <code>x</code> if it were <code>final</code> or if JIT determines it&#39;s never modified, but I have no idea if that happens. Now, if you&#39;re asking why the JVM can&#39;t just keep a direct pointer to <code>x</code> instead of via <code>this</code>, well I would say in that scenario, if the <code>State</code> instance is GC&#39;d, then what happens to <code>x</code>? The <code>x</code> field value is part of the object memory that&#39;s just been reclaimed (making <code>x</code> meaningless)."},{"owner":{"account_id":3211603,"reputation":289297,"user_id":2711488,"display_name":"Holger"},"score":3,"creation_date":1695108623,"post_id":77108762,"comment_id":135976380,"body_markdown":"To build on @Slaw’s comment, such optimization is possible in practice by inlining the code of `State`’s constructor, the `runnable()` and the `run()` method into the caller, then transforming the caller to a form which simply uses the value `10` which would be written to `x` in the constructor in the print statement directly instead of reading `x`. This requires that either, no thread synchronization happens in-between or Escape Analysis proves that `State` is never seen by other threads. Then both, `State` and `Runnable` instances, are garbage collectible or never created in the first place.","body":"To build on @Slaw’s comment, such optimization is possible in practice by inlining the code of <code>State</code>’s constructor, the <code>runnable()</code> and the <code>run()</code> method into the caller, then transforming the caller to a form which simply uses the value <code>10</code> which would be written to <code>x</code> in the constructor in the print statement directly instead of reading <code>x</code>. This requires that either, no thread synchronization happens in-between or Escape Analysis proves that <code>State</code> is never seen by other threads. Then both, <code>State</code> and <code>Runnable</code> instances, are garbage collectible or never created in the first place."}],"owner":{"account_id":1343574,"reputation":1526,"user_id":1284735,"accept_rate":62,"display_name":"petabyte"},"comment_count":12,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":83,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694798638,"creation_date":1694731602,"question_id":77108762,"body_markdown":"Does a reference to an instance variable keep the object around, or would it get garbage collected if it&#39;s not reachable?\r\n\r\n```java\r\npublic class State {\r\n    private int x = 10;\r\n    \r\n    Runnable runnable() {\r\n        return () -&gt; System.out.println(x);\r\n    }\r\n    \r\n    public static void main(String[] args) {\r\n       State state = new State();\r\n       Runnable runnable = state.runnable();\r\n       state = null;\r\n       // Is the `state` object eligible for collection here?\r\n       runnable.run();\r\n    }\r\n}","title":"Garbage collection with closure of instance variable","body":"<p>Does a reference to an instance variable keep the object around, or would it get garbage collected if it's not reachable?</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class State {\n    private int x = 10;\n    \n    Runnable runnable() {\n        return () -&gt; System.out.println(x);\n    }\n    \n    public static void main(String[] args) {\n       State state = new State();\n       Runnable runnable = state.runnable();\n       state = null;\n       // Is the `state` object eligible for collection here?\n       runnable.run();\n    }\n}\n</code></pre>\n"},{"tags":["java","hibernate","spring-boot"],"comments":[{"owner":{"account_id":12626017,"reputation":5868,"user_id":10426557,"display_name":"Jonathan JOhx"},"score":0,"creation_date":1569303898,"post_id":58054915,"comment_id":102542507,"body_markdown":"Possible duplicate of [What is the meaning of the CascadeType.ALL for a @ManyToOne JPA association](https://stackoverflow.com/questions/13027214/what-is-the-meaning-of-the-cascadetype-all-for-a-manytoone-jpa-association)","body":"Possible duplicate of <a href=\"https://stackoverflow.com/questions/13027214/what-is-the-meaning-of-the-cascadetype-all-for-a-manytoone-jpa-association\">What is the meaning of the CascadeType.ALL for a @ManyToOne JPA association</a>"}],"answers":[{"tags":[],"owner":{"account_id":14361012,"reputation":834,"user_id":10373317,"display_name":"GauravRai1512"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1569210718,"creation_date":1569210718,"answer_id":58055438,"question_id":58054915,"body_markdown":"This is something which you need to understand. first of all how effective you are designing your database also is your table independent or there is any relation with another table. please have a look on below points:\r\n\r\n1.  If Your table has multiple link with another table and persisting data in a single table should cascade data to all dependent table then in that scenario you have to use CascadeType.ALL For Example:\r\n\r\n    \r\nEmployeeEntity.java\r\n\r\n    @Entity\r\n    @Table(name = &quot;Employee&quot;)\r\n    public class EmployeeEntity implements Serializable\r\n    {\r\n        private static final long serialVersionUID = -1798070786993154676L;\r\n        @Id\r\n        @Column(name = &quot;ID&quot;, unique = true, nullable = false)\r\n        private Integer           employeeId;\r\n        @Column(name = &quot;FIRST_NAME&quot;, unique = false, nullable = false, length = 100)\r\n        private String            firstName;\r\n        @Column(name = &quot;LAST_NAME&quot;, unique = false, nullable = false, length = 100)\r\n        private String            lastName;\r\n     \r\n        @OneToMany(cascade=CascadeType.ALL, fetch = FetchType.LAZY)\r\n        @JoinColumn(name=&quot;EMPLOYEE_ID&quot;)\r\n        private Set&lt;AccountEntity&gt; accounts;\r\n     \r\n        //Getters and Setters Ommited\r\n    }\r\n\r\nAccountEntity.java\r\n\r\n    @Entity\r\n    @Table(name = &quot;Account&quot;)\r\n    public class AccountEntity implements Serializable\r\n    {\r\n        private static final long serialVersionUID = 1L;\r\n        @Id\r\n        @Column(name = &quot;ID&quot;, unique = true, nullable = false)\r\n        @GeneratedValue(strategy = GenerationType.SEQUENCE)\r\n        private Integer           accountId;\r\n        @Column(name = &quot;ACC_NO&quot;, unique = false, nullable = false, length = 100)\r\n        private String            accountNumber;\r\n     \r\n        @OneToOne (mappedBy=&quot;accounts&quot;,  fetch = FetchType.LAZY)\r\n        private EmployeeEntity employee;\r\n     \r\n    }\r\n\r\nLook at the above source code for EmployeeEntity.java. It defines “cascade=CascadeType.ALL” and it essentially means that any change happened on EmployeeEntity must cascade to AccountEntity as well. If you save an employee, then all associated accounts will also be saved into database. If you delete an Employee then all accounts associated with that Employee also be deleted. Simple enough.\r\n\r\nBut what if we only want to cascade only save operations but not delete operation. Then we need to clearly specify it using below code.\r\n\r\n    @OneToMany(cascade=CascadeType.PERSIST, fetch = FetchType.LAZY)\r\n    @JoinColumn(name=&quot;EMPLOYEE_ID&quot;)\r\n    private Set&lt;AccountEntity&gt; accounts;\r\n\r\nThere is no default cascade type in JPA. By default no operations are cascaded.","title":"Hibernate: When should I use Cascade.ALL and when should i specify them separately","body":"<p>This is something which you need to understand. first of all how effective you are designing your database also is your table independent or there is any relation with another table. please have a look on below points:</p>\n\n<ol>\n<li>If Your table has multiple link with another table and persisting data in a single table should cascade data to all dependent table then in that scenario you have to use CascadeType.ALL For Example:</li>\n</ol>\n\n<p>EmployeeEntity.java</p>\n\n<pre><code>@Entity\n@Table(name = \"Employee\")\npublic class EmployeeEntity implements Serializable\n{\n    private static final long serialVersionUID = -1798070786993154676L;\n    @Id\n    @Column(name = \"ID\", unique = true, nullable = false)\n    private Integer           employeeId;\n    @Column(name = \"FIRST_NAME\", unique = false, nullable = false, length = 100)\n    private String            firstName;\n    @Column(name = \"LAST_NAME\", unique = false, nullable = false, length = 100)\n    private String            lastName;\n\n    @OneToMany(cascade=CascadeType.ALL, fetch = FetchType.LAZY)\n    @JoinColumn(name=\"EMPLOYEE_ID\")\n    private Set&lt;AccountEntity&gt; accounts;\n\n    //Getters and Setters Ommited\n}\n</code></pre>\n\n<p>AccountEntity.java</p>\n\n<pre><code>@Entity\n@Table(name = \"Account\")\npublic class AccountEntity implements Serializable\n{\n    private static final long serialVersionUID = 1L;\n    @Id\n    @Column(name = \"ID\", unique = true, nullable = false)\n    @GeneratedValue(strategy = GenerationType.SEQUENCE)\n    private Integer           accountId;\n    @Column(name = \"ACC_NO\", unique = false, nullable = false, length = 100)\n    private String            accountNumber;\n\n    @OneToOne (mappedBy=\"accounts\",  fetch = FetchType.LAZY)\n    private EmployeeEntity employee;\n\n}\n</code></pre>\n\n<p>Look at the above source code for EmployeeEntity.java. It defines “cascade=CascadeType.ALL” and it essentially means that any change happened on EmployeeEntity must cascade to AccountEntity as well. If you save an employee, then all associated accounts will also be saved into database. If you delete an Employee then all accounts associated with that Employee also be deleted. Simple enough.</p>\n\n<p>But what if we only want to cascade only save operations but not delete operation. Then we need to clearly specify it using below code.</p>\n\n<pre><code>@OneToMany(cascade=CascadeType.PERSIST, fetch = FetchType.LAZY)\n@JoinColumn(name=\"EMPLOYEE_ID\")\nprivate Set&lt;AccountEntity&gt; accounts;\n</code></pre>\n\n<p>There is no default cascade type in JPA. By default no operations are cascaded.</p>\n"},{"tags":[],"owner":{"account_id":12626017,"reputation":5868,"user_id":10426557,"display_name":"Jonathan JOhx"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1569211385,"creation_date":1569211385,"answer_id":58055513,"question_id":58054915,"body_markdown":"**What does `CascadeType.ALL` mean and when should I use?**\r\n\r\n`CascadeType.ALL`are all operations `(PERSIST, MERGE, REMOVE, REFRESH, DETACH)` that are propagated to the associated entity to the relating entities in persistence context.\r\n\r\nSo, this question is very general, if you know these definitions, you can identify if it is necessary or not to use `CascadeType.ALL`.\r\n\r\n\r\n\r\n**DOCUMENTATION:**\r\n\r\nThe `EntityManager` has APIs to persist new entities, `remove` (delete) existing entities, `refresh` entity state from the datastore, and `merge` detached entity state back into the persistence context.\r\n\r\nWhen the `EntityManager` is performing the above operations, you can instruct it to automatically cascade the operation to the entities held in a persistent field with the cascade property of your metadata annotation. This process is recursive. The cascade property accepts an array of CascadeType enum values.\r\n\r\n**CascadeType.PERSIST**: When persisting an entity, also persist the entities held in this field. We suggest liberal application of this cascade rule, because if the EntityManager finds a field that references a new entity during flush, and the field does not use CascadeType.PERSIST, it is an error.\r\n\r\n**CascadeType.MERGE**: When merging entity state, also merge the entities held in this field.\r\n\r\n**CascadeType.REMOVE**: When deleting an entity, also delete the entities held in this field.\r\n\r\n**CascadeType.REFRESH**: When refreshing an entity, also refresh the entities held in this field.\r\n\r\n**CascadeType.DETACH**: When detaching an entity, also detach the entities held in this field.\r\n\r\n\r\n\r\n\r\n**REFERENCES:**\r\n\r\n[EJB3.0 Specification - 2.1.7 Entity Relationships][1]\r\n\r\n[Apache-openjpa docs JPA overview meta cascade][2]\r\n\r\n\r\n  [1]: https://download.oracle.com/otn-pub/jcp/ejb-3_0-fr-eval-oth-JSpec/ejb-3_0-fr-spec-persistence.pdf?AuthParam=1569211089_2c912ca451afd59f7ffc3468239708ef\r\n  [2]: http://openjpa.apache.org/builds/2.4.0/apache-openjpa/docs/jpa_overview_meta_field.html#jpa_overview_meta_cascade","title":"Hibernate: When should I use Cascade.ALL and when should i specify them separately","body":"<p><strong>What does <code>CascadeType.ALL</code> mean and when should I use?</strong></p>\n\n<p><code>CascadeType.ALL</code>are all operations <code>(PERSIST, MERGE, REMOVE, REFRESH, DETACH)</code> that are propagated to the associated entity to the relating entities in persistence context.</p>\n\n<p>So, this question is very general, if you know these definitions, you can identify if it is necessary or not to use <code>CascadeType.ALL</code>.</p>\n\n<p><strong>DOCUMENTATION:</strong></p>\n\n<p>The <code>EntityManager</code> has APIs to persist new entities, <code>remove</code> (delete) existing entities, <code>refresh</code> entity state from the datastore, and <code>merge</code> detached entity state back into the persistence context.</p>\n\n<p>When the <code>EntityManager</code> is performing the above operations, you can instruct it to automatically cascade the operation to the entities held in a persistent field with the cascade property of your metadata annotation. This process is recursive. The cascade property accepts an array of CascadeType enum values.</p>\n\n<p><strong>CascadeType.PERSIST</strong>: When persisting an entity, also persist the entities held in this field. We suggest liberal application of this cascade rule, because if the EntityManager finds a field that references a new entity during flush, and the field does not use CascadeType.PERSIST, it is an error.</p>\n\n<p><strong>CascadeType.MERGE</strong>: When merging entity state, also merge the entities held in this field.</p>\n\n<p><strong>CascadeType.REMOVE</strong>: When deleting an entity, also delete the entities held in this field.</p>\n\n<p><strong>CascadeType.REFRESH</strong>: When refreshing an entity, also refresh the entities held in this field.</p>\n\n<p><strong>CascadeType.DETACH</strong>: When detaching an entity, also detach the entities held in this field.</p>\n\n<p><strong>REFERENCES:</strong></p>\n\n<p><a href=\"https://download.oracle.com/otn-pub/jcp/ejb-3_0-fr-eval-oth-JSpec/ejb-3_0-fr-spec-persistence.pdf?AuthParam=1569211089_2c912ca451afd59f7ffc3468239708ef\" rel=\"nofollow noreferrer\">EJB3.0 Specification - 2.1.7 Entity Relationships</a></p>\n\n<p><a href=\"http://openjpa.apache.org/builds/2.4.0/apache-openjpa/docs/jpa_overview_meta_field.html#jpa_overview_meta_cascade\" rel=\"nofollow noreferrer\">Apache-openjpa docs JPA overview meta cascade</a></p>\n"},{"tags":[],"owner":{"account_id":8389289,"reputation":723,"user_id":6298537,"display_name":"yashjain12yj"},"down_vote_count":0,"up_vote_count":6,"is_accepted":true,"score":6,"last_activity_date":1569219376,"creation_date":1569219376,"answer_id":58056589,"question_id":58054915,"body_markdown":"**Cascading** is about persistence actions involving one object propagating to other objects via an association.\r\n\r\nCascading can apply to a variety of Hibernate actions, and it is typically transitive.  The **&quot;cascade=CascadeType...&quot;** attribute of the annotation that defines the association says what actions should cascade for that association.\r\n\r\n**Cascade = &quot;all&quot;** means to apply all primary cascade types.\r\n\r\nAs of Hibernate 5.3, these types are:\r\n\r\n   - &quot;delete&quot; / &quot;remove&quot;,\r\n   - &quot;detach&quot; / &quot;evict&quot;, \r\n   - &quot;merge&quot;, \r\n   - &quot;lock&quot;,\r\n   - &quot;persist&quot;, \r\n   - &quot;refresh&quot;, \r\n   - &quot;replicate&quot;,\r\n   - &quot;save_update&quot; / &quot;update&quot;\r\n\r\n(Some of those cascade type names are old and/or deprecated.)\r\n\r\nThere are three more compound types:\r\n\r\n - **&quot;all_delete_orphan&quot;** - means the same as &quot;all&quot; plus enabling the deletion of entities that are orphaned by the cascading.\r\n - **&quot;delete_orphan&quot;** - means &quot;delete&quot; plus orphan deletion.\r\n - **&quot;none&quot;** - means no cascading.\r\n\r\n","title":"Hibernate: When should I use Cascade.ALL and when should i specify them separately","body":"<p><strong>Cascading</strong> is about persistence actions involving one object propagating to other objects via an association.</p>\n\n<p>Cascading can apply to a variety of Hibernate actions, and it is typically transitive.  The <strong>\"cascade=CascadeType...\"</strong> attribute of the annotation that defines the association says what actions should cascade for that association.</p>\n\n<p><strong>Cascade = \"all\"</strong> means to apply all primary cascade types.</p>\n\n<p>As of Hibernate 5.3, these types are:</p>\n\n<ul>\n<li>\"delete\" / \"remove\",</li>\n<li>\"detach\" / \"evict\", </li>\n<li>\"merge\", </li>\n<li>\"lock\",</li>\n<li>\"persist\", </li>\n<li>\"refresh\", </li>\n<li>\"replicate\",</li>\n<li>\"save_update\" / \"update\"</li>\n</ul>\n\n<p>(Some of those cascade type names are old and/or deprecated.)</p>\n\n<p>There are three more compound types:</p>\n\n<ul>\n<li><strong>\"all_delete_orphan\"</strong> - means the same as \"all\" plus enabling the deletion of entities that are orphaned by the cascading.</li>\n<li><strong>\"delete_orphan\"</strong> - means \"delete\" plus orphan deletion.</li>\n<li><strong>\"none\"</strong> - means no cascading.</li>\n</ul>\n"},{"tags":[],"owner":{"account_id":16747579,"reputation":101,"user_id":12105387,"display_name":"Abhishek Shinde"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1569221398,"creation_date":1569221398,"answer_id":58057000,"question_id":58054915,"body_markdown":"Apart from opinions above, would also like to add following points.\r\nFrom OOPs perspective, we should think in terms of Composition vs Aggregation.\r\nIn java there is no away we can enforce strict relationship between parent and child unlike in DB using FK keys.\r\n\r\nConceptually CASCADE option in hibernate enforces us to maintain this strict relationship.","title":"Hibernate: When should I use Cascade.ALL and when should i specify them separately","body":"<p>Apart from opinions above, would also like to add following points.\nFrom OOPs perspective, we should think in terms of Composition vs Aggregation.\nIn java there is no away we can enforce strict relationship between parent and child unlike in DB using FK keys.</p>\n\n<p>Conceptually CASCADE option in hibernate enforces us to maintain this strict relationship.</p>\n"}],"owner":{"display_name":"user12099587"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":11871,"favorite_count":0,"down_vote_count":0,"up_vote_count":6,"accepted_answer_id":58056589,"answer_count":4,"score":6,"last_activity_date":1694798594,"creation_date":1569204976,"question_id":58054915,"body_markdown":"I usually annotate my `one-to-many`, `many-to-many` and `many-to-one` relationships with `CascadeType.ALL`, because they provide me with all features I need. But I feel it can lead me to some problems in the future. Is it okay to use `CascadeType.ALL`? What should I be aware of and why should I not use that?","title":"Hibernate: When should I use Cascade.ALL and when should i specify them separately","body":"<p>I usually annotate my <code>one-to-many</code>, <code>many-to-many</code> and <code>many-to-one</code> relationships with <code>CascadeType.ALL</code>, because they provide me with all features I need. But I feel it can lead me to some problems in the future. Is it okay to use <code>CascadeType.ALL</code>? What should I be aware of and why should I not use that?</p>\n"},{"tags":["java","android"],"owner":{"account_id":26337418,"reputation":1,"user_id":19997066,"display_name":"teoder"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":12,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1694798181,"answer_count":0,"score":0,"last_activity_date":1694798232,"creation_date":1694797310,"question_id":77114184,"body_markdown":"i&#39;m trying to get file from file manager in android. In fact, i have this code, that open file manager: \r\n```\r\n Intent getCsv = new Intent(Intent.ACTION_GET_CONTENT);\r\n getCsv.setType(&quot;*/*&quot;);\r\n startActivityForResult(getCsv, 1);\r\n```\r\nBut i don&#39;t know, how can i get the file to variable File file for example. \r\nI can get a uri, but this uri have a very strange path.\r\n\r\n```\r\nprotected void onActivityResult(int requestCode, int resultCode, Intent data)\r\n    {\r\n        super.onActivityResult(requestCode, resultCode, data);\r\n        if (requestCode == 1 &amp;&amp; resultCode == Activity.RESULT_OK)\r\n        {\r\n            Uri uriObj = data.getData();\r\n        }\r\n    }\r\n```\r\nFor example, path of uri: `content://com.android.externalstorage.documents/document/primary%3Atests.csv`.\r\nHow can i get a File?\r\n\r\n\r\nI have tried this:\r\n\r\n```\r\nUri uriObj = data.getData();\r\nFile fff = new File(uriObj.getPath());\r\n```\r\nBut file is `&quot;/document/primary:tests.csv&quot;`. The true file: `/storage/emulated/0/tests.csv`","title":"Pick file from storage","body":"<p>i'm trying to get file from file manager in android. In fact, i have this code, that open file manager:</p>\n<pre><code> Intent getCsv = new Intent(Intent.ACTION_GET_CONTENT);\n getCsv.setType(&quot;*/*&quot;);\n startActivityForResult(getCsv, 1);\n</code></pre>\n<p>But i don't know, how can i get the file to variable File file for example.\nI can get a uri, but this uri have a very strange path.</p>\n<pre><code>protected void onActivityResult(int requestCode, int resultCode, Intent data)\n    {\n        super.onActivityResult(requestCode, resultCode, data);\n        if (requestCode == 1 &amp;&amp; resultCode == Activity.RESULT_OK)\n        {\n            Uri uriObj = data.getData();\n        }\n    }\n</code></pre>\n<p>For example, path of uri: <code>content://com.android.externalstorage.documents/document/primary%3Atests.csv</code>.\nHow can i get a File?</p>\n<p>I have tried this:</p>\n<pre><code>Uri uriObj = data.getData();\nFile fff = new File(uriObj.getPath());\n</code></pre>\n<p>But file is <code>&quot;/document/primary:tests.csv&quot;</code>. The true file: <code>/storage/emulated/0/tests.csv</code></p>\n"},{"tags":["java","hibernate","jpa"],"comments":[{"owner":{"display_name":"user177800"},"score":0,"creation_date":1298320868,"post_id":5067619,"comment_id":5679949,"body_markdown":"What database and JDBC driver are you using?","body":"What database and JDBC driver are you using?"}],"answers":[{"tags":[],"owner":{"account_id":123612,"reputation":48061,"user_id":318174,"accept_rate":71,"display_name":"Adam Gent"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1298302930,"creation_date":1298301762,"answer_id":5067715,"question_id":5067619,"body_markdown":"I have wondered this myself. It seems to matter:\r\n\r\n * how big your dataset is (rows)\r\n * what JPA implementation you are using \r\n * what kind of processing you are doing for each row.\r\n\r\nI have written an Iterator to make it easy to swap out both approaches (findAll vs findEntries).\r\n\r\n**I recommend you try both.**\r\n\r\n\tLong count = entityManager().createQuery(&quot;select count(o) from Model o&quot;, Long.class).getSingleResult();\r\n\tChunkIterator&lt;Model&gt; it1 = new ChunkIterator&lt;Model&gt;(count, 2) {\r\n\t\t\r\n\t\t@Override\r\n\t\tpublic Iterator&lt;Model&gt; getChunk(long index, long chunkSize) {\r\n\t\t\t//Do your setFirst and setMax here and return an iterator.\r\n\t\t}\r\n\t\t\r\n\t};\r\n\r\n\tIterator&lt;Model&gt; it2 = List&lt;Model&gt; models = entityManager().createQuery(&quot;from Model m&quot;, Model.class).getResultList().iterator();\r\n\r\n\r\n\tpublic static abstract class ChunkIterator&lt;T&gt; \r\n\t\textends AbstractIterator&lt;T&gt; implements Iterable&lt;T&gt;{\r\n\t\tprivate Iterator&lt;T&gt; chunk;\r\n\t\tprivate Long count;\r\n\t\tprivate long index = 0;\r\n\t\tprivate long chunkSize = 100;\r\n\t\t\r\n\t\tpublic ChunkIterator(Long count, long chunkSize) {\r\n\t\t\tsuper();\r\n\t\t\tthis.count = count;\r\n\t\t\tthis.chunkSize = chunkSize;\r\n\t\t}\r\n\r\n\t\tpublic abstract Iterator&lt;T&gt; getChunk(long index, long chunkSize);\r\n\t\t\r\n\t\t@Override\r\n\t\tpublic Iterator&lt;T&gt; iterator() {\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t@Override\r\n\t\tprotected T computeNext() {\r\n\t\t\tif (count == 0) return endOfData();\r\n\t\t\tif (chunk != null &amp;&amp; chunk.hasNext() == false &amp;&amp; index &gt;= count) \r\n\t\t\t\treturn endOfData();\r\n\t\t\tif (chunk == null || chunk.hasNext() == false) {\r\n\t\t\t\tchunk = getChunk(index, chunkSize);\r\n\t\t\t\tindex += chunkSize;\r\n\t\t\t}\r\n\t\t\tif (chunk == null || chunk.hasNext() == false) \r\n\t\t\t\treturn endOfData();\r\n\t\t\treturn chunk.next();\r\n\t\t}\r\n\t\t\r\n\t}\r\nI ended up not using my chunk iterator (so it might not be that tested). By the way you will need google collections if you want to use it.","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<p>I have wondered this myself. It seems to matter:</p>\n\n<ul>\n<li>how big your dataset is (rows)</li>\n<li>what JPA implementation you are using </li>\n<li>what kind of processing you are doing for each row.</li>\n</ul>\n\n<p>I have written an Iterator to make it easy to swap out both approaches (findAll vs findEntries).</p>\n\n<p><strong>I recommend you try both.</strong></p>\n\n<pre><code>Long count = entityManager().createQuery(\"select count(o) from Model o\", Long.class).getSingleResult();\nChunkIterator&lt;Model&gt; it1 = new ChunkIterator&lt;Model&gt;(count, 2) {\n\n    @Override\n    public Iterator&lt;Model&gt; getChunk(long index, long chunkSize) {\n        //Do your setFirst and setMax here and return an iterator.\n    }\n\n};\n\nIterator&lt;Model&gt; it2 = List&lt;Model&gt; models = entityManager().createQuery(\"from Model m\", Model.class).getResultList().iterator();\n\n\npublic static abstract class ChunkIterator&lt;T&gt; \n    extends AbstractIterator&lt;T&gt; implements Iterable&lt;T&gt;{\n    private Iterator&lt;T&gt; chunk;\n    private Long count;\n    private long index = 0;\n    private long chunkSize = 100;\n\n    public ChunkIterator(Long count, long chunkSize) {\n        super();\n        this.count = count;\n        this.chunkSize = chunkSize;\n    }\n\n    public abstract Iterator&lt;T&gt; getChunk(long index, long chunkSize);\n\n    @Override\n    public Iterator&lt;T&gt; iterator() {\n        return this;\n    }\n\n    @Override\n    protected T computeNext() {\n        if (count == 0) return endOfData();\n        if (chunk != null &amp;&amp; chunk.hasNext() == false &amp;&amp; index &gt;= count) \n            return endOfData();\n        if (chunk == null || chunk.hasNext() == false) {\n            chunk = getChunk(index, chunkSize);\n            index += chunkSize;\n        }\n        if (chunk == null || chunk.hasNext() == false) \n            return endOfData();\n        return chunk.next();\n    }\n\n}\n</code></pre>\n\n<p>I ended up not using my chunk iterator (so it might not be that tested). By the way you will need google collections if you want to use it.</p>\n"},{"tags":[],"owner":{"account_id":155065,"reputation":3396,"user_id":371457,"accept_rate":100,"display_name":"frm"},"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1298302073,"creation_date":1298302073,"answer_id":5067783,"question_id":5067619,"body_markdown":"It depends upon the kind of operation you have to do. Why are you looping over a million of row? Are you updating something in batch mode? Are you going to display all records to a client? Are you computing some statistics upon the retrieved entities?\r\n\r\nIf you are going to display a million records to the client, please reconsider your user interface. In this case, the appropriate solution is paginating your results and using `setFirstResult()` and `setMaxResult()`.\r\n\r\nIf you have launched an update of a large amount of records, you&#39;ll better keep the update simple and use `Query.executeUpdate()`. Optionally, you can execute the update in asynchronous mode using a Message-Driven Bean o a Work Manager.\r\n\r\nIf you are computing some statistics upon the retrieved entities, you can take advantage on the grouping functions defined by the JPA specification.\r\n\r\nFor any other case, please be more specific :)","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<p>It depends upon the kind of operation you have to do. Why are you looping over a million of row? Are you updating something in batch mode? Are you going to display all records to a client? Are you computing some statistics upon the retrieved entities?</p>\n\n<p>If you are going to display a million records to the client, please reconsider your user interface. In this case, the appropriate solution is paginating your results and using <code>setFirstResult()</code> and <code>setMaxResult()</code>.</p>\n\n<p>If you have launched an update of a large amount of records, you'll better keep the update simple and use <code>Query.executeUpdate()</code>. Optionally, you can execute the update in asynchronous mode using a Message-Driven Bean o a Work Manager.</p>\n\n<p>If you are computing some statistics upon the retrieved entities, you can take advantage on the grouping functions defined by the JPA specification.</p>\n\n<p>For any other case, please be more specific :)</p>\n"},{"tags":[],"owner":{"account_id":299251,"reputation":335905,"user_id":605744,"accept_rate":100,"display_name":"Tomasz Nurkiewicz"},"down_vote_count":0,"up_vote_count":19,"is_accepted":false,"score":19,"last_activity_date":1298302487,"creation_date":1298302487,"answer_id":5067861,"question_id":5067619,"body_markdown":"To be honest, I would suggest leaving JPA and stick with JDBC (but certainly using `JdbcTemplate` support class or such like). JPA (and other ORM providers/specifications) is not designed to operate on many objects within one transaction as they assume everything loaded should stay in first-level cache (hence the need for `clear()` in JPA).\r\n\r\nAlso I am recommending more low level solution because the overhead of ORM (reflection is only a tip of an iceberg) might be so significant, that iterating over plain `ResultSet`, even using some lightweight support like mentioned `JdbcTemplate` will be much faster.\r\n\r\nJPA is simply not designed to perform operations on a large amount of entities. You might play with `flush()`/`clear()` to avoid `OutOfMemoryError`, but consider this once again. You gain very little paying the price of huge resource consumption.","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<p>To be honest, I would suggest leaving JPA and stick with JDBC (but certainly using <code>JdbcTemplate</code> support class or such like). JPA (and other ORM providers/specifications) is not designed to operate on many objects within one transaction as they assume everything loaded should stay in first-level cache (hence the need for <code>clear()</code> in JPA).</p>\n\n<p>Also I am recommending more low level solution because the overhead of ORM (reflection is only a tip of an iceberg) might be so significant, that iterating over plain <code>ResultSet</code>, even using some lightweight support like mentioned <code>JdbcTemplate</code> will be much faster.</p>\n\n<p>JPA is simply not designed to perform operations on a large amount of entities. You might play with <code>flush()</code>/<code>clear()</code> to avoid <code>OutOfMemoryError</code>, but consider this once again. You gain very little paying the price of huge resource consumption.</p>\n"},{"tags":[],"owner":{"account_id":159523,"reputation":12477,"user_id":378968,"accept_rate":87,"display_name":"Dead Programmer"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1298302834,"creation_date":1298302834,"answer_id":5067919,"question_id":5067619,"body_markdown":"Use `Pagination` Concept for retrieving result ","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<p>Use <code>Pagination</code> Concept for retrieving result </p>\n"},{"tags":[],"owner":{"display_name":"user177800"},"down_vote_count":2,"up_vote_count":7,"is_accepted":false,"score":5,"last_activity_date":1298391200,"creation_date":1298306040,"answer_id":5068542,"question_id":5067619,"body_markdown":"There is no &quot;proper&quot; what to do this, this isn&#39;t what JPA or JDO or any other ORM is intended to do, straight JDBC will be your best alternative, as you can configure it to bring back a small number of rows at a time and flush them as they are used, that is why server side cursors exist.\r\n\r\nORM tools are not designed for bulk processing, they are designed to let you manipulate objects and attempt to make the RDBMS that the data is stored in be as transparent as possible, most fail at the transparent part at least to some degree. At this scale, there is no way to process hundreds of thousands of rows ( Objects ), much less millions with any ORM and have it execute in any reasonable amount of time because of the object instantiation overhead, plain and simple. \r\n\r\nUse the appropriate tool. Straight JDBC and Stored Procedures definitely have a place in 2011, especially at what they are better at doing versus these ORM frameworks.\r\n\r\nPulling a million of anything, even into a simple `List&lt;Integer&gt;` is not going to be very efficient regardless of how you do it. The correct way to do what you are asking is a simple `SELECT id FROM table`, set to `SERVER SIDE` ( vendor dependent ) and the cursor to `FORWARD_ONLY READ-ONLY` and iterate over that.\r\n\r\nIf you are really pulling millions of id&#39;s to process by calling some web server with each one, you are going to have to do some concurrent processing as well for this to run in any reasonable amount of time. Pulling with a JDBC cursor and placing a few of them at a time in a [ConcurrentLinkedQueue][1] and having a small pool of threads  ( # CPU/Cores + 1 ) pull and process them is the only way to complete your task on a machine with any &quot;normal&quot; amount of RAM, given you are already running out of memory.\r\n\r\nSee this [answer][2] as well.\r\n\r\n\r\n  [1]: http://download.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentLinkedQueue.html\r\n  [2]: https://stackoverflow.com/questions/5047394/fast-way-to-get-results-in-hibernate","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<p>There is no \"proper\" what to do this, this isn't what JPA or JDO or any other ORM is intended to do, straight JDBC will be your best alternative, as you can configure it to bring back a small number of rows at a time and flush them as they are used, that is why server side cursors exist.</p>\n\n<p>ORM tools are not designed for bulk processing, they are designed to let you manipulate objects and attempt to make the RDBMS that the data is stored in be as transparent as possible, most fail at the transparent part at least to some degree. At this scale, there is no way to process hundreds of thousands of rows ( Objects ), much less millions with any ORM and have it execute in any reasonable amount of time because of the object instantiation overhead, plain and simple. </p>\n\n<p>Use the appropriate tool. Straight JDBC and Stored Procedures definitely have a place in 2011, especially at what they are better at doing versus these ORM frameworks.</p>\n\n<p>Pulling a million of anything, even into a simple <code>List&lt;Integer&gt;</code> is not going to be very efficient regardless of how you do it. The correct way to do what you are asking is a simple <code>SELECT id FROM table</code>, set to <code>SERVER SIDE</code> ( vendor dependent ) and the cursor to <code>FORWARD_ONLY READ-ONLY</code> and iterate over that.</p>\n\n<p>If you are really pulling millions of id's to process by calling some web server with each one, you are going to have to do some concurrent processing as well for this to run in any reasonable amount of time. Pulling with a JDBC cursor and placing a few of them at a time in a <a href=\"http://download.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentLinkedQueue.html\" rel=\"nofollow noreferrer\">ConcurrentLinkedQueue</a> and having a small pool of threads  ( # CPU/Cores + 1 ) pull and process them is the only way to complete your task on a machine with any \"normal\" amount of RAM, given you are already running out of memory.</p>\n\n<p>See this <a href=\"https://stackoverflow.com/questions/5047394/fast-way-to-get-results-in-hibernate\">answer</a> as well.</p>\n"},{"tags":[],"owner":{"account_id":33553,"reputation":30834,"user_id":93995,"accept_rate":81,"display_name":"George Armhold"},"down_vote_count":1,"up_vote_count":59,"is_accepted":true,"score":58,"last_activity_date":1430212418,"creation_date":1298323453,"answer_id":5071436,"question_id":5067619,"body_markdown":"Page 537 of [Java Persistence with Hibernate][1] gives a solution using `ScrollableResults`, but alas it&#39;s only for Hibernate.  \r\n\r\nSo it seems that using `setFirstResult`/`setMaxResults` and manual iteration really is necessary. Here&#39;s my solution using JPA:\r\n\r\n    private List&lt;Model&gt; getAllModelsIterable(int offset, int max)\r\n    {\r\n        return entityManager.createQuery(&quot;from Model m&quot;, Model.class).setFirstResult(offset).setMaxResults(max).getResultList();\r\n    }\r\n\r\nthen, use it like this:\r\n\r\n    private void iterateAll()\r\n    {\r\n        int offset = 0;\r\n\r\n        List&lt;Model&gt; models;\r\n        while ((models = Model.getAllModelsIterable(offset, 100)).size() &gt; 0)\r\n        {\r\n            entityManager.getTransaction().begin();\r\n            for (Model model : models)\r\n            {\r\n                log.info(&quot;do something with model: &quot; + model.getId());\r\n            }\r\n\r\n            entityManager.flush();\r\n            entityManager.clear();\r\n            em.getTransaction().commit();\r\n            offset += models.size();\r\n        }\r\n    }\r\n\r\n\r\n  [1]: http://www.amazon.com/Java-Persistence-Hibernate-Christian-Bauer/dp/1932394885","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<p>Page 537 of <a href=\"https://rads.stackoverflow.com/amzn/click/com/1932394885\" rel=\"noreferrer\" rel=\"nofollow noreferrer\">Java Persistence with Hibernate</a> gives a solution using <code>ScrollableResults</code>, but alas it's only for Hibernate.  </p>\n\n<p>So it seems that using <code>setFirstResult</code>/<code>setMaxResults</code> and manual iteration really is necessary. Here's my solution using JPA:</p>\n\n<pre><code>private List&lt;Model&gt; getAllModelsIterable(int offset, int max)\n{\n    return entityManager.createQuery(\"from Model m\", Model.class).setFirstResult(offset).setMaxResults(max).getResultList();\n}\n</code></pre>\n\n<p>then, use it like this:</p>\n\n<pre><code>private void iterateAll()\n{\n    int offset = 0;\n\n    List&lt;Model&gt; models;\n    while ((models = Model.getAllModelsIterable(offset, 100)).size() &gt; 0)\n    {\n        entityManager.getTransaction().begin();\n        for (Model model : models)\n        {\n            log.info(\"do something with model: \" + model.getId());\n        }\n\n        entityManager.flush();\n        entityManager.clear();\n        em.getTransaction().commit();\n        offset += models.size();\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":311422,"reputation":1687,"user_id":625001,"display_name":"Cyberax"},"down_vote_count":0,"up_vote_count":32,"is_accepted":false,"score":32,"last_activity_date":1319183685,"creation_date":1298325624,"answer_id":5071761,"question_id":5067619,"body_markdown":"You can&#39;t really do this in straight JPA, however Hibernate has support for stateless sessions and scrollable result sets.\r\n\r\nWe routinely process **billions** of rows with its help.\r\n\r\nHere is a link to documentation: http://docs.jboss.org/hibernate/core/3.3/reference/en/html/batch.html#batch-statelesssession","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<p>You can't really do this in straight JPA, however Hibernate has support for stateless sessions and scrollable result sets.</p>\n\n<p>We routinely process <strong>billions</strong> of rows with its help.</p>\n\n<p>Here is a link to documentation: <a href=\"http://docs.jboss.org/hibernate/core/3.3/reference/en/html/batch.html#batch-statelesssession\" rel=\"noreferrer\">http://docs.jboss.org/hibernate/core/3.3/reference/en/html/batch.html#batch-statelesssession</a></p>\n"},{"tags":[],"owner":{"account_id":320703,"reputation":4309,"user_id":639119,"display_name":"Zds"},"down_vote_count":0,"up_vote_count":44,"is_accepted":false,"score":44,"last_activity_date":1441615347,"creation_date":1299166526,"answer_id":5182888,"question_id":5067619,"body_markdown":"I tried the answers presented here, but JBoss 5.1 + MySQL Connector/J 5.1.15 + Hibernate 3.3.2 didn&#39;t work with those. We&#39;ve just migrated from JBoss 4.x to JBoss 5.1, so we&#39;ve stuck with it for now, and thus the latest Hibernate we can use is 3.3.2.\r\n\r\nAdding couple of extra parameters did the job, and code like this runs without OOMEs:\r\n\r\n\r\n            StatelessSession session = ((Session) entityManager.getDelegate()).getSessionFactory().openStatelessSession();\r\n            \r\n            Query query = session\r\n                    .createQuery(&quot;SELECT a FROM Address a WHERE .... ORDER BY a.id&quot;);\r\n            query.setFetchSize(Integer.valueOf(1000));\r\n            query.setReadOnly(true);\r\n            query.setLockMode(&quot;a&quot;, LockMode.NONE);\r\n            ScrollableResults results = query.scroll(ScrollMode.FORWARD_ONLY);\r\n            while (results.next()) {\r\n                Address addr = (Address) results.get(0);\r\n                // Do stuff\r\n            }\r\n            results.close();\r\n            session.close();\r\n\r\n\r\nThe crucial lines are the query parameters between createQuery and scroll. Without them the &quot;scroll&quot; call tries to load everything into memory and either never finishes or runs to OutOfMemoryError.","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<p>I tried the answers presented here, but JBoss 5.1 + MySQL Connector/J 5.1.15 + Hibernate 3.3.2 didn't work with those. We've just migrated from JBoss 4.x to JBoss 5.1, so we've stuck with it for now, and thus the latest Hibernate we can use is 3.3.2.</p>\n\n<p>Adding couple of extra parameters did the job, and code like this runs without OOMEs:</p>\n\n<pre><code>        StatelessSession session = ((Session) entityManager.getDelegate()).getSessionFactory().openStatelessSession();\n\n        Query query = session\n                .createQuery(\"SELECT a FROM Address a WHERE .... ORDER BY a.id\");\n        query.setFetchSize(Integer.valueOf(1000));\n        query.setReadOnly(true);\n        query.setLockMode(\"a\", LockMode.NONE);\n        ScrollableResults results = query.scroll(ScrollMode.FORWARD_ONLY);\n        while (results.next()) {\n            Address addr = (Address) results.get(0);\n            // Do stuff\n        }\n        results.close();\n        session.close();\n</code></pre>\n\n<p>The crucial lines are the query parameters between createQuery and scroll. Without them the \"scroll\" call tries to load everything into memory and either never finishes or runs to OutOfMemoryError.</p>\n"},{"tags":[],"owner":{"account_id":1267027,"reputation":2073,"user_id":1224138,"accept_rate":27,"display_name":"Danger"},"down_vote_count":1,"up_vote_count":3,"is_accepted":false,"score":2,"last_activity_date":1360447683,"creation_date":1357068228,"answer_id":14113471,"question_id":5067619,"body_markdown":"I was surprised to see that the use of stored procedures was not more prominent in the answers here.  In the past when I&#39;ve had to do something like this, I create a stored procedure that processes data in small chunks, then sleeps for a bit, then continues.  The reason for the sleeping is to not overwhelm the database which is presumably also being used for more real time types of queries, such as being connected to a web site.  If there is no one else using the database, then you can leave out the sleep.  If you need to ensure that you process each record once and only once, then you will need to create an additional table (or field) to store which records you have processed in order to be resilient across restarts.\r\n\r\nThe performance savings here are significant, possibly orders of magnitude faster than anything you could do in JPA/Hibernate/AppServer land, and your database server will most likely have its own server side cursor type of mechanism for processing large result sets efficiently.  The performance savings come from not having to ship the data from the database server to the application server, where you process the data, and then ship it back.\r\n\r\nThere are some significant downsides to using stored procedures which may completely rule this out for you, but if you&#39;ve got that skill in your personal toolbox and can use it in this kind of situation, you can knock out these kinds of things fairly quickly.","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<p>I was surprised to see that the use of stored procedures was not more prominent in the answers here.  In the past when I've had to do something like this, I create a stored procedure that processes data in small chunks, then sleeps for a bit, then continues.  The reason for the sleeping is to not overwhelm the database which is presumably also being used for more real time types of queries, such as being connected to a web site.  If there is no one else using the database, then you can leave out the sleep.  If you need to ensure that you process each record once and only once, then you will need to create an additional table (or field) to store which records you have processed in order to be resilient across restarts.</p>\n\n<p>The performance savings here are significant, possibly orders of magnitude faster than anything you could do in JPA/Hibernate/AppServer land, and your database server will most likely have its own server side cursor type of mechanism for processing large result sets efficiently.  The performance savings come from not having to ship the data from the database server to the application server, where you process the data, and then ship it back.</p>\n\n<p>There are some significant downsides to using stored procedures which may completely rule this out for you, but if you've got that skill in your personal toolbox and can use it in this kind of situation, you can knock out these kinds of things fairly quickly.</p>\n"},{"tags":[],"owner":{"account_id":2284006,"reputation":81,"user_id":2008477,"display_name":"Filippo Rossoni"},"down_vote_count":0,"up_vote_count":7,"is_accepted":false,"score":7,"last_activity_date":1360680005,"creation_date":1360073615,"answer_id":14709533,"question_id":5067619,"body_markdown":"If you use EclipseLink I&#39; using this method to get result as Iterable\r\n\r\n\r\n    private static &lt;T&gt; Iterable&lt;T&gt; getResult(TypedQuery&lt;T&gt; query)\r\n    {\r\n      //eclipseLink\r\n      if(query instanceof JpaQuery) {\r\n        JpaQuery&lt;T&gt; jQuery = (JpaQuery&lt;T&gt;) query;\r\n        jQuery.setHint(QueryHints.RESULT_SET_TYPE, ResultSetType.ForwardOnly)\r\n           .setHint(QueryHints.SCROLLABLE_CURSOR, true);\r\n      \r\n        final Cursor cursor = jQuery.getResultCursor();\r\n        return new Iterable&lt;T&gt;()\r\n        {     \r\n          @SuppressWarnings(&quot;unchecked&quot;)\r\n          @Override\r\n          public Iterator&lt;T&gt; iterator()\r\n          {\r\n            return cursor;\r\n          }\r\n        }; \r\n       }\r\n      return query.getResultList();  \r\n    }  \r\n      \r\nclose Method\r\n\r\n    static void closeCursor(Iterable&lt;?&gt; list)\r\n    {\r\n      if (list.iterator() instanceof Cursor)\r\n        {\r\n          ((Cursor) list.iterator()).close();\r\n        }\r\n    }","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<p>If you use EclipseLink I' using this method to get result as Iterable</p>\n\n<pre><code>private static &lt;T&gt; Iterable&lt;T&gt; getResult(TypedQuery&lt;T&gt; query)\n{\n  //eclipseLink\n  if(query instanceof JpaQuery) {\n    JpaQuery&lt;T&gt; jQuery = (JpaQuery&lt;T&gt;) query;\n    jQuery.setHint(QueryHints.RESULT_SET_TYPE, ResultSetType.ForwardOnly)\n       .setHint(QueryHints.SCROLLABLE_CURSOR, true);\n\n    final Cursor cursor = jQuery.getResultCursor();\n    return new Iterable&lt;T&gt;()\n    {     \n      @SuppressWarnings(\"unchecked\")\n      @Override\n      public Iterator&lt;T&gt; iterator()\n      {\n        return cursor;\n      }\n    }; \n   }\n  return query.getResultList();  \n}  \n</code></pre>\n\n<p>close Method</p>\n\n<pre><code>static void closeCursor(Iterable&lt;?&gt; list)\n{\n  if (list.iterator() instanceof Cursor)\n    {\n      ((Cursor) list.iterator()).close();\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1158229,"reputation":105,"user_id":1138285,"display_name":"Marcin Cinik"},"down_vote_count":1,"up_vote_count":5,"is_accepted":false,"score":4,"last_activity_date":1381932325,"creation_date":1381932325,"answer_id":19405622,"question_id":5067619,"body_markdown":"You can use another &quot;trick&quot;. Load only collection of identifiers of the entities you&#39;re interested in. Say identifier is of type long=8bytes, then 10^6 a list of such identifiers makes around 8Mb. If it is a batch process (one instance at a time), then it&#39;s bearable. Then just iterate and do the job.\r\n\r\nOne another remark - you should anyway do this in chunks - especially if you modify records, otherwise **rollback segment** in database will grow.\r\n\r\nWhen it comes to set firstResult/maxRows strategy - it will be **VERY VERY** slow for results far from the top.\r\n\r\nAlso take into consideration that the database is probably operating in **read commited isolation**, so to avoid phantom reads load identifiers and then load entities one by one (or 10 by 10 or whatever).","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<p>You can use another \"trick\". Load only collection of identifiers of the entities you're interested in. Say identifier is of type long=8bytes, then 10^6 a list of such identifiers makes around 8Mb. If it is a batch process (one instance at a time), then it's bearable. Then just iterate and do the job.</p>\n\n<p>One another remark - you should anyway do this in chunks - especially if you modify records, otherwise <strong>rollback segment</strong> in database will grow.</p>\n\n<p>When it comes to set firstResult/maxRows strategy - it will be <strong>VERY VERY</strong> slow for results far from the top.</p>\n\n<p>Also take into consideration that the database is probably operating in <strong>read commited isolation</strong>, so to avoid phantom reads load identifiers and then load entities one by one (or 10 by 10 or whatever).</p>\n"},{"tags":[],"owner":{"account_id":254543,"reputation":106,"user_id":534022,"display_name":"Larry Chu"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1391055559,"creation_date":1391055559,"answer_id":21447735,"question_id":5067619,"body_markdown":"With hibernate there are 4 different ways to achieve what you want. Each has design tradeoffs, limitations, and consequences. I suggest exploring each and deciding which is right for your situation.\r\n\r\n1. Use stateless session with scroll()\r\n2. Use session.clear() after every iteration. When other entities need to be attached, then load them in a separate session. effectively the first session is emulating the stateless session, but retaining all the features of a stateful session, until the objects are detached.\r\n3. Use iterate() or list() but get only ids in the first query, then in a separate session in each iteration, do session.load and close the session at the end of the iteration.\r\n4. Use Query.iterate() with EntityManager.detach() aka Session.evict();\r\n","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<p>With hibernate there are 4 different ways to achieve what you want. Each has design tradeoffs, limitations, and consequences. I suggest exploring each and deciding which is right for your situation.</p>\n\n<ol>\n<li>Use stateless session with scroll()</li>\n<li>Use session.clear() after every iteration. When other entities need to be attached, then load them in a separate session. effectively the first session is emulating the stateless session, but retaining all the features of a stateful session, until the objects are detached.</li>\n<li>Use iterate() or list() but get only ids in the first query, then in a separate session in each iteration, do session.load and close the session at the end of the iteration.</li>\n<li>Use Query.iterate() with EntityManager.detach() aka Session.evict();</li>\n</ol>\n"},{"tags":[],"owner":{"account_id":87230,"reputation":36816,"user_id":242042,"accept_rate":57,"display_name":"Archimedes Trajano"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1443653003,"creation_date":1443653003,"answer_id":32876734,"question_id":5067619,"body_markdown":"To expand on @Tomasz Nurkiewicz&#39;s answer.  You have access to the `DataSource` which in turn can provide you with a connection\r\n\r\n    @Resource(name = &quot;myDataSource&quot;,\r\n        lookup = &quot;java:comp/DefaultDataSource&quot;)\r\n    private DataSource myDataSource;\r\n\r\nIn your code you have \r\n\r\n    try (Connection connection = myDataSource.getConnection()) {\r\n        // raw jdbc operations\r\n    }\r\n\r\nThis will allow you to bypass JPA for some specific large batch operations like import/export, however you still have access to the entity manager for other JPA operations if you need it.","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<p>To expand on @Tomasz Nurkiewicz's answer.  You have access to the <code>DataSource</code> which in turn can provide you with a connection</p>\n\n<pre><code>@Resource(name = \"myDataSource\",\n    lookup = \"java:comp/DefaultDataSource\")\nprivate DataSource myDataSource;\n</code></pre>\n\n<p>In your code you have </p>\n\n<pre><code>try (Connection connection = myDataSource.getConnection()) {\n    // raw jdbc operations\n}\n</code></pre>\n\n<p>This will allow you to bypass JPA for some specific large batch operations like import/export, however you still have access to the entity manager for other JPA operations if you need it.</p>\n"},{"tags":[],"owner":{"account_id":113601,"reputation":1330,"user_id":299109,"accept_rate":55,"display_name":"Elifarley"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1581091879,"creation_date":1581091879,"answer_id":60117181,"question_id":5067619,"body_markdown":"Here&#39;s a simple, straight JPA example (in Kotlin) that shows how you can paginate over an arbitrarily large result set, reading chunks of 100 items at a time, without using a cursor (each cursor consumes resources on the database). It uses keyset pagination.\r\n\r\nSee https://use-the-index-luke.com/no-offset for the concept of keyset pagination, and https://www.citusdata.com/blog/2016/03/30/five-ways-to-paginate/ for a comparison of different ways to paginate along with their drawbacks.\r\n\r\n    /*\r\n    create table my_table(\r\n      id int primary key, -- index will be created\r\n      my_column varchar\r\n    )\r\n    */\r\n    \r\n    fun keysetPaginationExample() {\r\n    \tvar lastId = Integer.MIN_VALUE\r\n    \tdo {\r\n    \r\n    \t    val someItems =\r\n    \t\tmyRepository.findTop100ByMyTableIdAfterOrderByMyTableId(lastId)\r\n    \r\n    \t    if (someItems.isEmpty()) break\r\n    \r\n    \t    lastId = someItems.last().myTableId\r\n    \r\n    \t    for (item in someItems) {\r\n    \t\t  process(item)\r\n    \t    }\r\n    \r\n    \t} while (true)\r\n    }\r\n\r\n","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<p>Here's a simple, straight JPA example (in Kotlin) that shows how you can paginate over an arbitrarily large result set, reading chunks of 100 items at a time, without using a cursor (each cursor consumes resources on the database). It uses keyset pagination.</p>\n\n<p>See <a href=\"https://use-the-index-luke.com/no-offset\" rel=\"nofollow noreferrer\">https://use-the-index-luke.com/no-offset</a> for the concept of keyset pagination, and <a href=\"https://www.citusdata.com/blog/2016/03/30/five-ways-to-paginate/\" rel=\"nofollow noreferrer\">https://www.citusdata.com/blog/2016/03/30/five-ways-to-paginate/</a> for a comparison of different ways to paginate along with their drawbacks.</p>\n\n<pre><code>/*\ncreate table my_table(\n  id int primary key, -- index will be created\n  my_column varchar\n)\n*/\n\nfun keysetPaginationExample() {\n    var lastId = Integer.MIN_VALUE\n    do {\n\n        val someItems =\n        myRepository.findTop100ByMyTableIdAfterOrderByMyTableId(lastId)\n\n        if (someItems.isEmpty()) break\n\n        lastId = someItems.last().myTableId\n\n        for (item in someItems) {\n          process(item)\n        }\n\n    } while (true)\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":6325493,"reputation":465,"user_id":4912093,"display_name":"harryssuperman"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1585851386,"creation_date":1585851386,"answer_id":60998338,"question_id":5067619,"body_markdown":"An Example with JPA and NativeQuery fetching everytime the size Elements using offsets\r\n\r\n    public List&lt;X&gt; getXByFetching(int fetchSize) {\r\n            int totalX = getTotalRows(Entity);\r\n            List&lt;X&gt; result = new ArrayList&lt;&gt;();\r\n            for (int offset = 0; offset &lt; totalX; offset = offset + fetchSize) {\r\n                EntityManager entityManager = getEntityManager();\r\n                String sql = getSqlSelect(Entity) + &quot; OFFSET &quot; + offset + &quot; ROWS&quot;;\r\n                Query query = entityManager.createNativeQuery(sql, X.class);\r\n                query.setMaxResults(fetchSize);\r\n                result.addAll(query.getResultList());\r\n                entityManager.flush();\r\n                entityManager.clear();\r\n            return result;\r\n        }","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<p>An Example with JPA and NativeQuery fetching everytime the size Elements using offsets</p>\n\n<pre><code>public List&lt;X&gt; getXByFetching(int fetchSize) {\n        int totalX = getTotalRows(Entity);\n        List&lt;X&gt; result = new ArrayList&lt;&gt;();\n        for (int offset = 0; offset &lt; totalX; offset = offset + fetchSize) {\n            EntityManager entityManager = getEntityManager();\n            String sql = getSqlSelect(Entity) + \" OFFSET \" + offset + \" ROWS\";\n            Query query = entityManager.createNativeQuery(sql, X.class);\n            query.setMaxResults(fetchSize);\n            result.addAll(query.getResultList());\n            entityManager.flush();\n            entityManager.clear();\n        return result;\n    }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":279220,"reputation":2393,"user_id":574263,"accept_rate":44,"display_name":"mjaggard"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1694797354,"creation_date":1633632284,"answer_id":69486331,"question_id":5067619,"body_markdown":"Finally the answer to what you want arrived in JPA 2.2 regardless of which JPA framework you use. For Hibernate (at least in v5.4.30) it uses the Scrollable implementation mentioned in a previous answer.\r\n\r\nYour code can now look like this:\r\n\r\n    entityManager().createQuery(&quot;from Model m&quot;, Model.class)\r\n                      .getResultStream();\r\n                      .forEach(model -&gt; System.out.println(model.getId());","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<p>Finally the answer to what you want arrived in JPA 2.2 regardless of which JPA framework you use. For Hibernate (at least in v5.4.30) it uses the Scrollable implementation mentioned in a previous answer.</p>\n<p>Your code can now look like this:</p>\n<pre><code>entityManager().createQuery(&quot;from Model m&quot;, Model.class)\n                  .getResultStream();\n                  .forEach(model -&gt; System.out.println(model.getId());\n</code></pre>\n"},{"tags":[],"owner":{"account_id":8681711,"reputation":81,"user_id":6497346,"display_name":"The Rocket"},"down_vote_count":2,"up_vote_count":0,"is_accepted":false,"score":-2,"last_activity_date":1681463966,"creation_date":1681457626,"answer_id":76012608,"question_id":5067619,"body_markdown":"&gt; All, Most of the blogs/solutions are dealing with MySQL or PostgreSQL instead of Oracle database when trying to read/retrieve\r\n&gt; from the large set of data and process by locking/update from\r\n&gt; multi-servers or multithreading using Spring JPA\r\n&gt;     \r\n&gt; My version is the latest : v2.7.8\r\n&gt;     \r\n&gt; As JPA Repository, doesn&#39;t support scrolling the data by default - I was using ROWNUM (i.e., Rownum &lt;=1000) in the Queries for\r\n&gt; processing.\r\n&gt;     \r\n&gt; Most of them know the consequences of using Rownum from Oracle standpoint.\r\n&gt;     \r\n&gt; However, I will explain in short:\r\n&gt;     \r\n&gt; Whenever a value is assigned to Rownum and fire the SQL Query, mostly the same set is being retrieved. In this case, when I lock the rows with Spring JPA Native Query - other servers/threads leads to pick 0 records.\r\n&gt;     \r\n&gt; Its a nightmare &amp; terrible sleepless nights in terms of performance &amp; resource utilisation.\r\n&gt;     \r\n&gt; I have overcome these with some implementations on top of JPA Repository which saved me in all aspects.\r\n&gt;     \r\n&gt; Here is the solution for all the Database users using Spring JPA with locking (For Update Skip Locked):\r\n\r\n    \r\n    \r\n    1. Amend the JPA Repository interface:\r\n    \r\n    @Repository\r\n    public interface SampleDataRepo extends JpaRepository&lt;SampleObj, Id&gt; , SampleDataRepository{\r\n    }\r\n    \r\n    2. Create a new Interface declared above which extended JPA Repository:\r\n    \r\n    public interface SampleDataRepository {\r\n    \r\n    // Your Method\r\n    List&lt;SampleObj&gt; retrieveDataFromSample(\r\n    \t\t\t@Param(&quot;someColumn&quot;) String someColumn);\r\n    \r\n    }\r\n    \r\n    3. Implement the above Interface:\r\n    \r\n    public class SampleDataRepositoryImpl implements SampleDataRepository {\r\n    \r\n    \t@PersistenceContext\r\n    \tprivate EntityManager entityManager;\r\n    \r\n    // Your Method\r\n    @Override\r\n    List&lt;SampleObj&gt; retrieveDataFromSample(\r\n    \t\t\t@Param(&quot;someColumn&quot;) String someColumn){\r\n    \r\n    final String findDataBySomeColumnQuery = &quot;SELECT r.ID FROM SAMPLE_OBJECT_TABLE WHERE r.SOME_COLUMN = :someColumn ORDER BY ID ASC FOR UPDATE SKIP LOCKED&quot;;\r\n    \r\n    List&lt;SampleObj&gt; dataList = new ArrayList&lt;&gt;();\r\n    \r\n    ScrollableResults result = entityManager.createNativeQuery(findDataBySomeColumnQuery, SampleObj.class)\r\n    \t\t.setParameter(&quot;someColumn&quot;, someColumn)\r\n    \t\t\t\t.setHint(QueryHints.HINT_FETCH_SIZE, 1000)\r\n    \t\t\t\t.unwrap(Query.class).scroll(ScrollMode.FORWARD_ONLY);\r\n    \r\n    \t\tint limit = 1000;\r\n    \t\ttry {\r\n    \t\t\twhile (result.next() &amp;&amp; limit &gt; 0) {\r\n    \t\t\t\tdataList.add((SampleObj) result.get(0));\r\n    \t\t\t\tlimit--;\r\n    \t\t\t}\r\n    \t\t\treturn dataList;\r\n    \t\t} finally {\r\n    \t\t\tif (result != null) {\r\n    \t\t\t\tresult.close();\r\n    \t\t\t}\r\n    \t\t}\r\n      }\r\n    }\r\n    \r\n    4. Make a call to the above method from service class as earlier\r\n    \r\n    @Service(&quot;SampleMonitor&quot;)\r\n    @Primary\r\n    public class SampleMonitorServiceImpl implements SampleMonitorService {\r\n    \r\n    \t@Autowired\r\n    \tprivate SampleDataRepo sampleDataRepo;\r\n    \r\n    \t@Override\r\n    \t@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED, rollbackFor = { Exception.class,\r\n    \t\t\tRuntimeException.class })\r\n    \tpublic void monitor(){\r\n    \r\n    .......\r\n    .......\r\n    \r\n    List&lt;SampleObj&gt; dataList = sampleDataRepo.retrieveDataFromSample(value);\r\n    .......\r\n    \r\n      }\r\n    }\r\n    \r\n    \r\n    Now, there are no Heap Size/outofmemory issue. Performance on topnotch with multiple threads/servers.\r\n    \r\n    \r\n    Happieee Coding.","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<blockquote>\n<p>All, Most of the blogs/solutions are dealing with MySQL or PostgreSQL instead of Oracle database when trying to read/retrieve\nfrom the large set of data and process by locking/update from\nmulti-servers or multithreading using Spring JPA</p>\n<p>My version is the latest : v2.7.8</p>\n<p>As JPA Repository, doesn't support scrolling the data by default - I was using ROWNUM (i.e., Rownum &lt;=1000) in the Queries for\nprocessing.</p>\n<p>Most of them know the consequences of using Rownum from Oracle standpoint.</p>\n<p>However, I will explain in short:</p>\n<p>Whenever a value is assigned to Rownum and fire the SQL Query, mostly the same set is being retrieved. In this case, when I lock the rows with Spring JPA Native Query - other servers/threads leads to pick 0 records.</p>\n<p>Its a nightmare &amp; terrible sleepless nights in terms of performance &amp; resource utilisation.</p>\n<p>I have overcome these with some implementations on top of JPA Repository which saved me in all aspects.</p>\n<p>Here is the solution for all the Database users using Spring JPA with locking (For Update Skip Locked):</p>\n</blockquote>\n<pre><code>1. Amend the JPA Repository interface:\n\n@Repository\npublic interface SampleDataRepo extends JpaRepository&lt;SampleObj, Id&gt; , SampleDataRepository{\n}\n\n2. Create a new Interface declared above which extended JPA Repository:\n\npublic interface SampleDataRepository {\n\n// Your Method\nList&lt;SampleObj&gt; retrieveDataFromSample(\n            @Param(&quot;someColumn&quot;) String someColumn);\n\n}\n\n3. Implement the above Interface:\n\npublic class SampleDataRepositoryImpl implements SampleDataRepository {\n\n    @PersistenceContext\n    private EntityManager entityManager;\n\n// Your Method\n@Override\nList&lt;SampleObj&gt; retrieveDataFromSample(\n            @Param(&quot;someColumn&quot;) String someColumn){\n\nfinal String findDataBySomeColumnQuery = &quot;SELECT r.ID FROM SAMPLE_OBJECT_TABLE WHERE r.SOME_COLUMN = :someColumn ORDER BY ID ASC FOR UPDATE SKIP LOCKED&quot;;\n\nList&lt;SampleObj&gt; dataList = new ArrayList&lt;&gt;();\n\nScrollableResults result = entityManager.createNativeQuery(findDataBySomeColumnQuery, SampleObj.class)\n        .setParameter(&quot;someColumn&quot;, someColumn)\n                .setHint(QueryHints.HINT_FETCH_SIZE, 1000)\n                .unwrap(Query.class).scroll(ScrollMode.FORWARD_ONLY);\n\n        int limit = 1000;\n        try {\n            while (result.next() &amp;&amp; limit &gt; 0) {\n                dataList.add((SampleObj) result.get(0));\n                limit--;\n            }\n            return dataList;\n        } finally {\n            if (result != null) {\n                result.close();\n            }\n        }\n  }\n}\n\n4. Make a call to the above method from service class as earlier\n\n@Service(&quot;SampleMonitor&quot;)\n@Primary\npublic class SampleMonitorServiceImpl implements SampleMonitorService {\n\n    @Autowired\n    private SampleDataRepo sampleDataRepo;\n\n    @Override\n    @Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED, rollbackFor = { Exception.class,\n            RuntimeException.class })\n    public void monitor(){\n\n.......\n.......\n\nList&lt;SampleObj&gt; dataList = sampleDataRepo.retrieveDataFromSample(value);\n.......\n\n  }\n}\n\n\nNow, there are no Heap Size/outofmemory issue. Performance on topnotch with multiple threads/servers.\n\n\nHappieee Coding.\n</code></pre>\n"},{"tags":[],"owner":{"account_id":6197039,"reputation":6332,"user_id":4828060,"accept_rate":21,"display_name":"Jo&#227;o Matos"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1683802140,"creation_date":1683802140,"answer_id":76226801,"question_id":5067619,"body_markdown":"My two cents in addition to the helpful accepted answer, we can use Spring Data JPA to handle pagination. Repository example:\r\n\r\n    public interface ModelRepository extends JpaRepository&lt;Model, Long&gt; {\r\n    \r\n        //feel free to change the order by criteria\r\n    \tList&lt;Model&gt; findAllByOrderByUpdatedDesc(Pageable pageable);\r\n    \r\n    }\r\n\r\nAnd your service just do as initially suggested:\r\n \r\n\r\n    private void iterateAll()\r\n    {\r\n        int offset = 0;\r\n    \r\n        List&lt;Model&gt; models;\r\n        while ((models = modelRepository.findAllByOrderByUpdatedAsc(PageRequest.of(offset, 100)) ).size() &gt; 0)\r\n        {\r\n    \r\n            for (Model model : models)\r\n            {\r\n                log.info(&quot;do something with model: &quot; + model.getId());\r\n            }\r\n    \r\n            offset ++;\r\n        }\r\n    }\r\n\r\nNote that `OrderByUpdatedAsc` is likely preferable to `OrderByUpdatedDesc` if your table is being updated in parallel, although not necessarily immune to those sort of issues.\r\n\r\nAdditionally,\r\n\r\n&gt; Page 537 of Java Persistence with Hibernate gives a solution using\r\n&gt; ScrollableResults, but alas it&#39;s only for Hibernate.\r\n\r\nBeware of potential memory leaks using scrollable results, I&#39;ve had problems like these -&gt; https://stackoverflow.com/q/76008518/4828060\r\n\r\n\r\n","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<p>My two cents in addition to the helpful accepted answer, we can use Spring Data JPA to handle pagination. Repository example:</p>\n<pre><code>public interface ModelRepository extends JpaRepository&lt;Model, Long&gt; {\n\n    //feel free to change the order by criteria\n    List&lt;Model&gt; findAllByOrderByUpdatedDesc(Pageable pageable);\n\n}\n</code></pre>\n<p>And your service just do as initially suggested:</p>\n<pre><code>private void iterateAll()\n{\n    int offset = 0;\n\n    List&lt;Model&gt; models;\n    while ((models = modelRepository.findAllByOrderByUpdatedAsc(PageRequest.of(offset, 100)) ).size() &gt; 0)\n    {\n\n        for (Model model : models)\n        {\n            log.info(&quot;do something with model: &quot; + model.getId());\n        }\n\n        offset ++;\n    }\n}\n</code></pre>\n<p>Note that <code>OrderByUpdatedAsc</code> is likely preferable to <code>OrderByUpdatedDesc</code> if your table is being updated in parallel, although not necessarily immune to those sort of issues.</p>\n<p>Additionally,</p>\n<blockquote>\n<p>Page 537 of Java Persistence with Hibernate gives a solution using\nScrollableResults, but alas it's only for Hibernate.</p>\n</blockquote>\n<p>Beware of potential memory leaks using scrollable results, I've had problems like these -&gt; <a href=\"https://stackoverflow.com/q/76008518/4828060\">Spring/Hibernate connection leak with ScrollableResults</a></p>\n"},{"tags":[],"owner":{"account_id":3130088,"reputation":43207,"user_id":2648077,"accept_rate":80,"display_name":"Alireza Fattahi"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1692443108,"creation_date":1692442686,"answer_id":76934744,"question_id":5067619,"body_markdown":"In JPA documnets (Version 3.3) there is a section about [Scrolling][1]:\r\n\r\n&gt; Scrolling is a more fine-grained approach to iterate through larger\r\n&gt; results set chunks. Scrolling consists of a stable sort, a scroll type\r\n&gt; (Offset- or Keyset-based scrolling) and result limiting. You can\r\n&gt; define simple sorting expressions by using property names and define\r\n&gt; static result limiting using the Top or First keyword through query\r\n&gt; derivation. You can concatenate expressions to collect multiple\r\n&gt; criteria into one expression.\r\n&gt; \r\n&gt; Scroll queries return a Window&lt;T&gt; that allows obtaining the scroll\r\n&gt; position to resume to obtain the next Window&lt;T&gt; until your application\r\n&gt; has consumed the entire query result. Similar to consuming a Java\r\n&gt; Iterator&lt;List&lt;…&gt;&gt; by obtaining the next batch of results, query result\r\n&gt; scrolling lets you access the a ScrollPosition through\r\n&gt; Window.positionAt(…​).\r\n\r\n\r\nAs sample:\r\n\r\n\r\n\r\n    interface UserRepository extends Repository&lt;User, Long&gt; {\r\n    \r\n      Window&lt;User&gt; findFirst10ByLastnameOrderByFirstname(String lastname, OffsetScrollPosition position);\r\n\r\n    }\r\n\r\n    //Somewhere in your service\r\n    WindowIterator&lt;User&gt; users = WindowIterator.of( position -&gt; repository.findFirst10ByLastnameOrderByFirstname(&quot;Doe&quot;, position))\r\n                                  .startingAt(OffsetScrollPosition.initial());\r\n    \r\n    while (users.hasNext()) {\r\n      User u = users.next();\r\n      // consume the user\r\n    }\r\n\r\n  [1]: https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.scrolling\r\n","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<p>In JPA documnets (Version 3.3) there is a section about <a href=\"https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.scrolling\" rel=\"nofollow noreferrer\">Scrolling</a>:</p>\n<blockquote>\n<p>Scrolling is a more fine-grained approach to iterate through larger\nresults set chunks. Scrolling consists of a stable sort, a scroll type\n(Offset- or Keyset-based scrolling) and result limiting. You can\ndefine simple sorting expressions by using property names and define\nstatic result limiting using the Top or First keyword through query\nderivation. You can concatenate expressions to collect multiple\ncriteria into one expression.</p>\n<p>Scroll queries return a Window that allows obtaining the scroll\nposition to resume to obtain the next Window until your application\nhas consumed the entire query result. Similar to consuming a Java\nIterator&lt;List&lt;…&gt;&gt; by obtaining the next batch of results, query result\nscrolling lets you access the a ScrollPosition through\nWindow.positionAt(…​).</p>\n</blockquote>\n<p>As sample:</p>\n<pre><code>interface UserRepository extends Repository&lt;User, Long&gt; {\n\n  Window&lt;User&gt; findFirst10ByLastnameOrderByFirstname(String lastname, OffsetScrollPosition position);\n\n}\n\n//Somewhere in your service\nWindowIterator&lt;User&gt; users = WindowIterator.of( position -&gt; repository.findFirst10ByLastnameOrderByFirstname(&quot;Doe&quot;, position))\n                              .startingAt(OffsetScrollPosition.initial());\n\nwhile (users.hasNext()) {\n  User u = users.next();\n  // consume the user\n}\n</code></pre>\n"}],"owner":{"account_id":33553,"reputation":30834,"user_id":93995,"accept_rate":81,"display_name":"George Armhold"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":115148,"favorite_count":0,"down_vote_count":1,"up_vote_count":129,"accepted_answer_id":5071436,"answer_count":19,"score":128,"last_activity_date":1694797354,"creation_date":1298301210,"question_id":5067619,"body_markdown":"Let&#39;s say I have a table with millions of rows. Using JPA, what&#39;s the proper way to iterate over a query against that table, such that **I don&#39;t have all an in-memory List** with millions of objects?\r\n\r\nFor example, I suspect that the following will blow up if the table is large:\r\n\r\n    List&lt;Model&gt; models = entityManager().createQuery(&quot;from Model m&quot;, Model.class).getResultList();\r\n\r\n    for (Model model : models)\r\n    {\r\n         System.out.println(model.getId());\r\n    }\r\n\r\nIs pagination (looping and manually updating `setFirstResult()`/`setMaxResult()`) really the best solution?\r\n\r\n**Edit**: the primary use-case I&#39;m targeting is a kind of batch job. It&#39;s fine if it takes a long time to run. There is no web client involved; I just need to &quot;do something&quot; for each row, one (or some small N) at a time. I&#39;m just trying to avoid having them all in memory at the same time.\r\n\r\n\r\n\r\n","title":"JPA: what is the proper pattern for iterating over large result sets?","body":"<p>Let's say I have a table with millions of rows. Using JPA, what's the proper way to iterate over a query against that table, such that <strong>I don't have all an in-memory List</strong> with millions of objects?</p>\n\n<p>For example, I suspect that the following will blow up if the table is large:</p>\n\n<pre><code>List&lt;Model&gt; models = entityManager().createQuery(\"from Model m\", Model.class).getResultList();\n\nfor (Model model : models)\n{\n     System.out.println(model.getId());\n}\n</code></pre>\n\n<p>Is pagination (looping and manually updating <code>setFirstResult()</code>/<code>setMaxResult()</code>) really the best solution?</p>\n\n<p><strong>Edit</strong>: the primary use-case I'm targeting is a kind of batch job. It's fine if it takes a long time to run. There is no web client involved; I just need to \"do something\" for each row, one (or some small N) at a time. I'm just trying to avoid having them all in memory at the same time.</p>\n"},{"tags":["java","mysql","excel","jsp"],"answers":[{"tags":[],"owner":{"account_id":2075927,"reputation":2068,"user_id":1849276,"accept_rate":100,"display_name":"Afsun Khammadli"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1431355619,"creation_date":1431327055,"answer_id":30161224,"question_id":30160916,"body_markdown":"You must add following lines to your jsp page which you want to export to excel:&lt;br&gt;\r\n\r\n    response.setContentType(&quot;application/xls&quot;);\r\n    response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment;filename=File.xls&quot;);\r\n            \r\nOr you must learn about [`POI`][1]\r\n\r\n\r\n  [1]: http://www.tutorialspoint.com/apache_poi/\r\n\r\nAnd you must change `if(res.next())` with `while(res.next())`","title":"JSP code to generate excel sheet of data retrieved in jsp page","body":"<p>You must add following lines to your jsp page which you want to export to excel:<br></p>\n\n<pre><code>response.setContentType(\"application/xls\");\nresponse.setHeader(\"Content-Disposition\", \"attachment;filename=File.xls\");\n</code></pre>\n\n<p>Or you must learn about <a href=\"http://www.tutorialspoint.com/apache_poi/\" rel=\"nofollow\"><code>POI</code></a></p>\n\n<p>And you must change <code>if(res.next())</code> with <code>while(res.next())</code></p>\n"},{"tags":[],"owner":{"account_id":6084077,"reputation":199,"user_id":4748798,"display_name":"vishal rana"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1431327457,"creation_date":1431327457,"answer_id":30161331,"question_id":30160916,"body_markdown":"*Try using a servlet to do the Excel writing.*\r\n\r\n&gt; You could use it as a JSP:Include in your existing page if you wanted\r\n&gt; to.\r\n\r\nFrom the servlet you&#39;ll have to do something like this:\r\n\r\n    ServletOutputStream out = resp.getOutputStream();\r\n    resp.setContentType(&quot;application/vnd.ms-excel&quot;)\r\n    /*\r\n    * get data \r\n    */\r\n    \r\n    if (data != null) {\r\n    for (int i=0; i data.length; i++) {\r\n       String dataRow = &quot;&quot;;\r\n       for (int j = 0; j data[0].length; j++) {\r\n           dataRow += data[i][j] + &quot;\\t&quot;;// add tab delimiter\r\n       }\r\n       out.println(dataRow);// print data\r\n    }\r\n    } else {//Bad data...\r\n       out.println(&quot;No data to report.&quot;);\r\n    }\r\n    \r\n    out.flush();\r\n\r\nHope it helps you. :)","title":"JSP code to generate excel sheet of data retrieved in jsp page","body":"<p><em>Try using a servlet to do the Excel writing.</em></p>\n\n<blockquote>\n  <p>You could use it as a JSP:Include in your existing page if you wanted\n  to.</p>\n</blockquote>\n\n<p>From the servlet you'll have to do something like this:</p>\n\n<pre><code>ServletOutputStream out = resp.getOutputStream();\nresp.setContentType(\"application/vnd.ms-excel\")\n/*\n* get data \n*/\n\nif (data != null) {\nfor (int i=0; i data.length; i++) {\n   String dataRow = \"\";\n   for (int j = 0; j data[0].length; j++) {\n       dataRow += data[i][j] + \"\\t\";// add tab delimiter\n   }\n   out.println(dataRow);// print data\n}\n} else {//Bad data...\n   out.println(\"No data to report.\");\n}\n\nout.flush();\n</code></pre>\n\n<p>Hope it helps you. :)</p>\n"}],"owner":{"account_id":3952763,"reputation":109,"user_id":3262425,"accept_rate":40,"display_name":"Kasani Prabhakar"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":9909,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1694797270,"creation_date":1431325812,"question_id":30160916,"body_markdown":"I want to export data to Excel sheet  \r\n\r\n  \r\n\r\n    &lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=ISO-8859-1&quot;\r\n            pageEncoding=&quot;ISO-8859-1&quot;%&gt;\r\n            &lt;%@include file=&quot;connection.jsp&quot; %&gt;\r\n        &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;\r\n        &lt;html&gt;\r\n        &lt;head&gt;\r\n        &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;\r\n        &lt;title&gt;Insert title here&lt;/title&gt;\r\n        &lt;/head&gt;\r\n        &lt;body&gt;\r\n        \r\n        &lt;%\r\n        String ht = (String)session.getAttribute(&quot;ht&quot;);\r\n        %&gt;\r\n        &lt;table border=&quot;1&quot;&gt;\r\n        &lt;%\r\n        pst = con.prepareStatement(&quot;select * from attendance where ht=&#39;&quot;+ht+&quot;&#39;&quot;);\r\n        res = pst.executeQuery();\r\n        if(res.next())\r\n        {\r\n        \tString uname = res.getString(2);\r\n        \t%&gt;\r\n        \t&lt;b&gt;Student Name:&lt;%=uname%&gt;&lt;/b&gt;\r\n        \t\r\n        \t&lt;%\r\n        \tString hlt = res.getString(1);\r\n        \t%&gt;\r\n        \t&lt;b&gt;Hallticket:&lt;%=hlt%&gt;&lt;/b&gt;\r\n        \t&lt;tr&gt;&lt;th&gt;CG&lt;/th&gt;&lt;th&gt;CD&lt;/th&gt;&lt;th&gt;MPI&lt;/th&gt;&lt;th&gt;HCI&lt;/th&gt;&lt;th&gt;WT&lt;/th&gt;&lt;th&gt;MPI-Lab&lt;/th&gt;&lt;th&gt;CT=Lab&lt;/th&gt;&lt;th&gt;WT-Lab&lt;/th&gt;&lt;/tr&gt;\r\n        \t&lt;%\r\n        \tString cg = res.getString(3);\r\n        \tString cd = res.getString(4);\r\n        \tString mpi = res.getString(5);\r\n        \tString hci = res.getString(6);\r\n        \tString wt = res.getString(7);\r\n        \tString mpi_lab = res.getString(8);\r\n        \tString ct_lab = res.getString(9);\r\n        \tString wt_lab = res.getString(10);\r\n        \t%&gt;\r\n        \t&lt;tr&gt;\r\n        \t&lt;td align=&quot;center&quot;&gt;&lt;%=cg%&gt;&lt;/td&gt;\r\n        \t&lt;td align=&quot;center&quot;&gt;&lt;%=cd%&gt;&lt;/td&gt;\r\n        \t&lt;td align=&quot;center&quot;&gt;&lt;%=mpi%&gt;&lt;/td&gt;\r\n        \t&lt;td align=&quot;center&quot;&gt;&lt;%=hci%&gt;&lt;/td&gt;\r\n        \t&lt;td align=&quot;center&quot;&gt;&lt;%=wt%&gt;&lt;/td&gt;\r\n        \t&lt;td align=&quot;center&quot;&gt;&lt;%=mpi_lab%&gt;&lt;/td&gt;\r\n        \t&lt;td align=&quot;center&quot;&gt;&lt;%=ct_lab%&gt;&lt;/td&gt;\r\n        \t&lt;td align=&quot;center&quot;&gt;&lt;%=wt_lab%&gt;&lt;/td&gt;\r\n        \t&lt;/tr&gt;\r\n        \t&lt;br/&gt;&lt;br/&gt;\r\n        \t\r\n        \t&lt;%\r\n        }\r\n        %&gt;\r\n        &lt;/table&gt;\r\n        &lt;/body&gt;\r\n        &lt;/html&gt;\r\n\r\nI want the data that is retrieved from database and displayed in table should be printed on excel sheet\r\nPlease can any one tell me how to do it ... :(\r\nI used mysql databse.\r\n","title":"JSP code to generate excel sheet of data retrieved in jsp page","body":"<p>I want to export data to Excel sheet  </p>\n\n<pre><code>&lt;%@ page language=\"java\" contentType=\"text/html; charset=ISO-8859-1\"\n        pageEncoding=\"ISO-8859-1\"%&gt;\n        &lt;%@include file=\"connection.jsp\" %&gt;\n    &lt;!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\"&gt;\n    &lt;html&gt;\n    &lt;head&gt;\n    &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\"&gt;\n    &lt;title&gt;Insert title here&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n\n    &lt;%\n    String ht = (String)session.getAttribute(\"ht\");\n    %&gt;\n    &lt;table border=\"1\"&gt;\n    &lt;%\n    pst = con.prepareStatement(\"select * from attendance where ht='\"+ht+\"'\");\n    res = pst.executeQuery();\n    if(res.next())\n    {\n        String uname = res.getString(2);\n        %&gt;\n        &lt;b&gt;Student Name:&lt;%=uname%&gt;&lt;/b&gt;\n\n        &lt;%\n        String hlt = res.getString(1);\n        %&gt;\n        &lt;b&gt;Hallticket:&lt;%=hlt%&gt;&lt;/b&gt;\n        &lt;tr&gt;&lt;th&gt;CG&lt;/th&gt;&lt;th&gt;CD&lt;/th&gt;&lt;th&gt;MPI&lt;/th&gt;&lt;th&gt;HCI&lt;/th&gt;&lt;th&gt;WT&lt;/th&gt;&lt;th&gt;MPI-Lab&lt;/th&gt;&lt;th&gt;CT=Lab&lt;/th&gt;&lt;th&gt;WT-Lab&lt;/th&gt;&lt;/tr&gt;\n        &lt;%\n        String cg = res.getString(3);\n        String cd = res.getString(4);\n        String mpi = res.getString(5);\n        String hci = res.getString(6);\n        String wt = res.getString(7);\n        String mpi_lab = res.getString(8);\n        String ct_lab = res.getString(9);\n        String wt_lab = res.getString(10);\n        %&gt;\n        &lt;tr&gt;\n        &lt;td align=\"center\"&gt;&lt;%=cg%&gt;&lt;/td&gt;\n        &lt;td align=\"center\"&gt;&lt;%=cd%&gt;&lt;/td&gt;\n        &lt;td align=\"center\"&gt;&lt;%=mpi%&gt;&lt;/td&gt;\n        &lt;td align=\"center\"&gt;&lt;%=hci%&gt;&lt;/td&gt;\n        &lt;td align=\"center\"&gt;&lt;%=wt%&gt;&lt;/td&gt;\n        &lt;td align=\"center\"&gt;&lt;%=mpi_lab%&gt;&lt;/td&gt;\n        &lt;td align=\"center\"&gt;&lt;%=ct_lab%&gt;&lt;/td&gt;\n        &lt;td align=\"center\"&gt;&lt;%=wt_lab%&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;br/&gt;&lt;br/&gt;\n\n        &lt;%\n    }\n    %&gt;\n    &lt;/table&gt;\n    &lt;/body&gt;\n    &lt;/html&gt;\n</code></pre>\n\n<p>I want the data that is retrieved from database and displayed in table should be printed on excel sheet\nPlease can any one tell me how to do it ... :(\nI used mysql databse.</p>\n"},{"tags":["java","android-studio","android-manifest","execution-time"],"comments":[{"owner":{"account_id":2073393,"reputation":2457,"user_id":1847378,"display_name":"AndrewL"},"score":0,"creation_date":1695159628,"post_id":77108714,"comment_id":135986128,"body_markdown":"Avoid down votes, by not posting images, here is why: https://meta.stackoverflow.com/a/285557/1847378","body":"Avoid down votes, by not posting images, here is why: <a href=\"https://meta.stackoverflow.com/a/285557/1847378\">meta.stackoverflow.com/a/285557/1847378</a>"}],"answers":[{"tags":[],"owner":{"account_id":25285238,"reputation":405,"user_id":19112370,"display_name":"Harshali"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694797134,"creation_date":1694797134,"answer_id":77114166,"question_id":77108714,"body_markdown":"I&#39;m also getting this issue and solved by appending \r\n   \r\n\r\n     --add-opens java.base/java.io=ALL-UNNAMED\r\n\r\nin `org.gradle.jvmargs= ...`  property \r\n\r\nto the file  `./android/gradle.properties` \r\n\r\n\r\nhope it will help you","title":"An error when I try to run my android studio program","body":"<p>I'm also getting this issue and solved by appending</p>\n<pre><code> --add-opens java.base/java.io=ALL-UNNAMED\n</code></pre>\n<p>in <code>org.gradle.jvmargs= ...</code>  property</p>\n<p>to the file  <code>./android/gradle.properties</code></p>\n<p>hope it will help you</p>\n"}],"owner":{"account_id":29285180,"reputation":1,"user_id":22436946,"display_name":"Diego Alba"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":58,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"answer_count":1,"score":-1,"last_activity_date":1694797134,"creation_date":1694730755,"question_id":77108714,"body_markdown":"When I try to run the program it appears:\r\n&quot;Unable to make field private final java.lang.String java.io.File.path accessible: module java.base does not &quot;opens java.io&quot; to unnamed module @7c389728&quot;\r\n[It also appears:Main](https://i.stack.imgur.com/5JrRv.png)\r\n\r\n\r\nI want to try to solve this and see how my program is going","title":"An error when I try to run my android studio program","body":"<p>When I try to run the program it appears:\n&quot;Unable to make field private final java.lang.String java.io.File.path accessible: module java.base does not &quot;opens java.io&quot; to unnamed module @7c389728&quot;\n<a href=\"https://i.stack.imgur.com/5JrRv.png\" rel=\"nofollow noreferrer\">It also appears:Main</a></p>\n<p>I want to try to solve this and see how my program is going</p>\n"},{"tags":["java","spring","hibernate"],"comments":[{"owner":{"account_id":477214,"reputation":5260,"user_id":888580,"display_name":"lane.maxwell"},"score":0,"creation_date":1694830249,"post_id":77114136,"comment_id":135946794,"body_markdown":"The fact that it&#39;s taking forty minutes to run out of heap indicates that you have enough memory; the fact that you&#39;re running out of heap suggests some circular reference.  I recommend attaching VisualVM to the process when you start it up; it will give you an indication of what is filling up the heap to help you hone in on the problem.","body":"The fact that it&#39;s taking forty minutes to run out of heap indicates that you have enough memory; the fact that you&#39;re running out of heap suggests some circular reference.  I recommend attaching VisualVM to the process when you start it up; it will give you an indication of what is filling up the heap to help you hone in on the problem."}],"owner":{"account_id":27490497,"reputation":93,"user_id":20975951,"display_name":"Jaiylon"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":75,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694796705,"creation_date":1694796705,"question_id":77114136,"body_markdown":"I have an application that uses spring-boot version 2.6.4 and the entities uses `javax.persistence` API, but I need to add this DataTables dependency\r\n```\r\n&lt;dependency&gt;\r\n\t&lt;groupId&gt;com.github.darrachequesne&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;spring-data-jpa-datatables&lt;/artifactId&gt;\r\n\t&lt;version&gt;6.0.1&lt;/version&gt;\r\n&lt;/dependency&gt;\r\n```\r\nBut this cannot work with that version of Spring, so I upgraded to 3.1.2 and used the `jakarta.persistence` API instead of the of the `javax.persistence` API and now the application won&#39;t start and it takes about 40 minutes to throw the following exception&quot;\r\n\r\n```\r\nError starting ApplicationContext. To display the condition evaluation report re-run your application with &#39;debug&#39; enabled.\r\n2023-09-15T11:56:25.431-04:00 ERROR 6052 --- [  restartedMain] o.s.boot.SpringApplication               : Application run failed\r\n\r\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;entityManagerFactory&#39; defined in class path resource [org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]: Java heap space\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1751) ~[spring-beans-6.0.4.jar:6.0.4]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599) ~[spring-beans-6.0.4.jar:6.0.4]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:521) ~[spring-beans-6.0.4.jar:6.0.4]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.0.4.jar:6.0.4]\r\n\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.0.4.jar:6.0.4]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.0.4.jar:6.0.4]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.0.4.jar:6.0.4]\r\n\tat org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1130) ~[spring-context-6.0.4.jar:6.0.4]\r\n\tat org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:905) ~[spring-context-6.0.4.jar:6.0.4]\r\n\tat org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:584) ~[spring-context-6.0.4.jar:6.0.4]\r\n\tat org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[spring-boot-3.0.2.jar:3.0.2]\r\n\tat org.springframework.boot.SpringApplication.refresh(SpringApplication.java:730) ~[spring-boot-3.0.2.jar:3.0.2]\r\n\tat org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:432) ~[spring-boot-3.0.2.jar:3.0.2]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:308) ~[spring-boot-3.0.2.jar:3.0.2]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1302) ~[spring-boot-3.0.2.jar:3.0.2]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1291) ~[spring-boot-3.0.2.jar:3.0.2]\r\n\tat com.aegis.kyc.KycApplication.main(KycApplication.java:29) ~[classes/:na]\r\n\tat java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]\r\n\tat org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49) ~[spring-boot-devtools-3.0.2.jar:3.0.2]\r\nCaused by: java.lang.OutOfMemoryError: Java heap space\r\n\tat java.base/java.util.AbstractList.listIterator(AbstractList.java:342) ~[na:na]\r\n\tat java.base/java.util.AbstractList.listIterator(AbstractList.java:313) ~[na:na]\r\n\tat java.base/java.util.AbstractList.equals(AbstractList.java:545) ~[na:na]\r\n\tat org.hibernate.metamodel.mapping.AssociationKey.equals(AssociationKey.java:44) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat java.base/java.util.HashMap.removeNode(HashMap.java:826) ~[na:na]\r\n\tat java.base/java.util.HashMap.remove(HashMap.java:805) ~[na:na]\r\n\tat java.base/java.util.HashSet.remove(HashSet.java:245) ~[na:na]\r\n\tat org.hibernate.loader.ast.internal.LoaderSqlAstCreationState.removeVisitedAssociationKey(LoaderSqlAstCreationState.java:158) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat org.hibernate.metamodel.mapping.internal.ToOneAttributeMapping.withRegisteredAssociationKeys(ToOneAttributeMapping.java:1507) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat org.hibernate.metamodel.mapping.internal.ToOneAttributeMapping.generateFetch(ToOneAttributeMapping.java:1233) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat org.hibernate.metamodel.mapping.internal.ToOneAttributeMapping.generateFetch(ToOneAttributeMapping.java:107) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat org.hibernate.sql.results.graph.FetchParent.generateFetchableFetch(FetchParent.java:105) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat org.hibernate.loader.ast.internal.LoaderSelectBuilder.lambda$createFetchableBiConsumer$7(LoaderSelectBuilder.java:846) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat org.hibernate.loader.ast.internal.LoaderSelectBuilder$$Lambda$986/0x000001d09f7b5d10.accept(Unknown Source) ~[na:na]\r\n\tat org.hibernate.loader.ast.internal.LoaderSelectBuilder.visitFetches(LoaderSelectBuilder.java:684) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat org.hibernate.loader.ast.internal.LoaderSelectBuilder$$Lambda$979/0x000001d09f7afd68.visitFetches(Unknown Source) ~[na:na]\r\n\tat org.hibernate.loader.ast.internal.LoaderSqlAstCreationState.visitFetches(LoaderSqlAstCreationState.java:118) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat org.hibernate.sql.results.graph.AbstractFetchParent.afterInitialize(AbstractFetchParent.java:32) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat org.hibernate.sql.results.graph.entity.AbstractEntityResultGraphNode.afterInitialize(AbstractEntityResultGraphNode.java:100) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat org.hibernate.sql.results.graph.entity.internal.EntityFetchJoinedImpl.&lt;init&gt;(EntityFetchJoinedImpl.java:54) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat org.hibernate.metamodel.mapping.internal.ToOneAttributeMapping.lambda$generateFetch$0(ToOneAttributeMapping.java:1258) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat org.hibernate.metamodel.mapping.internal.ToOneAttributeMapping$$Lambda$991/0x000001d09f7bc228.get(Unknown Source) ~[na:na]\r\n\tat org.hibernate.metamodel.mapping.internal.ToOneAttributeMapping.withRegisteredAssociationKeys(ToOneAttributeMapping.java:1503) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat org.hibernate.metamodel.mapping.internal.ToOneAttributeMapping.generateFetch(ToOneAttributeMapping.java:1233) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat org.hibernate.metamodel.mapping.internal.ToOneAttributeMapping.generateFetch(ToOneAttributeMapping.java:107) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat org.hibernate.sql.results.graph.FetchParent.generateFetchableFetch(FetchParent.java:105) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat org.hibernate.loader.ast.internal.LoaderSelectBuilder.lambda$createFetchableBiConsumer$7(LoaderSelectBuilder.java:846) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat org.hibernate.loader.ast.internal.LoaderSelectBuilder$$Lambda$986/0x000001d09f7b5d10.accept(Unknown Source) ~[na:na]\r\n\tat org.hibernate.loader.ast.internal.LoaderSelectBuilder.visitFetches(LoaderSelectBuilder.java:684) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat org.hibernate.loader.ast.internal.LoaderSelectBuilder$$Lambda$979/0x000001d09f7afd68.visitFetches(Unknown Source) ~[na:na]\r\n\tat org.hibernate.loader.ast.internal.LoaderSqlAstCreationState.visitFetches(LoaderSqlAstCreationState.java:118) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\tat org.hibernate.sql.results.graph.AbstractFetchParent.afterInitialize(AbstractFetchParent.java:32) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\r\n\r\n\r\nProcess finished with exit code 0\r\n```\r\n\r\nNote that my entities were annotated with `@Audited` and that threw another XML type exception so I commented it out and now I get the error above.","title":"Error creating bean with name &#39;entityManagerFactory&#39; defined in class path resource []: Java heap space","body":"<p>I have an application that uses spring-boot version 2.6.4 and the entities uses <code>javax.persistence</code> API, but I need to add this DataTables dependency</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.github.darrachequesne&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-data-jpa-datatables&lt;/artifactId&gt;\n    &lt;version&gt;6.0.1&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>But this cannot work with that version of Spring, so I upgraded to 3.1.2 and used the <code>jakarta.persistence</code> API instead of the of the <code>javax.persistence</code> API and now the application won't start and it takes about 40 minutes to throw the following exception&quot;</p>\n<pre><code>Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.\n2023-09-15T11:56:25.431-04:00 ERROR 6052 --- [  restartedMain] o.s.boot.SpringApplication               : Application run failed\n\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in class path resource [org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]: Java heap space\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1751) ~[spring-beans-6.0.4.jar:6.0.4]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599) ~[spring-beans-6.0.4.jar:6.0.4]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:521) ~[spring-beans-6.0.4.jar:6.0.4]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.0.4.jar:6.0.4]\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.0.4.jar:6.0.4]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.0.4.jar:6.0.4]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.0.4.jar:6.0.4]\n    at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1130) ~[spring-context-6.0.4.jar:6.0.4]\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:905) ~[spring-context-6.0.4.jar:6.0.4]\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:584) ~[spring-context-6.0.4.jar:6.0.4]\n    at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[spring-boot-3.0.2.jar:3.0.2]\n    at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:730) ~[spring-boot-3.0.2.jar:3.0.2]\n    at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:432) ~[spring-boot-3.0.2.jar:3.0.2]\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:308) ~[spring-boot-3.0.2.jar:3.0.2]\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:1302) ~[spring-boot-3.0.2.jar:3.0.2]\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:1291) ~[spring-boot-3.0.2.jar:3.0.2]\n    at com.aegis.kyc.KycApplication.main(KycApplication.java:29) ~[classes/:na]\n    at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]\n    at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]\n    at org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49) ~[spring-boot-devtools-3.0.2.jar:3.0.2]\nCaused by: java.lang.OutOfMemoryError: Java heap space\n    at java.base/java.util.AbstractList.listIterator(AbstractList.java:342) ~[na:na]\n    at java.base/java.util.AbstractList.listIterator(AbstractList.java:313) ~[na:na]\n    at java.base/java.util.AbstractList.equals(AbstractList.java:545) ~[na:na]\n    at org.hibernate.metamodel.mapping.AssociationKey.equals(AssociationKey.java:44) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at java.base/java.util.HashMap.removeNode(HashMap.java:826) ~[na:na]\n    at java.base/java.util.HashMap.remove(HashMap.java:805) ~[na:na]\n    at java.base/java.util.HashSet.remove(HashSet.java:245) ~[na:na]\n    at org.hibernate.loader.ast.internal.LoaderSqlAstCreationState.removeVisitedAssociationKey(LoaderSqlAstCreationState.java:158) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at org.hibernate.metamodel.mapping.internal.ToOneAttributeMapping.withRegisteredAssociationKeys(ToOneAttributeMapping.java:1507) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at org.hibernate.metamodel.mapping.internal.ToOneAttributeMapping.generateFetch(ToOneAttributeMapping.java:1233) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at org.hibernate.metamodel.mapping.internal.ToOneAttributeMapping.generateFetch(ToOneAttributeMapping.java:107) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at org.hibernate.sql.results.graph.FetchParent.generateFetchableFetch(FetchParent.java:105) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at org.hibernate.loader.ast.internal.LoaderSelectBuilder.lambda$createFetchableBiConsumer$7(LoaderSelectBuilder.java:846) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at org.hibernate.loader.ast.internal.LoaderSelectBuilder$$Lambda$986/0x000001d09f7b5d10.accept(Unknown Source) ~[na:na]\n    at org.hibernate.loader.ast.internal.LoaderSelectBuilder.visitFetches(LoaderSelectBuilder.java:684) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at org.hibernate.loader.ast.internal.LoaderSelectBuilder$$Lambda$979/0x000001d09f7afd68.visitFetches(Unknown Source) ~[na:na]\n    at org.hibernate.loader.ast.internal.LoaderSqlAstCreationState.visitFetches(LoaderSqlAstCreationState.java:118) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at org.hibernate.sql.results.graph.AbstractFetchParent.afterInitialize(AbstractFetchParent.java:32) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at org.hibernate.sql.results.graph.entity.AbstractEntityResultGraphNode.afterInitialize(AbstractEntityResultGraphNode.java:100) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at org.hibernate.sql.results.graph.entity.internal.EntityFetchJoinedImpl.&lt;init&gt;(EntityFetchJoinedImpl.java:54) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at org.hibernate.metamodel.mapping.internal.ToOneAttributeMapping.lambda$generateFetch$0(ToOneAttributeMapping.java:1258) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at org.hibernate.metamodel.mapping.internal.ToOneAttributeMapping$$Lambda$991/0x000001d09f7bc228.get(Unknown Source) ~[na:na]\n    at org.hibernate.metamodel.mapping.internal.ToOneAttributeMapping.withRegisteredAssociationKeys(ToOneAttributeMapping.java:1503) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at org.hibernate.metamodel.mapping.internal.ToOneAttributeMapping.generateFetch(ToOneAttributeMapping.java:1233) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at org.hibernate.metamodel.mapping.internal.ToOneAttributeMapping.generateFetch(ToOneAttributeMapping.java:107) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at org.hibernate.sql.results.graph.FetchParent.generateFetchableFetch(FetchParent.java:105) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at org.hibernate.loader.ast.internal.LoaderSelectBuilder.lambda$createFetchableBiConsumer$7(LoaderSelectBuilder.java:846) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at org.hibernate.loader.ast.internal.LoaderSelectBuilder$$Lambda$986/0x000001d09f7b5d10.accept(Unknown Source) ~[na:na]\n    at org.hibernate.loader.ast.internal.LoaderSelectBuilder.visitFetches(LoaderSelectBuilder.java:684) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at org.hibernate.loader.ast.internal.LoaderSelectBuilder$$Lambda$979/0x000001d09f7afd68.visitFetches(Unknown Source) ~[na:na]\n    at org.hibernate.loader.ast.internal.LoaderSqlAstCreationState.visitFetches(LoaderSqlAstCreationState.java:118) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n    at org.hibernate.sql.results.graph.AbstractFetchParent.afterInitialize(AbstractFetchParent.java:32) ~[hibernate-core-6.1.6.Final.jar:6.1.6.Final]\n\n\nProcess finished with exit code 0\n</code></pre>\n<p>Note that my entities were annotated with <code>@Audited</code> and that threw another XML type exception so I commented it out and now I get the error above.</p>\n"},{"tags":["java","eclipse","game-development","frame-rate"],"comments":[{"owner":{"account_id":3116234,"reputation":9296,"user_id":2636929,"display_name":"Stultuske"},"score":3,"creation_date":1694529648,"post_id":77090096,"comment_id":135901300,"body_markdown":"if you are &#39;new to programming&#39;, you should start at the beginning, not trying to create a complex application, specially not if it uses tools and frameworks you don&#39;t understand. You show way too little information for us to go on (and we&#39;re definitely not going through that link), put all relevant information needed to debug in the question itself, but seriously, familiarize yourself with the tools and language before taking on big projects","body":"if you are &#39;new to programming&#39;, you should start at the beginning, not trying to create a complex application, specially not if it uses tools and frameworks you don&#39;t understand. You show way too little information for us to go on (and we&#39;re definitely not going through that link), put all relevant information needed to debug in the question itself, but seriously, familiarize yourself with the tools and language before taking on big projects"}],"answers":[{"tags":[],"owner":{"account_id":20798008,"reputation":181,"user_id":15274669,"display_name":"majixin"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694796128,"creation_date":1694793462,"answer_id":77113793,"question_id":77090096,"body_markdown":"I don&#39;t think learning coding while making a game is inherently bad. You encounter real-world problems that require thinking and good problem solving. I assume your update routine is also called 2300 times per second. If it records when it last executed, then if that time is less than 1000ms divided by desired-frame-rate, you should just return from the function.\r\n\r\nWhat you have is a function that increments ```frames``` counter. And when the ```System.currentTimeMillis() - lastCheck &gt;= 1000``` updates ```lastCheck``` time and resets the counter for ```frames```.\r\n\r\nWhat seems wrong here is where ```repaint()``` is located. It&#39;s being called each time ```paintComponent``` is called, rather than each time you would wish to permit an actual ```repaint()```.\r\n\r\nPlacing the repaint in to the if-statement won&#39;t work either. That is simply waiting 1000ms (1 second) before outputting the FPS rate.\r\n\r\nYou also lack the function I describe in my opening statements.\r\n\r\nYou need to:\r\n - add a variable that stores the time when the last repaint was called\r\n - add some conditional logic similar to the FPS if-statement to deduce when enough time has passed and you should actually call repaint\r\n\r\nI&#39;ve not put a running sample together, but I think the following is what you need, albeit it might need a tweak because I haven&#39;t tested it.\r\n\r\n```\r\n// class member fields\r\nlong lastRepaintTime = System.currentTimeMillis();\r\nlong desiredMaxFrameRate = 30;\r\nlong frameRateInterval = 1000 / desiredMaxFrameRate;\r\n\r\n\r\npublic void paintComponent(Graphics g) {\r\n\tsuper.paintComponent(g);\r\n\t\r\n\tlong now = System.currentTimeMillis();\r\n\t\r\n\t// only do UI activity if the frameRateInterval has elapsed\r\n\tif (now - lastRepaintTime &gt;= frameRateInterval)\r\n\t{\r\n\t    frames++;\t// only count frames we actually render\r\n\t\tupdateRectangle();\r\n\t\tg.setColor(color);\r\n\t\tg.fillRect((int)xDelta, (int)yDelta, 50, 50);\r\n\r\n\t\t// basic FPS counter - check if it&#39;s been 1000+ms since we last output the frame count\r\n\t\tif(now - lastCheck &gt;= 1000) {\r\n\t\t\tlastCheck = System.currentTimeMillis();\r\n\t\t\tSystem.out.println(&quot;FPS: &quot; + frames);\r\n\t\t\tframes = 0;\r\n\t\t}\r\n\t\trepaint();\t                                  // perform the actual repaint/rendering\r\n        lastRepaintTime = System.currentTimeMillis(); // update the lastRepaintTime\r\n\t}\r\n}\r\n```\r\n\r\nEDIT: it isn&#39;t clear how you end up with the FPS always being 1 unless you somehow only call ```paintComponent``` each second. If you&#39;re trying to use ```lastCheck``` in unposted code to limit how often you call ```paintComponent``` you need to realize that ```lastCheck``` should only be used for when you wish to output the FPS rate, not for rate-limiting when you wish to update the screen.","title":"How can I set a cap for FPS in an Eclipse IDE project?","body":"<p>I don't think learning coding while making a game is inherently bad. You encounter real-world problems that require thinking and good problem solving. I assume your update routine is also called 2300 times per second. If it records when it last executed, then if that time is less than 1000ms divided by desired-frame-rate, you should just return from the function.</p>\n<p>What you have is a function that increments <code>frames</code> counter. And when the <code>System.currentTimeMillis() - lastCheck &gt;= 1000</code> updates <code>lastCheck</code> time and resets the counter for <code>frames</code>.</p>\n<p>What seems wrong here is where <code>repaint()</code> is located. It's being called each time <code>paintComponent</code> is called, rather than each time you would wish to permit an actual <code>repaint()</code>.</p>\n<p>Placing the repaint in to the if-statement won't work either. That is simply waiting 1000ms (1 second) before outputting the FPS rate.</p>\n<p>You also lack the function I describe in my opening statements.</p>\n<p>You need to:</p>\n<ul>\n<li>add a variable that stores the time when the last repaint was called</li>\n<li>add some conditional logic similar to the FPS if-statement to deduce when enough time has passed and you should actually call repaint</li>\n</ul>\n<p>I've not put a running sample together, but I think the following is what you need, albeit it might need a tweak because I haven't tested it.</p>\n<pre><code>// class member fields\nlong lastRepaintTime = System.currentTimeMillis();\nlong desiredMaxFrameRate = 30;\nlong frameRateInterval = 1000 / desiredMaxFrameRate;\n\n\npublic void paintComponent(Graphics g) {\n    super.paintComponent(g);\n    \n    long now = System.currentTimeMillis();\n    \n    // only do UI activity if the frameRateInterval has elapsed\n    if (now - lastRepaintTime &gt;= frameRateInterval)\n    {\n        frames++;   // only count frames we actually render\n        updateRectangle();\n        g.setColor(color);\n        g.fillRect((int)xDelta, (int)yDelta, 50, 50);\n\n        // basic FPS counter - check if it's been 1000+ms since we last output the frame count\n        if(now - lastCheck &gt;= 1000) {\n            lastCheck = System.currentTimeMillis();\n            System.out.println(&quot;FPS: &quot; + frames);\n            frames = 0;\n        }\n        repaint();                                    // perform the actual repaint/rendering\n        lastRepaintTime = System.currentTimeMillis(); // update the lastRepaintTime\n    }\n}\n</code></pre>\n<p>EDIT: it isn't clear how you end up with the FPS always being 1 unless you somehow only call <code>paintComponent</code> each second. If you're trying to use <code>lastCheck</code> in unposted code to limit how often you call <code>paintComponent</code> you need to realize that <code>lastCheck</code> should only be used for when you wish to output the FPS rate, not for rate-limiting when you wish to update the screen.</p>\n"}],"owner":{"account_id":29423631,"reputation":1,"user_id":22544870,"display_name":"typhoon"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":37,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1694796128,"creation_date":1694528926,"question_id":77090096,"body_markdown":"While following a tutorial for game development in Java (Guide is by Kaarin Gaming, source: https://www.youtube.com/watch?v=aFS9Whsoecc&amp;list=PL4rzdwizLaxYmltJQRjq18a9gsSyEQQ-0&amp;index=8 ), I ran into an error on limiting my FPS count. His code looks mostly similar to my code other than for a few lines, \r\n\r\n```\r\npublic void paintComponent(Graphics g) {\r\n\t\tsuper.paintComponent(g);\r\n\t\t\r\n\t\t\r\n\t\tupdateRectangle();\r\n\t\tg.setColor(color);\r\n\t\tg.fillRect((int)xDelta, (int)yDelta, 50, 50);\r\n\t\t\r\n\t\t// basic FPS counter\r\n\t\t\t\tframes++;\r\n\t\t\t\tif(System.currentTimeMillis() - lastCheck &gt;= 1000) {\r\n\t\t\t\t\tlastCheck = System.currentTimeMillis();\r\n\t\t\t\t\tSystem.out.println(&quot;FPS: &quot; + frames);\r\n\t\t\t\t\tframes = 0;\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\trepaint();\r\n\t}\r\n```\r\n\r\nWhile the repaint(); is there, the game runs at 2300 FPS, which is way too high. So what he does to fix it is to add some code (of which I&#39;ve already added) and then remove the repaint();. However, when I do it, the game wont run and the FPS will stay at a static 1. \r\n\r\n\r\nI&#39;ve tried changing the intervals between frames refreshing, moving the repaint(); around to different parts of the code that might need it/don&#39;t have it yet, and I&#39;ve watched the video again to find a mistake but I haven&#39;t found anything. \r\n\r\nSomething else to note, I&#39;m new to programming. So if you do have an answer, please explain why so I can understand better, Thank you.","title":"How can I set a cap for FPS in an Eclipse IDE project?","body":"<p>While following a tutorial for game development in Java (Guide is by Kaarin Gaming, source: <a href=\"https://www.youtube.com/watch?v=aFS9Whsoecc&amp;list=PL4rzdwizLaxYmltJQRjq18a9gsSyEQQ-0&amp;index=8\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=aFS9Whsoecc&amp;list=PL4rzdwizLaxYmltJQRjq18a9gsSyEQQ-0&amp;index=8</a> ), I ran into an error on limiting my FPS count. His code looks mostly similar to my code other than for a few lines,</p>\n<pre><code>public void paintComponent(Graphics g) {\n        super.paintComponent(g);\n        \n        \n        updateRectangle();\n        g.setColor(color);\n        g.fillRect((int)xDelta, (int)yDelta, 50, 50);\n        \n        // basic FPS counter\n                frames++;\n                if(System.currentTimeMillis() - lastCheck &gt;= 1000) {\n                    lastCheck = System.currentTimeMillis();\n                    System.out.println(&quot;FPS: &quot; + frames);\n                    frames = 0;\n                    \n                }\n                repaint();\n    }\n</code></pre>\n<p>While the repaint(); is there, the game runs at 2300 FPS, which is way too high. So what he does to fix it is to add some code (of which I've already added) and then remove the repaint();. However, when I do it, the game wont run and the FPS will stay at a static 1.</p>\n<p>I've tried changing the intervals between frames refreshing, moving the repaint(); around to different parts of the code that might need it/don't have it yet, and I've watched the video again to find a mistake but I haven't found anything.</p>\n<p>Something else to note, I'm new to programming. So if you do have an answer, please explain why so I can understand better, Thank you.</p>\n"},{"tags":["java","hibernate","jpa"],"owner":{"account_id":18287195,"reputation":13,"user_id":20983892,"display_name":"Douglas Monteiro"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":55,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694795900,"creation_date":1694795900,"question_id":77114057,"body_markdown":"I&#39;m working with Hibernate and JPA&#39;s @Embeddable annotation to create composite attributes for my entities (I&#39;m using composites as value objects). I&#39;ve noticed some inconsistent behavior when these embeddables contain a Collection attribute. Specifically, the way Hibernate initializes these composites varies based on the presence of collection attributes.\r\n\r\n**Context:**\r\n\r\n**Null Composite Handling:** If all attributes within a composite (@Embeddable) object are null, Hibernate considers the entire composite as null. This is logical and expected.\r\n\r\n**Null Collection Handling:** If an attribute of type Collection is null when Hibernate loads data from the database, it sets this attribute to an empty collection. This makes sense since having null collections is generally considered bad practice.\r\n\r\n**The Issue:**\r\n\r\nThe above behaviors together create an inconsistent initialization pattern:\r\n\r\nWhen I retrieve an @Embeddable object from the database that was originally saved with only null attributes, and one of those attributes is a Collection, Hibernate initializes the composite. This happens because the collection attribute is set to empty, thereby making the composite non-null.\r\n\r\nExample:\r\nTo clarify, for some embedded properties, I end up having to do complex checks like:\r\n\r\n```\r\nif (entity.getAttribute() != null &amp;&amp; \r\n    entity.getAttribute().getFoo() != null &amp;&amp; \r\n    !entity.getAttribute().getCollection().isEmpty()) {\r\n  //...\r\n}\r\n```\r\n\r\n\r\n\r\n**Workaround:**\r\n\r\nI thought about introducing an isValid() method in all my @Embeddable classes. With this, I would always check:\r\n\r\n```\r\nif (entity.getAttribute() != null &amp;&amp; entity.getAttribute().isValid()) {\r\n  //...\r\n}\r\n```\r\n\r\nHowever, this approach feels like a hack and clutters the domain model with code that&#39;s solely there to mitigate an ORM behavior.\r\n\r\n**Question:**\r\n\r\nIs there a way to configure Hibernate to avoid initializing the collections within @Embeddable objects that have all other attributes set to null? I want to preserve the nullability of the entire composite object in such cases.","title":"How to Prevent Hibernate from Initializing Collections in Empty Composites?","body":"<p>I'm working with Hibernate and JPA's @Embeddable annotation to create composite attributes for my entities (I'm using composites as value objects). I've noticed some inconsistent behavior when these embeddables contain a Collection attribute. Specifically, the way Hibernate initializes these composites varies based on the presence of collection attributes.</p>\n<p><strong>Context:</strong></p>\n<p><strong>Null Composite Handling:</strong> If all attributes within a composite (@Embeddable) object are null, Hibernate considers the entire composite as null. This is logical and expected.</p>\n<p><strong>Null Collection Handling:</strong> If an attribute of type Collection is null when Hibernate loads data from the database, it sets this attribute to an empty collection. This makes sense since having null collections is generally considered bad practice.</p>\n<p><strong>The Issue:</strong></p>\n<p>The above behaviors together create an inconsistent initialization pattern:</p>\n<p>When I retrieve an @Embeddable object from the database that was originally saved with only null attributes, and one of those attributes is a Collection, Hibernate initializes the composite. This happens because the collection attribute is set to empty, thereby making the composite non-null.</p>\n<p>Example:\nTo clarify, for some embedded properties, I end up having to do complex checks like:</p>\n<pre><code>if (entity.getAttribute() != null &amp;&amp; \n    entity.getAttribute().getFoo() != null &amp;&amp; \n    !entity.getAttribute().getCollection().isEmpty()) {\n  //...\n}\n</code></pre>\n<p><strong>Workaround:</strong></p>\n<p>I thought about introducing an isValid() method in all my @Embeddable classes. With this, I would always check:</p>\n<pre><code>if (entity.getAttribute() != null &amp;&amp; entity.getAttribute().isValid()) {\n  //...\n}\n</code></pre>\n<p>However, this approach feels like a hack and clutters the domain model with code that's solely there to mitigate an ORM behavior.</p>\n<p><strong>Question:</strong></p>\n<p>Is there a way to configure Hibernate to avoid initializing the collections within @Embeddable objects that have all other attributes set to null? I want to preserve the nullability of the entire composite object in such cases.</p>\n"},{"tags":["java","serialization"],"comments":[{"owner":{"account_id":350117,"reputation":8653,"user_id":685806,"accept_rate":44,"display_name":"Pino"},"score":2,"creation_date":1694791092,"post_id":77113528,"comment_id":135942012,"body_markdown":"The best approach is not to try out, it is to synchronize to be safe :-)","body":"The best approach is not to try out, it is to synchronize to be safe :-)"},{"owner":{"account_id":465573,"reputation":192694,"user_id":869736,"accept_rate":82,"display_name":"Louis Wasserman"},"score":0,"creation_date":1694799044,"post_id":77113528,"comment_id":135943435,"body_markdown":"1. No.  2. No.  3. It will always serialize the value you _don&#39;t_ want except on Tuesdays.","body":"1. No.  2. No.  3. It will always serialize the value you <i>don&#39;t</i> want except on Tuesdays."},{"owner":{"account_id":23740623,"reputation":1,"user_id":17758716,"display_name":"Reilas"},"score":0,"creation_date":1694803403,"post_id":77113528,"comment_id":135944139,"body_markdown":"To clarify, are you referring to the _Java_ _[serialization](https://docs.oracle.com/javase/tutorial/jndi/objects/serial.html)_ functionality, or is the word &quot;serializing&quot; a _threading_ term?","body":"To clarify, are you referring to the <i>Java</i> <i><a href=\"https://docs.oracle.com/javase/tutorial/jndi/objects/serial.html\" rel=\"nofollow noreferrer\">serialization</a></i> functionality, or is the word &quot;serializing&quot; a <i>threading</i> term?"}],"answers":[{"tags":[],"owner":{"account_id":47283,"reputation":703817,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694795890,"creation_date":1694791253,"answer_id":77113566,"question_id":77113528,"body_markdown":"\r\n\r\n&gt; 1. Does Serialization put any kind of lock on the object by default or both Serialization and Modification (calling setter method on the object) can go hand in hand when performed concurrently?\r\n\r\nJava Object Serialization does not lock object that it is serializing.  It would be up to the thread that calls the `writeObject` method to ensure that it does this while holding appropriate locks to prevent other threads from mutating the object while it is being serialized.\r\n\r\n(Java doesn&#39;t have any way to block all other threads&#39; writes to an object ... unless the threads being blocked are cooperating by synchronizing in some way with the blocking thread(s).)\r\n\r\n&gt; 2. Can Serialization have any performance impact (execution runtime) on modification of an object i.e. invocation of setter methods concurrently?\r\n\r\nNot *per se*.  But if you lock an object to serialize it, that could delay other threads, and potentially have performance concerns.\r\n\r\n&gt; 3.  If the setter method is invoked when the Serialization is in progress - What value will get Serialized for the field being populated by setter method?\r\n\r\nThat is not defined.  Basically you are talking about the behavior of code that is not thread-safe.\r\n\r\n\r\n-----------------------\r\n\r\nPino commented:\r\n\r\n&gt;  The best approach is not to try out, it is to synchronize to be safe :-) \r\n\r\nAbsolutely correct.  And I will go a step further.  If you do try to serialize and mutate an object at the same time:\r\n  \r\n  - you are highly likely to run into problems at some point&lt;sup&gt;1&lt;/sup&gt;,\r\n  - they will have unpredictable symptoms, and\r\n  - they will be hard to diagnose.\r\n\r\n&lt;sup&gt;1 - ... but it is not possible to predict when.  For example, they might only occur under heavy load, or on certain machines, or with certain Java releases.&lt;/sup&gt;","title":"Java - Modifying and Serializing an Object concurrently","body":"<blockquote>\n<ol>\n<li>Does Serialization put any kind of lock on the object by default or both Serialization and Modification (calling setter method on the object) can go hand in hand when performed concurrently?</li>\n</ol>\n</blockquote>\n<p>Java Object Serialization does not lock object that it is serializing.  It would be up to the thread that calls the <code>writeObject</code> method to ensure that it does this while holding appropriate locks to prevent other threads from mutating the object while it is being serialized.</p>\n<p>(Java doesn't have any way to block all other threads' writes to an object ... unless the threads being blocked are cooperating by synchronizing in some way with the blocking thread(s).)</p>\n<blockquote>\n<ol start=\"2\">\n<li>Can Serialization have any performance impact (execution runtime) on modification of an object i.e. invocation of setter methods concurrently?</li>\n</ol>\n</blockquote>\n<p>Not <em>per se</em>.  But if you lock an object to serialize it, that could delay other threads, and potentially have performance concerns.</p>\n<blockquote>\n<ol start=\"3\">\n<li>If the setter method is invoked when the Serialization is in progress - What value will get Serialized for the field being populated by setter method?</li>\n</ol>\n</blockquote>\n<p>That is not defined.  Basically you are talking about the behavior of code that is not thread-safe.</p>\n<hr />\n<p>Pino commented:</p>\n<blockquote>\n<p>The best approach is not to try out, it is to synchronize to be safe :-)</p>\n</blockquote>\n<p>Absolutely correct.  And I will go a step further.  If you do try to serialize and mutate an object at the same time:</p>\n<ul>\n<li>you are highly likely to run into problems at some point<sup>1</sup>,</li>\n<li>they will have unpredictable symptoms, and</li>\n<li>they will be hard to diagnose.</li>\n</ul>\n<p><sup>1 - ... but it is not possible to predict when.  For example, they might only occur under heavy load, or on certain machines, or with certain Java releases.</sup></p>\n"},{"tags":[],"owner":{"account_id":401843,"reputation":89768,"user_id":768644,"display_name":"rzwitserloot"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694795194,"creation_date":1694794711,"answer_id":77113947,"question_id":77113528,"body_markdown":"&gt; The best approach would have been to try out and see the outcome\r\n\r\nThat&#39;s almost always true. __But it is wrong here__.\r\n\r\nThe problem is as follows:\r\n\r\nJava as a specification is almost always _exact_. It does not generally write things in terms of: &quot;And when you do this, what happens is undefined&quot;. It also rarely engages in: &quot;And when you do this, the compiler / runtime / OS / phase of the moon right now is free to decide to implement it like this, or like this&quot;. Contrast to e.g. the C spec where the spec explicitly goes out of its way to indicate that the bit size of a &#39;word&#39; is actually a choice the implementation can make, i.e. in C the exact point where an `int` overflows (and even _how_ it overflows) is not dictated by the spec, so you have no idea.\r\n\r\nIn contrast to java, where the spec dictates it precisely: A java `int` overflows when you add 1 to `2^31-1`, and it overflows into `-2^31`, because in java `int` is a signed 32-bit 2&#39;s complement representation. The spec decrees it. A JVM that doesn&#39;t work that way is buggy.\r\n\r\n__But that doesn&#39;t really apply to concurrency specifically__. Java doesn&#39;t exactly use the term &#39;undefined behaviour&#39;, but the selection of behaviours a JVM can have in light of concurrent modification is nebulous enough that it might as well be. Specifically, the spec says that the concept of &#39;sequencing&#39; __is not guaranteed__. As in, the spec neither states that a JVM must act like sequencing exists, nor that a JVM must necessarily _not_ sequence things. It simply states that a JVM may, or may not, it&#39;s up to the JVM, and it doesn&#39;t have to be fair or consistent in its choice.\r\n\r\nIn other words, the JVM spec in this area reads, effectively:\r\n\r\n_&quot;Any time the JVM needs to decide if a write to one field by one thread is to be visible by another, the JVM will grab its evil coin and flip it. The change is synced to the other thread if the coin comes up heads. Evil coin means that the coin isn&#39;t necessarily fair. It might be tails every time this week, then next week it flips heads juuuuust as you&#39;re giving that demo to the important customer, and then its like a fair coin next month. Such a JVM, while weird, is not buggy - your code is, if your code&#39;s behaviour is dependent on the result of the evil coin&quot;_.\r\n\r\nIn light of the fact that it works this, way, hopefully it is now obvious why _try it and see_ __is a big mistake__. Because during your try it and see phase, the coin might well flip heads every time, thus leading you to draw the _entirely incorrect_ conclusion that a JVM reliably flips heads.\r\n\r\n## Okay, but, what are you talking about? Where is the evil coin applied?\r\n\r\nSpecifically it&#39;s about the sequencing of field writes. Given:\r\n\r\n```\r\nclass Test {\r\n  static int a = 1;\r\n  static int b = 10;\r\n\r\n  static void modifyThem() {\r\n    a = 2;\r\n    b = 20;\r\n  }\r\n\r\n  public static void main(String[] args) {\r\n    new Thread(() -&gt; modifyThem()).start();\r\n    new Thread(() -&gt; printThem()).start();\r\n  }\r\n\r\n  static void printThem() {\r\n    System.out.println(a);\r\n    System.out.println(b);\r\n  }\r\n}\r\n```\r\n\r\nThis code&#39;s behaviour __depends on the outcome of the evil coin flip__. The JVM isn&#39;t quite C; there is no undefined behaviour here. But there is _arbitrary_ behaviour. The following results are __all__ possible. If you file a bug with the OpenJDK team that your JVM is broken because what it emits is apparently random (a different result is produced everytime you run the app), your bug would be closed as &#39;JVM working as intended&#39;:\r\n\r\n* 2/20\r\n* 1/20\r\n* 2/10\r\n* 1/10\r\n\r\nIf longs are involved it gets even crazier (because the JVM reserves the right that you can witness &#39;sheared&#39; updates, where the top 32 bits have been updated but the bottom 32-bits haven&#39;t, or vice versa, but this is incredibly hard to observe because on every 64-bit JVM I&#39;m aware of, it is literally impossible to observe it in action. But the spec still says that a JVM that does shear, even a 64-bit one, is not broken).\r\n\r\nOn a simple Raspbery pi I&#39;m fairly sure you&#39;d observe 2/20 every single time you ran this. On most modern CPUs you probably observe 1/10 almost all the time. But 1/20 and 2/10 are also possible.\r\n\r\n1/20 is a particularly bizarre case: That means the `a = 2;` statement appears to not have run yet, whereas the `b = 20;` statement has. But.. `a = 2;` __is above `b = 20;`__ so that seems utterly nuts.\r\n\r\nAnd nevertheless the JVM reserves the right to do that.\r\n\r\nThe key way to think about it is as follows: The JVM does not _actually_ guarantee that things that, to your mind&#39;s reconstruction of how a JVM does things, happens _before_ another thing happens, are observable by the later thing: __The JVM does not _actually_ guarantee that sequencing exists__ - things are not guaranteed to run in the exact order you wrote them in your source file!\r\n\r\nIn other words, it&#39;s wrong to say &#39;evidently, a = 2; has not run yet&#39;. It is right to say: &quot;Thread B is observing a state as it was _before_ `a = 2;` has run&quot;.\r\n\r\nThe way to fight the evil coin is also in the JVM specification. Specifically, the [Java Memory Model section: JLS &#167;17](https://docs.oracle.com/javase/specs/jls/se8/html/jls-17.html).\r\n\r\nThe spec saves you from the evil coin by introducing the notion of establishing &#39;Happens Before&#39; relationships: A very explicit enumerated list of acts which establish that line X (or, to be precise, bytecode X) is to be considered as &#39;happens before&#39; bytecode Y. When such a relationship exists, the JVM __guarantees__ you that it is not possible for Y to observe state as it was _before_ X happens. That doesn&#39;t mean the JVM promises that X is &#39;run&#39; before &#39;Y&#39; - after all, if Y doesn&#39;t actually try to witness anything X did (it doesn&#39;t observe at all) the JVM is free to do whatever it wants. It also applies only to fields and such - for example, any attempt you make at trying to observe if some other code has run or not based on how long the CPU needs to do stuff is _not part of the deal_ - this principle at the CPU level is the exact cause of the [Spectre security vulnerability](https://en.wikipedia.org/wiki/Spectre_(security_vulnerability)) even (observe things you&#39;re not meant to by checking how long things take, not by actually reading data).\r\n\r\nSo that&#39;s how you fight the coin: You establish HBs. The easy ways:\r\n\r\n* Natural HB: Within a single thread, any statement A that lexically appears in the code flow before statement B establishes HB(A, B). i.e. if you run `a = 0; a = 5; System.out.println(a);` all in one thread that cannot possibly print 0, obviously.\r\n* thread control: `thread.start()` is HB relative to the first statement inside the thread. Similarly, `thread.yield()` vs. a still actively running thread is HB relative to that thread ending.\r\n* synchronized: Exiting a `synchronized (x)` block is HB relative to any code that enters such a block afterwards.\r\n* volatile: Reads and writes to volatile fields establish HB, though it&#39;s not always easy to determine which one is the HB one.\r\n\r\nThere&#39;s more, but those are the highlights. A few important lessons from this:\r\n\r\n* __Two+ threads all interacting with the same field is ALWAYS BROKEN, and in UNTESTABLE WAYS, unless either [A] everything is just reading, or [B] it&#39;s all protected by HB relationships, which.. you can&#39;t test for. Yes, inter-thread communication via fields is incredibly complicated and very error prone. Try to avoid it entirely__. (One easy way to avoid it? Use a database. It has transactions, much simpler).\r\n* Loads of java internal code establishes HBs, which further complicates any attempt to witness the evil coin in action. For example, __on almost all systems, `System.out.println` uses `synchronized()` and therefore establishes HB relative to other threads also doing it. Thus, using sysout statements to print out states in threads so you can see what happens breaks the very thing you are attempting to observe!__\r\n\r\n## Why?\r\n\r\nModern CPU design. Here&#39;s a weird thing you probably didn&#39;t know: Modern CPUs __cannot read memory. At all.__ - yes, it has opcodes that write and read to memory but those are emulated. What CPUs can actually only do, is read from their own on-die cache pages, and ask the memory controller to shuttle entire pagefuls (64k usually) of memory between actual main RAM and one of those on-die cache pages ^1. It has a mapping that maintains which chunks (usually 64k in size, called a &#39;page&#39;) of main mem are in which of its limited set of on-die cache pages and will map any read or write op to main memory to a read/write op into its on-die pages with it. If the mapping says that the location that needs to be read or written is in a location that isn&#39;t mapped, the CPU:\r\n\r\n* Finds the on-die page that is eligible for eviction (generally the one least recently read/written).\r\n* Tells the memory controller to go write the _entire_ 64k it contains to the right place in the real main memory of the system, and simultaneously tells it to transfer all data in the entire 64k block that the CPU is interested in over it as it does so.\r\n* The CPU then __goes to sleep for 2000 cycles or something similarly massive__ because that&#39;s going to take a lot of time.\r\n\r\nThe problem is, if all CPUs are just zooming along doing their work such that the amount of main mem they touch is sufficiently localized that it&#39;s all mapped to on-die cores without any need to involve the memory controller, that&#39;s fantastic: No need for that 2000 cycle penalty then. But that also means __every CPU is in its own little universe__, and no write any CPU core does affects any other. The state of main memory after it&#39;s all done is kinda random - whatever CPU ended up telling the memory controller to sync its on-die page back to main mem _last_, &#39;wins&#39;.\r\n\r\nIf java made you promises about the observability of effects in other threads, then java would have to pay the 2000 cycle penalty after every field write, and __java would be ~2000x slower than it is now__. That&#39;s, obviously, ridiculous, so instead java gives you &#39;ridiculous&#39; rules about evil coins instead. Because that way it doesn&#39;t have to do that.\r\n\r\n## So what does serializing and concurrency have to do with each other?\r\n\r\nNothing whatsoever. Remember, concurrency __is broken by default__ - it only works if you explicitly take painstaking care to ensure every access to a single field from 2+ threads is protected with HB clauses, and serialization doesn&#39;t state that it establishes any, therefore, is broken if done in a concurrent environment.\r\n\r\nFurthermore, there is no such thing as &#39;locking an object&#39; in java. At best there&#39;s `synchronized (x) {}` but that doesn&#39;t really &quot;lock x&quot; - any other thread can do with x what it wants. a `synchronized (x)` statement only interacts with _other_ `synchronized (x)` statements. There _is no way in JVM-ese to lock an object in the sense that it freezes any other thread out from attempting to modify that object_.\r\n\r\n## Answering your questions\r\n\r\nWith all that context, the answers are easy:\r\n\r\n&gt; 1. Does Serialization put any kind of lock on the object by default\r\n\r\nThere&#39;s no such thing as a &#39;lock on an object&#39;, so trivially then: No it does not.\r\n\r\n&gt;  or both Serialization and Modification (calling setter method on the object) can go hand in hand when performed concurrently?\r\n\r\nNo, that will result in evil coin flips. Whilst in theory you can attempt to write code that allows evil coin flips but ends up with the same behaviour regardless of how they land, do not write code like that. At the very least it&#39;ll be utterly untestable, not to mention unreadable. Just don&#39;t. Hence: &quot;That results in evil coin flips, which means that code is broken, so do not write code like that&quot;.\r\n\r\n&gt; Can Serialization have any performance impact (execution runtime) on modification of an object i.e. invocation of setter methods concurrently?\r\n\r\nGiven that any code that serializes while simultaneously calling setters is broken without HBs, the answer is therefore: __Yes__, that has a performance impact, because establishing HBs has a performance impact. (Transfering data from one core to another takes 2000 cycles if not more. Even having one core tell another to cool its jets for a bit (awaiting some lock to clear) takes time: Not just the other core having to freeze for a bit or swap contexts to another job, but the mere act of conveying that info core-to-core takes time. CPUs are really fast and those cores are a few millimeters about. Electrons travel at something like 66% of the speed of light. To cross that millimeter? That&#39;s a long time, in CPU cycle terms, actually! Physics laws DEMAND that this has to cost some time!\r\n\r\n\r\n&gt; If the setter method is invoked when the Serialization is in progress - What value will get Serialized for the field being populated by setter method?\r\n\r\nThe evil coin flipped and that decides. It&#39;s guaranteed to be either the old, or the new value, but a JVM can decide to choose which one depending on the phase of the moon as far as the spec is concerned. And of course, if &#39;the value&#39; is an object with lots of state, you can of course get a sheared object written (where some of the fields of that object reflect the new state and some of it the old state).\r\n\r\n## An important sidenote\r\n\r\nSerialization, as in `java.io.Serializable`, is almost always a mistake. It&#39;s weird, complicated, not particularly efficient, its format is mostly opaque (it&#39;s certainly extremely hard to interact with that data from non-java code), it makes software updates incredibly complicated, it makes for very hard to test codebases (where you e.g. need to maintain newer and older versions of the same class simultaneously somehow, with multiple separate src roots to manage all that).\r\n\r\nInstead, use protobuf, JSON, XML, JSONB, YAML, CSV, handrolled formats, or anything else. Something a lot more explicit than java&#39;s baked in serialization mechanism. And that&#39;s also the opinion of the OpenJDK team itself. They aren&#39;t going to immediately deep-six the system (that&#39;d break stuff), but they vocally support the idea that it&#39;s.. very tricky to use right and very very _very_ rarely the right tool for the job.\r\n\r\n----\r\n\r\n[1] This is a very long answer, and nevertheless it is quite oversimplified. Most modern CPUs have layers of cache pages, some actually share them, the exact behaviour depends a bit on CPU architecture, CPUs themselves also have pipelines and re-ordering sequencers, and so much more. However, the core lessons in this answer, namely:\r\n\r\n* All attempts to have 2 threads interact by read/writing to the same field are to be considered broken by default.\r\n* HB is the only way to unbreak it. That, or avoid having _any_ fields interacted with by multiple threads and use message queues or databases instead to do it.\r\n* Behaviour is _effectively_ undefined, and not reliably so - you simply __cannot__ solve anything (be it ensuring that your code is working correctly, or be it learning more by toying around with these ideas) by &#39;trying it&#39;.\r\n\r\nare correct.\r\n","title":"Java - Modifying and Serializing an Object concurrently","body":"<blockquote>\n<p>The best approach would have been to try out and see the outcome</p>\n</blockquote>\n<p>That's almost always true. <strong>But it is wrong here</strong>.</p>\n<p>The problem is as follows:</p>\n<p>Java as a specification is almost always <em>exact</em>. It does not generally write things in terms of: &quot;And when you do this, what happens is undefined&quot;. It also rarely engages in: &quot;And when you do this, the compiler / runtime / OS / phase of the moon right now is free to decide to implement it like this, or like this&quot;. Contrast to e.g. the C spec where the spec explicitly goes out of its way to indicate that the bit size of a 'word' is actually a choice the implementation can make, i.e. in C the exact point where an <code>int</code> overflows (and even <em>how</em> it overflows) is not dictated by the spec, so you have no idea.</p>\n<p>In contrast to java, where the spec dictates it precisely: A java <code>int</code> overflows when you add 1 to <code>2^31-1</code>, and it overflows into <code>-2^31</code>, because in java <code>int</code> is a signed 32-bit 2's complement representation. The spec decrees it. A JVM that doesn't work that way is buggy.</p>\n<p><strong>But that doesn't really apply to concurrency specifically</strong>. Java doesn't exactly use the term 'undefined behaviour', but the selection of behaviours a JVM can have in light of concurrent modification is nebulous enough that it might as well be. Specifically, the spec says that the concept of 'sequencing' <strong>is not guaranteed</strong>. As in, the spec neither states that a JVM must act like sequencing exists, nor that a JVM must necessarily <em>not</em> sequence things. It simply states that a JVM may, or may not, it's up to the JVM, and it doesn't have to be fair or consistent in its choice.</p>\n<p>In other words, the JVM spec in this area reads, effectively:</p>\n<p><em>&quot;Any time the JVM needs to decide if a write to one field by one thread is to be visible by another, the JVM will grab its evil coin and flip it. The change is synced to the other thread if the coin comes up heads. Evil coin means that the coin isn't necessarily fair. It might be tails every time this week, then next week it flips heads juuuuust as you're giving that demo to the important customer, and then its like a fair coin next month. Such a JVM, while weird, is not buggy - your code is, if your code's behaviour is dependent on the result of the evil coin&quot;</em>.</p>\n<p>In light of the fact that it works this, way, hopefully it is now obvious why <em>try it and see</em> <strong>is a big mistake</strong>. Because during your try it and see phase, the coin might well flip heads every time, thus leading you to draw the <em>entirely incorrect</em> conclusion that a JVM reliably flips heads.</p>\n<h2>Okay, but, what are you talking about? Where is the evil coin applied?</h2>\n<p>Specifically it's about the sequencing of field writes. Given:</p>\n<pre><code>class Test {\n  static int a = 1;\n  static int b = 10;\n\n  static void modifyThem() {\n    a = 2;\n    b = 20;\n  }\n\n  public static void main(String[] args) {\n    new Thread(() -&gt; modifyThem()).start();\n    new Thread(() -&gt; printThem()).start();\n  }\n\n  static void printThem() {\n    System.out.println(a);\n    System.out.println(b);\n  }\n}\n</code></pre>\n<p>This code's behaviour <strong>depends on the outcome of the evil coin flip</strong>. The JVM isn't quite C; there is no undefined behaviour here. But there is <em>arbitrary</em> behaviour. The following results are <strong>all</strong> possible. If you file a bug with the OpenJDK team that your JVM is broken because what it emits is apparently random (a different result is produced everytime you run the app), your bug would be closed as 'JVM working as intended':</p>\n<ul>\n<li>2/20</li>\n<li>1/20</li>\n<li>2/10</li>\n<li>1/10</li>\n</ul>\n<p>If longs are involved it gets even crazier (because the JVM reserves the right that you can witness 'sheared' updates, where the top 32 bits have been updated but the bottom 32-bits haven't, or vice versa, but this is incredibly hard to observe because on every 64-bit JVM I'm aware of, it is literally impossible to observe it in action. But the spec still says that a JVM that does shear, even a 64-bit one, is not broken).</p>\n<p>On a simple Raspbery pi I'm fairly sure you'd observe 2/20 every single time you ran this. On most modern CPUs you probably observe 1/10 almost all the time. But 1/20 and 2/10 are also possible.</p>\n<p>1/20 is a particularly bizarre case: That means the <code>a = 2;</code> statement appears to not have run yet, whereas the <code>b = 20;</code> statement has. But.. <code>a = 2;</code> <strong>is above <code>b = 20;</code></strong> so that seems utterly nuts.</p>\n<p>And nevertheless the JVM reserves the right to do that.</p>\n<p>The key way to think about it is as follows: The JVM does not <em>actually</em> guarantee that things that, to your mind's reconstruction of how a JVM does things, happens <em>before</em> another thing happens, are observable by the later thing: <strong>The JVM does not <em>actually</em> guarantee that sequencing exists</strong> - things are not guaranteed to run in the exact order you wrote them in your source file!</p>\n<p>In other words, it's wrong to say 'evidently, a = 2; has not run yet'. It is right to say: &quot;Thread B is observing a state as it was <em>before</em> <code>a = 2;</code> has run&quot;.</p>\n<p>The way to fight the evil coin is also in the JVM specification. Specifically, the <a href=\"https://docs.oracle.com/javase/specs/jls/se8/html/jls-17.html\" rel=\"nofollow noreferrer\">Java Memory Model section: JLS §17</a>.</p>\n<p>The spec saves you from the evil coin by introducing the notion of establishing 'Happens Before' relationships: A very explicit enumerated list of acts which establish that line X (or, to be precise, bytecode X) is to be considered as 'happens before' bytecode Y. When such a relationship exists, the JVM <strong>guarantees</strong> you that it is not possible for Y to observe state as it was <em>before</em> X happens. That doesn't mean the JVM promises that X is 'run' before 'Y' - after all, if Y doesn't actually try to witness anything X did (it doesn't observe at all) the JVM is free to do whatever it wants. It also applies only to fields and such - for example, any attempt you make at trying to observe if some other code has run or not based on how long the CPU needs to do stuff is <em>not part of the deal</em> - this principle at the CPU level is the exact cause of the <a href=\"https://en.wikipedia.org/wiki/Spectre_(security_vulnerability)\" rel=\"nofollow noreferrer\">Spectre security vulnerability</a> even (observe things you're not meant to by checking how long things take, not by actually reading data).</p>\n<p>So that's how you fight the coin: You establish HBs. The easy ways:</p>\n<ul>\n<li>Natural HB: Within a single thread, any statement A that lexically appears in the code flow before statement B establishes HB(A, B). i.e. if you run <code>a = 0; a = 5; System.out.println(a);</code> all in one thread that cannot possibly print 0, obviously.</li>\n<li>thread control: <code>thread.start()</code> is HB relative to the first statement inside the thread. Similarly, <code>thread.yield()</code> vs. a still actively running thread is HB relative to that thread ending.</li>\n<li>synchronized: Exiting a <code>synchronized (x)</code> block is HB relative to any code that enters such a block afterwards.</li>\n<li>volatile: Reads and writes to volatile fields establish HB, though it's not always easy to determine which one is the HB one.</li>\n</ul>\n<p>There's more, but those are the highlights. A few important lessons from this:</p>\n<ul>\n<li><strong>Two+ threads all interacting with the same field is ALWAYS BROKEN, and in UNTESTABLE WAYS, unless either [A] everything is just reading, or [B] it's all protected by HB relationships, which.. you can't test for. Yes, inter-thread communication via fields is incredibly complicated and very error prone. Try to avoid it entirely</strong>. (One easy way to avoid it? Use a database. It has transactions, much simpler).</li>\n<li>Loads of java internal code establishes HBs, which further complicates any attempt to witness the evil coin in action. For example, <strong>on almost all systems, <code>System.out.println</code> uses <code>synchronized()</code> and therefore establishes HB relative to other threads also doing it. Thus, using sysout statements to print out states in threads so you can see what happens breaks the very thing you are attempting to observe!</strong></li>\n</ul>\n<h2>Why?</h2>\n<p>Modern CPU design. Here's a weird thing you probably didn't know: Modern CPUs <strong>cannot read memory. At all.</strong> - yes, it has opcodes that write and read to memory but those are emulated. What CPUs can actually only do, is read from their own on-die cache pages, and ask the memory controller to shuttle entire pagefuls (64k usually) of memory between actual main RAM and one of those on-die cache pages ^1. It has a mapping that maintains which chunks (usually 64k in size, called a 'page') of main mem are in which of its limited set of on-die cache pages and will map any read or write op to main memory to a read/write op into its on-die pages with it. If the mapping says that the location that needs to be read or written is in a location that isn't mapped, the CPU:</p>\n<ul>\n<li>Finds the on-die page that is eligible for eviction (generally the one least recently read/written).</li>\n<li>Tells the memory controller to go write the <em>entire</em> 64k it contains to the right place in the real main memory of the system, and simultaneously tells it to transfer all data in the entire 64k block that the CPU is interested in over it as it does so.</li>\n<li>The CPU then <strong>goes to sleep for 2000 cycles or something similarly massive</strong> because that's going to take a lot of time.</li>\n</ul>\n<p>The problem is, if all CPUs are just zooming along doing their work such that the amount of main mem they touch is sufficiently localized that it's all mapped to on-die cores without any need to involve the memory controller, that's fantastic: No need for that 2000 cycle penalty then. But that also means <strong>every CPU is in its own little universe</strong>, and no write any CPU core does affects any other. The state of main memory after it's all done is kinda random - whatever CPU ended up telling the memory controller to sync its on-die page back to main mem <em>last</em>, 'wins'.</p>\n<p>If java made you promises about the observability of effects in other threads, then java would have to pay the 2000 cycle penalty after every field write, and <strong>java would be ~2000x slower than it is now</strong>. That's, obviously, ridiculous, so instead java gives you 'ridiculous' rules about evil coins instead. Because that way it doesn't have to do that.</p>\n<h2>So what does serializing and concurrency have to do with each other?</h2>\n<p>Nothing whatsoever. Remember, concurrency <strong>is broken by default</strong> - it only works if you explicitly take painstaking care to ensure every access to a single field from 2+ threads is protected with HB clauses, and serialization doesn't state that it establishes any, therefore, is broken if done in a concurrent environment.</p>\n<p>Furthermore, there is no such thing as 'locking an object' in java. At best there's <code>synchronized (x) {}</code> but that doesn't really &quot;lock x&quot; - any other thread can do with x what it wants. a <code>synchronized (x)</code> statement only interacts with <em>other</em> <code>synchronized (x)</code> statements. There <em>is no way in JVM-ese to lock an object in the sense that it freezes any other thread out from attempting to modify that object</em>.</p>\n<h2>Answering your questions</h2>\n<p>With all that context, the answers are easy:</p>\n<blockquote>\n<ol>\n<li>Does Serialization put any kind of lock on the object by default</li>\n</ol>\n</blockquote>\n<p>There's no such thing as a 'lock on an object', so trivially then: No it does not.</p>\n<blockquote>\n<p>or both Serialization and Modification (calling setter method on the object) can go hand in hand when performed concurrently?</p>\n</blockquote>\n<p>No, that will result in evil coin flips. Whilst in theory you can attempt to write code that allows evil coin flips but ends up with the same behaviour regardless of how they land, do not write code like that. At the very least it'll be utterly untestable, not to mention unreadable. Just don't. Hence: &quot;That results in evil coin flips, which means that code is broken, so do not write code like that&quot;.</p>\n<blockquote>\n<p>Can Serialization have any performance impact (execution runtime) on modification of an object i.e. invocation of setter methods concurrently?</p>\n</blockquote>\n<p>Given that any code that serializes while simultaneously calling setters is broken without HBs, the answer is therefore: <strong>Yes</strong>, that has a performance impact, because establishing HBs has a performance impact. (Transfering data from one core to another takes 2000 cycles if not more. Even having one core tell another to cool its jets for a bit (awaiting some lock to clear) takes time: Not just the other core having to freeze for a bit or swap contexts to another job, but the mere act of conveying that info core-to-core takes time. CPUs are really fast and those cores are a few millimeters about. Electrons travel at something like 66% of the speed of light. To cross that millimeter? That's a long time, in CPU cycle terms, actually! Physics laws DEMAND that this has to cost some time!</p>\n<blockquote>\n<p>If the setter method is invoked when the Serialization is in progress - What value will get Serialized for the field being populated by setter method?</p>\n</blockquote>\n<p>The evil coin flipped and that decides. It's guaranteed to be either the old, or the new value, but a JVM can decide to choose which one depending on the phase of the moon as far as the spec is concerned. And of course, if 'the value' is an object with lots of state, you can of course get a sheared object written (where some of the fields of that object reflect the new state and some of it the old state).</p>\n<h2>An important sidenote</h2>\n<p>Serialization, as in <code>java.io.Serializable</code>, is almost always a mistake. It's weird, complicated, not particularly efficient, its format is mostly opaque (it's certainly extremely hard to interact with that data from non-java code), it makes software updates incredibly complicated, it makes for very hard to test codebases (where you e.g. need to maintain newer and older versions of the same class simultaneously somehow, with multiple separate src roots to manage all that).</p>\n<p>Instead, use protobuf, JSON, XML, JSONB, YAML, CSV, handrolled formats, or anything else. Something a lot more explicit than java's baked in serialization mechanism. And that's also the opinion of the OpenJDK team itself. They aren't going to immediately deep-six the system (that'd break stuff), but they vocally support the idea that it's.. very tricky to use right and very very <em>very</em> rarely the right tool for the job.</p>\n<hr />\n<p>[1] This is a very long answer, and nevertheless it is quite oversimplified. Most modern CPUs have layers of cache pages, some actually share them, the exact behaviour depends a bit on CPU architecture, CPUs themselves also have pipelines and re-ordering sequencers, and so much more. However, the core lessons in this answer, namely:</p>\n<ul>\n<li>All attempts to have 2 threads interact by read/writing to the same field are to be considered broken by default.</li>\n<li>HB is the only way to unbreak it. That, or avoid having <em>any</em> fields interacted with by multiple threads and use message queues or databases instead to do it.</li>\n<li>Behaviour is <em>effectively</em> undefined, and not reliably so - you simply <strong>cannot</strong> solve anything (be it ensuring that your code is working correctly, or be it learning more by toying around with these ideas) by 'trying it'.</li>\n</ul>\n<p>are correct.</p>\n"}],"owner":{"account_id":397984,"reputation":535,"user_id":762421,"accept_rate":36,"display_name":"user762421"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":43,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":2,"score":1,"last_activity_date":1694795890,"creation_date":1694790889,"question_id":77113528,"body_markdown":"I have few questions related to concurrently Modifying and Serializing a Java Object. (The best approach would have been to try out and see the outcome and build the understanding around it but coming up with concurrent code exactly to try out the below things is a bit tricky)\r\n\r\n 1. Does Serialization put any kind of lock on the object by default or both Serialization and Modification (calling setter method on the object) can go hand in hand when performed concurrently?\r\n\r\n 2. Can Serialization have any performance impact (execution runtime) on modification of an object i.e. invocation of setter methods concurrently?\r\n\r\n 2. If the setter method is invoked when the Serialization is in progress - What value will get Serialized for the field being populated by setter method?","title":"Java - Modifying and Serializing an Object concurrently","body":"<p>I have few questions related to concurrently Modifying and Serializing a Java Object. (The best approach would have been to try out and see the outcome and build the understanding around it but coming up with concurrent code exactly to try out the below things is a bit tricky)</p>\n<ol>\n<li><p>Does Serialization put any kind of lock on the object by default or both Serialization and Modification (calling setter method on the object) can go hand in hand when performed concurrently?</p>\n</li>\n<li><p>Can Serialization have any performance impact (execution runtime) on modification of an object i.e. invocation of setter methods concurrently?</p>\n</li>\n<li><p>If the setter method is invoked when the Serialization is in progress - What value will get Serialized for the field being populated by setter method?</p>\n</li>\n</ol>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":14438772,"reputation":702,"user_id":10430074,"display_name":"Ankit"},"score":0,"creation_date":1604128739,"post_id":64618773,"comment_id":114257778,"body_markdown":"I ran the code and it writes value of `max` variable in `output.txt` file.","body":"I ran the code and it writes value of <code>max</code> variable in <code>output.txt</code> file."}],"answers":[{"tags":[],"owner":{"account_id":8779643,"reputation":51,"user_id":6563652,"display_name":"Ashwin PRJ"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1604128661,"creation_date":1604128661,"answer_id":64619362,"question_id":64618773,"body_markdown":"create a new folder and keep your java and output.txt file inside the folder then compile and run the program.\r\nHope it will solve your problem","title":"Writing to a file in the current directory in java","body":"<p>create a new folder and keep your java and output.txt file inside the folder then compile and run the program.\nHope it will solve your problem</p>\n"},{"tags":[],"owner":{"account_id":5998820,"reputation":12656,"user_id":4712734,"display_name":"DuncG"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1694795532,"creation_date":1604148479,"answer_id":64621860,"question_id":64618773,"body_markdown":"If you want to access the current directory you should reference the file directly, and use try with resources to clean up the output stream:\r\n\r\n    public static void main(String args[]) throws IOException {\r\n        int max=10;\r\n\t\tFile output = new File(&quot;output.txt&quot;);\r\n\t\tSystem.out.println(&quot;Writing to: &quot;+output.getAbsolutePath());\r\n\t\ttry(BufferedWriter writer = new BufferedWriter(new FileWriter(output))) {\r\n\t\t\twriter.write(Integer.toString(max));\r\n\t\t}\r\n    }\r\n\r\nThe code is simpler in later JDKs using `Path` and `Files`:\r\n\r\n    public static void main(String ... args) throws IOException {\r\n        int max = 10;\r\n        Path output = Path.of(&quot;output.txt&quot;); // Use Paths.get in JDK9\r\n        System.out.println(&quot;Writing to: &quot;+output.toAbsolutePath());\r\n        Files.writeString(output, Integer.toString(max));\r\n    }\r\n","title":"Writing to a file in the current directory in java","body":"<p>If you want to access the current directory you should reference the file directly, and use try with resources to clean up the output stream:</p>\n<pre><code>public static void main(String args[]) throws IOException {\n    int max=10;\n    File output = new File(&quot;output.txt&quot;);\n    System.out.println(&quot;Writing to: &quot;+output.getAbsolutePath());\n    try(BufferedWriter writer = new BufferedWriter(new FileWriter(output))) {\n        writer.write(Integer.toString(max));\n    }\n}\n</code></pre>\n<p>The code is simpler in later JDKs using <code>Path</code> and <code>Files</code>:</p>\n<pre><code>public static void main(String ... args) throws IOException {\n    int max = 10;\n    Path output = Path.of(&quot;output.txt&quot;); // Use Paths.get in JDK9\n    System.out.println(&quot;Writing to: &quot;+output.toAbsolutePath());\n    Files.writeString(output, Integer.toString(max));\n}\n</code></pre>\n"}],"owner":{"account_id":17576552,"reputation":113,"user_id":12751181,"display_name":"Sasirekha MSVL"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1622,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":64621860,"answer_count":2,"score":0,"last_activity_date":1694795532,"creation_date":1604122851,"question_id":64618773,"body_markdown":"```\r\nimport java.io.*;\r\nimport java.lang.*;\r\nimport java.net.*;\r\nimport java.util.*;\r\npublic class Solution{\r\n    public static void main(String args[])throws IOException{\r\n        int max=10;\r\n        URL path = Solution.class.getResource(&quot;output.txt&quot;);\r\n        File output = new File(path.getFile());\r\n        BufferedWriter writer = new BufferedWriter(new FileWriter(output));\r\n        writer.write(Integer.toString(max));\r\n        writer.close();\r\n\r\n    }\r\n}\r\n```\r\nI was trying to write data to an output.txt file which is current directory.The program has no erros but max value is not getting written on the output.txt file. Thank you in advance.","title":"Writing to a file in the current directory in java","body":"<pre><code>import java.io.*;\nimport java.lang.*;\nimport java.net.*;\nimport java.util.*;\npublic class Solution{\n    public static void main(String args[])throws IOException{\n        int max=10;\n        URL path = Solution.class.getResource(&quot;output.txt&quot;);\n        File output = new File(path.getFile());\n        BufferedWriter writer = new BufferedWriter(new FileWriter(output));\n        writer.write(Integer.toString(max));\n        writer.close();\n\n    }\n}\n</code></pre>\n<p>I was trying to write data to an output.txt file which is current directory.The program has no erros but max value is not getting written on the output.txt file. Thank you in advance.</p>\n"},{"tags":["java"],"answers":[{"tags":[],"owner":{"account_id":29440053,"reputation":89,"user_id":22558282,"display_name":"Dave"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1694794801,"creation_date":1694794801,"answer_id":77113962,"question_id":77113911,"body_markdown":"To achieve the desired format with commas after the first two digits and then every three digits, you can customize the format in DecimalFormat more specifically. You can use the character 0 to represent a required digit and # to represent an optional digit. Here&#39;s how you can do it:\r\n\r\n    import java.text.DecimalFormat;\r\n    import java.util.Scanner;\r\n    \r\n    public class NumberCommaApplier {\r\n    \r\n        public static void main(String[] args) {\r\n            Scanner sc = new Scanner(System.in);\r\n            DecimalFormat comma = new DecimalFormat(&quot;##,##,###&quot;);\r\n    \r\n            System.out.print(&quot;Enter a number: &quot;);\r\n            double input = sc.nextDouble();\r\n    \r\n            System.out.println(comma.format(input));\r\n        }\r\n    }\r\n\r\nWith this format, you will get commas after the first two digits and then every three digits thereafter. For example:\r\n\r\nInput: 1000000\r\nDesired Output: 10,00,000\r\nUsing the format &quot;##,##,###&quot; in DecimalFormat will allow you to achieve the desired format with commas placed correctly. I hope this helps you\r\n","title":"Number formatting , JAVA","body":"<p>To achieve the desired format with commas after the first two digits and then every three digits, you can customize the format in DecimalFormat more specifically. You can use the character 0 to represent a required digit and # to represent an optional digit. Here's how you can do it:</p>\n<pre><code>import java.text.DecimalFormat;\nimport java.util.Scanner;\n\npublic class NumberCommaApplier {\n\n    public static void main(String[] args) {\n        Scanner sc = new Scanner(System.in);\n        DecimalFormat comma = new DecimalFormat(&quot;##,##,###&quot;);\n\n        System.out.print(&quot;Enter a number: &quot;);\n        double input = sc.nextDouble();\n\n        System.out.println(comma.format(input));\n    }\n}\n</code></pre>\n<p>With this format, you will get commas after the first two digits and then every three digits thereafter. For example:</p>\n<p>Input: 1000000\nDesired Output: 10,00,000\nUsing the format &quot;##,##,###&quot; in DecimalFormat will allow you to achieve the desired format with commas placed correctly. I hope this helps you</p>\n"}],"owner":{"account_id":29454207,"reputation":1,"user_id":22570400,"display_name":"Jay"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":39,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1694795188,"answer_count":1,"score":0,"last_activity_date":1694794801,"creation_date":1694794429,"question_id":77113911,"body_markdown":"I am trying to format a number. so that the output number has commas at desired locations. but with the help of DecimalFormat library there are commas after every 3 numbers but not able to change get commas after 2 digits after once there have been commas after 3 digits \r\n\r\nOutput getting - 1,000,000\r\nRequired Output= 10,00,000\r\n\r\n\r\n```package com.Practice;\r\nimport java.util.Scanner;\r\nimport java.text.DecimalFormat;\r\npublic class number_comma_applier {\r\n\r\n    public static void main(String[] args) {\r\n        Scanner sc=new Scanner(System.in);\r\n        DecimalFormat comma = new DecimalFormat(&quot;###,###&quot;);\r\n        System.out.print(&quot;Enter a number: &quot;);\r\n        double input = sc.nextDouble();\r\n        System.out.println(comma.format(input));\r\n    }\r\n}\r\n\r\n\r\ntype here\r\n```\r\n\r\n\r\n","title":"Number formatting , JAVA","body":"<p>I am trying to format a number. so that the output number has commas at desired locations. but with the help of DecimalFormat library there are commas after every 3 numbers but not able to change get commas after 2 digits after once there have been commas after 3 digits</p>\n<p>Output getting - 1,000,000\nRequired Output= 10,00,000</p>\n<pre><code>import java.util.Scanner;\nimport java.text.DecimalFormat;\npublic class number_comma_applier {\n\n    public static void main(String[] args) {\n        Scanner sc=new Scanner(System.in);\n        DecimalFormat comma = new DecimalFormat(&quot;###,###&quot;);\n        System.out.print(&quot;Enter a number: &quot;);\n        double input = sc.nextDouble();\n        System.out.println(comma.format(input));\n    }\n}\n\n\ntype here\n</code></pre>\n"},{"tags":["java","encryption","aes","cryptojs"],"answers":[{"tags":[],"owner":{"account_id":12359353,"reputation":42427,"user_id":9014097,"display_name":"Topaco"},"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1694794800,"creation_date":1694792720,"answer_id":77113718,"question_id":77113297,"body_markdown":"The hash algorithm is part of the key derivation function. Therefore, in the CryptoJS code, the hash algorithm must be specified in the key derivation function and not within the `encrypt()`/`decrypt()` calls: \r\n\r\n&lt;!-- begin snippet: js hide: false console: true babel: false --&gt;\r\n\r\n&lt;!-- language: lang-js --&gt;\r\n\r\n    var SECRET_KEY = &quot;431.396&quot;;\r\n    var SALT = &quot;d413321c765f563c8288ce281ae6808d&quot;;\r\n    var originalString = &quot;test123_XXX&quot;;\r\n\r\n    var iv = &#39;00000000000000000000000000000000&#39;; // 16 bytes correspons to 32 hex digits\r\n    iv = CryptoJS.enc.Hex.parse(iv);\r\n\r\n    var iterations = 65536;\r\n    var keySize = 256;\r\n\r\n    function encrypt (msg) {\r\n      \r\n      var key = CryptoJS.PBKDF2(SECRET_KEY, SALT, {\r\n          keySize: keySize/32,\r\n          iterations: iterations,\r\n          hasher: CryptoJS.algo.SHA256 // the hash algorithm is part of the key derivation\r\n        });\r\n\r\n      var encrypted = CryptoJS.AES.encrypt(msg, key, { \r\n        iv: iv, \r\n        padding: CryptoJS.pad.Pkcs7, // default\r\n        mode: CryptoJS.mode.CBC // default\r\n      });\r\n      \r\n      return encrypted;\r\n    }\r\n\r\n    function decrypt (encrypted) {\r\n      \r\n      var key = CryptoJS.PBKDF2(SECRET_KEY, SALT, {\r\n          keySize: keySize/32,\r\n          iterations: iterations,\r\n          hasher: CryptoJS.algo.SHA256 // the hash algorithm is part of the key derivation\r\n        });\r\n\r\n      var decrypted = CryptoJS.AES.decrypt(encrypted, key, { \r\n        iv: iv, \r\n        padding: CryptoJS.pad.Pkcs7, // default\r\n        mode: CryptoJS.mode.CBC // default\r\n      });\r\n      \r\n      return decrypted;\r\n    }\r\n\r\n    var encrypted = encrypt(originalString);\r\n    var encryptedHex = encrypted.ciphertext.toString(CryptoJS.enc.Hex).toUpperCase();\r\n    var decrypted = decrypt(encrypted);\r\n\r\n    console.log(&quot;SECRET_KEY: &quot;+ SECRET_KEY);\r\n    console.log(&quot;SALT: &quot;+ SALT);\r\n    console.log(&quot;originalString: &quot;+ originalString);\r\n    console.log(&quot;Encrypted: &quot;+ encrypted);\r\n    console.log(&quot;encryptedHex: &quot;+ encryptedHex);\r\n    console.log(&quot;Decrypted: &quot;+ decrypted.toString(CryptoJS.enc.Utf8) );\r\n\r\n&lt;!-- language: lang-html --&gt;\r\n\r\n    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js&quot;&gt;&lt;/script&gt;\r\n\r\n\r\n\r\n&lt;!-- end snippet --&gt;\r\n\r\nWith this change the CryptoJS code generates the same ciphertext as the Java code (compare for this the Base64 encoded ciphertexts).\r\n\r\n--------------\r\n\r\nThe hex encoded ciphertexts still differ because in the Java code the Base64 encoded ciphertext is hex encoded. This double encoding is unnecessary and should be avoided. E.g. with the following change in the Java code:\r\n\r\n```java\r\nString encryptedStringHex = Hex.encodeHexString(Base64.getDecoder().decode(encryptedString.getBytes(StandardCharsets.US_ASCII)));\r\n```\r\n\r\nthese values also match (except for the upper/lower case).  \r\nConsider encoding and decoding outside of `encrypt()` and `decrypt()` so that byte arrays are passed or returned instead of strings.\r\n\r\n---------------\r\n\r\nNote that the IV for AES is 16 bytes in size, which means the hex encoded value consists of 32 hex digits. In the CryptoJS code you use only 16 hex digits, which only works because a zero IV is applied and CryptoJS implicitly pads the too short IV with 0x00 values to the correct length.\r\n\r\n---------------\r\n\r\nRegarding security: A static salt and IV are vulnerabilities. The correct way is to generate a random IV and salt during encryption and pass both together with the ciphertext to the decrypting side, typically concatenated (IV and salt are not a secret).  \r\nFurthermore, when decoding with `new String()` and encoding with `getBytes()`, the encoding should always be specified, otherwise the default encoding is used, which may not correspond to the intended encoding.","title":"Cannot replicate Encryption AES-CBC (Java) with CryptoJS (Javascript)","body":"<p>The hash algorithm is part of the key derivation function. Therefore, in the CryptoJS code, the hash algorithm must be specified in the key derivation function and not within the <code>encrypt()</code>/<code>decrypt()</code> calls:</p>\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var SECRET_KEY = \"431.396\";\nvar SALT = \"d413321c765f563c8288ce281ae6808d\";\nvar originalString = \"test123_XXX\";\n\nvar iv = '00000000000000000000000000000000'; // 16 bytes correspons to 32 hex digits\niv = CryptoJS.enc.Hex.parse(iv);\n\nvar iterations = 65536;\nvar keySize = 256;\n\nfunction encrypt (msg) {\n  \n  var key = CryptoJS.PBKDF2(SECRET_KEY, SALT, {\n      keySize: keySize/32,\n      iterations: iterations,\n      hasher: CryptoJS.algo.SHA256 // the hash algorithm is part of the key derivation\n    });\n\n  var encrypted = CryptoJS.AES.encrypt(msg, key, { \n    iv: iv, \n    padding: CryptoJS.pad.Pkcs7, // default\n    mode: CryptoJS.mode.CBC // default\n  });\n  \n  return encrypted;\n}\n\nfunction decrypt (encrypted) {\n  \n  var key = CryptoJS.PBKDF2(SECRET_KEY, SALT, {\n      keySize: keySize/32,\n      iterations: iterations,\n      hasher: CryptoJS.algo.SHA256 // the hash algorithm is part of the key derivation\n    });\n\n  var decrypted = CryptoJS.AES.decrypt(encrypted, key, { \n    iv: iv, \n    padding: CryptoJS.pad.Pkcs7, // default\n    mode: CryptoJS.mode.CBC // default\n  });\n  \n  return decrypted;\n}\n\nvar encrypted = encrypt(originalString);\nvar encryptedHex = encrypted.ciphertext.toString(CryptoJS.enc.Hex).toUpperCase();\nvar decrypted = decrypt(encrypted);\n\nconsole.log(\"SECRET_KEY: \"+ SECRET_KEY);\nconsole.log(\"SALT: \"+ SALT);\nconsole.log(\"originalString: \"+ originalString);\nconsole.log(\"Encrypted: \"+ encrypted);\nconsole.log(\"encryptedHex: \"+ encryptedHex);\nconsole.log(\"Decrypted: \"+ decrypted.toString(CryptoJS.enc.Utf8) );</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js\"&gt;&lt;/script&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n<p>With this change the CryptoJS code generates the same ciphertext as the Java code (compare for this the Base64 encoded ciphertexts).</p>\n<hr />\n<p>The hex encoded ciphertexts still differ because in the Java code the Base64 encoded ciphertext is hex encoded. This double encoding is unnecessary and should be avoided. E.g. with the following change in the Java code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>String encryptedStringHex = Hex.encodeHexString(Base64.getDecoder().decode(encryptedString.getBytes(StandardCharsets.US_ASCII)));\n</code></pre>\n<p>these values also match (except for the upper/lower case).<br />\nConsider encoding and decoding outside of <code>encrypt()</code> and <code>decrypt()</code> so that byte arrays are passed or returned instead of strings.</p>\n<hr />\n<p>Note that the IV for AES is 16 bytes in size, which means the hex encoded value consists of 32 hex digits. In the CryptoJS code you use only 16 hex digits, which only works because a zero IV is applied and CryptoJS implicitly pads the too short IV with 0x00 values to the correct length.</p>\n<hr />\n<p>Regarding security: A static salt and IV are vulnerabilities. The correct way is to generate a random IV and salt during encryption and pass both together with the ciphertext to the decrypting side, typically concatenated (IV and salt are not a secret).<br />\nFurthermore, when decoding with <code>new String()</code> and encoding with <code>getBytes()</code>, the encoding should always be specified, otherwise the default encoding is used, which may not correspond to the intended encoding.</p>\n"}],"owner":{"account_id":3253860,"reputation":1277,"user_id":2743486,"accept_rate":55,"display_name":"DavidDunham"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":86,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77113718,"answer_count":1,"score":0,"last_activity_date":1694794800,"creation_date":1694788879,"question_id":77113297,"body_markdown":"**Goal:** Replicate Java-AES-CBC Encryption/Decryption with CryptoJS (Javascript)\r\n\r\n*Why?:* Create an Encrypted String (Base64 or HEX) with CryptoJS and decode with Java (different Server env.)\r\n\r\n**Problem:** I cannot get the CryptoJS part to produce the same Base64 (or HEX) encoded String as the Java.\r\nAs an effect, with the current state of code, there is no way for the encryption / decryption to be handed off to separate parties.\r\n\r\n\r\nMy Java code outputs following:\r\n\r\n    SECRET_KEY: 431.396\r\n    SALT: d413321c765f563c8288ce281ae6808d\r\n    originalString: test123_XXX\r\n    encryptedString: suBMmUzhQMtuAboORtvr6g==\r\n    encryptedStringHex: 7375424d6d557a68514d747541626f4f5274767236673d3d\r\n    decryptedString: test123_XXX\r\n\r\nMy Javascript code outputs the following\r\n\r\n    [Log] SECRET_KEY: 431.396\r\n    [Log] SALT: d413321c765f563c8288ce281ae6808d\r\n    [Log] originalString: test123_XXX\r\n    [Log] Encrypted: l+R6aYgrQI2+RAIH+X/iJw==\r\n    [Log] encryptedHex: 97E47A69882B408DBE440207F97FE227\r\n    [Log] Decrypted: test123_XXX\r\n\r\nHere is the complete Java code I am using:\r\n\r\n    import java.io.*;\r\n    import java.net.HttpURLConnection;\r\n    import java.net.URL;\r\n    import java.nio.charset.StandardCharsets;\r\n    import java.nio.file.Paths;\r\n    import java.time.LocalDate;\r\n    import java.util.Arrays;\r\n    import java.util.Base64;\r\n    import java.util.Enumeration;\r\n    import java.util.Iterator;\r\n    import java.util.List;\r\n    import java.util.Map;\r\n    import java.util.Map.Entry;\r\n    \r\n    import java.security.*;\r\n    import org.apache.commons.codec.binary.Hex;\r\n    \r\n    import javax.crypto.Cipher;\r\n    import javax.crypto.SecretKey;\r\n    import javax.crypto.SecretKeyFactory;\r\n    import javax.crypto.spec.IvParameterSpec;\r\n    import javax.crypto.spec.PBEKeySpec;\r\n    import javax.crypto.spec.SecretKeySpec;\r\n    import java.security.spec.KeySpec;\r\n    \r\n    \r\n    public class AES {\r\n        \r\n        public static String encrypt(String strToEncrypt, String SECRET_KEY, String SALT) {\r\n    \t\ttry {\r\n    \t\t\tbyte[] iv = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};\r\n    \t\t\tIvParameterSpec ivspec = new IvParameterSpec(iv);\r\n    \t\t\tSecretKeyFactory factory = SecretKeyFactory.getInstance(&quot;PBKDF2WithHmacSHA256&quot;);\r\n    \t\t\tKeySpec spec = new PBEKeySpec(SECRET_KEY.toCharArray(), SALT.getBytes(), 65536, 256);\r\n    \t\t\tSecretKey tmp = factory.generateSecret(spec);\r\n    \t\t\tSecretKeySpec secretKey = new SecretKeySpec(tmp.getEncoded(), &quot;AES&quot;);\r\n    \t\t\tCipher cipher = Cipher.getInstance(&quot;AES/CBC/PKCS5Padding&quot;);\r\n    \t\t\tcipher.init(Cipher.ENCRYPT_MODE, secretKey, ivspec);\r\n    \t\t\treturn Base64.getEncoder().encodeToString(cipher.doFinal(strToEncrypt.getBytes(StandardCharsets.UTF_8)));\r\n    \t\t} catch (Exception e) {\r\n    \t\t\tSystem.out.println(&quot;Error while encrypting: &quot; + e.toString());\r\n    \t\t}\r\n    \t\treturn null;\r\n    \t}\r\n    \t\r\n    \tpublic static String decrypt(String strToDecrypt, String SECRET_KEY, String SALT) {\r\n    \t\ttry {\r\n    \t\t\tbyte[] iv = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};\r\n    \t\t\tIvParameterSpec ivspec = new IvParameterSpec(iv);\r\n    \t\t\tSecretKeyFactory factory = SecretKeyFactory.getInstance(&quot;PBKDF2WithHmacSHA256&quot;);\r\n    \t\t\tKeySpec spec = new PBEKeySpec(SECRET_KEY.toCharArray(), SALT.getBytes(), 65536, 256);\r\n    \t\t\tSecretKey tmp = factory.generateSecret(spec);\r\n    \t\t\tSecretKeySpec secretKey = new SecretKeySpec(tmp.getEncoded(), &quot;AES&quot;);\r\n    \t\t\tCipher cipher = Cipher.getInstance(&quot;AES/CBC/PKCS5PADDING&quot;);\r\n    \t\t\tcipher.init(Cipher.DECRYPT_MODE, secretKey, ivspec);\r\n    \t\t\treturn new String(cipher.doFinal(Base64.getDecoder().decode(strToDecrypt)));\r\n    \t\t} catch (Exception e) {\r\n    \t\t\tSystem.out.println(&quot;Error while decrypting: &quot; + e.toString());\r\n    \t\t}\r\n    \t\treturn null;\r\n    \t}\r\n    \t\r\n    \t///\r\n        public static void main(String args[]) {\r\n          \r\n    \t\tString originalString = &quot;test123_XXX&quot;;\r\n    \t\tString SECRET_KEY = &quot;431.396&quot;;\r\n    \t    String SALT = &quot;d413321c765f563c8288ce281ae6808d&quot;;\r\n    \t\t \r\n    \t    String encryptedString = AES.encrypt(originalString, SECRET_KEY, SALT);\r\n    \t\tString encryptedStringHex = Hex.encodeHexString(encryptedString.getBytes());\r\n    \t    String decryptedString = AES.decrypt(encryptedString, SECRET_KEY, SALT);\r\n    \t\r\n    \t\tSystem.out.println(&quot;SECRET_KEY: &quot; + SECRET_KEY);\r\n    \t\tSystem.out.println(&quot;SALT: &quot; + SALT);\r\n    \t\tSystem.out.println(&quot;originalString: &quot; + originalString);\r\n    \t\tSystem.out.println(&quot;encryptedString: &quot; + encryptedString);\r\n    \t    System.out.println(&quot;encryptedStringHex: &quot; + encryptedStringHex);\r\n    \t\tSystem.out.println(&quot;decryptedString: &quot; + decryptedString);\r\n        }\r\n    }\r\n\r\nHere is the complete Javascript code I am using:\r\n\r\n&lt;!-- begin snippet: js hide: false console: true babel: false --&gt;\r\n\r\n&lt;!-- language: lang-js --&gt;\r\n\r\n    var SECRET_KEY = &quot;431.396&quot;;\r\n    var SALT = &quot;d413321c765f563c8288ce281ae6808d&quot;;\r\n    var originalString = &quot;test123_XXX&quot;;\r\n\r\n    var iv = &#39;0000000000000000&#39;;\r\n    iv = CryptoJS.enc.Hex.parse(iv);\r\n\r\n    var iterations = 65536;\r\n    var keySize = 256;\r\n\r\n    function encrypt (msg) {\r\n      \r\n      var key = CryptoJS.PBKDF2(SECRET_KEY, SALT, {\r\n          keySize: keySize/32,\r\n          iterations: iterations\r\n        });\r\n\r\n      var encrypted = CryptoJS.AES.encrypt(msg, key, { \r\n        iv: iv, \r\n        padding: CryptoJS.pad.Pkcs7,\r\n        mode: CryptoJS.mode.CBC,\r\n        hasher: CryptoJS.algo.SHA256\r\n      });\r\n      \r\n      return encrypted;\r\n    }\r\n\r\n    function decrypt (encrypted) {\r\n      \r\n      var key = CryptoJS.PBKDF2(SECRET_KEY, SALT, {\r\n          keySize: keySize/32,\r\n          iterations: iterations\r\n        });\r\n\r\n      var decrypted = CryptoJS.AES.decrypt(encrypted, key, { \r\n        iv: iv, \r\n        padding: CryptoJS.pad.Pkcs7,\r\n        mode: CryptoJS.mode.CBC,\r\n        hasher: CryptoJS.algo.SHA256\r\n      });\r\n      \r\n      return decrypted;\r\n    }\r\n\r\n    var encrypted = encrypt(originalString);\r\n    var encryptedHex = encrypted.ciphertext.toString(CryptoJS.enc.Hex).toUpperCase();\r\n    var decrypted = decrypt(encrypted);\r\n\r\n    console.log(&quot;SECRET_KEY: &quot;+ SECRET_KEY);\r\n    console.log(&quot;SALT: &quot;+ SALT);\r\n    console.log(&quot;originalString: &quot;+ originalString);\r\n    console.log(&quot;Encrypted: &quot;+ encrypted);\r\n    console.log(&quot;encryptedHex: &quot;+ encryptedHex);\r\n    console.log(&quot;Decrypted: &quot;+ decrypted.toString(CryptoJS.enc.Utf8) );\r\n\r\n&lt;!-- language: lang-html --&gt;\r\n\r\n    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js&quot;&gt;&lt;/script&gt;\r\n    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/aes.min.js&quot;&gt;&lt;/script&gt;\r\n    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/enc-hex.min.js&quot;&gt;&lt;/script&gt;\r\n    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/md5.min.js&quot;&gt;&lt;/script&gt;\r\n\r\n&lt;!-- end snippet --&gt;\r\n\r\n","title":"Cannot replicate Encryption AES-CBC (Java) with CryptoJS (Javascript)","body":"<p><strong>Goal:</strong> Replicate Java-AES-CBC Encryption/Decryption with CryptoJS (Javascript)</p>\n<p><em>Why?:</em> Create an Encrypted String (Base64 or HEX) with CryptoJS and decode with Java (different Server env.)</p>\n<p><strong>Problem:</strong> I cannot get the CryptoJS part to produce the same Base64 (or HEX) encoded String as the Java.\nAs an effect, with the current state of code, there is no way for the encryption / decryption to be handed off to separate parties.</p>\n<p>My Java code outputs following:</p>\n<pre><code>SECRET_KEY: 431.396\nSALT: d413321c765f563c8288ce281ae6808d\noriginalString: test123_XXX\nencryptedString: suBMmUzhQMtuAboORtvr6g==\nencryptedStringHex: 7375424d6d557a68514d747541626f4f5274767236673d3d\ndecryptedString: test123_XXX\n</code></pre>\n<p>My Javascript code outputs the following</p>\n<pre><code>[Log] SECRET_KEY: 431.396\n[Log] SALT: d413321c765f563c8288ce281ae6808d\n[Log] originalString: test123_XXX\n[Log] Encrypted: l+R6aYgrQI2+RAIH+X/iJw==\n[Log] encryptedHex: 97E47A69882B408DBE440207F97FE227\n[Log] Decrypted: test123_XXX\n</code></pre>\n<p>Here is the complete Java code I am using:</p>\n<pre><code>import java.io.*;\nimport java.net.HttpURLConnection;\nimport java.net.URL;\nimport java.nio.charset.StandardCharsets;\nimport java.nio.file.Paths;\nimport java.time.LocalDate;\nimport java.util.Arrays;\nimport java.util.Base64;\nimport java.util.Enumeration;\nimport java.util.Iterator;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.Map.Entry;\n\nimport java.security.*;\nimport org.apache.commons.codec.binary.Hex;\n\nimport javax.crypto.Cipher;\nimport javax.crypto.SecretKey;\nimport javax.crypto.SecretKeyFactory;\nimport javax.crypto.spec.IvParameterSpec;\nimport javax.crypto.spec.PBEKeySpec;\nimport javax.crypto.spec.SecretKeySpec;\nimport java.security.spec.KeySpec;\n\n\npublic class AES {\n    \n    public static String encrypt(String strToEncrypt, String SECRET_KEY, String SALT) {\n        try {\n            byte[] iv = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};\n            IvParameterSpec ivspec = new IvParameterSpec(iv);\n            SecretKeyFactory factory = SecretKeyFactory.getInstance(&quot;PBKDF2WithHmacSHA256&quot;);\n            KeySpec spec = new PBEKeySpec(SECRET_KEY.toCharArray(), SALT.getBytes(), 65536, 256);\n            SecretKey tmp = factory.generateSecret(spec);\n            SecretKeySpec secretKey = new SecretKeySpec(tmp.getEncoded(), &quot;AES&quot;);\n            Cipher cipher = Cipher.getInstance(&quot;AES/CBC/PKCS5Padding&quot;);\n            cipher.init(Cipher.ENCRYPT_MODE, secretKey, ivspec);\n            return Base64.getEncoder().encodeToString(cipher.doFinal(strToEncrypt.getBytes(StandardCharsets.UTF_8)));\n        } catch (Exception e) {\n            System.out.println(&quot;Error while encrypting: &quot; + e.toString());\n        }\n        return null;\n    }\n    \n    public static String decrypt(String strToDecrypt, String SECRET_KEY, String SALT) {\n        try {\n            byte[] iv = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};\n            IvParameterSpec ivspec = new IvParameterSpec(iv);\n            SecretKeyFactory factory = SecretKeyFactory.getInstance(&quot;PBKDF2WithHmacSHA256&quot;);\n            KeySpec spec = new PBEKeySpec(SECRET_KEY.toCharArray(), SALT.getBytes(), 65536, 256);\n            SecretKey tmp = factory.generateSecret(spec);\n            SecretKeySpec secretKey = new SecretKeySpec(tmp.getEncoded(), &quot;AES&quot;);\n            Cipher cipher = Cipher.getInstance(&quot;AES/CBC/PKCS5PADDING&quot;);\n            cipher.init(Cipher.DECRYPT_MODE, secretKey, ivspec);\n            return new String(cipher.doFinal(Base64.getDecoder().decode(strToDecrypt)));\n        } catch (Exception e) {\n            System.out.println(&quot;Error while decrypting: &quot; + e.toString());\n        }\n        return null;\n    }\n    \n    ///\n    public static void main(String args[]) {\n      \n        String originalString = &quot;test123_XXX&quot;;\n        String SECRET_KEY = &quot;431.396&quot;;\n        String SALT = &quot;d413321c765f563c8288ce281ae6808d&quot;;\n         \n        String encryptedString = AES.encrypt(originalString, SECRET_KEY, SALT);\n        String encryptedStringHex = Hex.encodeHexString(encryptedString.getBytes());\n        String decryptedString = AES.decrypt(encryptedString, SECRET_KEY, SALT);\n    \n        System.out.println(&quot;SECRET_KEY: &quot; + SECRET_KEY);\n        System.out.println(&quot;SALT: &quot; + SALT);\n        System.out.println(&quot;originalString: &quot; + originalString);\n        System.out.println(&quot;encryptedString: &quot; + encryptedString);\n        System.out.println(&quot;encryptedStringHex: &quot; + encryptedStringHex);\n        System.out.println(&quot;decryptedString: &quot; + decryptedString);\n    }\n}\n</code></pre>\n<p>Here is the complete Javascript code I am using:</p>\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var SECRET_KEY = \"431.396\";\nvar SALT = \"d413321c765f563c8288ce281ae6808d\";\nvar originalString = \"test123_XXX\";\n\nvar iv = '0000000000000000';\niv = CryptoJS.enc.Hex.parse(iv);\n\nvar iterations = 65536;\nvar keySize = 256;\n\nfunction encrypt (msg) {\n  \n  var key = CryptoJS.PBKDF2(SECRET_KEY, SALT, {\n      keySize: keySize/32,\n      iterations: iterations\n    });\n\n  var encrypted = CryptoJS.AES.encrypt(msg, key, { \n    iv: iv, \n    padding: CryptoJS.pad.Pkcs7,\n    mode: CryptoJS.mode.CBC,\n    hasher: CryptoJS.algo.SHA256\n  });\n  \n  return encrypted;\n}\n\nfunction decrypt (encrypted) {\n  \n  var key = CryptoJS.PBKDF2(SECRET_KEY, SALT, {\n      keySize: keySize/32,\n      iterations: iterations\n    });\n\n  var decrypted = CryptoJS.AES.decrypt(encrypted, key, { \n    iv: iv, \n    padding: CryptoJS.pad.Pkcs7,\n    mode: CryptoJS.mode.CBC,\n    hasher: CryptoJS.algo.SHA256\n  });\n  \n  return decrypted;\n}\n\nvar encrypted = encrypt(originalString);\nvar encryptedHex = encrypted.ciphertext.toString(CryptoJS.enc.Hex).toUpperCase();\nvar decrypted = decrypt(encrypted);\n\nconsole.log(\"SECRET_KEY: \"+ SECRET_KEY);\nconsole.log(\"SALT: \"+ SALT);\nconsole.log(\"originalString: \"+ originalString);\nconsole.log(\"Encrypted: \"+ encrypted);\nconsole.log(\"encryptedHex: \"+ encryptedHex);\nconsole.log(\"Decrypted: \"+ decrypted.toString(CryptoJS.enc.Utf8) );</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js\"&gt;&lt;/script&gt;\n&lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/aes.min.js\"&gt;&lt;/script&gt;\n&lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/enc-hex.min.js\"&gt;&lt;/script&gt;\n&lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/md5.min.js\"&gt;&lt;/script&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"},{"tags":["java","mockito"],"comments":[{"owner":{"account_id":39208,"reputation":251240,"user_id":112968,"accept_rate":68,"display_name":"knittl"},"score":0,"creation_date":1694792357,"post_id":77113467,"comment_id":135942273,"body_markdown":"Your test could simply be `assertEquals(1, x.b())` without any mocks.","body":"Your test could simply be <code>assertEquals(1, x.b())</code> without any mocks."},{"owner":{"account_id":202552,"reputation":12096,"user_id":449693,"accept_rate":58,"display_name":"Tony Ennis"},"score":0,"creation_date":1694792541,"post_id":77113467,"comment_id":135942303,"body_markdown":"@knittl this is a boiled-down example.","body":"@knittl this is a boiled-down example."},{"owner":{"account_id":39208,"reputation":251240,"user_id":112968,"accept_rate":68,"display_name":"knittl"},"score":2,"creation_date":1694792602,"post_id":77113467,"comment_id":135942318,"body_markdown":"What are you really testing, if you are changing the behavior of your thing under test? Are you testing your real thing or are you testing an almost-real-but-not-quite version of it?","body":"What are you really testing, if you are changing the behavior of your thing under test? Are you testing your real thing or are you testing an almost-real-but-not-quite version of it?"},{"owner":{"account_id":202552,"reputation":12096,"user_id":449693,"accept_rate":58,"display_name":"Tony Ennis"},"score":0,"creation_date":1694792727,"post_id":77113467,"comment_id":135942336,"body_markdown":"In reality `a()` is has a static reference that really should be injected instead. But this is legacy code and plenty of it, and I want to write a test without refactoring the world.  I am indeed testing `b()`&#39;s behavior.","body":"In reality <code>a()</code> is has a static reference that really should be injected instead. But this is legacy code and plenty of it, and I want to write a test without refactoring the world.  I am indeed testing <code>b()</code>&#39;s behavior."}],"answers":[{"tags":[],"owner":{"account_id":19118721,"reputation":6319,"user_id":13963086,"display_name":"k314159"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1694793691,"creation_date":1694793691,"answer_id":77113823,"question_id":77113467,"body_markdown":"Best practices say you should either mock an object entirely or not at all. Thus, Mockito mocks every single method of the mocked object. If you want to mock only some methods, you have to tell it which methods you _don&#39;t_ want to mock:\r\n\r\n    when (x.a()).thenReturn(100);\r\n    when (x.b()).thenCallRealMethod();\r\n\r\nThis is called a partial mock. Read more about it in section 16 of the [Javadoc](https://javadoc.io/doc/org.mockito/mockito-core/latest/org/mockito/Mockito.html).","title":"mock a method that is called by another method","body":"<p>Best practices say you should either mock an object entirely or not at all. Thus, Mockito mocks every single method of the mocked object. If you want to mock only some methods, you have to tell it which methods you <em>don't</em> want to mock:</p>\n<pre><code>when (x.a()).thenReturn(100);\nwhen (x.b()).thenCallRealMethod();\n</code></pre>\n<p>This is called a partial mock. Read more about it in section 16 of the <a href=\"https://javadoc.io/doc/org.mockito/mockito-core/latest/org/mockito/Mockito.html\" rel=\"nofollow noreferrer\">Javadoc</a>.</p>\n"},{"tags":[],"owner":{"account_id":6518557,"reputation":2810,"user_id":5043481,"display_name":"zforgo"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1694794706,"creation_date":1694794706,"answer_id":77113946,"question_id":77113467,"body_markdown":"Mockito has to be configured to use partial mocking aproach.\r\n\r\nThe class has to be tested:\r\n\r\n```java\r\npublic class Something {\r\n\r\n    protected int a() {\r\n        return 1;\r\n    }\r\n\r\n    protected int b() {\r\n        return a();\r\n    }\r\n}\r\n```\r\n\r\n### Solution A - Using mock()\r\n\r\n```java\r\nclass SomethingTest {\r\n\r\n    @Test\r\n    void mockTest() {\r\n        var mock = mock(Something.class);\r\n\r\n        when(mock.a()).thenReturn(100); // mocking method call a()\r\n        when(mock.b()).thenCallRealMethod(); // call the real implementation\r\n        assertEquals(100, mock.b());\r\n        assertEquals(100, mock.a());\r\n    }\r\n}\r\n```\r\n\r\n### Solution B - Using spy()\r\n\r\nSpied object calls the real methods unless they are stubbed.\r\n\r\n```java\r\nclass SomethingTest {\r\n\r\n    @Test\r\n    void spyTest() {\r\n        var spy = spy(Something.class);\r\n        when(spy.a()).thenReturn(100);\r\n        assertEquals(100, spy.b());\r\n        assertEquals(100, spy.a());\r\n    }\r\n}\r\n``` ","title":"mock a method that is called by another method","body":"<p>Mockito has to be configured to use partial mocking aproach.</p>\n<p>The class has to be tested:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Something {\n\n    protected int a() {\n        return 1;\n    }\n\n    protected int b() {\n        return a();\n    }\n}\n</code></pre>\n<h3>Solution A - Using mock()</h3>\n<pre class=\"lang-java prettyprint-override\"><code>class SomethingTest {\n\n    @Test\n    void mockTest() {\n        var mock = mock(Something.class);\n\n        when(mock.a()).thenReturn(100); // mocking method call a()\n        when(mock.b()).thenCallRealMethod(); // call the real implementation\n        assertEquals(100, mock.b());\n        assertEquals(100, mock.a());\n    }\n}\n</code></pre>\n<h3>Solution B - Using spy()</h3>\n<p>Spied object calls the real methods unless they are stubbed.</p>\n<pre class=\"lang-java prettyprint-override\"><code>class SomethingTest {\n\n    @Test\n    void spyTest() {\n        var spy = spy(Something.class);\n        when(spy.a()).thenReturn(100);\n        assertEquals(100, spy.b());\n        assertEquals(100, spy.a());\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":202552,"reputation":12096,"user_id":449693,"accept_rate":58,"display_name":"Tony Ennis"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":41,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":2,"score":1,"last_activity_date":1694794706,"creation_date":1694790343,"question_id":77113467,"body_markdown":"my class\r\n\r\n    class X {\r\n        protected int a() { return 1; }\r\n        protected int b() { return a(); }\r\n    }\r\n\r\nMy test code\r\n\r\n    X x = mock(X.class)\r\n    when (x.a()).thenReturn(100);\r\n    // System.out.println(x.a());\r\n    assertEquals(100, x.b());\r\n\r\nThe assert fails as `a()` from within `b()` is still returning 1.\r\nif I uncomment the debug line, 100 is printed. But the assert still fails with a 1.\r\n\r\nWhat am I doing wrong here?  I expected `x.a()` to return 100 in all cases, not only when I call it directly.","title":"mock a method that is called by another method","body":"<p>my class</p>\n<pre><code>class X {\n    protected int a() { return 1; }\n    protected int b() { return a(); }\n}\n</code></pre>\n<p>My test code</p>\n<pre><code>X x = mock(X.class)\nwhen (x.a()).thenReturn(100);\n// System.out.println(x.a());\nassertEquals(100, x.b());\n</code></pre>\n<p>The assert fails as <code>a()</code> from within <code>b()</code> is still returning 1.\nif I uncomment the debug line, 100 is printed. But the assert still fails with a 1.</p>\n<p>What am I doing wrong here?  I expected <code>x.a()</code> to return 100 in all cases, not only when I call it directly.</p>\n"},{"tags":["java","camunda"],"answers":[{"tags":[],"owner":{"account_id":4946825,"reputation":1577,"user_id":3981961,"display_name":"thorben"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1459945966,"creation_date":1459945966,"answer_id":36451301,"question_id":36446945,"body_markdown":"For explanation, I assume there is a context A and context B. These could for example be cluster nodes that run process engines against the same database. We assume, you complete the task in context A, but the resources to process the next task (e.g. a `JavaDelegate` implementation of a service task) are only available in context B.\r\n\r\nBoth ways to resolve the problem that you sketch are valid. Either, you make sure the task is completed in context B. Or you make sure that process execution continues in context B after you have completed the task in context A. \r\n\r\nTo implement the second solution, you can use [asynchronous continuations](https://docs.camunda.org/manual/latest/user-guide/process-engine/transactions-in-processes/#asynchronous-continuations). In particular, on the `userTask` element in the BPMN XML you can set the attribute `camunda:asyncAfter=&quot;true&quot;`. When the task is completed in context A, process execution continues until the activity instance of the user task has been completed. Instead of continuing execution at follow-up activities immediately, the process engine persists a job in the database. The job represents the task to continue process execution. It is eventually picked up and executed by the [job executor component](https://docs.camunda.org/manual/latest/user-guide/process-engine/the-job-executor/). Assuming that the job executor runs in context B, it will be able to resolve the resources correctly.\r\n","title":"Camunda custom tasklist - complete task","body":"<p>For explanation, I assume there is a context A and context B. These could for example be cluster nodes that run process engines against the same database. We assume, you complete the task in context A, but the resources to process the next task (e.g. a <code>JavaDelegate</code> implementation of a service task) are only available in context B.</p>\n\n<p>Both ways to resolve the problem that you sketch are valid. Either, you make sure the task is completed in context B. Or you make sure that process execution continues in context B after you have completed the task in context A. </p>\n\n<p>To implement the second solution, you can use <a href=\"https://docs.camunda.org/manual/latest/user-guide/process-engine/transactions-in-processes/#asynchronous-continuations\" rel=\"nofollow\">asynchronous continuations</a>. In particular, on the <code>userTask</code> element in the BPMN XML you can set the attribute <code>camunda:asyncAfter=\"true\"</code>. When the task is completed in context A, process execution continues until the activity instance of the user task has been completed. Instead of continuing execution at follow-up activities immediately, the process engine persists a job in the database. The job represents the task to continue process execution. It is eventually picked up and executed by the <a href=\"https://docs.camunda.org/manual/latest/user-guide/process-engine/the-job-executor/\" rel=\"nofollow\">job executor component</a>. Assuming that the job executor runs in context B, it will be able to resolve the resources correctly.</p>\n"}],"owner":{"account_id":1748498,"reputation":1914,"user_id":1598149,"accept_rate":50,"display_name":"GregD"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":1191,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1694794428,"creation_date":1459934860,"question_id":36446945,"body_markdown":"As first, I&#39;m new to camunda..\r\nI&#39;ve created a custom tasklist in camunda. \r\nI can claim / unclaim tasks etc and this is working.\r\n\r\nRight now I&#39;d like to complete a certain task, but when I&#39;m calling: \r\n\r\n    public void completeSelectedTask() {\r\n        taskService.complete(selectedTask.getId());\r\n    }\r\n\r\nit seems as if camunda wants to go to the next step in THIS context, instead of the context where the BPMN schema has been deployed and where everything is deployed needed to perform the next step. So I&#39;m getting &quot;classNotFound&quot; exceptions since I&#39;m not having the same classes in my customTasklist.war as in the camundaProcessor.war.. \r\n\r\nHow could I tell camunda to go to the next step in the correct context?! Or am I handeling this wrong and should I always complete the task in the camundaProccessor context?\r\n\r\nSome more information: It&#39;s to complete a userTask, with a form. I currently added to form to customTasklist.war and not camundaProcessor.war (so the out of the box tasklist isn&#39;t working anymore ofcourse since he&#39;s looking for the form in the camundaProcessor.war)","title":"Camunda custom tasklist - complete task","body":"<p>As first, I'm new to camunda..\nI've created a custom tasklist in camunda. \nI can claim / unclaim tasks etc and this is working.</p>\n\n<p>Right now I'd like to complete a certain task, but when I'm calling: </p>\n\n<pre><code>public void completeSelectedTask() {\n    taskService.complete(selectedTask.getId());\n}\n</code></pre>\n\n<p>it seems as if camunda wants to go to the next step in THIS context, instead of the context where the BPMN schema has been deployed and where everything is deployed needed to perform the next step. So I'm getting \"classNotFound\" exceptions since I'm not having the same classes in my customTasklist.war as in the camundaProcessor.war.. </p>\n\n<p>How could I tell camunda to go to the next step in the correct context?! Or am I handeling this wrong and should I always complete the task in the camundaProccessor context?</p>\n\n<p>Some more information: It's to complete a userTask, with a form. I currently added to form to customTasklist.war and not camundaProcessor.war (so the out of the box tasklist isn't working anymore ofcourse since he's looking for the form in the camundaProcessor.war)</p>\n"},{"tags":["java","reflection","overriding"],"comments":[{"owner":{"account_id":3430916,"reputation":3799,"user_id":3059385,"accept_rate":40,"display_name":"Christopher Schneider"},"score":1,"creation_date":1694788834,"post_id":77113262,"comment_id":135941516,"body_markdown":"`@Override` is a source policy type annotation, so no. For you to check an annotation at run time, it has to be marked as a runtime annotation. See [this answer](https://stackoverflow.com/questions/3107970/how-do-different-retention-policies-affect-my-annotations)","body":"<code>@Override</code> is a source policy type annotation, so no. For you to check an annotation at run time, it has to be marked as a runtime annotation. See <a href=\"https://stackoverflow.com/questions/3107970/how-do-different-retention-policies-affect-my-annotations\">this answer</a>"},{"owner":{"account_id":1211967,"reputation":7024,"user_id":1180351,"display_name":"Rob Spoor"},"score":0,"creation_date":1694794418,"post_id":77113262,"comment_id":135942616,"body_markdown":"As said before, you cannot do this through reflection. What you _can_ do is use tools like https://checkstyle.sourceforge.io/index.html with its https://checkstyle.sourceforge.io/checks/annotation/missingoverride.html#MissingOverride rule.","body":"As said before, you cannot do this through reflection. What you <i>can</i> do is use tools like <a href=\"https://checkstyle.sourceforge.io/index.html\" rel=\"nofollow noreferrer\">checkstyle.sourceforge.io/index.html</a> with its <a href=\"https://checkstyle.sourceforge.io/checks/annotation/missingoverride.html#MissingOverride\" rel=\"nofollow noreferrer\">checkstyle.sourceforge.io/checks/annotation/&hellip;</a> rule."},{"owner":{"account_id":1211967,"reputation":7024,"user_id":1180351,"display_name":"Rob Spoor"},"score":0,"creation_date":1694794544,"post_id":77113262,"comment_id":135942637,"body_markdown":"If you want to check that a method overrides another method, you can check the method&#39;s declared class&#39; super class (and further up the chain) to see if a method with the same name and parameter types exists. If you also want to check for interface method implementations you need to go through each interface as well (recursively).","body":"If you want to check that a method overrides another method, you can check the method&#39;s declared class&#39; super class (and further up the chain) to see if a method with the same name and parameter types exists. If you also want to check for interface method implementations you need to go through each interface as well (recursively)."}],"answers":[{"tags":[],"owner":{"account_id":24440940,"reputation":3122,"user_id":18364656,"display_name":"Andrei Lisa"},"down_vote_count":0,"up_vote_count":6,"is_accepted":true,"score":6,"last_activity_date":1694788947,"creation_date":1694788947,"answer_id":77113310,"question_id":77113262,"body_markdown":"If you are going to check `java docs` of annotation you will see that the retention policy is `SOURCE`, not `RUNTIME`, which means the annotation is not present at runtime. Also more details check it [Override][1]\r\n\r\n\r\n  [1]: https://docs.oracle.com/javase/8/docs/api/java/lang/Override.html","title":"Check @Override annotation presence on method","body":"<p>If you are going to check <code>java docs</code> of annotation you will see that the retention policy is <code>SOURCE</code>, not <code>RUNTIME</code>, which means the annotation is not present at runtime. Also more details check it <a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/Override.html\" rel=\"noreferrer\">Override</a></p>\n"}],"owner":{"account_id":23714100,"reputation":45,"user_id":17757908,"display_name":"Ксения Лабутина"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":93,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77113310,"answer_count":1,"score":0,"last_activity_date":1694794370,"creation_date":1694788511,"question_id":77113262,"body_markdown":"I have a java.lang.reflect.Method method and I want to check if it is marked with @Override annotation. \r\n\r\nWas trying to do that with method.isAnnotationPresent(Override.class) but this approach doesn&#39;t applicable for this annotation. Also tried MergedAnnotations.from(method).isPresent() but it also doesn&#39;t return true for my method with @Override. \r\n\r\nIs it possible to check that? ","title":"Check @Override annotation presence on method","body":"<p>I have a java.lang.reflect.Method method and I want to check if it is marked with @Override annotation.</p>\n<p>Was trying to do that with method.isAnnotationPresent(Override.class) but this approach doesn't applicable for this annotation. Also tried MergedAnnotations.from(method).isPresent() but it also doesn't return true for my method with @Override.</p>\n<p>Is it possible to check that?</p>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":892161,"reputation":11512,"user_id":930207,"display_name":"mcfinnigan"},"score":4,"creation_date":1332847236,"post_id":9888508,"comment_id":12612858,"body_markdown":"I use yoda conditions out of preference, for the same reasons you do.","body":"I use yoda conditions out of preference, for the same reasons you do."},{"owner":{"account_id":20816,"reputation":430875,"user_id":50079,"accept_rate":67,"display_name":"Jon"},"score":2,"creation_date":1332847302,"post_id":9888508,"comment_id":12612883,"body_markdown":"Voted to close as not constructive, since from a technical standpoint there is only a slight difference (the one you mention) for which there are reasonable alternatives (explicit `null` check) and therefore the debate invariably degenerates to the comparative merits of style, consistence, readability, etc.","body":"Voted to close as not constructive, since from a technical standpoint there is only a slight difference (the one you mention) for which there are reasonable alternatives (explicit <code>null</code> check) and therefore the debate invariably degenerates to the comparative merits of style, consistence, readability, etc."},{"owner":{"account_id":357454,"reputation":77335,"user_id":697630,"accept_rate":84,"display_name":"Edwin Dalorzo"},"score":1,"creation_date":1332847305,"post_id":9888508,"comment_id":12612885,"body_markdown":"Because we all know that Yoda doesn&#39;t speak good English, perhaps :-)","body":"Because we all know that Yoda doesn&#39;t speak good English, perhaps :-)"},{"owner":{"account_id":1024230,"reputation":120585,"user_id":1033896,"accept_rate":71,"display_name":"hmjd"},"score":0,"creation_date":1332847308,"post_id":9888508,"comment_id":12612886,"body_markdown":"If the question does not really fit here as suggested by the close vote, can it be migrated somewhere more appropriate?","body":"If the question does not really fit here as suggested by the close vote, can it be migrated somewhere more appropriate?"},{"owner":{"account_id":113294,"reputation":54886,"user_id":298455,"accept_rate":100,"display_name":"Nishant"},"score":0,"creation_date":1332847344,"post_id":9888508,"comment_id":12612910,"body_markdown":"http://stackoverflow.com/questions/2349378/new-programming-jargon-you-coined/2430307#2430307","body":"<a href=\"http://stackoverflow.com/questions/2349378/new-programming-jargon-you-coined/2430307#2430307\" title=\"new programming jargon you coined\">stackoverflow.com/questions/2349378/&hellip;</a>"},{"owner":{"account_id":1317657,"reputation":639,"user_id":1264186,"display_name":"Pedro Ferreira"},"score":1,"creation_date":1332847504,"post_id":9888508,"comment_id":12612969,"body_markdown":"Jon, @hmjd asks a very clear question.\nIf its a poor coding style and asks for a justification.\nNot constructive when the question wants to attempt to create a standard?","body":"Jon, @hmjd asks a very clear question. If its a poor coding style and asks for a justification. Not constructive when the question wants to attempt to create a standard?"},{"owner":{"account_id":38201,"reputation":1161,"user_id":109492,"accept_rate":80,"display_name":"Jim"},"score":3,"creation_date":1332847519,"post_id":9888508,"comment_id":12612972,"body_markdown":"Good are Yoda conditions; use them I do. Like them I do.\n\n**if ((null != foo) &amp;&amp; ( ! foo.isEmpty)**","body":"Good are Yoda conditions; use them I do. Like them I do.  <b>if ((null != foo) &amp;&amp; ( ! foo.isEmpty)</b>"},{"owner":{"account_id":20816,"reputation":430875,"user_id":50079,"accept_rate":67,"display_name":"Jon"},"score":0,"creation_date":1332847596,"post_id":9888508,"comment_id":12613002,"body_markdown":"For the record, I almost always *avoid* Yoda conditions because e.g. in this case I would prefer the explicit check: it makes it crystal clear at a glance that you won&#39;t unwittingly hit a null reference. The Yoda style is correct of course, but it&#39;s not as obviously correct.","body":"For the record, I almost always <i>avoid</i> Yoda conditions because e.g. in this case I would prefer the explicit check: it makes it crystal clear at a glance that you won&#39;t unwittingly hit a null reference. The Yoda style is correct of course, but it&#39;s not as obviously correct."},{"owner":{"account_id":20816,"reputation":430875,"user_id":50079,"accept_rate":67,"display_name":"Jon"},"score":0,"creation_date":1332847641,"post_id":9888508,"comment_id":12613016,"body_markdown":"@PedroFerreira: From the description of &quot;not constructive&quot;: *this question will likely solicit opinion, debate, arguments, polling, or extended discussion.*","body":"@PedroFerreira: From the description of &quot;not constructive&quot;: <i>this question will likely solicit opinion, debate, arguments, polling, or extended discussion.</i>"},{"owner":{"account_id":1317657,"reputation":639,"user_id":1264186,"display_name":"Pedro Ferreira"},"score":1,"creation_date":1332849137,"post_id":9888508,"comment_id":12613551,"body_markdown":"Yet it doesnt. The answer is no, it is not a poor coding style.\nYoda is a choice for the reasons i&#39;ve posted below in the answer.","body":"Yet it doesnt. The answer is no, it is not a poor coding style. Yoda is a choice for the reasons i&#39;ve posted below in the answer."}],"answers":[{"tags":[],"owner":{"account_id":84454,"reputation":3183,"user_id":236092,"accept_rate":70,"display_name":"Dennis Laumen"},"down_vote_count":0,"up_vote_count":10,"is_accepted":false,"score":10,"last_activity_date":1332847356,"creation_date":1332847356,"answer_id":9888623,"question_id":9888508,"body_markdown":"Yoda conditions (i.e. putting a constant before a variable in a comparison) can be considered bad practice as it makes the line of code less comprehensible. In this specific case however I would state that using a Yoda condition makes the code more comprehensible as you don&#39;t have to put a extra null check in front of it.","title":"String.equals() argument ordering","body":"<p>Yoda conditions (i.e. putting a constant before a variable in a comparison) can be considered bad practice as it makes the line of code less comprehensible. In this specific case however I would state that using a Yoda condition makes the code more comprehensible as you don't have to put a extra null check in front of it.</p>\n"},{"tags":[],"owner":{"account_id":1317657,"reputation":639,"user_id":1264186,"display_name":"Pedro Ferreira"},"down_vote_count":0,"up_vote_count":9,"is_accepted":false,"score":9,"last_activity_date":1332847397,"creation_date":1332847397,"answer_id":9888633,"question_id":9888508,"body_markdown":"\r\nVisit the following link to understand what is meant by [Yoda Conditions|Notation](http://united-coders.com/christian-harms/what-are-yoda-conditions)\r\n\r\n\r\nIts not a &quot;poor coding style&quot; its diferent way of coding.\r\n\r\nYoda can be usefull to track typos in some languages, i believe the -1 was not deserved to be honest but that is my personal opinion.\r\n\r\nBut [Yoda can be bad](http://pushinginertia.com/2011/05/why-yoda-conditions-are-bad-and-usage-of-javas-final-keyword-is-good/) as explained in this lengthy but very interesting article.\r\n\r\nEnd of the day, there are supporters in favor and against this kinda of notation.","title":"String.equals() argument ordering","body":"<p>Visit the following link to understand what is meant by <a href=\"http://united-coders.com/christian-harms/what-are-yoda-conditions\" rel=\"noreferrer\">Yoda Conditions|Notation</a></p>\n\n<p>Its not a \"poor coding style\" its diferent way of coding.</p>\n\n<p>Yoda can be usefull to track typos in some languages, i believe the -1 was not deserved to be honest but that is my personal opinion.</p>\n\n<p>But <a href=\"http://pushinginertia.com/2011/05/why-yoda-conditions-are-bad-and-usage-of-javas-final-keyword-is-good/\" rel=\"noreferrer\">Yoda can be bad</a> as explained in this lengthy but very interesting article.</p>\n\n<p>End of the day, there are supporters in favor and against this kinda of notation.</p>\n"},{"tags":[],"owner":{"account_id":46475,"reputation":20349,"user_id":137369,"accept_rate":78,"display_name":"Thirler"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1332847455,"creation_date":1332847455,"answer_id":9888647,"question_id":9888508,"body_markdown":"There are several reasons not to do it like that, however in the end it depends on you (or the team working on your product) if you think this is bad coding style. Arguments against it are:\r\n\r\n - Strings are rarely null (and you shouldn&#39;t make APIs where they are because people don&#39;t expect it)\r\n - It feels weird to put the value you are comparing to first\r\n - Code style uniformity is important, because this way is the exception, you should only do it, if everyone in your team does it.\r\n\r\nAs said I don&#39;t think these arguments are very strong, nor is the reason to do it like you. So it is mostly important to just agree on one way as your coding style and stick to that.","title":"String.equals() argument ordering","body":"<p>There are several reasons not to do it like that, however in the end it depends on you (or the team working on your product) if you think this is bad coding style. Arguments against it are:</p>\n\n<ul>\n<li>Strings are rarely null (and you shouldn't make APIs where they are because people don't expect it)</li>\n<li>It feels weird to put the value you are comparing to first</li>\n<li>Code style uniformity is important, because this way is the exception, you should only do it, if everyone in your team does it.</li>\n</ul>\n\n<p>As said I don't think these arguments are very strong, nor is the reason to do it like you. So it is mostly important to just agree on one way as your coding style and stick to that.</p>\n"},{"tags":[],"owner":{"account_id":937281,"reputation":4473,"user_id":965979,"accept_rate":60,"display_name":"mpartel"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1332847506,"creation_date":1332847506,"answer_id":9888661,"question_id":9888508,"body_markdown":"One might argue that you should (unit-)test your code enough to be confident that nulls don&#39;t go where they&#39;re not supposed to. This should obviate the need for yoda conditions.","title":"String.equals() argument ordering","body":"<p>One might argue that you should (unit-)test your code enough to be confident that nulls don't go where they're not supposed to. This should obviate the need for yoda conditions.</p>\n"},{"tags":[],"owner":{"account_id":981311,"reputation":13552,"user_id":1000959,"accept_rate":67,"display_name":"scibuff"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1332847562,"creation_date":1332847562,"answer_id":9888676,"question_id":9888508,"body_markdown":"TL;DR; This definitely is poor coding style NOT :D\r\n\r\nwell, the yoda conditions are useful in languages where non-boolean can evaluate to a boolean value, e.g. \r\n\r\n    int test = 0;\r\n    if ( test ){ /* do something */\r\n\r\nbut this is not allowed in Java so you don&#39;t run into problems such as forgetting &#39;=&#39;, e.g.\r\n\r\n    if ( test = 2 ){ /* do something */\r\n\r\ninstead of `test == 2`\r\n\r\n- the compiler will not let you do this. So the yoda condition may seem unnatural to someone who has not had to care about this (because he/she didn&#39;t use any other language but Java). \r\n\r\nThis definitely is NOT poor coding style it is just not very common to see Java code using it\r\n","title":"String.equals() argument ordering","body":"<p>TL;DR; This definitely is poor coding style NOT :D</p>\n\n<p>well, the yoda conditions are useful in languages where non-boolean can evaluate to a boolean value, e.g. </p>\n\n<pre><code>int test = 0;\nif ( test ){ /* do something */\n</code></pre>\n\n<p>but this is not allowed in Java so you don't run into problems such as forgetting '=', e.g.</p>\n\n<pre><code>if ( test = 2 ){ /* do something */\n</code></pre>\n\n<p>instead of <code>test == 2</code></p>\n\n<ul>\n<li>the compiler will not let you do this. So the yoda condition may seem unnatural to someone who has not had to care about this (because he/she didn't use any other language but Java). </li>\n</ul>\n\n<p>This definitely is NOT poor coding style it is just not very common to see Java code using it</p>\n"},{"tags":[],"owner":{"account_id":305750,"reputation":3099,"user_id":616100,"display_name":"Sibster"},"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1332847636,"creation_date":1332847636,"answer_id":9888695,"question_id":9888508,"body_markdown":"yoda condition is where oup put the  literal in front of the variable.\r\n\r\n\r\nword.equals(&quot;s&quot;) is read as &quot;word equals s&quot;\r\n\r\n&quot;s&quot;.equals(word) a human reads as &quot;s equals word&quot;\r\n\r\nOur brains read the first example much better and the code is clearer.\r\n\r\nthe only reason imho to use yoda conditions is to prevent assignment \r\nas in &quot;if (42 = i)&quot; instead of &quot;if(42 == i)&quot;","title":"String.equals() argument ordering","body":"<p>yoda condition is where oup put the  literal in front of the variable.</p>\n\n<p>word.equals(\"s\") is read as \"word equals s\"</p>\n\n<p>\"s\".equals(word) a human reads as \"s equals word\"</p>\n\n<p>Our brains read the first example much better and the code is clearer.</p>\n\n<p>the only reason imho to use yoda conditions is to prevent assignment \nas in \"if (42 = i)\" instead of \"if(42 == i)\"</p>\n"},{"tags":[],"owner":{"account_id":394499,"reputation":1752,"user_id":756968,"accept_rate":73,"display_name":"bigGuy"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1694762273,"creation_date":1332847740,"answer_id":9888729,"question_id":9888508,"body_markdown":"Well, it depends. If in your program `word` should never be `null`, `word.equals(&quot;s&quot;)` may actually be better. If for some obscure reason `word` will become `null`, you will get `NullPointerException`.\r\nThink about it. If you get exception, you know something went wrong, and you can faster find mistake and fix it. If program will continue to work silently, and produce wrong results, it will be much harder to detect the problem. Actually, you may not notice there is the problem at all.\r\n\r\nIt all depends.","title":"String.equals() argument ordering","body":"<p>Well, it depends. If in your program <code>word</code> should never be <code>null</code>, <code>word.equals(&quot;s&quot;)</code> may actually be better. If for some obscure reason <code>word</code> will become <code>null</code>, you will get <code>NullPointerException</code>.\nThink about it. If you get exception, you know something went wrong, and you can faster find mistake and fix it. If program will continue to work silently, and produce wrong results, it will be much harder to detect the problem. Actually, you may not notice there is the problem at all.</p>\n<p>It all depends.</p>\n"},{"tags":[],"owner":{"account_id":473751,"reputation":19104,"user_id":883033,"accept_rate":63,"display_name":"Chandra Sekhar"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1332851411,"creation_date":1332847973,"answer_id":9888775,"question_id":9888508,"body_markdown":"You can write\r\n\r\n    if (word != null &amp;&amp; (word.equals(&quot;s&quot;) || word.equals(&quot;y&quot;)))\r\n\r\ninstead of\r\n\r\n    if (&quot;s&quot;.equals(word) || &quot;y&quot;.equals(word))\r\n\r\nIn this case, first one will never cause any **NullpointerException**, but in my point of view in this case the 2nd one is better, though it is in **Yoda Condition**","title":"String.equals() argument ordering","body":"<p>You can write</p>\n\n<pre><code>if (word != null &amp;&amp; (word.equals(\"s\") || word.equals(\"y\")))\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>if (\"s\".equals(word) || \"y\".equals(word))\n</code></pre>\n\n<p>In this case, first one will never cause any <strong>NullpointerException</strong>, but in my point of view in this case the 2nd one is better, though it is in <strong>Yoda Condition</strong></p>\n"},{"tags":[],"owner":{"account_id":3282,"reputation":146296,"user_id":4725,"accept_rate":100,"display_name":"Tom Hawtin - tackline"},"down_vote_count":1,"up_vote_count":37,"is_accepted":true,"score":36,"last_activity_date":1332848405,"creation_date":1332848405,"answer_id":9888867,"question_id":9888508,"body_markdown":"Bill Pugh asked this question at Devoxx 2011. The vast majority of people went for the form `&quot;xyz&quot;.equals(str)`. I am with Bill, now preferring `str.equals(&quot;xyz&quot;)`.\r\n\r\nIt&#39;s fundamental to the Java tradition that we find errors as early as reasonably possible. NPEs are exceptionally common. We want to route these nulls out as soon as possible.\r\n\r\nIf you&#39;re expecting the reference to maybe `null`, then I don&#39;t particularly object to the backwards notation. It&#39;s nice to be explicit and easier to understand that there may be a `null` with a separate `null` check, but the reverse order should be well understood and sufficiently differentiate the code from the normal case where `null` is forbidden.\r\n\r\nWorking in security, some of the bugs null-tolerance accommodates are vulnerabilities. ","title":"String.equals() argument ordering","body":"<p>Bill Pugh asked this question at Devoxx 2011. The vast majority of people went for the form <code>\"xyz\".equals(str)</code>. I am with Bill, now preferring <code>str.equals(\"xyz\")</code>.</p>\n\n<p>It's fundamental to the Java tradition that we find errors as early as reasonably possible. NPEs are exceptionally common. We want to route these nulls out as soon as possible.</p>\n\n<p>If you're expecting the reference to maybe <code>null</code>, then I don't particularly object to the backwards notation. It's nice to be explicit and easier to understand that there may be a <code>null</code> with a separate <code>null</code> check, but the reverse order should be well understood and sufficiently differentiate the code from the normal case where <code>null</code> is forbidden.</p>\n\n<p>Working in security, some of the bugs null-tolerance accommodates are vulnerabilities. </p>\n"},{"tags":[],"owner":{"account_id":261142,"reputation":47118,"user_id":545127,"accept_rate":69,"display_name":"Raedwald"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1332853836,"creation_date":1332853836,"answer_id":9890196,"question_id":9888508,"body_markdown":"There is a special case pf Yoda conditional I&#39;ve not seen defended, or attacked, in any of the answers, so I&#39;ll add it for reference. This is the style of:\r\n\r\n     if(0 &lt; x &amp;&amp; x &lt;= max) {\r\n\r\nA Yoda conditional because the constant (`0`) is before the variable (`x`). The argument against Yoda conditionals is that is hinders readability. Contrast that example with the functionally equivalent\r\n\r\n     if(x &lt;= max &amp;&amp; x &gt; 0) {\r\n\r\nDo you really think that, non-Yoda variant, is more readable? I don&#39;t.\r\n\r\nFor readability when using ordering relational operators (&lt;, &lt;=, &gt;, &gt;=), I prefer the style of these heuristics:\r\n\r\n* Use consistent ordering relations: &gt; is consistent with &gt;=, but not with &lt; or &lt;=; &lt; is consistent with &lt;=.\r\n* Prefer &lt; and &lt;= to &gt; and &gt;=, as the default is ascending order.\r\n* Place conditions that impose a lower bound on the variable before conditions that impose an upper bound, if using &lt; and &lt;=. Do the opposite if using &gt; and &gt;=.\r\n\r\nThis very often produces a Yoda conditional for the lower bound.","title":"String.equals() argument ordering","body":"<p>There is a special case pf Yoda conditional I've not seen defended, or attacked, in any of the answers, so I'll add it for reference. This is the style of:</p>\n\n<pre><code> if(0 &lt; x &amp;&amp; x &lt;= max) {\n</code></pre>\n\n<p>A Yoda conditional because the constant (<code>0</code>) is before the variable (<code>x</code>). The argument against Yoda conditionals is that is hinders readability. Contrast that example with the functionally equivalent</p>\n\n<pre><code> if(x &lt;= max &amp;&amp; x &gt; 0) {\n</code></pre>\n\n<p>Do you really think that, non-Yoda variant, is more readable? I don't.</p>\n\n<p>For readability when using ordering relational operators (&lt;, &lt;=, >, >=), I prefer the style of these heuristics:</p>\n\n<ul>\n<li>Use consistent ordering relations: > is consistent with >=, but not with &lt; or &lt;=; &lt; is consistent with &lt;=.</li>\n<li>Prefer &lt; and &lt;= to > and >=, as the default is ascending order.</li>\n<li>Place conditions that impose a lower bound on the variable before conditions that impose an upper bound, if using &lt; and &lt;=. Do the opposite if using > and >=.</li>\n</ul>\n\n<p>This very often produces a Yoda conditional for the lower bound.</p>\n"}],"owner":{"account_id":1024230,"reputation":120585,"user_id":1033896,"accept_rate":71,"display_name":"hmjd"},"comment_count":10,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":6371,"favorite_count":0,"down_vote_count":1,"up_vote_count":27,"closed_date":1694794686,"accepted_answer_id":9888867,"answer_count":10,"score":26,"last_activity_date":1694794164,"creation_date":1332846858,"question_id":9888508,"body_markdown":"I recently received a downvote for using the following in a recent [answer](https://stackoverflow.com/questions/9870985/if-condition-does-not-work/9870998#9870998):\r\n\r\n    String word = ...;\r\n    if (&quot;s&quot;.equals(word) || &quot;y&quot;.equals(word))\r\n\r\nThe downvote was given due to using the _[Yoda condition][1]_. I asked for further explanation but none was provided. I prefer this style to avoid a possible `NullPointerException`.\r\n\r\nIs this a poor coding style? If so, why?\r\n\r\n\r\n  [1]: https://en.wikipedia.org/wiki/Yoda_conditions","title":"String.equals() argument ordering","body":"<p>I recently received a downvote for using the following in a recent <a href=\"https://stackoverflow.com/questions/9870985/if-condition-does-not-work/9870998#9870998\">answer</a>:</p>\n<pre><code>String word = ...;\nif (&quot;s&quot;.equals(word) || &quot;y&quot;.equals(word))\n</code></pre>\n<p>The downvote was given due to using the <em><a href=\"https://en.wikipedia.org/wiki/Yoda_conditions\" rel=\"nofollow noreferrer\">Yoda condition</a></em>. I asked for further explanation but none was provided. I prefer this style to avoid a possible <code>NullPointerException</code>.</p>\n<p>Is this a poor coding style? If so, why?</p>\n"},{"tags":["java","postgresql","hibernate","orm"],"owner":{"account_id":7058459,"reputation":445,"user_id":5404771,"accept_rate":89,"display_name":"Tim"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":26,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694794021,"creation_date":1694794021,"question_id":77113865,"body_markdown":"I have the following hibernate structure: \r\n\r\nA decision has by definition some parameters that define the possible inputs and outputs. A decision also has one or more rules and each rule has some decision rule input parameters and output parameters that are linked to the decision parameters:\r\n\r\n    public class Decision {\r\n\r\n       @Column(name = &quot;name&quot;, nullable = false)\r\n       private String name;\r\n\r\n       @OneToMany(mappedBy = &quot;decision&quot;, cascade = CascadeType.ALL, orphanRemoval = true)\r\n       private List&lt;DecisionParameter&gt; parameters = new ArrayList&lt;&gt;();\r\n\r\n       @OneToMany(cascade = CascadeType.ALL, fetch = FetchType.LAZY, mappedBy = &quot;decision&quot;, orphanRemoval = true)\r\n       private List&lt;DecisionRule&gt; rules = new ArrayList&lt;&gt;();\r\n    \r\n    }\r\n\r\n    public class DecisionParameter {\r\n\r\n       @ManyToOne(fetch = FetchType.LAZY)\r\n       @JoinColumn(name = &quot;decision_id&quot;, table = &quot;decision_parameter&quot;, nullable = false,\r\n            foreignKey = @ForeignKey(name = &quot;fk_decision_parameter_decision_id&quot;))\r\n       private Decision decision;\r\n\r\n    }\r\n\r\n    public class DecisionRule {\r\n\r\n       @OneToMany(mappedBy = &quot;decisionRule&quot;, cascade = CascadeType.ALL, orphanRemoval = true)\r\n       @Where(clause = &quot;type = 1&quot;)\r\n       private List&lt;DecisionRuleParameter&gt; inputs = new ArrayList&lt;&gt;();\r\n\r\n       @OneToMany(mappedBy = &quot;decisionRule&quot;, cascade = CascadeType.ALL, orphanRemoval = true)\r\n       @Where(clause = &quot;type = 2&quot;)\r\n       private List&lt;DecisionRuleParameter&gt; outputs = new ArrayList&lt;&gt;();\r\n\r\n       @ManyToOne(fetch = FetchType.LAZY)\r\n       @JoinColumn(name = &quot;decision_id&quot;, foreignKey = @ForeignKey(name = &quot;fk_decision_item_decision_id&quot;))\r\n       private Decision decision;\r\n\r\n    }\r\n\r\n    public class DecisionRuleParameter {\r\n\r\n       @ManyToOne(fetch = FetchType.LAZY)\r\n       @JoinColumn(name = &quot;decision_parameter_id&quot;, nullable = false, foreignKey = @ForeignKey(name = &quot;fk_decision_paramater_decision_parameter_id&quot;))\r\n       private DecisionParameter decisionParameter;\r\n\r\n       @ManyToOne(fetch = FetchType.LAZY)\r\n       @JoinColumn(name = &quot;decision_rule_id&quot;, foreignKey = @ForeignKey(name = &quot;fk_decision_rule_decision_rule_id&quot;))\r\n       private DecisionRule decisionRule;\r\n\r\n    }\r\n\r\n    @DiscriminatorValue(&quot;1&quot;)\r\n    public class DecisionRuleInputParameter extends DecisionRuleParameter {\r\n       ...\r\n    }\r\n\r\n    @DiscriminatorValue(&quot;2&quot;)\r\n    public class DecisionRuleOutputParameter extends DecisionRuleParameter {\r\n       ...\r\n    }\r\n\r\n\r\nWhen I try to delete a `decision` object:\r\n\r\n\r\nhibernate updates the decision rule parameters by setting the decision_parameter_id to null\r\n\r\n    update model.decision_rule_parameter set decision_parameter_id = NULL where id = ...\r\n\r\ntiggering a not null constraint:\r\n\r\n    ERROR: null value in column &quot;decision_parameter_id&quot; of relation &quot;decision_rule_parameter&quot; violates not-null constraint\r\n\r\nWhy does this happen and how can I make sure that hibernates does not set the id to null? I do not want to remove the not null constraint.","title":"Java hibernate delete fails due to update entity not null constraint","body":"<p>I have the following hibernate structure:</p>\n<p>A decision has by definition some parameters that define the possible inputs and outputs. A decision also has one or more rules and each rule has some decision rule input parameters and output parameters that are linked to the decision parameters:</p>\n<pre><code>public class Decision {\n\n   @Column(name = &quot;name&quot;, nullable = false)\n   private String name;\n\n   @OneToMany(mappedBy = &quot;decision&quot;, cascade = CascadeType.ALL, orphanRemoval = true)\n   private List&lt;DecisionParameter&gt; parameters = new ArrayList&lt;&gt;();\n\n   @OneToMany(cascade = CascadeType.ALL, fetch = FetchType.LAZY, mappedBy = &quot;decision&quot;, orphanRemoval = true)\n   private List&lt;DecisionRule&gt; rules = new ArrayList&lt;&gt;();\n\n}\n\npublic class DecisionParameter {\n\n   @ManyToOne(fetch = FetchType.LAZY)\n   @JoinColumn(name = &quot;decision_id&quot;, table = &quot;decision_parameter&quot;, nullable = false,\n        foreignKey = @ForeignKey(name = &quot;fk_decision_parameter_decision_id&quot;))\n   private Decision decision;\n\n}\n\npublic class DecisionRule {\n\n   @OneToMany(mappedBy = &quot;decisionRule&quot;, cascade = CascadeType.ALL, orphanRemoval = true)\n   @Where(clause = &quot;type = 1&quot;)\n   private List&lt;DecisionRuleParameter&gt; inputs = new ArrayList&lt;&gt;();\n\n   @OneToMany(mappedBy = &quot;decisionRule&quot;, cascade = CascadeType.ALL, orphanRemoval = true)\n   @Where(clause = &quot;type = 2&quot;)\n   private List&lt;DecisionRuleParameter&gt; outputs = new ArrayList&lt;&gt;();\n\n   @ManyToOne(fetch = FetchType.LAZY)\n   @JoinColumn(name = &quot;decision_id&quot;, foreignKey = @ForeignKey(name = &quot;fk_decision_item_decision_id&quot;))\n   private Decision decision;\n\n}\n\npublic class DecisionRuleParameter {\n\n   @ManyToOne(fetch = FetchType.LAZY)\n   @JoinColumn(name = &quot;decision_parameter_id&quot;, nullable = false, foreignKey = @ForeignKey(name = &quot;fk_decision_paramater_decision_parameter_id&quot;))\n   private DecisionParameter decisionParameter;\n\n   @ManyToOne(fetch = FetchType.LAZY)\n   @JoinColumn(name = &quot;decision_rule_id&quot;, foreignKey = @ForeignKey(name = &quot;fk_decision_rule_decision_rule_id&quot;))\n   private DecisionRule decisionRule;\n\n}\n\n@DiscriminatorValue(&quot;1&quot;)\npublic class DecisionRuleInputParameter extends DecisionRuleParameter {\n   ...\n}\n\n@DiscriminatorValue(&quot;2&quot;)\npublic class DecisionRuleOutputParameter extends DecisionRuleParameter {\n   ...\n}\n</code></pre>\n<p>When I try to delete a <code>decision</code> object:</p>\n<p>hibernate updates the decision rule parameters by setting the decision_parameter_id to null</p>\n<pre><code>update model.decision_rule_parameter set decision_parameter_id = NULL where id = ...\n</code></pre>\n<p>tiggering a not null constraint:</p>\n<pre><code>ERROR: null value in column &quot;decision_parameter_id&quot; of relation &quot;decision_rule_parameter&quot; violates not-null constraint\n</code></pre>\n<p>Why does this happen and how can I make sure that hibernates does not set the id to null? I do not want to remove the not null constraint.</p>\n"},{"tags":["java","spring-boot","spring-boot-test","testcontainers"],"comments":[{"owner":{"account_id":3356208,"reputation":3145,"user_id":5775077,"display_name":"P3trur0"},"score":0,"creation_date":1592385672,"post_id":62425598,"comment_id":110404032,"body_markdown":"Did you try the withReuse(true) option?","body":"Did you try the withReuse(true) option?"},{"owner":{"account_id":435063,"reputation":4304,"user_id":821436,"accept_rate":79,"display_name":"Martin Schr&#246;der"},"score":0,"creation_date":1592386483,"post_id":62425598,"comment_id":110404438,"body_markdown":"@P3trur0: Yes. And `testcontainers.reuse.enable=true` - doesn&#39;t help.","body":"@P3trur0: Yes. And <code>testcontainers.reuse.enable=true</code> - doesn&#39;t help."},{"owner":{"account_id":2563377,"reputation":7174,"user_id":2224047,"display_name":"Nikolai  Shevchenko"},"score":0,"creation_date":1592388179,"post_id":62425598,"comment_id":110405274,"body_markdown":"Try to place container instance into separate `@TestConfiguration` as a `@Bean` and then import this configuration in all your relevant tests.","body":"Try to place container instance into separate <code>@TestConfiguration</code> as a <code>@Bean</code> and then import this configuration in all your relevant tests."},{"owner":{"account_id":435063,"reputation":4304,"user_id":821436,"accept_rate":79,"display_name":"Martin Schr&#246;der"},"score":0,"creation_date":1592393704,"post_id":62425598,"comment_id":110407946,"body_markdown":"@NikolaiShevchenko: Tried that, but it&#39;s needed in the `@ContextConfiguration(initializers` and I can&#39;t get it to work there.","body":"@NikolaiShevchenko: Tried that, but it&#39;s needed in the <code>@ContextConfiguration(initializers</code> and I can&#39;t get it to work there."}],"answers":[{"tags":[],"owner":{"account_id":11732873,"reputation":734,"user_id":8587732,"display_name":"Vitaly Chura"},"down_vote_count":4,"up_vote_count":1,"is_accepted":false,"score":-3,"last_activity_date":1592411316,"creation_date":1592411316,"answer_id":62433814,"question_id":62425598,"body_markdown":"I&#39;m not sure how `@Testcontainers` works, but I suspect it might work per class. \r\n\r\nJust make your singleton static as described in [Singleton pattern][1]\r\nand get it in every test from your signleton holder, don&#39;t define it in every test class.\r\n\r\n  [1]: https://www.testcontainers.org/test_framework_integration/manual_lifecycle_control/","title":"How to reuse Testcontainers between multiple SpringBootTests?","body":"<p>I'm not sure how <code>@Testcontainers</code> works, but I suspect it might work per class. </p>\n\n<p>Just make your singleton static as described in <a href=\"https://www.testcontainers.org/test_framework_integration/manual_lifecycle_control/\" rel=\"nofollow noreferrer\">Singleton pattern</a>\nand get it in every test from your signleton holder, don't define it in every test class.</p>\n"},{"tags":[],"owner":{"account_id":12480263,"reputation":10843,"user_id":9085273,"display_name":"rieckpil"},"down_vote_count":1,"up_vote_count":70,"is_accepted":true,"score":69,"last_activity_date":1592731802,"creation_date":1592459718,"answer_id":62443261,"question_id":62425598,"body_markdown":"You can&#39;t use the JUnit Jupiter annotation `@Container` if you want to have reusable containers. This annotation ensures to stop the container [after each test][1]. \r\n\r\nWhat you need is the singleton container approach, and use e.g. `@BeforeAll` to start your containers. Even though you then have `.start()` in multiple tests, Testcontainers won&#39;t start a new container if you opted-in for reusability using both `.withReuse(true)` on your container definition AND the following `.testcontainers.properties` file in your home directory:\r\n\r\n    testcontainers.reuse.enable=true\r\n\r\nA simple example might look like the following:\r\n\r\n    @SpringBootTest\r\n    public class SomeIT {\r\n    \r\n      public static GenericContainer postgreSQLContainer = new PostgreSQLContainer().\r\n        withReuse(true);\r\n    \r\n      @BeforeAll\r\n      public static void beforeAll() {\r\n        postgreSQLContainer.start();\r\n      }\r\n    \r\n      @Test\r\n      public void test() {\r\n    \r\n      }\r\n    \r\n    }\r\n\r\nand another integration test:\r\n\r\n    @SpringBootTest\r\n    public class SecondIT {\r\n    \r\n      public static GenericContainer postgreSQLContainer = new PostgreSQLContainer().\r\n        withReuse(true);\r\n    \r\n      @BeforeAll\r\n      public static void beforeAll() {\r\n        postgreSQLContainer.start();\r\n      }\r\n\r\n      @Test\r\n      public void secondTest() {\r\n\r\n      }\r\n    \r\n    }\r\n\r\nThere is currently a [PR that adds documentation][2] about this\r\n\r\nI&#39;ve put together a blog post explaining [how to reuse containers with Testcontainers][3] in detail.\r\n\r\n\r\n  [1]: https://github.com/testcontainers/testcontainers-java/issues/2352\r\n  [2]: https://github.com/testcontainers/testcontainers-java/pull/2555\r\n  [3]: https://rieckpil.de/reuse-containers-with-testcontainers-for-fast-integration-tests/","title":"How to reuse Testcontainers between multiple SpringBootTests?","body":"<p>You can't use the JUnit Jupiter annotation <code>@Container</code> if you want to have reusable containers. This annotation ensures to stop the container <a href=\"https://github.com/testcontainers/testcontainers-java/issues/2352\" rel=\"noreferrer\">after each test</a>.</p>\n<p>What you need is the singleton container approach, and use e.g. <code>@BeforeAll</code> to start your containers. Even though you then have <code>.start()</code> in multiple tests, Testcontainers won't start a new container if you opted-in for reusability using both <code>.withReuse(true)</code> on your container definition AND the following <code>.testcontainers.properties</code> file in your home directory:</p>\n<pre><code>testcontainers.reuse.enable=true\n</code></pre>\n<p>A simple example might look like the following:</p>\n<pre><code>@SpringBootTest\npublic class SomeIT {\n\n  public static GenericContainer postgreSQLContainer = new PostgreSQLContainer().\n    withReuse(true);\n\n  @BeforeAll\n  public static void beforeAll() {\n    postgreSQLContainer.start();\n  }\n\n  @Test\n  public void test() {\n\n  }\n\n}\n</code></pre>\n<p>and another integration test:</p>\n<pre><code>@SpringBootTest\npublic class SecondIT {\n\n  public static GenericContainer postgreSQLContainer = new PostgreSQLContainer().\n    withReuse(true);\n\n  @BeforeAll\n  public static void beforeAll() {\n    postgreSQLContainer.start();\n  }\n\n  @Test\n  public void secondTest() {\n\n  }\n\n}\n</code></pre>\n<p>There is currently a <a href=\"https://github.com/testcontainers/testcontainers-java/pull/2555\" rel=\"noreferrer\">PR that adds documentation</a> about this</p>\n<p>I've put together a blog post explaining <a href=\"https://rieckpil.de/reuse-containers-with-testcontainers-for-fast-integration-tests/\" rel=\"noreferrer\">how to reuse containers with Testcontainers</a> in detail.</p>\n"},{"tags":[],"owner":{"account_id":9532081,"reputation":166,"user_id":16585344,"display_name":"brneto"},"down_vote_count":0,"up_vote_count":9,"is_accepted":false,"score":9,"last_activity_date":1627995516,"creation_date":1627995516,"answer_id":68636519,"question_id":62425598,"body_markdown":"If you decide go forward with the [singleton pattern][2], mind the warning in &quot;[Database containers launched via JDBC URL scheme][1]&quot;. I took hours till I note that, even though I was using the [singleton pattern][2], an additional container was always being created mapped on a different port.\r\n\r\nIn summary, do not use the test containers JDBC (host-less) URIs, such as `jdbc:tc:postgresql:&lt;image-tag&gt;:///&lt;databasename&gt;`, if you need use the [singleton pattern][2].\r\n\r\n\r\n  [1]: https://www.testcontainers.org/modules/databases/jdbc/#database-containers-launched-via-jdbc-url-scheme\r\n  [2]: https://www.testcontainers.org/test_framework_integration/manual_lifecycle_control/#singleton-containers","title":"How to reuse Testcontainers between multiple SpringBootTests?","body":"<p>If you decide go forward with the <a href=\"https://www.testcontainers.org/test_framework_integration/manual_lifecycle_control/#singleton-containers\" rel=\"noreferrer\">singleton pattern</a>, mind the warning in &quot;<a href=\"https://www.testcontainers.org/modules/databases/jdbc/#database-containers-launched-via-jdbc-url-scheme\" rel=\"noreferrer\">Database containers launched via JDBC URL scheme</a>&quot;. I took hours till I note that, even though I was using the <a href=\"https://www.testcontainers.org/test_framework_integration/manual_lifecycle_control/#singleton-containers\" rel=\"noreferrer\">singleton pattern</a>, an additional container was always being created mapped on a different port.</p>\n<p>In summary, do not use the test containers JDBC (host-less) URIs, such as <code>jdbc:tc:postgresql:&lt;image-tag&gt;:///&lt;databasename&gt;</code>, if you need use the <a href=\"https://www.testcontainers.org/test_framework_integration/manual_lifecycle_control/#singleton-containers\" rel=\"noreferrer\">singleton pattern</a>.</p>\n"},{"tags":[],"owner":{"account_id":4895787,"reputation":10833,"user_id":3945473,"display_name":"M.P. Korstanje"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1665404950,"creation_date":1665404950,"answer_id":74014960,"question_id":62425598,"body_markdown":"Using either singleton containers or reusable containers are possible solutions but because they don&#39;t scope the life-cycle of the container to that of the application context both are less then ideal.\r\n\r\nIt is however possible to scope the container to the application contexts lifecycle by using a `ContextCustomizerFactory` and [I&#39;ve written about this in more detail in a blog post][1].\r\n\r\nIn a test use:\r\n\r\n```java\r\n@Slf4j\r\n@SpringBootTest\r\n@EnabledPostgresTestContainer\r\nclass DemoApplicationTest {\r\n\r\n    @Test\r\n    void contextLoads() {\r\n        log.info(&quot;Hello world&quot;);\r\n    }\r\n\r\n}\r\n```\r\n\r\nThen enable the annotation in `META-INF/spring.factories`:\r\n\r\n```properties\r\norg.springframework.test.context.ContextCustomizerFactory=\\\r\n  com.logarithmicwhale.demo.EnablePostgresTestContainerContextCustomizerFactory\r\n```\r\n\r\nWhich can be implemented as:\r\n\r\n```java\r\npublic class EnablePostgresTestContainerContextCustomizerFactory implements ContextCustomizerFactory {\r\n\r\n    @Target(ElementType.TYPE)\r\n    @Retention(RetentionPolicy.RUNTIME)\r\n    @Documented\r\n    @Inherited\r\n    public @interface EnabledPostgresTestContainer {\r\n    }\r\n\r\n    @Override\r\n    public ContextCustomizer createContextCustomizer(Class&lt;?&gt; testClass,\r\n            List&lt;ContextConfigurationAttributes&gt; configAttributes) {\r\n        if (!(AnnotatedElementUtils.hasAnnotation(testClass, EnabledPostgresTestContainer.class))) {\r\n            return null;\r\n        }\r\n        return new PostgresTestContainerContextCustomizer();\r\n    }\r\n\r\n    @EqualsAndHashCode // See ContextCustomizer java doc\r\n    private static class PostgresTestContainerContextCustomizer implements ContextCustomizer {\r\n\r\n        private static final DockerImageName image = DockerImageName\r\n                .parse(&quot;postgres&quot;)\r\n                .withTag(&quot;14.1&quot;);\r\n\r\n        @Override\r\n        public void customizeContext(ConfigurableApplicationContext context, MergedContextConfiguration mergedConfig) {\r\n            var postgresContainer = new PostgreSQLContainer&lt;&gt;(image);\r\n            postgresContainer.start();\r\n            var properties = Map.&lt;String, Object&gt;of(\r\n                    &quot;spring.datasource.url&quot;, postgresContainer.getJdbcUrl(),\r\n                    &quot;spring.datasource.username&quot;, postgresContainer.getUsername(),\r\n                    &quot;spring.datasource.password&quot;, postgresContainer.getPassword(),\r\n                    // Prevent any in memory db from replacing the data source\r\n                    // See @AutoConfigureTestDatabase\r\n                    &quot;spring.test.database.replace&quot;, &quot;NONE&quot;\r\n            );\r\n            var propertySource = new MapPropertySource(&quot;PostgresContainer Test Properties&quot;, properties);\r\n            context.getEnvironment().getPropertySources().addFirst(propertySource);\r\n        }\r\n\r\n    }\r\n\r\n}\r\n```\r\n\r\n\r\n  [1]: https://logarithmicwhale.com/posts/faster-tests-by-resuing-testcontainers-in-spring-boot/","title":"How to reuse Testcontainers between multiple SpringBootTests?","body":"<p>Using either singleton containers or reusable containers are possible solutions but because they don't scope the life-cycle of the container to that of the application context both are less then ideal.</p>\n<p>It is however possible to scope the container to the application contexts lifecycle by using a <code>ContextCustomizerFactory</code> and <a href=\"https://logarithmicwhale.com/posts/faster-tests-by-resuing-testcontainers-in-spring-boot/\" rel=\"nofollow noreferrer\">I've written about this in more detail in a blog post</a>.</p>\n<p>In a test use:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Slf4j\n@SpringBootTest\n@EnabledPostgresTestContainer\nclass DemoApplicationTest {\n\n    @Test\n    void contextLoads() {\n        log.info(&quot;Hello world&quot;);\n    }\n\n}\n</code></pre>\n<p>Then enable the annotation in <code>META-INF/spring.factories</code>:</p>\n<pre><code>org.springframework.test.context.ContextCustomizerFactory=\\\n  com.logarithmicwhale.demo.EnablePostgresTestContainerContextCustomizerFactory\n</code></pre>\n<p>Which can be implemented as:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class EnablePostgresTestContainerContextCustomizerFactory implements ContextCustomizerFactory {\n\n    @Target(ElementType.TYPE)\n    @Retention(RetentionPolicy.RUNTIME)\n    @Documented\n    @Inherited\n    public @interface EnabledPostgresTestContainer {\n    }\n\n    @Override\n    public ContextCustomizer createContextCustomizer(Class&lt;?&gt; testClass,\n            List&lt;ContextConfigurationAttributes&gt; configAttributes) {\n        if (!(AnnotatedElementUtils.hasAnnotation(testClass, EnabledPostgresTestContainer.class))) {\n            return null;\n        }\n        return new PostgresTestContainerContextCustomizer();\n    }\n\n    @EqualsAndHashCode // See ContextCustomizer java doc\n    private static class PostgresTestContainerContextCustomizer implements ContextCustomizer {\n\n        private static final DockerImageName image = DockerImageName\n                .parse(&quot;postgres&quot;)\n                .withTag(&quot;14.1&quot;);\n\n        @Override\n        public void customizeContext(ConfigurableApplicationContext context, MergedContextConfiguration mergedConfig) {\n            var postgresContainer = new PostgreSQLContainer&lt;&gt;(image);\n            postgresContainer.start();\n            var properties = Map.&lt;String, Object&gt;of(\n                    &quot;spring.datasource.url&quot;, postgresContainer.getJdbcUrl(),\n                    &quot;spring.datasource.username&quot;, postgresContainer.getUsername(),\n                    &quot;spring.datasource.password&quot;, postgresContainer.getPassword(),\n                    // Prevent any in memory db from replacing the data source\n                    // See @AutoConfigureTestDatabase\n                    &quot;spring.test.database.replace&quot;, &quot;NONE&quot;\n            );\n            var propertySource = new MapPropertySource(&quot;PostgresContainer Test Properties&quot;, properties);\n            context.getEnvironment().getPropertySources().addFirst(propertySource);\n        }\n\n    }\n\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":14583346,"reputation":863,"user_id":10533012,"display_name":"Elyorbek Ibrokhimov"},"down_vote_count":0,"up_vote_count":10,"is_accepted":false,"score":10,"last_activity_date":1684742258,"creation_date":1670901981,"answer_id":74779653,"question_id":62425598,"body_markdown":"Accepted answer is great but the problem is you still have to repeat the configurations(creating, starting and etc.) for each integration tests. It would be better to have simpler configuration with fewer lines of code. I think cleaner version would be using JUnit 5 extensions.\r\n\r\nThis is how I solved the problem. Below sample uses MariaDB container but the concept is applicable to all.\r\n\r\n1. Create the container config holding class:\r\n\r\n```java\r\npublic class AppMariaDBContainer extends MariaDBContainer&lt;AppMariaDBContainer&gt; {\r\n\r\n    private static final String IMAGE_VERSION = &quot;mariadb:10.5&quot;;\r\n    private static final String DATABASE_NAME = &quot;my-db&quot;;\r\n    private static final String USERNAME = &quot;user&quot;;\r\n    private static final String PASSWORD = &quot;strong-password&quot;;\r\n\r\n    public static AppMariaDBContainer container = new AppMariaDBContainer()\r\n            .withDatabaseName(DATABASE_NAME)\r\n            .withUsername(USERNAME)\r\n            .withPassword(PASSWORD);\r\n\r\n    public AppMariaDBContainer() {\r\n        super(IMAGE_VERSION);\r\n    }\r\n\r\n}\r\n```\r\n\r\n2. Create an extension class that starts the container and sets the `DataSource` properties. And run migrations if needed:\r\n\r\n```java\r\npublic class DatabaseSetupExtension implements BeforeAllCallback {\r\n\r\n    @Override\r\n    public void beforeAll(ExtensionContext context) {\r\n        AppMariaDBContainer.container.start();\r\n        updateDataSourceProps(AppMariaDBContainer.container);\r\n        //migration logic here (if needed)\r\n    }\r\n\r\n    private void updateDataSourceProps(AppMariaDBContainer container) {\r\n        System.setProperty(&quot;spring.datasource.url&quot;, container.getJdbcUrl());\r\n        System.setProperty(&quot;spring.datasource.username&quot;, container.getUsername());\r\n        System.setProperty(&quot;spring.datasource.password&quot;, container.getPassword());\r\n    }\r\n\r\n}\r\n```\r\n\r\n3. Add `@ExtendWith` to your test class\r\n\r\n```java\r\n@SpringBootTest\r\n@ExtendWith(DatabaseSetupExtension.class)\r\nclass ApplicationIntegrationTests {\r\n\r\n    @Test\r\n    void someTest() {\r\n    }\r\n\r\n}\r\n\r\n```\r\n\r\nAnother test\r\n\r\n```java\r\n@SpringBootTest\r\n@ExtendWith(DatabaseSetupExtension.class)\r\nclass AnotherIntegrationTests {\r\n\r\n    @Test\r\n    void anotherTest() {\r\n    }\r\n\r\n}\r\n```\r\n","title":"How to reuse Testcontainers between multiple SpringBootTests?","body":"<p>Accepted answer is great but the problem is you still have to repeat the configurations(creating, starting and etc.) for each integration tests. It would be better to have simpler configuration with fewer lines of code. I think cleaner version would be using JUnit 5 extensions.</p>\n<p>This is how I solved the problem. Below sample uses MariaDB container but the concept is applicable to all.</p>\n<ol>\n<li>Create the container config holding class:</li>\n</ol>\n<pre class=\"lang-java prettyprint-override\"><code>public class AppMariaDBContainer extends MariaDBContainer&lt;AppMariaDBContainer&gt; {\n\n    private static final String IMAGE_VERSION = &quot;mariadb:10.5&quot;;\n    private static final String DATABASE_NAME = &quot;my-db&quot;;\n    private static final String USERNAME = &quot;user&quot;;\n    private static final String PASSWORD = &quot;strong-password&quot;;\n\n    public static AppMariaDBContainer container = new AppMariaDBContainer()\n            .withDatabaseName(DATABASE_NAME)\n            .withUsername(USERNAME)\n            .withPassword(PASSWORD);\n\n    public AppMariaDBContainer() {\n        super(IMAGE_VERSION);\n    }\n\n}\n</code></pre>\n<ol start=\"2\">\n<li>Create an extension class that starts the container and sets the <code>DataSource</code> properties. And run migrations if needed:</li>\n</ol>\n<pre class=\"lang-java prettyprint-override\"><code>public class DatabaseSetupExtension implements BeforeAllCallback {\n\n    @Override\n    public void beforeAll(ExtensionContext context) {\n        AppMariaDBContainer.container.start();\n        updateDataSourceProps(AppMariaDBContainer.container);\n        //migration logic here (if needed)\n    }\n\n    private void updateDataSourceProps(AppMariaDBContainer container) {\n        System.setProperty(&quot;spring.datasource.url&quot;, container.getJdbcUrl());\n        System.setProperty(&quot;spring.datasource.username&quot;, container.getUsername());\n        System.setProperty(&quot;spring.datasource.password&quot;, container.getPassword());\n    }\n\n}\n</code></pre>\n<ol start=\"3\">\n<li>Add <code>@ExtendWith</code> to your test class</li>\n</ol>\n<pre class=\"lang-java prettyprint-override\"><code>@SpringBootTest\n@ExtendWith(DatabaseSetupExtension.class)\nclass ApplicationIntegrationTests {\n\n    @Test\n    void someTest() {\n    }\n\n}\n\n</code></pre>\n<p>Another test</p>\n<pre class=\"lang-java prettyprint-override\"><code>@SpringBootTest\n@ExtendWith(DatabaseSetupExtension.class)\nclass AnotherIntegrationTests {\n\n    @Test\n    void anotherTest() {\n    }\n\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4547322,"reputation":2501,"user_id":3693478,"display_name":"Todor Todorov"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1677054810,"creation_date":1677054810,"answer_id":75530001,"question_id":62425598,"body_markdown":"Simply follow the guide from the testcontainers documentation. about the [Singleton pattern][1]. As they say - it is an option for JUnit5.\r\nDo not use the @Testcontainers annotation and @Container annotation. Those are related to the JUnit4. \r\nAlso add to your class path testcontainers.properties file with:\r\n\r\n    testcontainers.reuse.enable=true\r\n\r\nThat did the trick for me.\r\n\r\n\r\n  [1]: https://www.testcontainers.org/test_framework_integration/manual_lifecycle_control/#singleton-containers","title":"How to reuse Testcontainers between multiple SpringBootTests?","body":"<p>Simply follow the guide from the testcontainers documentation. about the <a href=\"https://www.testcontainers.org/test_framework_integration/manual_lifecycle_control/#singleton-containers\" rel=\"nofollow noreferrer\">Singleton pattern</a>. As they say - it is an option for JUnit5.\nDo not use the @Testcontainers annotation and @Container annotation. Those are related to the JUnit4.\nAlso add to your class path testcontainers.properties file with:</p>\n<pre><code>testcontainers.reuse.enable=true\n</code></pre>\n<p>That did the trick for me.</p>\n"},{"tags":[],"owner":{"account_id":887980,"reputation":2175,"user_id":926942,"display_name":"sk_"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1694793992,"creation_date":1694793656,"answer_id":77113817,"question_id":62425598,"body_markdown":"The accepted answer has the caveat that the container will survive the execution of the tests, which may be not desirable as it can make your tests run not reproducible.\r\n\r\nIf the goal is to have only one PostgreSQL container instance across multiple test classes and have it discarded at the end of the test phase, it can be easily achieved without relying on reusable testcontainers.\r\n\r\nFirst create an abstract class that will be in charge of the setup of the needed testcontainers\r\n\r\n    public abstract class BaseIntegrationTest {\r\n    \r\n        @ServiceConnection\r\n        protected static final PostgreSQLContainer&lt;?&gt; dbContainer = new PostgreSQLContainer&lt;&gt;(\r\n                DockerImageName.parse(&quot;postgres&quot;)\r\n                        .withTag(&quot;15.4&quot;))\r\n                .withDatabaseName(&quot;testcontainer&quot;)\r\n                .withUsername(&quot;user&quot;)\r\n                .withPassword(&quot;pass&quot;);\r\n     \r\n        static {\r\n            dbContainer.start();\r\n        }\r\n    }\r\n\r\nImplement each test class as an extension of this abstract class\r\n\r\n    @SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)\r\n    @ExtendWith(SpringExtension.class)\r\n    public class BootstrapApplicationTest extends BaseIntegrationTest {\r\n    \r\n        @Test\r\n        @DisplayName(&quot;My test case&quot;)\r\n        void myTest() throws Exception {\r\n    \r\n            ...\r\n        }\r\n    \r\n    }\r\n\r\nNotice that the @TestContainers annotation is not used here as it tells Spring to create a container per test class.\r\n","title":"How to reuse Testcontainers between multiple SpringBootTests?","body":"<p>The accepted answer has the caveat that the container will survive the execution of the tests, which may be not desirable as it can make your tests run not reproducible.</p>\n<p>If the goal is to have only one PostgreSQL container instance across multiple test classes and have it discarded at the end of the test phase, it can be easily achieved without relying on reusable testcontainers.</p>\n<p>First create an abstract class that will be in charge of the setup of the needed testcontainers</p>\n<pre><code>public abstract class BaseIntegrationTest {\n\n    @ServiceConnection\n    protected static final PostgreSQLContainer&lt;?&gt; dbContainer = new PostgreSQLContainer&lt;&gt;(\n            DockerImageName.parse(&quot;postgres&quot;)\n                    .withTag(&quot;15.4&quot;))\n            .withDatabaseName(&quot;testcontainer&quot;)\n            .withUsername(&quot;user&quot;)\n            .withPassword(&quot;pass&quot;);\n \n    static {\n        dbContainer.start();\n    }\n}\n</code></pre>\n<p>Implement each test class as an extension of this abstract class</p>\n<pre><code>@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)\n@ExtendWith(SpringExtension.class)\npublic class BootstrapApplicationTest extends BaseIntegrationTest {\n\n    @Test\n    @DisplayName(&quot;My test case&quot;)\n    void myTest() throws Exception {\n\n        ...\n    }\n\n}\n</code></pre>\n<p>Notice that the @TestContainers annotation is not used here as it tells Spring to create a container per test class.</p>\n"}],"owner":{"account_id":435063,"reputation":4304,"user_id":821436,"accept_rate":79,"display_name":"Martin Schr&#246;der"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":37580,"favorite_count":0,"down_vote_count":1,"up_vote_count":47,"accepted_answer_id":62443261,"answer_count":7,"score":46,"last_activity_date":1694793992,"creation_date":1592385474,"question_id":62425598,"body_markdown":"I&#39;m using TestContainers with Spring Boot to run unit tests for repositories like this:\r\n\r\n    @Testcontainers\r\n    @ExtendWith(SpringExtension.class)\r\n    @ActiveProfiles(&quot;itest&quot;)\r\n    @SpringBootTest(classes = RouteTestingCheapRouteDetector.class)\r\n    @ContextConfiguration(initializers = AlwaysFailingRouteRepositoryShould.Initializer.class)\r\n    @TestExecutionListeners(listeners = DependencyInjectionTestExecutionListener.class)\r\n    @AutoConfigureTestDatabase(replace = AutoConfigureTestDatabase.Replace.NONE)\r\n    @Tag(&quot;docker&quot;)\r\n    @Tag(&quot;database&quot;)\r\n    class AlwaysFailingRouteRepositoryShould {\r\n    \r\n      @SuppressWarnings(&quot;rawtypes&quot;)\r\n      @Container\r\n      private static final PostgreSQLContainer database =\r\n          new PostgreSQLContainer(&quot;postgres:9.6&quot;)\r\n              .withDatabaseName(&quot;database&quot;)\r\n              .withUsername(&quot;postgres&quot;)\r\n              .withPassword(&quot;postgres&quot;);\r\n\r\nBut now I have 14 of these tests and every time a test is run a new instance of Postgres is spun up. Is it possible to reuse the same instance across all tests? The [Singleton pattern][1] doesn&#39;t help since every test starts a new application.\r\n\r\nI&#39;ve also tried `testcontainers.reuse.enable=true` in `.testcontainers.properties` and `.withReuse(true)`, but that didn&#39;t help.\r\n\r\n\r\n  [1]: https://www.testcontainers.org/test_framework_integration/manual_lifecycle_control/","title":"How to reuse Testcontainers between multiple SpringBootTests?","body":"<p>I'm using TestContainers with Spring Boot to run unit tests for repositories like this:</p>\n\n<pre><code>@Testcontainers\n@ExtendWith(SpringExtension.class)\n@ActiveProfiles(\"itest\")\n@SpringBootTest(classes = RouteTestingCheapRouteDetector.class)\n@ContextConfiguration(initializers = AlwaysFailingRouteRepositoryShould.Initializer.class)\n@TestExecutionListeners(listeners = DependencyInjectionTestExecutionListener.class)\n@AutoConfigureTestDatabase(replace = AutoConfigureTestDatabase.Replace.NONE)\n@Tag(\"docker\")\n@Tag(\"database\")\nclass AlwaysFailingRouteRepositoryShould {\n\n  @SuppressWarnings(\"rawtypes\")\n  @Container\n  private static final PostgreSQLContainer database =\n      new PostgreSQLContainer(\"postgres:9.6\")\n          .withDatabaseName(\"database\")\n          .withUsername(\"postgres\")\n          .withPassword(\"postgres\");\n</code></pre>\n\n<p>But now I have 14 of these tests and every time a test is run a new instance of Postgres is spun up. Is it possible to reuse the same instance across all tests? The <a href=\"https://www.testcontainers.org/test_framework_integration/manual_lifecycle_control/\" rel=\"noreferrer\">Singleton pattern</a> doesn't help since every test starts a new application.</p>\n\n<p>I've also tried <code>testcontainers.reuse.enable=true</code> in <code>.testcontainers.properties</code> and <code>.withReuse(true)</code>, but that didn't help.</p>\n"},{"tags":["java","spring","hibernate","vaadin","vaadin24"],"comments":[{"owner":{"account_id":12280349,"reputation":10212,"user_id":8962195,"display_name":"Tatu Lund"},"score":0,"creation_date":1694620582,"post_id":77098117,"comment_id":135916141,"body_markdown":"Does that custom framework you did not name offer some data service abstraction layer on top of Hibernate? Just noting here that Vaadin itself has nothing and is totally agnostic regarding how you access data.","body":"Does that custom framework you did not name offer some data service abstraction layer on top of Hibernate? Just noting here that Vaadin itself has nothing and is totally agnostic regarding how you access data."},{"owner":{"account_id":1038596,"reputation":34548,"user_id":1045142,"accept_rate":67,"display_name":"Simon Martinelli"},"score":0,"creation_date":1694702375,"post_id":77098117,"comment_id":135928776,"body_markdown":"OSIV will not help with Vaadin. I wonder how it was possible that it worked before","body":"OSIV will not help with Vaadin. I wonder how it was possible that it worked before"},{"owner":{"account_id":3837378,"reputation":35463,"user_id":3181392,"display_name":"cfrick"},"score":1,"creation_date":1694763462,"post_id":77098117,"comment_id":135936619,"body_markdown":"What is the point, when it &quot;fixes alot of the issues&quot;, but not all? OSIV is/was a band-aid in a vaadin application (it helped back in the V7/8 days so maybe still; but more likely by accident, as it prolongs the link to the session for the loaded objects across the borders of the servlet world), when your design has no barrier between DB and UI.  So the answer no one wants to hear is: fix your architecture.  Therefor I close-vote: neither the problems, that OSIV fixes are shown (I have a strong guess though) nor the remaining ones.","body":"What is the point, when it &quot;fixes alot of the issues&quot;, but not all? OSIV is/was a band-aid in a vaadin application (it helped back in the V7/8 days so maybe still; but more likely by accident, as it prolongs the link to the session for the loaded objects across the borders of the servlet world), when your design has no barrier between DB and UI.  So the answer no one wants to hear is: fix your architecture.  Therefor I close-vote: neither the problems, that OSIV fixes are shown (I have a strong guess though) nor the remaining ones."}],"owner":{"account_id":29430225,"reputation":11,"user_id":22550078,"display_name":"loooooong"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":68,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1694793715,"creation_date":1694615936,"question_id":77098117,"body_markdown":"Since updating the versions of Hibernate, Vaadin and a custom framework based on Vaadin of the application, many issues have appeared regarding Hibernate proxy and lazily loading, that weren&#39;t there before doing the update.\r\n\r\nI have enabled spring.jpa.open-in-view in the application.properties, since this was explicitly disabled before, and it fixed a lot of the issues. \r\n\r\nI was wondering if anyone working with Vaadin 20 or later, would discourage enabling spring.jpa.open-in-view on an application running on Vaadin 24 in production, and if so, why this would be the case? \r\n\r\nI have only found some warnings regarding it slowing down performance a bit, but the way the custom framework based on Vaadin is set up, enabling OSIV seems like the most effective and efficient way of solving the issues at this moment.","title":"Using OSIV in vaadin 24 in production","body":"<p>Since updating the versions of Hibernate, Vaadin and a custom framework based on Vaadin of the application, many issues have appeared regarding Hibernate proxy and lazily loading, that weren't there before doing the update.</p>\n<p>I have enabled spring.jpa.open-in-view in the application.properties, since this was explicitly disabled before, and it fixed a lot of the issues.</p>\n<p>I was wondering if anyone working with Vaadin 20 or later, would discourage enabling spring.jpa.open-in-view on an application running on Vaadin 24 in production, and if so, why this would be the case?</p>\n<p>I have only found some warnings regarding it slowing down performance a bit, but the way the custom framework based on Vaadin is set up, enabling OSIV seems like the most effective and efficient way of solving the issues at this moment.</p>\n"},{"tags":["java","jpa","junit","spring-data-jpa","mockito"],"answers":[{"tags":[],"owner":{"account_id":39208,"reputation":251240,"user_id":112968,"accept_rate":68,"display_name":"knittl"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1694793690,"creation_date":1694793690,"answer_id":77113822,"question_id":77108950,"body_markdown":"[`JpaSystemException`](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/orm/jpa/JpaSystemException.html#%3Cinit%3E(java.lang.RuntimeException)) has a public constructor, so you can simply create an instance of it for your test:\r\n\r\n```\r\nfinal int errorCode = 20001;\r\nfinal Exception ex = new JpaSystemException(\r\n    new Exception(\r\n        new SQLException(&quot;reason&quot;, &quot;sqlstate&quot;, errorCode)));\r\n\r\n// ex.getCause().getCause() is your SQLException\r\n```","title":"How to unit test JpaSystemException error handling logic?","body":"<p><a href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/orm/jpa/JpaSystemException.html#%3Cinit%3E(java.lang.RuntimeException)\" rel=\"nofollow noreferrer\"><code>JpaSystemException</code></a> has a public constructor, so you can simply create an instance of it for your test:</p>\n<pre><code>final int errorCode = 20001;\nfinal Exception ex = new JpaSystemException(\n    new Exception(\n        new SQLException(&quot;reason&quot;, &quot;sqlstate&quot;, errorCode)));\n\n// ex.getCause().getCause() is your SQLException\n</code></pre>\n"}],"owner":{"account_id":3504050,"reputation":125,"user_id":2930025,"display_name":"alaskanloops"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":23,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77113822,"answer_count":1,"score":0,"last_activity_date":1694793690,"creation_date":1694735758,"question_id":77108950,"body_markdown":"I have a JpaRepository that is calling an Oracle function, which can return a handfull of application errors.  I&#39;ve successfully handled the errors with the following util method:\r\n\r\n        private Integer pullOracleErrorCodeFromJpaException(JpaSystemException t) {\r\n        if (t.getCause().getCause() instanceof SQLException) {\r\n            SQLException sqlException = (SQLException) t.getCause().getCause();\r\n            return sqlException.getErrorCode();\r\n        }\r\n        return null;\r\n    }\r\n\r\nI can then key off of returned error in the JpaSystemException catch block like so:\r\n\r\n\r\n    try {\r\n    personProfile = personRepository.findPersonProfile(\r\n            request.getPersonId(),\r\n            request.getBillingAccount(),\r\n            request.getCustomerAccount()\r\n    } catch (JpaSystemException jse) {\r\n\r\n    Integer oracleErrorCode = pullOracleErrorCodeFromJpaException(jse);\r\n\r\n    if (oracleErrorCode == null) {\r\n        throw new OracleErrorException(&quot;Oracle Function returned an error.&quot;);\r\n    }\r\n    else if (oracleErrorCode == 20001) {\r\n        throw new InvalidRequestException(&quot;At least one variable is required to run the acp usac function.&quot;);\r\n    } else if (oracleErrorCode == 20002) {\r\n        throw new InvalidRequestException(&quot;Make sure you enter billing account in the billing account field.&quot;);\r\n    } else if (oracleErrorCode == 20003) {\r\n        throw new InvalidRequestException(&quot;Make sure you enter a customer account in the customer account field.&quot;);\r\n    } else {\r\n        throw new OracleErrorException(&quot;Oracle function returned an unrecognized application error.&quot;);\r\n    }\r\n    \r\n\r\n\r\nWhich works great! However I&#39;m having a hard time figuring out how to unit test the various return codes from Oracle, since they&#39;re 2 exceptions deep. Is it possible to set a cause 2 levels deep in a `org.mockito.Mockito.doThrow` so that I can validate each Oracle error code throws the correct subsequent exception?","title":"How to unit test JpaSystemException error handling logic?","body":"<p>I have a JpaRepository that is calling an Oracle function, which can return a handfull of application errors.  I've successfully handled the errors with the following util method:</p>\n<pre><code>    private Integer pullOracleErrorCodeFromJpaException(JpaSystemException t) {\n    if (t.getCause().getCause() instanceof SQLException) {\n        SQLException sqlException = (SQLException) t.getCause().getCause();\n        return sqlException.getErrorCode();\n    }\n    return null;\n}\n</code></pre>\n<p>I can then key off of returned error in the JpaSystemException catch block like so:</p>\n<pre><code>try {\npersonProfile = personRepository.findPersonProfile(\n        request.getPersonId(),\n        request.getBillingAccount(),\n        request.getCustomerAccount()\n} catch (JpaSystemException jse) {\n\nInteger oracleErrorCode = pullOracleErrorCodeFromJpaException(jse);\n\nif (oracleErrorCode == null) {\n    throw new OracleErrorException(&quot;Oracle Function returned an error.&quot;);\n}\nelse if (oracleErrorCode == 20001) {\n    throw new InvalidRequestException(&quot;At least one variable is required to run the acp usac function.&quot;);\n} else if (oracleErrorCode == 20002) {\n    throw new InvalidRequestException(&quot;Make sure you enter billing account in the billing account field.&quot;);\n} else if (oracleErrorCode == 20003) {\n    throw new InvalidRequestException(&quot;Make sure you enter a customer account in the customer account field.&quot;);\n} else {\n    throw new OracleErrorException(&quot;Oracle function returned an unrecognized application error.&quot;);\n}\n</code></pre>\n<p>Which works great! However I'm having a hard time figuring out how to unit test the various return codes from Oracle, since they're 2 exceptions deep. Is it possible to set a cause 2 levels deep in a <code>org.mockito.Mockito.doThrow</code> so that I can validate each Oracle error code throws the correct subsequent exception?</p>\n"},{"tags":["java","spring","intellij-idea"],"comments":[{"owner":{"account_id":1100252,"reputation":10087,"user_id":1092818,"display_name":"crizzis"},"score":2,"creation_date":1694793339,"post_id":77113738,"comment_id":135942451,"body_markdown":"Is there a reason why you cannot simply debug your code and see which implementation ends up being used at runtime?","body":"Is there a reason why you cannot simply debug your code and see which implementation ends up being used at runtime?"},{"owner":{"account_id":1100252,"reputation":10087,"user_id":1092818,"display_name":"crizzis"},"score":0,"creation_date":1694793504,"post_id":77113738,"comment_id":135942475,"body_markdown":"Also, you should get a small green bean icon in the gutter next to the autowired field. If you click it, it will take you to the location where the candidates for autowiring are being created. I&#39;m talking about IntelliJ Enterprise, of course","body":"Also, you should get a small green bean icon in the gutter next to the autowired field. If you click it, it will take you to the location where the candidates for autowiring are being created. I&#39;m talking about IntelliJ Enterprise, of course"},{"owner":{"account_id":25761652,"reputation":56,"user_id":19512473,"display_name":"javaguy"},"score":0,"creation_date":1694797737,"post_id":77113738,"comment_id":135943217,"body_markdown":"I have Intellij Ultimate but when clicking the green bean it says no autowired candidates.  Just expecting that geen bean to be better help when the implementation is in a jar that was pulled in by the pom.  I wanted to see if I could find the implementation without having to run the code","body":"I have Intellij Ultimate but when clicking the green bean it says no autowired candidates.  Just expecting that geen bean to be better help when the implementation is in a jar that was pulled in by the pom.  I wanted to see if I could find the implementation without having to run the code"}],"owner":{"account_id":25761652,"reputation":56,"user_id":19512473,"display_name":"javaguy"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":26,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694792875,"creation_date":1694792875,"question_id":77113738,"body_markdown":"We have an interface in our Springboot 2 code that references an abstract method on interface of type MessageChannel  (org.springframework.messaging)\r\n\r\nThe implementation is in a class that is autoconfigured and pulled in by maven as a transitive dependency, likely by a maven artifact for RabbitMQ\r\n\r\nIn Intellij, I click the down arrow in the gutter and see a dropdown containing 33 implementations. \r\n\r\nHow can I tell which implementation in the dropdown is the one that applicable?","title":"Determine which implementation is applicable?","body":"<p>We have an interface in our Springboot 2 code that references an abstract method on interface of type MessageChannel  (org.springframework.messaging)</p>\n<p>The implementation is in a class that is autoconfigured and pulled in by maven as a transitive dependency, likely by a maven artifact for RabbitMQ</p>\n<p>In Intellij, I click the down arrow in the gutter and see a dropdown containing 33 implementations.</p>\n<p>How can I tell which implementation in the dropdown is the one that applicable?</p>\n"},{"tags":["java","string","junit","tostring","assert"],"comments":[{"owner":{"account_id":3589934,"reputation":1414,"user_id":4070984,"display_name":"Ben"},"score":0,"creation_date":1456919764,"post_id":35746442,"comment_id":59166280,"body_markdown":"Is this question JUnit&#39;s assertEquals method? If so you should add a JUnit tag.","body":"Is this question JUnit&#39;s assertEquals method? If so you should add a JUnit tag."},{"owner":{"account_id":3589934,"reputation":1414,"user_id":4070984,"display_name":"Ben"},"score":2,"creation_date":1456919821,"post_id":35746442,"comment_id":59166318,"body_markdown":"Why don&#39;t you want to call toString yourself - what&#39;s the problem you&#39;re trying to solve here?","body":"Why don&#39;t you want to call toString yourself - what&#39;s the problem you&#39;re trying to solve here?"},{"owner":{"account_id":4470050,"reputation":68258,"user_id":3636601,"accept_rate":75,"display_name":"Jens"},"score":0,"creation_date":1456919859,"post_id":35746442,"comment_id":59166347,"body_markdown":"The only way is to override the `assertEquals` method.","body":"The only way is to override the <code>assertEquals</code> method."},{"owner":{"account_id":4470050,"reputation":68258,"user_id":3636601,"accept_rate":75,"display_name":"Jens"},"score":2,"creation_date":1456919939,"post_id":35746442,"comment_id":59166412,"body_markdown":"But the best way is to convert &quot;10,00 €&quot;To a currency object and compare the two currecy objects","body":"But the best way is to convert &quot;10,00 €&quot;To a currency object and compare the two currecy objects"}],"answers":[{"tags":[],"owner":{"account_id":4647011,"reputation":41835,"user_id":3764965,"accept_rate":94,"display_name":"Nikolas Charalambidis"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1522143486,"creation_date":1456919794,"answer_id":35746538,"question_id":35746442,"body_markdown":"Nope, the only way to do that is to write it yourself:\r\n\r\n    assertEquals(&quot;10,00 €&quot;, new Currency(bon.getTotal()).toString());","title":"force assertEquals(String s, Object o) to use o.toString()?","body":"<p>Nope, the only way to do that is to write it yourself:</p>\n\n<pre><code>assertEquals(\"10,00 €\", new Currency(bon.getTotal()).toString());\n</code></pre>\n"},{"tags":[],"owner":{"account_id":5501406,"reputation":4041,"user_id":4370629,"accept_rate":67,"display_name":"Spotted"},"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1456920256,"creation_date":1456920256,"answer_id":35746707,"question_id":35746442,"body_markdown":"You should compare two instances of `Currency`:\r\n\r\n    assertEquals(new Currency(&quot;10,00 €&quot;), new Currency(bon.getTotal()))\r\n\r\nTherefore, redefining `equals()` is mandatory. If the equality must be based on the string representation of `Currency`, it&#39;s also mandatory to override `toString()` (you probably already did that).\r\n\r\n    public class Currency {\r\n\r\n        ...\r\n    \r\n        @Override\r\n        public String toString() {\r\n            //overriden in a custom way\r\n        }\r\n    \r\n        @Override\r\n        public boolean equals(Object other) {\r\n            if(other instanceof Currency) {\r\n                Currency that = (Currency) other;\r\n                return this.toString().equals(that.toString());\r\n            }\r\n            return false;\r\n        }\r\n\r\n        ...\r\n    }","title":"force assertEquals(String s, Object o) to use o.toString()?","body":"<p>You should compare two instances of <code>Currency</code>:</p>\n\n<pre><code>assertEquals(new Currency(\"10,00 €\"), new Currency(bon.getTotal()))\n</code></pre>\n\n<p>Therefore, redefining <code>equals()</code> is mandatory. If the equality must be based on the string representation of <code>Currency</code>, it's also mandatory to override <code>toString()</code> (you probably already did that).</p>\n\n<pre><code>public class Currency {\n\n    ...\n\n    @Override\n    public String toString() {\n        //overriden in a custom way\n    }\n\n    @Override\n    public boolean equals(Object other) {\n        if(other instanceof Currency) {\n            Currency that = (Currency) other;\n            return this.toString().equals(that.toString());\n        }\n        return false;\n    }\n\n    ...\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":17509483,"reputation":45,"user_id":12697880,"display_name":"bahareh saremi"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694792227,"creation_date":1694792227,"answer_id":77113653,"question_id":35746442,"body_markdown":"I had the same error.\r\nI used this approach.\r\nthe  `assertEquals(20 ,   new Duller(result.multiple()).toString());` did not work.\r\n\r\n    public class MoneyTest {\r\n    \r\n        @Test\r\n        public void testMultiplication(){\r\n            Duller fiveValue= new Duller(5);\r\n            Duller twoTimes = fiveValue.times(2);\r\n            assertEquals(10,twoTimes.amount);\r\n    \r\n            Duller threeTimes = fiveValue.times(3);\r\n            assertEquals(15, threeTimes.amount);\r\n    \r\n            Duller result = new Duller();\r\n            result.setAmount(4);\r\n            result.setTimes(5);\r\n           int x=  result.multiple();\r\n    \r\n    \r\n           /*\r\n           org.opentest4j.AssertionFailedError:\r\n            Expected :20\r\n            Actual   :com.bahar.test.domain.Duller@16aa0a0a\r\n            */\r\n          //  assertEquals(20 ,   new Duller(result.multiple(result.getTimes())); //actual and expected is obj\r\n            assertEquals(20,x);\r\n        }   \r\n    }\r\n\r\n\r\n    public class Duller {\r\n        int amount;\r\n        int times;\r\n    \r\n        public Duller(){}\r\n        public Duller(int amount){\r\n            this.amount=amount;\r\n        }\r\n    \r\n         Duller times(int multiple){\r\n         //   amount *=multiple; // version 1\r\n            return new Duller(amount*multiple); //version 2\r\n        }\r\n    \r\n        public int getAmount() {\r\n            return amount;\r\n        }\r\n    \r\n        public void setAmount(int amount) {\r\n            this.amount = amount;\r\n        }\r\n    \r\n        public int getTimes() {\r\n            return times;\r\n        }\r\n    \r\n        public void setTimes(int times) {\r\n            this.times = times;\r\n        }\r\n    // changed the Dullar to int\r\n       public int multiple(){\r\n            //   amount *=multiple; // version 1\r\n            return getAmount()*getTimes(); //version 2\r\n           // return this.getAmount()*this.getTimes();\r\n    \r\n        }","title":"force assertEquals(String s, Object o) to use o.toString()?","body":"<p>I had the same error.\nI used this approach.\nthe  <code>assertEquals(20 ,   new Duller(result.multiple()).toString());</code> did not work.</p>\n<pre><code>public class MoneyTest {\n\n    @Test\n    public void testMultiplication(){\n        Duller fiveValue= new Duller(5);\n        Duller twoTimes = fiveValue.times(2);\n        assertEquals(10,twoTimes.amount);\n\n        Duller threeTimes = fiveValue.times(3);\n        assertEquals(15, threeTimes.amount);\n\n        Duller result = new Duller();\n        result.setAmount(4);\n        result.setTimes(5);\n       int x=  result.multiple();\n\n\n       /*\n       org.opentest4j.AssertionFailedError:\n        Expected :20\n        Actual   :com.bahar.test.domain.Duller@16aa0a0a\n        */\n      //  assertEquals(20 ,   new Duller(result.multiple(result.getTimes())); //actual and expected is obj\n        assertEquals(20,x);\n    }   \n}\n\n\npublic class Duller {\n    int amount;\n    int times;\n\n    public Duller(){}\n    public Duller(int amount){\n        this.amount=amount;\n    }\n\n     Duller times(int multiple){\n     //   amount *=multiple; // version 1\n        return new Duller(amount*multiple); //version 2\n    }\n\n    public int getAmount() {\n        return amount;\n    }\n\n    public void setAmount(int amount) {\n        this.amount = amount;\n    }\n\n    public int getTimes() {\n        return times;\n    }\n\n    public void setTimes(int times) {\n        this.times = times;\n    }\n// changed the Dullar to int\n   public int multiple(){\n        //   amount *=multiple; // version 1\n        return getAmount()*getTimes(); //version 2\n       // return this.getAmount()*this.getTimes();\n\n    }\n</code></pre>\n"}],"owner":{"account_id":7929539,"reputation":1273,"user_id":5987899,"accept_rate":94,"display_name":"jam"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1024,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":35746707,"answer_count":3,"score":1,"last_activity_date":1694792227,"creation_date":1456919513,"question_id":35746442,"body_markdown":"Is it possible to force \r\n\r\n    assertEquals(&quot;10,00 €&quot;, new Currency(bon.getTotal()))\r\n\r\nto use the toString() method of the Currency Object?\r\n(I don&#39;t want to call it myself.)\r\n\r\nSince otherwise, it compares the references, which of course don&#39;t match.\r\n\r\n&gt;  java.lang.AssertionError:  \r\n\r\n&gt; expected: java.lang.String&lt;10,00 €&gt;\r\n\r\n&gt; but was: jam.cashregister.Currency&lt;10,00 €&gt;\r\n\r\n\r\n**Update**\r\n\r\nI finally ended up with this code:\r\n\r\n    assertEquals(new Currency(bon.getTotal()), &quot;10,00 €&quot;);\r\n\r\n&gt; I don&#39;t know if it is a good idea to swap the expected with\r\n&gt; the actual part, in the assertation.\r\n\r\n    \r\n    public class Currency() {\r\n    \r\n        @Override\r\n        public boolean equals(Object other) {\r\n            return this.toString().equals(other.toString());\r\n        }\r\n    }","title":"force assertEquals(String s, Object o) to use o.toString()?","body":"<p>Is it possible to force </p>\n\n<pre><code>assertEquals(\"10,00 €\", new Currency(bon.getTotal()))\n</code></pre>\n\n<p>to use the toString() method of the Currency Object?\n(I don't want to call it myself.)</p>\n\n<p>Since otherwise, it compares the references, which of course don't match.</p>\n\n<blockquote>\n  <p>java.lang.AssertionError:  </p>\n  \n  <p>expected: java.lang.String&lt;10,00 €></p>\n  \n  <p>but was: jam.cashregister.Currency&lt;10,00 €></p>\n</blockquote>\n\n<p><strong>Update</strong></p>\n\n<p>I finally ended up with this code:</p>\n\n<pre><code>assertEquals(new Currency(bon.getTotal()), \"10,00 €\");\n</code></pre>\n\n<blockquote>\n  <p>I don't know if it is a good idea to swap the expected with\n  the actual part, in the assertation.</p>\n</blockquote>\n\n<pre><code>public class Currency() {\n\n    @Override\n    public boolean equals(Object other) {\n        return this.toString().equals(other.toString());\n    }\n}\n</code></pre>\n"},{"tags":["java","android","timestamp","relative-time-span"],"comments":[{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":3,"creation_date":1694770992,"post_id":77111289,"comment_id":135938012,"body_markdown":"Assuming that represents milliseconds since epoch, calculate the number of milliseconds from the timestamp to now, divide by 1000, you have seconds. Is it bigger than 60? Divide by 60 and you have minutes. Is it bigger than 60? Divide again by 60 and you have hours. Is it bigger than 24? Divide again by 24 and you have days. And so on...","body":"Assuming that represents milliseconds since epoch, calculate the number of milliseconds from the timestamp to now, divide by 1000, you have seconds. Is it bigger than 60? Divide by 60 and you have minutes. Is it bigger than 60? Divide again by 60 and you have hours. Is it bigger than 24? Divide again by 24 and you have days. And so on..."},{"owner":{"account_id":483434,"reputation":25487,"user_id":898478,"accept_rate":86,"display_name":"m0skit0"},"score":0,"creation_date":1694771065,"post_id":77111289,"comment_id":135938035,"body_markdown":"Any solution in JS should be easily translatable to Java, or you can just code it yourself, doesn&#39;t seem very complicated as stated by @FedericoklezCulloca","body":"Any solution in JS should be easily translatable to Java, or you can just code it yourself, doesn&#39;t seem very complicated as stated by @FedericoklezCulloca"},{"owner":{"account_id":3557625,"reputation":198996,"user_id":2970947,"display_name":"Elliott Frisch"},"score":2,"creation_date":1694771133,"post_id":77111289,"comment_id":135938052,"body_markdown":"That was more than one minute ago, but `Duration.between(Instant.ofEpochMilli(1694603269045L), Instant.now(Clock.systemUTC()));`","body":"That was more than one minute ago, but <code>Duration.between(Instant.ofEpochMilli(1694603269045L), Instant.now(Clock.systemUTC()));</code>"},{"owner":{"account_id":24830565,"reputation":79,"user_id":18709793,"display_name":"Newbie_programmer"},"score":1,"creation_date":1694771439,"post_id":77111289,"comment_id":135938102,"body_markdown":"How does this Duration.between and Instant.now works?","body":"How does this Duration.between and Instant.now works?"},{"owner":{"account_id":3557625,"reputation":198996,"user_id":2970947,"display_name":"Elliott Frisch"},"score":0,"creation_date":1694771531,"post_id":77111289,"comment_id":135938114,"body_markdown":"Math. [`Duration.between(Temporal, Temporal)`](https://docs.oracle.com/javase/8/docs/api/java/time/Duration.html#between-java.time.temporal.Temporal-java.time.temporal.Temporal-) and [`Instant.now(Clock)`](https://docs.oracle.com/javase/8/docs/api/java/time/Instant.html#now-java.time.Clock-)","body":"Math. <a href=\"https://docs.oracle.com/javase/8/docs/api/java/time/Duration.html#between-java.time.temporal.Temporal-java.time.temporal.Temporal-\" rel=\"nofollow noreferrer\"><code>Duration.between(Temporal, Temporal)</code></a> and <a href=\"https://docs.oracle.com/javase/8/docs/api/java/time/Instant.html#now-java.time.Clock-\" rel=\"nofollow noreferrer\"><code>Instant.now(Clock)</code></a>"},{"owner":{"account_id":24830565,"reputation":79,"user_id":18709793,"display_name":"Newbie_programmer"},"score":0,"creation_date":1694771642,"post_id":77111289,"comment_id":135938144,"body_markdown":"How to get the string by the help of these?","body":"How to get the string by the help of these?"},{"owner":{"account_id":465573,"reputation":192694,"user_id":869736,"accept_rate":82,"display_name":"Louis Wasserman"},"score":1,"creation_date":1694771768,"post_id":77111289,"comment_id":135938165,"body_markdown":"Formatting this, specifically in English, may need you to manually arrange it.","body":"Formatting this, specifically in English, may need you to manually arrange it."}],"answers":[{"tags":[],"owner":{"account_id":1894950,"reputation":18007,"user_id":1712135,"display_name":"deHaar"},"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1694771759,"creation_date":1694771759,"answer_id":77111407,"question_id":77111289,"body_markdown":"You can create an `Instant` from your *timestamp* and calculate the `Duration` between it and `Instant.now()`.\r\n\r\n```Java\r\npublic static void main(String[] args) {\r\n\t// your timestamp\t\r\n\tlong timestamp = 1694603269045L;\r\n    // convert to an Instant\r\n\tInstant then = Instant.ofEpochMilli(timestamp);\r\n    // get &quot;now&quot;\r\n\tInstant now = Instant.now();\r\n    // calulate the Duration\r\n\tDuration duration = Duration.between(then, now);\r\n    // print the minutes part\r\n\tSystem.out.println(duration.toMinutesPart() + &quot; minutes ago&quot;);\r\n}\r\n```\r\n\r\nThis just printed\r\n```none\r\n47 minutes ago\r\n```\r\n\r\nYou will have to check which values (hours, minutes, seconds and so on) are actually zero if you want to switch from minutes to hours when minutes are 0, but hours aren&#39;t, for example. This would print `0 minutes ago` in 13 minutes and you may want to cover situations like that.","title":"How to convert timestamp into human readable time string (for example &quot;one minute ago&quot;) in Java","body":"<p>You can create an <code>Instant</code> from your <em>timestamp</em> and calculate the <code>Duration</code> between it and <code>Instant.now()</code>.</p>\n<pre><code>public static void main(String[] args) {\n    // your timestamp   \n    long timestamp = 1694603269045L;\n    // convert to an Instant\n    Instant then = Instant.ofEpochMilli(timestamp);\n    // get &quot;now&quot;\n    Instant now = Instant.now();\n    // calulate the Duration\n    Duration duration = Duration.between(then, now);\n    // print the minutes part\n    System.out.println(duration.toMinutesPart() + &quot; minutes ago&quot;);\n}\n</code></pre>\n<p>This just printed</p>\n<pre class=\"lang-none prettyprint-override\"><code>47 minutes ago\n</code></pre>\n<p>You will have to check which values (hours, minutes, seconds and so on) are actually zero if you want to switch from minutes to hours when minutes are 0, but hours aren't, for example. This would print <code>0 minutes ago</code> in 13 minutes and you may want to cover situations like that.</p>\n"},{"tags":[],"owner":{"account_id":6714862,"reputation":16230,"user_id":5176992,"display_name":"Eritrean"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1694773003,"creation_date":1694773003,"answer_id":77111532,"question_id":77111289,"body_markdown":"If you want to use a third party library, you might want to take a look at [PrettyTime Library][1]\r\n\r\n\r\n  [1]: https://github.com/ocpsoft/prettytime\r\n\r\nUsing PrettyTime your code could look as simple as:\r\n\r\n    String calculateTimeAgoWithPrettyTime(final Instant pastTime) {\r\n        PrettyTime prettyTime = new PrettyTime();\r\n        return prettyTime.format(pastTime);\r\n    }","title":"How to convert timestamp into human readable time string (for example &quot;one minute ago&quot;) in Java","body":"<p>If you want to use a third party library, you might want to take a look at <a href=\"https://github.com/ocpsoft/prettytime\" rel=\"nofollow noreferrer\">PrettyTime Library</a></p>\n<p>Using PrettyTime your code could look as simple as:</p>\n<pre><code>String calculateTimeAgoWithPrettyTime(final Instant pastTime) {\n    PrettyTime prettyTime = new PrettyTime();\n    return prettyTime.format(pastTime);\n}\n</code></pre>\n"}],"owner":{"account_id":24830565,"reputation":79,"user_id":18709793,"display_name":"Newbie_programmer"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":119,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"closed_date":1694870069,"accepted_answer_id":77111407,"answer_count":2,"score":0,"last_activity_date":1694792006,"creation_date":1694770735,"question_id":77111289,"body_markdown":"I am trying to create a chat application in android studio.  \r\nI have a timestamp, say this\r\n```none\r\n1694603269045\r\n```\r\nNow I want to convert this timestamp into human readable way like `one minute ago` or `one hour ago`. I will is into my `storyView` mode where a user will be able to see when his friends uploaded a story/status.\r\n\r\nI need this as `String`, like\r\n```none\r\none minute ago\r\n```\r\nso that I can use it in a `TextView`. Is that possible?\r\n\r\nI tried to find some solutions but most of them are related to javascript where I need it in Java.\r\nThe `String` needs to be like this: \r\n[![Example][1]][1]\r\n\r\nIs that possible in Java in some way? Thank You.\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/fIZTI.png","title":"How to convert timestamp into human readable time string (for example &quot;one minute ago&quot;) in Java","body":"<p>I am trying to create a chat application in android studio.<br />\nI have a timestamp, say this</p>\n<pre class=\"lang-none prettyprint-override\"><code>1694603269045\n</code></pre>\n<p>Now I want to convert this timestamp into human readable way like <code>one minute ago</code> or <code>one hour ago</code>. I will is into my <code>storyView</code> mode where a user will be able to see when his friends uploaded a story/status.</p>\n<p>I need this as <code>String</code>, like</p>\n<pre class=\"lang-none prettyprint-override\"><code>one minute ago\n</code></pre>\n<p>so that I can use it in a <code>TextView</code>. Is that possible?</p>\n<p>I tried to find some solutions but most of them are related to javascript where I need it in Java.\nThe <code>String</code> needs to be like this:\n<a href=\"https://i.stack.imgur.com/fIZTI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fIZTI.png\" alt=\"Example\" /></a></p>\n<p>Is that possible in Java in some way? Thank You.</p>\n"},{"tags":["java","jackson","deep-copy"],"comments":[{"owner":{"account_id":21287,"reputation":37465,"user_id":51591,"accept_rate":82,"display_name":"Michał Ziober"},"score":2,"creation_date":1668900301,"post_id":74501974,"comment_id":131519523,"body_markdown":"Have you tried: `.addMixIn(MultipartFile[].class, JacksonMixInForIgnoreType.class)`? It should work in the same way. Which version of Jackson do you use?","body":"Have you tried: <code>.addMixIn(MultipartFile[].class, JacksonMixInForIgnoreType.class)</code>? It should work in the same way. Which version of Jackson do you use?"}],"answers":[{"tags":[],"owner":{"account_id":4835964,"reputation":1710,"user_id":3902663,"accept_rate":78,"display_name":"SATO Yusuke"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1668957621,"creation_date":1668957621,"answer_id":74509369,"question_id":74501974,"body_markdown":"I am using Jackson Databind 2.13.1. The following code works for `MultipartFile[]` (based on @Michał Ziober&#39;s comment):\r\n\r\n```java\r\nprivate Object makeClone(Object obj) {\r\n    ObjectMapper mapper = new ObjectMapper();\r\n    mapper.addMixIn(MultipartFile.class, JacksonMixInForIgnoreType.class);\r\n    mapper.addMixIn(MultipartFile[].class, JacksonMixInForIgnoreType.class);\r\n    try {\r\n        return mapper.readValue(mapper.writeValueAsString(obj), obj.getClass());\r\n    } catch (JsonProcessingException e) {\r\n        throw new RuntimeException(e);\r\n    }\r\n}\r\n```\r\n\r\nAnd I couldn&#39;t find the way to ignore `List&lt;MultipartFile&gt;` with `ObjectMapper#addMixIn()`.\r\n","title":"Tell Jackson to ignore a property that is a array/collection of a specific type","body":"<p>I am using Jackson Databind 2.13.1. The following code works for <code>MultipartFile[]</code> (based on @Michał Ziober's comment):</p>\n<pre class=\"lang-java prettyprint-override\"><code>private Object makeClone(Object obj) {\n    ObjectMapper mapper = new ObjectMapper();\n    mapper.addMixIn(MultipartFile.class, JacksonMixInForIgnoreType.class);\n    mapper.addMixIn(MultipartFile[].class, JacksonMixInForIgnoreType.class);\n    try {\n        return mapper.readValue(mapper.writeValueAsString(obj), obj.getClass());\n    } catch (JsonProcessingException e) {\n        throw new RuntimeException(e);\n    }\n}\n</code></pre>\n<p>And I couldn't find the way to ignore <code>List&lt;MultipartFile&gt;</code> with <code>ObjectMapper#addMixIn()</code>.</p>\n"},{"tags":[],"owner":{"account_id":29453953,"reputation":1,"user_id":22570188,"display_name":"woordi52"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694791938,"creation_date":1694791769,"answer_id":77113612,"question_id":74501974,"body_markdown":"    ObjectMapper mapper = new ObjectMapper();\r\n    TypeFactory typeFactory = mapper.getTypeFactory();\r\n    CollectionType collectionType = typeFactory.constructCollectionType(List.class, MultipartFile.class);\r\n    mapper.configOverride(collectionType.getRawClass()).setIsIgnoredType(true);\r\n\r\nthis code worked for me, please try.","title":"Tell Jackson to ignore a property that is a array/collection of a specific type","body":"<pre><code>ObjectMapper mapper = new ObjectMapper();\nTypeFactory typeFactory = mapper.getTypeFactory();\nCollectionType collectionType = typeFactory.constructCollectionType(List.class, MultipartFile.class);\nmapper.configOverride(collectionType.getRawClass()).setIsIgnoredType(true);\n</code></pre>\n<p>this code worked for me, please try.</p>\n"}],"owner":{"account_id":4835964,"reputation":1710,"user_id":3902663,"accept_rate":78,"display_name":"SATO Yusuke"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":262,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":74509369,"answer_count":2,"score":0,"last_activity_date":1694791938,"creation_date":1668877526,"question_id":74501974,"body_markdown":"## Background\r\n\r\n- I want to clone DTOs that store values from a request in Spring Boot.\r\n  - Sometimes it has a non-serializable field (i.e. `MultipartFile`), so I can&#39;t use the strategy to use `ObjectOutputStream`/`ObjectInputStream` like https://stackoverflow.com/a/64066/3902663 .\r\n- I don&#39;t have control over these DTOs, so I can&#39;t add a `transient` modifier to ignore these fields.\r\n\r\n\r\n## What I tried\r\n\r\nI tried to write a method with Jackson&#39;s `ObjectMapper`. You can use `@JsonIgnoreType` and `ObjectMapper#addMixIn()` to ignore non-serializable fields according to their class without changing the definition of DTOs.\r\n\r\n```java\r\nprivate Object makeClone(Object obj) {\r\n    ObjectMapper mapper = new ObjectMapper();\r\n    mapper.addMixIn(MultipartFile.class, JacksonMixInForIgnoreType.class);\r\n    try {\r\n        return mapper.readValue(mapper.writeValueAsString(obj), obj.getClass());\r\n    } catch (JsonProcessingException e) {\r\n        throw new RuntimeException(e);\r\n    }\r\n}\r\n\r\n@JsonIgnoreType\r\nclass JacksonMixInForIgnoreType {}\r\n```\r\n\r\n## Problem\r\n\r\nYou can&#39;t ignore the field like `MultipartFile[] fileArray;` with this strategy. When you have an array of `MultipartFile` in a DTO to upload multiple files, the code above throws an exception like this:\r\n\r\n```\r\ncom.fasterxml.jackson.databind.exc.InvalidDefinitionException: No serializer found for class java.io.FileDescriptor and no properties discovered to create BeanSerializer (to avoid exception, disable SerializationFeature.FAIL_ON_EMPTY_BEANS) (through reference chain: com.example.uploadingfiles.DeepCopyDto[&quot;fileArray&quot;]-&gt;org.springframework.web.multipart.support.StandardMultipartHttpServletRequest$StandardMultipartFile[0]-&gt;org.springframework.web.multipart.support.StandardMultipartHttpServletRequest$StandardMultipartFile[&quot;inputStream&quot;]-&gt;java.io.FileInputStream[&quot;fd&quot;])\r\n        at com.fasterxml.jackson.databind.exc.InvalidDefinitionException.from(InvalidDefinitionException.java:77) ~[jackson-databind-2.13.1.jar:2.13.1]\r\n        at com.fasterxml.jackson.databind.SerializerProvider.reportBadDefinition(SerializerProvider.java:1300) ~[jackson-databind-2.13.1.jar:2.13.1]\r\n ...\r\n```\r\n\r\n## Question\r\n\r\nIs there any way to tell Jackson to ignore a property that is an array/collection of a specific type?\r\n","title":"Tell Jackson to ignore a property that is a array/collection of a specific type","body":"<h2>Background</h2>\n<ul>\n<li>I want to clone DTOs that store values from a request in Spring Boot.\n<ul>\n<li>Sometimes it has a non-serializable field (i.e. <code>MultipartFile</code>), so I can't use the strategy to use <code>ObjectOutputStream</code>/<code>ObjectInputStream</code> like <a href=\"https://stackoverflow.com/a/64066/3902663\">https://stackoverflow.com/a/64066/3902663</a> .</li>\n</ul>\n</li>\n<li>I don't have control over these DTOs, so I can't add a <code>transient</code> modifier to ignore these fields.</li>\n</ul>\n<h2>What I tried</h2>\n<p>I tried to write a method with Jackson's <code>ObjectMapper</code>. You can use <code>@JsonIgnoreType</code> and <code>ObjectMapper#addMixIn()</code> to ignore non-serializable fields according to their class without changing the definition of DTOs.</p>\n<pre class=\"lang-java prettyprint-override\"><code>private Object makeClone(Object obj) {\n    ObjectMapper mapper = new ObjectMapper();\n    mapper.addMixIn(MultipartFile.class, JacksonMixInForIgnoreType.class);\n    try {\n        return mapper.readValue(mapper.writeValueAsString(obj), obj.getClass());\n    } catch (JsonProcessingException e) {\n        throw new RuntimeException(e);\n    }\n}\n\n@JsonIgnoreType\nclass JacksonMixInForIgnoreType {}\n</code></pre>\n<h2>Problem</h2>\n<p>You can't ignore the field like <code>MultipartFile[] fileArray;</code> with this strategy. When you have an array of <code>MultipartFile</code> in a DTO to upload multiple files, the code above throws an exception like this:</p>\n<pre><code>com.fasterxml.jackson.databind.exc.InvalidDefinitionException: No serializer found for class java.io.FileDescriptor and no properties discovered to create BeanSerializer (to avoid exception, disable SerializationFeature.FAIL_ON_EMPTY_BEANS) (through reference chain: com.example.uploadingfiles.DeepCopyDto[&quot;fileArray&quot;]-&gt;org.springframework.web.multipart.support.StandardMultipartHttpServletRequest$StandardMultipartFile[0]-&gt;org.springframework.web.multipart.support.StandardMultipartHttpServletRequest$StandardMultipartFile[&quot;inputStream&quot;]-&gt;java.io.FileInputStream[&quot;fd&quot;])\n        at com.fasterxml.jackson.databind.exc.InvalidDefinitionException.from(InvalidDefinitionException.java:77) ~[jackson-databind-2.13.1.jar:2.13.1]\n        at com.fasterxml.jackson.databind.SerializerProvider.reportBadDefinition(SerializerProvider.java:1300) ~[jackson-databind-2.13.1.jar:2.13.1]\n ...\n</code></pre>\n<h2>Question</h2>\n<p>Is there any way to tell Jackson to ignore a property that is an array/collection of a specific type?</p>\n"},{"tags":["java"],"answers":[{"tags":[],"owner":{"account_id":16267237,"reputation":620,"user_id":11746899,"display_name":"Opri"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1694699126,"creation_date":1694698883,"answer_id":77105491,"question_id":77105433,"body_markdown":"The second instance t2 gets you also the nanoseconds, so it is more precise. The first one stops at milliseconds.\r\n\r\nt1 console log:\r\n2023-09-14 16:44:51.055\r\n\r\nt2 console log:\r\n2023-09-14 16:44:51.057259","title":"Any difference in creating Timestamp using constructor vs from an Instant","body":"<p>The second instance t2 gets you also the nanoseconds, so it is more precise. The first one stops at milliseconds.</p>\n<p>t1 console log:\n2023-09-14 16:44:51.055</p>\n<p>t2 console log:\n2023-09-14 16:44:51.057259</p>\n"},{"tags":[],"owner":{"account_id":18549439,"reputation":1201,"user_id":13515974,"display_name":"Zufar Sunagatov"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1694698950,"creation_date":1694698950,"answer_id":77105505,"question_id":77105433,"body_markdown":"I know that there is only one not significant difference:\r\n\r\n `Timestamp.from(Instant.now())` is more precise, as it can represent timestamps with a resolution of nanoseconds. \r\n\r\n`new Timestamp(System.currentTimeMillis())` can only represent timestamps with a resolution of milliseconds.\r\n\r\n","title":"Any difference in creating Timestamp using constructor vs from an Instant","body":"<p>I know that there is only one not significant difference:</p>\n<p><code>Timestamp.from(Instant.now())</code> is more precise, as it can represent timestamps with a resolution of nanoseconds.</p>\n<p><code>new Timestamp(System.currentTimeMillis())</code> can only represent timestamps with a resolution of milliseconds.</p>\n"},{"tags":[],"owner":{"account_id":5860066,"reputation":13475,"user_id":4616087,"display_name":"Marvin"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694698978,"creation_date":1694698978,"answer_id":77105509,"question_id":77105433,"body_markdown":"By looking at the [source code][1] there are indeed subtle differences in the implementation:\r\n\r\n```\r\npublic static Timestamp from(Instant instant) {\r\n    try {\r\n        Timestamp stamp = new Timestamp(instant.getEpochSecond() * MILLIS_PER_SECOND);\r\n        stamp.nanos = instant.getNano();\r\n        return stamp;\r\n    } catch (ArithmeticException ex) {\r\n        throw new IllegalArgumentException(ex);\r\n    }\r\n}\r\n```\r\nvs\r\n```\r\npublic Timestamp(long time) {\r\n    super((time/1000)*1000);\r\n    nanos = (int)((time%1000) * 1000000);\r\n    if (nanos &lt; 0) {\r\n        nanos = 1000000000 + nanos;\r\n        super.setTime(((time/1000)-1)*1000);\r\n    }\r\n}\r\n```\r\n\r\nIn practice I&#39;d say that none of those is significantly better or worse than the other(1). However, factory methods _may_ allow for optimizations in future JDK versions (cf. https://stackoverflow.com/q/3130311/4616087) so I&#39;d personally prefer `from`.\r\n\r\n(1) Other answers mention the different resolution of nanos vs millis but that also depends on the system clock and more often than not does not make a difference in real-world code. It can also simply be remedied by using [`System.nanoTime()`][2].\r\n\r\n\r\n  [1]: https://github.com/openjdk/jdk/blob/master/src/java.sql/share/classes/java/sql/Timestamp.java\r\n  [2]: https://download.java.net/java/early_access/jdk21/docs/api/java.base/java/lang/System.html#nanoTime()","title":"Any difference in creating Timestamp using constructor vs from an Instant","body":"<p>By looking at the <a href=\"https://github.com/openjdk/jdk/blob/master/src/java.sql/share/classes/java/sql/Timestamp.java\" rel=\"nofollow noreferrer\">source code</a> there are indeed subtle differences in the implementation:</p>\n<pre><code>public static Timestamp from(Instant instant) {\n    try {\n        Timestamp stamp = new Timestamp(instant.getEpochSecond() * MILLIS_PER_SECOND);\n        stamp.nanos = instant.getNano();\n        return stamp;\n    } catch (ArithmeticException ex) {\n        throw new IllegalArgumentException(ex);\n    }\n}\n</code></pre>\n<p>vs</p>\n<pre><code>public Timestamp(long time) {\n    super((time/1000)*1000);\n    nanos = (int)((time%1000) * 1000000);\n    if (nanos &lt; 0) {\n        nanos = 1000000000 + nanos;\n        super.setTime(((time/1000)-1)*1000);\n    }\n}\n</code></pre>\n<p>In practice I'd say that none of those is significantly better or worse than the other(1). However, factory methods <em>may</em> allow for optimizations in future JDK versions (cf. <a href=\"https://stackoverflow.com/q/3130311/4616087\">Weird Integer boxing in Java</a>) so I'd personally prefer <code>from</code>.</p>\n<p>(1) Other answers mention the different resolution of nanos vs millis but that also depends on the system clock and more often than not does not make a difference in real-world code. It can also simply be remedied by using <a href=\"https://download.java.net/java/early_access/jdk21/docs/api/java.base/java/lang/System.html#nanoTime()\" rel=\"nofollow noreferrer\"><code>System.nanoTime()</code></a>.</p>\n"},{"tags":[],"owner":{"account_id":1689973,"reputation":37280,"user_id":1552534,"display_name":"WJS"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694703090,"creation_date":1694702702,"answer_id":77106035,"question_id":77105433,"body_markdown":"Sans any internal implementation differences, as long as you&#39;re talking about milliseconds then they are the same as they are both how many milliseconds from the epoch date and time (aka [Unix time](https://en.wikipedia.org/wiki/Unix_time#:~:text=Early%20definitions%20of%20Unix%20time,to%20avoid%20short%2Dterm%20overflow)) of 1970-01-01 00:00 UTC have elapsed.\r\n\r\nAny delta time it takes to invoke the two calls is somewhat mitigated by calling twice in different order and then averaging.\r\n```\r\nlong instant1 = Instant.now().toEpochMilli();\r\nlong system1 = System.currentTimeMillis();\r\n\r\nlong system2 = System.currentTimeMillis();\r\nlong instant2 = Instant.now().toEpochMilli();\r\n\r\nSystem.out.println((system1 + system2)/2);\r\nSystem.out.println((instant1 + instant2)/2);\r\n```\r\nprints something like\r\n```\r\n1694702273207\r\n1694702273207        ","title":"Any difference in creating Timestamp using constructor vs from an Instant","body":"<p>Sans any internal implementation differences, as long as you're talking about milliseconds then they are the same as they are both how many milliseconds from the epoch date and time (aka <a href=\"https://en.wikipedia.org/wiki/Unix_time#:%7E:text=Early%20definitions%20of%20Unix%20time,to%20avoid%20short%2Dterm%20overflow\" rel=\"nofollow noreferrer\">Unix time</a>) of 1970-01-01 00:00 UTC have elapsed.</p>\n<p>Any delta time it takes to invoke the two calls is somewhat mitigated by calling twice in different order and then averaging.</p>\n<pre><code>long instant1 = Instant.now().toEpochMilli();\nlong system1 = System.currentTimeMillis();\n\nlong system2 = System.currentTimeMillis();\nlong instant2 = Instant.now().toEpochMilli();\n\nSystem.out.println((system1 + system2)/2);\nSystem.out.println((instant1 + instant2)/2);\n</code></pre>\n<p>prints something like</p>\n<pre><code>1694702273207\n1694702273207        \n</code></pre>\n"},{"tags":[],"owner":{"account_id":19118721,"reputation":6319,"user_id":13963086,"display_name":"k314159"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1694706390,"creation_date":1694706390,"answer_id":77106528,"question_id":77105433,"body_markdown":"Which one is better depends on your requirements. If you want more than milliseconds precision, use `Timestamp.from(Instant.now())`. However, you should bear the following points in mind:\r\n\r\n1. Your system clock almost certainly does not have nanosecond accuracy. You will be lucky if it is within a millisecond of actual UTC.\r\n2. Your DBMS probably holds SQL timestamp values with less than nanosecond precision. For example, PostgreSQL has microsecond precision.\r\n3. Using the nanoseconds from `Instant.now()` is only useful when you compare two such instants to see which one came first. Even then, it is not 100% guaranteed that Instant uses a monotonic clock (so not 100% guaranteed that if you call `Instant.now()` twice, you&#39;ll get a higher value from the second call). However, on a well maintained Linux system running `ntpd`, your system clock _should_ be monotonic and therefore, in those circumstances, you _could_ use the timestamp to determine which event came after which.","title":"Any difference in creating Timestamp using constructor vs from an Instant","body":"<p>Which one is better depends on your requirements. If you want more than milliseconds precision, use <code>Timestamp.from(Instant.now())</code>. However, you should bear the following points in mind:</p>\n<ol>\n<li>Your system clock almost certainly does not have nanosecond accuracy. You will be lucky if it is within a millisecond of actual UTC.</li>\n<li>Your DBMS probably holds SQL timestamp values with less than nanosecond precision. For example, PostgreSQL has microsecond precision.</li>\n<li>Using the nanoseconds from <code>Instant.now()</code> is only useful when you compare two such instants to see which one came first. Even then, it is not 100% guaranteed that Instant uses a monotonic clock (so not 100% guaranteed that if you call <code>Instant.now()</code> twice, you'll get a higher value from the second call). However, on a well maintained Linux system running <code>ntpd</code>, your system clock <em>should</em> be monotonic and therefore, in those circumstances, you <em>could</em> use the timestamp to determine which event came after which.</li>\n</ol>\n"},{"tags":[],"owner":{"account_id":322981,"reputation":310745,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1694791859,"creation_date":1694718748,"answer_id":77107792,"question_id":77105433,"body_markdown":"# Moot question\r\n\r\nSeveral good Answers already. But none mention the most important thing: Your Question is moot. \r\n\r\nThe terribly flawed `java.sql.Timestamp` class was years ago supplanted by the modern *java.time* classes defined in JSR 310 for Java 8+. Specifically replaced by `OffsetDateTime` for JDBC (database access), and by `Instant` for more general purposes. \r\n\r\n[JDBC][1] 4.2+ requires all [drivers][2] to support *java.time*. [Jakarta Persistence][3] (JPA) and [Hibernate][4] have been updated to support *java.time*. \r\n\r\nSo there is **no reason for you to be constructing any `Timestamp`** objects. Do all your work in *java.time* classes. \r\n\r\n## *java.time* with JDBC\r\n\r\n    OffsetDateTime odt = OffsetDateTime.now() ;\r\n    myPreparedStatement.setObject( … , odt ) ;\r\n\r\nRetrieval:\r\n\r\n    OffsetDateTime odt = myReultSet.getObject( … , OffsetDateTime.class ) ; \r\n\r\n## Converting legacy ↔ modern\r\n\r\nYou may need to interoperate with old code not yet updated to *java.time*. You can convert back and forth between legacy and modern classes by calling new conversion methods added to the old classes. \r\n\r\n    Timestamp ts = java.sql.Timestamp.from( odt.toInstant() ) ;\r\n\r\nAnd the other direction:\r\n\r\n    Instant instant = ts.toInstant() ;\r\n    OffsetDateTime odt = instant.atOffset( ZoneOffset.UTC ) ;\r\n\r\nBy the way… Both `OffsetDateTime` and `Instant` resolve to nanoseconds. Be aware that many databases do not support such fine granularity. You can [truncate][5] your *java.time* objects if need be. \r\n\r\n    \r\n    \r\n\r\n\r\n  [1]: https://en.m.wikipedia.org/wiki/Java_Database_Connectivity\r\n  [2]: https://en.m.wikipedia.org/wiki/JDBC_driver\r\n  [3]: https://en.m.wikipedia.org/wiki/Jakarta_Persistence\r\n  [4]: https://en.m.wikipedia.org/wiki/Hibernate_(framework)\r\n  [5]: https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/time/Instant.html#truncatedTo(java.time.temporal.TemporalUnit)","title":"Any difference in creating Timestamp using constructor vs from an Instant","body":"<h1>Moot question</h1>\n<p>Several good Answers already. But none mention the most important thing: Your Question is moot.</p>\n<p>The terribly flawed <code>java.sql.Timestamp</code> class was years ago supplanted by the modern <em>java.time</em> classes defined in JSR 310 for Java 8+. Specifically replaced by <code>OffsetDateTime</code> for JDBC (database access), and by <code>Instant</code> for more general purposes.</p>\n<p><a href=\"https://en.m.wikipedia.org/wiki/Java_Database_Connectivity\" rel=\"nofollow noreferrer\">JDBC</a> 4.2+ requires all <a href=\"https://en.m.wikipedia.org/wiki/JDBC_driver\" rel=\"nofollow noreferrer\">drivers</a> to support <em>java.time</em>. <a href=\"https://en.m.wikipedia.org/wiki/Jakarta_Persistence\" rel=\"nofollow noreferrer\">Jakarta Persistence</a> (JPA) and <a href=\"https://en.m.wikipedia.org/wiki/Hibernate_(framework)\" rel=\"nofollow noreferrer\">Hibernate</a> have been updated to support <em>java.time</em>.</p>\n<p>So there is <strong>no reason for you to be constructing any <code>Timestamp</code></strong> objects. Do all your work in <em>java.time</em> classes.</p>\n<h2><em>java.time</em> with JDBC</h2>\n<pre><code>OffsetDateTime odt = OffsetDateTime.now() ;\nmyPreparedStatement.setObject( … , odt ) ;\n</code></pre>\n<p>Retrieval:</p>\n<pre><code>OffsetDateTime odt = myReultSet.getObject( … , OffsetDateTime.class ) ; \n</code></pre>\n<h2>Converting legacy ↔ modern</h2>\n<p>You may need to interoperate with old code not yet updated to <em>java.time</em>. You can convert back and forth between legacy and modern classes by calling new conversion methods added to the old classes.</p>\n<pre><code>Timestamp ts = java.sql.Timestamp.from( odt.toInstant() ) ;\n</code></pre>\n<p>And the other direction:</p>\n<pre><code>Instant instant = ts.toInstant() ;\nOffsetDateTime odt = instant.atOffset( ZoneOffset.UTC ) ;\n</code></pre>\n<p>By the way… Both <code>OffsetDateTime</code> and <code>Instant</code> resolve to nanoseconds. Be aware that many databases do not support such fine granularity. You can <a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/time/Instant.html#truncatedTo(java.time.temporal.TemporalUnit)\" rel=\"nofollow noreferrer\">truncate</a> your <em>java.time</em> objects if need be.</p>\n"}],"owner":{"account_id":16466407,"reputation":584,"user_id":11896414,"display_name":"once"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":113,"favorite_count":0,"down_vote_count":2,"up_vote_count":4,"accepted_answer_id":77106528,"answer_count":6,"score":2,"last_activity_date":1694791859,"creation_date":1694698397,"question_id":77105433,"body_markdown":"I was wondering is there any difference or which one is better between these two in creating a current sql `timestamp`\r\n\r\n    java.sql.Timestamp t1 = new Timestamp(System.currentTimeMillis());\r\n    \r\n    java.sql.Timestamp t2 = Timestamp.from(Instant.now());","title":"Any difference in creating Timestamp using constructor vs from an Instant","body":"<p>I was wondering is there any difference or which one is better between these two in creating a current sql <code>timestamp</code></p>\n<pre><code>java.sql.Timestamp t1 = new Timestamp(System.currentTimeMillis());\n\njava.sql.Timestamp t2 = Timestamp.from(Instant.now());\n</code></pre>\n"},{"tags":["java","spring","jdbc","sybase","jconnect"],"comments":[{"owner":{"account_id":47283,"reputation":703817,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":0,"creation_date":1694792519,"post_id":77113363,"comment_id":135942298,"body_markdown":"If you Google for &quot;sybase jdbc driver&quot; you will see a number of search results.  The Sybase documentation suggests the SQL Anywhere JDBC 3.0 driver or the SQL Anywhere JDBC 4.0 driver or the jConnect driver.  There are a few options to try.","body":"If you Google for &quot;sybase jdbc driver&quot; you will see a number of search results.  The Sybase documentation suggests the SQL Anywhere JDBC 3.0 driver or the SQL Anywhere JDBC 4.0 driver or the jConnect driver.  There are a few options to try."}],"owner":{"account_id":27071838,"reputation":207,"user_id":20622382,"display_name":"Seriously"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":44,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":0,"score":2,"last_activity_date":1694791083,"creation_date":1694789321,"question_id":77113363,"body_markdown":"I am successfullt able to connect to sybase db using jconnect4 lib &amp; bcpkix-jdk15on and below code\r\n\r\n```\r\nimport com.sybase.jdbc4.jdbc.SybDataSource;\r\nimport java.sql.Connection;\r\nimport java.sql.SQLException;\r\n\r\npublic class SybaseConnectionManager {\r\n    public static Connection getSybaseConnection(String serverName, String databaseName, String userName, String password, String url) throws DataGeneratorException {\r\n        SybDataSource ds = new SybDataSource();\r\n\r\n        try {\r\n            ds.setServerName(serverName);\r\n            ds.setDatabaseName(databaseName);\r\n            ds.setUser(userName);\r\n            ds.setPassword(password);\r\n\r\n            // Splitting URL by semicolon\r\n            String[] params = url.split(&quot;;&quot;);\r\n            for (String param : params) {\r\n                String[] props = param.split(&quot;=&quot;);\r\n                switch (props[0].toUpperCase()) {\r\n                    case &quot;PORT&quot;:\r\n                        ds.setPortNumber(Integer.parseInt(props[1]));\r\n                        break;\r\n                    case &quot;ENCRYPT_PASSWORD&quot;:\r\n                        ds.setENCRYPT_PASSWORD(props[1]);\r\n                        break;\r\n                    case &quot;RETRY_WITH_NO_ENCRYPTION&quot;:\r\n                        ds.setRETRY_WITH_NO_ENCRYPTION(props[1]);\r\n                        break;\r\n                    case &quot;JCE_PROVIDER_CLASS&quot;:\r\n                        ds.setJCE_PROVIDER_CLASS(props[1]);\r\n                        break;\r\n                }\r\n            }\r\n\r\n            // Get the connection\r\n            Connection con = ds.getConnection();\r\n            con.setAutoCommit(false);\r\n            return con;\r\n        } catch (SQLException e) {\r\n            log.error(&quot;Handling Sybase Exception&quot;, e);\r\n            throw new DataGeneratorException(e.getMessage());\r\n        }\r\n    }\r\n```\r\nI tried connecting to sybase db using jtds lib but getting error &quot;Adaptive Server requires encryption of the login password on the network&quot;. I created jdbc url for jtds like below \r\n```\r\njdbc:jtds:sybase://&lt;hostname&gt;:&lt;portno&gt;/&lt;dbname&gt;\r\nconn prop below:--\r\nuser:\r\npassword:\r\nencrypt_password:\r\nretry_with_no_encryyption:\r\njce_provider_class:\r\n```\r\nwhy I&#39;m trying to connect with sybase because of this issue jconnect4 with ojdbcx lib giving noclassfounderror in linux server when used in single application.\r\nhttps://stackoverflow.com/questions/77096194/getting-classnotfounderror-for-oracle-and-sybase-db-connection-in-linux-server","title":"How to make Connection to sybase db not using jconnect4 in java","body":"<p>I am successfullt able to connect to sybase db using jconnect4 lib &amp; bcpkix-jdk15on and below code</p>\n<pre><code>import com.sybase.jdbc4.jdbc.SybDataSource;\nimport java.sql.Connection;\nimport java.sql.SQLException;\n\npublic class SybaseConnectionManager {\n    public static Connection getSybaseConnection(String serverName, String databaseName, String userName, String password, String url) throws DataGeneratorException {\n        SybDataSource ds = new SybDataSource();\n\n        try {\n            ds.setServerName(serverName);\n            ds.setDatabaseName(databaseName);\n            ds.setUser(userName);\n            ds.setPassword(password);\n\n            // Splitting URL by semicolon\n            String[] params = url.split(&quot;;&quot;);\n            for (String param : params) {\n                String[] props = param.split(&quot;=&quot;);\n                switch (props[0].toUpperCase()) {\n                    case &quot;PORT&quot;:\n                        ds.setPortNumber(Integer.parseInt(props[1]));\n                        break;\n                    case &quot;ENCRYPT_PASSWORD&quot;:\n                        ds.setENCRYPT_PASSWORD(props[1]);\n                        break;\n                    case &quot;RETRY_WITH_NO_ENCRYPTION&quot;:\n                        ds.setRETRY_WITH_NO_ENCRYPTION(props[1]);\n                        break;\n                    case &quot;JCE_PROVIDER_CLASS&quot;:\n                        ds.setJCE_PROVIDER_CLASS(props[1]);\n                        break;\n                }\n            }\n\n            // Get the connection\n            Connection con = ds.getConnection();\n            con.setAutoCommit(false);\n            return con;\n        } catch (SQLException e) {\n            log.error(&quot;Handling Sybase Exception&quot;, e);\n            throw new DataGeneratorException(e.getMessage());\n        }\n    }\n</code></pre>\n<p>I tried connecting to sybase db using jtds lib but getting error &quot;Adaptive Server requires encryption of the login password on the network&quot;. I created jdbc url for jtds like below</p>\n<pre><code>jdbc:jtds:sybase://&lt;hostname&gt;:&lt;portno&gt;/&lt;dbname&gt;\nconn prop below:--\nuser:\npassword:\nencrypt_password:\nretry_with_no_encryyption:\njce_provider_class:\n</code></pre>\n<p>why I'm trying to connect with sybase because of this issue jconnect4 with ojdbcx lib giving noclassfounderror in linux server when used in single application.\n<a href=\"https://stackoverflow.com/questions/77096194/getting-classnotfounderror-for-oracle-and-sybase-db-connection-in-linux-server\">Getting ClassNotFoundError for oracle and sybase db connection in linux server, but in local wndows eclipse it is working fine</a></p>\n"},{"tags":["java","spring-boot","threadpool"],"answers":[{"tags":[],"owner":{"account_id":477949,"reputation":5596,"user_id":889742,"accept_rate":28,"display_name":"Gonen I"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1633716682,"creation_date":1633716022,"answer_id":69500000,"question_id":69498421,"body_markdown":"Short answer? Yes\r\n\r\nOn shutdown ( either by hitting by a request to the shutdown end point or by calling applicationcontext.close ) by default, Spring&#39;s TaskExecutor simply interrupts all running tasks.\r\n\r\nNote that your threads must be in an interruptible state (e.g. sleep) to actually be interrupted.  \r\n\r\nIn some cases you may want to wait for all running tasks to be complete.\r\n\r\ncalling setWaitForTasksToCompleteOnShutdown(true) simply prevents interrupting the running tasks on shutdown and ensures that both the currently executing tasks and queued up tasks are completed.\r\n\r\n\r\n( I assume this is because they are non-daemon threads that prevent application exit. )\r\n\r\nIn short, the answer to your question is yes.\r\n\r\nYou can play with the following piece of code. When you change setWait from false to true, you will see that the application will not exit until the sleep is over. When you set it to false, the application will terminate immediately.\r\n\r\n    import javax.annotation.PostConstruct;\r\n    \r\n    import org.springframework.beans.factory.annotation.Autowired;\r\n    import org.springframework.boot.SpringApplication;\r\n    import org.springframework.boot.autoconfigure.SpringBootApplication;\r\n    import org.springframework.context.ConfigurableApplicationContext;\r\n    import org.springframework.context.annotation.Bean;\r\n    import org.springframework.core.task.TaskExecutor;\r\n    import org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor;\r\n    \r\n    \r\n    @SpringBootApplication\r\n    public class Application {\r\n    \t@Autowired\r\n    \tprivate TaskExecutor taskExecutor;\r\n    \t\r\n    \t@Bean\r\n    \tpublic TaskExecutor taskExecutor() {\r\n    \t    ThreadPoolTaskExecutor taskExecutor = new ThreadPoolTaskExecutor();\r\n    \t    taskExecutor.setCorePoolSize(2);\r\n    \t    taskExecutor.setMaxPoolSize(2);\r\n    \t    taskExecutor.setWaitForTasksToCompleteOnShutdown(false);\r\n    \t    taskExecutor.initialize();\r\n    \t    return taskExecutor;\r\n    \t}\r\n    \t\r\n    \t@PostConstruct\r\n    \tpublic void runTaskOnStartup() {\r\n    \t    for (int i = 0; i &lt; 1; i++) {\r\n    \t        taskExecutor.execute(() -&gt; {\r\n    \t            try {\r\n    \t\t\t\t\tThread.sleep(10_000);\r\n    \t\t\t\t} catch (InterruptedException e) {\r\n    \t\t\t\t\tSystem.out.println(&quot;Sleep Interrupted!&quot;);\r\n    \t\t\t\t\te.printStackTrace();\r\n    \t\t\t\t}\r\n    \t        });\r\n    \t    }\r\n    \t}\r\n    \t\r\n        public static void main(String[] args) {\r\n            ConfigurableApplicationContext run = SpringApplication.run(Application.class, args);\r\n            run.close();\r\n        }\r\n    }\r\n\r\n\r\n","title":"Spring Boot async task stuck on shutdown","body":"<p>Short answer? Yes</p>\n<p>On shutdown ( either by hitting by a request to the shutdown end point or by calling applicationcontext.close ) by default, Spring's TaskExecutor simply interrupts all running tasks.</p>\n<p>Note that your threads must be in an interruptible state (e.g. sleep) to actually be interrupted.</p>\n<p>In some cases you may want to wait for all running tasks to be complete.</p>\n<p>calling setWaitForTasksToCompleteOnShutdown(true) simply prevents interrupting the running tasks on shutdown and ensures that both the currently executing tasks and queued up tasks are completed.</p>\n<p>( I assume this is because they are non-daemon threads that prevent application exit. )</p>\n<p>In short, the answer to your question is yes.</p>\n<p>You can play with the following piece of code. When you change setWait from false to true, you will see that the application will not exit until the sleep is over. When you set it to false, the application will terminate immediately.</p>\n<pre><code>import javax.annotation.PostConstruct;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.context.ConfigurableApplicationContext;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.core.task.TaskExecutor;\nimport org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor;\n\n\n@SpringBootApplication\npublic class Application {\n    @Autowired\n    private TaskExecutor taskExecutor;\n    \n    @Bean\n    public TaskExecutor taskExecutor() {\n        ThreadPoolTaskExecutor taskExecutor = new ThreadPoolTaskExecutor();\n        taskExecutor.setCorePoolSize(2);\n        taskExecutor.setMaxPoolSize(2);\n        taskExecutor.setWaitForTasksToCompleteOnShutdown(false);\n        taskExecutor.initialize();\n        return taskExecutor;\n    }\n    \n    @PostConstruct\n    public void runTaskOnStartup() {\n        for (int i = 0; i &lt; 1; i++) {\n            taskExecutor.execute(() -&gt; {\n                try {\n                    Thread.sleep(10_000);\n                } catch (InterruptedException e) {\n                    System.out.println(&quot;Sleep Interrupted!&quot;);\n                    e.printStackTrace();\n                }\n            });\n        }\n    }\n    \n    public static void main(String[] args) {\n        ConfigurableApplicationContext run = SpringApplication.run(Application.class, args);\n        run.close();\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":22670093,"reputation":51,"user_id":16841967,"display_name":"Bruno Genovese"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1694790775,"creation_date":1694790775,"answer_id":77113515,"question_id":69498421,"body_markdown":"As far as I can tell after extensive googling the root cause is that in Java 17 (possibly earlier) they deprecated Thread.stop(), making threads that cannot be interrupted or stopped via a flag... unstoppable from inside java.\r\n\r\nI would love a better solution, but this clunky approach currently works for me:\r\n\r\n- Use the ThreadExecutor to launch the thread.\r\n- Add a &quot;stop&quot; flag that the thread code can check, ending the processing loop if set.\r\n- To stop, set the flag.  Wait for a &quot;stop tolerance time&quot; for the thread to hit that flag check and end cleanly.\r\n- After the tolerance time, if not stopped use an interrupt (2nd stop attempt).  I do it on the thread, which is possibly not ideal and it might be better to do it on the TaskExecutor.\r\n- A second later, if the thread still has not stopped, I use the deprecated Thread.stop() as a final resort (3rd stop attempt).  This is known to be a **bad approach**, but has not caused **me** any problems for a decade.  \r\n- As another undesirable alternative to stop, there is always the option to kill the executable itself, by hand.  Nasty, but under some emergency circumstances it might be the only way to stop a long-running thread.\r\n\r\nI sincerely hope I am wrong and that there is a better way to stop uninterruptible long-running threads, but I found no better answer anywhere.\r\n\r\nIf anybody knows of a better solution, please mention it and I&#39;ll edit this post.","title":"Spring Boot async task stuck on shutdown","body":"<p>As far as I can tell after extensive googling the root cause is that in Java 17 (possibly earlier) they deprecated Thread.stop(), making threads that cannot be interrupted or stopped via a flag... unstoppable from inside java.</p>\n<p>I would love a better solution, but this clunky approach currently works for me:</p>\n<ul>\n<li>Use the ThreadExecutor to launch the thread.</li>\n<li>Add a &quot;stop&quot; flag that the thread code can check, ending the processing loop if set.</li>\n<li>To stop, set the flag.  Wait for a &quot;stop tolerance time&quot; for the thread to hit that flag check and end cleanly.</li>\n<li>After the tolerance time, if not stopped use an interrupt (2nd stop attempt).  I do it on the thread, which is possibly not ideal and it might be better to do it on the TaskExecutor.</li>\n<li>A second later, if the thread still has not stopped, I use the deprecated Thread.stop() as a final resort (3rd stop attempt).  This is known to be a <strong>bad approach</strong>, but has not caused <strong>me</strong> any problems for a decade.</li>\n<li>As another undesirable alternative to stop, there is always the option to kill the executable itself, by hand.  Nasty, but under some emergency circumstances it might be the only way to stop a long-running thread.</li>\n</ul>\n<p>I sincerely hope I am wrong and that there is a better way to stop uninterruptible long-running threads, but I found no better answer anywhere.</p>\n<p>If anybody knows of a better solution, please mention it and I'll edit this post.</p>\n"}],"owner":{"account_id":22980025,"reputation":85,"user_id":17107099,"display_name":"newbie"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":2947,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"accepted_answer_id":69500000,"answer_count":2,"score":3,"last_activity_date":1694790775,"creation_date":1633707455,"question_id":69498421,"body_markdown":"As per spring documentation for `setWaitForTasksToCompleteOnShutdown` \r\n&gt; Set whether to wait for scheduled tasks to complete on shutdown\r\n\r\nDoes it mean that if any task is stuck on some long running process and we explicity try to stop the container, it will not be terminated untill that task is finished?\r\n\r\n```Java\r\n  @Bean\r\n  public TaskExecutor myAsyncTaskExecutor() {\r\n    ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();\r\n    executor.setCorePoolSize(20);\r\n    executor.setMaxPoolSize(30);\r\n    executor.setQueueCapacity(50);\r\n    executor.setWaitForTasksToCompleteOnShutdown(true); // How it behaves?\r\n    //executor.afterPropertiesSet();\r\n    executor.setThreadNamePrefix(&quot;MY-ASYNC-TASK&quot;);\r\n    executor.initialize();\r\n    return executor;\r\n  }\r\n```\r\n\r\nThanks for the answers.\r\n","title":"Spring Boot async task stuck on shutdown","body":"<p>As per spring documentation for <code>setWaitForTasksToCompleteOnShutdown</code></p>\n<blockquote>\n<p>Set whether to wait for scheduled tasks to complete on shutdown</p>\n</blockquote>\n<p>Does it mean that if any task is stuck on some long running process and we explicity try to stop the container, it will not be terminated untill that task is finished?</p>\n<pre><code>  @Bean\n  public TaskExecutor myAsyncTaskExecutor() {\n    ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();\n    executor.setCorePoolSize(20);\n    executor.setMaxPoolSize(30);\n    executor.setQueueCapacity(50);\n    executor.setWaitForTasksToCompleteOnShutdown(true); // How it behaves?\n    //executor.afterPropertiesSet();\n    executor.setThreadNamePrefix(&quot;MY-ASYNC-TASK&quot;);\n    executor.initialize();\n    return executor;\n  }\n</code></pre>\n<p>Thanks for the answers.</p>\n"},{"tags":["java","android","kotlin","file"],"comments":[{"owner":{"account_id":39846,"reputation":991133,"user_id":115145,"accept_rate":84,"display_name":"CommonsWare"},"score":5,"creation_date":1694790497,"post_id":77113471,"comment_id":135941869,"body_markdown":"&quot;this file is supposed to be deleted after I close my app&quot; -- what is your definition of &quot;close my app&quot;? `deleteOnExit()` will take effect when your process ends, which is handled by the OS on its own schedule.","body":"&quot;this file is supposed to be deleted after I close my app&quot; -- what is your definition of &quot;close my app&quot;? <code>deleteOnExit()</code> will take effect when your process ends, which is handled by the OS on its own schedule."},{"owner":{"account_id":4398965,"reputation":368,"user_id":3585218,"accept_rate":22,"display_name":"tipa"},"score":0,"creation_date":1696010483,"post_id":77113471,"comment_id":136104095,"body_markdown":"https://android.googlesource.com/platform/libcore.git/+/android-4.2.2_r1/luni/src/main/java/java/io/File.java#323 &quot;Note that on Android, the application lifecycle does not include VM termination, so calling this method will not ensure that files are deleted&quot;","body":"<a href=\"https://android.googlesource.com/platform/libcore.git/+/android-4.2.2_r1/luni/src/main/java/java/io/File.java#323\" rel=\"nofollow noreferrer\">android.googlesource.com/platform/libcore.git/+/&hellip;</a> &quot;Note that on Android, the application lifecycle does not include VM termination, so calling this method will not ensure that files are deleted&quot;"}],"owner":{"account_id":19214916,"reputation":96,"user_id":14039860,"display_name":"segoSambel"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":35,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694790351,"creation_date":1694790351,"question_id":77113471,"body_markdown":"This is my current implementation to create a temporary file inside the cache directory on Android. However, this file is supposed to be deleted after I close my app. Yet, this file is still present in my cache directory. My emulator is running Android 12 btw.\r\n\r\n```\r\nfun uriToFile(context: Context, uri: Uri): File? {\r\n    val contentResolver: ContentResolver = context.contentResolver\r\n    val fileExtension = getFileExtension(context, uri)\r\n    val fileName = &quot;file_${System.currentTimeMillis()}&quot;\r\n    val directory = context.cacheDir\r\n    val destinationFile = File.createTempFile(fileName, &quot;.$fileExtension&quot;, directory)\r\n    destinationFile.deleteOnExit()\r\n\r\n    try {\r\n        val inputStream: InputStream? = contentResolver.openInputStream(uri)\r\n        if (inputStream!=null) {\r\n            val outputStream = FileOutputStream(destinationFile)\r\n            val buffer = ByteArray(1024)\r\n            var bytesRead: Int\r\n            while (inputStream.read(buffer).also { bytesRead = it }!=-1) {\r\n                outputStream.write(buffer, 0, bytesRead)\r\n            }\r\n            outputStream.close()\r\n            inputStream.close()\r\n            return destinationFile\r\n        }\r\n    } catch (e: IOException) {\r\n        //\r\n    }\r\n    return null\r\n}\r\n\r\nprivate fun getFileExtension(context: Context, uri: Uri): String {\r\n    val contentResolver: ContentResolver = context.contentResolver\r\n    val mimeType = contentResolver.getType(uri)\r\n    return MimeTypeMap.getSingleton().getExtensionFromMimeType(mimeType)\r\n        ?: &quot;unknown&quot;\r\n}\r\n```\r\n\r\n\r\nI&#39;ve tried moving around the `destinationFile.deleteOnExit()`, but it didn&#39;t work.","title":"Temporary file not deleted after calling deleteOnExit","body":"<p>This is my current implementation to create a temporary file inside the cache directory on Android. However, this file is supposed to be deleted after I close my app. Yet, this file is still present in my cache directory. My emulator is running Android 12 btw.</p>\n<pre><code>fun uriToFile(context: Context, uri: Uri): File? {\n    val contentResolver: ContentResolver = context.contentResolver\n    val fileExtension = getFileExtension(context, uri)\n    val fileName = &quot;file_${System.currentTimeMillis()}&quot;\n    val directory = context.cacheDir\n    val destinationFile = File.createTempFile(fileName, &quot;.$fileExtension&quot;, directory)\n    destinationFile.deleteOnExit()\n\n    try {\n        val inputStream: InputStream? = contentResolver.openInputStream(uri)\n        if (inputStream!=null) {\n            val outputStream = FileOutputStream(destinationFile)\n            val buffer = ByteArray(1024)\n            var bytesRead: Int\n            while (inputStream.read(buffer).also { bytesRead = it }!=-1) {\n                outputStream.write(buffer, 0, bytesRead)\n            }\n            outputStream.close()\n            inputStream.close()\n            return destinationFile\n        }\n    } catch (e: IOException) {\n        //\n    }\n    return null\n}\n\nprivate fun getFileExtension(context: Context, uri: Uri): String {\n    val contentResolver: ContentResolver = context.contentResolver\n    val mimeType = contentResolver.getType(uri)\n    return MimeTypeMap.getSingleton().getExtensionFromMimeType(mimeType)\n        ?: &quot;unknown&quot;\n}\n</code></pre>\n<p>I've tried moving around the <code>destinationFile.deleteOnExit()</code>, but it didn't work.</p>\n"},{"tags":["java","xml","junit","webdriver","testng"],"answers":[{"tags":[],"owner":{"account_id":456728,"reputation":14328,"user_id":855636,"accept_rate":94,"display_name":"Pavel Janicek"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1335905459,"creation_date":1335905459,"answer_id":10404167,"question_id":10397117,"body_markdown":"I am going to make assumption - you would like to pass some parameter to the Webdriver. That can be done via two ways:\r\n\r\n 1. Make class which extends Webdriver and make its constructor to have the parameter which you need to pass. However, this is the **hard** way, because you have to implement/override all (needed) functions from webdriver:\r\n\r\n        public class MyWebdriver extends Webdriver{\r\n              private String theParameter;\r\n          \r\n             public MyWebdriver(String parameter){\r\n               //... initialize the Webdriver\r\n               \r\n               //store the parameter\r\n               theParameter = parameter\r\n        }\r\n\r\n 2. Make your own wrapper, which will contain instance off WebDriver. That is **easy**(-ier). For example: In my own tests, I need to tell the Webdriver which environment I am testing. So I created my own class for the Environment:\r\n\r\n        public class Environment{\r\n          private String baseUrl;\r\n          public enum NameOfEnvironment {DEV, ACC}\r\n          private NameOfEnvironment environment;\r\n\r\n          public Environment(NameOfEnvironment envName){\r\n             environment = envName;\r\n          }\r\n\r\n          public String getBaseUrl(){\r\n              switch (environment){\r\n                 case DEV: baseUrl = &quot;https://10.10.11.12:9080/test/&quot;;\r\n                           break;\r\n                 case ACC: baseUrl = &quot;https://acceptance.our-official-site.com&quot;;\r\n                           break;\r\n              }\r\n            return baseUrl;\r\n          }\r\n         }\r\n\r\nand then I have my own WebDriver wrapper, where I initialize it like this:\r\n\r\n    public class TestUI{\r\n          private Webdriver driver;\r\n          private Environment env;\r\n      \r\n       public TestUI(Environment e){\r\n           this.env = e;\r\n           driver = new FirefoxDriver;\r\n           driver.get(env.getBaseUrl());\r\n       }\r\n    }\r\n\r\nAnd in the test:\r\n\r\n     public class TestCases{\r\n\r\n       public static final Environment USED_ENVIRONMENT = new Environment(Environment.NameOfEnvironment.ACC);\r\n\r\n     @Test\r\n     public void testSomething(){\r\n        testUI test = new testUI(USED_ENVIRONMENT);\r\n        //.. further steps\r\n     }\r\n     }","title":"How to do parameterization in Selenium Webdriver?","body":"<p>I am going to make assumption - you would like to pass some parameter to the Webdriver. That can be done via two ways:</p>\n\n<ol>\n<li><p>Make class which extends Webdriver and make its constructor to have the parameter which you need to pass. However, this is the <strong>hard</strong> way, because you have to implement/override all (needed) functions from webdriver:</p>\n\n<pre><code>public class MyWebdriver extends Webdriver{\n      private String theParameter;\n\n     public MyWebdriver(String parameter){\n       //... initialize the Webdriver\n\n       //store the parameter\n       theParameter = parameter\n}\n</code></pre></li>\n<li><p>Make your own wrapper, which will contain instance off WebDriver. That is <strong>easy</strong>(-ier). For example: In my own tests, I need to tell the Webdriver which environment I am testing. So I created my own class for the Environment:</p>\n\n<pre><code>public class Environment{\n  private String baseUrl;\n  public enum NameOfEnvironment {DEV, ACC}\n  private NameOfEnvironment environment;\n\n  public Environment(NameOfEnvironment envName){\n     environment = envName;\n  }\n\n  public String getBaseUrl(){\n      switch (environment){\n         case DEV: baseUrl = \"https://10.10.11.12:9080/test/\";\n                   break;\n         case ACC: baseUrl = \"https://acceptance.our-official-site.com\";\n                   break;\n      }\n    return baseUrl;\n  }\n }\n</code></pre></li>\n</ol>\n\n<p>and then I have my own WebDriver wrapper, where I initialize it like this:</p>\n\n<pre><code>public class TestUI{\n      private Webdriver driver;\n      private Environment env;\n\n   public TestUI(Environment e){\n       this.env = e;\n       driver = new FirefoxDriver;\n       driver.get(env.getBaseUrl());\n   }\n}\n</code></pre>\n\n<p>And in the test:</p>\n\n<pre><code> public class TestCases{\n\n   public static final Environment USED_ENVIRONMENT = new Environment(Environment.NameOfEnvironment.ACC);\n\n @Test\n public void testSomething(){\n    testUI test = new testUI(USED_ENVIRONMENT);\n    //.. further steps\n }\n }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":471893,"reputation":8441,"user_id":879977,"display_name":"niharika_neo"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1335941260,"creation_date":1335941260,"answer_id":10408966,"question_id":10397117,"body_markdown":"My suggestion would be to try to use a testing framework (TestNG or Junit) which gives many more features than just parametrization.  Probably a little effort in setting up the framework in the beginning will save a lot of effort when your test code grows.","title":"How to do parameterization in Selenium Webdriver?","body":"<p>My suggestion would be to try to use a testing framework (TestNG or Junit) which gives many more features than just parametrization.  Probably a little effort in setting up the framework in the beginning will save a lot of effort when your test code grows.</p>\n"},{"tags":[],"owner":{"account_id":1530436,"reputation":1,"user_id":1427749,"display_name":"shashank"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1338449028,"creation_date":1338449028,"answer_id":10829112,"question_id":10397117,"body_markdown":"\tpublic void property(){\r\n\t\ttry {\r\n\t\t\t\r\n\t\t\tFile file = new File(&quot;login.properties&quot;);\r\n\t\t\tFileInputStream fileInput = new FileInputStream(file);\r\n\t\t\tProperties properties = new Properties();\r\n\t\t\tproperties.load(fileInput);\r\n\t\t\tfileInput.close();\r\n\r\n\t\t\tEnumeration enuKeys = properties.keys();\r\n\t\t\twhile (enuKeys.hasMoreElements()) {\r\n\t\t\t\tString key = (String) enuKeys.nextElement();\r\n\t\t\t\tString value = properties.getProperty(key);\r\n\t\t\t\tdriver.findElement(By.id(key)).sendKeys(value);\r\n\t\t\t\tSystem.out.println(key + &quot;: &quot; + value);\r\n\t\t\t}\r\n\t\t} catch (FileNotFoundException e) {\r\n\t\t\te.printStackTrace();\r\n\t\t} catch (IOException e) {\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\t}\r\nand to pass the values from the properties file use property(); in main class. and execute ","title":"How to do parameterization in Selenium Webdriver?","body":"<pre><code>public void property(){\n    try {\n\n        File file = new File(\"login.properties\");\n        FileInputStream fileInput = new FileInputStream(file);\n        Properties properties = new Properties();\n        properties.load(fileInput);\n        fileInput.close();\n\n        Enumeration enuKeys = properties.keys();\n        while (enuKeys.hasMoreElements()) {\n            String key = (String) enuKeys.nextElement();\n            String value = properties.getProperty(key);\n            driver.findElement(By.id(key)).sendKeys(value);\n            System.out.println(key + \": \" + value);\n        }\n    } catch (FileNotFoundException e) {\n        e.printStackTrace();\n    } catch (IOException e) {\n        e.printStackTrace();\n    }\n}\n</code></pre>\n\n<p>and to pass the values from the properties file use property(); in main class. and execute </p>\n"},{"tags":[],"owner":{"account_id":306604,"reputation":37084,"user_id":617450,"accept_rate":61,"display_name":"Ripon Al Wasim"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1344331010,"creation_date":1344331010,"answer_id":11842780,"question_id":10397117,"body_markdown":"    @Parameters({ &quot;first-name&quot; })\r\n    @Test\r\n    public void testSingleString(String firstName) {\r\n      System.out.println(&quot;Invoked testString &quot; + firstName);\r\n      assert &quot;Cedric&quot;.equals(firstName);\r\n    }\r\n\r\nIn this code, we specify that the parameter firstName of your Java method should receive the value of the XML parameter called first-name.  This XML parameter is defined in testng.xml:\r\n    &lt;suite name=&quot;My suite&quot;&gt;\r\n      &lt;parameter name=&quot;first-name&quot;  value=&quot;Cedric&quot;/&gt;\r\n      &lt;test name=&quot;Simple example&quot;&gt;\r\n      &lt;-- ... --&gt;\r\n\r\nFor more details, please visit the following:\r\nhttp://testng.org/doc/documentation-main.html#parameters\r\n\r\n","title":"How to do parameterization in Selenium Webdriver?","body":"<pre><code>@Parameters({ \"first-name\" })\n@Test\npublic void testSingleString(String firstName) {\n  System.out.println(\"Invoked testString \" + firstName);\n  assert \"Cedric\".equals(firstName);\n}\n</code></pre>\n\n<p>In this code, we specify that the parameter firstName of your Java method should receive the value of the XML parameter called first-name.  This XML parameter is defined in testng.xml:\n    \n      \n      \n      &lt;-- ... --></p>\n\n<p>For more details, please visit the following:\n<a href=\"http://testng.org/doc/documentation-main.html#parameters\" rel=\"nofollow\">http://testng.org/doc/documentation-main.html#parameters</a></p>\n"},{"tags":[],"owner":{"account_id":3713601,"reputation":1,"user_id":3090311,"display_name":"B-Gun"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1389177251,"creation_date":1389177251,"answer_id":20993067,"question_id":10397117,"body_markdown":"Here i am providing a test case that might be helpful            \r\n \r\n \r\n \r\n     package pac1;\r\n     import org.openqa.selenium.By;\r\n    import org.openqa.selenium.WebDriver;\r\n    import org.openqa.selenium.WebElement;\r\n    import org.openqa.selenium.support.ui.Wait;\r\n    import java.io.File;\r\n    import javax.xml.parsers.DocumentBuilder;\r\n      import javax.xml.parsers.DocumentBuilderFactory;\r\n     import org.w3c.dom.*;\r\n\r\n    public class test extends sut  {\r\n    static WebDriver driver;\r\n    static Wait&lt;WebDriver&gt; wait;\r\n      public static boolean run(WebDriver driverArg, Wait&lt;WebDriver&gt; waitArg)\r\n    {\r\n        driver = driverArg;\r\n        wait = waitArg;\r\n       // Run all the methods and return false if any fails\r\n        return (test1() );\r\n                      }\t\r\n       private static boolean test1()\r\n       {\r\n          \r\n\r\n\r\n      driver.get(&quot;https://accounts.google.com&quot;);\r\n\r\n    \ttry {\r\n    \t\tFile file = new File(&quot;emaildata.xml&quot;); //file location should be specified correctly put your xml in the same folder of the source code.\r\n    \t\t// Prepare XML\r\n    \t\tDocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\r\n    \t\tDocumentBuilder db = dbf.newDocumentBuilder();\r\n    \t\tDocument document = db.parse(file);\r\n    \t\tdocument.getDocumentElement().normalize();\r\n    \t\tNodeList emailNodeElementList = document.getElementsByTagName(&quot;test&quot;);//test is the name of the child tag \r\n    \t    for(int j=0;j&lt;emailNodeElementList.getLength(); j++)//loop for the multiple data\r\n    \t{\r\n    \t   String client = &quot;The username or password you entered is incorrect. ?&quot;;\r\n    \t\tElement emailNodeElement = (Element)emailNodeElementList.item(j);\r\n    \t\tNodeList details = emailNodeElement.getChildNodes();\r\n    \t\tString emailAddress=((Node) details.item(0)).getNodeValue();\r\n    \t\tSystem.out.println(&quot;email :&quot; + emailAddress);//it just prints which email is going to be parsed\r\n    \t\tWebElement element = driver.findElement(By.cssSelector(&quot;body&quot;));\r\n    \t        boolean feedBack = driver.findElement(By.cssSelector(&quot;body&quot;)).getText().contains(client);\r\n    \t        boolean feedbackVisible = element.isDisplayed();\r\n\r\n    \t\t\r\n        WebElement e1 = driver.findElement(By.id(&quot;Email&quot;));//getting the location from the web\r\n        e1.sendKeys(emailAddress);//sending keys to the server\r\n        WebElement e3 = driver.findElement(By.id(&quot;signIn&quot;));\r\n        e3.click();\r\n        \r\n       \r\n        if(feedBack==true){\r\n            System.out.println(client+ &quot;is present&quot;);\r\n            if(feedbackVisible==true){\r\n                System.out.println(client+ &quot;is visible&quot;);\r\n            }\r\n            else{\r\n                System.out.println(client+ &quot;is not visible&quot;);\r\n            }\r\n\r\n        }\r\n        else{\r\n            System.out.println(client+ &quot;is not present&quot;);\r\n\r\n        }\r\n    \t}\r\n      }\r\n     catch (Exception e) {e.printStackTrace();}\r\n   \r\n      return true;\r\n      }}\r\n    \r\n","title":"How to do parameterization in Selenium Webdriver?","body":"<p>Here i am providing a test case that might be helpful            </p>\n\n<pre><code> package pac1;\n import org.openqa.selenium.By;\nimport org.openqa.selenium.WebDriver;\nimport org.openqa.selenium.WebElement;\nimport org.openqa.selenium.support.ui.Wait;\nimport java.io.File;\nimport javax.xml.parsers.DocumentBuilder;\n  import javax.xml.parsers.DocumentBuilderFactory;\n import org.w3c.dom.*;\n\npublic class test extends sut  {\nstatic WebDriver driver;\nstatic Wait&lt;WebDriver&gt; wait;\n  public static boolean run(WebDriver driverArg, Wait&lt;WebDriver&gt; waitArg)\n{\n    driver = driverArg;\n    wait = waitArg;\n   // Run all the methods and return false if any fails\n    return (test1() );\n                  } \n   private static boolean test1()\n   {\n\n\n\n  driver.get(\"https://accounts.google.com\");\n\n    try {\n        File file = new File(\"emaildata.xml\"); //file location should be specified correctly put your xml in the same folder of the source code.\n        // Prepare XML\n        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n        DocumentBuilder db = dbf.newDocumentBuilder();\n        Document document = db.parse(file);\n        document.getDocumentElement().normalize();\n        NodeList emailNodeElementList = document.getElementsByTagName(\"test\");//test is the name of the child tag \n        for(int j=0;j&lt;emailNodeElementList.getLength(); j++)//loop for the multiple data\n    {\n       String client = \"The username or password you entered is incorrect. ?\";\n        Element emailNodeElement = (Element)emailNodeElementList.item(j);\n        NodeList details = emailNodeElement.getChildNodes();\n        String emailAddress=((Node) details.item(0)).getNodeValue();\n        System.out.println(\"email :\" + emailAddress);//it just prints which email is going to be parsed\n        WebElement element = driver.findElement(By.cssSelector(\"body\"));\n            boolean feedBack = driver.findElement(By.cssSelector(\"body\")).getText().contains(client);\n            boolean feedbackVisible = element.isDisplayed();\n\n\n    WebElement e1 = driver.findElement(By.id(\"Email\"));//getting the location from the web\n    e1.sendKeys(emailAddress);//sending keys to the server\n    WebElement e3 = driver.findElement(By.id(\"signIn\"));\n    e3.click();\n\n\n    if(feedBack==true){\n        System.out.println(client+ \"is present\");\n        if(feedbackVisible==true){\n            System.out.println(client+ \"is visible\");\n        }\n        else{\n            System.out.println(client+ \"is not visible\");\n        }\n\n    }\n    else{\n        System.out.println(client+ \"is not present\");\n\n    }\n    }\n  }\n catch (Exception e) {e.printStackTrace();}\n\n  return true;\n  }}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":12147097,"reputation":1,"user_id":8868964,"display_name":"dfhfghfgdfghdf"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1509549671,"creation_date":1509548853,"answer_id":47057904,"question_id":10397117,"body_markdown":"    /* You can pass parameters by creating two classes.\r\n    The first class, which you can call Main Class, will be public static void.\r\n    It will contain code such as:\r\n    */\r\n    WebDriver driver = new FirefoxDriver();\r\n    driver.get(&quot;https://www.google.com&quot;);\r\n    Parameters id = new Parameters();   //this is referring to second class\r\n\tdriver.findElement(By.name(&quot;q&quot;)).sendKeys(id.x);\r\n    //****************************************************************\r\n    //this is the second class [separate page] - here you can declare int or string varibale as public [so you can share them with other class while defining them]  - \r\n    //when you make this class - don&#39;t need to add public static void\r\n\r\n    public String x = &quot;username&quot;\r\n    //if you look at the first page, I&#39;m passing this string in the main script","title":"How to do parameterization in Selenium Webdriver?","body":"<pre><code>/* You can pass parameters by creating two classes.\nThe first class, which you can call Main Class, will be public static void.\nIt will contain code such as:\n*/\nWebDriver driver = new FirefoxDriver();\ndriver.get(\"https://www.google.com\");\nParameters id = new Parameters();   //this is referring to second class\ndriver.findElement(By.name(\"q\")).sendKeys(id.x);\n//****************************************************************\n//this is the second class [separate page] - here you can declare int or string varibale as public [so you can share them with other class while defining them]  - \n//when you make this class - don't need to add public static void\n\npublic String x = \"username\"\n//if you look at the first page, I'm passing this string in the main script\n</code></pre>\n"},{"tags":[],"owner":{"account_id":15849179,"reputation":1,"user_id":11435506,"display_name":"guest"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1556683733,"creation_date":1556683687,"answer_id":55931504,"question_id":10397117,"body_markdown":"    public class ReadExcel {\r\n           public String readData (String strSheetName, int strRowNo, int strCellNo) throws Exception {\r\n                 \r\n                  FileInputStream fis = new FileInputStream(&quot;D:\\\\Selenium\\\\TestData.xlsx&quot;);\r\n                  Workbook wb = WorkbookFactory.create(fis);\r\n                  Sheet sh = wb.getSheet(strSheetName);\r\n                  Row rw = sh.getRow(strRowNo);\r\n                  String val = rw.getCell(strCellNo).getStringCellValue();\r\n                  \r\n                  return val;\r\n                         \r\n                  }\r\n    \r\n    }\r\n\r\n","title":"How to do parameterization in Selenium Webdriver?","body":"<pre><code>public class ReadExcel {\n       public String readData (String strSheetName, int strRowNo, int strCellNo) throws Exception {\n\n              FileInputStream fis = new FileInputStream(\"D:\\\\Selenium\\\\TestData.xlsx\");\n              Workbook wb = WorkbookFactory.create(fis);\n              Sheet sh = wb.getSheet(strSheetName);\n              Row rw = sh.getRow(strRowNo);\n              String val = rw.getCell(strCellNo).getStringCellValue();\n\n              return val;\n\n              }\n\n}\n</code></pre>\n"}],"owner":{"account_id":1440553,"reputation":13,"user_id":1360832,"display_name":"Tufan"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":22284,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":7,"score":0,"last_activity_date":1694790175,"creation_date":1335872225,"question_id":10397117,"body_markdown":"How to do parameterization in Selenium 2 (WebDriver)? I use Eclipse with maven plugins and I have no previous experience on Selenium Webdriver. When I google for it then every thing shows about testNG and JUnit. Is there any method through which we can parameterized the Webdriver?","title":"How to do parameterization in Selenium Webdriver?","body":"<p>How to do parameterization in Selenium 2 (WebDriver)? I use Eclipse with maven plugins and I have no previous experience on Selenium Webdriver. When I google for it then every thing shows about testNG and JUnit. Is there any method through which we can parameterized the Webdriver?</p>\n"},{"tags":["java","completable-future"],"comments":[{"owner":{"account_id":39208,"reputation":251240,"user_id":112968,"accept_rate":68,"display_name":"knittl"},"score":0,"creation_date":1694789810,"post_id":77113065,"comment_id":135941732,"body_markdown":"You need to change your method to `Future&lt;ResponseEntity&lt;JsonNode&gt;&gt;` or block the thread while waiting for the future to complete.","body":"You need to change your method to <code>Future&lt;ResponseEntity&lt;JsonNode&gt;&gt;</code> or block the thread while waiting for the future to complete."},{"owner":{"account_id":39208,"reputation":251240,"user_id":112968,"accept_rate":68,"display_name":"knittl"},"score":0,"creation_date":1694791284,"post_id":77113065,"comment_id":135942051,"body_markdown":"Closely related: https://journal.stuffwithstuff.com/2015/02/01/what-color-is-your-function/ (you are calling a &quot;red&quot; function)","body":"Closely related: <a href=\"https://journal.stuffwithstuff.com/2015/02/01/what-color-is-your-function/\" rel=\"nofollow noreferrer\">journal.stuffwithstuff.com/2015/02/01/&hellip;</a> (you are calling a &quot;red&quot; function)"},{"owner":{"account_id":2085695,"reputation":1023,"user_id":1856744,"accept_rate":4,"display_name":"Stunner"},"score":0,"creation_date":1694792729,"post_id":77113065,"comment_id":135942337,"body_markdown":"@knittl  How should i block the thread till the future is complete? can u give some idea?","body":"@knittl  How should i block the thread till the future is complete? can u give some idea?"},{"owner":{"account_id":39208,"reputation":251240,"user_id":112968,"accept_rate":68,"display_name":"knittl"},"score":1,"creation_date":1694793042,"post_id":77113065,"comment_id":135942397,"body_markdown":"[`future.get(10, TimeUnit.SECONDS)`](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Future.html#get-long-java.util.concurrent.TimeUnit-)","body":"<a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Future.html#get-long-java.util.concurrent.TimeUnit-\" rel=\"nofollow noreferrer\"><code>future.get(10, TimeUnit.SECONDS)</code></a>"},{"owner":{"account_id":2085695,"reputation":1023,"user_id":1856744,"accept_rate":4,"display_name":"Stunner"},"score":0,"creation_date":1694794653,"post_id":77113065,"comment_id":135942654,"body_markdown":"This seems to be Future object from  io.vertx:vertx-core:3.9.0\nSo get method is not available. Only result() is available but no timeout can be passed","body":"This seems to be Future object from  io.vertx:vertx-core:3.9.0 So get method is not available. Only result() is available but no timeout can be passed"}],"answers":[{"tags":[],"owner":{"account_id":116746,"reputation":12467,"user_id":306030,"accept_rate":70,"display_name":"forty-two"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1694790111,"creation_date":1694790111,"answer_id":77113442,"question_id":77113065,"body_markdown":"You can use a CountDownLatch to wait for the result:\r\n\r\n```\r\n    public ResponseEntity&lt;JsonNode&gt; doSomeAction(\r\n            @ApiParam(name = &quot;mode&quot;, required = true) @PathVariable final String mode,\r\n            @RequestBody SomeAction action, HttpServletRequest request) throws IOException) {\r\n\r\n                ResponseEntity&lt;JSonObbject&gt; result = null;\r\n                CountDownLatch ready = new CountDownLatch(1);\r\n                if(mode.equals(&quot;POWER&quot;){\r\n                    Future&lt;JsonObject&gt; future = someAppService.generatePower(action);\r\n                    future.onComplete( result -&gt; {\r\n                        result = new ResponseEntity&lt;JsonNode&gt;(JsonHelper.toJsonNode(result.result().encode()), HttpStatus.OK)\r\n                        ready.countDown();\r\n                    });\r\n                } else if(mode.equals(&quot;someOtherMode&quot;){\r\n    \r\n                    //code that updates result variable\r\n    \r\n                } else {\r\n                   // take care of all other cases\r\n                }\r\n                \r\n                if (!ready.await(timeout, SECONDS) {\r\n                    // return error or throw appropriate exception\r\n                }\r\n                return result;\r\n    }\r\n```\r\n","title":"Java Future object return value from API after onComplete","body":"<p>You can use a CountDownLatch to wait for the result:</p>\n<pre><code>    public ResponseEntity&lt;JsonNode&gt; doSomeAction(\n            @ApiParam(name = &quot;mode&quot;, required = true) @PathVariable final String mode,\n            @RequestBody SomeAction action, HttpServletRequest request) throws IOException) {\n\n                ResponseEntity&lt;JSonObbject&gt; result = null;\n                CountDownLatch ready = new CountDownLatch(1);\n                if(mode.equals(&quot;POWER&quot;){\n                    Future&lt;JsonObject&gt; future = someAppService.generatePower(action);\n                    future.onComplete( result -&gt; {\n                        result = new ResponseEntity&lt;JsonNode&gt;(JsonHelper.toJsonNode(result.result().encode()), HttpStatus.OK)\n                        ready.countDown();\n                    });\n                } else if(mode.equals(&quot;someOtherMode&quot;){\n    \n                    //code that updates result variable\n    \n                } else {\n                   // take care of all other cases\n                }\n                \n                if (!ready.await(timeout, SECONDS) {\n                    // return error or throw appropriate exception\n                }\n                return result;\n    }\n</code></pre>\n"}],"owner":{"account_id":2085695,"reputation":1023,"user_id":1856744,"accept_rate":4,"display_name":"Stunner"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":52,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":77113442,"answer_count":1,"score":1,"last_activity_date":1694790111,"creation_date":1694786931,"question_id":77113065,"body_markdown":"I have a API method like below where the method returns `ResponseEntity&lt;JsonNode&gt;`. I don&#39;t know how to wait for it and return value in Future `onComplete` method.\r\n\r\n```\r\npublic ResponseEntity&lt;JsonNode&gt; doSomeAction(\r\n        @ApiParam(name = &quot;mode&quot;, required = true) @PathVariable final String mode,\r\n        @RequestBody SomeAction action, HttpServletRequest request) throws IOException) {\r\n\r\n            if(mode.equals(&quot;POWER&quot;){\r\n                Future&lt;JsonObject&gt; future = someAppService.generatePower(action);\r\n                future.onComplete( result -&gt; {\r\n                    return new ResponseEntity&lt;JsonNode&gt;(JsonHelper.toJsonNode(result.result().encode()), HttpStatus.OK)\r\n                    //above return is not valid but i want to return here as soon as future completes\r\n\r\n                });\r\n            }\r\n            if(mode.equals(&quot;someOtherMode&quot;){\r\n\r\n                //some code here\r\n\r\n            }\r\n            return new ResponseEntity&lt;JsonNode&gt;(JsonHelper.getObjectMapper().valueToTree(someResponse), headers, HttpStatus.OK);\r\n}\r\n```\r\n\r\nBasically , i want to return value in `onComplete` method i.e after generatePower() method is executed which internally invokes some API which might take some time.\r\nI tried to use `DeferredResult&lt;JsonNode&gt;` but its not working.  Any idea?","title":"Java Future object return value from API after onComplete","body":"<p>I have a API method like below where the method returns <code>ResponseEntity&lt;JsonNode&gt;</code>. I don't know how to wait for it and return value in Future <code>onComplete</code> method.</p>\n<pre><code>public ResponseEntity&lt;JsonNode&gt; doSomeAction(\n        @ApiParam(name = &quot;mode&quot;, required = true) @PathVariable final String mode,\n        @RequestBody SomeAction action, HttpServletRequest request) throws IOException) {\n\n            if(mode.equals(&quot;POWER&quot;){\n                Future&lt;JsonObject&gt; future = someAppService.generatePower(action);\n                future.onComplete( result -&gt; {\n                    return new ResponseEntity&lt;JsonNode&gt;(JsonHelper.toJsonNode(result.result().encode()), HttpStatus.OK)\n                    //above return is not valid but i want to return here as soon as future completes\n\n                });\n            }\n            if(mode.equals(&quot;someOtherMode&quot;){\n\n                //some code here\n\n            }\n            return new ResponseEntity&lt;JsonNode&gt;(JsonHelper.getObjectMapper().valueToTree(someResponse), headers, HttpStatus.OK);\n}\n</code></pre>\n<p>Basically , i want to return value in <code>onComplete</code> method i.e after generatePower() method is executed which internally invokes some API which might take some time.\nI tried to use <code>DeferredResult&lt;JsonNode&gt;</code> but its not working.  Any idea?</p>\n"},{"tags":["java","mysql","hibernate","jdbc"],"comments":[{"owner":{"account_id":2032926,"reputation":24901,"user_id":1816093,"accept_rate":57,"display_name":"Drew"},"score":0,"creation_date":1447431808,"post_id":33697213,"comment_id":55166156,"body_markdown":"classpath or servlet container setup issue for these error msgs. It is needing `mysql-connector-java-5.1.35-bin` jar or one of its siblings","body":"classpath or servlet container setup issue for these error msgs. It is needing <code>mysql-connector-java-5.1.35-bin</code> jar or one of its siblings"},{"owner":{"account_id":2460030,"reputation":118378,"user_id":2144390,"accept_rate":100,"display_name":"Gord Thompson"},"score":0,"creation_date":1447436884,"post_id":33697213,"comment_id":55169428,"body_markdown":"It looks like the .jar file is in the root folder of the project. Perhaps it should be under &quot;External Libraries&quot;? (I&#39;ve never used IntelliJ, but in Eclipse it would need to be in the &quot;Referenced Libraries&quot; folder, a.k.a. the classpath for the project.)","body":"It looks like the .jar file is in the root folder of the project. Perhaps it should be under &quot;External Libraries&quot;? (I&#39;ve never used IntelliJ, but in Eclipse it would need to be in the &quot;Referenced Libraries&quot; folder, a.k.a. the classpath for the project.)"},{"owner":{"account_id":27699053,"reputation":2348,"user_id":21144042,"display_name":"Diego Borba"},"score":0,"creation_date":1695037957,"post_id":33697213,"comment_id":135966224,"body_markdown":"Please, [do not upload images of code/data/error](https://meta.stackoverflow.com/questions/285551/why-should-i-not-upload-images-of-code-data-errors/285557#285557).","body":"Please, <a href=\"https://meta.stackoverflow.com/questions/285551/why-should-i-not-upload-images-of-code-data-errors/285557#285557\">do not upload images of code/data/error</a>."}],"answers":[{"tags":[],"owner":{"account_id":5324221,"reputation":99,"user_id":4246703,"accept_rate":50,"display_name":"K K"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1447437302,"creation_date":1447432401,"answer_id":33697516,"question_id":33697213,"body_markdown":"Please add **mysql-connector-java-5.1.x-bin.jar** not mysql-connector-java-5.1.x.jar. \r\n\r\nAlso, Add it to the global lib directory. For Tomcat this is `TOMCAT_HOME/lib`.\r\n\r\n1. Click File from File menu\r\n2. Project Structure (&lt;kbd&gt;CTRL&lt;/kbd&gt; + &lt;kbd&gt;SHIFT&lt;/kbd&gt; + &lt;kbd&gt;ALT&lt;/kbd&gt; + &lt;kbd&gt;S&lt;/kbd&gt; on Windows/Linux, &lt;kbd&gt;⌘&lt;/kbd&gt; + &lt;kbd&gt;;&lt;/kbd&gt; on Mac OS X)\r\n3. Select Modules at the left panel\r\n4. Dependencies tab\r\n5. Add... &amp;rarr; Project Library &amp;rarr;  Attach Jar\r\n\r\nTry this.","title":"Hibernate JDBC Driver com.mysql.jdbc.Driver could not be loaded","body":"<p>Please add <strong>mysql-connector-java-5.1.x-bin.jar</strong> not mysql-connector-java-5.1.x.jar. </p>\n\n<p>Also, Add it to the global lib directory. For Tomcat this is <code>TOMCAT_HOME/lib</code>.</p>\n\n<ol>\n<li>Click File from File menu</li>\n<li>Project Structure (<kbd>CTRL</kbd> + <kbd>SHIFT</kbd> + <kbd>ALT</kbd> + <kbd>S</kbd> on Windows/Linux, <kbd>⌘</kbd> + <kbd>;</kbd> on Mac OS X)</li>\n<li>Select Modules at the left panel</li>\n<li>Dependencies tab</li>\n<li>Add... &rarr; Project Library &rarr;  Attach Jar</li>\n</ol>\n\n<p>Try this.</p>\n"},{"tags":[],"owner":{"account_id":1132853,"reputation":2896,"user_id":1118527,"accept_rate":83,"display_name":"Lama"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1491756715,"creation_date":1491756715,"answer_id":43309351,"question_id":33697213,"body_markdown":"If you got maven support with your project, you can also add this dependency to your POM:\r\n\r\n    &lt;dependency&gt;\r\n    &lt;groupId&gt;mysql&lt;/groupId&gt;\r\n    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\r\n    &lt;version&gt;(current version)&lt;/version&gt;\r\n&lt;/dependency&gt;\r\n\r\n\r\nPlease also notice you might want to update the scope of your dependency if you deploy it.\r\n","title":"Hibernate JDBC Driver com.mysql.jdbc.Driver could not be loaded","body":"<p>If you got maven support with your project, you can also add this dependency to your POM:</p>\n\n<pre><code>&lt;dependency&gt;\n&lt;groupId&gt;mysql&lt;/groupId&gt;\n&lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\n&lt;version&gt;(current version)&lt;/version&gt;\n</code></pre>\n\n<p></p>\n\n<p>Please also notice you might want to update the scope of your dependency if you deploy it.</p>\n"},{"tags":[],"owner":{"account_id":29370870,"reputation":1,"user_id":22503527,"display_name":"Faslan Rizni"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694789841,"creation_date":1694789841,"answer_id":77113418,"question_id":33697213,"body_markdown":"To overcome from this issue, need to add hibernate manually to intalij(IDE)\r\n1) download hibernate orm dependency jar file\r\n2) open -&gt; lib -&gt; required -&gt;copy the files \r\n3) paste it in intalij(IDE)\r\n4)\r\nClick File from File menu\r\nProject Structure \r\nSelect Libraries at the left panel\r\nDependencies tab\r\nAdd... → Project Library → Attach Jar ","title":"Hibernate JDBC Driver com.mysql.jdbc.Driver could not be loaded","body":"<p>To overcome from this issue, need to add hibernate manually to intalij(IDE)</p>\n<ol>\n<li>download hibernate orm dependency jar file</li>\n<li>open -&gt; lib -&gt; required -&gt;copy the files</li>\n<li>paste it in intalij(IDE)</li>\n<li></li>\n</ol>\n<p>Click File from File menu\nProject Structure\nSelect Libraries at the left panel\nDependencies tab\nAdd... → Project Library → Attach Jar</p>\n"}],"owner":{"account_id":6154866,"reputation":79,"user_id":4798186,"accept_rate":67,"display_name":"Mary"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1478,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":33697516,"answer_count":3,"score":2,"last_activity_date":1694789841,"creation_date":1447431536,"question_id":33697213,"body_markdown":"I&#39;m trying to run this simple hibernate example: \r\n[tutorial link][1]\r\n\r\nError is\r\n\r\n&gt; Specified JDBC Driver com.mysql.jdbc.Driver could not be loaded\r\n\r\n[![enter image description here][2]][2]\r\n\r\n\r\nhere is an error stacktrace:\r\n\r\n[![enter image description here][3]][3]\r\n\r\n\r\n  [1]: http://www.tutorialspoint.com/hibernate/hibernate_examples.htm\r\n  [2]: http://i.stack.imgur.com/kRKsM.png\r\n  [3]: http://i.stack.imgur.com/NhwoK.png","title":"Hibernate JDBC Driver com.mysql.jdbc.Driver could not be loaded","body":"<p>I'm trying to run this simple hibernate example: \n<a href=\"http://www.tutorialspoint.com/hibernate/hibernate_examples.htm\" rel=\"nofollow noreferrer\">tutorial link</a></p>\n\n<p>Error is</p>\n\n<blockquote>\n  <p>Specified JDBC Driver com.mysql.jdbc.Driver could not be loaded</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/kRKsM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kRKsM.png\" alt=\"enter image description here\"></a></p>\n\n<p>here is an error stacktrace:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NhwoK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NhwoK.png\" alt=\"enter image description here\"></a></p>\n"},{"tags":["java","spring-boot","7zip"],"answers":[{"tags":[],"owner":{"account_id":7373320,"reputation":17364,"user_id":5612858,"display_name":"Arnaud"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1694789793,"creation_date":1694789793,"answer_id":77113413,"question_id":77113319,"body_markdown":"Examples found online, close the file after closing the archive.\r\n\r\nSomething like the following (depending on your needs, you may want to try-catch the close() calls separately) :\r\n\r\n    @PostMapping(&quot;/upload&quot;)\r\n    public void extractRar(@RequestBody UploadDto dto){\r\n        byte[] decodedBytes = Base64.getDecoder().decode(dto.data());\r\n        try {\r\n            String filePath = dto.name();\r\n            Files.write(Paths.get(filePath), decodedBytes);\r\n            log.info(&quot;File saved successfully to: &quot; + filePath);\r\n            File file = new File(filePath);\r\n            IInArchive archive;\r\n    \t\tRandomAccessFile randomAccessFile;\r\n            try {\r\n    \t\t\t\r\n    \t\t\trandomAccessFile = new RandomAccessFile(file, &quot;r&quot;);\r\n                archive = SevenZip.openInArchive(null, new RandomAccessFileInStream(randomAccessFile));\r\n                log.info(String.valueOf(archive.getNumberOfItems()));\r\n            } catch (SevenZipException | FileNotFoundException e) {\r\n                throw new RuntimeException(e);\r\n            }\r\n            archive.close();\r\n    \t\trandomAccessFile.close();\r\n    \r\n            // 1 method\r\n            Files.delete(Path.of(filePath));\r\n    \r\n            // 2 method\r\n            if (file.delete()) {\r\n                log.info(&quot;file deleted successfully&quot;);\r\n            } else {\r\n                log.error(&quot;failed to delete the temporary file used for unzipping&quot;);\r\n            }\r\n    \r\n        } catch (IOException e) {\r\n            throw new RuntimeException(e);\r\n        }\r\n    }","title":"Unable to delete file after using SevenZip.openArchive method in java","body":"<p>Examples found online, close the file after closing the archive.</p>\n<p>Something like the following (depending on your needs, you may want to try-catch the close() calls separately) :</p>\n<pre><code>@PostMapping(&quot;/upload&quot;)\npublic void extractRar(@RequestBody UploadDto dto){\n    byte[] decodedBytes = Base64.getDecoder().decode(dto.data());\n    try {\n        String filePath = dto.name();\n        Files.write(Paths.get(filePath), decodedBytes);\n        log.info(&quot;File saved successfully to: &quot; + filePath);\n        File file = new File(filePath);\n        IInArchive archive;\n        RandomAccessFile randomAccessFile;\n        try {\n            \n            randomAccessFile = new RandomAccessFile(file, &quot;r&quot;);\n            archive = SevenZip.openInArchive(null, new RandomAccessFileInStream(randomAccessFile));\n            log.info(String.valueOf(archive.getNumberOfItems()));\n        } catch (SevenZipException | FileNotFoundException e) {\n            throw new RuntimeException(e);\n        }\n        archive.close();\n        randomAccessFile.close();\n\n        // 1 method\n        Files.delete(Path.of(filePath));\n\n        // 2 method\n        if (file.delete()) {\n            log.info(&quot;file deleted successfully&quot;);\n        } else {\n            log.error(&quot;failed to delete the temporary file used for unzipping&quot;);\n        }\n\n    } catch (IOException e) {\n        throw new RuntimeException(e);\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":13956967,"reputation":97,"user_id":10079056,"display_name":"S H"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":32,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":77113413,"answer_count":1,"score":2,"last_activity_date":1694789793,"creation_date":1694788991,"question_id":77113319,"body_markdown":"In my endpoint I receive the content of a file as String in format base64.\r\nUnzipping works fine with SevenZip library, no problems there.\r\nBut after executing this line \r\n```\r\narchive = SevenZip.openInArchive(null, new RandomAccessFileInStream(\r\n                        new RandomAccessFile(file, &quot;r&quot;)));\r\n```\r\njava is unable to delete file because of following exception:\r\n```\r\njava.nio.file.FileSystemException: myFile.RAR: The process cannot access the file because it is being used by another process\r\n```\r\nI have tried to use junrar library, but SevenZip works better (supports RAR5 and identifies less corupted files as junrar).\r\n\r\npom.xml:\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n\txsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n\t&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n\t&lt;parent&gt;\r\n\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\r\n\t\t&lt;version&gt;3.1.3&lt;/version&gt;\r\n\t\t&lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\r\n\t&lt;/parent&gt;\r\n\t&lt;groupId&gt;com.example&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;demo&lt;/artifactId&gt;\r\n\t&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\r\n\t&lt;name&gt;demo&lt;/name&gt;\r\n\t&lt;description&gt;demo&lt;/description&gt;\r\n\t&lt;properties&gt;\r\n\t\t&lt;java.version&gt;17&lt;/java.version&gt;\r\n\t&lt;/properties&gt;\r\n\t&lt;dependencies&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;javax.validation&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;validation-api&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;2.0.1.Final&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;net.sf.sevenzipjbinding&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;sevenzipjbinding&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;16.02-2.01&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;net.sf.sevenzipjbinding&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;sevenzipjbinding-all-platforms&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;16.02-2.01&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t&lt;/dependencies&gt;\r\n\r\n\t&lt;build&gt;\r\n\t\t&lt;plugins&gt;\r\n\t\t\t&lt;plugin&gt;\r\n\t\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n\t\t\t&lt;/plugin&gt;\r\n\t\t&lt;/plugins&gt;\r\n\t&lt;/build&gt;\r\n\r\n&lt;/project&gt;\r\n```\r\n\r\n\r\nHere is the dto:\r\n```\r\npublic record UploadDto(\r\n        @NotNull\r\n        String name,\r\n        @NotNull\r\n        String data) {\r\n}\r\n```\r\n\r\nHere is the controller with the logic:\r\n```\r\nimport net.sf.sevenzipjbinding.IInArchive;\r\nimport net.sf.sevenzipjbinding.SevenZip;\r\nimport net.sf.sevenzipjbinding.SevenZipException;\r\nimport net.sf.sevenzipjbinding.impl.RandomAccessFileInStream;\r\nimport org.slf4j.Logger;\r\nimport org.slf4j.LoggerFactory;\r\nimport org.springframework.web.bind.annotation.*;\r\n\r\nimport java.io.File;\r\nimport java.io.FileNotFoundException;\r\nimport java.io.IOException;\r\nimport java.io.RandomAccessFile;\r\nimport java.nio.file.Files;\r\nimport java.nio.file.Path;\r\nimport java.nio.file.Paths;\r\nimport java.util.Base64;\r\n\r\n@RestController\r\npublic class TestController {\r\n    private final Logger log = LoggerFactory.getLogger(TestController.class);\r\n\r\n    @PostMapping(&quot;/upload&quot;)\r\n    public void extractRar(@RequestBody UploadDto dto){\r\n        byte[] decodedBytes = Base64.getDecoder().decode(dto.data());\r\n        try {\r\n            String filePath = dto.name();\r\n            Files.write(Paths.get(filePath), decodedBytes);\r\n            log.info(&quot;File saved successfully to: &quot; + filePath);\r\n            File file = new File(filePath);\r\n            IInArchive archive;\r\n            try {\r\n                archive = SevenZip.openInArchive(null, new RandomAccessFileInStream(\r\n                        new RandomAccessFile(file, &quot;r&quot;)));\r\n                log.info(String.valueOf(archive.getNumberOfItems()));\r\n            } catch (SevenZipException | FileNotFoundException e) {\r\n                throw new RuntimeException(e);\r\n            }\r\n            archive.close();\r\n\r\n            // 1 method\r\n            Files.delete(Path.of(filePath));\r\n\r\n            // 2 method\r\n            if (file.delete()) {\r\n                log.info(&quot;file deleted successfully&quot;);\r\n            } else {\r\n                log.error(&quot;failed to delete the temporary file used for unzipping&quot;);\r\n            }\r\n\r\n        } catch (IOException e) {\r\n            throw new RuntimeException(e);\r\n        }\r\n    }\r\n\r\n}\r\n```\r\nexample of request body :\r\n```\r\n{\r\n  &quot;name&quot;: &quot;myFile.RAR&quot;,\r\n  &quot;data&quot;: &quot;UmFyIRoHAM+QcwAADQAAAAAAAABTL3QgkC8AFAAAABQAAAACTeXQiWmKL1cdMAoAIAAAAG15RmlsZS50eHQAsAA/PXJhciBkYXRhIG1vY2sgaGVyZQ0KxD17AEAHAA==&quot;\r\n}\r\n```\r\nI have tried 2 methods to delete the file, but none of them seems to work.\r\nAlso I didn&#39;t find any method to openArchive using a byte array or InputStream.\r\nThe problem would be solved if I could delete the file after extracting the content or to extract the content without saving the file locally.\r\nAny help or ideas would be appreciated!\r\nOS windows 10","title":"Unable to delete file after using SevenZip.openArchive method in java","body":"<p>In my endpoint I receive the content of a file as String in format base64.\nUnzipping works fine with SevenZip library, no problems there.\nBut after executing this line</p>\n<pre><code>archive = SevenZip.openInArchive(null, new RandomAccessFileInStream(\n                        new RandomAccessFile(file, &quot;r&quot;)));\n</code></pre>\n<p>java is unable to delete file because of following exception:</p>\n<pre><code>java.nio.file.FileSystemException: myFile.RAR: The process cannot access the file because it is being used by another process\n</code></pre>\n<p>I have tried to use junrar library, but SevenZip works better (supports RAR5 and identifies less corupted files as junrar).</p>\n<p>pom.xml:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.1.3&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;demo&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;demo&lt;/name&gt;\n    &lt;description&gt;demo&lt;/description&gt;\n    &lt;properties&gt;\n        &lt;java.version&gt;17&lt;/java.version&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.validation&lt;/groupId&gt;\n            &lt;artifactId&gt;validation-api&lt;/artifactId&gt;\n            &lt;version&gt;2.0.1.Final&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;net.sf.sevenzipjbinding&lt;/groupId&gt;\n            &lt;artifactId&gt;sevenzipjbinding&lt;/artifactId&gt;\n            &lt;version&gt;16.02-2.01&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;net.sf.sevenzipjbinding&lt;/groupId&gt;\n            &lt;artifactId&gt;sevenzipjbinding-all-platforms&lt;/artifactId&gt;\n            &lt;version&gt;16.02-2.01&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n</code></pre>\n<p>Here is the dto:</p>\n<pre><code>public record UploadDto(\n        @NotNull\n        String name,\n        @NotNull\n        String data) {\n}\n</code></pre>\n<p>Here is the controller with the logic:</p>\n<pre><code>import net.sf.sevenzipjbinding.IInArchive;\nimport net.sf.sevenzipjbinding.SevenZip;\nimport net.sf.sevenzipjbinding.SevenZipException;\nimport net.sf.sevenzipjbinding.impl.RandomAccessFileInStream;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.web.bind.annotation.*;\n\nimport java.io.File;\nimport java.io.FileNotFoundException;\nimport java.io.IOException;\nimport java.io.RandomAccessFile;\nimport java.nio.file.Files;\nimport java.nio.file.Path;\nimport java.nio.file.Paths;\nimport java.util.Base64;\n\n@RestController\npublic class TestController {\n    private final Logger log = LoggerFactory.getLogger(TestController.class);\n\n    @PostMapping(&quot;/upload&quot;)\n    public void extractRar(@RequestBody UploadDto dto){\n        byte[] decodedBytes = Base64.getDecoder().decode(dto.data());\n        try {\n            String filePath = dto.name();\n            Files.write(Paths.get(filePath), decodedBytes);\n            log.info(&quot;File saved successfully to: &quot; + filePath);\n            File file = new File(filePath);\n            IInArchive archive;\n            try {\n                archive = SevenZip.openInArchive(null, new RandomAccessFileInStream(\n                        new RandomAccessFile(file, &quot;r&quot;)));\n                log.info(String.valueOf(archive.getNumberOfItems()));\n            } catch (SevenZipException | FileNotFoundException e) {\n                throw new RuntimeException(e);\n            }\n            archive.close();\n\n            // 1 method\n            Files.delete(Path.of(filePath));\n\n            // 2 method\n            if (file.delete()) {\n                log.info(&quot;file deleted successfully&quot;);\n            } else {\n                log.error(&quot;failed to delete the temporary file used for unzipping&quot;);\n            }\n\n        } catch (IOException e) {\n            throw new RuntimeException(e);\n        }\n    }\n\n}\n</code></pre>\n<p>example of request body :</p>\n<pre><code>{\n  &quot;name&quot;: &quot;myFile.RAR&quot;,\n  &quot;data&quot;: &quot;UmFyIRoHAM+QcwAADQAAAAAAAABTL3QgkC8AFAAAABQAAAACTeXQiWmKL1cdMAoAIAAAAG15RmlsZS50eHQAsAA/PXJhciBkYXRhIG1vY2sgaGVyZQ0KxD17AEAHAA==&quot;\n}\n</code></pre>\n<p>I have tried 2 methods to delete the file, but none of them seems to work.\nAlso I didn't find any method to openArchive using a byte array or InputStream.\nThe problem would be solved if I could delete the file after extracting the content or to extract the content without saving the file locally.\nAny help or ideas would be appreciated!\nOS windows 10</p>\n"},{"tags":["java","connection","httpclient"],"owner":{"account_id":13758918,"reputation":1,"user_id":9929119,"display_name":"Wiebe G"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":31,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694789600,"creation_date":1694767172,"question_id":77110885,"body_markdown":"I have a problem with the `CloseableHttpClient`:\r\n\r\nAfter about two days I end up with 200 ESTABLISHED connections and my application stuck on a `client.execute`\r\n\r\nLooks like a connection leak. \r\n\r\n`netstat -a | grep address-portal.loc` gives me 200 lines like this:\r\n\r\n\r\n    cp6       0      0 mymachine.unix.i:38064 address-portal.loc.lo:https ESTABLISHED\r\n\r\nMy Java code :\r\n```java\r\nprivate static CloseableHttpClient getHttpClient() throws NoSuchAlgorithmException, KeyStoreException, KeyManagementException {\r\n\treturn HttpClients.custom().setSSLContext(getSSLContext()).setMaxConnTotal(20).setConnectionTimeToLive(1, TimeUnit.SECONDS).build();\r\n}\r\n\r\npublic static List&lt;Address&gt; lookupAddress(String id, NominatimSourceType sourceType) throws NoSuchAlgorithmException, KeyStoreException, KeyManagementException, IOException {\r\n\tList&lt;Address&gt; reqResult;\r\n\tString apiCall = String.format(API_CALL_FORMAT_STR, getNominatimBaseUrl(sourceType), LOOKUP_URL_PRE_PART, id);\r\n\tLoggerService.logWhenDebug(&quot;API Call lookupAddress: &quot; + apiCall, LOGGER);\r\n\tHttpGet req = new HttpGet(apiCall);\r\n\tCloseableHttpClient client = getHttpClient();\r\n\ttry {\r\n\t\tLoggerService.logWhenDebug(&quot;before client.execute&quot;, LOGGER);\r\n\t\t// in the end the application hangs on this execute because of too many ESTABLISHED connections\r\n\t\treqResult = client.execute(req, listAddressNominatimResponseHandler);\r\n\t\tLoggerService.logWhenDebug(&quot;client execute done&quot;, LOGGER);\r\n\t}\r\n\tcatch (Exception e) {\r\n\t\tLoggerService.logWhenDebug(&quot;client.execute error: &quot; + e, LOGGER);\r\n\t\tthrow e;\r\n\t}\r\n\tfinally {\r\n\t\treq.releaseConnection();\r\n\t\tclient.close();\r\n\t\t// below is used deprecated getConnectionManager() trying too fix the connections problem\r\n\t\tclient.getConnectionManager().closeExpiredConnections();\r\n\t\tclient.getConnectionManager().closeIdleConnections(1, TimeUnit.SECONDS);\r\n\t}\r\n\treturn reqResult;\r\n}\r\n```\r\n    \r\n\r\nI am using Java version 11.0.20 and runnning on Tomcat version 9.0.55\r\n\r\nAnybody has a clue?\r\n\r\nI have tried adding the following code to fix the problem\r\n```java\r\nsetMaxConnTotal(20)\r\nsetConnectionTimeToLive(1, TimeUnit.SECONDS)\r\n```\r\n\r\nAnd also used the deprecated function `getConnectionManager()` to try to close the connections\r\n\r\n```java\r\nclient.getConnectionManager().closeExpiredConnections();\r\nclient.getConnectionManager().closeIdleConnections(1, TimeUnit.SECONDS);\r\n```\r\n","title":"Connections do not close, and continue as ESTABLISHED and in the CloseableHttpClient will get stuck by that","body":"<p>I have a problem with the <code>CloseableHttpClient</code>:</p>\n<p>After about two days I end up with 200 ESTABLISHED connections and my application stuck on a <code>client.execute</code></p>\n<p>Looks like a connection leak.</p>\n<p><code>netstat -a | grep address-portal.loc</code> gives me 200 lines like this:</p>\n<pre><code>cp6       0      0 mymachine.unix.i:38064 address-portal.loc.lo:https ESTABLISHED\n</code></pre>\n<p>My Java code :</p>\n<pre class=\"lang-java prettyprint-override\"><code>private static CloseableHttpClient getHttpClient() throws NoSuchAlgorithmException, KeyStoreException, KeyManagementException {\n    return HttpClients.custom().setSSLContext(getSSLContext()).setMaxConnTotal(20).setConnectionTimeToLive(1, TimeUnit.SECONDS).build();\n}\n\npublic static List&lt;Address&gt; lookupAddress(String id, NominatimSourceType sourceType) throws NoSuchAlgorithmException, KeyStoreException, KeyManagementException, IOException {\n    List&lt;Address&gt; reqResult;\n    String apiCall = String.format(API_CALL_FORMAT_STR, getNominatimBaseUrl(sourceType), LOOKUP_URL_PRE_PART, id);\n    LoggerService.logWhenDebug(&quot;API Call lookupAddress: &quot; + apiCall, LOGGER);\n    HttpGet req = new HttpGet(apiCall);\n    CloseableHttpClient client = getHttpClient();\n    try {\n        LoggerService.logWhenDebug(&quot;before client.execute&quot;, LOGGER);\n        // in the end the application hangs on this execute because of too many ESTABLISHED connections\n        reqResult = client.execute(req, listAddressNominatimResponseHandler);\n        LoggerService.logWhenDebug(&quot;client execute done&quot;, LOGGER);\n    }\n    catch (Exception e) {\n        LoggerService.logWhenDebug(&quot;client.execute error: &quot; + e, LOGGER);\n        throw e;\n    }\n    finally {\n        req.releaseConnection();\n        client.close();\n        // below is used deprecated getConnectionManager() trying too fix the connections problem\n        client.getConnectionManager().closeExpiredConnections();\n        client.getConnectionManager().closeIdleConnections(1, TimeUnit.SECONDS);\n    }\n    return reqResult;\n}\n</code></pre>\n<p>I am using Java version 11.0.20 and runnning on Tomcat version 9.0.55</p>\n<p>Anybody has a clue?</p>\n<p>I have tried adding the following code to fix the problem</p>\n<pre class=\"lang-java prettyprint-override\"><code>setMaxConnTotal(20)\nsetConnectionTimeToLive(1, TimeUnit.SECONDS)\n</code></pre>\n<p>And also used the deprecated function <code>getConnectionManager()</code> to try to close the connections</p>\n<pre class=\"lang-java prettyprint-override\"><code>client.getConnectionManager().closeExpiredConnections();\nclient.getConnectionManager().closeIdleConnections(1, TimeUnit.SECONDS);\n</code></pre>\n"},{"tags":["java","database","oracle"],"comments":[{"owner":{"account_id":350117,"reputation":8653,"user_id":685806,"accept_rate":44,"display_name":"Pino"},"score":0,"creation_date":1694682196,"post_id":77103283,"comment_id":135924142,"body_markdown":"`FETCH FIRST 5 ROWS ONLY` is supported in Oracle 12c and above.  Try to remove it. See https://www.dbi-services.com/blog/oracle-rownum-vs-rownumber-and-12c-fetch-first/","body":"<code>FETCH FIRST 5 ROWS ONLY</code> is supported in Oracle 12c and above.  Try to remove it. See <a href=\"https://www.dbi-services.com/blog/oracle-rownum-vs-rownumber-and-12c-fetch-first/\" rel=\"nofollow noreferrer\">dbi-services.com/blog/&hellip;</a>"},{"owner":{"account_id":47283,"reputation":703817,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":1,"creation_date":1694683623,"post_id":77103283,"comment_id":135924456,"body_markdown":"You are running a version of Java that was EOL in 2008 to connect to an Oracle database that was EOL before 2003.  And you are using an application that is using Oracle SQL features introduced in 2013.  Are you seeing the problem here?","body":"You are running a version of Java that was EOL in 2008 to connect to an Oracle database that was EOL before 2003.  And you are using an application that is using Oracle SQL features introduced in 2013.  Are you seeing the problem here?"},{"owner":{"account_id":29054609,"reputation":11,"user_id":22256640,"display_name":"Nuwan Madushanka"},"score":0,"creation_date":1694684975,"post_id":77103283,"comment_id":135924780,"body_markdown":"I&#39;ve changed the select statement. Still, the issue persists. modified query is &quot;SELECT COL1,COL2,COL3 FROM SCHEMA_A.TABLE_A WHERE COL1=1&quot;.","body":"I&#39;ve changed the select statement. Still, the issue persists. modified query is &quot;SELECT COL1,COL2,COL3 FROM SCHEMA_A.TABLE_A WHERE COL1=1&quot;."},{"owner":{"account_id":29054609,"reputation":11,"user_id":22256640,"display_name":"Nuwan Madushanka"},"score":0,"creation_date":1694685472,"post_id":77103283,"comment_id":135924908,"body_markdown":"The error is occurred at &quot;con = DriverManager.getConnection(\n                &quot;jdbc:oracle:thin:@192.168.1.3:1521/DBNAME&quot;, &quot;USERNAME&quot;, &quot;PASSWORD&quot;);&quot; This is why suspect something to do with ojdbc version and java version","body":"The error is occurred at &quot;con = DriverManager.getConnection(                 &quot;jdbc:oracle:thin:@192.168.1.3:1521/DBNAME&quot;, &quot;USERNAME&quot;, &quot;PASSWORD&quot;);&quot; This is why suspect something to do with ojdbc version and java version"}],"answers":[{"tags":[],"owner":{"account_id":1635690,"reputation":150047,"user_id":1509264,"accept_rate":58,"display_name":"MT0"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694683158,"creation_date":1694683158,"answer_id":77103469,"question_id":77103283,"body_markdown":"You have (at least) two problems:\r\n\r\n 1. The error message is:\r\n\r\n    ```lang-none\r\n    ORA-02248: invalid option for ALTER SESSION\r\n    ```\r\n\r\n    This means that, when you create the connection and Oracle implicitly starts a session, an `ALTER SESSION` command is being invoked and that command is invalid. You do not show any `ALTER SESSION` commands so it is probably in a trigger. You need to fix that command so it is valid.\r\n 2. The `FETCH FIRST n ROWS ONLY` syntax was introduced in Oracle 12. You are using Oracle 8 so it is not going to work. Instead, you want:\r\n\r\n    ```lang-sql\r\n    SELECT COL1, COL2, COL3 FROM TABLE_A WHERE ROWNUM &lt;= 5\r\n    ```\r\n\r\n    However, you probably want an `ORDER BY` clause as well (otherwise you are getting 5 random rows, rather than 5 specific rows).\r\n    \r\n    ```lang-sql\r\n    SELECT * FROM (SELECT COL1, COL2, COL3 FROM TABLE_A ORDER BY COL1, COL2, COL2) WHERE ROWNUM &lt;= 5\r\n    ```\r\n","title":"Java application connectivity issue for Oracle8 Release 8.0.5.0.0","body":"<p>You have (at least) two problems:</p>\n<ol>\n<li><p>The error message is:</p>\n<pre class=\"lang-none prettyprint-override\"><code>ORA-02248: invalid option for ALTER SESSION\n</code></pre>\n<p>This means that, when you create the connection and Oracle implicitly starts a session, an <code>ALTER SESSION</code> command is being invoked and that command is invalid. You do not show any <code>ALTER SESSION</code> commands so it is probably in a trigger. You need to fix that command so it is valid.</p>\n</li>\n<li><p>The <code>FETCH FIRST n ROWS ONLY</code> syntax was introduced in Oracle 12. You are using Oracle 8 so it is not going to work. Instead, you want:</p>\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT COL1, COL2, COL3 FROM TABLE_A WHERE ROWNUM &lt;= 5\n</code></pre>\n<p>However, you probably want an <code>ORDER BY</code> clause as well (otherwise you are getting 5 random rows, rather than 5 specific rows).</p>\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT * FROM (SELECT COL1, COL2, COL3 FROM TABLE_A ORDER BY COL1, COL2, COL2) WHERE ROWNUM &lt;= 5\n</code></pre>\n</li>\n</ol>\n"},{"tags":[],"owner":{"account_id":29054609,"reputation":11,"user_id":22256640,"display_name":"Nuwan Madushanka"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694789069,"creation_date":1694789069,"answer_id":77113326,"question_id":77103283,"body_markdown":"Managed to fix with Java 1.2 and classes12.zip","title":"Java application connectivity issue for Oracle8 Release 8.0.5.0.0","body":"<p>Managed to fix with Java 1.2 and classes12.zip</p>\n"}],"owner":{"account_id":29054609,"reputation":11,"user_id":22256640,"display_name":"Nuwan Madushanka"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":32,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1694789069,"creation_date":1694681837,"question_id":77103283,"body_markdown":"I&#39;ve given a task to connect to Oracle8 Release 8.0.5.0.0 from a Java application. My code snippet is as follows.\r\n\r\n\r\n```\r\nimport java.sql.*;\r\n\r\nclass OracleConOldJava {\r\n    public static void main(String args[]) {\r\n        Connection con = null;\r\n        Statement stmt = null;\r\n        ResultSet rs = null;\r\n\r\n        try {\r\n            // Load the Oracle JDBC driver\r\n            Class.forName(&quot;oracle.jdbc.driver.OracleDriver&quot;);\r\n\r\n            // Establish the database connection\r\n            con = DriverManager.getConnection(\r\n                &quot;jdbc:oracle:thin:@192.168.1.3:1521/DBNAME&quot;, &quot;USERNAME&quot;, &quot;PASSWORD&quot;);\r\n\r\n            // Create a statement\r\n            stmt = con.createStatement();\r\n\r\n            // Execute the SQL query with FETCH FIRST to limit the number of rows\r\n            rs = stmt.executeQuery(\r\n                &quot;SELECT COL1, COL2, COL3 FROM TABLE_A FETCH FIRST 5 ROWS ONLY&quot;);\r\n\r\n            // Iterate through the result set and print the data\r\n            while (rs.next()) {\r\n                System.out.println(\r\n                    rs.getInt(&quot;COL&quot;) + &quot;  &quot; +\r\n                    rs.getString(&quot;COL2&quot;) + &quot;  &quot; +\r\n                    rs.getString(&quot;COL3&quot;));\r\n            }\r\n        } catch (ClassNotFoundException e) {\r\n            e.printStackTrace();\r\n        } catch (SQLException e) {\r\n            e.printStackTrace();\r\n        } finally {\r\n            try {\r\n                // Close the resources in the reverse order of acquisition\r\n                if (rs != null) rs.close();\r\n                if (stmt != null) stmt.close();\r\n                if (con != null) con.close();\r\n            } catch (SQLException e) {\r\n                e.printStackTrace();\r\n            }\r\n        }\r\n    }\r\n}\r\n```\r\n\r\n\r\nI&#39;m using ojdbc14.jar with java 1.4.\r\n\r\nWhen I run the code getting below error.\r\n\r\n\r\n```\r\nC:\\j2sdk1.4.2_18\\bin\\java.exe -cp .;ojdbc14.jar OracleConOldJava\r\njava.sql.SQLException: ORA-00604: error occurred at recursive SQL level 1\r\nORA-02248: invalid option for ALTER SESSION\r\n\r\n        at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)\r\n        at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331)\r\n        at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:283)\r\n        at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:278)\r\n        at oracle.jdbc.driver.T4CTTIoauthenticate.receiveOauth(T4CTTIoauthenticate.java:785)\r\n        at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:362)\r\n        at oracle.jdbc.driver.PhysicalConnection.&lt;init&gt;(PhysicalConnection.java:414)\r\n        at oracle.jdbc.driver.T4CConnection.&lt;init&gt;(T4CConnection.java:165)\r\n        at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:35)\r\n        at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:801)\r\n        at java.sql.DriverManager.getConnection(DriverManager.java:512)\r\n        at java.sql.DriverManager.getConnection(DriverManager.java:171)\r\n        at OracleConOldJava.main(OracleConOldJava.java:14)\r\n```\r\n\r\n\r\n\r\n\r\nI&#39;ve used java 1.8 with ojdbc8.jar and java 1.4 with ojdbc14.jar. Same error occurred.\r\nWhat could be the reason for this? Is it due to driver mismatch? If so what is the driver I have to use?","title":"Java application connectivity issue for Oracle8 Release 8.0.5.0.0","body":"<p>I've given a task to connect to Oracle8 Release 8.0.5.0.0 from a Java application. My code snippet is as follows.</p>\n<pre><code>import java.sql.*;\n\nclass OracleConOldJava {\n    public static void main(String args[]) {\n        Connection con = null;\n        Statement stmt = null;\n        ResultSet rs = null;\n\n        try {\n            // Load the Oracle JDBC driver\n            Class.forName(&quot;oracle.jdbc.driver.OracleDriver&quot;);\n\n            // Establish the database connection\n            con = DriverManager.getConnection(\n                &quot;jdbc:oracle:thin:@192.168.1.3:1521/DBNAME&quot;, &quot;USERNAME&quot;, &quot;PASSWORD&quot;);\n\n            // Create a statement\n            stmt = con.createStatement();\n\n            // Execute the SQL query with FETCH FIRST to limit the number of rows\n            rs = stmt.executeQuery(\n                &quot;SELECT COL1, COL2, COL3 FROM TABLE_A FETCH FIRST 5 ROWS ONLY&quot;);\n\n            // Iterate through the result set and print the data\n            while (rs.next()) {\n                System.out.println(\n                    rs.getInt(&quot;COL&quot;) + &quot;  &quot; +\n                    rs.getString(&quot;COL2&quot;) + &quot;  &quot; +\n                    rs.getString(&quot;COL3&quot;));\n            }\n        } catch (ClassNotFoundException e) {\n            e.printStackTrace();\n        } catch (SQLException e) {\n            e.printStackTrace();\n        } finally {\n            try {\n                // Close the resources in the reverse order of acquisition\n                if (rs != null) rs.close();\n                if (stmt != null) stmt.close();\n                if (con != null) con.close();\n            } catch (SQLException e) {\n                e.printStackTrace();\n            }\n        }\n    }\n}\n</code></pre>\n<p>I'm using ojdbc14.jar with java 1.4.</p>\n<p>When I run the code getting below error.</p>\n<pre><code>C:\\j2sdk1.4.2_18\\bin\\java.exe -cp .;ojdbc14.jar OracleConOldJava\njava.sql.SQLException: ORA-00604: error occurred at recursive SQL level 1\nORA-02248: invalid option for ALTER SESSION\n\n        at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)\n        at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331)\n        at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:283)\n        at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:278)\n        at oracle.jdbc.driver.T4CTTIoauthenticate.receiveOauth(T4CTTIoauthenticate.java:785)\n        at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:362)\n        at oracle.jdbc.driver.PhysicalConnection.&lt;init&gt;(PhysicalConnection.java:414)\n        at oracle.jdbc.driver.T4CConnection.&lt;init&gt;(T4CConnection.java:165)\n        at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:35)\n        at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:801)\n        at java.sql.DriverManager.getConnection(DriverManager.java:512)\n        at java.sql.DriverManager.getConnection(DriverManager.java:171)\n        at OracleConOldJava.main(OracleConOldJava.java:14)\n</code></pre>\n<p>I've used java 1.8 with ojdbc8.jar and java 1.4 with ojdbc14.jar. Same error occurred.\nWhat could be the reason for this? Is it due to driver mismatch? If so what is the driver I have to use?</p>\n"},{"tags":["java","openstack-swift"],"owner":{"account_id":2119755,"reputation":1211,"user_id":1883278,"accept_rate":17,"display_name":"Sankalp"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":19,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694788596,"creation_date":1694124377,"question_id":77063109,"body_markdown":"I&#39;m uploading the file like this as mentioned in their public document.\r\n```\r\nString path = getClass().getClassLoader().getResource(&quot;SmallImage.png&quot;).getPath();\r\nString name = &quot;SmallImage.png&quot;;\r\nStoredObject object = container.getObject(name);\r\nUploadInstructions uploadInstructions = new UploadInstructions(new File(path));\r\nobject.uploadObject(uploadInstructions);\r\n```\r\nThe library itself generates the Etag and adds it to the PUT request header. But then I get the MD5_CHECKSUM error when I try to upload. I don&#39;t understand why that MD5 checksum is rejected the the server when the library itself is generating the etag.\r\n\r\nThe workaround of not supplying the etag does not work either since the library mandatorily adds the etag header here in UploadObjectCommandImpl.prepareUpload method.\r\n\r\nPlease suggest what can be done here to solve this problem.","title":"MD5_CHECKSUM error while uploading a file","body":"<p>I'm uploading the file like this as mentioned in their public document.</p>\n<pre><code>String path = getClass().getClassLoader().getResource(&quot;SmallImage.png&quot;).getPath();\nString name = &quot;SmallImage.png&quot;;\nStoredObject object = container.getObject(name);\nUploadInstructions uploadInstructions = new UploadInstructions(new File(path));\nobject.uploadObject(uploadInstructions);\n</code></pre>\n<p>The library itself generates the Etag and adds it to the PUT request header. But then I get the MD5_CHECKSUM error when I try to upload. I don't understand why that MD5 checksum is rejected the the server when the library itself is generating the etag.</p>\n<p>The workaround of not supplying the etag does not work either since the library mandatorily adds the etag header here in UploadObjectCommandImpl.prepareUpload method.</p>\n<p>Please suggest what can be done here to solve this problem.</p>\n"},{"tags":["java","spring","spring-boot"],"answers":[{"tags":[],"owner":{"account_id":18391609,"reputation":87,"user_id":13397146,"display_name":"Josselin Beaud&#39;huy"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694788427,"creation_date":1694788427,"answer_id":77113247,"question_id":77053100,"body_markdown":"Pffffff !! \r\n\r\nI had a proxy on my vm arguments ... it works without","title":"Springboot - Connect exception","body":"<p>Pffffff !!</p>\n<p>I had a proxy on my vm arguments ... it works without</p>\n"}],"owner":{"account_id":18391609,"reputation":87,"user_id":13397146,"display_name":"Josselin Beaud&#39;huy"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":55,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"answer_count":1,"score":-1,"last_activity_date":1694788427,"creation_date":1694012157,"question_id":77053100,"body_markdown":"I used this code in a springboot application : \r\n\r\n\r\n```\r\ntry {\r\n\t\t\tSystem.out.println(&quot;StartListener.onApplicationEvent()&quot;);\r\n\t\t\tHttpRequest request = HttpRequest.newBuilder().GET()\r\n\t\t\t\t\t.uri(URI.create(\r\n\t\t\t\t\t\t\t&quot;https://fr.ftp.opendatasoft.com/openscol/fr-en-calendrier-scolaire/Zone-A-B-C-Corse.ics&quot;))\r\n\t\t\t\t\t.build();\r\n\t\t\tHttpClient httpClient = HttpClient.newBuilder().version(HttpClient.Version.HTTP_2).build();\r\n\t\t\tHttpResponse&lt;String&gt; response = httpClient.send(request, HttpResponse.BodyHandlers.ofString());\r\n\t\t\tSystem.out.println(response.body());\r\n\t\t} catch (IOException | InterruptedException e) {\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n```\r\n\r\ni have a connect exception every time : \r\n\r\n\r\n&gt; java.net.ConnectException \tat\r\n&gt; java.net.http/jdk.internal.net.http.HttpClientImpl.send(HttpClientImpl.java:573)\r\n&gt; \tat\r\n&gt; java.net.http/jdk.internal.net.http.HttpClientFacade.send(HttpClientFacade.java:123)\r\n&gt; \tat\r\n&gt; fr.utensilia.covoit.back.config.StartListener.onApplicationEvent(StartListener.java:42)\r\n&gt; \tat\r\n&gt; java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native\r\n&gt; Method) \tat\r\n&gt; java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\r\n&gt; \tat\r\n&gt; java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n&gt; \tat java.base/java.lang.reflect.Method.invoke(Method.java:568) \tat\r\n&gt; org.springframework.context.event.ApplicationListenerMethodAdapter.doInvoke(ApplicationListenerMethodAdapter.java:344)\r\n&gt; \tat\r\n&gt; org.springframework.context.event.ApplicationListenerMethodAdapter.processEvent(ApplicationListenerMethodAdapter.java:229)\r\n&gt; \tat\r\n&gt; org.springframework.context.event.ApplicationListenerMethodAdapter.onApplicationEvent(ApplicationListenerMethodAdapter.java:166)\r\n&gt; \tat\r\n&gt; org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176)\r\n&gt; \tat\r\n&gt; org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169)\r\n&gt; \tat\r\n&gt; org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143)\r\n&gt; \tat\r\n&gt; org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421)\r\n&gt; \tat\r\n&gt; org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378)\r\n&gt; \tat\r\n&gt; org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:938)\r\n&gt; \tat\r\n&gt; org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586)\r\n&gt; \tat\r\n&gt; org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147)\r\n&gt; \tat\r\n&gt; org.springframework.boot.SpringApplication.refresh(SpringApplication.java:734)\r\n&gt; \tat\r\n&gt; org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408)\r\n&gt; \tat\r\n&gt; org.springframework.boot.SpringApplication.run(SpringApplication.java:308)\r\n&gt; \tat\r\n&gt; org.springframework.boot.SpringApplication.run(SpringApplication.java:1306)\r\n&gt; \tat\r\n&gt; org.springframework.boot.SpringApplication.run(SpringApplication.java:1295)\r\n&gt; \tat\r\n&gt; fr.utensilia.covoit.CovoitApplication.main(CovoitApplication.java:10)\r\n&gt; \tat\r\n&gt; java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native\r\n&gt; Method) \tat\r\n&gt; java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\r\n&gt; \tat\r\n&gt; java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n&gt; \tat java.base/java.lang.reflect.Method.invoke(Method.java:568) \tat\r\n&gt; org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49)\r\n&gt; Caused by: java.net.ConnectException \tat\r\n&gt; java.net.http/jdk.internal.net.http.common.Utils.toConnectException(Utils.java:1047)\r\n&gt; \tat\r\n&gt; java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:198)\r\n&gt; \tat\r\n&gt; java.net.http/jdk.internal.net.http.PlainHttpConnection.checkRetryConnect(PlainHttpConnection.java:230)\r\n&gt; \tat\r\n&gt; java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$1(PlainHttpConnection.java:206)\r\n&gt; \tat\r\n&gt; java.base/java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:934)\r\n&gt; \tat\r\n&gt; java.base/java.util.concurrent.CompletableFuture$UniHandle.tryFire(CompletableFuture.java:911)\r\n&gt; \tat\r\n&gt; java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)\r\n&gt; \tat\r\n&gt; java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1773)\r\n&gt; \tat\r\n&gt; java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\r\n&gt; \tat\r\n&gt; java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n&gt; \tat java.base/java.lang.Thread.run(Thread.java:833) Caused by:\r\n&gt; java.nio.channels.ClosedChannelException \tat\r\n&gt; java.base/sun.nio.ch.SocketChannelImpl.ensureOpen(SocketChannelImpl.java:195)\r\n&gt; \tat\r\n&gt; java.base/sun.nio.ch.SocketChannelImpl.beginConnect(SocketChannelImpl.java:760)\r\n&gt; \tat\r\n&gt; java.base/sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:848)\r\n&gt; \tat\r\n&gt; java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$0(PlainHttpConnection.java:183)\r\n&gt; \tat\r\n&gt; java.base/java.security.AccessController.doPrivileged(AccessController.java:569)\r\n&gt; \tat\r\n&gt; java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:185)\r\n&gt; \t... 9 more\r\n\r\n\r\n\r\nIf i use the same code in a simple class (without spring) it&#39;s ok : \r\n\r\n\r\n```\r\nimport java.io.IOException;\r\nimport java.net.URI;\r\nimport java.net.http.HttpClient;\r\nimport java.net.http.HttpRequest;\r\nimport java.net.http.HttpResponse;\r\n\r\npublic class Test {\r\n\r\n\tpublic static void main(String[] args) {\r\n\t\ttry {\r\n\t\t\tSystem.out.println(&quot;StartListener.onApplicationEvent()&quot;);\r\n\t\t\tHttpRequest request = HttpRequest.newBuilder().GET()\r\n\t\t\t\t\t.uri(URI.create(\r\n\t\t\t\t\t\t\t&quot;https://fr.ftp.opendatasoft.com/openscol/fr-en-calendrier-scolaire/Zone-A-B-C-Corse.ics&quot;))\r\n\t\t\t\t\t.build();\r\n\t\t\tHttpClient httpClient = HttpClient.newBuilder().version(HttpClient.Version.HTTP_2).build();\r\n\t\t\tHttpResponse&lt;String&gt; response = httpClient.send(request, HttpResponse.BodyHandlers.ofString());\r\n\t\t\tSystem.out.println(response.body());\r\n\t\t} catch (IOException | InterruptedException e) {\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n```\r\n\r\nI can open it in a browser and exception is not similar to this one : https://stackoverflow.com/questions/72688051/java-net-connectexception-while-source-validation-in-java\r\n\r\nAny idea ? ","title":"Springboot - Connect exception","body":"<p>I used this code in a springboot application :</p>\n<pre><code>try {\n            System.out.println(&quot;StartListener.onApplicationEvent()&quot;);\n            HttpRequest request = HttpRequest.newBuilder().GET()\n                    .uri(URI.create(\n                            &quot;https://fr.ftp.opendatasoft.com/openscol/fr-en-calendrier-scolaire/Zone-A-B-C-Corse.ics&quot;))\n                    .build();\n            HttpClient httpClient = HttpClient.newBuilder().version(HttpClient.Version.HTTP_2).build();\n            HttpResponse&lt;String&gt; response = httpClient.send(request, HttpResponse.BodyHandlers.ofString());\n            System.out.println(response.body());\n        } catch (IOException | InterruptedException e) {\n            e.printStackTrace();\n        }\n</code></pre>\n<p>i have a connect exception every time :</p>\n<blockquote>\n<p>java.net.ConnectException     at\njava.net.http/jdk.internal.net.http.HttpClientImpl.send(HttpClientImpl.java:573)\nat\njava.net.http/jdk.internal.net.http.HttpClientFacade.send(HttpClientFacade.java:123)\nat\nfr.utensilia.covoit.back.config.StartListener.onApplicationEvent(StartListener.java:42)\nat\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native\nMethod)   at\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\nat\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.base/java.lang.reflect.Method.invoke(Method.java:568)   at\norg.springframework.context.event.ApplicationListenerMethodAdapter.doInvoke(ApplicationListenerMethodAdapter.java:344)\nat\norg.springframework.context.event.ApplicationListenerMethodAdapter.processEvent(ApplicationListenerMethodAdapter.java:229)\nat\norg.springframework.context.event.ApplicationListenerMethodAdapter.onApplicationEvent(ApplicationListenerMethodAdapter.java:166)\nat\norg.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176)\nat\norg.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169)\nat\norg.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143)\nat\norg.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421)\nat\norg.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378)\nat\norg.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:938)\nat\norg.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586)\nat\norg.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147)\nat\norg.springframework.boot.SpringApplication.refresh(SpringApplication.java:734)\nat\norg.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408)\nat\norg.springframework.boot.SpringApplication.run(SpringApplication.java:308)\nat\norg.springframework.boot.SpringApplication.run(SpringApplication.java:1306)\nat\norg.springframework.boot.SpringApplication.run(SpringApplication.java:1295)\nat\nfr.utensilia.covoit.CovoitApplication.main(CovoitApplication.java:10)\nat\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native\nMethod)   at\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\nat\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.base/java.lang.reflect.Method.invoke(Method.java:568)   at\norg.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49)\nCaused by: java.net.ConnectException  at\njava.net.http/jdk.internal.net.http.common.Utils.toConnectException(Utils.java:1047)\nat\njava.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:198)\nat\njava.net.http/jdk.internal.net.http.PlainHttpConnection.checkRetryConnect(PlainHttpConnection.java:230)\nat\njava.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$1(PlainHttpConnection.java:206)\nat\njava.base/java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:934)\nat\njava.base/java.util.concurrent.CompletableFuture$UniHandle.tryFire(CompletableFuture.java:911)\nat\njava.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)\nat\njava.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1773)\nat\njava.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\nat\njava.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\nat java.base/java.lang.Thread.run(Thread.java:833) Caused by:\njava.nio.channels.ClosedChannelException  at\njava.base/sun.nio.ch.SocketChannelImpl.ensureOpen(SocketChannelImpl.java:195)\nat\njava.base/sun.nio.ch.SocketChannelImpl.beginConnect(SocketChannelImpl.java:760)\nat\njava.base/sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:848)\nat\njava.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$0(PlainHttpConnection.java:183)\nat\njava.base/java.security.AccessController.doPrivileged(AccessController.java:569)\nat\njava.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:185)\n... 9 more</p>\n</blockquote>\n<p>If i use the same code in a simple class (without spring) it's ok :</p>\n<pre><code>import java.io.IOException;\nimport java.net.URI;\nimport java.net.http.HttpClient;\nimport java.net.http.HttpRequest;\nimport java.net.http.HttpResponse;\n\npublic class Test {\n\n    public static void main(String[] args) {\n        try {\n            System.out.println(&quot;StartListener.onApplicationEvent()&quot;);\n            HttpRequest request = HttpRequest.newBuilder().GET()\n                    .uri(URI.create(\n                            &quot;https://fr.ftp.opendatasoft.com/openscol/fr-en-calendrier-scolaire/Zone-A-B-C-Corse.ics&quot;))\n                    .build();\n            HttpClient httpClient = HttpClient.newBuilder().version(HttpClient.Version.HTTP_2).build();\n            HttpResponse&lt;String&gt; response = httpClient.send(request, HttpResponse.BodyHandlers.ofString());\n            System.out.println(response.body());\n        } catch (IOException | InterruptedException e) {\n            e.printStackTrace();\n        }\n\n    }\n\n}\n</code></pre>\n<p>I can open it in a browser and exception is not similar to this one : <a href=\"https://stackoverflow.com/questions/72688051/java-net-connectexception-while-source-validation-in-java\">java.net.ConnectException while Source Validation in Java</a></p>\n<p>Any idea ?</p>\n"},{"tags":["java","tree","swt","eclipse-rcp","row-height"],"comments":[{"owner":{"account_id":3159259,"reputation":109666,"user_id":2670892,"display_name":"greg-449"},"score":1,"creation_date":1694787638,"post_id":77113080,"comment_id":135941279,"body_markdown":"Setting the `height` field in the `MeasureItem` event can increase the size of the rows (but not decrease it). Also note that all rows have to have the same height.","body":"Setting the <code>height</code> field in the <code>MeasureItem</code> event can increase the size of the rows (but not decrease it). Also note that all rows have to have the same height."},{"owner":{"account_id":28805956,"reputation":9,"user_id":22061831,"display_name":"Satya"},"score":0,"creation_date":1694789248,"post_id":77113080,"comment_id":135941612,"body_markdown":"@greg-449 i want to decrease the height for all rows. How can i do it","body":"@greg-449 i want to decrease the height for all rows. How can i do it"},{"owner":{"account_id":3159259,"reputation":109666,"user_id":2670892,"display_name":"greg-449"},"score":0,"creation_date":1694795733,"post_id":77113080,"comment_id":135942853,"body_markdown":"There is no official way to do that. On macOS it is possible to access some of the SWT internals to do it but that make the code macOS specific. I don&#39;t know if it is possible on other platforms.","body":"There is no official way to do that. On macOS it is possible to access some of the SWT internals to do it but that make the code macOS specific. I don&#39;t know if it is possible on other platforms."}],"owner":{"account_id":28805956,"reputation":9,"user_id":22061831,"display_name":"Satya"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":20,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694787083,"creation_date":1694787044,"question_id":77113080,"body_markdown":"I have tree, i want to change the row height of that tree.\r\nI have tried adding listener, SWT.MeasureItem and EraseItem as well, but still the row height is not changing.\r\n\r\nThere is the function in inbuilt Tree class but, that function is not public , so I am not able to use that function\r\n\r\n\r\n\r\nPlease suggest some approach to change the row height of the tree.","title":"Change row height in SWT tree","body":"<p>I have tree, i want to change the row height of that tree.\nI have tried adding listener, SWT.MeasureItem and EraseItem as well, but still the row height is not changing.</p>\n<p>There is the function in inbuilt Tree class but, that function is not public , so I am not able to use that function</p>\n<p>Please suggest some approach to change the row height of the tree.</p>\n"},{"tags":["java","java-8","java-stream"],"comments":[{"owner":{"account_id":371244,"reputation":443,"user_id":17825391,"display_name":"user213769"},"score":0,"creation_date":1687866243,"post_id":23868733,"comment_id":134993694,"body_markdown":"somewhat surprisingly, even `Supplier&lt;Void&gt;` won&#39;t work since `void cannot be converted to Void` XD","body":"somewhat surprisingly, even <code>Supplier&lt;Void&gt;</code> won&#39;t work since <code>void cannot be converted to Void</code> XD"},{"owner":{"account_id":234754,"reputation":5730,"user_id":501113,"accept_rate":90,"display_name":"chaotic3quilibrium"},"score":0,"creation_date":1689980001,"post_id":23868733,"comment_id":135294223,"body_markdown":"I disagree with the use `Runnable` advice. It miscommunicates intent: https://stackoverflow.com/a/76741622/501113","body":"I disagree with the use <code>Runnable</code> advice. It miscommunicates intent: <a href=\"https://stackoverflow.com/a/76741622/501113\">stackoverflow.com/a/76741622/501113</a>"}],"answers":[{"tags":[],"owner":{"account_id":440158,"reputation":323231,"user_id":829571,"accept_rate":94,"display_name":"assylias"},"down_vote_count":3,"up_vote_count":136,"is_accepted":true,"score":133,"last_activity_date":1471334322,"creation_date":1401103370,"answer_id":23868969,"question_id":23868733,"body_markdown":"If I understand correctly you want a functional interface with a method `void m()`. In which case you can simply use a [`Runnable`](https://docs.oracle.com/javase/8/docs/api/java/lang/Runnable.html).","title":"Java 8 functional interface with no arguments and no return value","body":"<p>If I understand correctly you want a functional interface with a method <code>void m()</code>. In which case you can simply use a <a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/Runnable.html\"><code>Runnable</code></a>.</p>\n"},{"tags":[],"owner":{"account_id":6899463,"reputation":1074,"user_id":5299539,"accept_rate":59,"display_name":"Charana"},"down_vote_count":6,"up_vote_count":40,"is_accepted":false,"score":34,"last_activity_date":1501513648,"creation_date":1501513648,"answer_id":45419418,"question_id":23868733,"body_markdown":"Just make your own\r\n\r\n\r\n    @FunctionalInterface\r\n    public interface Procedure {\r\n        void run();\r\n    \r\n        default Procedure andThen(Procedure after){\r\n            return () -&gt; {\r\n                this.run();\r\n                after.run();\r\n            };\r\n        }\r\n    \r\n        default Procedure compose(Procedure before){\r\n            return () -&gt; {\r\n                before.run();\r\n                this.run();\r\n            };\r\n        }\r\n    }\r\n\r\nand use it like this\r\n\r\n    public static void main(String[] args){\r\n        Procedure procedure1 = () -&gt; System.out.print(&quot;Hello&quot;);\r\n        Procedure procedure2 = () -&gt; System.out.print(&quot;World&quot;);\r\n\r\n        procedure1.andThen(procedure2).run();\r\n        System.out.println();\r\n        procedure1.compose(procedure2).run();\r\n\r\n    }\r\n\r\nand the output\r\n\r\n    HelloWorld\r\n    WorldHello","title":"Java 8 functional interface with no arguments and no return value","body":"<p>Just make your own</p>\n\n<pre><code>@FunctionalInterface\npublic interface Procedure {\n    void run();\n\n    default Procedure andThen(Procedure after){\n        return () -&gt; {\n            this.run();\n            after.run();\n        };\n    }\n\n    default Procedure compose(Procedure before){\n        return () -&gt; {\n            before.run();\n            this.run();\n        };\n    }\n}\n</code></pre>\n\n<p>and use it like this</p>\n\n<pre><code>public static void main(String[] args){\n    Procedure procedure1 = () -&gt; System.out.print(\"Hello\");\n    Procedure procedure2 = () -&gt; System.out.print(\"World\");\n\n    procedure1.andThen(procedure2).run();\n    System.out.println();\n    procedure1.compose(procedure2).run();\n\n}\n</code></pre>\n\n<p>and the output</p>\n\n<pre><code>HelloWorld\nWorldHello\n</code></pre>\n"},{"tags":[],"owner":{"account_id":17945185,"reputation":122,"user_id":13039638,"display_name":"uma mahesh"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1610528915,"creation_date":1589866728,"answer_id":61883965,"question_id":23868733,"body_markdown":"   \r\n\r\n `@FunctionalInterface` allows only method abstract method Hence you can instantiate that interface with lambda expression as below and you can access the interface members\r\n\r\n            @FunctionalInterface\r\n            interface Hai {\r\n            \r\n            \tvoid m2();\r\n            \r\n            \tstatic void m1() {\r\n            \t\tSystem.out.println(&quot;i m1 method:::&quot;);\r\n            \t}\r\n            \r\n            \tdefault void log(String str) {\r\n            \t\tSystem.out.println(&quot;i am log method:::&quot; + str);\r\n            \t}\r\n            \r\n            }\r\n        \r\n        public class Hello {\r\n        \tpublic static void main(String[] args) {\r\n        \r\n        \t\tHai hai = () -&gt; {};\r\n        \t\thai.log(&quot;lets do it.&quot;);\r\n        \t\tHai.m1();\r\n        \r\n        \t}\r\n        }\r\n    \r\n    \r\noutput:\r\n\r\n    i am log method:::lets do it.\r\n    i m1 method:::","title":"Java 8 functional interface with no arguments and no return value","body":"<p><code>@FunctionalInterface</code> allows only method abstract method Hence you can instantiate that interface with lambda expression as below and you can access the interface members</p>\n<pre><code>        @FunctionalInterface\n        interface Hai {\n        \n            void m2();\n        \n            static void m1() {\n                System.out.println(&quot;i m1 method:::&quot;);\n            }\n        \n            default void log(String str) {\n                System.out.println(&quot;i am log method:::&quot; + str);\n            }\n        \n        }\n    \n    public class Hello {\n        public static void main(String[] args) {\n    \n            Hai hai = () -&gt; {};\n            hai.log(&quot;lets do it.&quot;);\n            Hai.m1();\n    \n        }\n    }\n</code></pre>\n<p>output:</p>\n<pre><code>i am log method:::lets do it.\ni m1 method:::\n</code></pre>\n"},{"tags":[],"owner":{"account_id":234754,"reputation":5730,"user_id":501113,"accept_rate":90,"display_name":"chaotic3quilibrium"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694786406,"creation_date":1689979594,"answer_id":76741622,"question_id":23868733,"body_markdown":"**Note:** For a more complete solution, here&#39;s an [StackOverflow Answer][1] I&#39;ve posted.\r\n\r\n----------\r\n\r\nI don&#39;t like the decision made by the Java library team to leave out the case of a no-parameter-no-return-value `Function` interface, and nudging those who need one to use `Runnable`. I think it inaccurately, and even incorrectly, redirects attention and subsequent assumptions when trying to read through a code base. Especially years after the original code was written.\r\n\r\nGiven communication and readability are far higher concerns for me and my audiences, I have composed a small helper `interface` designed and named in the spirit of the Java library&#39;s missing case:\r\n\r\n```java\r\n@FunctionalInterface\r\npublic interface VoidSupplier {\r\n  void get();\r\n}\r\n```\r\n\r\nAnd in my case, the likelihood of an Exception being thrown in the method is considerably higher, so I actually added a checked exception like this:\r\n\r\n```java\r\n@FunctionalInterface\r\npublic interface VoidSupplier {\r\n  void get() throws Exception;\r\n}\r\n```\r\n\r\n\r\n  [1]: https://stackoverflow.com/a/76985309/501113","title":"Java 8 functional interface with no arguments and no return value","body":"<p><strong>Note:</strong> For a more complete solution, here's an <a href=\"https://stackoverflow.com/a/76985309/501113\">StackOverflow Answer</a> I've posted.</p>\n<hr />\n<p>I don't like the decision made by the Java library team to leave out the case of a no-parameter-no-return-value <code>Function</code> interface, and nudging those who need one to use <code>Runnable</code>. I think it inaccurately, and even incorrectly, redirects attention and subsequent assumptions when trying to read through a code base. Especially years after the original code was written.</p>\n<p>Given communication and readability are far higher concerns for me and my audiences, I have composed a small helper <code>interface</code> designed and named in the spirit of the Java library's missing case:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@FunctionalInterface\npublic interface VoidSupplier {\n  void get();\n}\n</code></pre>\n<p>And in my case, the likelihood of an Exception being thrown in the method is considerably higher, so I actually added a checked exception like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@FunctionalInterface\npublic interface VoidSupplier {\n  void get() throws Exception;\n}\n</code></pre>\n"}],"owner":{"account_id":1161310,"reputation":8921,"user_id":1140754,"accept_rate":70,"display_name":"Miguel Gamboa"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":37148,"favorite_count":0,"down_vote_count":1,"up_vote_count":144,"accepted_answer_id":23868969,"answer_count":4,"score":143,"last_activity_date":1694786406,"creation_date":1401102531,"question_id":23868733,"body_markdown":"What is the Java 8 functional interface for a method that takes nothing and returns nothing? \r\n\r\nI.e., the equivalent to the C# parameterless `Action` with `void` return type?","title":"Java 8 functional interface with no arguments and no return value","body":"<p>What is the Java 8 functional interface for a method that takes nothing and returns nothing?</p>\n<p>I.e., the equivalent to the C# parameterless <code>Action</code> with <code>void</code> return type?</p>\n"},{"tags":["java","intellij-idea","javafx","jar","artifact"],"comments":[{"owner":{"account_id":81822,"reputation":204250,"user_id":230513,"accept_rate":100,"display_name":"trashgod"},"score":4,"creation_date":1694780106,"post_id":77111187,"comment_id":135939633,"body_markdown":"Please, [no images of code/data/errors](https://meta.stackoverflow.com/q/285551/230513).","body":"Please, <a href=\"https://meta.stackoverflow.com/q/285551/230513\">no images of code/data/errors</a>."},{"owner":{"account_id":2819940,"reputation":12538,"user_id":2423906,"accept_rate":100,"display_name":"SedJ601"},"score":2,"creation_date":1694788625,"post_id":77111187,"comment_id":135941470,"body_markdown":"Follow one of the tutorials [here](https://openjfx.io/openjfx-docs/).","body":"Follow one of the tutorials <a href=\"https://openjfx.io/openjfx-docs/\" rel=\"nofollow noreferrer\">here</a>."}],"answers":[{"tags":[],"owner":{"account_id":13556035,"reputation":11,"user_id":9779463,"display_name":"cdiegobb"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694785984,"creation_date":1694785984,"answer_id":77112952,"question_id":77111187,"body_markdown":"Which version of java do you use?, normally after the version 11 of Java, JavaFx is no more part of the lib. \r\nYou need to download apart go here (https://openjfx.io/), if you use version 9 please made this:\r\n`java --module-path /path/of/javafx-sdk-XX/lib --add-modules javafx.controls,javafx.fxml -jar YourApp.jar` java and javafx most be compatible also \r\n\r\n","title":"JavaFX runtine components are missing?","body":"<p>Which version of java do you use?, normally after the version 11 of Java, JavaFx is no more part of the lib.\nYou need to download apart go here (<a href=\"https://openjfx.io/\" rel=\"nofollow noreferrer\">https://openjfx.io/</a>), if you use version 9 please made this:\n<code>java --module-path /path/of/javafx-sdk-XX/lib --add-modules javafx.controls,javafx.fxml -jar YourApp.jar</code> java and javafx most be compatible also</p>\n"}],"owner":{"account_id":28953821,"reputation":1,"user_id":22177788,"display_name":"dominguez damien"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":49,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1694896370,"answer_count":1,"score":0,"last_activity_date":1694785984,"creation_date":1694769902,"question_id":77111187,"body_markdown":"Hello i try to build an artifact but they say:[enter image description here](https://i.stack.imgur.com/XtxIx.png)\r\n\r\n\r\n\r\ni try to add maven dependency on the projetstructure, but that doesn t work.[enter image description here](https://i.stack.imgur.com/zJsSS.png) what can i do ?\r\n\r\nThanks a lot for your answers","title":"JavaFX runtine components are missing?","body":"<p>Hello i try to build an artifact but they say:<a href=\"https://i.stack.imgur.com/XtxIx.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n<p>i try to add maven dependency on the projetstructure, but that doesn t work.<a href=\"https://i.stack.imgur.com/zJsSS.png\" rel=\"nofollow noreferrer\">enter image description here</a> what can i do ?</p>\n<p>Thanks a lot for your answers</p>\n"},{"tags":["java","spring-boot","caching","types","ehcache-3"],"comments":[{"owner":{"account_id":10326,"reputation":9293,"user_id":19450,"display_name":"Ben Manes"},"score":0,"creation_date":1694916932,"post_id":77112895,"comment_id":135953920,"body_markdown":"You should upgrade, as you are on v3.0.0 which [asserts](https://github.com/ehcache/ehcache3/blob/v3.0.0/107/src/main/java/org/ehcache/jsr107/Eh107CacheManager.java#L256C2-L275) that `getCache(String)` uses `Object.class` for the key/value type. The jsr107 spec was [changed](https://github.com/jsr107/jsr107spec/commit/403cb2b86813b18e1febdfa3143724df65b14ad1) in 1.1 to no longer require this check.","body":"You should upgrade, as you are on v3.0.0 which <a href=\"https://github.com/ehcache/ehcache3/blob/v3.0.0/107/src/main/java/org/ehcache/jsr107/Eh107CacheManager.java#L256C2-L275\" rel=\"nofollow noreferrer\">asserts</a> that <code>getCache(String)</code> uses <code>Object.class</code> for the key/value type. The jsr107 spec was <a href=\"https://github.com/jsr107/jsr107spec/commit/403cb2b86813b18e1febdfa3143724df65b14ad1\" rel=\"nofollow noreferrer\">changed</a> in 1.1 to no longer require this check."},{"owner":{"account_id":29452437,"reputation":1,"user_id":22568819,"display_name":"Francesca Pizzimenti"},"score":0,"creation_date":1695020681,"post_id":77112895,"comment_id":135962964,"body_markdown":"@BenManes it worked, thank you so much!","body":"@BenManes it worked, thank you so much!"},{"owner":{"account_id":29452437,"reputation":1,"user_id":22568819,"display_name":"Francesca Pizzimenti"},"score":0,"creation_date":1695022044,"post_id":77112895,"comment_id":135963207,"body_markdown":"@BenManes Sorry, you know if it is possible to use &quot;@Cacheable&quot; on an interceptor method?","body":"@BenManes Sorry, you know if it is possible to use &quot;@Cacheable&quot; on an interceptor method?"},{"owner":{"account_id":10326,"reputation":9293,"user_id":19450,"display_name":"Ben Manes"},"score":0,"creation_date":1695073158,"post_id":77112895,"comment_id":135972885,"body_markdown":"Sorry, I haven&#39;t used either Spring or Ehcache for many years. ChatGPT seems to say that is non-standard scenario, so you either write your own caching abstraction or annotate the target method.","body":"Sorry, I haven&#39;t used either Spring or Ehcache for many years. ChatGPT seems to say that is non-standard scenario, so you either write your own caching abstraction or annotate the target method."}],"owner":{"account_id":29452437,"reputation":1,"user_id":22568819,"display_name":"Francesca Pizzimenti"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":91,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694785580,"creation_date":1694785580,"question_id":77112895,"body_markdown":"my issue is the same of this https://stackoverflow.com/q/45737109/22568819,\r\nthe only difference is that I don&#39;t have an .xml file, I have this CacheConfig instead: \r\n\r\n```\r\n@Configuration\r\n@EnableCaching\r\npublic class CacheConfig {\r\n\r\n    @Bean\r\n    public CacheManager cacheManager() {\r\n        // creation of cache configuration\r\n        CacheConfiguration&lt;String, String&gt; cacheConfiguration = CacheConfigurationBuilder\r\n                .newCacheConfigurationBuilder(\r\n                        String.class, String.class,\r\n                        ResourcePoolsBuilder.heap(1000).build()\r\n                ).build();\r\n\r\n        // fetching cacheManager\r\n        CachingProvider cachingProvider = Caching.getCachingProvider();\r\n        CacheManager cacheManager = cachingProvider.getCacheManager();\r\n\r\n        // parsing ehcache configuration to something SpringBoot will understand\r\n        javax.cache.configuration.Configuration&lt;String, String&gt; configuration = Eh107Configuration.fromEhcacheCacheConfiguration(cacheConfiguration);\r\n\r\n        // creating as many caches as you want\r\n        cacheManager.createCache(&quot;serviceHostName&quot;, configuration);\r\n\r\n        // add shutdown hook to close cacheManager\r\n        Runtime.getRuntime().addShutdownHook(new Thread(cacheManager::close));\r\n\r\n        // return Bean\r\n        return cacheManager;\r\n    }\r\n}\r\n\r\n```\r\nBut when I deploy project, I have this exception: \r\n\r\n```\r\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;cacheManager&#39; defined in class path resource [org/springframework/boot/autoconfigure/cache/JCacheCacheConfiguration.class]: Cache [serviceHostName] specifies key/value types. Use getCache(String, Class, Class)....\r\n\t\r\nCaused by: java.lang.IllegalArgumentException: Cache [serviceHostName] specifies key/value types. Use getCache(String, Class, Class)\r\n\tat org.ehcache.jsr107.Eh107CacheManager.getCache(Eh107CacheManager.java:271) ~[ehcache-3.0.0.jar:3.0.0 6973aca181d2b3e0010945a89933f3c99f4460c5]....\r\n\r\n```\r\nWhat is need to do, that I can use own key type and value types?\r\n","title":"Spring Ehcache3 cause exception with key-type and value-type","body":"<p>my issue is the same of this <a href=\"https://stackoverflow.com/q/45737109/22568819\">Spring Ehcache3 cause exception with with key-type and value-type</a>,\nthe only difference is that I don't have an .xml file, I have this CacheConfig instead:</p>\n<pre><code>@Configuration\n@EnableCaching\npublic class CacheConfig {\n\n    @Bean\n    public CacheManager cacheManager() {\n        // creation of cache configuration\n        CacheConfiguration&lt;String, String&gt; cacheConfiguration = CacheConfigurationBuilder\n                .newCacheConfigurationBuilder(\n                        String.class, String.class,\n                        ResourcePoolsBuilder.heap(1000).build()\n                ).build();\n\n        // fetching cacheManager\n        CachingProvider cachingProvider = Caching.getCachingProvider();\n        CacheManager cacheManager = cachingProvider.getCacheManager();\n\n        // parsing ehcache configuration to something SpringBoot will understand\n        javax.cache.configuration.Configuration&lt;String, String&gt; configuration = Eh107Configuration.fromEhcacheCacheConfiguration(cacheConfiguration);\n\n        // creating as many caches as you want\n        cacheManager.createCache(&quot;serviceHostName&quot;, configuration);\n\n        // add shutdown hook to close cacheManager\n        Runtime.getRuntime().addShutdownHook(new Thread(cacheManager::close));\n\n        // return Bean\n        return cacheManager;\n    }\n}\n\n</code></pre>\n<p>But when I deploy project, I have this exception:</p>\n<pre><code>org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'cacheManager' defined in class path resource [org/springframework/boot/autoconfigure/cache/JCacheCacheConfiguration.class]: Cache [serviceHostName] specifies key/value types. Use getCache(String, Class, Class)....\n    \nCaused by: java.lang.IllegalArgumentException: Cache [serviceHostName] specifies key/value types. Use getCache(String, Class, Class)\n    at org.ehcache.jsr107.Eh107CacheManager.getCache(Eh107CacheManager.java:271) ~[ehcache-3.0.0.jar:3.0.0 6973aca181d2b3e0010945a89933f3c99f4460c5]....\n\n</code></pre>\n<p>What is need to do, that I can use own key type and value types?</p>\n"},{"tags":["java","windows","ant","runtime","version"],"comments":[{"owner":{"account_id":3284439,"reputation":39734,"user_id":2764255,"accept_rate":50,"display_name":"Nikos Paraskevopoulos"},"score":1,"creation_date":1694613938,"post_id":77097715,"comment_id":135914627,"body_markdown":"Have you tried to `SET JAVA_HOME=G:\\Progra~1\\Java\\jdk1.8.0_301` before running `ant`? And if that doesn&#39;t work, maybe `SET PATH=G:\\Progra~1\\Java\\jdk1.8.0_301\\bin;%PATH%`?","body":"Have you tried to <code>SET JAVA_HOME=G:\\Progra~1\\Java\\jdk1.8.0_301</code> before running <code>ant</code>? And if that doesn&#39;t work, maybe <code>SET PATH=G:\\Progra~1\\Java\\jdk1.8.0_301\\bin;%PATH%</code>?"},{"owner":{"account_id":15446251,"reputation":3031,"user_id":11143113,"display_name":"Ashar"},"score":0,"creation_date":1694614105,"post_id":77097715,"comment_id":135914662,"body_markdown":"@NikosParaskevopoulos `SET JAVA_HOME` works. Thank you ... However, still interested to know if there is any `-D` parameters to force which java to use?","body":"@NikosParaskevopoulos <code>SET JAVA_HOME</code> works. Thank you ... However, still interested to know if there is any <code>-D</code> parameters to force which java to use?"},{"owner":{"account_id":2994830,"reputation":1,"user_id":2541560,"display_name":"Kayaman"},"score":1,"creation_date":1694614412,"post_id":77097715,"comment_id":135914732,"body_markdown":"No, there isn&#39;t. And setting the source/target compatibility does not affect which JDK is used, it affects which bytecode version is emitted (and which Java features are available in source).","body":"No, there isn&#39;t. And setting the source/target compatibility does not affect which JDK is used, it affects which bytecode version is emitted (and which Java features are available in source)."},{"owner":{"account_id":3284439,"reputation":39734,"user_id":2764255,"accept_rate":50,"display_name":"Nikos Paraskevopoulos"},"score":0,"creation_date":1694614481,"post_id":77097715,"comment_id":135914754,"body_markdown":"`-D` parameters usually apply to the `java` executable, after the startup script has determined where it is! So, I would say no, `-D` parameters will not have the effect you want. What they probably do (haven&#39;t used Ant for many years) is set the compiler compatibility required by your code, but again *after* the `java` executable has been located.","body":"<code>-D</code> parameters usually apply to the <code>java</code> executable, after the startup script has determined where it is! So, I would say no, <code>-D</code> parameters will not have the effect you want. What they probably do (haven&#39;t used Ant for many years) is set the compiler compatibility required by your code, but again <i>after</i> the <code>java</code> executable has been located."},{"owner":{"account_id":27243397,"reputation":1316,"user_id":20769158,"display_name":"scrhartley"},"score":0,"creation_date":1694614766,"post_id":77097715,"comment_id":135914815,"body_markdown":"I would consider using [JEnv for Windows](https://github.com/FelixSelter/JEnv-for-Windows) and then you can get it to automatically use a particular version depending upon which project folder you&#39;re running in.","body":"I would consider using <a href=\"https://github.com/FelixSelter/JEnv-for-Windows\" rel=\"nofollow noreferrer\">JEnv for Windows</a> and then you can get it to automatically use a particular version depending upon which project folder you&#39;re running in."}],"answers":[{"tags":[],"owner":{"account_id":5998820,"reputation":12656,"user_id":4712734,"display_name":"DuncG"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694785141,"creation_date":1694784769,"answer_id":77112804,"question_id":77097715,"body_markdown":"You should be able to use javac from a different JDK version to the default by specifying a forked javac task:\r\n\r\n    &lt;javac \r\n         ...\r\n         fork=&quot;yes&quot; executable=&quot;${mycompiler}&quot;\r\n\r\nRun with path to a different javac.exe:\r\n\r\n    ant -Dmycompiler=C:\\java\\jdk-14\\bin\\javac.exe targets\r\n    ant -Dmycompiler=C:\\java\\jdk-17\\bin\\javac.exe targets\r\n\r\nYou may of course need additional ant settings to ensure that the default source/release is compatible for alternative JDK.\r\n\r\nIMO though you&#39;d be better off fixing your login / environment so that there isn&#39;t multiple java.exe versions when you type `where java`. It is very easy to configure CMD.EXE or Windows Terminal to setup for a specific JDK, allowing build from any version without changing the command line to `ant`.","title":"Force ant to use specific java version on Windows","body":"<p>You should be able to use javac from a different JDK version to the default by specifying a forked javac task:</p>\n<pre><code>&lt;javac \n     ...\n     fork=&quot;yes&quot; executable=&quot;${mycompiler}&quot;\n</code></pre>\n<p>Run with path to a different javac.exe:</p>\n<pre><code>ant -Dmycompiler=C:\\java\\jdk-14\\bin\\javac.exe targets\nant -Dmycompiler=C:\\java\\jdk-17\\bin\\javac.exe targets\n</code></pre>\n<p>You may of course need additional ant settings to ensure that the default source/release is compatible for alternative JDK.</p>\n<p>IMO though you'd be better off fixing your login / environment so that there isn't multiple java.exe versions when you type <code>where java</code>. It is very easy to configure CMD.EXE or Windows Terminal to setup for a specific JDK, allowing build from any version without changing the command line to <code>ant</code>.</p>\n"}],"owner":{"account_id":15446251,"reputation":3031,"user_id":11143113,"display_name":"Ashar"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":102,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1694785141,"creation_date":1694612917,"question_id":77097715,"body_markdown":"I use a simple build.xml from the internet with no java/executable specified as below. \r\n\r\n    &lt;?xml version=&quot;1.0&quot;?&gt;\r\n    &lt;project name=&quot;the project&quot; default=&quot;compile&quot; basedir=&quot;.&quot;&gt;\r\n    \r\n    \t&lt;property name=&quot;src.dir&quot; location=&quot;src&quot; /&gt;\r\n    \t&lt;property name=&quot;bin.dir&quot; location=&quot;bin&quot; /&gt;\r\n    \t&lt;property name=&quot;lib.dir&quot; location=&quot;lib&quot; /&gt;\r\n    \r\n    \t&lt;path id=&quot;classpath&quot;&gt;\r\n    \t\t&lt;fileset dir=&quot;${lib.dir}&quot; includes=&quot;**/*.jar&quot; /&gt;\r\n    \t&lt;/path&gt;\r\n    \r\n    \t&lt;target name=&quot;init&quot;&gt;\r\n    \t\t&lt;!-- Create the time stamp --&gt;\r\n    \t\t&lt;tstamp /&gt;\r\n    \t\t&lt;!-- Create the build directory structure used by compile --&gt;\r\n    \t\t&lt;mkdir dir=&quot;${bin.dir}&quot; /&gt;\r\n    \t&lt;/target&gt;\r\n    \r\n    \r\n    \t&lt;target name=&quot;clean&quot; description=&quot;remove intermediate files&quot;&gt;\r\n    \t\t&lt;delete dir=&quot;${bin.dir}&quot; /&gt;\r\n    \t&lt;/target&gt;\r\n    \r\n    \t&lt;target name=&quot;compile&quot; depends=&quot;init&quot; description=&quot;compile the Java source code to class files&quot;&gt;\r\n    \t\t&lt;javac srcdir=&quot;${src.dir}&quot; destdir=&quot;${bin.dir}&quot; classpathref=&quot;classpath&quot; /&gt;\r\n    \t&lt;/target&gt;\r\n    \r\n    &lt;/project&gt;\r\n\r\nBelow are a few java versions on my Windows apart from others:\r\n\r\n    where java\r\n    C:\\Program Files\\Common Files\\Oracle\\Java\\javapath\\java.exe\r\n    C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath\\java.exe\r\n    G:\\Program Files\\Java\\jdk1.8.0_301\\bin\\java.exe\r\n\r\nI wish to use this specific version of java with ant `G:\\Program Files\\Java\\jdk1.8.0_301\\bin\\java.exe`. However, ant continues to use a different below JDK version.\r\n\r\n    C:\\Users\\HOME&gt;ant -Dant.build.javac.target=1.8.0_301 -Dant.build.javac.source=1.8.0_301 -Dant.java.version=1.8.0_301 -v |  findstr /I &quot;java&quot;\r\n    Detected Java version: 10 in: G:\\jdk-10\r\n    \r\n    BUILD FAILED\r\n    C:\\Users\\HOME\\build.xml:25: srcdir &quot;C:\\Users\\HOME\\src&quot; does not exist!\r\n            at org.apache.tools.ant.taskdefs.Javac.collectFileListFromSourcePath(Javac.java:1144)\r\n            at org.apache.tools.ant.taskdefs.Javac.execute(Javac.java:1086)\r\n            at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:299)\r\n            at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n            at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n            at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n            at java.base/java.lang.reflect.Method.invoke(Method.java:564)\r\n            at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:99)\r\n            at org.apache.tools.ant.Task.perform(Task.java:350)\r\n            at org.apache.tools.ant.Target.execute(Target.java:449)\r\n            at org.apache.tools.ant.Target.performTasks(Target.java:470)\r\n            at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1401)\r\n            at org.apache.tools.ant.Project.executeTarget(Project.java:1374)\r\n            at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\r\n            at org.apache.tools.ant.Project.executeTargets(Project.java:1264)\r\n            at org.apache.tools.ant.Main.runBuild(Main.java:818)\r\n            at org.apache.tools.ant.Main.startAnt(Main.java:223)\r\n            at org.apache.tools.ant.launch.Launcher.run(Launcher.java:284)\r\n            at org.apache.tools.ant.launch.Launcher.main(Launcher.java:101)\r\n    \r\n    Total time: 0 seconds\r\n        [javac] C:\\Users\\HOME\\build.xml:25: warning: &#39;includeantruntime&#39; was not set, defaulting to build.sysclasspath=last; set to false for repeatable builds\r\n\r\nIgnoring the error as I&#39;m just concerned with checking which version of java is used by my ant.\r\n\r\nI also tried `C:\\Users\\HOME&gt;ant -Dant.build.javac.target=1.8 -Dant.build.javac.source=1.8 -v |  findstr /I &quot;java&quot;` which also did not help.\r\n\r\n\r\nI&#39;m open to different answers but would prefer solutions to pass arguments to ant commands to use the desired JDK. \r\n\r\nThe idea is to switch between `java versions` when using `ant` to build different applications on my host.\r\n\r\nThe sub-version of java is important so I may wish to choose between java versions `1.8.0_145` and `1.8.0_301`\r\n\r\n","title":"Force ant to use specific java version on Windows","body":"<p>I use a simple build.xml from the internet with no java/executable specified as below.</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;\n&lt;project name=&quot;the project&quot; default=&quot;compile&quot; basedir=&quot;.&quot;&gt;\n\n    &lt;property name=&quot;src.dir&quot; location=&quot;src&quot; /&gt;\n    &lt;property name=&quot;bin.dir&quot; location=&quot;bin&quot; /&gt;\n    &lt;property name=&quot;lib.dir&quot; location=&quot;lib&quot; /&gt;\n\n    &lt;path id=&quot;classpath&quot;&gt;\n        &lt;fileset dir=&quot;${lib.dir}&quot; includes=&quot;**/*.jar&quot; /&gt;\n    &lt;/path&gt;\n\n    &lt;target name=&quot;init&quot;&gt;\n        &lt;!-- Create the time stamp --&gt;\n        &lt;tstamp /&gt;\n        &lt;!-- Create the build directory structure used by compile --&gt;\n        &lt;mkdir dir=&quot;${bin.dir}&quot; /&gt;\n    &lt;/target&gt;\n\n\n    &lt;target name=&quot;clean&quot; description=&quot;remove intermediate files&quot;&gt;\n        &lt;delete dir=&quot;${bin.dir}&quot; /&gt;\n    &lt;/target&gt;\n\n    &lt;target name=&quot;compile&quot; depends=&quot;init&quot; description=&quot;compile the Java source code to class files&quot;&gt;\n        &lt;javac srcdir=&quot;${src.dir}&quot; destdir=&quot;${bin.dir}&quot; classpathref=&quot;classpath&quot; /&gt;\n    &lt;/target&gt;\n\n&lt;/project&gt;\n</code></pre>\n<p>Below are a few java versions on my Windows apart from others:</p>\n<pre><code>where java\nC:\\Program Files\\Common Files\\Oracle\\Java\\javapath\\java.exe\nC:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath\\java.exe\nG:\\Program Files\\Java\\jdk1.8.0_301\\bin\\java.exe\n</code></pre>\n<p>I wish to use this specific version of java with ant <code>G:\\Program Files\\Java\\jdk1.8.0_301\\bin\\java.exe</code>. However, ant continues to use a different below JDK version.</p>\n<pre><code>C:\\Users\\HOME&gt;ant -Dant.build.javac.target=1.8.0_301 -Dant.build.javac.source=1.8.0_301 -Dant.java.version=1.8.0_301 -v |  findstr /I &quot;java&quot;\nDetected Java version: 10 in: G:\\jdk-10\n\nBUILD FAILED\nC:\\Users\\HOME\\build.xml:25: srcdir &quot;C:\\Users\\HOME\\src&quot; does not exist!\n        at org.apache.tools.ant.taskdefs.Javac.collectFileListFromSourcePath(Javac.java:1144)\n        at org.apache.tools.ant.taskdefs.Javac.execute(Javac.java:1086)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:299)\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.base/java.lang.reflect.Method.invoke(Method.java:564)\n        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:99)\n        at org.apache.tools.ant.Task.perform(Task.java:350)\n        at org.apache.tools.ant.Target.execute(Target.java:449)\n        at org.apache.tools.ant.Target.performTasks(Target.java:470)\n        at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1401)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1374)\n        at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1264)\n        at org.apache.tools.ant.Main.runBuild(Main.java:818)\n        at org.apache.tools.ant.Main.startAnt(Main.java:223)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:284)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:101)\n\nTotal time: 0 seconds\n    [javac] C:\\Users\\HOME\\build.xml:25: warning: 'includeantruntime' was not set, defaulting to build.sysclasspath=last; set to false for repeatable builds\n</code></pre>\n<p>Ignoring the error as I'm just concerned with checking which version of java is used by my ant.</p>\n<p>I also tried <code>C:\\Users\\HOME&gt;ant -Dant.build.javac.target=1.8 -Dant.build.javac.source=1.8 -v |  findstr /I &quot;java&quot;</code> which also did not help.</p>\n<p>I'm open to different answers but would prefer solutions to pass arguments to ant commands to use the desired JDK.</p>\n<p>The idea is to switch between <code>java versions</code> when using <code>ant</code> to build different applications on my host.</p>\n<p>The sub-version of java is important so I may wish to choose between java versions <code>1.8.0_145</code> and <code>1.8.0_301</code></p>\n"},{"tags":["java","error-handling","mapbox","mapbox-android","rnmapbox-maps"],"answers":[{"tags":[],"owner":{"account_id":27137770,"reputation":11,"user_id":20678952,"display_name":"Lynda Douglas"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1694785011,"creation_date":1694785011,"answer_id":77112835,"question_id":77112806,"body_markdown":"Adding the following code to onDestroy resolved this issue:\r\n\r\n\r\n&lt;!-- begin snippet: js hide: false console: true babel: false --&gt;\r\n\r\n&lt;!-- language: lang-html --&gt;\r\n\r\n      @Override\r\n        protected void onDestroy() {\r\n            super.onDestroy();\r\n            if (mapboxMap != null) {\r\n                mapboxMap.removeOnMapClickListener(this);\r\n                mapView.removeOnDidFinishLoadingStyleListener(this::onDestroy);\r\n                mapView.onStop();\r\n            }\r\n            mapView.onDestroy();\r\n\r\n        }\r\n\r\n&lt;!-- end snippet --&gt;\r\n\r\n","title":"App crashing after exiting MapBoxMap Activity","body":"<p>Adding the following code to onDestroy resolved this issue:</p>\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>  @Override\n    protected void onDestroy() {\n        super.onDestroy();\n        if (mapboxMap != null) {\n            mapboxMap.removeOnMapClickListener(this);\n            mapView.removeOnDidFinishLoadingStyleListener(this::onDestroy);\n            mapView.onStop();\n        }\n        mapView.onDestroy();\n\n    }</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}],"owner":{"account_id":27137770,"reputation":11,"user_id":20678952,"display_name":"Lynda Douglas"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":23,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77112835,"answer_count":1,"score":0,"last_activity_date":1694785011,"creation_date":1694784803,"question_id":77112806,"body_markdown":"Whenever I exit the activity that holds the Mapbox map, the application crashes and this error message appears in my log:\r\n\r\nW/mbgl-locationSymbol: Style is not fully loaded, not able to get source!\r\n\r\nThis is what my @onDestroy looks like:\r\n  \r\n```\r\n  @Override\r\n    protected void onDestroy() {\r\n        super.onDestroy();\r\n        if (mapboxMap != null) {\r\n           mapView.onDestroy();\r\n        }\r\n        \r\n\r\n    }\r\n```\r\n","title":"App crashing after exiting MapBoxMap Activity","body":"<p>Whenever I exit the activity that holds the Mapbox map, the application crashes and this error message appears in my log:</p>\n<p>W/mbgl-locationSymbol: Style is not fully loaded, not able to get source!</p>\n<p>This is what my @onDestroy looks like:</p>\n<pre><code>  @Override\n    protected void onDestroy() {\n        super.onDestroy();\n        if (mapboxMap != null) {\n           mapView.onDestroy();\n        }\n        \n\n    }\n</code></pre>\n"},{"tags":["java","json","dto"],"comments":[{"owner":{"account_id":23783500,"reputation":5175,"user_id":17795888,"display_name":"Chaosfire"},"score":1,"creation_date":1694785696,"post_id":77112829,"comment_id":135940860,"body_markdown":"Also, don&#39;t recreate the instance of `Gson` every time, reuse an existing one - you can use static field in your case.","body":"Also, don&#39;t recreate the instance of <code>Gson</code> every time, reuse an existing one - you can use static field in your case."}],"owner":{"account_id":24771120,"reputation":64,"user_id":18654817,"display_name":"Dev Minty"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":13,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1695019413,"answer_count":0,"score":0,"last_activity_date":1694784954,"creation_date":1694784954,"question_id":77112829,"body_markdown":"Is there a way I could deserialize JSON string into DTO object and trim all the string values in the proces with some kind of a contstructor? Or could I update my custom JSON parser code?\r\n\r\nThis is an excaple of DTO class:\r\n```\r\npublic class House {\r\n    @SerializedName(&quot;HouseID&quot;)\r\n    @Expose\r\n    private final int houseId;\r\n    @SerializedName(&quot;Address&quot;)\r\n    @Expose\r\n    private final String address;\r\n    @SerializedName(&quot;Number&quot;)\r\n    @Expose\r\n    private final int number;\r\n}\r\n```\r\n\r\nAfter I receive a JSON response I parse the JSON like this:\r\n```\r\nCommon.parseJson(arr.getJSONObject(i).toString(), House.class)\r\n```\r\n\r\nThis is my JSON parser:\r\n```\r\npublic static &lt;T&gt; T parseJson(String json, Class&lt;T&gt; type) {\r\n    if (json.equals(&quot;{}&quot;)) return null;\r\n    else {\r\n        Gson gson = new GsonBuilder().create();\r\n        return gson.fromJson(json, type);\r\n    }\r\n}\r\n```\r\n\r\n","title":"Deserialize JSON into DTO object and trim string values","body":"<p>Is there a way I could deserialize JSON string into DTO object and trim all the string values in the proces with some kind of a contstructor? Or could I update my custom JSON parser code?</p>\n<p>This is an excaple of DTO class:</p>\n<pre><code>public class House {\n    @SerializedName(&quot;HouseID&quot;)\n    @Expose\n    private final int houseId;\n    @SerializedName(&quot;Address&quot;)\n    @Expose\n    private final String address;\n    @SerializedName(&quot;Number&quot;)\n    @Expose\n    private final int number;\n}\n</code></pre>\n<p>After I receive a JSON response I parse the JSON like this:</p>\n<pre><code>Common.parseJson(arr.getJSONObject(i).toString(), House.class)\n</code></pre>\n<p>This is my JSON parser:</p>\n<pre><code>public static &lt;T&gt; T parseJson(String json, Class&lt;T&gt; type) {\n    if (json.equals(&quot;{}&quot;)) return null;\n    else {\n        Gson gson = new GsonBuilder().create();\n        return gson.fromJson(json, type);\n    }\n}\n</code></pre>\n"},{"tags":["java","spring-boot","maven","sonarqube","maven-surefire-plugin"],"comments":[{"owner":{"account_id":350117,"reputation":8653,"user_id":685806,"accept_rate":44,"display_name":"Pino"},"score":0,"creation_date":1694767317,"post_id":77110860,"comment_id":135937324,"body_markdown":"Does this answer your question? [multiple maven modules sonar code coverage is showing zero % on sonar qube](https://stackoverflow.com/questions/68157168/multiple-maven-modules-sonar-code-coverage-is-showing-zero-on-sonar-qube)","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/68157168/multiple-maven-modules-sonar-code-coverage-is-showing-zero-on-sonar-qube\">multiple maven modules sonar code coverage is showing zero % on sonar qube</a>"},{"owner":{"account_id":5289146,"reputation":8128,"user_id":4222206,"display_name":"queeg"},"score":0,"creation_date":1694768225,"post_id":77110860,"comment_id":135937481,"body_markdown":"Your 0.0% are for NEW code only. What is the overall amount?","body":"Your 0.0% are for NEW code only. What is the overall amount?"},{"owner":{"account_id":9010593,"reputation":2151,"user_id":6715384,"display_name":"HMT"},"score":0,"creation_date":1694768472,"post_id":77110860,"comment_id":135937527,"body_markdown":"overall is also 0%","body":"overall is also 0%"},{"owner":{"account_id":3116234,"reputation":9296,"user_id":2636929,"display_name":"Stultuske"},"score":0,"creation_date":1694769524,"post_id":77110860,"comment_id":135937727,"body_markdown":"for all we know, you have zero tests written.","body":"for all we know, you have zero tests written."},{"owner":{"account_id":9010593,"reputation":2151,"user_id":6715384,"display_name":"HMT"},"score":1,"creation_date":1694769806,"post_id":77110860,"comment_id":135937781,"body_markdown":"Actually , the coverage was coming 70% before, but it is coming as 0 after updating the versions of spring boot , sonar and jacoco. I have written the test cases. Sure fire reports rae getting generated but I don&#39;t see jacoco.xml though jacoco.exec is generating","body":"Actually , the coverage was coming 70% before, but it is coming as 0 after updating the versions of spring boot , sonar and jacoco. I have written the test cases. Sure fire reports rae getting generated but I don&#39;t see jacoco.xml though jacoco.exec is generating"}],"answers":[{"tags":[],"owner":{"account_id":9010593,"reputation":2151,"user_id":6715384,"display_name":"HMT"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1694784601,"creation_date":1694772970,"answer_id":77111528,"question_id":77110860,"body_markdown":"This worked for me:\r\n\r\n1. Run `mvn clean install` (check if `jacoco.exec` is generated in the `target` folder).\r\n2. Then run `mvn jacoco:report` (This will generate the `jacoco.xml` file which sonar will import and calculate the coverage)","title":"Getting 0% Sonar coverage, jacoco.xml not generated","body":"<p>This worked for me:</p>\n<ol>\n<li>Run <code>mvn clean install</code> (check if <code>jacoco.exec</code> is generated in the <code>target</code> folder).</li>\n<li>Then run <code>mvn jacoco:report</code> (This will generate the <code>jacoco.xml</code> file which sonar will import and calculate the coverage)</li>\n</ol>\n"}],"owner":{"account_id":9010593,"reputation":2151,"user_id":6715384,"display_name":"HMT"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":117,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":77111528,"answer_count":1,"score":2,"last_activity_date":1694784601,"creation_date":1694766965,"question_id":77110860,"body_markdown":"This is how my POM file looks like:\r\n   \r\n \r\n\r\n    &lt;properties&gt;\r\n        \t&lt;java.version&gt;11&lt;/java.version&gt;\r\n        \t&lt;spring-cloud.version&gt;3.1.5&lt;/spring-cloud.version&gt;\r\n        \t&lt;jacoco.version&gt;0.8.6&lt;/jacoco.version&gt;\r\n        \t&lt;sonar.java.coveragePlugin&gt;jacoco&lt;/sonar.java.coveragePlugin&gt;\r\n        \t&lt;sonar.dynamicAnalysis&gt;reuseReports&lt;/sonar.dynamicAnalysis&gt;\r\n        \t&lt;sonar.version&gt;3.4.0.905&lt;/sonar.version&gt;\r\n        \t&lt;swagger.version&gt;3.0.0&lt;/swagger.version&gt;\r\n        \t&lt;sonar.host.url&gt;http://localhost:9000&lt;/sonar.host.url&gt;\r\n        \t&lt;sonar.jacoco.reportPath&gt;${project.basedir}/../target/jacoco.exec&lt;/sonar.jacoco.reportPath&gt;\r\n        &lt;/properties&gt;\r\n    &lt;plugin&gt;\r\n                    &lt;groupId&gt;org.sonarsource.scanner.maven&lt;/groupId&gt;\r\n                    &lt;artifactId&gt;sonar-maven-plugin&lt;/artifactId&gt;\r\n                    &lt;version&gt;${sonar.version}&lt;/version&gt;\r\n                &lt;/plugin&gt;\r\n    &lt;plugin&gt;\r\n        &lt;groupId&gt;org.jacoco&lt;/groupId&gt;\r\n        &lt;artifactId&gt;jacoco-maven-plugin&lt;/artifactId&gt;\r\n        &lt;version&gt;${jacoco.version}&lt;/version&gt;\r\n        &lt;executions&gt;\r\n            &lt;execution&gt;\r\n                &lt;id&gt;jacoco-initialize&lt;/id&gt;\r\n                &lt;goals&gt;\r\n                    &lt;goal&gt;prepare-agent&lt;/goal&gt;\r\n                &lt;/goals&gt;\r\n            &lt;/execution&gt;\r\n            &lt;execution&gt;\r\n                &lt;id&gt;jacoco-site&lt;/id&gt;\r\n                &lt;phase&gt;package&lt;/phase&gt;\r\n                &lt;goals&gt;\r\n                    &lt;goal&gt;report&lt;/goal&gt;\r\n                &lt;/goals&gt;\r\n            &lt;/execution&gt;\r\n        &lt;/executions&gt;\r\n    &lt;/plugin&gt;\r\n\r\n[![enter image description here][1]][1]\r\n\r\n[![enter image description here][2]][2]\r\n\r\n\r\n the coverage was coming 70% before, but it is coming as 0 after updating the versions of spring boot , sonar and jacoco. I have written the test cases. Sure fire reports are getting generated but I don&#39;t see jacoco.xml though jacoco.exec is generating\r\n\r\n[![enter image description here][3]][3]\r\n\r\n\r\n[![enter image description here][4]][4]\r\n\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/f7UpR.png\r\n  [2]: https://i.stack.imgur.com/WlR8W.png\r\n  [3]: https://i.stack.imgur.com/9sLpz.png\r\n  [4]: https://i.stack.imgur.com/gC4zK.png","title":"Getting 0% Sonar coverage, jacoco.xml not generated","body":"<p>This is how my POM file looks like:</p>\n<pre><code>&lt;properties&gt;\n        &lt;java.version&gt;11&lt;/java.version&gt;\n        &lt;spring-cloud.version&gt;3.1.5&lt;/spring-cloud.version&gt;\n        &lt;jacoco.version&gt;0.8.6&lt;/jacoco.version&gt;\n        &lt;sonar.java.coveragePlugin&gt;jacoco&lt;/sonar.java.coveragePlugin&gt;\n        &lt;sonar.dynamicAnalysis&gt;reuseReports&lt;/sonar.dynamicAnalysis&gt;\n        &lt;sonar.version&gt;3.4.0.905&lt;/sonar.version&gt;\n        &lt;swagger.version&gt;3.0.0&lt;/swagger.version&gt;\n        &lt;sonar.host.url&gt;http://localhost:9000&lt;/sonar.host.url&gt;\n        &lt;sonar.jacoco.reportPath&gt;${project.basedir}/../target/jacoco.exec&lt;/sonar.jacoco.reportPath&gt;\n    &lt;/properties&gt;\n&lt;plugin&gt;\n                &lt;groupId&gt;org.sonarsource.scanner.maven&lt;/groupId&gt;\n                &lt;artifactId&gt;sonar-maven-plugin&lt;/artifactId&gt;\n                &lt;version&gt;${sonar.version}&lt;/version&gt;\n            &lt;/plugin&gt;\n&lt;plugin&gt;\n    &lt;groupId&gt;org.jacoco&lt;/groupId&gt;\n    &lt;artifactId&gt;jacoco-maven-plugin&lt;/artifactId&gt;\n    &lt;version&gt;${jacoco.version}&lt;/version&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;id&gt;jacoco-initialize&lt;/id&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;prepare-agent&lt;/goal&gt;\n            &lt;/goals&gt;\n        &lt;/execution&gt;\n        &lt;execution&gt;\n            &lt;id&gt;jacoco-site&lt;/id&gt;\n            &lt;phase&gt;package&lt;/phase&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;report&lt;/goal&gt;\n            &lt;/goals&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/f7UpR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f7UpR.png\" alt=\"enter image description here\" /></a></p>\n<p><a href=\"https://i.stack.imgur.com/WlR8W.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WlR8W.png\" alt=\"enter image description here\" /></a></p>\n<p>the coverage was coming 70% before, but it is coming as 0 after updating the versions of spring boot , sonar and jacoco. I have written the test cases. Sure fire reports are getting generated but I don't see jacoco.xml though jacoco.exec is generating</p>\n<p><a href=\"https://i.stack.imgur.com/9sLpz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9sLpz.png\" alt=\"enter image description here\" /></a></p>\n<p><a href=\"https://i.stack.imgur.com/gC4zK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gC4zK.png\" alt=\"enter image description here\" /></a></p>\n"},{"tags":["java","windows","swing","user-interface"],"answers":[{"tags":[],"owner":{"account_id":1644814,"reputation":41,"user_id":1516520,"display_name":"Tan Hao"},"down_vote_count":10,"up_vote_count":6,"is_accepted":false,"score":-4,"last_activity_date":1473424312,"creation_date":1341977476,"answer_id":11425134,"question_id":11425103,"body_markdown":"try this code:\r\n\r\n    javax.swing.UIManager.setLookAndFeel(&quot;Windows&quot;)","title":"How to get the windows native look in Java GUI programming?","body":"<p>try this code:</p>\n\n<pre><code>javax.swing.UIManager.setLookAndFeel(\"Windows\")\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1355206,"reputation":33312,"user_id":1293744,"accept_rate":44,"display_name":"Kumar Vivek Mitra"},"down_vote_count":0,"up_vote_count":16,"is_accepted":false,"score":16,"last_activity_date":1341980809,"creation_date":1341980809,"answer_id":11425549,"question_id":11425103,"body_markdown":"Try this....\r\n\r\nThe syntax is:\r\n\r\n`UIManager.setLookAndFeel(PLAF);   (Pluggable Look and Feel)`\r\n\r\nSo, **you must include the below 3 lines.**\r\n\r\n    UIManager.setLookAndFeel(&quot;com.sun.java.swing.plaf.windows.WindowsLookAndFeel&quot;);\r\n\r\n    SwingUtilities.updateComponentTreeUI(frame);\r\n\r\n    updateComponentTreeUI(frame);\r\n\r\n**SwingUtilities.updateComponentTreeUI(frame)** is used for refreshing the frame after the change.","title":"How to get the windows native look in Java GUI programming?","body":"<p>Try this....</p>\n\n<p>The syntax is:</p>\n\n<p><code>UIManager.setLookAndFeel(PLAF);   (Pluggable Look and Feel)</code></p>\n\n<p>So, <strong>you must include the below 3 lines.</strong></p>\n\n<pre><code>UIManager.setLookAndFeel(\"com.sun.java.swing.plaf.windows.WindowsLookAndFeel\");\n\nSwingUtilities.updateComponentTreeUI(frame);\n\nupdateComponentTreeUI(frame);\n</code></pre>\n\n<p><strong>SwingUtilities.updateComponentTreeUI(frame)</strong> is used for refreshing the frame after the change.</p>\n"},{"tags":[],"owner":{"account_id":1042637,"reputation":21143,"user_id":1048330,"display_name":"tenorsax"},"down_vote_count":0,"up_vote_count":91,"is_accepted":true,"score":91,"last_activity_date":1341984283,"creation_date":1341984283,"answer_id":11426036,"question_id":11425103,"body_markdown":"Use the following: \r\n\r\n    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());\r\n\r\nRead [UIManager][1] and [How to Set the Look and Feel][2] for more information. \r\n\r\n\r\n  [1]: http://docs.oracle.com/javase/6/docs/api/javax/swing/UIManager.html\r\n  [2]: http://docs.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html","title":"How to get the windows native look in Java GUI programming?","body":"<p>Use the following: </p>\n\n<pre><code>UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());\n</code></pre>\n\n<p>Read <a href=\"http://docs.oracle.com/javase/6/docs/api/javax/swing/UIManager.html\">UIManager</a> and <a href=\"http://docs.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html\">How to Set the Look and Feel</a> for more information. </p>\n"}],"owner":{"account_id":1641172,"reputation":737,"user_id":1513551,"accept_rate":100,"display_name":"Anirudh Rayabharam"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":71230,"favorite_count":0,"down_vote_count":1,"up_vote_count":50,"accepted_answer_id":11426036,"answer_count":3,"score":49,"last_activity_date":1694784569,"creation_date":1341977118,"question_id":11425103,"body_markdown":"I am new to Java programming and want to whether it is possible to get the windows native look in Java GUI applications. Obviously Swing won&#39;t work.","title":"How to get the windows native look in Java GUI programming?","body":"<p>I am new to Java programming and want to whether it is possible to get the windows native look in Java GUI applications. Obviously Swing won't work.</p>\n"},{"tags":["java","hibernate","filter","log4j","java-8"],"answers":[{"tags":[],"owner":{"account_id":48117,"reputation":944,"user_id":142815,"accept_rate":75,"display_name":"Barn"},"down_vote_count":0,"up_vote_count":9,"is_accepted":false,"score":9,"last_activity_date":1563971257,"creation_date":1417093976,"answer_id":27171593,"question_id":26166281,"body_markdown":"Using log4j 1.2 I am able to filter out specific exceptions, using an [ExpressionFilter](https://logging.apache.org/log4j/extras/apidocs/index.html?org/apache/log4j/filter/ExpressionFilter.html) in the Appender.\r\n\r\n    &lt;appender name=&quot;LOGFILE&quot; class=&quot;com.me.RollingFileAppender&quot;&gt;\r\n        &lt;param name=&quot;File&quot; value=&quot;...&quot; /&gt;\r\n        ...\r\n        &lt;layout .../&gt;\r\n        &lt;!-- Exclude expected exceptions --&gt;\r\n        &lt;filter class=&quot;org.apache.log4j.filter.ExpressionFilter&quot;&gt;\r\n            &lt;param name=&quot;Expression&quot; value=&quot;EXCEPTION ~= &#39;String found in the exception message&#39;&quot;/&gt;\r\n            &lt;param name=&quot;AcceptOnMatch&quot; value=&quot;false&quot;/&gt;\r\n        &lt;/filter&gt;\r\n    &lt;/appender&gt;\r\n\r\nSee http://blog.trifork.com/2011/08/23/filtering-specific-exceptions-when-using-log4j/\r\n","title":"How to filter a specific exception from Log4j?","body":"<p>Using log4j 1.2 I am able to filter out specific exceptions, using an <a href=\"https://logging.apache.org/log4j/extras/apidocs/index.html?org/apache/log4j/filter/ExpressionFilter.html\" rel=\"nofollow noreferrer\">ExpressionFilter</a> in the Appender.</p>\n\n<pre><code>&lt;appender name=\"LOGFILE\" class=\"com.me.RollingFileAppender\"&gt;\n    &lt;param name=\"File\" value=\"...\" /&gt;\n    ...\n    &lt;layout .../&gt;\n    &lt;!-- Exclude expected exceptions --&gt;\n    &lt;filter class=\"org.apache.log4j.filter.ExpressionFilter\"&gt;\n        &lt;param name=\"Expression\" value=\"EXCEPTION ~= 'String found in the exception message'\"/&gt;\n        &lt;param name=\"AcceptOnMatch\" value=\"false\"/&gt;\n    &lt;/filter&gt;\n&lt;/appender&gt;\n</code></pre>\n\n<p>See <a href=\"http://blog.trifork.com/2011/08/23/filtering-specific-exceptions-when-using-log4j/\" rel=\"nofollow noreferrer\">http://blog.trifork.com/2011/08/23/filtering-specific-exceptions-when-using-log4j/</a></p>\n"},{"tags":[],"owner":{"account_id":981251,"reputation":691,"user_id":1000908,"accept_rate":71,"display_name":"FiruzzZ"},"down_vote_count":0,"up_vote_count":10,"is_accepted":true,"score":10,"last_activity_date":1589332739,"creation_date":1519729197,"answer_id":49007065,"question_id":26166281,"body_markdown":"I have found the solution - [`RegexFilter`][1].\r\n\r\nHere is the related Log4j 2.x configuration, that allows me to exclude specific messages both from *log file* and *console* appenders.\r\n\r\n&lt;!-- language: lang-xml --&gt;\r\n\r\n    &lt;Appenders&gt;\r\n        &lt;Console name=&quot;console&quot; target=&quot;System.out&quot;&gt;\r\n            &lt;RegexFilter regex=&quot;.*(Javassist Enhancement failed|could not create proxy factory for).*&quot; onMatch=&quot;DENY&quot; onMismatch=&quot;ACCEPT&quot;/&gt;\r\n            &lt;PatternLayout pattern=&quot;%d{yyyy-MM-dd HH:mm:ss} %-2p %c{1.} %x - %m%n&quot;/&gt; \r\n        &lt;/Console&gt;\r\n        &lt;File name=&quot;logfile&quot; filename=&quot;./app.log&quot; append=&quot;true&quot;&gt;\r\n            &lt;!--Evita cargar en el log el error que tira hibernate por Java 8 (default method en Interfaces)--&gt;\r\n            &lt;RegexFilter regex=&quot;.*(Javassist Enhancement failed|could not create proxy factory for).*&quot; onMatch=&quot;DENY&quot; onMismatch=&quot;ACCEPT&quot;/&gt;\r\n            &lt;PatternLayout pattern=&quot;%d{yyyy-MM-dd HH:mm:ss} [%t] %-5p %c{-1} %X{userName} - %m%n&quot;/&gt; \r\n        &lt;/File&gt;\r\n    &lt;/Appenders&gt;\r\n\r\n\r\n  [1]: https://logging.apache.org/log4j/2.x/log4j-core/apidocs/org/apache/logging/log4j/core/filter/RegexFilter.html","title":"How to filter a specific exception from Log4j?","body":"<p>I have found the solution - <a href=\"https://logging.apache.org/log4j/2.x/log4j-core/apidocs/org/apache/logging/log4j/core/filter/RegexFilter.html\" rel=\"noreferrer\"><code>RegexFilter</code></a>.</p>\n\n<p>Here is the related Log4j 2.x configuration, that allows me to exclude specific messages both from <em>log file</em> and <em>console</em> appenders.</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Appenders&gt;\n    &lt;Console name=\"console\" target=\"System.out\"&gt;\n        &lt;RegexFilter regex=\".*(Javassist Enhancement failed|could not create proxy factory for).*\" onMatch=\"DENY\" onMismatch=\"ACCEPT\"/&gt;\n        &lt;PatternLayout pattern=\"%d{yyyy-MM-dd HH:mm:ss} %-2p %c{1.} %x - %m%n\"/&gt; \n    &lt;/Console&gt;\n    &lt;File name=\"logfile\" filename=\"./app.log\" append=\"true\"&gt;\n        &lt;!--Evita cargar en el log el error que tira hibernate por Java 8 (default method en Interfaces)--&gt;\n        &lt;RegexFilter regex=\".*(Javassist Enhancement failed|could not create proxy factory for).*\" onMatch=\"DENY\" onMismatch=\"ACCEPT\"/&gt;\n        &lt;PatternLayout pattern=\"%d{yyyy-MM-dd HH:mm:ss} [%t] %-5p %c{-1} %X{userName} - %m%n\"/&gt; \n    &lt;/File&gt;\n&lt;/Appenders&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2358516,"reputation":1085,"user_id":2065799,"display_name":"Vivek"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694784496,"creation_date":1692102702,"answer_id":76906003,"question_id":26166281,"body_markdown":"&gt; For YAML ,please see/read below:\r\n\r\nThe accepted answer is using [RegexFilter][1] and is an elegant solution for managing log filtering in Log4j2.\r\n\r\n[1]: https://logging.apache.org/log4j/2.x/log4j-core/apidocs/org/apache/logging/log4j/core/filter/RegexFilter.html\r\n\r\nWhile implementing, encountered a scenario where it was needed to exclude a specific `Hibernate` error from being logged. As in our projects we are working with a `YAML` configuration, thus found it valuable to share the approach here, especially since most available examples on the internet tend to focus on `XML` configuration.\r\n\r\nBelow is an example of how to employ the `RegexFilter` within a `YAML` `Log4j2` configuration:\r\n\r\n\r\n```\r\n  Loggers:\r\n    logger:\r\n      - name: org.hibernate.orm.jdbc.batch\r\n        level: ERROR\r\n        Filters:\r\n          # Ignore log events with &#39;org.hibernate.StaleStateException&#39; exception\r\n          - RegexFilter:\r\n              regex: &quot;.*org.hibernate.StaleStateException.*&quot;\r\n              onMatch: DENY\r\n              onMismatch: NEUTRAL\r\n```\r\n\r\nIn the above example, the intent is to filter out logs related to `org.hibernate.StaleStateException`, preventing them from being recorded. This is achieved while allowing all other `error` logs from the `org.hibernate.orm.jdbc.batch` logger to be captured.\r\n\r\nFeel free to customize it further according to your preference.","title":"How to filter a specific exception from Log4j?","body":"<blockquote>\n<p>For YAML ,please see/read below:</p>\n</blockquote>\n<p>The accepted answer is using <a href=\"https://logging.apache.org/log4j/2.x/log4j-core/apidocs/org/apache/logging/log4j/core/filter/RegexFilter.html\" rel=\"nofollow noreferrer\">RegexFilter</a> and is an elegant solution for managing log filtering in Log4j2.</p>\n<p>While implementing, encountered a scenario where it was needed to exclude a specific <code>Hibernate</code> error from being logged. As in our projects we are working with a <code>YAML</code> configuration, thus found it valuable to share the approach here, especially since most available examples on the internet tend to focus on <code>XML</code> configuration.</p>\n<p>Below is an example of how to employ the <code>RegexFilter</code> within a <code>YAML</code> <code>Log4j2</code> configuration:</p>\n<pre><code>  Loggers:\n    logger:\n      - name: org.hibernate.orm.jdbc.batch\n        level: ERROR\n        Filters:\n          # Ignore log events with 'org.hibernate.StaleStateException' exception\n          - RegexFilter:\n              regex: &quot;.*org.hibernate.StaleStateException.*&quot;\n              onMatch: DENY\n              onMismatch: NEUTRAL\n</code></pre>\n<p>In the above example, the intent is to filter out logs related to <code>org.hibernate.StaleStateException</code>, preventing them from being recorded. This is achieved while allowing all other <code>error</code> logs from the <code>org.hibernate.orm.jdbc.batch</code> logger to be captured.</p>\n<p>Feel free to customize it further according to your preference.</p>\n"}],"owner":{"account_id":981251,"reputation":691,"user_id":1000908,"accept_rate":71,"display_name":"FiruzzZ"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":14278,"favorite_count":0,"down_vote_count":0,"up_vote_count":9,"accepted_answer_id":49007065,"answer_count":3,"score":9,"last_activity_date":1694784496,"creation_date":1412271161,"question_id":26166281,"body_markdown":"I&#39;m implementing some new features of Java 8 on my desktop app and Hibernate 3.6 seems to doesn&#39;t like it.\r\n\r\nI added to an Interface a &quot;default method&quot;, since then Hibernate it throwing:\r\n\r\n    2014-10-02 14:01:25,538 WARN entity.PojoEntityTuplizer  - could not create proxy factory for:modelo.ChequeTercero\r\n    org.hibernate.HibernateException: Javassist Enhancement failed: modelo.ChequeTercero\r\n\tat org.hibernate.proxy.pojo.javassist.JavassistLazyInitializer.getProxyFactory(JavassistLazyInitializer.java:169)\r\n\tat org.hibernate.proxy.pojo.javassist.JavassistProxyFactory.postInstantiate(JavassistProxyFactory.java:65)\r\n    Caused by: java.lang.VerifyError: (class: modelo/ChequeTercero_$$_javassist_45, method: _d21getNumeroValor signature: ()Ljava/lang/String;) Illegal use of nonvirtual function call\r\n\r\nfor EACH class that implement the interface multiplied for EACH default method in the interface.\r\n\r\nAs this log is a `Level.WARN`, it is generating biiiiiiiiiig log file on the users every time they open the application.\r\n\r\nI tried to make some logger filters but is not working:\r\n\r\n    &lt;filter class=&quot;org.hibernate.proxy.pojo.BasicLazyInitializer&quot;&gt;\r\n    &lt;param name=&quot;LevelMin&quot; value=&quot;FATAL&quot; /&gt;\r\n    &lt;param name=&quot;LevelMax&quot; value=&quot;FATAL&quot; /&gt;\r\n        &lt;/filter&gt;\r\n    &lt;filter class=&quot;org.apache.log4j.filter.ExpressionFilter&quot;&gt;\r\n            &lt;param name=&quot;expression&quot; value=&quot;EXCEPTION ~= org.hibernate.proxy.pojo.BasicLazyInitializer&quot;/&gt;\r\n            &lt;param name=&quot;acceptOnMatch&quot; value=&quot;false&quot;/&gt;\r\n        &lt;/filter&gt;\r\n        &lt;filter class=&quot;org.apache.log4j.varia.StringMatchFilter&quot;&gt;\r\n            &lt;param name=&quot;StringToMatch&quot; value=&quot;org.hibernate.HibernateException: Javassist Enhancement failed&quot;/&gt;\r\n            &lt;param name=&quot;AcceptOnMatch&quot; value=&quot;false&quot; /&gt;\r\n        &lt;/filter&gt;\r\n        &lt;!--&lt;filter class=&quot;org.apache.log4j.varia.DenyAllFilter&quot;/&gt; --&gt;\r\n\r\n\r\nWhat am I doing wrong? Also if I uncomment `DenyAllFilter` no log appears anymore.\r\n","title":"How to filter a specific exception from Log4j?","body":"<p>I'm implementing some new features of Java 8 on my desktop app and Hibernate 3.6 seems to doesn't like it.</p>\n\n<p>I added to an Interface a \"default method\", since then Hibernate it throwing:</p>\n\n<pre><code>2014-10-02 14:01:25,538 WARN entity.PojoEntityTuplizer  - could not create proxy factory for:modelo.ChequeTercero\norg.hibernate.HibernateException: Javassist Enhancement failed: modelo.ChequeTercero\nat org.hibernate.proxy.pojo.javassist.JavassistLazyInitializer.getProxyFactory(JavassistLazyInitializer.java:169)\nat org.hibernate.proxy.pojo.javassist.JavassistProxyFactory.postInstantiate(JavassistProxyFactory.java:65)\nCaused by: java.lang.VerifyError: (class: modelo/ChequeTercero_$$_javassist_45, method: _d21getNumeroValor signature: ()Ljava/lang/String;) Illegal use of nonvirtual function call\n</code></pre>\n\n<p>for EACH class that implement the interface multiplied for EACH default method in the interface.</p>\n\n<p>As this log is a <code>Level.WARN</code>, it is generating biiiiiiiiiig log file on the users every time they open the application.</p>\n\n<p>I tried to make some logger filters but is not working:</p>\n\n<pre><code>&lt;filter class=\"org.hibernate.proxy.pojo.BasicLazyInitializer\"&gt;\n&lt;param name=\"LevelMin\" value=\"FATAL\" /&gt;\n&lt;param name=\"LevelMax\" value=\"FATAL\" /&gt;\n    &lt;/filter&gt;\n&lt;filter class=\"org.apache.log4j.filter.ExpressionFilter\"&gt;\n        &lt;param name=\"expression\" value=\"EXCEPTION ~= org.hibernate.proxy.pojo.BasicLazyInitializer\"/&gt;\n        &lt;param name=\"acceptOnMatch\" value=\"false\"/&gt;\n    &lt;/filter&gt;\n    &lt;filter class=\"org.apache.log4j.varia.StringMatchFilter\"&gt;\n        &lt;param name=\"StringToMatch\" value=\"org.hibernate.HibernateException: Javassist Enhancement failed\"/&gt;\n        &lt;param name=\"AcceptOnMatch\" value=\"false\" /&gt;\n    &lt;/filter&gt;\n    &lt;!--&lt;filter class=\"org.apache.log4j.varia.DenyAllFilter\"/&gt; --&gt;\n</code></pre>\n\n<p>What am I doing wrong? Also if I uncomment <code>DenyAllFilter</code> no log appears anymore.</p>\n"},{"tags":["java","spring-boot","jpa","spring-data-jpa","spring-retry"],"comments":[{"owner":{"account_id":538250,"reputation":14477,"user_id":903137,"accept_rate":71,"display_name":"Ashish"},"score":0,"creation_date":1694716416,"post_id":77107528,"comment_id":135931571,"body_markdown":"do you have `@EnableRetry` in your AppConfig class ?","body":"do you have <code>@EnableRetry</code> in your AppConfig class ?"},{"owner":{"account_id":29444595,"reputation":1,"user_id":22562155,"display_name":"PCcorrosive"},"score":0,"creation_date":1694719169,"post_id":77107528,"comment_id":135931998,"body_markdown":"@Ashish Yes, I do","body":"@Ashish Yes, I do"},{"owner":{"account_id":231721,"reputation":20460,"user_id":496099,"display_name":"Chris"},"score":1,"creation_date":1694800459,"post_id":77107528,"comment_id":135943679,"body_markdown":"This looks like the same question as here: https://stackoverflow.com/questions/42730104/retryable-doesnt-work-in-spring-data-repository-interface They don&#39;t seem to have support for it - see https://github.com/spring-projects/spring-data-jpa/issues/2223","body":"This looks like the same question as here: <a href=\"https://stackoverflow.com/questions/42730104/retryable-doesnt-work-in-spring-data-repository-interface\" title=\"retryable doesnt work in spring data repository interface\">stackoverflow.com/questions/42730104/&hellip;</a> They don&#39;t seem to have support for it - see <a href=\"https://github.com/spring-projects/spring-data-jpa/issues/2223\" rel=\"nofollow noreferrer\">github.com/spring-projects/spring-data-jpa/issues/2223</a>"}],"owner":{"account_id":29444595,"reputation":1,"user_id":22562155,"display_name":"PCcorrosive"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":132,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694784293,"creation_date":1694715856,"question_id":77107528,"body_markdown":"I am trying to implement retries on the methods of a class that extends JpaRespository. For all the methods annotated with @Query the retries work as expected (3 retries, and then the error is thrown if unsuccessful). However, when the inherited save() function is called and a database exception is thrown, only one retry is performed, and then program execution continues as if the query were successful (even though it wasn&#39;t). \r\n\r\nThe MSSQL database connection is configured with Spring Boot. The repository is defined similarly to the below:\r\n\r\n    @EnableJpaRepositories\r\n    @Repository\r\n    @Retryable(listeners = {&quot;retryListeners&quot;})\r\n    public interface ExampleRepo extends JpaRepository&lt;ExampleRecord, Long&gt;{\r\n\r\n    @Query(&quot;select * from ExampleRepo where exampleParam = :exampleParam&quot;)\r\n    List&lt;ExampleRecord&gt; exampleQuery(@Param(&quot;exampleParam&quot;) String exampleParam);\r\n\r\n    }\r\n\r\nThe save method is being called on an instance of the repo from another class. \r\n\r\n    exampleRepo.save(exampleRecord);\r\n\r\nEditing to add that my AppConfig class is like below:\r\n\r\n    @Slf4j\r\n    @Configuration\r\n    @EnableRetry\r\n    public class AppConfig {\r\n    \r\n    // unrelated configurations\r\n    \r\n    // Retry listener bean implemented similarly to this response https://stackoverflow.com/a/50704746/22562155\r\n\r\n    }\r\n\r\nThe output I get in the console comes in this order:\r\n\r\n1. &quot;Starting retryable method&quot; from the retryListener\r\n2. Hibernate debug logs with the query and parameter binding information\r\n3. SqlExceptionHelper logs with error info, eg that data would be truncated\r\n4. &quot;Retryable method threw exception&quot; from the retryListener\r\n5. &quot;Finished retryable method&quot; from the retryListener\r\n6. Logs from continued normal code execution; no exception is thrown\r\n\r\n\r\n\r\nI have stepped through the execution with the IntelliJ debugger, and I can tell that somehow the retry implementation concludes that the retryable method succeeded, but I&#39;m having trouble understanding why. I can&#39;t find any answers online about this issue to reference; I am hoping someone else knows whether the save() method is incompatible with the Retryable annotation, or if there is something I need to fix for this to work. ","title":"Can Spring Boot @Retryable work with the Spring Data JPA save() method? My attempt retries once and then fakes success","body":"<p>I am trying to implement retries on the methods of a class that extends JpaRespository. For all the methods annotated with @Query the retries work as expected (3 retries, and then the error is thrown if unsuccessful). However, when the inherited save() function is called and a database exception is thrown, only one retry is performed, and then program execution continues as if the query were successful (even though it wasn't).</p>\n<p>The MSSQL database connection is configured with Spring Boot. The repository is defined similarly to the below:</p>\n<pre><code>@EnableJpaRepositories\n@Repository\n@Retryable(listeners = {&quot;retryListeners&quot;})\npublic interface ExampleRepo extends JpaRepository&lt;ExampleRecord, Long&gt;{\n\n@Query(&quot;select * from ExampleRepo where exampleParam = :exampleParam&quot;)\nList&lt;ExampleRecord&gt; exampleQuery(@Param(&quot;exampleParam&quot;) String exampleParam);\n\n}\n</code></pre>\n<p>The save method is being called on an instance of the repo from another class.</p>\n<pre><code>exampleRepo.save(exampleRecord);\n</code></pre>\n<p>Editing to add that my AppConfig class is like below:</p>\n<pre><code>@Slf4j\n@Configuration\n@EnableRetry\npublic class AppConfig {\n\n// unrelated configurations\n\n// Retry listener bean implemented similarly to this response https://stackoverflow.com/a/50704746/22562155\n\n}\n</code></pre>\n<p>The output I get in the console comes in this order:</p>\n<ol>\n<li>&quot;Starting retryable method&quot; from the retryListener</li>\n<li>Hibernate debug logs with the query and parameter binding information</li>\n<li>SqlExceptionHelper logs with error info, eg that data would be truncated</li>\n<li>&quot;Retryable method threw exception&quot; from the retryListener</li>\n<li>&quot;Finished retryable method&quot; from the retryListener</li>\n<li>Logs from continued normal code execution; no exception is thrown</li>\n</ol>\n<p>I have stepped through the execution with the IntelliJ debugger, and I can tell that somehow the retry implementation concludes that the retryable method succeeded, but I'm having trouble understanding why. I can't find any answers online about this issue to reference; I am hoping someone else knows whether the save() method is incompatible with the Retryable annotation, or if there is something I need to fix for this to work.</p>\n"},{"tags":["java","memory-management","garbage-collection","javabeans","jmx"],"comments":[{"owner":{"account_id":54150,"reputation":2013,"user_id":161995,"accept_rate":100,"display_name":"Erik"},"score":0,"creation_date":1548241084,"post_id":54325529,"comment_id":95469734,"body_markdown":"System.gc is not an order, it&#39;s a recommendation. There are no guarantees that the gc will actually be performed.","body":"System.gc is not an order, it&#39;s a recommendation. There are no guarantees that the gc will actually be performed."},{"owner":{"account_id":5495106,"reputation":343,"user_id":4366515,"display_name":"Tomer Shahar"},"score":0,"creation_date":1548241554,"post_id":54325529,"comment_id":95469985,"body_markdown":"@Erik Agree, but as I mention in the post, there is a test that waits for GC to be performed and check it by using a WeakReference to an object that is being cleaned. If this isn&#39;t a sufficient indication for GC then what is?","body":"@Erik Agree, but as I mention in the post, there is a test that waits for GC to be performed and check it by using a WeakReference to an object that is being cleaned. If this isn&#39;t a sufficient indication for GC then what is?"},{"owner":{"account_id":54150,"reputation":2013,"user_id":161995,"accept_rate":100,"display_name":"Erik"},"score":0,"creation_date":1548242423,"post_id":54325529,"comment_id":95470488,"body_markdown":"But is there a reason for the gc to run? What does the heap look like? If there are space enough, why should it run?","body":"But is there a reason for the gc to run? What does the heap look like? If there are space enough, why should it run?"},{"owner":{"account_id":5495106,"reputation":343,"user_id":4366515,"display_name":"Tomer Shahar"},"score":0,"creation_date":1548242493,"post_id":54325529,"comment_id":95470534,"body_markdown":"I also tried creating a lot of object, but let&#39;s say I didn&#39;t. The fact that the ref is empty should mean that it did actually ran GC.","body":"I also tried creating a lot of object, but let&#39;s say I didn&#39;t. The fact that the ref is empty should mean that it did actually ran GC."},{"owner":{"account_id":54150,"reputation":2013,"user_id":161995,"accept_rate":100,"display_name":"Erik"},"score":0,"creation_date":1548248280,"post_id":54325529,"comment_id":95473593,"body_markdown":"Look at the gc log.","body":"Look at the gc log."},{"owner":{"account_id":3211603,"reputation":289297,"user_id":2711488,"display_name":"Holger"},"score":0,"creation_date":1548261868,"post_id":54325529,"comment_id":95481713,"body_markdown":"It seems, it doesn’t send any notification when only the Young Generation changes. When I create enough objects to affect the Old Generation, I get notifications. Which makes me wonder whether there is any documentation about whether and which notifications are supposed to be sent. Or is finding out that the object implements `NotificationEmitter` at runtime the best we can get?","body":"It seems, it doesn’t send any notification when only the Young Generation changes. When I create enough objects to affect the Old Generation, I get notifications. Which makes me wonder whether there is any documentation about whether and which notifications are supposed to be sent. Or is finding out that the object implements <code>NotificationEmitter</code> at runtime the best we can get?"}],"answers":[{"tags":[],"owner":{"account_id":6010176,"reputation":986,"user_id":4720870,"display_name":"Tarun"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1548241802,"creation_date":1548241802,"answer_id":54325901,"question_id":54325529,"body_markdown":"This is what [System.gc()][1] javadoc says  \r\n\r\n&gt; Calling the gc method suggests that the Java Virtual Machine expend\r\n&gt; effort toward recycling unused objects in order to make the memory\r\n&gt; they currently occupy available for quick reuse. When control returns\r\n&gt; from the method call, the Java Virtual Machine has made a best effort\r\n&gt; to reclaim space from all discarded objects.\r\n\r\nCalling garbage collector does not means that garbage will collected immediately on call. But by calling gc you can only suggest JVM to collect garbage but cannot force it.\r\n\r\n\r\n  [1]: https://docs.oracle.com/javase/7/docs/api/java/lang/System.html#gc()","title":"Java garbage collection is performed, but GC notification is not received","body":"<p>This is what <a href=\"https://docs.oracle.com/javase/7/docs/api/java/lang/System.html#gc()\" rel=\"nofollow noreferrer\">System.gc()</a> javadoc says  </p>\n\n<blockquote>\n  <p>Calling the gc method suggests that the Java Virtual Machine expend\n  effort toward recycling unused objects in order to make the memory\n  they currently occupy available for quick reuse. When control returns\n  from the method call, the Java Virtual Machine has made a best effort\n  to reclaim space from all discarded objects.</p>\n</blockquote>\n\n<p>Calling garbage collector does not means that garbage will collected immediately on call. But by calling gc you can only suggest JVM to collect garbage but cannot force it.</p>\n"},{"tags":[],"owner":{"account_id":5495106,"reputation":343,"user_id":4366515,"display_name":"Tomer Shahar"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1650658247,"creation_date":1548597252,"answer_id":54388868,"question_id":54325529,"body_markdown":"The problem actually was:\r\n\r\n1. As Holger mentioned in a comment, I was only getting notification for GC that affected the old generation, and \r\n2. Debugger did not stop at my breakpoint, though the code was executed, so even though I couldn&#39;t tell, doSomething actually did something.\r\n","title":"Java garbage collection is performed, but GC notification is not received","body":"<p>The problem actually was:</p>\n<ol>\n<li>As Holger mentioned in a comment, I was only getting notification for GC that affected the old generation, and</li>\n<li>Debugger did not stop at my breakpoint, though the code was executed, so even though I couldn't tell, doSomething actually did something.</li>\n</ol>\n"}],"owner":{"account_id":5495106,"reputation":343,"user_id":4366515,"display_name":"Tomer Shahar"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":841,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":2,"score":2,"last_activity_date":1694784142,"creation_date":1548240629,"question_id":54325529,"body_markdown":"I have followed a few examples from various sources, and have the following snippet:\r\n\r\n     private void registerForMemUsageChanges() {\r\n        List&lt;GarbageCollectorMXBean&gt; garbageCollectorMXBeans = ManagementFactory.getGarbageCollectorMXBeans();\r\n        for (GarbageCollectorMXBean garbageCollectorMXBean : garbageCollectorMXBeans) {\r\n            listenForGarbageCollectionOn(garbageCollectorMXBean); \r\n        }\r\n\r\n    }\r\n\r\n    private void listenForGarbageCollectionOn(GarbageCollectorMXBean garbageCollectorMXBean) {\r\n        NotificationEmitter notificationEmitter = (NotificationEmitter) garbageCollectorMXBean;\r\n        GarbageListener listener = new GarbageListener();\r\n        notificationEmitter.addNotificationListener(listener, null, null);\r\n    }\r\n\r\n    public class GarbageListener implements NotificationListener {\r\n\r\n        @Override\r\n        public void handleNotification(Notification notification, Object handback) {\r\n            if (notification.getType().equals(GarbageCollectionNotificationInfo.GARBAGE_COLLECTION_NOTIFICATION)) {\r\n                doSomthing();//irrelevant\r\n            }\r\n\r\n        }\r\n    }\r\nI have added a test that does the following (again, based on examples I found) and it seems to work:\r\n\r\n    private void triggerGc() throws InterruptedException {\r\n        Object obj = new Object();\r\n        WeakReference ref = new WeakReference&lt;Object&gt;(obj);\r\n        obj = null;\r\n        while(ref.get() != null) {\r\n            System.gc();\r\n        }\r\n    }\r\n\r\n\r\nWhile running in debug mode I see that the listener is registered to ps marksweep and ps scavenge. **The while loop finished (which I take as a sign that GC was performed)** but no notification is called. Not a GC notification or of any type.\r\n\r\n\r\nIs the problem that the listener is registered wrong or was GC not really performed? it seems that the weak ref is indeed empty after the while loop.\r\n\r\nI am using openjdk 1.8.0_144.\r\n  ","title":"Java garbage collection is performed, but GC notification is not received","body":"<p>I have followed a few examples from various sources, and have the following snippet:</p>\n\n<pre><code> private void registerForMemUsageChanges() {\n    List&lt;GarbageCollectorMXBean&gt; garbageCollectorMXBeans = ManagementFactory.getGarbageCollectorMXBeans();\n    for (GarbageCollectorMXBean garbageCollectorMXBean : garbageCollectorMXBeans) {\n        listenForGarbageCollectionOn(garbageCollectorMXBean); \n    }\n\n}\n\nprivate void listenForGarbageCollectionOn(GarbageCollectorMXBean garbageCollectorMXBean) {\n    NotificationEmitter notificationEmitter = (NotificationEmitter) garbageCollectorMXBean;\n    GarbageListener listener = new GarbageListener();\n    notificationEmitter.addNotificationListener(listener, null, null);\n}\n\npublic class GarbageListener implements NotificationListener {\n\n    @Override\n    public void handleNotification(Notification notification, Object handback) {\n        if (notification.getType().equals(GarbageCollectionNotificationInfo.GARBAGE_COLLECTION_NOTIFICATION)) {\n            doSomthing();//irrelevant\n        }\n\n    }\n}\n</code></pre>\n\n<p>I have added a test that does the following (again, based on examples I found) and it seems to work:</p>\n\n<pre><code>private void triggerGc() throws InterruptedException {\n    Object obj = new Object();\n    WeakReference ref = new WeakReference&lt;Object&gt;(obj);\n    obj = null;\n    while(ref.get() != null) {\n        System.gc();\n    }\n}\n</code></pre>\n\n<p>While running in debug mode I see that the listener is registered to ps marksweep and ps scavenge. <strong>The while loop finished (which I take as a sign that GC was performed)</strong> but no notification is called. Not a GC notification or of any type.</p>\n\n<p>Is the problem that the listener is registered wrong or was GC not really performed? it seems that the weak ref is indeed empty after the while loop.</p>\n\n<p>I am using openjdk 1.8.0_144.</p>\n"},{"tags":["java","collections"],"comments":[{"owner":{"account_id":8655,"reputation":20729,"user_id":15689,"accept_rate":91,"display_name":"Brian Knoblauch"},"score":0,"creation_date":1393357001,"post_id":1049518,"comment_id":33387040,"body_markdown":"After dealing with it a few times in code, I&#39;m pretty sure it&#39;s that way just to make maintenance programmers angry at the API designer.  :-)  Greenfield programmers end up passing around LinkedList (instead of List) so they can use getLast().  Maintenance guys figure out that ArrayList is more appropriate and have to deal with all these specified LinkedLists that really should have been List in the first place (and probably would have been except for this one critical failure in the List interface)...","body":"After dealing with it a few times in code, I&#39;m pretty sure it&#39;s that way just to make maintenance programmers angry at the API designer.  :-)  Greenfield programmers end up passing around LinkedList (instead of List) so they can use getLast().  Maintenance guys figure out that ArrayList is more appropriate and have to deal with all these specified LinkedLists that really should have been List in the first place (and probably would have been except for this one critical failure in the List interface)..."}],"answers":[{"tags":[],"owner":{"account_id":18735,"reputation":12072,"user_id":43222,"accept_rate":87,"display_name":"Zack Marrapese"},"down_vote_count":1,"up_vote_count":3,"is_accepted":false,"score":2,"last_activity_date":1246044525,"creation_date":1246027646,"answer_id":1049540,"question_id":1049518,"body_markdown":"An interface&#39;s goal is to provide the maximum usability with the lowest possible number of public methods. The less methods there are to support, the better. There is no getLast() method because this can be derived, as you said.\r\n\r\nLinkedList, on the other hand is a concrete implementation, and therefore doesn&#39;t have these issues.\r\n\r\nEdit: as Skaffman pointed out, this is not the *main* goal of an interface. It is more a secondary goal which allows implementations of this interface to be easier to maintain. The main purpose of an interface is to decouple the concrete implementation from the objects that use it.","title":"Why does the Java List interface not support getLast()?","body":"<p>An interface's goal is to provide the maximum usability with the lowest possible number of public methods. The less methods there are to support, the better. There is no getLast() method because this can be derived, as you said.</p>\n\n<p>LinkedList, on the other hand is a concrete implementation, and therefore doesn't have these issues.</p>\n\n<p>Edit: as Skaffman pointed out, this is not the <em>main</em> goal of an interface. It is more a secondary goal which allows implementations of this interface to be easier to maintain. The main purpose of an interface is to decouple the concrete implementation from the objects that use it.</p>\n"},{"tags":[],"owner":{"account_id":2794,"reputation":88136,"user_id":3937,"accept_rate":76,"display_name":"Lou Franco"},"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1246027718,"creation_date":1246027718,"answer_id":1049543,"question_id":1049518,"body_markdown":"Usually the reason is that they wanted to specify each function with a Big-O requirement and felt that getLast() could not be implemented efficiently on all lists.  So they introduce it at each level with its Big-O promise.\r\n\r\nOr it could just have been an oversight, or they felt it wasn&#39;t common enough and if you needed it you could get it with size/getIndex.","title":"Why does the Java List interface not support getLast()?","body":"<p>Usually the reason is that they wanted to specify each function with a Big-O requirement and felt that getLast() could not be implemented efficiently on all lists.  So they introduce it at each level with its Big-O promise.</p>\n\n<p>Or it could just have been an oversight, or they felt it wasn't common enough and if you needed it you could get it with size/getIndex.</p>\n"},{"tags":[],"owner":{"account_id":15311,"reputation":2760,"user_id":32188,"accept_rate":82,"display_name":"Alexandru Luchian"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1246027734,"creation_date":1246027734,"answer_id":1049546,"question_id":1049518,"body_markdown":"As you said, with List you can get the last one with getIndex(), since it&#39;s index based. So personally I do not see any good reason to put it (since you can write it yourself).\r\n\r\nWhile a LinkedList is not array based, so no indexes, it makes sense to provide a method like that, sometimes you need to know the last item.","title":"Why does the Java List interface not support getLast()?","body":"<p>As you said, with List you can get the last one with getIndex(), since it's index based. So personally I do not see any good reason to put it (since you can write it yourself).</p>\n\n<p>While a LinkedList is not array based, so no indexes, it makes sense to provide a method like that, sometimes you need to know the last item.</p>\n"},{"tags":[],"owner":{"account_id":19563,"reputation":1419,"user_id":45938,"accept_rate":50,"display_name":"clemahieu"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1246028627,"creation_date":1246028627,"answer_id":1049614,"question_id":1049518,"body_markdown":"getLast() couldn&#39;t be implemented in a one-way linked list.  getIndex() on a one-way linked list would probably scan the entire list from the beginning so it has an efficiency implication.","title":"Why does the Java List interface not support getLast()?","body":"<p>getLast() couldn't be implemented in a one-way linked list.  getIndex() on a one-way linked list would probably scan the entire list from the beginning so it has an efficiency implication.</p>\n"},{"tags":[],"owner":{"account_id":2842,"reputation":31004,"user_id":4023,"accept_rate":89,"display_name":"Matthew Murdoch"},"down_vote_count":0,"up_vote_count":19,"is_accepted":true,"score":19,"last_activity_date":1246035734,"creation_date":1246029306,"answer_id":1049678,"question_id":1049518,"body_markdown":"The `java.util.List` interface doesn&#39;t support `getLast()` because the designers went for a &#39;minimal interface&#39;. With the minimal number of methods defined it makes it both easier to understand and quicker to learn.\n\nThis is in contrast with a &#39;humane interface&#39; (such as used in the [Ruby array class][1]) which attempts to provide methods for doing common operations (e.g. `getLast()`). As there are many uses which such a fundamental concept as a list can be put to this tends to lead to much larger interfaces.\n\nFor further information see Martin Fowler&#39;s [Minimal Interface][2] and [Humane Interface][3] descriptions.\n\nAs to why LinkedList supports `getLast()` etc., to quote the javadoc:\n\n&gt; ... the LinkedList class provides uniformly named methods to get, remove and insert an element at the beginning and end of the list. These operations allow linked lists to be used as a stack, queue, or double-ended queue (deque).\n\nPresumably it was felt that a general List would not be adequate for these specific use cases.\n\nAs an insight into the mind of the principal designer of the Java Collections API (Joshua Bloch) he provides [this list of API design maxims][4] by which he works. Of which, the most pertinent to this question are:\n\n&gt; Early drafts of APIs should be short, typically one page with class and method signatures and one-line descriptions. This makes it easy to restructure the API when you don&#39;t get it right the first time.\n&gt;\n&gt; When in doubt, leave it out. If there is a fundamental theorem of API design, this is it. It applies equally to functionality, classes, methods, and parameters. Every facet of an API should be as small as possible, but no smaller. You can always add things later, but you can&#39;t take them away. Minimizing conceptual weight is more important than class- or method-count.\n&gt;\n&gt; Keep APIs free of implementations details. They confuse users and inhibit the flexibility to evolve. It isn&#39;t always obvious what&#39;s an implementation detail: Be wary of overspecification.\n&gt;\n&gt; Minimize accessibility; when in doubt, make it private. This simplifies APIs and reduces coupling.\n&gt;\n&gt; Consider the performance consequences of API design decisions, but don&#39;t warp an API to achieve performance gains. Luckily, good APIs typically lend themselves to fast implementations.\n\nHowever he also states:\n\n&gt; Don&#39;t make the client do anything the library could do. Violating this rule leads to boilerplate code in the client, which is annoying and error-prone.\n\nWhich just shows that design guidelines often conflict and the hardest part of an API designers job is to balance these conflicts.\n\n\n  [1]: http://www.ruby-doc.org/core/classes/Array.html\n  [2]: http://martinfowler.com/bliki/MinimalInterface.html\n  [3]: http://martinfowler.com/bliki/HumaneInterface.html\n  [4]: http://www.infoq.com/articles/API-Design-Joshua-Bloch","title":"Why does the Java List interface not support getLast()?","body":"<p>The <code>java.util.List</code> interface doesn't support <code>getLast()</code> because the designers went for a 'minimal interface'. With the minimal number of methods defined it makes it both easier to understand and quicker to learn.</p>\n<p>This is in contrast with a 'humane interface' (such as used in the <a href=\"http://www.ruby-doc.org/core/classes/Array.html\" rel=\"noreferrer\">Ruby array class</a>) which attempts to provide methods for doing common operations (e.g. <code>getLast()</code>). As there are many uses which such a fundamental concept as a list can be put to this tends to lead to much larger interfaces.</p>\n<p>For further information see Martin Fowler's <a href=\"http://martinfowler.com/bliki/MinimalInterface.html\" rel=\"noreferrer\">Minimal Interface</a> and <a href=\"http://martinfowler.com/bliki/HumaneInterface.html\" rel=\"noreferrer\">Humane Interface</a> descriptions.</p>\n<p>As to why LinkedList supports <code>getLast()</code> etc., to quote the javadoc:</p>\n<blockquote>\n<p>... the LinkedList class provides uniformly named methods to get, remove and insert an element at the beginning and end of the list. These operations allow linked lists to be used as a stack, queue, or double-ended queue (deque).</p>\n</blockquote>\n<p>Presumably it was felt that a general List would not be adequate for these specific use cases.</p>\n<p>As an insight into the mind of the principal designer of the Java Collections API (Joshua Bloch) he provides <a href=\"http://www.infoq.com/articles/API-Design-Joshua-Bloch\" rel=\"noreferrer\">this list of API design maxims</a> by which he works. Of which, the most pertinent to this question are:</p>\n<blockquote>\n<p>Early drafts of APIs should be short, typically one page with class and method signatures and one-line descriptions. This makes it easy to restructure the API when you don't get it right the first time.</p>\n<p>When in doubt, leave it out. If there is a fundamental theorem of API design, this is it. It applies equally to functionality, classes, methods, and parameters. Every facet of an API should be as small as possible, but no smaller. You can always add things later, but you can't take them away. Minimizing conceptual weight is more important than class- or method-count.</p>\n<p>Keep APIs free of implementations details. They confuse users and inhibit the flexibility to evolve. It isn't always obvious what's an implementation detail: Be wary of overspecification.</p>\n<p>Minimize accessibility; when in doubt, make it private. This simplifies APIs and reduces coupling.</p>\n<p>Consider the performance consequences of API design decisions, but don't warp an API to achieve performance gains. Luckily, good APIs typically lend themselves to fast implementations.</p>\n</blockquote>\n<p>However he also states:</p>\n<blockquote>\n<p>Don't make the client do anything the library could do. Violating this rule leads to boilerplate code in the client, which is annoying and error-prone.</p>\n</blockquote>\n<p>Which just shows that design guidelines often conflict and the hardest part of an API designers job is to balance these conflicts.</p>\n"},{"tags":[],"owner":{"account_id":44171,"reputation":11,"user_id":129484,"display_name":"Daire"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1246029366,"creation_date":1246029366,"answer_id":1049687,"question_id":1049518,"body_markdown":"The getLast() method is from the Deque interface that LinkedList implements.  If you wanted an array backed version of that, you could use ArrayDeque .  I guess it&#39;s not part of the List interface because they wanted to seperate out different abstract data types into seperate interfaces, even though an implementation like LinkedList can implement more than one interface.","title":"Why does the Java List interface not support getLast()?","body":"<p>The getLast() method is from the Deque interface that LinkedList implements.  If you wanted an array backed version of that, you could use ArrayDeque .  I guess it's not part of the List interface because they wanted to seperate out different abstract data types into seperate interfaces, even though an implementation like LinkedList can implement more than one interface.</p>\n"},{"tags":[],"owner":{"account_id":28947,"reputation":90759,"user_id":77779,"accept_rate":89,"display_name":"Yishai"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1246029391,"creation_date":1246029391,"answer_id":1049695,"question_id":1049518,"body_markdown":"The List interface doesn&#39;t have any convenience methods of that type. No getFirst() or getLast(). It is strictly index based. LinkedList needs a way of avoiding index based lookups if possible for performance reasons, so getLast is really an optimization, not a convenience method.\r\n\r\nI&#39;m sure the designers wanted to keep the amount of methods down, so they didn&#39;t add a lot of potentially convenient methods.","title":"Why does the Java List interface not support getLast()?","body":"<p>The List interface doesn't have any convenience methods of that type. No getFirst() or getLast(). It is strictly index based. LinkedList needs a way of avoiding index based lookups if possible for performance reasons, so getLast is really an optimization, not a convenience method.</p>\n\n<p>I'm sure the designers wanted to keep the amount of methods down, so they didn't add a lot of potentially convenient methods.</p>\n"}],"owner":{"account_id":11857,"reputation":88771,"user_id":23072,"accept_rate":74,"display_name":"Uri"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":7378,"favorite_count":0,"down_vote_count":0,"up_vote_count":19,"closed_date":1694784261,"accepted_answer_id":1049678,"answer_count":7,"score":19,"last_activity_date":1694784037,"creation_date":1246027416,"question_id":1049518,"body_markdown":"I&#39;m trying to understand the API inconsistency in the Java standard collections library.\r\n\r\nThere is no method in `List` or in `AbstractList` to get the last item, although one can simulate that with size and `getIndex()`. \r\n\r\nHowever, `LinkedList` supports that function.\r\n\r\nAny idea why it was decided not to support this method in the interface?\r\n\r\n","title":"Why does the Java List interface not support getLast()?","body":"<p>I'm trying to understand the API inconsistency in the Java standard collections library.</p>\n<p>There is no method in <code>List</code> or in <code>AbstractList</code> to get the last item, although one can simulate that with size and <code>getIndex()</code>.</p>\n<p>However, <code>LinkedList</code> supports that function.</p>\n<p>Any idea why it was decided not to support this method in the interface?</p>\n"},{"tags":["java","kubernetes"],"answers":[{"tags":[],"owner":{"account_id":7405203,"reputation":161,"user_id":5634320,"display_name":"Hiteshwar Sharma"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1589646336,"creation_date":1589641761,"answer_id":61838916,"question_id":61825748,"body_markdown":"The Resource Metrics API is not included in the official Java client library.\r\nso you have to query the API server as following:\r\n\r\n    GET /apis/metrics/v1alpha1/namespaces/{namespace}/pods/{pod}\r\n\r\nwhich will return the results of current metrics.\r\n\r\nHere are a few references with ability to add even more custom metrics:\r\n\r\n* https://blog.jetstack.io/blog/resource-and-custom-metrics-hpa-v2/\r\n* https://github.com/kubernetes/metrics\r\n\r\nHope this answers your question.","title":"Kubernetes Java API for Metrics","body":"<p>The Resource Metrics API is not included in the official Java client library.\nso you have to query the API server as following:</p>\n\n<pre><code>GET /apis/metrics/v1alpha1/namespaces/{namespace}/pods/{pod}\n</code></pre>\n\n<p>which will return the results of current metrics.</p>\n\n<p>Here are a few references with ability to add even more custom metrics:</p>\n\n<ul>\n<li><a href=\"https://blog.jetstack.io/blog/resource-and-custom-metrics-hpa-v2/\" rel=\"nofollow noreferrer\">https://blog.jetstack.io/blog/resource-and-custom-metrics-hpa-v2/</a></li>\n<li><a href=\"https://github.com/kubernetes/metrics\" rel=\"nofollow noreferrer\">https://github.com/kubernetes/metrics</a></li>\n</ul>\n\n<p>Hope this answers your question.</p>\n"},{"tags":[],"owner":{"account_id":2622195,"reputation":53,"user_id":2270000,"display_name":"blue_man"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1605887294,"creation_date":1605887294,"answer_id":64932540,"question_id":61825748,"body_markdown":"Kotlin Solution\r\n\r\n    val client = Config.defaultClient();\r\n\tConfiguration.setDefaultApiClient(client);\r\n\tMetrics(client).getPodMetrics(\r\n\t\t\t&quot;name-space&quot;\r\n\t).items.forEach {\r\n\t\tit.containers.forEach {metrics -&gt;\r\n\t\t\tprintln(metrics.usage)\r\n\t\t}\r\n\t}\r\n\r\nThis should give the metrics you are looking for.\r\n\r\nSample Output\r\n\r\n    {cpu=Quantity{number=0.011135729, format=DECIMAL_SI}, memory=Quantity{number=831680512, format=BINARY_SI}}\r\n\r\n    {cpu=Quantity{number=0.008742460, format=DECIMAL_SI}, memory=Quantity{number=781041664, format=BINARY_SI}}","title":"Kubernetes Java API for Metrics","body":"<p>Kotlin Solution</p>\n<pre><code>val client = Config.defaultClient();\nConfiguration.setDefaultApiClient(client);\nMetrics(client).getPodMetrics(\n        &quot;name-space&quot;\n).items.forEach {\n    it.containers.forEach {metrics -&gt;\n        println(metrics.usage)\n    }\n}\n</code></pre>\n<p>This should give the metrics you are looking for.</p>\n<p>Sample Output</p>\n<pre><code>{cpu=Quantity{number=0.011135729, format=DECIMAL_SI}, memory=Quantity{number=831680512, format=BINARY_SI}}\n\n{cpu=Quantity{number=0.008742460, format=DECIMAL_SI}, memory=Quantity{number=781041664, format=BINARY_SI}}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":13663465,"reputation":246,"user_id":9857909,"display_name":"Lukonjun"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1618818801,"creation_date":1618516435,"answer_id":67115224,"question_id":61825748,"body_markdown":"as blue man said, it is now possible to get this metrics  \r\nJava Solution\r\n\r\n&lt;!-- begin snippet: js hide: false console: true babel: false --&gt;\r\n\r\n&lt;!-- language: java --&gt;\r\n    PodMetricsList list = new Metrics(client).getPodMetrics(&quot;playground&quot;);\r\n    \r\n    for(PodMetrics podMetrics:list.getItems()){\r\n        for(ContainerMetrics containerMetrics:podMetrics.getContainers()){\r\n    \t\t\t\tSystem.out.println(containerMetrics.getUsage());\r\n    \t}\r\n    }\r\n\r\n&lt;!-- end snippet --&gt;\r\n\r\n","title":"Kubernetes Java API for Metrics","body":"<p>as blue man said, it is now possible to get this metrics<br />\nJava Solution</p>\n<pre class=\"lang-java prettyprint-override\"><code>PodMetricsList list = new Metrics(client).getPodMetrics(&quot;playground&quot;);\n\nfor(PodMetrics podMetrics:list.getItems()){\n    for(ContainerMetrics containerMetrics:podMetrics.getContainers()){\n                System.out.println(containerMetrics.getUsage());\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":25973720,"reputation":1,"user_id":19688458,"display_name":"Suresh Samarawarna"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694783336,"creation_date":1694783095,"answer_id":77112613,"question_id":61825748,"body_markdown":"you can test with your Kubernetes cluster by changing the following parameters.(should be installed metrics server on your cluster)\r\n\r\n`ApiClient client;` //create client as you wish\r\n\r\n    import com.google.gson.JsonElement;\r\n    import io.kubernetes.client.openapi.ApiClient;\r\n    import io.kubernetes.client.openapi.ApiException;\r\n    import io.kubernetes.client.openapi.Configuration;\r\n    import io.kubernetes.client.openapi.Pair;\r\n    import io.kubernetes.client.util.Config;\r\n    import okhttp3.Call;\r\n    import org.springframework.boot.SpringApplication;\r\n\r\n    String apiPath = &quot;    &quot;;\r\n            Object localVarPostBody = null;\r\n            List&lt;Pair&gt; localVarCollectionQueryParams = new ArrayList &lt;&gt;();\r\n            List &lt; Pair &gt; localVarQueryParams = new ArrayList &lt;&gt;();\r\n            localVarQueryParams.addAll(client.parameterToPair(&quot;pretty&quot;, &quot;true&quot;));\r\n            Map &lt;String, String&gt; localVarHeaderParams = new HashMap &lt;&gt;();\r\n            Map&lt;String, String&gt; localVarCookieParams = new HashMap &lt;&gt;();\r\n            Map&lt;String, Object&gt; localVarFormParams = new HashMap &lt;&gt;();\r\n            String[] localVarAccepts = new String[]{&quot;application/json&quot;};\r\n            String localVarAccept = client.selectHeaderAccept(localVarAccepts);\r\n            if (localVarAccept != null) {\r\n                localVarHeaderParams.put(&quot;Accept&quot;, localVarAccept);\r\n            }\r\n            String[] localVarContentTypes = new String[0];\r\n            String localVarContentType = client.selectHeaderContentType(localVarContentTypes);\r\n            localVarHeaderParams.put(&quot;Content-Type&quot;, localVarContentType);\r\n            String[] localVarAuthNames = new String[]{&quot;BearerToken&quot;};\r\n            Call call = client.buildCall(apiPath, &quot;GET&quot;, localVarQueryParams, localVarCollectionQueryParams, localVarPostBody, localVarHeaderParams, localVarCookieParams, localVarFormParams, localVarAuthNames, null);\r\n            JsonElement element = (JsonElement)client.execute(call, JsonElement.class).getData();\r\n            System.out.println(element);\r\n\r\napiPath = /apis/metrics.k8s.io/v1beta1/namespaces/{namespace}/pods/{pod} ,\r\n          /apis/metrics.k8s.io/v1beta1/pods\r\n\r\nyou can get usage of &quot;cpu&quot; and &quot;memory&quot; according to the **container vice** under the **pod name**.\r\n\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;io.kubernetes&lt;/groupId&gt;\r\n        &lt;artifactId&gt;client-java&lt;/artifactId&gt;\r\n        &lt;version&gt;11.0.2&lt;/version&gt;\r\n        &lt;scope&gt;compile&lt;/scope&gt;\r\n    &lt;/dependency&gt;\r\n\r\n\r\n","title":"Kubernetes Java API for Metrics","body":"<p>you can test with your Kubernetes cluster by changing the following parameters.(should be installed metrics server on your cluster)</p>\n<p><code>ApiClient client;</code> //create client as you wish</p>\n<pre><code>import com.google.gson.JsonElement;\nimport io.kubernetes.client.openapi.ApiClient;\nimport io.kubernetes.client.openapi.ApiException;\nimport io.kubernetes.client.openapi.Configuration;\nimport io.kubernetes.client.openapi.Pair;\nimport io.kubernetes.client.util.Config;\nimport okhttp3.Call;\nimport org.springframework.boot.SpringApplication;\n\nString apiPath = &quot;    &quot;;\n        Object localVarPostBody = null;\n        List&lt;Pair&gt; localVarCollectionQueryParams = new ArrayList &lt;&gt;();\n        List &lt; Pair &gt; localVarQueryParams = new ArrayList &lt;&gt;();\n        localVarQueryParams.addAll(client.parameterToPair(&quot;pretty&quot;, &quot;true&quot;));\n        Map &lt;String, String&gt; localVarHeaderParams = new HashMap &lt;&gt;();\n        Map&lt;String, String&gt; localVarCookieParams = new HashMap &lt;&gt;();\n        Map&lt;String, Object&gt; localVarFormParams = new HashMap &lt;&gt;();\n        String[] localVarAccepts = new String[]{&quot;application/json&quot;};\n        String localVarAccept = client.selectHeaderAccept(localVarAccepts);\n        if (localVarAccept != null) {\n            localVarHeaderParams.put(&quot;Accept&quot;, localVarAccept);\n        }\n        String[] localVarContentTypes = new String[0];\n        String localVarContentType = client.selectHeaderContentType(localVarContentTypes);\n        localVarHeaderParams.put(&quot;Content-Type&quot;, localVarContentType);\n        String[] localVarAuthNames = new String[]{&quot;BearerToken&quot;};\n        Call call = client.buildCall(apiPath, &quot;GET&quot;, localVarQueryParams, localVarCollectionQueryParams, localVarPostBody, localVarHeaderParams, localVarCookieParams, localVarFormParams, localVarAuthNames, null);\n        JsonElement element = (JsonElement)client.execute(call, JsonElement.class).getData();\n        System.out.println(element);\n</code></pre>\n<p>apiPath = /apis/metrics.k8s.io/v1beta1/namespaces/{namespace}/pods/{pod} ,\n/apis/metrics.k8s.io/v1beta1/pods</p>\n<p>you can get usage of &quot;cpu&quot; and &quot;memory&quot; according to the <strong>container vice</strong> under the <strong>pod name</strong>.</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;io.kubernetes&lt;/groupId&gt;\n    &lt;artifactId&gt;client-java&lt;/artifactId&gt;\n    &lt;version&gt;11.0.2&lt;/version&gt;\n    &lt;scope&gt;compile&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre>\n"}],"owner":{"account_id":3195546,"reputation":79,"user_id":2698795,"accept_rate":0,"display_name":"geek"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1596,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"answer_count":4,"score":3,"last_activity_date":1694783336,"creation_date":1589566251,"question_id":61825748,"body_markdown":"I am getting the pod metrics through kubectl command\r\n\r\n```\r\n➜  kubectl top pods\r\nNAME                CPU(cores)   MEMORY(bytes)\r\napi-6bd876fc8b-85dnx   72m          553Mi\r\nui-67b794cf8d-gcrg5    0m           1Mi\r\n```\r\nbut I want to try through Java client https://github.com/kubernetes-client/java/\r\n\r\nIs there any support to get the Metrics for Pods and Nodes through kubernetes-client ?","title":"Kubernetes Java API for Metrics","body":"<p>I am getting the pod metrics through kubectl command</p>\n\n<pre><code>➜  kubectl top pods\nNAME                CPU(cores)   MEMORY(bytes)\napi-6bd876fc8b-85dnx   72m          553Mi\nui-67b794cf8d-gcrg5    0m           1Mi\n</code></pre>\n\n<p>but I want to try through Java client <a href=\"https://github.com/kubernetes-client/java/\" rel=\"nofollow noreferrer\">https://github.com/kubernetes-client/java/</a></p>\n\n<p>Is there any support to get the Metrics for Pods and Nodes through kubernetes-client ?</p>\n"},{"tags":["java","ghostscript","ghost4j"],"answers":[{"tags":[],"owner":{"account_id":360158,"reputation":30342,"user_id":701996,"display_name":"KenS"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1515251944,"creation_date":1515251944,"answer_id":48128725,"question_id":48121900,"body_markdown":"Try running Ghostscript directly from the command line.\r\n\r\nError -100 is a &#39;fatal error&#39;, something went wrong, and we can&#39;t tell what. Can be out of memory, file permission problems, or invalid configuration (or trying to use a 32-bit library when a 64-bit version was expected).\r\n\r\nI can&#39;t help at all with Ghost4J, which is why I suggest trying to reproduce the problem with Ghostscript itself. If you can do that, or you can get the transcript from stderr/stdout then I may be able to help more.\r\n","title":"Cannot Initialize Ghostscript Interpreter","body":"<p>Try running Ghostscript directly from the command line.</p>\n\n<p>Error -100 is a 'fatal error', something went wrong, and we can't tell what. Can be out of memory, file permission problems, or invalid configuration (or trying to use a 32-bit library when a 64-bit version was expected).</p>\n\n<p>I can't help at all with Ghost4J, which is why I suggest trying to reproduce the problem with Ghostscript itself. If you can do that, or you can get the transcript from stderr/stdout then I may be able to help more.</p>\n"},{"tags":[],"owner":{"account_id":15068677,"reputation":29,"user_id":10874949,"display_name":"Nibra"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1589892659,"creation_date":1589892659,"answer_id":61891476,"question_id":48121900,"body_markdown":"it may be a little old but here is my solution:\r\nyou need to delete the instance at the end of conversion\r\n\r\n    Ghostscript.deleteInstance();\r\n\r\n\r\n","title":"Cannot Initialize Ghostscript Interpreter","body":"<p>it may be a little old but here is my solution:\nyou need to delete the instance at the end of conversion</p>\n\n<pre><code>Ghostscript.deleteInstance();\n</code></pre>\n"},{"tags":[],"owner":{"account_id":10217408,"reputation":524,"user_id":7542654,"display_name":"David Abragimov"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694783073,"creation_date":1694783073,"answer_id":77112609,"question_id":48121900,"body_markdown":"In my case the &quot;Cannot initialize Ghostscript interpreter. Error code is -100&quot; was because ghostscript used in multithreaded environment.  \r\nhttp://www.ghost4j.org/threadsafetyandmultithreading.html\r\n\r\nadding synchronized in addition to gs.deleteInstance(); helped to resolve the problem \r\n\r\n    try {\r\n    \t\t\tsynchronized(gs) {\r\n    \t\t\t\tgs.initialize(args.toArray(new String[args.size()]));\r\n    \t\t\t\tgs.deleteInstance();\r\n    \t\t\t\tgs.exit();\r\n    \t\t\t}\r\n    \r\n    \t\t} catch (GhostscriptException e) {\r\n    \t\t}","title":"Cannot Initialize Ghostscript Interpreter","body":"<p>In my case the &quot;Cannot initialize Ghostscript interpreter. Error code is -100&quot; was because ghostscript used in multithreaded environment.<br />\n<a href=\"http://www.ghost4j.org/threadsafetyandmultithreading.html\" rel=\"nofollow noreferrer\">http://www.ghost4j.org/threadsafetyandmultithreading.html</a></p>\n<p>adding synchronized in addition to gs.deleteInstance(); helped to resolve the problem</p>\n<pre><code>try {\n            synchronized(gs) {\n                gs.initialize(args.toArray(new String[args.size()]));\n                gs.deleteInstance();\n                gs.exit();\n            }\n\n        } catch (GhostscriptException e) {\n        }\n</code></pre>\n"}],"owner":{"account_id":11936715,"reputation":171,"user_id":8734940,"display_name":"Akshay Chopra"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1115,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":3,"score":1,"last_activity_date":1694783073,"creation_date":1515189703,"question_id":48121900,"body_markdown":"I&#39;m trying to use the Ghost4j wrapper to convert .ps files to .pdf on macOS 10.12.6 (Sierra)\r\n\r\nI have used the sample program found here: http://www.ghost4j.org/highlevelapisamples.html\r\n\r\nI have included the all the ghost4j jars and add the ghostscript libraries on the build path.\r\n\r\nBut I am getting the following error: \r\n\r\n    \r\n    org.ghost4j.converter.ConverterException: org.ghost4j.GhostscriptException: Cannot initialize Ghostscript interpreter. Error code is -100\r\n\tat org.ghost4j.converter.PDFConverter.run(PDFConverter.java:251)\r\n\tat org.ghost4j.converter.AbstractRemoteConverter.convert(AbstractRemoteConverter.java:85)\r\n\tat Convert.main(Convert.java:25)\r\n    Caused by: org.ghost4j.GhostscriptException: Cannot initialize Ghostscript interpreter. Error code is -100\r\n\tat org.ghost4j.Ghostscript.initialize(Ghostscript.java:365)\r\n\tat org.ghost4j.converter.PDFConverter.run(PDFConverter.java:231)\r\n\t... 2 more\r\n\r\n\r\nAny suggestions?\r\n\r\n\r\n","title":"Cannot Initialize Ghostscript Interpreter","body":"<p>I'm trying to use the Ghost4j wrapper to convert .ps files to .pdf on macOS 10.12.6 (Sierra)</p>\n\n<p>I have used the sample program found here: <a href=\"http://www.ghost4j.org/highlevelapisamples.html\" rel=\"nofollow noreferrer\">http://www.ghost4j.org/highlevelapisamples.html</a></p>\n\n<p>I have included the all the ghost4j jars and add the ghostscript libraries on the build path.</p>\n\n<p>But I am getting the following error: </p>\n\n<pre><code>org.ghost4j.converter.ConverterException: org.ghost4j.GhostscriptException: Cannot initialize Ghostscript interpreter. Error code is -100\nat org.ghost4j.converter.PDFConverter.run(PDFConverter.java:251)\nat org.ghost4j.converter.AbstractRemoteConverter.convert(AbstractRemoteConverter.java:85)\nat Convert.main(Convert.java:25)\nCaused by: org.ghost4j.GhostscriptException: Cannot initialize Ghostscript interpreter. Error code is -100\nat org.ghost4j.Ghostscript.initialize(Ghostscript.java:365)\nat org.ghost4j.converter.PDFConverter.run(PDFConverter.java:231)\n... 2 more\n</code></pre>\n\n<p>Any suggestions?</p>\n"},{"tags":["java","graphql","netflix","netflix-dgs"],"owner":{"account_id":28666351,"reputation":77,"user_id":21950267,"display_name":"CodeBot"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":142,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":0,"score":2,"last_activity_date":1694781982,"creation_date":1694172158,"question_id":77066464,"body_markdown":"I am using `com.netflix.graphql.dgs:graphql-dgs-client:4.9.16` along with HttpClient (JDK 17) \r\n\r\nI am creating graphql client using below.\r\n\r\n    GraphQLCLient graphQLClient = GraphQLClient.createCustom(\r\n            host-url,\r\n            requestExecutor::exec);\r\n\r\nAnd my request executor is based on HttpClient.\r\n\r\nThe `requestExecutor.exec(String url, Map&lt;String, ? extends List&lt;String&gt;&gt; headers, String body)` method can accept the headers but I am not seeing a graphql client method that can pass or accept httpheader. \r\n\r\nWhat I am currently using is -   \r\n\r\n    var request = new GraphQLQueryRequest(\r\n            OurStoreGraphQLQuery.newRequest().oneStoreId(oneStoreId).build(),\r\n            RESPONSE_PROJECTION; \r\n    \r\n    GraphQLResponse response = graphQLClient.executeQuery(request.serialize());\r\n\r\nNeither of the above i.e. `GraphQLQueryRequest` constructor or `executeQuery` method has a overloaded equivalent that accept HttpHeader and in-turn pass it to `requestExecutor::exec` method. \r\n\r\n1) What is the point of [exec method][1] accepting `headers` if it can not be passed by the user code with out creating a new instance of `RequestExecutor`.\r\n-- from where is the headers parameter picked up, how can i add more headers to the above headers param??\r\n\r\n\r\n----------\r\nProbably I can use the below style as mentioned in [java-client/#plug-in-your-own-http-client][2] docs - \r\n\r\n    CustomGraphQLClient client = GraphQLClient.createCustom(url,  (url, headers, body) -&gt; {\r\n        HttpHeaders httpHeaders = new HttpHeaders();\r\n        headers.forEach(httpHeaders::addAll);\r\n        ResponseEntity&lt;String&gt; exchange = restTemplate.exchange(url, HttpMethod.POST, new HttpEntity&lt;&gt;(body, httpHeaders),String.class);\r\n        return new HttpResponse(exchange.getStatusCodeValue(), exchange.getBody());\r\n    });\r\n    \r\n    GraphQLResponse graphQLResponse = client.executeQuery(query, emptyMap(), &quot;SubmitReview&quot;);\r\n    String submittedBy = graphQLResponse.extractValueAsObject(&quot;submitReview.submittedBy&quot;, String.class);\r\n\r\n-- but looks like i will have to create a custom client instance each time my header changes. Is that right?? \r\n-- Using the above suggested approach, it does not look like i can use the same requestExecutor i.e requestExecutor::exec in a generic approach.\r\n\r\n\r\n  [1]: https://github.com/Netflix/dgs-framework/blob/8f6eba40859138ef173690da8640a3defe6de56f/graphql-dgs-client/src/main/kotlin/com/netflix/graphql/dgs/client/RequestExecutor.kt#L29\r\n  [2]: https://netflix.github.io/dgs/advanced/java-client/#plug-in-your-own-http-client","title":"How to pass request headers when using java netflix graphql client?","body":"<p>I am using <code>com.netflix.graphql.dgs:graphql-dgs-client:4.9.16</code> along with HttpClient (JDK 17)</p>\n<p>I am creating graphql client using below.</p>\n<pre><code>GraphQLCLient graphQLClient = GraphQLClient.createCustom(\n        host-url,\n        requestExecutor::exec);\n</code></pre>\n<p>And my request executor is based on HttpClient.</p>\n<p>The <code>requestExecutor.exec(String url, Map&lt;String, ? extends List&lt;String&gt;&gt; headers, String body)</code> method can accept the headers but I am not seeing a graphql client method that can pass or accept httpheader.</p>\n<p>What I am currently using is -</p>\n<pre><code>var request = new GraphQLQueryRequest(\n        OurStoreGraphQLQuery.newRequest().oneStoreId(oneStoreId).build(),\n        RESPONSE_PROJECTION; \n\nGraphQLResponse response = graphQLClient.executeQuery(request.serialize());\n</code></pre>\n<p>Neither of the above i.e. <code>GraphQLQueryRequest</code> constructor or <code>executeQuery</code> method has a overloaded equivalent that accept HttpHeader and in-turn pass it to <code>requestExecutor::exec</code> method.</p>\n<ol>\n<li>What is the point of <a href=\"https://github.com/Netflix/dgs-framework/blob/8f6eba40859138ef173690da8640a3defe6de56f/graphql-dgs-client/src/main/kotlin/com/netflix/graphql/dgs/client/RequestExecutor.kt#L29\" rel=\"nofollow noreferrer\">exec method</a> accepting <code>headers</code> if it can not be passed by the user code with out creating a new instance of <code>RequestExecutor</code>.\n-- from where is the headers parameter picked up, how can i add more headers to the above headers param??</li>\n</ol>\n<hr />\n<p>Probably I can use the below style as mentioned in <a href=\"https://netflix.github.io/dgs/advanced/java-client/#plug-in-your-own-http-client\" rel=\"nofollow noreferrer\">java-client/#plug-in-your-own-http-client</a> docs -</p>\n<pre><code>CustomGraphQLClient client = GraphQLClient.createCustom(url,  (url, headers, body) -&gt; {\n    HttpHeaders httpHeaders = new HttpHeaders();\n    headers.forEach(httpHeaders::addAll);\n    ResponseEntity&lt;String&gt; exchange = restTemplate.exchange(url, HttpMethod.POST, new HttpEntity&lt;&gt;(body, httpHeaders),String.class);\n    return new HttpResponse(exchange.getStatusCodeValue(), exchange.getBody());\n});\n\nGraphQLResponse graphQLResponse = client.executeQuery(query, emptyMap(), &quot;SubmitReview&quot;);\nString submittedBy = graphQLResponse.extractValueAsObject(&quot;submitReview.submittedBy&quot;, String.class);\n</code></pre>\n<p>-- but looks like i will have to create a custom client instance each time my header changes. Is that right??\n-- Using the above suggested approach, it does not look like i can use the same requestExecutor i.e requestExecutor::exec in a generic approach.</p>\n"},{"tags":["java","apdu","emv"],"comments":[{"owner":{"account_id":220963,"reputation":8330,"user_id":478681,"accept_rate":53,"display_name":"user478681"},"score":0,"creation_date":1694869793,"post_id":77112421,"comment_id":135949713,"body_markdown":"are you sure that the SELECT command has correct Len specifier? 00A4040005A0000000031010 - here you define 00 A4 04 00 - SELECT command, 05 - the length of the payload, but the payload consist of 7 bytes (A0 00 00 00 03 10 10)","body":"are you sure that the SELECT command has correct Len specifier? 00A4040005A0000000031010 - here you define 00 A4 04 00 - SELECT command, 05 - the length of the payload, but the payload consist of 7 bytes (A0 00 00 00 03 10 10)"},{"owner":{"account_id":11125108,"reputation":5965,"user_id":8166854,"display_name":"Michael Fehr"},"score":0,"creation_date":1695054859,"post_id":77112421,"comment_id":135969855,"body_markdown":"According to `https://www.eftlab.com/knowledge-base/complete-list-of-application-identifiers-aid` the dedicated file name provided by the card (&quot;\tA000000003000000&quot;) is NOT pointing to a regular payment card/application but to a **Global Payment* one (see: *(VISA) Card Manager: Used by most GP2.1.1 cards / Oberthur OP201 cards. Visa Proprietary Card Manager AID for OpenPlatform cards (visa.openplatform).*). Probably you need additional documents provided from Visa to process the card.","body":"According to <code>https:&#47;&#47;www.eftlab.com&#47;knowledge-base&#47;complete-list-of-appli&zwnj;&#8203;cation-identifiers-a&zwnj;&#8203;id</code> the dedicated file name provided by the card (&quot;\tA000000003000000&quot;) is NOT pointing to a regular payment card/application but to a <i>*Global Payment</i> one (see: <i>(VISA) Card Manager: Used by most GP2.1.1 cards / Oberthur OP201 cards. Visa Proprietary Card Manager AID for OpenPlatform cards (visa.openplatform).</i>). Probably you need additional documents provided from Visa to process the card."},{"owner":{"account_id":123769,"reputation":9348,"user_id":1348522,"accept_rate":57,"display_name":"Zumry Mohamed"},"score":0,"creation_date":1695096982,"post_id":77112421,"comment_id":135974875,"body_markdown":"@user478681 when i tried with length 07, i receive only SW1 and SW2 as 9000. no response data but when i mention the 05, i receive the above response. Do oyu think this might be a manufactorer error?","body":"@user478681 when i tried with length 07, i receive only SW1 and SW2 as 9000. no response data but when i mention the 05, i receive the above response. Do oyu think this might be a manufactorer error?"},{"owner":{"account_id":123769,"reputation":9348,"user_id":1348522,"accept_rate":57,"display_name":"Zumry Mohamed"},"score":0,"creation_date":1695097084,"post_id":77112421,"comment_id":135974886,"body_markdown":"@MichaelFehr i will try to find addtitional doc. Sometime i feel like device got manufacturer error. I don&#39;t receive values properly for the commands sometime.","body":"@MichaelFehr i will try to find addtitional doc. Sometime i feel like device got manufacturer error. I don&#39;t receive values properly for the commands sometime."},{"owner":{"account_id":220963,"reputation":8330,"user_id":478681,"accept_rate":53,"display_name":"user478681"},"score":0,"creation_date":1695127103,"post_id":77112421,"comment_id":135980016,"body_markdown":"@ZumryMohamed, sorry, have no idea. Even the response to request 3 looks not correct to me (at least it is not a TLV coded data). Either you have manufactorer error or some issue with logging. Try to read the card using some external tool","body":"@ZumryMohamed, sorry, have no idea. Even the response to request 3 looks not correct to me (at least it is not a TLV coded data). Either you have manufactorer error or some issue with logging. Try to read the card using some external tool"},{"owner":{"account_id":13158077,"reputation":1197,"user_id":9504571,"display_name":"Michal Gluchowski"},"score":0,"creation_date":1695222946,"post_id":77112421,"comment_id":135996362,"body_markdown":"Honestly, it seems that you are not using a certified kernel. The commands you are showing would not have been sent by it. You have not select the application properly, but a card manager instead. I don&#39;t know what you are doing, but it is not a payment application as this way you won&#39;t get through L3 certifications without using certified L2 kernels.","body":"Honestly, it seems that you are not using a certified kernel. The commands you are showing would not have been sent by it. You have not select the application properly, but a card manager instead. I don&#39;t know what you are doing, but it is not a payment application as this way you won&#39;t get through L3 certifications without using certified L2 kernels."}],"owner":{"account_id":123769,"reputation":9348,"user_id":1348522,"accept_rate":57,"display_name":"Zumry Mohamed"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":86,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694781301,"creation_date":1694781301,"question_id":77112421,"body_markdown":"I have been working on a Pos terminal app for Pax A930 device. I was able to AID, card type and etc but when i tried the GPO command, it throws 6985 error. I am not sure issues is from my end or whether the SDK got any issue. \r\n\r\nRequest 1 : \r\n\r\n    00A404000E315041592E5359532E444446303100\r\n\r\nResponse :\r\n\r\n    6F1E840E315041592E5359532E4444463031A50C8801015F2D02656E9F1101019000\r\n\r\n&gt; ------\r\n\r\nRequest 2 : \r\n\r\n    00B2010C00\r\n\r\nResponse: \r\n\r\n    7021611F4F07A00000000310105004564953419F120A564953412044454249548701019000\r\n\r\n&gt; ------\r\n\r\nRequest 3: \r\n\r\n    00A4040005A0000000031010\r\n\r\nResponse\r\n\r\n    6F3D8408A000000003000000A5319F6E9000\r\n\r\n\r\nEverything works perfectly upto here but when i try to execute the GPO\r\n\r\n    80A800000283000000\r\n\r\nI get 6985\r\n\r\n\r\nAs per my knowledge i didnt get PDOL response from the 3rd call, so i am using the commonly used command for the GPO.  \r\n\r\ncan someone guide me on this?\r\n\r\n","title":"Trying to get GPO command for EMV Card failed","body":"<p>I have been working on a Pos terminal app for Pax A930 device. I was able to AID, card type and etc but when i tried the GPO command, it throws 6985 error. I am not sure issues is from my end or whether the SDK got any issue.</p>\n<p>Request 1 :</p>\n<pre><code>00A404000E315041592E5359532E444446303100\n</code></pre>\n<p>Response :</p>\n<pre><code>6F1E840E315041592E5359532E4444463031A50C8801015F2D02656E9F1101019000\n</code></pre>\n<blockquote>\n<hr />\n</blockquote>\n<p>Request 2 :</p>\n<pre><code>00B2010C00\n</code></pre>\n<p>Response:</p>\n<pre><code>7021611F4F07A00000000310105004564953419F120A564953412044454249548701019000\n</code></pre>\n<blockquote>\n<hr />\n</blockquote>\n<p>Request 3:</p>\n<pre><code>00A4040005A0000000031010\n</code></pre>\n<p>Response</p>\n<pre><code>6F3D8408A000000003000000A5319F6E9000\n</code></pre>\n<p>Everything works perfectly upto here but when i try to execute the GPO</p>\n<pre><code>80A800000283000000\n</code></pre>\n<p>I get 6985</p>\n<p>As per my knowledge i didnt get PDOL response from the 3rd call, so i am using the commonly used command for the GPO.</p>\n<p>can someone guide me on this?</p>\n"},{"tags":["java","logback","spring-logback"],"answers":[{"tags":[],"owner":{"account_id":13209447,"reputation":13,"user_id":9540164,"display_name":"forestfart"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1588761794,"creation_date":1588752312,"answer_id":61630247,"question_id":59664650,"body_markdown":"You can change application user file creation mask by `umask 023` in linux (best to do it on startup).\r\n\r\nIf you want to have more control over it inside application you can upgrade your logging to Log4j2 which is more powerful and starting from version `2.9` you can set it in `log4j2.xml`, i.e. `&lt;RollingFile ... filePermissions=&quot;rwxr-xr--&quot;&gt;`.","title":"Give 754 linux file permission to java application log files generated through Spring Logback","body":"<p>You can change application user file creation mask by <code>umask 023</code> in linux (best to do it on startup).</p>\n\n<p>If you want to have more control over it inside application you can upgrade your logging to Log4j2 which is more powerful and starting from version <code>2.9</code> you can set it in <code>log4j2.xml</code>, i.e. <code>&lt;RollingFile ... filePermissions=\"rwxr-xr--\"&gt;</code>.</p>\n"},{"tags":[],"owner":{"account_id":3111257,"reputation":97,"user_id":2632932,"display_name":"Varun"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694781048,"creation_date":1694781048,"answer_id":77112386,"question_id":59664650,"body_markdown":"    Add this to your pom file:\r\n    \r\n    &lt;plugin&gt;\r\n                    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n                    &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n                    &lt;configuration&gt;\r\n            \t\t\t&lt;jvmArguments&gt;\r\n    \t\t\t\t\t\t-DUMASK=&quot;0022&quot;\r\n                \t\t\t-Dorg.apache.catalina.security.SecurityListener.UMASK=&quot;0022&quot;\r\n            \t\t\t&lt;/jvmArguments&gt;\r\n        \t\t\t&lt;/configuration&gt;\r\n                &lt;/plugin&gt;","title":"Give 754 linux file permission to java application log files generated through Spring Logback","body":"<pre><code>Add this to your pom file:\n\n&lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n                &lt;configuration&gt;\n                    &lt;jvmArguments&gt;\n                        -DUMASK=&quot;0022&quot;\n                        -Dorg.apache.catalina.security.SecurityListener.UMASK=&quot;0022&quot;\n                    &lt;/jvmArguments&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n</code></pre>\n"}],"owner":{"account_id":12500257,"reputation":47,"user_id":9098955,"display_name":"Ishan Gandhi"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":2901,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1694781048,"creation_date":1578575134,"question_id":59664650,"body_markdown":"In my Java Spring-based application, using Logback to generate application logs, I need to give specific `754` linux file permission to log files generated by this application.\r\n\r\nHow can specific file permissions of log files be set in `logback-spring.xml` file?\r\n","title":"Give 754 linux file permission to java application log files generated through Spring Logback","body":"<p>In my Java Spring-based application, using Logback to generate application logs, I need to give specific <code>754</code> linux file permission to log files generated by this application.</p>\n\n<p>How can specific file permissions of log files be set in <code>logback-spring.xml</code> file?</p>\n"},{"tags":["java","mongodb"],"comments":[{"owner":{"account_id":8819821,"reputation":1674,"user_id":7492795,"display_name":"TheKingElessar"},"score":0,"creation_date":1686253703,"post_id":39433775,"comment_id":134777565,"body_markdown":"For anybody getting this exception when querying Mongo, ensure you&#39;re querying with the correct datatype (e.g. String), not a POJO.","body":"For anybody getting this exception when querying Mongo, ensure you&#39;re querying with the correct datatype (e.g. String), not a POJO."}],"answers":[{"tags":[],"owner":{"account_id":6497236,"reputation":381,"user_id":5029447,"display_name":"Dallas Phillips"},"down_vote_count":1,"up_vote_count":25,"is_accepted":false,"score":24,"last_activity_date":1473877937,"creation_date":1473877937,"answer_id":39497344,"question_id":39433775,"body_markdown":"From the looks of what you are trying to do, you are trying to add some custom data type (in this case your POJO) but what you need to keep in mind is that fields in documents can only accept certain data types, not objects directly.\r\n\r\nIn case if you didn&#39;t know also, Mongo Documents are structured the same way as json. So you have to explicitaly create the documents by creating the fields and inserting the values into them. There are specific data types that are allowed in value fields: \r\n\r\nhttp://mongodb.github.io/mongo-java-driver/3.0/bson/documents/\r\n\r\nTo help with your case, the code below takes your POJO as a parameter and knowing the structure of the POJO, returns a Mongo Document that can be inserted into your collection:\r\n\r\n    private Document pojoToDoc(Pojo pojo){\r\n        Document doc = new Document();\r\n\r\n        doc.put(&quot;Name&quot;,pojo.getName());\r\n        doc.put(&quot;Surname&quot;,pojo.getSurname());\r\n        doc.put(&quot;id&quot;,pojo.getId());\r\n \r\n        return doc;\r\n    } \r\n\r\nThis should work for insertion. If you want to index one of the fields:\r\n\r\n    database.getCollection(&quot;Records&quot;).createIndex(new Document(&quot;id&quot;, 1));\r\n\r\nI hope this answers your question and works for you.","title":"MongoDB Java Inserting Throws org.bson.codecs.configuration.CodecConfigurationException: Can&#39;t find a codec for class io.github.ilkgunel.mongodb.Pojo","body":"<p>From the looks of what you are trying to do, you are trying to add some custom data type (in this case your POJO) but what you need to keep in mind is that fields in documents can only accept certain data types, not objects directly.</p>\n\n<p>In case if you didn't know also, Mongo Documents are structured the same way as json. So you have to explicitaly create the documents by creating the fields and inserting the values into them. There are specific data types that are allowed in value fields: </p>\n\n<p><a href=\"http://mongodb.github.io/mongo-java-driver/3.0/bson/documents/\" rel=\"noreferrer\">http://mongodb.github.io/mongo-java-driver/3.0/bson/documents/</a></p>\n\n<p>To help with your case, the code below takes your POJO as a parameter and knowing the structure of the POJO, returns a Mongo Document that can be inserted into your collection:</p>\n\n<pre><code>private Document pojoToDoc(Pojo pojo){\n    Document doc = new Document();\n\n    doc.put(\"Name\",pojo.getName());\n    doc.put(\"Surname\",pojo.getSurname());\n    doc.put(\"id\",pojo.getId());\n\n    return doc;\n} \n</code></pre>\n\n<p>This should work for insertion. If you want to index one of the fields:</p>\n\n<pre><code>database.getCollection(\"Records\").createIndex(new Document(\"id\", 1));\n</code></pre>\n\n<p>I hope this answers your question and works for you.</p>\n"},{"tags":[],"owner":{"account_id":10016352,"reputation":15,"user_id":7407492,"display_name":"hankchan101"},"down_vote_count":3,"up_vote_count":0,"is_accepted":false,"score":-3,"last_activity_date":1498549353,"creation_date":1498549353,"answer_id":44774764,"question_id":39433775,"body_markdown":"did you check the library of mongodb. I solve this problem in this morning by change the mongodb java driver from 3.2.2 to 3.4.2.\r\nthe new maven like that:\r\n\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n        &lt;artifactId&gt;spring-boot-starter-data-mongodb&lt;/artifactId&gt;\r\n        &lt;version&gt;1.5.4.RELEASE&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n\r\nhave a try and response","title":"MongoDB Java Inserting Throws org.bson.codecs.configuration.CodecConfigurationException: Can&#39;t find a codec for class io.github.ilkgunel.mongodb.Pojo","body":"<p>did you check the library of mongodb. I solve this problem in this morning by change the mongodb java driver from 3.2.2 to 3.4.2.\nthe new maven like that:</p>\n\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-data-mongodb&lt;/artifactId&gt;\n    &lt;version&gt;1.5.4.RELEASE&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n\n<p>have a try and response</p>\n"},{"tags":[],"owner":{"account_id":3079097,"reputation":492,"user_id":2607753,"display_name":"Renato Oliveira"},"down_vote_count":1,"up_vote_count":12,"is_accepted":false,"score":11,"last_activity_date":1527699183,"creation_date":1527699183,"answer_id":50609892,"question_id":39433775,"body_markdown":"You need to configure the CodeRegistry to use the PojoCodecProvider as explained here:\r\nhttp://mongodb.github.io/mongo-java-driver/3.7/driver/getting-started/quick-start-pojo/","title":"MongoDB Java Inserting Throws org.bson.codecs.configuration.CodecConfigurationException: Can&#39;t find a codec for class io.github.ilkgunel.mongodb.Pojo","body":"<p>You need to configure the CodeRegistry to use the PojoCodecProvider as explained here:\n<a href=\"http://mongodb.github.io/mongo-java-driver/3.7/driver/getting-started/quick-start-pojo/\" rel=\"noreferrer\">http://mongodb.github.io/mongo-java-driver/3.7/driver/getting-started/quick-start-pojo/</a></p>\n"},{"tags":[],"owner":{"account_id":6834571,"reputation":1130,"user_id":5257091,"display_name":"Hasnaa Ibraheem"},"down_vote_count":1,"up_vote_count":10,"is_accepted":false,"score":9,"last_activity_date":1551364726,"creation_date":1551363643,"answer_id":54927809,"question_id":39433775,"body_markdown":"To be bit abstract, as this may save the day for other developers..&lt;br&gt;\r\nThis error: _CodecConfigurationException: Can&#39;t find a codec for class xxx_ means that your mongo driver is not able to handle the data you sent in the object you made of that xxx class and accordingly can&#39;t generate the mongo query you want.&lt;br&gt;&lt;br&gt;\r\nThe resolution in that case would be either to use the right class i.e to use one of the expected classes by the driver (in my case replacing java array by ArrayList object resolved the issue).. The other resolution could be to upgrade your driver. Third solution could be as mentioned by @Renato, to define your own decoding logic.. This depends on your exact case.&lt;br&gt;\r\nhth","title":"MongoDB Java Inserting Throws org.bson.codecs.configuration.CodecConfigurationException: Can&#39;t find a codec for class io.github.ilkgunel.mongodb.Pojo","body":"<p>To be bit abstract, as this may save the day for other developers..<br>\nThis error: <em>CodecConfigurationException: Can't find a codec for class xxx</em> means that your mongo driver is not able to handle the data you sent in the object you made of that xxx class and accordingly can't generate the mongo query you want.<br><br>\nThe resolution in that case would be either to use the right class i.e to use one of the expected classes by the driver (in my case replacing java array by ArrayList object resolved the issue).. The other resolution could be to upgrade your driver. Third solution could be as mentioned by @Renato, to define your own decoding logic.. This depends on your exact case.<br>\nhth</p>\n"},{"tags":[],"owner":{"account_id":42068,"reputation":20631,"user_id":122441,"accept_rate":70,"display_name":"Hendy Irawan"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1579989538,"creation_date":1579989538,"answer_id":59913773,"question_id":39433775,"body_markdown":"I&#39;m using [MongoDB POJO support][1]. In my case, I had this &quot;clue&quot; WARNing before the exception:\r\n\r\n```\r\n org.bson.codecs.pojo                     : Cannot use &#39;UserBeta&#39; with the PojoCodec.\r\n\r\norg.bson.codecs.configuration.CodecConfigurationException: Property &#39;premium&#39; in UserBeta, has differing data types: TypeData{type=PremiumStatus} and TypeData{type=Boolean}.\r\n```\r\n\r\nMy class `UserBeta` had `getPremium()`, `setPremium()`, and `isPremium()`. I already `@BsonIgnore`-d the `isPremium()` but for some reason it&#39;s still detected and causing conflict.\r\n\r\nMy workaround is to rename `isPremium()` to `isAnyPremium()`.\r\n\r\n\r\n  [1]: https://mongodb.github.io/mongo-java-driver/3.12/bson/pojos/","title":"MongoDB Java Inserting Throws org.bson.codecs.configuration.CodecConfigurationException: Can&#39;t find a codec for class io.github.ilkgunel.mongodb.Pojo","body":"<p>I'm using <a href=\"https://mongodb.github.io/mongo-java-driver/3.12/bson/pojos/\" rel=\"nofollow noreferrer\">MongoDB POJO support</a>. In my case, I had this \"clue\" WARNing before the exception:</p>\n\n<pre><code> org.bson.codecs.pojo                     : Cannot use 'UserBeta' with the PojoCodec.\n\norg.bson.codecs.configuration.CodecConfigurationException: Property 'premium' in UserBeta, has differing data types: TypeData{type=PremiumStatus} and TypeData{type=Boolean}.\n</code></pre>\n\n<p>My class <code>UserBeta</code> had <code>getPremium()</code>, <code>setPremium()</code>, and <code>isPremium()</code>. I already <code>@BsonIgnore</code>-d the <code>isPremium()</code> but for some reason it's still detected and causing conflict.</p>\n\n<p>My workaround is to rename <code>isPremium()</code> to <code>isAnyPremium()</code>.</p>\n"},{"tags":[],"owner":{"account_id":11561916,"reputation":11,"user_id":8471381,"display_name":"Rami DH"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1582791736,"creation_date":1582791736,"answer_id":60428965,"question_id":39433775,"body_markdown":"I resolve it by adding the spring-boot-starter-data-mongodb dependency in your pom.xml or your build.gradle.\r\n\r\n`compile group: &#39;org.springframework.boot&#39;, name: &#39;spring-boot-starter-data-mongodb&#39;, version: &#39;2.2.4.RELEASE&#39;`","title":"MongoDB Java Inserting Throws org.bson.codecs.configuration.CodecConfigurationException: Can&#39;t find a codec for class io.github.ilkgunel.mongodb.Pojo","body":"<p>I resolve it by adding the spring-boot-starter-data-mongodb dependency in your pom.xml or your build.gradle.</p>\n\n<p><code>compile group: 'org.springframework.boot', name: 'spring-boot-starter-data-mongodb', version: '2.2.4.RELEASE'</code></p>\n"},{"tags":[],"owner":{"account_id":9094789,"reputation":3313,"user_id":6769119,"display_name":"Mukundhan"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1588521096,"creation_date":1588151660,"answer_id":61498214,"question_id":39433775,"body_markdown":"Documentation:\r\n[MongoDB Driver Quick Start - POJOs][1]\r\n\r\n\r\nAfter following the above document, if you are still getting error, then\r\n\r\nyou could be using a **generic document** inside your **collection**  like\r\n\r\n    class DocStore {\r\n      String docId:\r\n      String docType;\r\n      Object document; // this will cause the BSON cast to throw a codec error\r\n      Map&lt;String, Object&gt; document; // this won&#39;t\r\n    }\r\n\r\nAnd still, you would want to cast your document \r\nfrom **POJO** to **Map**\r\n\r\n[mkyong][2] tutorial could help.\r\n\r\nAs for the fetch, it works as expected but you might want to cast from Map to your POJO as a post-processing step, we can find some good answers [here][3]\r\n\r\nHope it helps! &#128578;️\r\n\r\n  [1]: http://mongodb.github.io/mongo-java-driver/3.7/driver/getting-started/quick-start-pojo/\r\n  [2]: https://mkyong.com/java/java-convert-object-to-map-example/\r\n  [3]: https://stackoverflow.com/questions/16428817/convert-a-mapstring-string-to-a-pojo","title":"MongoDB Java Inserting Throws org.bson.codecs.configuration.CodecConfigurationException: Can&#39;t find a codec for class io.github.ilkgunel.mongodb.Pojo","body":"<p>Documentation:\n<a href=\"http://mongodb.github.io/mongo-java-driver/3.7/driver/getting-started/quick-start-pojo/\" rel=\"nofollow noreferrer\">MongoDB Driver Quick Start - POJOs</a></p>\n\n<p>After following the above document, if you are still getting error, then</p>\n\n<p>you could be using a <strong>generic document</strong> inside your <strong>collection</strong>  like</p>\n\n<pre><code>class DocStore {\n  String docId:\n  String docType;\n  Object document; // this will cause the BSON cast to throw a codec error\n  Map&lt;String, Object&gt; document; // this won't\n}\n</code></pre>\n\n<p>And still, you would want to cast your document \nfrom <strong>POJO</strong> to <strong>Map</strong></p>\n\n<p><a href=\"https://mkyong.com/java/java-convert-object-to-map-example/\" rel=\"nofollow noreferrer\">mkyong</a> tutorial could help.</p>\n\n<p>As for the fetch, it works as expected but you might want to cast from Map to your POJO as a post-processing step, we can find some good answers <a href=\"https://stackoverflow.com/questions/16428817/convert-a-mapstring-string-to-a-pojo\">here</a></p>\n\n<p>Hope it helps! 🙂️</p>\n"},{"tags":[],"owner":{"account_id":9461048,"reputation":69,"user_id":7034744,"display_name":"Lakshmi Narayanan"},"down_vote_count":1,"up_vote_count":5,"is_accepted":false,"score":4,"last_activity_date":1590657839,"creation_date":1590651709,"answer_id":62059453,"question_id":39433775,"body_markdown":"Use below set of lines while making connection to mongo db for resolving the issue with codec, while using POJO class in mongo.\r\n\r\nReference : https://developer.mongodb.com/quickstart/java-mapping-pojos\r\n\r\n```java\r\nConnectionString connectionString = new ConnectionString(&quot;mongodb://&quot; + username + &quot;:&quot; + password + &quot;@&quot; + host + &quot;:&quot; + port);\r\nCodecRegistry pojoCodecRegistry = fromProviders(PojoCodecProvider.builder().automatic(true).build());\r\nCodecRegistry codecRegistry = fromRegistries(MongoClientSettings.getDefaultCodecRegistry(), pojoCodecRegistry);\r\n\r\nMongoClientSettings clientSettings = MongoClientSettings.builder()\r\n                .applyConnectionString(connectionString)\r\n                .codecRegistry(codecRegistry)\r\n                .build();\r\nMongoClient mongoClient = MongoClients.create(clientSettings);\r\nMongoDatabase mongoDatabase = mongoClient.getDatabase(database);\r\n```\r\n","title":"MongoDB Java Inserting Throws org.bson.codecs.configuration.CodecConfigurationException: Can&#39;t find a codec for class io.github.ilkgunel.mongodb.Pojo","body":"<p>Use below set of lines while making connection to mongo db for resolving the issue with codec, while using POJO class in mongo.</p>\n\n<p>Reference : <a href=\"https://developer.mongodb.com/quickstart/java-mapping-pojos\" rel=\"nofollow noreferrer\">https://developer.mongodb.com/quickstart/java-mapping-pojos</a></p>\n\n<pre class=\"lang-java prettyprint-override\"><code>ConnectionString connectionString = new ConnectionString(\"mongodb://\" + username + \":\" + password + \"@\" + host + \":\" + port);\nCodecRegistry pojoCodecRegistry = fromProviders(PojoCodecProvider.builder().automatic(true).build());\nCodecRegistry codecRegistry = fromRegistries(MongoClientSettings.getDefaultCodecRegistry(), pojoCodecRegistry);\n\nMongoClientSettings clientSettings = MongoClientSettings.builder()\n                .applyConnectionString(connectionString)\n                .codecRegistry(codecRegistry)\n                .build();\nMongoClient mongoClient = MongoClients.create(clientSettings);\nMongoDatabase mongoDatabase = mongoClient.getDatabase(database);\n</code></pre>\n"},{"tags":[],"owner":{"account_id":7557673,"reputation":928,"user_id":5736627,"display_name":"Elias Meireles"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1624179460,"creation_date":1624178939,"answer_id":68054176,"question_id":39433775,"body_markdown":"I had this problem with the spring boot. The code below solved the problem.\r\n\r\nCreating beam.\r\n    \r\n\r\n    @Configuration\r\n    @RequiredArgsConstructor\r\n    public class MongoConfig {\r\n    \r\n    \tprivate final MongodbProperties properties;\r\n    \r\n    \t@Bean\r\n    \tpublic MongoClientSettings mongoClient() {\r\n    \t\treturn MongoClientSettings.builder()\r\n    \t\t\t\t.applyToClusterSettings(builder -&gt; builder.hosts(getServerAddress()))\r\n    \t\t\t\t.credential(getClientCredentials())\r\n    \t\t\t\t.codecRegistry(getCodecRegistry())\r\n    \t\t\t\t.build();\r\n    \t}\r\n    \r\n    \tprivate CodecRegistry getCodecRegistry() {\r\n    \t\treturn fromRegistries(MongoClientSettings.getDefaultCodecRegistry(),\r\n    \t\t\t\tfromProviders(PojoCodecProvider.builder().automatic(true).build()));\r\n    \t}\r\n    \r\n    \tprivate List&lt;ServerAddress&gt; getServerAddress() {\r\n    \t\treturn Collections.singletonList(new ServerAddress(properties.getHost(), properties.getPort()));\r\n    \t}\r\n    \r\n    \tprivate MongoCredential getClientCredentials() {\r\n    \t\treturn MongoCredential\r\n    \t\t\t\t.createCredential(properties.getUsername(), properties.getAuthenticationDatabase(),\r\n    \t\t\t\t\t\tproperties.getPassword().toCharArray());\r\n    \t}\r\n    }\r\n\r\nGetting properties from application.yml file.\r\n    \r\n    @Getter\r\n    @Setter\r\n    @Configuration\r\n    public class MongodbProperties {\r\n    \r\n    \t@Value(&quot;${spring.data.mongodb.host}&quot;)\r\n    \tprivate String host;\r\n    \r\n    \t@Value(&quot;${spring.data.mongodb.database}&quot;)\r\n    \tprivate String database;\r\n    \r\n    \t@Value(&quot;${spring.data.mongodb.authentication-database}&quot;)\r\n    \tprivate String authenticationDatabase;\r\n    \r\n    \t@Value(&quot;${spring.data.mongodb.port}&quot;)\r\n    \tprivate int port;\r\n    \r\n    \t@Value(&quot;${spring.data.mongodb.username}&quot;)\r\n    \tprivate String username;\r\n    \r\n    \t@Value(&quot;${spring.data.mongodb.password}&quot;)\r\n    \tprivate String password;\r\n    }\r\n\r\n","title":"MongoDB Java Inserting Throws org.bson.codecs.configuration.CodecConfigurationException: Can&#39;t find a codec for class io.github.ilkgunel.mongodb.Pojo","body":"<p>I had this problem with the spring boot. The code below solved the problem.</p>\n<p>Creating beam.</p>\n<pre><code>@Configuration\n@RequiredArgsConstructor\npublic class MongoConfig {\n\n    private final MongodbProperties properties;\n\n    @Bean\n    public MongoClientSettings mongoClient() {\n        return MongoClientSettings.builder()\n                .applyToClusterSettings(builder -&gt; builder.hosts(getServerAddress()))\n                .credential(getClientCredentials())\n                .codecRegistry(getCodecRegistry())\n                .build();\n    }\n\n    private CodecRegistry getCodecRegistry() {\n        return fromRegistries(MongoClientSettings.getDefaultCodecRegistry(),\n                fromProviders(PojoCodecProvider.builder().automatic(true).build()));\n    }\n\n    private List&lt;ServerAddress&gt; getServerAddress() {\n        return Collections.singletonList(new ServerAddress(properties.getHost(), properties.getPort()));\n    }\n\n    private MongoCredential getClientCredentials() {\n        return MongoCredential\n                .createCredential(properties.getUsername(), properties.getAuthenticationDatabase(),\n                        properties.getPassword().toCharArray());\n    }\n}\n</code></pre>\n<p>Getting properties from application.yml file.</p>\n<pre><code>@Getter\n@Setter\n@Configuration\npublic class MongodbProperties {\n\n    @Value(&quot;${spring.data.mongodb.host}&quot;)\n    private String host;\n\n    @Value(&quot;${spring.data.mongodb.database}&quot;)\n    private String database;\n\n    @Value(&quot;${spring.data.mongodb.authentication-database}&quot;)\n    private String authenticationDatabase;\n\n    @Value(&quot;${spring.data.mongodb.port}&quot;)\n    private int port;\n\n    @Value(&quot;${spring.data.mongodb.username}&quot;)\n    private String username;\n\n    @Value(&quot;${spring.data.mongodb.password}&quot;)\n    private String password;\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":9934165,"reputation":63,"user_id":7353036,"display_name":"Vignesh Baskaran"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1657780377,"creation_date":1657780377,"answer_id":72976150,"question_id":39433775,"body_markdown":"MongoDB driver couldn&#39;t understand your POJO, So it is asking for a way to convert it to the BSON document. So, Instead of defining codecs for each object, it is better to convert POJO into the document and use it further.\r\n\r\nJust convert it using object mapper/ GSON and parse it using `org.bson.Document` class.\r\n\r\n    ObjectMapper objectMapper = new ObjectMapper(); //Advisable to create and consume as bean\r\n    Document pojoDocument = Document.parse(objectMapper.writeValueAsString(pojo));\r\n\r\nThen you can fed the pojoDocument into the mongo client methods.\r\n\r\n    Document document = new Document();\r\n    document.put(&quot;person&quot;, pojoDocument);\r\n\r\n    database.getCollection(&quot;Records&quot;).insertOne(document); ","title":"MongoDB Java Inserting Throws org.bson.codecs.configuration.CodecConfigurationException: Can&#39;t find a codec for class io.github.ilkgunel.mongodb.Pojo","body":"<p>MongoDB driver couldn't understand your POJO, So it is asking for a way to convert it to the BSON document. So, Instead of defining codecs for each object, it is better to convert POJO into the document and use it further.</p>\n<p>Just convert it using object mapper/ GSON and parse it using <code>org.bson.Document</code> class.</p>\n<pre><code>ObjectMapper objectMapper = new ObjectMapper(); //Advisable to create and consume as bean\nDocument pojoDocument = Document.parse(objectMapper.writeValueAsString(pojo));\n</code></pre>\n<p>Then you can fed the pojoDocument into the mongo client methods.</p>\n<pre><code>Document document = new Document();\ndocument.put(&quot;person&quot;, pojoDocument);\n\ndatabase.getCollection(&quot;Records&quot;).insertOne(document); \n</code></pre>\n"}],"owner":{"account_id":9171073,"reputation":732,"user_id":6818560,"accept_rate":12,"display_name":"İlkay Gunel"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":77950,"favorite_count":0,"down_vote_count":0,"up_vote_count":30,"answer_count":10,"score":30,"last_activity_date":1694780801,"creation_date":1473578424,"question_id":39433775,"body_markdown":"I&#39;m learning MongoDB with Java. I&#39;m trying to insert data to MongoDB with Java driver. I&#39;m doing inserting like in MongoDB tutorial and every thing is okey. But if I want to insert a variable and when I run the code, driver throws an error like this:\r\n\r\n    org.bson.codecs.configuration.CodecConfigurationException: Can&#39;t find a codec for class io.github.ilkgunel.mongodb.Pojo.\r\n\r\nI searhed questions in Stack Overflow like this but I couldn&#39;t understand anything and I cant&#39;t find anything to solve this error. My code is below. How can solve this problem?\r\n\r\nI&#39;m using this code:\r\n\r\n    package io.github.ilkgunel.mongodb;\r\n    import org.bson.Document;\r\n    \r\n    import com.mongodb.MongoClient;\r\n    import com.mongodb.client.MongoCollection;\r\n    import com.mongodb.client.MongoDatabase;\r\n    \r\n    import java.text.DateFormat;\r\n    import java.text.SimpleDateFormat;\r\n    import java.util.ArrayList;\r\n    import java.util.Collection;\r\n    import java.util.List;\r\n    import java.util.Locale;\r\n    \r\n    public class MongoDBBasicUsage {\r\n        public static void main(String[] args) {\r\n            MongoClient mongoClient;\r\n            try {\r\n                Pojo pojo = new Pojo();\r\n                mongoClient = new MongoClient(&quot;localhost&quot;, 27017);\r\n                MongoDatabase database = mongoClient.getDatabase(&quot;MongoDB&quot;);\r\n                \r\n                pojo.setId(&quot;1&quot;);\r\n                pojo.setName(&quot;ilkay&quot;);\r\n                pojo.setSurname(&quot;g&#252;nel&quot;);\r\n            \r\n                Document document = new Document();\r\n                document.put(&quot;person&quot;, pojo);\r\n            \r\n                database.getCollection(&quot;Records&quot;).insertOne(document);  \r\n            } catch (Exception e) {\r\n                System.err.println(&quot;Bir Hata Meydana Geldi!&quot;);\r\n                System.out.println(&quot;Hata&quot; + e);\r\n            }\r\n        }\r\n    }\r\n\r\nMy Pojo is this:\r\n\r\n    package io.github.ilkgunel.mongodb;\r\n    \r\n    public class Pojo {\r\n        String name;\r\n        String surname;\r\n        String id;\r\n    \r\n        public String getName() {\r\n            return name;\r\n        }\r\n    \r\n        public void setName(String name) {\r\n            this.name = name;\r\n        }\r\n    \r\n        public String getSurname() {\r\n            return surname;\r\n        }\r\n    \r\n        public void setSurname(String surname) {\r\n            this.surname = surname;\r\n        }\r\n    \r\n        public String getId() {\r\n            return id;\r\n        }\r\n    \r\n        public void setId(String id) {\r\n            this.id = id;\r\n        } \r\n    }\r\n\r\n","title":"MongoDB Java Inserting Throws org.bson.codecs.configuration.CodecConfigurationException: Can&#39;t find a codec for class io.github.ilkgunel.mongodb.Pojo","body":"<p>I'm learning MongoDB with Java. I'm trying to insert data to MongoDB with Java driver. I'm doing inserting like in MongoDB tutorial and every thing is okey. But if I want to insert a variable and when I run the code, driver throws an error like this:</p>\n<pre><code>org.bson.codecs.configuration.CodecConfigurationException: Can't find a codec for class io.github.ilkgunel.mongodb.Pojo.\n</code></pre>\n<p>I searhed questions in Stack Overflow like this but I couldn't understand anything and I cant't find anything to solve this error. My code is below. How can solve this problem?</p>\n<p>I'm using this code:</p>\n<pre><code>package io.github.ilkgunel.mongodb;\nimport org.bson.Document;\n\nimport com.mongodb.MongoClient;\nimport com.mongodb.client.MongoCollection;\nimport com.mongodb.client.MongoDatabase;\n\nimport java.text.DateFormat;\nimport java.text.SimpleDateFormat;\nimport java.util.ArrayList;\nimport java.util.Collection;\nimport java.util.List;\nimport java.util.Locale;\n\npublic class MongoDBBasicUsage {\n    public static void main(String[] args) {\n        MongoClient mongoClient;\n        try {\n            Pojo pojo = new Pojo();\n            mongoClient = new MongoClient(&quot;localhost&quot;, 27017);\n            MongoDatabase database = mongoClient.getDatabase(&quot;MongoDB&quot;);\n            \n            pojo.setId(&quot;1&quot;);\n            pojo.setName(&quot;ilkay&quot;);\n            pojo.setSurname(&quot;günel&quot;);\n        \n            Document document = new Document();\n            document.put(&quot;person&quot;, pojo);\n        \n            database.getCollection(&quot;Records&quot;).insertOne(document);  \n        } catch (Exception e) {\n            System.err.println(&quot;Bir Hata Meydana Geldi!&quot;);\n            System.out.println(&quot;Hata&quot; + e);\n        }\n    }\n}\n</code></pre>\n<p>My Pojo is this:</p>\n<pre><code>package io.github.ilkgunel.mongodb;\n\npublic class Pojo {\n    String name;\n    String surname;\n    String id;\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public String getSurname() {\n        return surname;\n    }\n\n    public void setSurname(String surname) {\n        this.surname = surname;\n    }\n\n    public String getId() {\n        return id;\n    }\n\n    public void setId(String id) {\n        this.id = id;\n    } \n}\n</code></pre>\n"},{"tags":["java","android","ssl"],"comments":[{"owner":{"account_id":15268897,"reputation":1894,"user_id":11016652,"display_name":"zomega"},"score":0,"creation_date":1694780382,"post_id":77112283,"comment_id":135939689,"body_markdown":"Please show some code.","body":"Please show some code."},{"owner":{"account_id":53770,"reputation":2255,"user_id":160808,"accept_rate":71,"display_name":"Ageis"},"score":0,"creation_date":1694782821,"post_id":77112283,"comment_id":135940216,"body_markdown":"There no code t show. I am asking for advise","body":"There no code t show. I am asking for advise"},{"owner":{"account_id":9107988,"reputation":3190,"user_id":6777695,"display_name":"Hakan54"},"score":0,"creation_date":1694783590,"post_id":77112283,"comment_id":135940382,"body_markdown":"What you can try is to use the default jdk trusted certificates, android ca trusted certificates and also include the ssl certificate issued by Ionos. These two links will give you examples how to load them all: https://github.com/Hakky54/sslcontext-kickstart#loading-jdk-and-os-trusted-certificates and https://github.com/Hakky54/sslcontext-kickstart#using-der-files By the way this is my library... Please let me know if this works for you. The SSLFactory instance will give you a SSLSocketFactory","body":"What you can try is to use the default jdk trusted certificates, android ca trusted certificates and also include the ssl certificate issued by Ionos. These two links will give you examples how to load them all: <a href=\"https://github.com/Hakky54/sslcontext-kickstart#loading-jdk-and-os-trusted-certificates\" rel=\"nofollow noreferrer\">github.com/Hakky54/&hellip;</a> and <a href=\"https://github.com/Hakky54/sslcontext-kickstart#using-der-files\" rel=\"nofollow noreferrer\">github.com/Hakky54/sslcontext-kickstart#using-der-files</a> By the way this is my library... Please let me know if this works for you. The SSLFactory instance will give you a SSLSocketFactory"},{"owner":{"account_id":53770,"reputation":2255,"user_id":160808,"accept_rate":71,"display_name":"Ageis"},"score":0,"creation_date":1694789929,"post_id":77112283,"comment_id":135941756,"body_markdown":"Hi thanks for providing me with a library to do this. but how do I then connect the sslcontext to a websocket client","body":"Hi thanks for providing me with a library to do this. but how do I then connect the sslcontext to a websocket client"},{"owner":{"account_id":9107988,"reputation":3190,"user_id":6777695,"display_name":"Hakan54"},"score":0,"creation_date":1694795255,"post_id":77112283,"comment_id":135942761,"body_markdown":"@Ageis which websocket are you using?","body":"@Ageis which websocket are you using?"},{"owner":{"account_id":53770,"reputation":2255,"user_id":160808,"accept_rate":71,"display_name":"Ageis"},"score":0,"creation_date":1694810949,"post_id":77112283,"comment_id":135945238,"body_markdown":"WebSocketClient the org.java_websocket.client https://javadoc.io/doc/org.java-websocket/Java-WebSocket/latest/index.html","body":"WebSocketClient the org.java_websocket.client <a href=\"https://javadoc.io/doc/org.java-websocket/Java-WebSocket/latest/index.html\" rel=\"nofollow noreferrer\">javadoc.io/doc/org.java-websocket/Java-WebSocket/latest/&hellip;</a>"},{"owner":{"account_id":9107988,"reputation":3190,"user_id":6777695,"display_name":"Hakan54"},"score":0,"creation_date":1694850320,"post_id":77112283,"comment_id":135947896,"body_markdown":"You can just do: `webSocketClient.setSocketFactory(sslfactory.getSslSocketFacktory())` can you give it a try and share your results here?","body":"You can just do: <code>webSocketClient.setSocketFactory(sslfactory.getSslSocketFack&zwnj;&#8203;tory())</code> can you give it a try and share your results here?"}],"owner":{"account_id":53770,"reputation":2255,"user_id":160808,"accept_rate":71,"display_name":"Ageis"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":90,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694780305,"creation_date":1694779984,"question_id":77112283,"body_markdown":"I am trying to create a keystore for my android app because I am guessing it doesn&#39;t trust the root ca for my Digi cert issued certificate. It&#39;s a real ssl certificate issued by Ionos but the root ca is digi cert.\r\n\r\nI am using web sockets in my android app and I get this error enter \r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\nso I am trying to create a custom SSLSocketFactory that uses the built-in certificate KeyStore, but falls back on an alternate KeyStore for anything that fails to verify with the default.\r\nAfter some research, I came across this stack overflow https://stackoverflow.com/questions/6825226/trust-anchor-not-found-for-android-ssl-connection which mensions bks keystore however according to this video https://www.youtube.com/watch?v=iB41HWOhVnc bks keystores arent considered secure anymore.\r\n\r\nso what is the recommended method nowadays? I will require full instructions as I am absolutely clueless. Thanks in advance.\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/uSayD.png","title":"recommend way of resolving Trust Anchor not found for Android SSL Connection","body":"<p>I am trying to create a keystore for my android app because I am guessing it doesn't trust the root ca for my Digi cert issued certificate. It's a real ssl certificate issued by Ionos but the root ca is digi cert.</p>\n<p>I am using web sockets in my android app and I get this error enter</p>\n<p><a href=\"https://i.stack.imgur.com/uSayD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uSayD.png\" alt=\"enter image description here\" /></a></p>\n<p>so I am trying to create a custom SSLSocketFactory that uses the built-in certificate KeyStore, but falls back on an alternate KeyStore for anything that fails to verify with the default.\nAfter some research, I came across this stack overflow <a href=\"https://stackoverflow.com/questions/6825226/trust-anchor-not-found-for-android-ssl-connection\">Trust Anchor not found for Android SSL Connection</a> which mensions bks keystore however according to this video <a href=\"https://www.youtube.com/watch?v=iB41HWOhVnc\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=iB41HWOhVnc</a> bks keystores arent considered secure anymore.</p>\n<p>so what is the recommended method nowadays? I will require full instructions as I am absolutely clueless. Thanks in advance.</p>\n"},{"tags":["java","gradle","kotlin","junit5","gradle-kotlin-dsl"],"answers":[{"tags":[],"owner":{"account_id":8431463,"reputation":1868,"user_id":6327046,"display_name":"Marc Philipp"},"down_vote_count":0,"up_vote_count":29,"is_accepted":true,"score":29,"last_activity_date":1578661304,"creation_date":1526289621,"answer_id":50326943,"question_id":50324092,"body_markdown":"There&#39;s [documentation][1] and a [sample project][2] for using Gradle and JUnit 5.\r\n\r\nIf you want to use the Kotlin DSL you&#39;ll have to adapt it in the following way:\r\n\r\n    tasks.withType&lt;Test&gt;().configureEach {\r\n        useJUnitPlatform()\r\n    }\r\n\r\nFor Jigsaw, Gradle provides [experimental support][3] and there&#39;s a [fork of the plugin][4] that provides additional features.\r\n\r\n\r\n  [1]: https://junit.org/junit5/docs/current/user-guide/#running-tests-build-gradle\r\n  [2]: https://github.com/junit-team/junit5-samples/tree/master/junit5-jupiter-starter-gradle\r\n  [3]: https://guides.gradle.org/building-java-9-modules/\r\n  [4]: https://github.com/zyxist/chainsaw","title":"How to use JUnit 5 with build.gradle.kts and Kotlin?","body":"<p>There's <a href=\"https://junit.org/junit5/docs/current/user-guide/#running-tests-build-gradle\" rel=\"noreferrer\">documentation</a> and a <a href=\"https://github.com/junit-team/junit5-samples/tree/master/junit5-jupiter-starter-gradle\" rel=\"noreferrer\">sample project</a> for using Gradle and JUnit 5.</p>\n\n<p>If you want to use the Kotlin DSL you'll have to adapt it in the following way:</p>\n\n<pre><code>tasks.withType&lt;Test&gt;().configureEach {\n    useJUnitPlatform()\n}\n</code></pre>\n\n<p>For Jigsaw, Gradle provides <a href=\"https://guides.gradle.org/building-java-9-modules/\" rel=\"noreferrer\">experimental support</a> and there's a <a href=\"https://github.com/zyxist/chainsaw\" rel=\"noreferrer\">fork of the plugin</a> that provides additional features.</p>\n"},{"tags":[],"owner":{"account_id":3771097,"reputation":2695,"user_id":3133286,"accept_rate":86,"display_name":"ordonezalex"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1548974402,"creation_date":1548974402,"answer_id":54470276,"question_id":50324092,"body_markdown":"Marc Philipp&#39;s answer works. Here is another approach:\r\n\r\n    val test: Test by tasks\r\n    test.useJUnitPlatform()","title":"How to use JUnit 5 with build.gradle.kts and Kotlin?","body":"<p>Marc Philipp's answer works. Here is another approach:</p>\n\n<pre><code>val test: Test by tasks\ntest.useJUnitPlatform()\n</code></pre>\n"},{"tags":[],"owner":{"account_id":11726648,"reputation":19523,"user_id":8583692,"display_name":"Mahozad"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694780170,"creation_date":1694780170,"answer_id":77112302,"question_id":50324092,"body_markdown":"A little more complete answer:\r\n\r\n```kotlin\r\ntasks.withType&lt;Test&gt; {\r\n    useJUnitPlatform() // Enables JUnit Platform (JUnit 5 + JUnit 4)\r\n}\r\n\r\ndependencies {\r\n    // Aggregator dependency that also brings JUnit 5 parameterized tests etc.\r\n    testImplementation(&quot;org.junit.jupiter:junit-jupiter:5.10.0&quot;)\r\n    // Include the Vintage engine to be able to run JUnit 4 tests as well\r\n    // testImplementation(&quot;org.junit.vintage:junit-vintage-engine:5.10.0&quot;)\r\n}\r\n```","title":"How to use JUnit 5 with build.gradle.kts and Kotlin?","body":"<p>A little more complete answer:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>tasks.withType&lt;Test&gt; {\n    useJUnitPlatform() // Enables JUnit Platform (JUnit 5 + JUnit 4)\n}\n\ndependencies {\n    // Aggregator dependency that also brings JUnit 5 parameterized tests etc.\n    testImplementation(&quot;org.junit.jupiter:junit-jupiter:5.10.0&quot;)\n    // Include the Vintage engine to be able to run JUnit 4 tests as well\n    // testImplementation(&quot;org.junit.vintage:junit-vintage-engine:5.10.0&quot;)\n}\n</code></pre>\n"}],"owner":{"account_id":5648336,"reputation":1414,"user_id":4469745,"accept_rate":43,"display_name":"xiang"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":4844,"favorite_count":0,"down_vote_count":1,"up_vote_count":15,"accepted_answer_id":50326943,"answer_count":3,"score":14,"last_activity_date":1694780223,"creation_date":1526278796,"question_id":50324092,"body_markdown":"* Java version:    `java 10.0.1 2018-04-17`\r\n* Kotlin version:  `1.2.41`\r\n* Gradle version:  `4.7`\r\n\r\nIt will be even better if we could use **jigsaw module system**.\r\n","title":"How to use JUnit 5 with build.gradle.kts and Kotlin?","body":"<ul>\n<li>Java version:    <code>java 10.0.1 2018-04-17</code></li>\n<li>Kotlin version:  <code>1.2.41</code></li>\n<li>Gradle version:  <code>4.7</code></li>\n</ul>\n<p>It will be even better if we could use <strong>jigsaw module system</strong>.</p>\n"},{"tags":["java","spring","spring-boot","spring-security","jwt"],"comments":[{"owner":{"account_id":6166039,"reputation":469,"user_id":7210926,"display_name":"Vipul Kumar"},"score":0,"creation_date":1694776546,"post_id":77111796,"comment_id":135938992,"body_markdown":"which spring boot version are you using?","body":"which spring boot version are you using?"},{"owner":{"account_id":25127622,"reputation":1,"user_id":18975254,"display_name":"MintedFairy"},"score":0,"creation_date":1694776963,"post_id":77111796,"comment_id":135939037,"body_markdown":"@VipulKumar I am using version 3.1.3","body":"@VipulKumar I am using version 3.1.3"},{"owner":{"account_id":24440940,"reputation":3122,"user_id":18364656,"display_name":"Andrei Lisa"},"score":0,"creation_date":1694777667,"post_id":77111796,"comment_id":135939165,"body_markdown":"all should work without any problem, can you also show how you are doing request of Authentication ?","body":"all should work without any problem, can you also show how you are doing request of Authentication ?"},{"owner":{"account_id":25127622,"reputation":1,"user_id":18975254,"display_name":"MintedFairy"},"score":0,"creation_date":1694777972,"post_id":77111796,"comment_id":135939231,"body_markdown":"@AndreiLisa sorry what do you mean please? I am just going to localhost:8080 on my browser and logging in when I am redirected to http://localhost:8080/login. Did you mean show some other part of my code?","body":"@AndreiLisa sorry what do you mean please? I am just going to localhost:8080 on my browser and logging in when I am redirected to <a href=\"http://localhost:8080/login\" rel=\"nofollow noreferrer\">localhost:8080/login</a>. Did you mean show some other part of my code?"},{"owner":{"account_id":24440940,"reputation":3122,"user_id":18364656,"display_name":"Andrei Lisa"},"score":0,"creation_date":1694778069,"post_id":77111796,"comment_id":135939254,"body_markdown":"because i tried you code and all work well, authentication is passing","body":"because i tried you code and all work well, authentication is passing"},{"owner":{"account_id":2064278,"reputation":13128,"user_id":1840146,"accept_rate":86,"display_name":"Toerktumlare"},"score":1,"creation_date":1694778216,"post_id":77111796,"comment_id":135939275,"body_markdown":"if you are seeing an auto generated password in the logs, means that your security configuration is not picked up by Spring Security, which means that spring is using the default security configuration. Your configuration file needs to be placed either in the root package next to file containing the main function, or in a package, beneath the file that contains the main function.","body":"if you are seeing an auto generated password in the logs, means that your security configuration is not picked up by Spring Security, which means that spring is using the default security configuration. Your configuration file needs to be placed either in the root package next to file containing the main function, or in a package, beneath the file that contains the main function."},{"owner":{"account_id":24440940,"reputation":3122,"user_id":18364656,"display_name":"Andrei Lisa"},"score":0,"creation_date":1694778232,"post_id":77111796,"comment_id":135939279,"body_markdown":"by the way into `securityFilterChain` also add `.formLogin(Customizer.withDefaults())`","body":"by the way into <code>securityFilterChain</code> also add <code>.formLogin(Customizer.withDefaults())</code>"},{"owner":{"account_id":24440940,"reputation":3122,"user_id":18364656,"display_name":"Andrei Lisa"},"score":0,"creation_date":1694778313,"post_id":77111796,"comment_id":135939300,"body_markdown":"also @Toerktumlare wrote a good point, check your package structure.","body":"also @Toerktumlare wrote a good point, check your package structure."},{"owner":{"account_id":2064278,"reputation":13128,"user_id":1840146,"accept_rate":86,"display_name":"Toerktumlare"},"score":1,"creation_date":1694778375,"post_id":77111796,"comment_id":135939310,"body_markdown":"@AndreiLisa it depends on what he is going for, if he wants basic login, he wants basic, if he wants form he wants form. If he is using basic login, he should get a web browser popup that asks him to insert his credentials. What he should remove is what says his application should be STATELESS, because otherwise he will need to login multiple times.","body":"@AndreiLisa it depends on what he is going for, if he wants basic login, he wants basic, if he wants form he wants form. If he is using basic login, he should get a web browser popup that asks him to insert his credentials. What he should remove is what says his application should be STATELESS, because otherwise he will need to login multiple times."},{"owner":{"account_id":25127622,"reputation":1,"user_id":18975254,"display_name":"MintedFairy"},"score":1,"creation_date":1694778771,"post_id":77111796,"comment_id":135939393,"body_markdown":"@Toerktumlare OMG thank you! i moved my config package into the same package containing the main function and it worked! Thank you so much!! (also I&#39;m a she lol :D )","body":"@Toerktumlare OMG thank you! i moved my config package into the same package containing the main function and it worked! Thank you so much!! (also I&#39;m a she lol :D )"},{"owner":{"account_id":2064278,"reputation":13128,"user_id":1840146,"accept_rate":86,"display_name":"Toerktumlare"},"score":1,"creation_date":1694779497,"post_id":77111796,"comment_id":135939520,"body_markdown":"i apologize for assuming your gender, that was my bad. Remember to remove the line saying stateless. If you have that, the server will not remember you between requests after you have logged in.","body":"i apologize for assuming your gender, that was my bad. Remember to remove the line saying stateless. If you have that, the server will not remember you between requests after you have logged in."}],"answers":[{"tags":[],"owner":{"account_id":2064278,"reputation":13128,"user_id":1840146,"accept_rate":86,"display_name":"Toerktumlare"},"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1694780055,"creation_date":1694780055,"answer_id":77112290,"question_id":77111796,"body_markdown":"When creating a custom explicit security configuration, the `@SpringBootApplication` on the main function means that spring will search for spring beans and configuration classes recursively from the location of the file that contains the main function.\r\n\r\nIn the question it was pointed out that she could see a default password generated in the spring security logs.\r\n\r\nThis means that Spring Security is using its [default configuration][1] and any defined custom security has not been found by spring security.\r\n\r\nThis also probably means that the security configuration is not placed in either the same package, or a subpackage beneath the class/file that contains the main function.\r\n\r\n\r\n  [1]: https://docs.spring.io/spring-security/reference/servlet/getting-started.html#servlet-hello-starting","title":"Bad Credentials Error when using InMemoryUserDetailsManager","body":"<p>When creating a custom explicit security configuration, the <code>@SpringBootApplication</code> on the main function means that spring will search for spring beans and configuration classes recursively from the location of the file that contains the main function.</p>\n<p>In the question it was pointed out that she could see a default password generated in the spring security logs.</p>\n<p>This means that Spring Security is using its <a href=\"https://docs.spring.io/spring-security/reference/servlet/getting-started.html#servlet-hello-starting\" rel=\"nofollow noreferrer\">default configuration</a> and any defined custom security has not been found by spring security.</p>\n<p>This also probably means that the security configuration is not placed in either the same package, or a subpackage beneath the class/file that contains the main function.</p>\n"}],"owner":{"account_id":25127622,"reputation":1,"user_id":18975254,"display_name":"MintedFairy"},"comment_count":11,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":57,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"answer_count":1,"score":-1,"last_activity_date":1694780055,"creation_date":1694775613,"question_id":77111796,"body_markdown":"I am new to Spring and have been following a Spring Security JWT tutorial by Dan Vega. It&#39;s been going ok but I keep having an issue with the following code. Whenever I go to localhost and try to login with the credentials below. I keep getting a bad credentials error, but when I login with &#39;user&#39; and the auto-generated password I am able to login just fine. I don&#39;t know if i&#39;m missing something crucial and just unable to see it. Can anyone help me please. \r\n\r\n```\r\n@Configuration\r\n@EnableWebSecurity\r\npublic class SecurityConfig {\r\n    @Bean\r\n    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\r\n        return http\r\n                .csrf(csrf -&gt; csrf.disable())\r\n                .authorizeRequests( auth -&gt; auth\r\n                        .anyRequest().authenticated()\r\n                )\r\n                .sessionManagement(session -&gt; session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))\r\n                .httpBasic(Customizer.withDefaults())\r\n                .build();\r\n    }\r\n\r\n\r\n    @Bean\r\n    public InMemoryUserDetailsManager users() {\r\n        return new InMemoryUserDetailsManager(\r\n                User.withUsername(&quot;myname&quot;)\r\n                        .password(&quot;{noop}password&quot;)\r\n                        .authorities(&quot;read&quot;)\r\n                        .build()\r\n        );\r\n    }\r\n\r\n}```\r\n\r\n\r\nI have even tried refactoring it as so but even that hasn&#39;t helped the issue...\r\n```\r\n    @Bean\r\n    public UserDetailsService users() {\r\n        UserDetails user = User.builder()\r\n                .username(&quot;admin&quot;)\r\n                .password(&quot;{noop}password&quot;)\r\n                .roles(&quot;ADMIN&quot;)\r\n                .build();\r\n        return new InMemoryUserDetailsManager(user);\r\n    }\r\n```\r\n","title":"Bad Credentials Error when using InMemoryUserDetailsManager","body":"<p>I am new to Spring and have been following a Spring Security JWT tutorial by Dan Vega. It's been going ok but I keep having an issue with the following code. Whenever I go to localhost and try to login with the credentials below. I keep getting a bad credentials error, but when I login with 'user' and the auto-generated password I am able to login just fine. I don't know if i'm missing something crucial and just unable to see it. Can anyone help me please.</p>\n<pre><code>@Configuration\n@EnableWebSecurity\npublic class SecurityConfig {\n    @Bean\n    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n        return http\n                .csrf(csrf -&gt; csrf.disable())\n                .authorizeRequests( auth -&gt; auth\n                        .anyRequest().authenticated()\n                )\n                .sessionManagement(session -&gt; session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))\n                .httpBasic(Customizer.withDefaults())\n                .build();\n    }\n\n\n    @Bean\n    public InMemoryUserDetailsManager users() {\n        return new InMemoryUserDetailsManager(\n                User.withUsername(&quot;myname&quot;)\n                        .password(&quot;{noop}password&quot;)\n                        .authorities(&quot;read&quot;)\n                        .build()\n        );\n    }\n\n}```\n\n\nI have even tried refactoring it as so but even that hasn't helped the issue...\n</code></pre>\n<pre><code>@Bean\npublic UserDetailsService users() {\n    UserDetails user = User.builder()\n            .username(&quot;admin&quot;)\n            .password(&quot;{noop}password&quot;)\n            .roles(&quot;ADMIN&quot;)\n            .build();\n    return new InMemoryUserDetailsManager(user);\n}\n</code></pre>\n<pre><code></code></pre>\n"},{"tags":["java","spring","spring-saml"],"answers":[{"tags":[],"owner":{"account_id":4923916,"reputation":91,"user_id":3965719,"display_name":"Ollie"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1539885956,"creation_date":1539885956,"answer_id":52880047,"question_id":52863139,"body_markdown":"I found the answer in [another post](https://stackoverflow.com/questions/38081242/how-can-i-force-spring-saml-to-reread-my-idp-metadata)\r\n\r\nAs I am currently using an XML config file, I modified the security context XML to set the Credential Resolver as follows:\r\n\r\n    &lt;!-- Provider of default SAML Context --&gt;\r\n    &lt;bean id=&quot;contextProvider&quot; class=&quot;org.springframework.security.saml.context.SAMLContextProviderImpl&quot;&gt;\r\n      &lt;property name=&quot;metadataResolver&quot;&gt;\r\n    \t\t\t&lt;bean class=&quot;com.mydomain.CustomMetadataCredentialResolver&quot;&gt;\r\n    \t\t\t\t&lt;constructor-arg index=&quot;0&quot; ref=&quot;metadata&quot; /&gt;\r\n    \t\t\t\t&lt;constructor-arg index=&quot;1&quot; ref=&quot;keyManager&quot; /&gt;\r\n    \t\t\t\t&lt;property name=&quot;useXmlMetadata&quot; value=&quot;true&quot; /&gt;\r\n    \t\t\t&lt;/bean&gt;\r\n      &lt;/property&gt; \r\n    &lt;/bean&gt;\r\n\r\n\r\nI then created a class that extends `org.springframework.security.saml.trust.MetadataCredentialResolver`\r\n\r\nFor now, I simply override the cacheCredentials method:\r\n\r\n    @Component\r\n    public class CustomMetadataCredentialResolver extends MetadataCredentialResolver {\r\n    \r\n      public CustomMetadataCredentialResolver(MetadataManager metadataProvider, KeyManager keyManager) {\r\n        super(metadataProvider, keyManager);\r\n      }\r\n    \r\n      @Override\r\n      protected void cacheCredentials( MetadataCacheKey cacheKey, Collection&lt;Credential&gt; credentials ) {\r\n        //no-op\r\n      }\r\n    }\r\n\r\n\r\nI&#39;ll likely clean this up to clear the cache on command rather than never caching the credentials, but for now it works.","title":"Spring SAML: updating Metadata Provider does not update signing certificates used","body":"<p>I found the answer in <a href=\"https://stackoverflow.com/questions/38081242/how-can-i-force-spring-saml-to-reread-my-idp-metadata\">another post</a></p>\n\n<p>As I am currently using an XML config file, I modified the security context XML to set the Credential Resolver as follows:</p>\n\n<pre><code>&lt;!-- Provider of default SAML Context --&gt;\n&lt;bean id=\"contextProvider\" class=\"org.springframework.security.saml.context.SAMLContextProviderImpl\"&gt;\n  &lt;property name=\"metadataResolver\"&gt;\n            &lt;bean class=\"com.mydomain.CustomMetadataCredentialResolver\"&gt;\n                &lt;constructor-arg index=\"0\" ref=\"metadata\" /&gt;\n                &lt;constructor-arg index=\"1\" ref=\"keyManager\" /&gt;\n                &lt;property name=\"useXmlMetadata\" value=\"true\" /&gt;\n            &lt;/bean&gt;\n  &lt;/property&gt; \n&lt;/bean&gt;\n</code></pre>\n\n<p>I then created a class that extends <code>org.springframework.security.saml.trust.MetadataCredentialResolver</code></p>\n\n<p>For now, I simply override the cacheCredentials method:</p>\n\n<pre><code>@Component\npublic class CustomMetadataCredentialResolver extends MetadataCredentialResolver {\n\n  public CustomMetadataCredentialResolver(MetadataManager metadataProvider, KeyManager keyManager) {\n    super(metadataProvider, keyManager);\n  }\n\n  @Override\n  protected void cacheCredentials( MetadataCacheKey cacheKey, Collection&lt;Credential&gt; credentials ) {\n    //no-op\n  }\n}\n</code></pre>\n\n<p>I'll likely clean this up to clear the cache on command rather than never caching the credentials, but for now it works.</p>\n"}],"owner":{"account_id":4923916,"reputation":91,"user_id":3965719,"display_name":"Ollie"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":2373,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":1,"score":2,"last_activity_date":1694779991,"creation_date":1539808263,"question_id":52863139,"body_markdown":"I&#39;ve recently implemented a Spring SAML solution which allows customers to register their IdP Metadata with a service and use their SAML authentication to access my SP.\r\n\r\nThe IdP Metadata is stored as a Database entry as part of a custom AbstractReloadingMetadataProvider implementation, as suggested [here](https://stackoverflow.com/questions/42906985/spring-saml-reading-and-refreshing-idp-metadata-at-runtime)  :\r\n\r\n\r\n----------\r\n\r\n```java\r\npublic class DbIdpMetadataProvider extends AbstractReloadingMetadataProvider {\r\n...\r\n  @Override\r\n  protected byte[] fetchMetadata() throws MetadataProviderException {\r\n  IdpProviderData provider  = null; // DAO of IdP metadata in DB\r\n\r\n  try {\r\n\r\n    log.info(&quot;Attempting to retrieve DB provider data for entity: &quot; + entityId);\r\n\r\n    provider = dbService.getIdpByEntityId(entityId);\r\n\r\n    // verify that we have a provider\r\n    if ( null != provider) {\r\n\r\n      // get last update time recorded in DB\r\n      DateTime lastUpdate = getLastUpdate();\r\n\r\n      log.info(&quot;Performing refresh of Metadata Provider XML by reading from database&quot;);\r\n\r\n\r\n      String metadataBody = provider.getMetadataBody();\r\n      emitChangeEvent();\r\n      return metadataBody.getBytes();\r\n    }\r\n\r\n\r\n    // if no provider, throw an exception as this metadata provider instance is invalid\r\n    else {\r\n      log.error(&quot;IdP Provider could not be found for EntityId: &quot; + entityId );\r\n      throw new MetadataProviderException(&quot;Metadata could not be found for String entity: &quot; + entityId);\r\n    }\r\n\r\n  }\r\n  catch(Exception e) {\r\n    log.error(&quot;Failed to query database for provider entity: &quot; + entityId);\r\n    throw new MetadataProviderException(&quot;Failed to query database for provider entity: &quot; + entityId, e);\r\n  }\r\n\r\n}\r\n```\r\n\r\n----------\r\n\r\nWhen the metadata is updated, I save the metadata XML to the database and remove the previous instance of the Metadata Provider from the CachingMetadataManager. I then import the Certificates from the metadata to a local keystore and add a new metadata provider instance to the CachingMetadataManager:\r\n\r\n```java\r\n@Autowired\r\nprivate MetadataManager       metadataManager;\r\n\r\n...\r\n\r\n/**\r\n * Update our existing IdP metadata provider with new XML and other information\r\n */\r\npublic void updateIdpMetadata(IdPRegistrationData _data) throws RequiredDataException, NotFoundException, SystemException {\r\n  IdpProviderData           provider;\r\n  XMLObject                 xml;\r\n  String                    metadataXml;\r\n  EntityDescriptor          entity;\r\n  String                    entityId;\r\n\r\n  try {\r\n    \r\n    // validation\r\n    validateIdpRegistrationData(_data);\r\n\r\n    //ensure our top level DOM element is the IDPSSO entity descriptor, removing all other metadata\r\n    xml         = parseMetadataXml(_data.getMetadataXml());\r\n    entity      = getIDPSSOParentEntityDescriptor(xml);\r\n    entityId    = entity.getEntityID();\r\n    metadataXml = serialize(entity);\r\n    \r\n    // get our provider Data\r\n    provider    = getIdpByAccountSysid(_data.getAccountSysid());\r\n    \r\n    if ( null == provider) {\r\n      throw new NotFoundException(NotFoundExceptionType.ACCOUNT);\r\n    }\r\n    \r\n    // update our provider\r\n    provider.setEntityId(entityId);\r\n    provider.setMetadataBody(metadataXml);\r\n    \r\n    // save data in database\r\n    metadataStoreDao.saveAndFlush(provider);\r\n    keystoreMgr.importMetadataCertificates(xml, provider.getUrlContext());\r\n    \r\n    // remove existing provider from metadata store\r\n    removeDelegateFromManager(entityId);\r\n    \r\n    // reintroduce delegate to manager\r\n    loadIdpMetadata(provider);\r\n         \r\n  }\r\n  catch(NotFoundException e) {\r\n    log.error(&quot;No previous version of IDP registration metadata found to update.&quot;,e);\r\n    throw (e);\r\n  }\r\n  catch (MetadataProviderException e){\r\n    log.error(&quot;Failed to update Keystore and Signing algorithm of IdP Metadata.&quot;,e);\r\n    throw new SystemException(&quot;Failed to update certificates.&quot;);\r\n  }\r\n  catch(RequiredDataException e) {\r\n    log.error(&quot;Missing required data for update.&quot;,e);\r\n    throw(e);\r\n  }\r\n\r\n}\r\n\r\n/**\r\n * Remove the metadata provider from our manager\r\n */\r\nprivate void removeDelegateFromManager( String _entityId ) throws MetadataProviderException {\r\n  ExtendedMetadataDelegate  delegate;\r\n  DbIdpMetadataProvider     provider;\r\n  \r\n  delegate  = findMetadataDelegate(_entityId);\r\n  \r\n  if( null == delegate){\r\n    log.error(&quot;Failed to find Delegate in metadata manager for Entity ID: &quot; + _entityId );\r\n    return;\r\n  }\r\n  \r\n  metadataManager.removeMetadataProvider(delegate);\r\n  provider = (DbIdpMetadataProvider)delegate.getDelegate();\r\n  provider.destroy();\r\n  metadataManager.setRefreshRequired(true);\r\n  metadataManager.refreshMetadata();\r\n\r\n}    \r\n\r\n/**\r\n * load our provider data to a metadata provider object\r\n */\r\nprivate void loadIdpMetadata(IdpProviderData _providerData) throws MetadataProviderException {\r\n  DbIdpMetadataProvider idpProvider;\r\n\r\n  // initialize our IdP provider\r\n  idpProvider     = new DbIdpMetadataProvider(_providerData);\r\n  idpProvider.setParserPool(parser);\r\n  addIdpToMetadataManager(idpProvider);\r\n\r\n}\r\n\r\n/**\r\n * Add the metadata provider to our cache\r\n */\r\nprivate void addIdpToMetadataManager(DbIdpMetadataProvider _provider) throws MetadataProviderException {\r\n  ExtendedMetadataDelegate  delegate;\r\n  ExtendedMetadata          extMeta = new ExtendedMetadata();\r\n  \r\n  // initialize our provider\r\n  _provider.initialize();\r\n  \r\n  extMeta     = createExtendedMetadata(_provider);\r\n\r\n  delegate    = new ExtendedMetadataDelegate(_provider, extMeta);\r\n  delegate.setMetadataTrustCheck(false);\r\n  delegate.initialize();\r\n  \r\n  metadataManager.addMetadataProvider(delegate);\r\n  metadataManager.setRefreshRequired(true);\r\n  metadataManager.refreshMetadata();\r\n}\r\n```    \r\n\r\nThe problem is that when a database entry is refreshed, the new signing certificate defined in the &lt;ds:X509Certificate&gt; element in the IdP metadata is not applied.\r\n\r\nI can see the new certificate when I print out the Metadata XML:\r\n\r\n----------\r\n```xml\r\n&lt;!--  new signing key  --&gt;\r\n&lt;IDPSSODescriptor protocolSupportEnumeration=&quot;urn:oasis:names:tc:SAML:2.0:protocol&quot;&gt;\r\n    &lt;KeyDescriptor use=&quot;encryption&quot;&gt;\r\n        &lt;KeyInfo xmlns=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;\r\n            &lt;X509Data&gt;\r\n                &lt;X509Certificate&gt;MIIC4jCCAcqgAwIBAgIQafZAY7...&lt;/X509Certificate&gt;\r\n            &lt;/X509Data&gt;\r\n        &lt;/KeyInfo&gt;\r\n    &lt;/KeyDescriptor&gt;\r\n    &lt;KeyDescriptor use=&quot;signing&quot;&gt;\r\n        &lt;KeyInfo xmlns=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;\r\n            &lt;X509Data&gt;\r\n                &lt;X509Certificate&gt;MIIC3DCCAcSgAwIBAgIQeny6jM...&lt;/X509Certificate&gt;\r\n            &lt;/X509Data&gt;\r\n        &lt;/KeyInfo&gt;\r\n    &lt;/KeyDescriptor&gt;\r\n    &lt;KeyDescriptor use=&quot;signing&quot;&gt;\r\n        &lt;KeyInfo xmlns=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;\r\n            &lt;X509Data&gt;\r\n                &lt;X509Certificate&gt;MIIC3DCCAcSgAwIBAgIQRtno3W...&lt;/X509Certificate&gt;\r\n            &lt;/X509Data&gt;\r\n        &lt;/KeyInfo&gt;\r\n    &lt;/KeyDescriptor&gt;\r\n```\r\n----------\r\n        \r\nI receive a SUCCESS SAML response from my IdP at time of SP initiated sign on:\r\n\r\n----------\r\n\r\n```xml\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;samlp:Response xmlns:samlp=&quot;urn:oasis:names:tc:SAML:2.0:protocol&quot; Consent=&quot;urn:oasis:names:tc:SAML:2.0:consent:unspecified&quot; Destination=&quot;https://{my-domain}:443/eas-saml/saml/SSO&quot; ID=&quot;_0d023fb8-bf24-4b78-b690-c9b53df4db72&quot; InResponseTo=&quot;a22h6bb0gf2e8f314e00316b198ddg1&quot; IssueInstant=&quot;2018-10-17T18:31:47.332Z&quot; Version=&quot;2.0&quot;&gt;\r\n   &lt;Issuer xmlns=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot;&gt;http://{my-domain}/adfs/services/trust&lt;/Issuer&gt;\r\n   &lt;samlp:Status&gt;\r\n      &lt;samlp:StatusCode Value=&quot;urn:oasis:names:tc:SAML:2.0:status:Success&quot;/&gt;\r\n   &lt;/samlp:Status&gt;\r\n   &lt;Assertion xmlns=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; ID=&quot;_317d062d-247e-4405-9dd8-0ef3d032bf3f&quot; IssueInstant=&quot;2018-10-17T18:31:47.332Z&quot; Version=&quot;2.0&quot;&gt;\r\n      &lt;Issuer&gt;http://{my-domain}/adfs/services/trust&lt;/Issuer&gt;\r\n      &lt;ds:Signature xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;\r\n         &lt;ds:SignedInfo&gt;\r\n            &lt;ds:CanonicalizationMethod Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;/&gt;\r\n            &lt;ds:SignatureMethod Algorithm=&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;/&gt;\r\n            &lt;ds:Reference URI=&quot;#_8049000b-6e76-416c-84aa-180d61ca359a&quot;&gt;\r\n               &lt;ds:Transforms&gt;\r\n                  &lt;ds:Transform Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;/&gt;\r\n                  &lt;ds:Transform Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;/&gt;\r\n               &lt;/ds:Transforms&gt;\r\n               &lt;ds:DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;/&gt;\r\n               &lt;ds:DigestValue&gt;x/PKyqXDECmE2IBNiZ0pqet3HqQYgDwlbeo1Vb3gXD8=&lt;/ds:DigestValue&gt;\r\n            &lt;/ds:Reference&gt;\r\n         &lt;/ds:SignedInfo&gt;\r\n         &lt;ds:SignatureValue&gt;UvhpsDE7XT1uvqGbA+IZ2sC9t8x0i42/P7tdNXO...&lt;/ds:SignatureValue&gt;\r\n         &lt;KeyInfo xmlns=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;\r\n            &lt;ds:X509Data&gt;\r\n               &lt;ds:X509Certificate&gt;MIIC3DCCAcSgAwIBAgIQRtno3W...&lt;/ds:X509Certificate&gt;\r\n            &lt;/ds:X509Data&gt;\r\n         &lt;/KeyInfo&gt;\r\n      &lt;/ds:Signature&gt;\r\n      &lt;Subject&gt;\r\n         &lt;NameID Format=&quot;urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified&quot;&gt;userId&lt;/NameID&gt;\r\n         &lt;SubjectConfirmation Method=&quot;urn:oasis:names:tc:SAML:2.0:cm:bearer&quot;&gt;\r\n            &lt;SubjectConfirmationData InResponseTo=&quot;a22h6bb0gf2e8f314e00316b198ddg1&quot; NotOnOrAfter=&quot;2018-10-17T18:36:47.332Z&quot; Recipient=&quot;https://{my-domain}:443/eas-saml/saml/SSO&quot;/&gt;\r\n         &lt;/SubjectConfirmation&gt;\r\n      &lt;/Subject&gt;\r\n      &lt;Conditions NotBefore=&quot;2018-10-17T18:31:47.327Z&quot; NotOnOrAfter=&quot;2018-10-17T18:33:47.327Z&quot;&gt;\r\n         &lt;AudienceRestriction&gt;\r\n            &lt;Audience&gt;https://{my-domain}/eas-saml&lt;/Audience&gt;\r\n         &lt;/AudienceRestriction&gt;\r\n      &lt;/Conditions&gt;\r\n      &lt;AttributeStatement&gt;\r\n         &lt;Attribute Name=&quot;http://schemas.xmlsoap.org/ws/2005/05/identity/claims/upn&quot;&gt;\r\n            &lt;AttributeValue&gt;userId&lt;/AttributeValue&gt;\r\n         &lt;/Attribute&gt;\r\n         &lt;Attribute Name=&quot;http://E-Mail-Addresses&quot;&gt;\r\n            &lt;AttributeValue&gt;user@domain.com&lt;/AttributeValue&gt;\r\n         &lt;/Attribute&gt;\r\n      &lt;/AttributeStatement&gt;\r\n      &lt;AuthnStatement AuthnInstant=&quot;2018-10-17T18:31:47.233Z&quot; SessionIndex=&quot;_317d062d-247e-4405-9dd8-0ef3d032bf3f&quot;&gt;\r\n         &lt;AuthnContext&gt;\r\n            &lt;AuthnContextClassRef&gt;urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport&lt;/AuthnContextClassRef&gt;\r\n         &lt;/AuthnContext&gt;\r\n      &lt;/AuthnStatement&gt;\r\n   &lt;/Assertion&gt;\r\n&lt;/samlp:Response&gt;\r\n\r\n----------\r\n\r\nWhere as the log output shows a failure with the following stack trace:\r\n\r\n----------\r\n&lt;pre&gt;\r\n    2018-10-17 18:31:47 INFO  SAMLDefaultLogger:129 - AuthNResponse;FAILURE;172.17.0.1;https://{my-domain}/eas-saml;http://{my-domain}/adfs/services/trust;;;org.opensaml.common.SAMLException: Response doesn&#39;t have any valid assertion which would pass subject validation\r\n      at org.springframework.security.saml.websso.WebSSOProfileConsumerImpl.processAuthenticationResponse(WebSSOProfileConsumerImpl.java:229)\r\n      at org.springframework.security.saml.SAMLAuthenticationProvider.authenticate(SAMLAuthenticationProvider.java:88)\r\n      at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:174)\r\n      at org.springframework.security.saml.SAMLProcessingFilter.attemptAuthentication(SAMLProcessingFilter.java:92)\r\n      at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)\r\n      at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)\r\n      at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:215)\r\n      at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)\r\n      at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)\r\n      at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:64)\r\n      at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\r\n      at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)\r\n      at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:56)\r\n      at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\r\n      at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)\r\n      at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:105)\r\n      at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)\r\n      at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:215)\r\n      at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:178)\r\n    Caused by: org.opensaml.xml.validation.ValidationException: Signature is not trusted or invalid\r\n      at org.springframework.security.saml.websso.AbstractProfileBase.verifySignature(AbstractProfileBase.java:272)\r\n      at org.springframework.security.saml.websso.WebSSOProfileConsumerImpl.verifyAssertionSignature(WebSSOProfileConsumerImpl.java:419)\r\n      at org.springframework.security.saml.websso.WebSSOProfileConsumerImpl.verifyAssertion(WebSSOProfileConsumerImpl.java:292)\r\n      at org.springframework.security.saml.websso.WebSSOProfileConsumerImpl.processAuthenticationResponse(WebSSOProfileConsumerImpl.java:214)\r\n      ... 39 more\r\n&lt;/pre&gt;\r\n----------\r\n\r\nIf I restart the service, the signature is recognized and the response is successfully processed.\r\n\r\nCan anyone see what I may be doing wrong? Shouldn&#39;t a refresh of the metadata manager be enough to allow the new certificates be used? Or is there a step I&#39;m missing?\r\n","title":"Spring SAML: updating Metadata Provider does not update signing certificates used","body":"<p>I've recently implemented a Spring SAML solution which allows customers to register their IdP Metadata with a service and use their SAML authentication to access my SP.</p>\n<p>The IdP Metadata is stored as a Database entry as part of a custom AbstractReloadingMetadataProvider implementation, as suggested <a href=\"https://stackoverflow.com/questions/42906985/spring-saml-reading-and-refreshing-idp-metadata-at-runtime\">here</a>  :</p>\n<hr />\n<pre class=\"lang-java prettyprint-override\"><code>public class DbIdpMetadataProvider extends AbstractReloadingMetadataProvider {\n...\n  @Override\n  protected byte[] fetchMetadata() throws MetadataProviderException {\n  IdpProviderData provider  = null; // DAO of IdP metadata in DB\n\n  try {\n\n    log.info(&quot;Attempting to retrieve DB provider data for entity: &quot; + entityId);\n\n    provider = dbService.getIdpByEntityId(entityId);\n\n    // verify that we have a provider\n    if ( null != provider) {\n\n      // get last update time recorded in DB\n      DateTime lastUpdate = getLastUpdate();\n\n      log.info(&quot;Performing refresh of Metadata Provider XML by reading from database&quot;);\n\n\n      String metadataBody = provider.getMetadataBody();\n      emitChangeEvent();\n      return metadataBody.getBytes();\n    }\n\n\n    // if no provider, throw an exception as this metadata provider instance is invalid\n    else {\n      log.error(&quot;IdP Provider could not be found for EntityId: &quot; + entityId );\n      throw new MetadataProviderException(&quot;Metadata could not be found for String entity: &quot; + entityId);\n    }\n\n  }\n  catch(Exception e) {\n    log.error(&quot;Failed to query database for provider entity: &quot; + entityId);\n    throw new MetadataProviderException(&quot;Failed to query database for provider entity: &quot; + entityId, e);\n  }\n\n}\n</code></pre>\n<hr />\n<p>When the metadata is updated, I save the metadata XML to the database and remove the previous instance of the Metadata Provider from the CachingMetadataManager. I then import the Certificates from the metadata to a local keystore and add a new metadata provider instance to the CachingMetadataManager:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Autowired\nprivate MetadataManager       metadataManager;\n\n...\n\n/**\n * Update our existing IdP metadata provider with new XML and other information\n */\npublic void updateIdpMetadata(IdPRegistrationData _data) throws RequiredDataException, NotFoundException, SystemException {\n  IdpProviderData           provider;\n  XMLObject                 xml;\n  String                    metadataXml;\n  EntityDescriptor          entity;\n  String                    entityId;\n\n  try {\n    \n    // validation\n    validateIdpRegistrationData(_data);\n\n    //ensure our top level DOM element is the IDPSSO entity descriptor, removing all other metadata\n    xml         = parseMetadataXml(_data.getMetadataXml());\n    entity      = getIDPSSOParentEntityDescriptor(xml);\n    entityId    = entity.getEntityID();\n    metadataXml = serialize(entity);\n    \n    // get our provider Data\n    provider    = getIdpByAccountSysid(_data.getAccountSysid());\n    \n    if ( null == provider) {\n      throw new NotFoundException(NotFoundExceptionType.ACCOUNT);\n    }\n    \n    // update our provider\n    provider.setEntityId(entityId);\n    provider.setMetadataBody(metadataXml);\n    \n    // save data in database\n    metadataStoreDao.saveAndFlush(provider);\n    keystoreMgr.importMetadataCertificates(xml, provider.getUrlContext());\n    \n    // remove existing provider from metadata store\n    removeDelegateFromManager(entityId);\n    \n    // reintroduce delegate to manager\n    loadIdpMetadata(provider);\n         \n  }\n  catch(NotFoundException e) {\n    log.error(&quot;No previous version of IDP registration metadata found to update.&quot;,e);\n    throw (e);\n  }\n  catch (MetadataProviderException e){\n    log.error(&quot;Failed to update Keystore and Signing algorithm of IdP Metadata.&quot;,e);\n    throw new SystemException(&quot;Failed to update certificates.&quot;);\n  }\n  catch(RequiredDataException e) {\n    log.error(&quot;Missing required data for update.&quot;,e);\n    throw(e);\n  }\n\n}\n\n/**\n * Remove the metadata provider from our manager\n */\nprivate void removeDelegateFromManager( String _entityId ) throws MetadataProviderException {\n  ExtendedMetadataDelegate  delegate;\n  DbIdpMetadataProvider     provider;\n  \n  delegate  = findMetadataDelegate(_entityId);\n  \n  if( null == delegate){\n    log.error(&quot;Failed to find Delegate in metadata manager for Entity ID: &quot; + _entityId );\n    return;\n  }\n  \n  metadataManager.removeMetadataProvider(delegate);\n  provider = (DbIdpMetadataProvider)delegate.getDelegate();\n  provider.destroy();\n  metadataManager.setRefreshRequired(true);\n  metadataManager.refreshMetadata();\n\n}    \n\n/**\n * load our provider data to a metadata provider object\n */\nprivate void loadIdpMetadata(IdpProviderData _providerData) throws MetadataProviderException {\n  DbIdpMetadataProvider idpProvider;\n\n  // initialize our IdP provider\n  idpProvider     = new DbIdpMetadataProvider(_providerData);\n  idpProvider.setParserPool(parser);\n  addIdpToMetadataManager(idpProvider);\n\n}\n\n/**\n * Add the metadata provider to our cache\n */\nprivate void addIdpToMetadataManager(DbIdpMetadataProvider _provider) throws MetadataProviderException {\n  ExtendedMetadataDelegate  delegate;\n  ExtendedMetadata          extMeta = new ExtendedMetadata();\n  \n  // initialize our provider\n  _provider.initialize();\n  \n  extMeta     = createExtendedMetadata(_provider);\n\n  delegate    = new ExtendedMetadataDelegate(_provider, extMeta);\n  delegate.setMetadataTrustCheck(false);\n  delegate.initialize();\n  \n  metadataManager.addMetadataProvider(delegate);\n  metadataManager.setRefreshRequired(true);\n  metadataManager.refreshMetadata();\n}\n</code></pre>\n<p>The problem is that when a database entry is refreshed, the new signing certificate defined in the &lt;ds:X509Certificate&gt; element in the IdP metadata is not applied.</p>\n<p>I can see the new certificate when I print out the Metadata XML:</p>\n<hr />\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;!--  new signing key  --&gt;\n&lt;IDPSSODescriptor protocolSupportEnumeration=&quot;urn:oasis:names:tc:SAML:2.0:protocol&quot;&gt;\n    &lt;KeyDescriptor use=&quot;encryption&quot;&gt;\n        &lt;KeyInfo xmlns=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;\n            &lt;X509Data&gt;\n                &lt;X509Certificate&gt;MIIC4jCCAcqgAwIBAgIQafZAY7...&lt;/X509Certificate&gt;\n            &lt;/X509Data&gt;\n        &lt;/KeyInfo&gt;\n    &lt;/KeyDescriptor&gt;\n    &lt;KeyDescriptor use=&quot;signing&quot;&gt;\n        &lt;KeyInfo xmlns=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;\n            &lt;X509Data&gt;\n                &lt;X509Certificate&gt;MIIC3DCCAcSgAwIBAgIQeny6jM...&lt;/X509Certificate&gt;\n            &lt;/X509Data&gt;\n        &lt;/KeyInfo&gt;\n    &lt;/KeyDescriptor&gt;\n    &lt;KeyDescriptor use=&quot;signing&quot;&gt;\n        &lt;KeyInfo xmlns=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;\n            &lt;X509Data&gt;\n                &lt;X509Certificate&gt;MIIC3DCCAcSgAwIBAgIQRtno3W...&lt;/X509Certificate&gt;\n            &lt;/X509Data&gt;\n        &lt;/KeyInfo&gt;\n    &lt;/KeyDescriptor&gt;\n</code></pre>\n<hr />\n<p>I receive a SUCCESS SAML response from my IdP at time of SP initiated sign on:</p>\n<hr />\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;samlp:Response xmlns:samlp=&quot;urn:oasis:names:tc:SAML:2.0:protocol&quot; Consent=&quot;urn:oasis:names:tc:SAML:2.0:consent:unspecified&quot; Destination=&quot;https://{my-domain}:443/eas-saml/saml/SSO&quot; ID=&quot;_0d023fb8-bf24-4b78-b690-c9b53df4db72&quot; InResponseTo=&quot;a22h6bb0gf2e8f314e00316b198ddg1&quot; IssueInstant=&quot;2018-10-17T18:31:47.332Z&quot; Version=&quot;2.0&quot;&gt;\n   &lt;Issuer xmlns=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot;&gt;http://{my-domain}/adfs/services/trust&lt;/Issuer&gt;\n   &lt;samlp:Status&gt;\n      &lt;samlp:StatusCode Value=&quot;urn:oasis:names:tc:SAML:2.0:status:Success&quot;/&gt;\n   &lt;/samlp:Status&gt;\n   &lt;Assertion xmlns=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; ID=&quot;_317d062d-247e-4405-9dd8-0ef3d032bf3f&quot; IssueInstant=&quot;2018-10-17T18:31:47.332Z&quot; Version=&quot;2.0&quot;&gt;\n      &lt;Issuer&gt;http://{my-domain}/adfs/services/trust&lt;/Issuer&gt;\n      &lt;ds:Signature xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;\n         &lt;ds:SignedInfo&gt;\n            &lt;ds:CanonicalizationMethod Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;/&gt;\n            &lt;ds:SignatureMethod Algorithm=&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;/&gt;\n            &lt;ds:Reference URI=&quot;#_8049000b-6e76-416c-84aa-180d61ca359a&quot;&gt;\n               &lt;ds:Transforms&gt;\n                  &lt;ds:Transform Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;/&gt;\n                  &lt;ds:Transform Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;/&gt;\n               &lt;/ds:Transforms&gt;\n               &lt;ds:DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;/&gt;\n               &lt;ds:DigestValue&gt;x/PKyqXDECmE2IBNiZ0pqet3HqQYgDwlbeo1Vb3gXD8=&lt;/ds:DigestValue&gt;\n            &lt;/ds:Reference&gt;\n         &lt;/ds:SignedInfo&gt;\n         &lt;ds:SignatureValue&gt;UvhpsDE7XT1uvqGbA+IZ2sC9t8x0i42/P7tdNXO...&lt;/ds:SignatureValue&gt;\n         &lt;KeyInfo xmlns=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;\n            &lt;ds:X509Data&gt;\n               &lt;ds:X509Certificate&gt;MIIC3DCCAcSgAwIBAgIQRtno3W...&lt;/ds:X509Certificate&gt;\n            &lt;/ds:X509Data&gt;\n         &lt;/KeyInfo&gt;\n      &lt;/ds:Signature&gt;\n      &lt;Subject&gt;\n         &lt;NameID Format=&quot;urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified&quot;&gt;userId&lt;/NameID&gt;\n         &lt;SubjectConfirmation Method=&quot;urn:oasis:names:tc:SAML:2.0:cm:bearer&quot;&gt;\n            &lt;SubjectConfirmationData InResponseTo=&quot;a22h6bb0gf2e8f314e00316b198ddg1&quot; NotOnOrAfter=&quot;2018-10-17T18:36:47.332Z&quot; Recipient=&quot;https://{my-domain}:443/eas-saml/saml/SSO&quot;/&gt;\n         &lt;/SubjectConfirmation&gt;\n      &lt;/Subject&gt;\n      &lt;Conditions NotBefore=&quot;2018-10-17T18:31:47.327Z&quot; NotOnOrAfter=&quot;2018-10-17T18:33:47.327Z&quot;&gt;\n         &lt;AudienceRestriction&gt;\n            &lt;Audience&gt;https://{my-domain}/eas-saml&lt;/Audience&gt;\n         &lt;/AudienceRestriction&gt;\n      &lt;/Conditions&gt;\n      &lt;AttributeStatement&gt;\n         &lt;Attribute Name=&quot;http://schemas.xmlsoap.org/ws/2005/05/identity/claims/upn&quot;&gt;\n            &lt;AttributeValue&gt;userId&lt;/AttributeValue&gt;\n         &lt;/Attribute&gt;\n         &lt;Attribute Name=&quot;http://E-Mail-Addresses&quot;&gt;\n            &lt;AttributeValue&gt;user@domain.com&lt;/AttributeValue&gt;\n         &lt;/Attribute&gt;\n      &lt;/AttributeStatement&gt;\n      &lt;AuthnStatement AuthnInstant=&quot;2018-10-17T18:31:47.233Z&quot; SessionIndex=&quot;_317d062d-247e-4405-9dd8-0ef3d032bf3f&quot;&gt;\n         &lt;AuthnContext&gt;\n            &lt;AuthnContextClassRef&gt;urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport&lt;/AuthnContextClassRef&gt;\n         &lt;/AuthnContext&gt;\n      &lt;/AuthnStatement&gt;\n   &lt;/Assertion&gt;\n&lt;/samlp:Response&gt;\n\n----------\n\nWhere as the log output shows a failure with the following stack trace:\n\n----------\n&lt;pre&gt;\n    2018-10-17 18:31:47 INFO  SAMLDefaultLogger:129 - AuthNResponse;FAILURE;172.17.0.1;https://{my-domain}/eas-saml;http://{my-domain}/adfs/services/trust;;;org.opensaml.common.SAMLException: Response doesn't have any valid assertion which would pass subject validation\n      at org.springframework.security.saml.websso.WebSSOProfileConsumerImpl.processAuthenticationResponse(WebSSOProfileConsumerImpl.java:229)\n      at org.springframework.security.saml.SAMLAuthenticationProvider.authenticate(SAMLAuthenticationProvider.java:88)\n      at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:174)\n      at org.springframework.security.saml.SAMLProcessingFilter.attemptAuthentication(SAMLProcessingFilter.java:92)\n      at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)\n      at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)\n      at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:215)\n      at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)\n      at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)\n      at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:64)\n      at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\n      at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)\n      at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:56)\n      at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\n      at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)\n      at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:105)\n      at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)\n      at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:215)\n      at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:178)\n    Caused by: org.opensaml.xml.validation.ValidationException: Signature is not trusted or invalid\n      at org.springframework.security.saml.websso.AbstractProfileBase.verifySignature(AbstractProfileBase.java:272)\n      at org.springframework.security.saml.websso.WebSSOProfileConsumerImpl.verifyAssertionSignature(WebSSOProfileConsumerImpl.java:419)\n      at org.springframework.security.saml.websso.WebSSOProfileConsumerImpl.verifyAssertion(WebSSOProfileConsumerImpl.java:292)\n      at org.springframework.security.saml.websso.WebSSOProfileConsumerImpl.processAuthenticationResponse(WebSSOProfileConsumerImpl.java:214)\n      ... 39 more\n&lt;/pre&gt;\n----------\n\nIf I restart the service, the signature is recognized and the response is successfully processed.\n\nCan anyone see what I may be doing wrong? Shouldn't a refresh of the metadata manager be enough to allow the new certificates be used? Or is there a step I'm missing?\n</code></pre>\n"},{"tags":["java","floating-point","double","precision","ieee-754"],"comments":[{"owner":{"account_id":1637842,"reputation":155176,"user_id":1708801,"accept_rate":30,"display_name":"Shafik Yaghmour"},"score":1,"creation_date":1373128239,"post_id":17504833,"comment_id":25447631,"body_markdown":"Can you provide the specific example(s) that you are seeing this behavior in? It would be better to show a SSCCE: http://sscce.org/","body":"Can you provide the specific example(s) that you are seeing this behavior in? It would be better to show a SSCCE: <a href=\"http://sscce.org/\" rel=\"nofollow noreferrer\">sscce.org</a>"},{"owner":{"account_id":115344,"reputation":76329,"user_id":302916,"display_name":"Brian Roach"},"score":1,"creation_date":1373128327,"post_id":17504833,"comment_id":25447653,"body_markdown":"One word: **precision**. Technically ... the values aren&#39;t &quot;changing&quot; ;)","body":"One word: <b>precision</b>. Technically ... the values aren&#39;t &quot;changing&quot; ;)"},{"owner":{"account_id":267086,"reputation":62435,"user_id":555045,"accept_rate":100,"display_name":"harold"},"score":3,"creation_date":1373128352,"post_id":17504833,"comment_id":25447657,"body_markdown":"Afaik, that&#39;s impossible. Doubles have both more precision and more range, so you lose neither when casting in that direction. It may print differently, though.","body":"Afaik, that&#39;s impossible. Doubles have both more precision and more range, so you lose neither when casting in that direction. It may print differently, though."}],"answers":[{"tags":[],"owner":{"account_id":1114067,"reputation":196781,"user_id":1103872,"accept_rate":82,"display_name":"Marko Topolnik"},"down_vote_count":1,"up_vote_count":5,"is_accepted":false,"score":4,"last_activity_date":1401866535,"creation_date":1373128472,"answer_id":17504873,"question_id":17504833,"body_markdown":"The conversion from `float` to `double` is a *widening conversion*, as [specified by the JLS](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html). A widening conversion is defined as an injective mapping of a smaller set into its superset. Therefore the number being represented *does not change* after a conversion from `float` to `double`.\n\n## More information regarding your updated question\n\nIn your update you added an example which is supposed to demonstrate that the number has changed. However, it only shows that the *string representation* of the number has changed, which indeed it has due to the additional precision acquired through the conversion to `double`. Note that your first output is just a rounding of the second output. As specified by  `Double.toString`, \n\n&gt; There must be at least one digit to represent the fractional part, and beyond that as many, but only as many, more digits as are needed to uniquely distinguish the argument value from adjacent values of type `double`.\n\nSince the adjacent values in the type `double` are much closer than in `float`, more digits are needed to comply with that ruling.","title":"Why converting from float to double changes the value?","body":"<p>The conversion from <code>float</code> to <code>double</code> is a <em>widening conversion</em>, as <a href=\"http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html\" rel=\"nofollow noreferrer\">specified by the JLS</a>. A widening conversion is defined as an injective mapping of a smaller set into its superset. Therefore the number being represented <em>does not change</em> after a conversion from <code>float</code> to <code>double</code>.</p>\n<h2>More information regarding your updated question</h2>\n<p>In your update you added an example which is supposed to demonstrate that the number has changed. However, it only shows that the <em>string representation</em> of the number has changed, which indeed it has due to the additional precision acquired through the conversion to <code>double</code>. Note that your first output is just a rounding of the second output. As specified by  <code>Double.toString</code>,</p>\n<blockquote>\n<p>There must be at least one digit to represent the fractional part, and beyond that as many, but only as many, more digits as are needed to uniquely distinguish the argument value from adjacent values of type <code>double</code>.</p>\n</blockquote>\n<p>Since the adjacent values in the type <code>double</code> are much closer than in <code>float</code>, more digits are needed to comply with that ruling.</p>\n"},{"tags":[],"owner":{"account_id":1949611,"reputation":5546,"user_id":1754010,"display_name":"Curt"},"down_vote_count":2,"up_vote_count":1,"is_accepted":false,"score":-1,"last_activity_date":1373174526,"creation_date":1373128481,"answer_id":17504874,"question_id":17504833,"body_markdown":"Both are what Microsoft refers to as &quot;approximate number data types.&quot; \r\n\r\nThere&#39;s a reason.   A float has a precision of 7 digits, and a double 15.   But I have seen it happen many times that 8.0 - 1.0 - 6.999999999.  This is because  they are not guaranteed to represent a decimal number fraction exactly.\r\n\r\nIf you need absolute, invariable precision, go with a decimal, or integral type.","title":"Why converting from float to double changes the value?","body":"<p>Both are what Microsoft refers to as \"approximate number data types.\" </p>\n\n<p>There's a reason.   A float has a precision of 7 digits, and a double 15.   But I have seen it happen many times that 8.0 - 1.0 - 6.999999999.  This is because  they are not guaranteed to represent a decimal number fraction exactly.</p>\n\n<p>If you need absolute, invariable precision, go with a decimal, or integral type.</p>\n"},{"tags":[],"owner":{"account_id":34382,"reputation":123977,"user_id":97160,"accept_rate":100,"display_name":"Amro"},"down_vote_count":1,"up_vote_count":2,"is_accepted":false,"score":1,"last_activity_date":1373130874,"creation_date":1373130874,"answer_id":17505230,"question_id":17504833,"body_markdown":"The issue of the precision of floating-point numbers is really language-agnostic, so I&#39;ll be using MATLAB in my explanation.\r\n\r\nThe reason you see a difference is that certain numbers are not exactly representable in fixed number of bits. Take `0.1` for example:\r\n\r\n    &gt;&gt; format hex\r\n    \r\n    &gt;&gt; double(0.1)\r\n    ans =\r\n       3fb999999999999a\r\n\r\n    &gt;&gt; double(single(0.1))\r\n    ans =\r\n       3fb99999a0000000\r\n\r\nSo the error in the approximation of `0.1` in single-precision gets bigger when you cast it as double-precision floating-point number. The result is different from its approximation if you started directly in double-precision.\r\n\r\n    &gt;&gt; double(single(0.1)) - double(0.1)\r\n    ans =\r\n         1.490116113833651e-09\r\n\r\n","title":"Why converting from float to double changes the value?","body":"<p>The issue of the precision of floating-point numbers is really language-agnostic, so I'll be using MATLAB in my explanation.</p>\n\n<p>The reason you see a difference is that certain numbers are not exactly representable in fixed number of bits. Take <code>0.1</code> for example:</p>\n\n<pre><code>&gt;&gt; format hex\n\n&gt;&gt; double(0.1)\nans =\n   3fb999999999999a\n\n&gt;&gt; double(single(0.1))\nans =\n   3fb99999a0000000\n</code></pre>\n\n<p>So the error in the approximation of <code>0.1</code> in single-precision gets bigger when you cast it as double-precision floating-point number. The result is different from its approximation if you started directly in double-precision.</p>\n\n<pre><code>&gt;&gt; double(single(0.1)) - double(0.1)\nans =\n     1.490116113833651e-09\n</code></pre>\n"},{"tags":[],"owner":{"account_id":267086,"reputation":62435,"user_id":555045,"accept_rate":100,"display_name":"harold"},"down_vote_count":1,"up_vote_count":4,"is_accepted":false,"score":3,"last_activity_date":1373132985,"creation_date":1373132985,"answer_id":17505556,"question_id":17504833,"body_markdown":"The 32bit IEEE-754 floating point number closest to 125.32 is in fact 125.31999969482421875. Pretty close, but not quite there (that&#39;s because 0.32 is repeating in binary).\r\n\r\nWhen you cast that to a double, it&#39;s the value 125.31999969482421875 that will be made into a double (125.32 is nowhere to be found at this point, the information that it should really end in .32 is completely lost) and of course can be represented exactly by a double. When you print that double, the print routine thinks it has more significant digits than it really has (but of course it can&#39;t know that), so it prints to 125.31999969482422, which is the shortest decimal that rounds to that exact double (and of all decimals of that length, it is the closest).","title":"Why converting from float to double changes the value?","body":"<p>The 32bit IEEE-754 floating point number closest to 125.32 is in fact 125.31999969482421875. Pretty close, but not quite there (that's because 0.32 is repeating in binary).</p>\n\n<p>When you cast that to a double, it's the value 125.31999969482421875 that will be made into a double (125.32 is nowhere to be found at this point, the information that it should really end in .32 is completely lost) and of course can be represented exactly by a double. When you print that double, the print routine thinks it has more significant digits than it really has (but of course it can't know that), so it prints to 125.31999969482422, which is the shortest decimal that rounds to that exact double (and of all decimals of that length, it is the closest).</p>\n"},{"tags":[],"owner":{"account_id":47225,"reputation":79382,"user_id":139746,"accept_rate":92,"display_name":"Pascal Cuoq"},"down_vote_count":0,"up_vote_count":12,"is_accepted":false,"score":12,"last_activity_date":1373163298,"creation_date":1373159998,"answer_id":17508468,"question_id":17504833,"body_markdown":" 1. When you convert a `float` into a `double`, there is no loss of information. Every `float` can be represented exactly as a `double`.\r\n 2. On the other hand, neither decimal representation printed by `System.out.println` is the exact value for the number. An exact decimal representation could require up to about 760 decimal digits. Instead, `System.out.println` prints exactly the number of decimal digits that allow to parse the decimal representation back into the original `float` or `double`. There are more `double`s, so when printing one, `System.out.println` needs to print more digits before the representation becomes unambiguous.","title":"Why converting from float to double changes the value?","body":"<ol>\n<li>When you convert a <code>float</code> into a <code>double</code>, there is no loss of information. Every <code>float</code> can be represented exactly as a <code>double</code>.</li>\n<li>On the other hand, neither decimal representation printed by <code>System.out.println</code> is the exact value for the number. An exact decimal representation could require up to about 760 decimal digits. Instead, <code>System.out.println</code> prints exactly the number of decimal digits that allow to parse the decimal representation back into the original <code>float</code> or <code>double</code>. There are more <code>double</code>s, so when printing one, <code>System.out.println</code> needs to print more digits before the representation becomes unambiguous.</li>\n</ol>\n"},{"tags":[],"owner":{"account_id":113187,"reputation":200947,"user_id":298225,"accept_rate":100,"display_name":"Eric Postpischil"},"down_vote_count":0,"up_vote_count":17,"is_accepted":false,"score":17,"last_activity_date":1563790959,"creation_date":1373162856,"answer_id":17508660,"question_id":17504833,"body_markdown":"The value of a `float` does not change when converted to a `double`. There is a difference in the displayed numerals because more digits are required to distinguish a `double` value from its neighbors, which is [required by the Java documentation][1]. That is the documentation for `toString`, which is referred (through several links) from the documentation for `println`.\r\n\r\nThe exact value for `125.32f` is 125.3**1999969482421875**. The two neighboring `float` values are 125.3**199920654296875** and 125.3**2000732421875**. Observe that 125.32 is closer to 125.31999969482421875 than to either of the neighbors. Therefore, by displaying “125.32”, Java has displayed enough digits so that conversion back from the decimal numeral to `float` reproduces the value of the `float` passed to `println`.\r\n\r\nThe two neighboring `double` values of 125.3199996948242**1875** are 125.3199996948242**045391452847979962825775146484375** and 125.3199996948242**329608547152020037174224853515625**.  \r\nObserve that 125.32 is closer to the latter neighbor than to the original value (125.31999969482421875). Therefore, printing “125.32” does not contain enough digits to distinguish the original value. Java must print more digits in order to ensure that a conversion from the displayed numeral back to `double` reproduces the value of the `double` passed to `println`.\r\n\r\n\r\n  [1]: https://docs.oracle.com/javase/8/docs/api/java/lang/Float.html#toString-float-","title":"Why converting from float to double changes the value?","body":"<p>The value of a <code>float</code> does not change when converted to a <code>double</code>. There is a difference in the displayed numerals because more digits are required to distinguish a <code>double</code> value from its neighbors, which is <a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/Float.html#toString-float-\" rel=\"nofollow noreferrer\">required by the Java documentation</a>. That is the documentation for <code>toString</code>, which is referred (through several links) from the documentation for <code>println</code>.</p>\n\n<p>The exact value for <code>125.32f</code> is 125.3<strong>1999969482421875</strong>. The two neighboring <code>float</code> values are 125.3<strong>199920654296875</strong> and 125.3<strong>2000732421875</strong>. Observe that 125.32 is closer to 125.31999969482421875 than to either of the neighbors. Therefore, by displaying “125.32”, Java has displayed enough digits so that conversion back from the decimal numeral to <code>float</code> reproduces the value of the <code>float</code> passed to <code>println</code>.</p>\n\n<p>The two neighboring <code>double</code> values of 125.3199996948242<strong>1875</strong> are 125.3199996948242<strong>045391452847979962825775146484375</strong> and 125.3199996948242<strong>329608547152020037174224853515625</strong>.<br>\nObserve that 125.32 is closer to the latter neighbor than to the original value (125.31999969482421875). Therefore, printing “125.32” does not contain enough digits to distinguish the original value. Java must print more digits in order to ensure that a conversion from the displayed numeral back to <code>double</code> reproduces the value of the <code>double</code> passed to <code>println</code>.</p>\n"},{"tags":[],"owner":{"account_id":440158,"reputation":323231,"user_id":829571,"accept_rate":94,"display_name":"assylias"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1378581366,"creation_date":1378581366,"answer_id":18676934,"question_id":17504833,"body_markdown":"As already explained, all floats can be exactly represented as a double and the reason for your issue is that `System.out.println` performs some rounding when displaying the value of a `float` or `double` but the rounding methodology is not the same in both cases.\r\n\r\nTo see the exact value of the float, you can use a `BigDecimal`:\r\n\r\n    float f = 125.32f;\r\n    System.out.println(&quot;value of f = &quot; + new BigDecimal(f));\r\n    double d = (double) 125.32f;\r\n    System.out.println(&quot;value of d = &quot; + new BigDecimal(d));\r\n\r\nwhich outputs:\r\n\r\n    value of f = 125.31999969482421875\r\n    value of d = 125.31999969482421875","title":"Why converting from float to double changes the value?","body":"<p>As already explained, all floats can be exactly represented as a double and the reason for your issue is that <code>System.out.println</code> performs some rounding when displaying the value of a <code>float</code> or <code>double</code> but the rounding methodology is not the same in both cases.</p>\n\n<p>To see the exact value of the float, you can use a <code>BigDecimal</code>:</p>\n\n<pre><code>float f = 125.32f;\nSystem.out.println(\"value of f = \" + new BigDecimal(f));\ndouble d = (double) 125.32f;\nSystem.out.println(\"value of d = \" + new BigDecimal(d));\n</code></pre>\n\n<p>which outputs:</p>\n\n<pre><code>value of f = 125.31999969482421875\nvalue of d = 125.31999969482421875\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4153248,"reputation":1,"user_id":3405112,"display_name":"sekhar beri"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1395205521,"creation_date":1395205521,"answer_id":22496700,"question_id":17504833,"body_markdown":"it won`t work in java because in java by default it will take real values as double and if we declare a float value without float representation\r\nlike\r\n123.45f\r\nby default it will take it as double and it will cause an error as loss of precision ","title":"Why converting from float to double changes the value?","body":"<p>it won`t work in java because in java by default it will take real values as double and if we declare a float value without float representation\nlike\n123.45f\nby default it will take it as double and it will cause an error as loss of precision </p>\n"},{"tags":[],"owner":{"account_id":937533,"reputation":4930,"user_id":966185,"accept_rate":81,"display_name":"Pavel"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1530851381,"creation_date":1530851381,"answer_id":51203047,"question_id":17504833,"body_markdown":"The representation of the values changes due to contracts of the methods that convert numerical values to a `String`, correspondingly `java.lang.Float#toString(float)` and `java.lang.Double#toString(double)`, while the actual value remains the same. There is a common part in Javadoc of both aforementioned methods that elaborates requirements to values&#39; `String` representation:\r\n\r\n&gt; There must be at least one digit to represent the fractional part, and beyond that as many, but only as many, more digits as are needed to uniquely distinguish the argument value from adjacent values\r\n\r\nTo illustrate the similarity of significant parts for values of both types, the following snippet can be run:\r\n\r\n    package com.my.sandbox.numbers;\r\n    \r\n    public class FloatToDoubleConversion {\r\n    \r\n        public static void main(String[] args) {\r\n            float f = 125.32f;\r\n            floatToBits(f);\r\n            double d = (double) f;\r\n            doubleToBits(d);\r\n        }\r\n    \r\n        private static void floatToBits(float floatValue) {\r\n            System.out.println();\r\n            System.out.println(&quot;Float.&quot;);\r\n            System.out.println(&quot;String representation of float: &quot; + floatValue);\r\n            int bits = Float.floatToIntBits(floatValue);\r\n            int sign = bits &gt;&gt;&gt; 31;\r\n            int exponent = (bits &gt;&gt;&gt; 23 &amp; ((1 &lt;&lt; 8) - 1)) - ((1 &lt;&lt; 7) - 1);\r\n            int mantissa = bits &amp; ((1 &lt;&lt; 23) - 1);\r\n            System.out.println(&quot;Bytes: &quot; + Long.toBinaryString(Float.floatToIntBits(floatValue)));\r\n            System.out.println(&quot;Sign: &quot; + Long.toBinaryString(sign));\r\n            System.out.println(&quot;Exponent: &quot; + Long.toBinaryString(exponent));\r\n            System.out.println(&quot;Mantissa: &quot; + Long.toBinaryString(mantissa));\r\n            System.out.println(&quot;Back from parts: &quot; + Float.intBitsToFloat((sign &lt;&lt; 31) | (exponent + ((1 &lt;&lt; 7) - 1)) &lt;&lt; 23 | mantissa));\r\n            System.out.println(10D);\r\n        }\r\n    \r\n        private static void doubleToBits(double doubleValue) {\r\n            System.out.println();\r\n            System.out.println(&quot;Double.&quot;);\r\n            System.out.println(&quot;String representation of double: &quot; + doubleValue);\r\n            long bits = Double.doubleToLongBits(doubleValue);\r\n            long sign = bits &gt;&gt;&gt; 63;\r\n            long exponent = (bits &gt;&gt;&gt; 52 &amp; ((1 &lt;&lt; 11) - 1)) - ((1 &lt;&lt; 10) - 1);\r\n            long mantissa = bits &amp; ((1L &lt;&lt; 52) - 1);\r\n            System.out.println(&quot;Bytes: &quot; + Long.toBinaryString(Double.doubleToLongBits(doubleValue)));\r\n            System.out.println(&quot;Sign: &quot; + Long.toBinaryString(sign));\r\n            System.out.println(&quot;Exponent: &quot; + Long.toBinaryString(exponent));\r\n            System.out.println(&quot;Mantissa: &quot; + Long.toBinaryString(mantissa));\r\n            System.out.println(&quot;Back from parts: &quot; + Double.longBitsToDouble((sign &lt;&lt; 63) | (exponent + ((1 &lt;&lt; 10) - 1)) &lt;&lt; 52 | mantissa));\r\n        }\r\n    }\r\n\r\nIn my environment, the output is:\r\n\r\n    Float.\r\n    String representation of float: 125.32\r\n    Bytes: 1000010111110101010001111010111\r\n    Sign: 0\r\n    Exponent: 110\r\n    Mantissa: 11110101010001111010111\r\n    Back from parts: 125.32\r\n    \r\n    Double.\r\n    String representation of double: 125.31999969482422\r\n    Bytes: 100000001011111010101000111101011100000000000000000000000000000\r\n    Sign: 0\r\n    Exponent: 110\r\n    Mantissa: 1111010101000111101011100000000000000000000000000000\r\n    Back from parts: 125.31999969482422\r\n\r\nThis way, you can see that values&#39; sign, exponent are the same, while its mantissa   was extended retained its significant part (`11110101010001111010111`) exactly the same.\r\n\r\n\r\nThe used extraction logic of floating point number parts: [1][1] and [2][2].\r\n\r\n\r\n  [1]: http://s-j.github.io/java-float/\r\n  [2]: https://www.artima.com/underthehood/floatingP.html","title":"Why converting from float to double changes the value?","body":"<p>The representation of the values changes due to contracts of the methods that convert numerical values to a <code>String</code>, correspondingly <code>java.lang.Float#toString(float)</code> and <code>java.lang.Double#toString(double)</code>, while the actual value remains the same. There is a common part in Javadoc of both aforementioned methods that elaborates requirements to values' <code>String</code> representation:</p>\n\n<blockquote>\n  <p>There must be at least one digit to represent the fractional part, and beyond that as many, but only as many, more digits as are needed to uniquely distinguish the argument value from adjacent values</p>\n</blockquote>\n\n<p>To illustrate the similarity of significant parts for values of both types, the following snippet can be run:</p>\n\n<pre><code>package com.my.sandbox.numbers;\n\npublic class FloatToDoubleConversion {\n\n    public static void main(String[] args) {\n        float f = 125.32f;\n        floatToBits(f);\n        double d = (double) f;\n        doubleToBits(d);\n    }\n\n    private static void floatToBits(float floatValue) {\n        System.out.println();\n        System.out.println(\"Float.\");\n        System.out.println(\"String representation of float: \" + floatValue);\n        int bits = Float.floatToIntBits(floatValue);\n        int sign = bits &gt;&gt;&gt; 31;\n        int exponent = (bits &gt;&gt;&gt; 23 &amp; ((1 &lt;&lt; 8) - 1)) - ((1 &lt;&lt; 7) - 1);\n        int mantissa = bits &amp; ((1 &lt;&lt; 23) - 1);\n        System.out.println(\"Bytes: \" + Long.toBinaryString(Float.floatToIntBits(floatValue)));\n        System.out.println(\"Sign: \" + Long.toBinaryString(sign));\n        System.out.println(\"Exponent: \" + Long.toBinaryString(exponent));\n        System.out.println(\"Mantissa: \" + Long.toBinaryString(mantissa));\n        System.out.println(\"Back from parts: \" + Float.intBitsToFloat((sign &lt;&lt; 31) | (exponent + ((1 &lt;&lt; 7) - 1)) &lt;&lt; 23 | mantissa));\n        System.out.println(10D);\n    }\n\n    private static void doubleToBits(double doubleValue) {\n        System.out.println();\n        System.out.println(\"Double.\");\n        System.out.println(\"String representation of double: \" + doubleValue);\n        long bits = Double.doubleToLongBits(doubleValue);\n        long sign = bits &gt;&gt;&gt; 63;\n        long exponent = (bits &gt;&gt;&gt; 52 &amp; ((1 &lt;&lt; 11) - 1)) - ((1 &lt;&lt; 10) - 1);\n        long mantissa = bits &amp; ((1L &lt;&lt; 52) - 1);\n        System.out.println(\"Bytes: \" + Long.toBinaryString(Double.doubleToLongBits(doubleValue)));\n        System.out.println(\"Sign: \" + Long.toBinaryString(sign));\n        System.out.println(\"Exponent: \" + Long.toBinaryString(exponent));\n        System.out.println(\"Mantissa: \" + Long.toBinaryString(mantissa));\n        System.out.println(\"Back from parts: \" + Double.longBitsToDouble((sign &lt;&lt; 63) | (exponent + ((1 &lt;&lt; 10) - 1)) &lt;&lt; 52 | mantissa));\n    }\n}\n</code></pre>\n\n<p>In my environment, the output is:</p>\n\n<pre><code>Float.\nString representation of float: 125.32\nBytes: 1000010111110101010001111010111\nSign: 0\nExponent: 110\nMantissa: 11110101010001111010111\nBack from parts: 125.32\n\nDouble.\nString representation of double: 125.31999969482422\nBytes: 100000001011111010101000111101011100000000000000000000000000000\nSign: 0\nExponent: 110\nMantissa: 1111010101000111101011100000000000000000000000000000\nBack from parts: 125.31999969482422\n</code></pre>\n\n<p>This way, you can see that values' sign, exponent are the same, while its mantissa   was extended retained its significant part (<code>11110101010001111010111</code>) exactly the same.</p>\n\n<p>The used extraction logic of floating point number parts: <a href=\"http://s-j.github.io/java-float/\" rel=\"nofollow noreferrer\">1</a> and <a href=\"https://www.artima.com/underthehood/floatingP.html\" rel=\"nofollow noreferrer\">2</a>.</p>\n"},{"tags":[],"owner":{"account_id":20484963,"reputation":35,"user_id":15032355,"display_name":"FredWoozley"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694779842,"creation_date":1694779842,"answer_id":77112265,"question_id":17504833,"body_markdown":"The other answers explain the background of why the numbers differ. That is great. However, if you need a pragmatic way to convert from float to double or the other way around without suddenly ending up with a different representation you can use the string representation as a translation stepping stone, i.e. you can do\r\n\r\n```\r\nfloat f = 125.32f;\r\nSystem.out.println(&quot;value of f = &quot; + f);\r\ndouble d = Double.valueOf(String.valueOf(125.32f)); \r\nSystem.out.println(&quot;value of d = &quot; + d);\r\n\r\n```\r\n\r\nThis will print\r\n\r\n```\r\nvalue of f = 125.32\r\nvalue of d = 125.32\r\n```\r\n\r\nNote: Performance-wise and for calculations this is not recommended, but it can be helpful if you need to convert back and forth on a UI level and don&#39;t want to surprise a user with unexpected value changes. E.g. if they type something as float and you want to be sure to have what they typed as a double at another point - then the double value will be based off what he user typed rather off what the float interpretation of their typed value was. In such cases it can make sense you should however make sure to not mix different such interpretations then and assume they are the &quot;same actual value&quot;. ","title":"Why converting from float to double changes the value?","body":"<p>The other answers explain the background of why the numbers differ. That is great. However, if you need a pragmatic way to convert from float to double or the other way around without suddenly ending up with a different representation you can use the string representation as a translation stepping stone, i.e. you can do</p>\n<pre><code>float f = 125.32f;\nSystem.out.println(&quot;value of f = &quot; + f);\ndouble d = Double.valueOf(String.valueOf(125.32f)); \nSystem.out.println(&quot;value of d = &quot; + d);\n\n</code></pre>\n<p>This will print</p>\n<pre><code>value of f = 125.32\nvalue of d = 125.32\n</code></pre>\n<p>Note: Performance-wise and for calculations this is not recommended, but it can be helpful if you need to convert back and forth on a UI level and don't want to surprise a user with unexpected value changes. E.g. if they type something as float and you want to be sure to have what they typed as a double at another point - then the double value will be based off what he user typed rather off what the float interpretation of their typed value was. In such cases it can make sense you should however make sure to not mix different such interpretations then and assume they are the &quot;same actual value&quot;.</p>\n"}],"owner":{"account_id":3013835,"reputation":737,"user_id":2556592,"accept_rate":50,"display_name":"arthursfreire"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":34447,"favorite_count":0,"down_vote_count":4,"up_vote_count":28,"answer_count":10,"score":24,"last_activity_date":1694779842,"creation_date":1373128173,"question_id":17504833,"body_markdown":"I&#39;ve been trying to find out the reason, but I couldn&#39;t.\r\nCan anybody help me?\r\n\r\nLook at the following example.\r\n\r\n    float f = 125.32f;\r\n    System.out.println(&quot;value of f = &quot; + f);\r\n    double d = (double) 125.32f; \r\n    System.out.println(&quot;value of d = &quot; + d);\r\n\r\nThis is the output:\r\n\r\n&lt;!-- language: lang-none --&gt;\r\n\r\n    value of f = 125.32\r\n    value of d = 125.31999969482422","title":"Why converting from float to double changes the value?","body":"<p>I've been trying to find out the reason, but I couldn't.\nCan anybody help me?</p>\n\n<p>Look at the following example.</p>\n\n<pre><code>float f = 125.32f;\nSystem.out.println(\"value of f = \" + f);\ndouble d = (double) 125.32f; \nSystem.out.println(\"value of d = \" + d);\n</code></pre>\n\n<p>This is the output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>value of f = 125.32\nvalue of d = 125.31999969482422\n</code></pre>\n"},{"tags":["java","spring","spring-boot","spring-data-jpa","spring-data"],"comments":[{"owner":{"account_id":1223835,"reputation":75848,"user_id":1189885,"accept_rate":43,"display_name":"chrylis -cautiouslyoptimistic-"},"score":1,"creation_date":1569985627,"post_id":58194552,"comment_id":102768202,"body_markdown":"(1) `applicationContext.xml` is obsolete with Spring Boot. (2) Package names should use all lowercase; compare with your import statements. (3) `@ComponentScan` and similar configuration annotations are only activated when present on `@Configuration` classes (`@SpringBootApplication` includes that). (4) You need `@EnableJpaRepositories` on your configuration (`Application`).","body":"(1) <code>applicationContext.xml</code> is obsolete with Spring Boot. (2) Package names should use all lowercase; compare with your import statements. (3) <code>@ComponentScan</code> and similar configuration annotations are only activated when present on <code>@Configuration</code> classes (<code>@SpringBootApplication</code> includes that). (4) You need <code>@EnableJpaRepositories</code> on your configuration (<code>Application</code>)."},{"owner":{"account_id":4513420,"reputation":421,"user_id":3668936,"accept_rate":45,"display_name":"Tyler B. Joudrey"},"score":0,"creation_date":1569986081,"post_id":58194552,"comment_id":102768254,"body_markdown":"I implemented the changes you suggested and I am still getting the same result","body":"I implemented the changes you suggested and I am still getting the same result"},{"owner":{"account_id":1223835,"reputation":75848,"user_id":1189885,"accept_rate":43,"display_name":"chrylis -cautiouslyoptimistic-"},"score":0,"creation_date":1569988968,"post_id":58194552,"comment_id":102768740,"body_markdown":"Please update your error message.","body":"Please update your error message."},{"owner":{"account_id":4513420,"reputation":421,"user_id":3668936,"accept_rate":45,"display_name":"Tyler B. Joudrey"},"score":0,"creation_date":1569989637,"post_id":58194552,"comment_id":102768849,"body_markdown":"I updated the error message, I believe it is the same","body":"I updated the error message, I believe it is the same"},{"owner":{"account_id":1223835,"reputation":75848,"user_id":1189885,"accept_rate":43,"display_name":"chrylis -cautiouslyoptimistic-"},"score":0,"creation_date":1569989792,"post_id":58194552,"comment_id":102768876,"body_markdown":"Okay, please include your `pom.xml` or `build.gradle` file and show your directory structure (ASCII art is the usual way). You also might want to try `@ComponentScan({&quot;controllers&quot;, &quot;repositories&quot;}) @EntityScan(&quot;models&quot;)`; I don&#39;t remember off the top of my head whether `@EnableJpaRepositories` will find a type that&#39;s not already component-scanned (it should, but I&#39;m not certain).","body":"Okay, please include your <code>pom.xml</code> or <code>build.gradle</code> file and show your directory structure (ASCII art is the usual way). You also might want to try <code>@ComponentScan({&quot;controllers&quot;, &quot;repositories&quot;}) @EntityScan(&quot;models&quot;)</code>; I don&#39;t remember off the top of my head whether <code>@EnableJpaRepositories</code> will find a type that&#39;s not already component-scanned (it should, but I&#39;m not certain)."},{"owner":{"account_id":4513420,"reputation":421,"user_id":3668936,"accept_rate":45,"display_name":"Tyler B. Joudrey"},"score":0,"creation_date":1569990256,"post_id":58194552,"comment_id":102768937,"body_markdown":"I added the pom.xml and updated the structure to remove the need for the componentScan decorator","body":"I added the pom.xml and updated the structure to remove the need for the componentScan decorator"},{"owner":{"account_id":3192259,"reputation":117599,"user_id":2696260,"display_name":"M. Deinum"},"score":0,"creation_date":1569998571,"post_id":58194552,"comment_id":102771096,"body_markdown":"Remove `@EnableJpaRepositories`, as that is enabled by Spring Boot already. Remove the hibernate and spring-data-jpa dependencies and instead add the `spring-boot-starter-data-jpa` dependency. Also the junit dependency is already included in the `spring-boot-starter-test` dependency remove that as well (as it is an ancient version).","body":"Remove <code>@EnableJpaRepositories</code>, as that is enabled by Spring Boot already. Remove the hibernate and spring-data-jpa dependencies and instead add the <code>spring-boot-starter-data-jpa</code> dependency. Also the junit dependency is already included in the <code>spring-boot-starter-test</code> dependency remove that as well (as it is an ancient version)."},{"owner":{"account_id":13318942,"reputation":3000,"user_id":9614331,"display_name":"Avijit Barua"},"score":0,"creation_date":1570007091,"post_id":58194552,"comment_id":102774970,"body_markdown":"@TylerB.Joudrey, Do as M. Deinum said, And check my answer also.","body":"@TylerB.Joudrey, Do as M. Deinum said, And check my answer also."},{"owner":{"account_id":4513420,"reputation":421,"user_id":3668936,"accept_rate":45,"display_name":"Tyler B. Joudrey"},"score":0,"creation_date":1570068585,"post_id":58194552,"comment_id":102800176,"body_markdown":"I followed the suggestions made and I now have a new error, the question and files have been updated","body":"I followed the suggestions made and I now have a new error, the question and files have been updated"},{"owner":{"account_id":13318942,"reputation":3000,"user_id":9614331,"display_name":"Avijit Barua"},"score":0,"creation_date":1570077844,"post_id":58194552,"comment_id":102801694,"body_markdown":"@TylerB.Joudrey I have modified my answer. Please let me know whether it works or not.","body":"@TylerB.Joudrey I have modified my answer. Please let me know whether it works or not."},{"owner":{"account_id":13318942,"reputation":3000,"user_id":9614331,"display_name":"Avijit Barua"},"score":0,"creation_date":1570175319,"post_id":58194552,"comment_id":102837921,"body_markdown":"@TylerB.Joudrey Have you checked my answer ?","body":"@TylerB.Joudrey Have you checked my answer ?"}],"answers":[{"tags":[],"owner":{"account_id":16807537,"reputation":207,"user_id":12151306,"display_name":"Steven Diamante"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1605850679,"creation_date":1569989387,"answer_id":58195093,"question_id":58194552,"body_markdown":"It may be beneficial for you to fix your package structure. If your main application is at a package called my.base and your controller is at my.base.controllers then you won&#39;t have to use the component scans. My suggestion in the current state is to add the repositories package to the component scan so it will find the bean at runtime.\r\n\r\n    @ComponentScan({&quot;controllers&quot;, &quot;reposistories&quot;})","title":"How to fix: Error creating bean with name : Unsatisfied dependency expressed through field","body":"<p>It may be beneficial for you to fix your package structure. If your main application is at a package called my.base and your controller is at my.base.controllers then you won't have to use the component scans. My suggestion in the current state is to add the repositories package to the component scan so it will find the bean at runtime.</p>\n<pre><code>@ComponentScan({&quot;controllers&quot;, &quot;reposistories&quot;})\n</code></pre>\n"},{"tags":[],"owner":{"account_id":11377012,"reputation":12762,"user_id":8340997,"display_name":"Anish B."},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1569998864,"creation_date":1569997958,"answer_id":58196270,"question_id":58194552,"body_markdown":"**First, you don&#39;t have an appropriate project packaging structure. Then, you don&#39;t have a base package. Spring always mentions to have a base package for proper component scans. Without base package, it&#39;s a bad practice.**\r\n\r\nThe best practice should be like :\r\n\r\n    src\r\n    -main\r\n    --base package(x.x.x.) (for example : com.project)\r\n    ---controllers\r\n    ---models\r\n    ---repositories\r\n    -resources\r\n\r\n1. Xml - Based config :\r\n\r\n    `&lt;context:component-scan base-package=&quot;com.project&quot; /&gt;`\r\n\r\n2. Annotation or Java- based config :\r\n\r\n    `@ComponentScan(&quot;com.project&quot;)`\r\n\r\nSecondly, if you have these kind of package, on a contrary, you have to mention package names separately.\r\n\r\nYou have to do it like this :\r\n\r\n1. Xml - Based config :\r\n\r\n    `&lt;context:component-scan base-package=&quot;main.controllers, main.repositories&quot; /&gt;`\r\n\r\n2. Annotation or Java- based config :\r\n\r\n    `@ComponentScan({&quot;main.controllers&quot;, &quot;main.repositories&quot;})`\r\n\r\nMoreover, you are having a spring-boot project. So what you do is add @ComponentScan in the `Application` class :\r\n\r\n    @ComponentScan({&quot;main.controllers&quot;, &quot;main.repositories&quot;})\r\n    @EnableJpaRepositories(&quot;main.repositories&quot;)\r\n    @SpringBootApplication\r\n    public class Application {\r\n      public static void main(String[] args) {\r\n         SpringApplication.run(Application.class, args);\r\n      }\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","title":"How to fix: Error creating bean with name : Unsatisfied dependency expressed through field","body":"<p><strong>First, you don't have an appropriate project packaging structure. Then, you don't have a base package. Spring always mentions to have a base package for proper component scans. Without base package, it's a bad practice.</strong></p>\n\n<p>The best practice should be like :</p>\n\n<pre><code>src\n-main\n--base package(x.x.x.) (for example : com.project)\n---controllers\n---models\n---repositories\n-resources\n</code></pre>\n\n<ol>\n<li><p>Xml - Based config :</p>\n\n<p><code>&lt;context:component-scan base-package=\"com.project\" /&gt;</code></p></li>\n<li><p>Annotation or Java- based config :</p>\n\n<p><code>@ComponentScan(\"com.project\")</code></p></li>\n</ol>\n\n<p>Secondly, if you have these kind of package, on a contrary, you have to mention package names separately.</p>\n\n<p>You have to do it like this :</p>\n\n<ol>\n<li><p>Xml - Based config :</p>\n\n<p><code>&lt;context:component-scan base-package=\"main.controllers, main.repositories\" /&gt;</code></p></li>\n<li><p>Annotation or Java- based config :</p>\n\n<p><code>@ComponentScan({\"main.controllers\", \"main.repositories\"})</code></p></li>\n</ol>\n\n<p>Moreover, you are having a spring-boot project. So what you do is add @ComponentScan in the <code>Application</code> class :</p>\n\n<pre><code>@ComponentScan({\"main.controllers\", \"main.repositories\"})\n@EnableJpaRepositories(\"main.repositories\")\n@SpringBootApplication\npublic class Application {\n  public static void main(String[] args) {\n     SpringApplication.run(Application.class, args);\n  }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":13318942,"reputation":3000,"user_id":9614331,"display_name":"Avijit Barua"},"down_vote_count":0,"up_vote_count":11,"is_accepted":true,"score":11,"last_activity_date":1570077805,"creation_date":1570006951,"answer_id":58198400,"question_id":58194552,"body_markdown":"In your `User` class you declare id with `int` type  \r\n\r\n    @Id\r\n    @Column(name = &quot;id&quot;, unique = true)\r\n    private int id;\r\n\r\nBut in the repository interface, you declared `Long`\r\n\r\n    public interface UserRepository extends JpaRepository&lt;User, Long&gt; {}\r\n\r\nSo, in `User` class change type of id like,\r\n\r\n    @Id\r\n    @Column(name = &quot;id&quot;, unique = true)\r\n    private Long id;\r\n\r\n\r\nAnd avoid your new error, use `@Service` annotation at `UserService` interface like \r\n\r\n    @Service\r\n    public interface UserService {\r\n        List&lt;User&gt; getUsers();\r\n    }","title":"How to fix: Error creating bean with name : Unsatisfied dependency expressed through field","body":"<p>In your <code>User</code> class you declare id with <code>int</code> type  </p>\n\n<pre><code>@Id\n@Column(name = \"id\", unique = true)\nprivate int id;\n</code></pre>\n\n<p>But in the repository interface, you declared <code>Long</code></p>\n\n<pre><code>public interface UserRepository extends JpaRepository&lt;User, Long&gt; {}\n</code></pre>\n\n<p>So, in <code>User</code> class change type of id like,</p>\n\n<pre><code>@Id\n@Column(name = \"id\", unique = true)\nprivate Long id;\n</code></pre>\n\n<p>And avoid your new error, use <code>@Service</code> annotation at <code>UserService</code> interface like </p>\n\n<pre><code>@Service\npublic interface UserService {\n    List&lt;User&gt; getUsers();\n}\n</code></pre>\n"}],"owner":{"account_id":4513420,"reputation":421,"user_id":3668936,"accept_rate":45,"display_name":"Tyler B. Joudrey"},"comment_count":11,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":148545,"favorite_count":0,"down_vote_count":0,"up_vote_count":11,"accepted_answer_id":58198400,"answer_count":3,"score":11,"last_activity_date":1694779632,"creation_date":1569983985,"question_id":58194552,"body_markdown":"I am trying to set up a spring rest api using hibernate. When trying to use the userRespository I set up I am getting this error\r\n\r\n```\r\norg.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;userController&#39;: Unsatisfied dependency expressed through field &#39;userService&#39;; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;userServiceImpl&#39;: Unsatisfied dependency expressed through field &#39;userRepository&#39;; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;userRepository&#39;: Invocation of init method failed; nested exception is java.lang.IllegalArgumentException: Not a managed type: class com.potholeapi.models.User\r\n\tat org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:596) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\r\n\tat org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:90) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\r\n\tat org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:374) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1411) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:592) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:515) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\r\n\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:845) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\r\n\tat org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:877) ~[spring-context-5.1.8.RELEASE.jar:5.1.8.RELEASE]\r\n\tat org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:549) ~[spring-context-5.1.8.RELEASE.jar:5.1.8.RELEASE]\r\n\tat org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:140) ~[spring-boot-2.1.6.RELEASE.jar:2.1.6.RELEASE]\r\n\tat org.springframework.boot.SpringApplication.refresh(SpringApplication.java:742) ~[spring-boot-2.1.6.RELEASE.jar:2.1.6.RELEASE]\r\n\tat org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:389) ~[spring-boot-2.1.6.RELEASE.jar:2.1.6.RELEASE]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:311) ~[spring-boot-2.1.6.RELEASE.jar:2.1.6.RELEASE]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1213) ~[spring-boot-2.1.6.RELEASE.jar:2.1.6.RELEASE]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1202) ~[spring-boot-2.1.6.RELEASE.jar:2.1.6.RELEASE]\r\n\tat com.potholeapi.Application.main(Application.java:20) ~[classes/:na]\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]\r\n\tat org.springframework.boot.maven.AbstractRunMojo$LaunchRunner.run(AbstractRunMojo.java:542) ~[na:na]\r\n\tat java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]\r\n```\r\n\r\nHere are the Model, Controller and Application Files\r\n\r\nModel\r\n```\r\npackage com.potholeapi.models;\r\n\r\nimport org.hibernate.annotations.Entity;\r\nimport org.springframework.data.jpa.domain.support.AuditingEntityListener;\r\n\r\nimport java.io.Serializable;\r\nimport javax.persistence.*;\r\n\r\n@Entity\r\n@Table(name = &quot;User&quot;)\r\npublic class User implements Serializable{\r\n\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    @Id\r\n    @Column(name = &quot;id&quot;, unique = true)\r\n    private Long id;\r\n\r\n    @Column(name = &quot;name&quot;, unique = true)\r\n    private String name;\r\n\r\n    @Column(name = &quot;created_date&quot;)\r\n    private int created_date;\r\n\r\n    public Long getId() {\r\n        return id;\r\n    }\r\n\r\n    public void setId(Long id) {\r\n        this.id = id;\r\n    }\r\n\r\n    public String getName() {\r\n        return name;\r\n    }\r\n\r\n    public void setName(String name) {\r\n        this.name = name;\r\n    }\r\n\r\n    public int getCreated_date() {\r\n        return created_date;\r\n    }\r\n\r\n    public void setCreated_date(int created_date) {\r\n        this.created_date = created_date;\r\n    }\r\n}\r\n\r\n```\r\n\r\nController\r\n\r\n```\r\npackage com.potholeapi.controllers;\r\n\r\nimport com.potholeapi.repositories.UserRepository;\r\nimport com.potholeapi.services.UserService;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.web.bind.annotation.GetMapping;\r\nimport org.springframework.web.bind.annotation.RestController;\r\n\r\nimport com.potholeapi.models.User;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\n@RestController\r\npublic class UserController {\r\n    @Autowired\r\n    private UserService userService;\r\n\r\n    /**\r\n     * Get all users list.\r\n     *\r\n     * @return the list\r\n     */\r\n    @GetMapping(&quot;/users&quot;)\r\n    public List&lt;User&gt; getAllUsers() {\r\n        return  userService.getUsers();\r\n    }\r\n}\r\n\r\n```\r\n\r\nRepository\r\n```\r\npackage com.potholeapi.repositories;\r\n\r\nimport com.potholeapi.models.User;\r\nimport org.springframework.data.jpa.repository.JpaRepository;\r\nimport org.springframework.stereotype.Repository;\r\n\r\n@Repository\r\npublic interface UserRepository extends JpaRepository&lt;User, Long&gt; {}\r\n\r\n```\r\nService\r\n```\r\npackage com.potholeapi.services;\r\n\r\nimport com.potholeapi.models.User;\r\n\r\nimport java.util.List;\r\nimport java.util.Optional;\r\n\r\npublic interface UserService {\r\n    List&lt;User&gt; getUsers();\r\n}\r\n\r\n```\r\nServiceImpl\r\n```\r\npackage com.potholeapi.services.impl;\r\n\r\nimport com.potholeapi.models.User;\r\nimport com.potholeapi.repositories.UserRepository;\r\nimport com.potholeapi.services.UserService;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.stereotype.Service;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\nimport java.util.Optional;\r\n\r\n@Service\r\npublic class UserServiceImpl implements UserService {\r\n    @Autowired\r\n    private UserRepository userRepository;\r\n\r\n    @Override\r\n    public List&lt;User&gt; getUsers(){\r\n        List&lt;User&gt; out = new ArrayList&lt;User&gt;();\r\n        userRepository.findAll().forEach(user -&gt; out.add(user));\r\n        return out;\r\n    }\r\n}\r\n```\r\n\r\n\r\nApplication\r\n```\r\npackage com.potholeapi;\r\n\r\nimport org.springframework.boot.SpringApplication;\r\nimport org.springframework.boot.autoconfigure.EnableAutoConfiguration;\r\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\r\nimport org.springframework.boot.autoconfigure.domain.EntityScan;\r\nimport org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration;\r\nimport org.springframework.context.annotation.ComponentScan;\r\nimport org.springframework.context.annotation.Configuration;\r\nimport org.springframework.data.jpa.repository.config.EnableJpaRepositories;\r\nimport org.springframework.transaction.annotation.EnableTransactionManagement;\r\n\r\n@Configuration\r\n@EntityScan\r\n@EnableJpaRepositories(basePackages = &quot;com.potholeapi.repositories&quot;)\r\n@EnableTransactionManagement\r\n@SpringBootApplication\r\npublic class Application {\r\n    public static void main(String[] args) {\r\n        SpringApplication.run(Application.class, args);\r\n    }\r\n}\r\n\r\n```\r\n\r\npom.xml\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n\r\n    &lt;groupId&gt;org.springframework&lt;/groupId&gt;\r\n    &lt;artifactId&gt;gs-rest-service&lt;/artifactId&gt;\r\n    &lt;version&gt;0.1.0&lt;/version&gt;\r\n    &lt;name&gt;potholeAPI&lt;/name&gt;\r\n\r\n    &lt;parent&gt;\r\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\r\n        &lt;version&gt;2.1.6.RELEASE&lt;/version&gt;\r\n    &lt;/parent&gt;\r\n\r\n    &lt;dependencies&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n        &lt;/dependency&gt;\r\n\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;com.jayway.jsonpath&lt;/groupId&gt;\r\n            &lt;artifactId&gt;json-path&lt;/artifactId&gt;\r\n            &lt;scope&gt;test&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\n\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;mysql&lt;/groupId&gt;\r\n            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\r\n            &lt;version&gt;8.0.15&lt;/version&gt;\r\n            &lt;scope&gt;provided&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\n\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;junit&lt;/groupId&gt;\r\n            &lt;artifactId&gt;junit&lt;/artifactId&gt;\r\n            &lt;version&gt;3.8.1&lt;/version&gt;\r\n            &lt;scope&gt;test&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\n\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;com.h2database&lt;/groupId&gt;\r\n            &lt;artifactId&gt;h2&lt;/artifactId&gt;\r\n            &lt;scope&gt;runtime&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\n\r\n        &lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-data-jpa --&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\r\n            &lt;version&gt;2.1.8.RELEASE&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n\r\n    &lt;/dependencies&gt;\r\n\r\n    &lt;properties&gt;\r\n        &lt;java.version&gt;1.8&lt;/java.version&gt;\r\n    &lt;/properties&gt;\r\n\r\n\r\n    &lt;build&gt;\r\n        &lt;plugins&gt;\r\n            &lt;plugin&gt;\r\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n            &lt;/plugin&gt;\r\n        &lt;/plugins&gt;\r\n    &lt;/build&gt;\r\n\r\n&lt;/project&gt;\r\n```\r\napplication.properties\r\n```\r\nspring.datasource.url = jdbc:mysql://localhost:3306/PotholeDB?useUnicode=true&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=UTC\r\nspring.datasource.username = admin\r\nspring.datasource.password = admin\r\n\r\nspring.jpa.properties.hibernate.dialect = org.hibernate.dialect.MariaDB53Dialect\r\n\r\nspring.jpa.hibernate.ddl-auto = update\r\n\r\n```\r\n\r\ndirectory structure\r\n```\r\nsrc\r\n-main\r\n--java\r\n---com.potholeapi\r\n----controllers\r\n----models\r\n----repositories\r\n----services\r\n-----impl\r\n-resources\r\npom.xml\r\n```\r\nWhat have I missed in setting this up? From all of the tutorials i have looked at online autowired is supposed to work oujt of the box","title":"How to fix: Error creating bean with name : Unsatisfied dependency expressed through field","body":"<p>I am trying to set up a spring rest api using hibernate. When trying to use the userRespository I set up I am getting this error</p>\n\n<pre><code>org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'userController': Unsatisfied dependency expressed through field 'userService'; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'userServiceImpl': Unsatisfied dependency expressed through field 'userRepository'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userRepository': Invocation of init method failed; nested exception is java.lang.IllegalArgumentException: Not a managed type: class com.potholeapi.models.User\n    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:596) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\n    at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:90) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\n    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:374) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1411) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:592) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:515) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:845) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE]\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:877) ~[spring-context-5.1.8.RELEASE.jar:5.1.8.RELEASE]\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:549) ~[spring-context-5.1.8.RELEASE.jar:5.1.8.RELEASE]\n    at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:140) ~[spring-boot-2.1.6.RELEASE.jar:2.1.6.RELEASE]\n    at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:742) ~[spring-boot-2.1.6.RELEASE.jar:2.1.6.RELEASE]\n    at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:389) ~[spring-boot-2.1.6.RELEASE.jar:2.1.6.RELEASE]\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:311) ~[spring-boot-2.1.6.RELEASE.jar:2.1.6.RELEASE]\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:1213) ~[spring-boot-2.1.6.RELEASE.jar:2.1.6.RELEASE]\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:1202) ~[spring-boot-2.1.6.RELEASE.jar:2.1.6.RELEASE]\n    at com.potholeapi.Application.main(Application.java:20) ~[classes/:na]\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]\n    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]\n    at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]\n    at org.springframework.boot.maven.AbstractRunMojo$LaunchRunner.run(AbstractRunMojo.java:542) ~[na:na]\n    at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]\n</code></pre>\n\n<p>Here are the Model, Controller and Application Files</p>\n\n<p>Model</p>\n\n<pre><code>package com.potholeapi.models;\n\nimport org.hibernate.annotations.Entity;\nimport org.springframework.data.jpa.domain.support.AuditingEntityListener;\n\nimport java.io.Serializable;\nimport javax.persistence.*;\n\n@Entity\n@Table(name = \"User\")\npublic class User implements Serializable{\n\n    private static final long serialVersionUID = 1L;\n\n    @Id\n    @Column(name = \"id\", unique = true)\n    private Long id;\n\n    @Column(name = \"name\", unique = true)\n    private String name;\n\n    @Column(name = \"created_date\")\n    private int created_date;\n\n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public int getCreated_date() {\n        return created_date;\n    }\n\n    public void setCreated_date(int created_date) {\n        this.created_date = created_date;\n    }\n}\n\n</code></pre>\n\n<p>Controller</p>\n\n<pre><code>package com.potholeapi.controllers;\n\nimport com.potholeapi.repositories.UserRepository;\nimport com.potholeapi.services.UserService;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\nimport com.potholeapi.models.User;\n\nimport java.util.ArrayList;\nimport java.util.List;\n\n@RestController\npublic class UserController {\n    @Autowired\n    private UserService userService;\n\n    /**\n     * Get all users list.\n     *\n     * @return the list\n     */\n    @GetMapping(\"/users\")\n    public List&lt;User&gt; getAllUsers() {\n        return  userService.getUsers();\n    }\n}\n\n</code></pre>\n\n<p>Repository</p>\n\n<pre><code>package com.potholeapi.repositories;\n\nimport com.potholeapi.models.User;\nimport org.springframework.data.jpa.repository.JpaRepository;\nimport org.springframework.stereotype.Repository;\n\n@Repository\npublic interface UserRepository extends JpaRepository&lt;User, Long&gt; {}\n\n</code></pre>\n\n<p>Service</p>\n\n<pre><code>package com.potholeapi.services;\n\nimport com.potholeapi.models.User;\n\nimport java.util.List;\nimport java.util.Optional;\n\npublic interface UserService {\n    List&lt;User&gt; getUsers();\n}\n\n</code></pre>\n\n<p>ServiceImpl</p>\n\n<pre><code>package com.potholeapi.services.impl;\n\nimport com.potholeapi.models.User;\nimport com.potholeapi.repositories.UserRepository;\nimport com.potholeapi.services.UserService;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Service;\n\nimport java.util.ArrayList;\nimport java.util.List;\nimport java.util.Optional;\n\n@Service\npublic class UserServiceImpl implements UserService {\n    @Autowired\n    private UserRepository userRepository;\n\n    @Override\n    public List&lt;User&gt; getUsers(){\n        List&lt;User&gt; out = new ArrayList&lt;User&gt;();\n        userRepository.findAll().forEach(user -&gt; out.add(user));\n        return out;\n    }\n}\n</code></pre>\n\n<p>Application</p>\n\n<pre><code>package com.potholeapi;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.EnableAutoConfiguration;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.boot.autoconfigure.domain.EntityScan;\nimport org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration;\nimport org.springframework.context.annotation.ComponentScan;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.data.jpa.repository.config.EnableJpaRepositories;\nimport org.springframework.transaction.annotation.EnableTransactionManagement;\n\n@Configuration\n@EntityScan\n@EnableJpaRepositories(basePackages = \"com.potholeapi.repositories\")\n@EnableTransactionManagement\n@SpringBootApplication\npublic class Application {\n    public static void main(String[] args) {\n        SpringApplication.run(Application.class, args);\n    }\n}\n\n</code></pre>\n\n<p>pom.xml</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n    &lt;artifactId&gt;gs-rest-service&lt;/artifactId&gt;\n    &lt;version&gt;0.1.0&lt;/version&gt;\n    &lt;name&gt;potholeAPI&lt;/name&gt;\n\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;2.1.6.RELEASE&lt;/version&gt;\n    &lt;/parent&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.jayway.jsonpath&lt;/groupId&gt;\n            &lt;artifactId&gt;json-path&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;mysql&lt;/groupId&gt;\n            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\n            &lt;version&gt;8.0.15&lt;/version&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;junit&lt;/groupId&gt;\n            &lt;artifactId&gt;junit&lt;/artifactId&gt;\n            &lt;version&gt;3.8.1&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.h2database&lt;/groupId&gt;\n            &lt;artifactId&gt;h2&lt;/artifactId&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-data-jpa --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n            &lt;version&gt;2.1.8.RELEASE&lt;/version&gt;\n        &lt;/dependency&gt;\n\n    &lt;/dependencies&gt;\n\n    &lt;properties&gt;\n        &lt;java.version&gt;1.8&lt;/java.version&gt;\n    &lt;/properties&gt;\n\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n</code></pre>\n\n<p>application.properties</p>\n\n<pre><code>spring.datasource.url = jdbc:mysql://localhost:3306/PotholeDB?useUnicode=true&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=UTC\nspring.datasource.username = admin\nspring.datasource.password = admin\n\nspring.jpa.properties.hibernate.dialect = org.hibernate.dialect.MariaDB53Dialect\n\nspring.jpa.hibernate.ddl-auto = update\n\n</code></pre>\n\n<p>directory structure</p>\n\n<pre><code>src\n-main\n--java\n---com.potholeapi\n----controllers\n----models\n----repositories\n----services\n-----impl\n-resources\npom.xml\n</code></pre>\n\n<p>What have I missed in setting this up? From all of the tutorials i have looked at online autowired is supposed to work oujt of the box</p>\n"},{"tags":["java","network-programming","wifi"],"comments":[{"owner":{"account_id":455911,"reputation":1863,"user_id":854371,"accept_rate":88,"display_name":"AJC"},"score":2,"creation_date":1314125819,"post_id":7166036,"comment_id":8599950,"body_markdown":"Wifi has nothing to do with it, it&#39;s the same as if you connect the two computers directly with a Lan cable, or if you install the server in a public address. All you need is the IP address of the server (local or public) so that the client can connect, and make sure the firewall is not blocking it.","body":"Wifi has nothing to do with it, it&#39;s the same as if you connect the two computers directly with a Lan cable, or if you install the server in a public address. All you need is the IP address of the server (local or public) so that the client can connect, and make sure the firewall is not blocking it."},{"owner":{"account_id":281486,"reputation":8971,"user_id":577812,"accept_rate":86,"display_name":"omnomnom"},"score":2,"creation_date":1314125822,"post_id":7166036,"comment_id":8599951,"body_markdown":"Using or not using wireless connection has no impact on your java program. Java application hosted on JVM does not have to care about used connection type.","body":"Using or not using wireless connection has no impact on your java program. Java application hosted on JVM does not have to care about used connection type."}],"answers":[{"tags":[],"owner":{"account_id":202653,"reputation":54444,"user_id":449856,"accept_rate":88,"display_name":"Codemwnci"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1314126485,"creation_date":1314126485,"answer_id":7166231,"question_id":7166036,"body_markdown":"Each computer on your WiFi network will have an IP address. Using one computer as the host, you create your ServerSocket.\r\nYour other computer will be the client, and can connect to the IP address of your host.\r\n\r\nYou then have your client/server over Wifi (and any other network for that matter) ready to go.","title":"server-client chat using WiFi and java socket programming","body":"<p>Each computer on your WiFi network will have an IP address. Using one computer as the host, you create your ServerSocket.\nYour other computer will be the client, and can connect to the IP address of your host.</p>\n\n<p>You then have your client/server over Wifi (and any other network for that matter) ready to go.</p>\n"}],"owner":{"account_id":620194,"reputation":53,"user_id":880036,"accept_rate":20,"display_name":"Matrix"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":8363,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1694779580,"creation_date":1314125446,"question_id":7166036,"body_markdown":"I want to make a chat program using WiFi connection between 2 computers (ad-hoc).\r\nI&#39;m familiar with socket programming in java, but I can&#39;t implement this in 2 computers.\r\nCould you help me to add WiFi network to my program?","title":"server-client chat using WiFi and java socket programming","body":"<p>I want to make a chat program using WiFi connection between 2 computers (ad-hoc).\nI'm familiar with socket programming in java, but I can't implement this in 2 computers.\nCould you help me to add WiFi network to my program?</p>\n"},{"tags":["java","android","reactjs","react-native","kotlin"],"answers":[{"tags":[],"owner":{"account_id":205843,"reputation":21,"user_id":454798,"accept_rate":29,"display_name":"Nation"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694779212,"creation_date":1694779212,"answer_id":77112189,"question_id":76975015,"body_markdown":"Please follow this [link](https://stackoverflow.com/questions/74648576/spring-class-file-has-wrong-version-61-0-should-be-55-0) to resolve Your issue. I had a same issues with ***RNGestureHandlerPackage*** and other packages. \r\n\r\n\r\nBasically it says, you should update ***JavaVersion*** from 11 to 17 in *app/build.gradle*\r\n","title":"How to solve the issue - &quot;error: cannot find symbol import com.swmansion.gesturehandler.RNGestureHandlerPackage&quot; - React Native?","body":"<p>Please follow this <a href=\"https://stackoverflow.com/questions/74648576/spring-class-file-has-wrong-version-61-0-should-be-55-0\">link</a> to resolve Your issue. I had a same issues with <em><strong>RNGestureHandlerPackage</strong></em> and other packages.</p>\n<p>Basically it says, you should update <em><strong>JavaVersion</strong></em> from 11 to 17 in <em>app/build.gradle</em></p>\n"}],"owner":{"account_id":24356145,"reputation":89,"user_id":18291275,"display_name":"happy smile"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":266,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1694779212,"creation_date":1692947462,"question_id":76975015,"body_markdown":"I am building a mobile app with React Native and I need to use both of modules - &quot;react-native-gesture-handler&quot; and &quot;react-native-screens&quot;.\r\n\r\nI installed those modules with `yarn add react-native-gesture-handler react-native-screens` and followed additional steps for Android.\r\n\r\nBut it fails to build APK.\r\n\r\nBelow is error log.\r\n\r\n\r\n```\r\n&gt; Task :app:compileDebugJavaWithJavac FAILED\r\nE:\\projects\\scannget-v2.1\\scannget-mobile-v21\\android\\app\\build\\generated\\rncli\\src\\main\\java\\com\\facebook\\react\\PackageList.java:19: error: cannot find symbol\r\nimport com.swmansion.gesturehandler.RNGestureHandlerPackage;\r\n                                   ^\r\n  symbol:   class RNGestureHandlerPackage\r\n  location: package com.swmansion.gesturehandler\r\nE:\\projects\\scannget-v2.1\\scannget-mobile-v21\\android\\app\\build\\generated\\rncli\\src\\main\\java\\com\\facebook\\react\\PackageList.java:27: error: cannot find symbol\r\nimport com.swmansion.rnscreens.RNScreensPackage;\r\n                              ^\r\n  symbol:   class RNScreensPackage\r\n  location: package com.swmansion.rnscreens\r\nE:\\projects\\scannget-v2.1\\scannget-mobile-v21\\android\\app\\build\\generated\\rncli\\src\\main\\java\\com\\facebook\\react\\PackageList.java:77: error: cannot find symbol\r\n      new RNGestureHandlerPackage(),\r\n          ^\r\n  symbol:   class RNGestureHandlerPackage\r\n  location: class PackageList\r\nE:\\projects\\scannget-v2.1\\scannget-mobile-v21\\android\\app\\build\\generated\\rncli\\src\\main\\java\\com\\facebook\\react\\PackageList.java:81: error: cannot find symbol\r\n      new RNScreensPackage(),\r\n          ^\r\n  symbol:   class RNScreensPackage\r\n  location: class PackageList\r\n4 errors\r\n```\r\n\r\nI searched everywhere regarding to this error but I couldn&#39;t find how to solve.\r\n\r\nIf anyone could help me, it will be much appreciated.\r\n\r\nReact Native version: 0.72.1\r\nreact-native-gesture-handler: 2.12.1\r\nreact-native-screens: 3.24.0\r\n\r\n\r\nI could see that RNGestureHandlerPackage and RNScreensPackage were writte in Kotlin and I thought the issue was happened because Kotlin classes were not built.\r\n\r\nI tried to add `apply plugin: &#39;kotlin-android&#39;` into everywhere in build.gradle files but it still throws same error.","title":"How to solve the issue - &quot;error: cannot find symbol import com.swmansion.gesturehandler.RNGestureHandlerPackage&quot; - React Native?","body":"<p>I am building a mobile app with React Native and I need to use both of modules - &quot;react-native-gesture-handler&quot; and &quot;react-native-screens&quot;.</p>\n<p>I installed those modules with <code>yarn add react-native-gesture-handler react-native-screens</code> and followed additional steps for Android.</p>\n<p>But it fails to build APK.</p>\n<p>Below is error log.</p>\n<pre><code>&gt; Task :app:compileDebugJavaWithJavac FAILED\nE:\\projects\\scannget-v2.1\\scannget-mobile-v21\\android\\app\\build\\generated\\rncli\\src\\main\\java\\com\\facebook\\react\\PackageList.java:19: error: cannot find symbol\nimport com.swmansion.gesturehandler.RNGestureHandlerPackage;\n                                   ^\n  symbol:   class RNGestureHandlerPackage\n  location: package com.swmansion.gesturehandler\nE:\\projects\\scannget-v2.1\\scannget-mobile-v21\\android\\app\\build\\generated\\rncli\\src\\main\\java\\com\\facebook\\react\\PackageList.java:27: error: cannot find symbol\nimport com.swmansion.rnscreens.RNScreensPackage;\n                              ^\n  symbol:   class RNScreensPackage\n  location: package com.swmansion.rnscreens\nE:\\projects\\scannget-v2.1\\scannget-mobile-v21\\android\\app\\build\\generated\\rncli\\src\\main\\java\\com\\facebook\\react\\PackageList.java:77: error: cannot find symbol\n      new RNGestureHandlerPackage(),\n          ^\n  symbol:   class RNGestureHandlerPackage\n  location: class PackageList\nE:\\projects\\scannget-v2.1\\scannget-mobile-v21\\android\\app\\build\\generated\\rncli\\src\\main\\java\\com\\facebook\\react\\PackageList.java:81: error: cannot find symbol\n      new RNScreensPackage(),\n          ^\n  symbol:   class RNScreensPackage\n  location: class PackageList\n4 errors\n</code></pre>\n<p>I searched everywhere regarding to this error but I couldn't find how to solve.</p>\n<p>If anyone could help me, it will be much appreciated.</p>\n<p>React Native version: 0.72.1\nreact-native-gesture-handler: 2.12.1\nreact-native-screens: 3.24.0</p>\n<p>I could see that RNGestureHandlerPackage and RNScreensPackage were writte in Kotlin and I thought the issue was happened because Kotlin classes were not built.</p>\n<p>I tried to add <code>apply plugin: 'kotlin-android'</code> into everywhere in build.gradle files but it still throws same error.</p>\n"},{"tags":["java","maven","junit","junit4","junit5"],"comments":[{"owner":{"account_id":261142,"reputation":47118,"user_id":545127,"accept_rate":69,"display_name":"Raedwald"},"score":0,"creation_date":1550243598,"post_id":47158583,"comment_id":96209868,"body_markdown":"I note that several popular BDD tools do not yet run under JUnit 5.","body":"I note that several popular BDD tools do not yet run under JUnit 5."},{"owner":{"account_id":100270,"reputation":127154,"user_id":270371,"accept_rate":33,"display_name":"davidxxx"},"score":0,"creation_date":1550644627,"post_id":47158583,"comment_id":96339245,"body_markdown":"@Raedwald When I wrote this post, one of my issues was for Cucumber. For BDD tools that are on several languages, I notice that the standard Java is not always very well updated/supported.","body":"@Raedwald When I wrote this post, one of my issues was for Cucumber. For BDD tools that are on several languages, I notice that the standard Java is not always very well updated/supported."}],"answers":[{"tags":[],"owner":{"account_id":100270,"reputation":127154,"user_id":270371,"accept_rate":33,"display_name":"davidxxx"},"down_vote_count":0,"up_vote_count":84,"is_accepted":false,"score":84,"last_activity_date":1535479737,"creation_date":1510059406,"answer_id":47158584,"question_id":47158583,"body_markdown":"JUnit 5 provides [a way out of the box][1].&lt;br&gt;\r\n\r\n&gt; JUnit 5 = JUnit Platform + JUnit Jupiter + JUnit Vintage\r\n\r\nEach one is a distinct project and using all of them allows to compile and execute JUnit 4 and JUnit 5 tests in a same project.&lt;br&gt;\r\n\r\n&gt; **JUnit Jupiter** is the combination of the new programming model and extension model for writing tests and extensions in JUnit 5.\r\n&gt; \r\n&gt; **JUnit Vintage** provides a TestEngine for running JUnit 3 and JUnit 4 based tests on the platform.\r\n&gt; \r\n&gt; **The JUnit Platform** serves as a foundation for launching testing frameworks on the JVM\r\n\r\n\r\n----------\r\n\r\n\r\n**Update : from Maven Surefire `2.22.0`**    \r\n\r\nFrom [the JUnit 5 documentation][2] :\r\n\r\n&gt; Starting with version `2.22.0`, Maven Surefire provides native support\r\n&gt; for executing tests on the JUnit Platform.\r\n\r\nSo the configuration is much simpler.    \r\nNote that the `junit-4` api dependency is optional as the `engine` dependencies that are now required already pull a default `api` version (it is the case for both junit 4 and 5).   \r\n\r\nHere is a sample `pom.xml`. \r\n\r\n    &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\r\n    \txmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n    \txsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n    \t&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n    \t&lt;groupId&gt;david&lt;/groupId&gt;\r\n    \t&lt;artifactId&gt;jupiter-4-and-5-same-build&lt;/artifactId&gt;\r\n    \t&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\r\n    \r\n    \t&lt;properties&gt;\r\n    \t\t&lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;\r\n    \t\t&lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;\r\n    \t\t&lt;junit-jupiter.version&gt;5.1.0&lt;/junit-jupiter.version&gt;\r\n    \t\t&lt;!-- optional : if we want to use a junit4 specific version --&gt;\r\n    \t\t&lt;junit.version&gt;4.12&lt;/junit.version&gt;\r\n    \t&lt;/properties&gt;\r\n    \t&lt;dependencies&gt;\r\n    \t\t&lt;!--JUnit Jupiter Engine to depend on the JUnit5 engine and JUnit 5 API --&gt;\r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;junit-jupiter-engine&lt;/artifactId&gt;\r\n    \t\t\t&lt;version&gt;${junit-jupiter.version}&lt;/version&gt;\r\n    \t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \t\t&lt;!--JUnit Jupiter Engine to depend on the JUnit4 engine and JUnit 4 API  --&gt;\r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;groupId&gt;org.junit.vintage&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;junit-vintage-engine&lt;/artifactId&gt;\r\n    \t\t\t&lt;version&gt;${junit-jupiter.version}&lt;/version&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \t\t&lt;!-- Optional : override the JUnit 4 API version provided by junit-vintage-engine --&gt;\r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;groupId&gt;junit&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;junit&lt;/artifactId&gt;\r\n    \t\t\t&lt;version&gt;${junit.version}&lt;/version&gt;\r\n    \t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \t&lt;/dependencies&gt;\r\n    \r\n    \t&lt;build&gt;\r\n    \t\t&lt;plugins&gt;\r\n    \t\t\t&lt;plugin&gt;\r\n    \t\t\t\t&lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;\r\n    \t\t\t\t&lt;version&gt;2.22.0&lt;/version&gt;\r\n    \t\t\t&lt;/plugin&gt;\r\n    \t\t&lt;/plugins&gt;\r\n    \t&lt;/build&gt;\r\n    \r\n    &lt;/project&gt;\r\n       \r\n\r\nOn my GitHub space I added a working sample maven project that you can browse/clone.\r\nURL: [https://github.com/ebundy/junit4-and-5-minimal-maven-project][3]\r\n\r\n----------\r\n\r\n**Old way : for Maven Surefire below `2.22.0`**    \r\n\r\nHere is the minimal configuration to use with Maven to configure the project to compile and run both JUnit4 and JUnit5 tests :\r\n\r\n    &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n    \txsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n    \t&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n    \t&lt;groupId&gt;mygroup&lt;/groupId&gt;\r\n    \t&lt;artifactId&gt;minimal-conf-junit4-5&lt;/artifactId&gt;\r\n    \t&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\r\n    \r\n    \t&lt;properties&gt;\r\n    \t\t&lt;!-- JUnit 5 depends on JDK 1.8 --&gt;\r\n    \t\t&lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;\r\n    \t\t&lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;\r\n    \t\t&lt;!--  JUnit dependency versions --&gt;\r\n    \t\t&lt;junit.version&gt;4.12&lt;/junit.version&gt;\r\n    \t\t&lt;junit-vintage-engine&gt;4.12.1&lt;/junit-vintage-engine&gt;\r\n    \t\t&lt;junit-jupiter.version&gt;5.0.1&lt;/junit-jupiter.version&gt;\r\n    \t\t&lt;junit-platform.version&gt;1.0.1&lt;/junit-platform.version&gt;\r\n    \t&lt;/properties&gt;\r\n    \r\n    \t&lt;dependencies&gt;\r\n    \t\t&lt;!--JUnit Jupiter API to write and compile tests with JUnit5 --&gt;\r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;junit-jupiter-api&lt;/artifactId&gt;\r\n    \t\t\t&lt;version&gt;${junit-jupiter.version}&lt;/version&gt;\r\n    \t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \t\t&lt;!-- JUnit 4 to make legacy JUnit 4 tests compile --&gt;\r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;groupId&gt;junit&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;junit&lt;/artifactId&gt;\r\n    \t\t\t&lt;version&gt;${junit.version}&lt;/version&gt;\r\n    \t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \t&lt;/dependencies&gt;\r\n    \r\n    \t&lt;build&gt;\r\n    \t\t&lt;plugins&gt;\r\n    \t\t\t&lt;plugin&gt;\r\n    \t\t\t\t&lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;\r\n    \t\t\t\t&lt;version&gt;2.19.1&lt;/version&gt; &lt;!-- matters until now--&gt;\r\n    \t\t\t\t&lt;dependencies&gt;\r\n    \t\t\t\t\t&lt;!-- to let surefire to run JUnit 4 but also JUnit 5 tests --&gt;\r\n    \t\t\t\t\t&lt;dependency&gt;\r\n    \t\t\t\t\t\t&lt;groupId&gt;org.junit.platform&lt;/groupId&gt;\r\n    \t\t\t\t\t\t&lt;artifactId&gt;junit-platform-surefire-provider&lt;/artifactId&gt;\r\n    \t\t\t\t\t\t&lt;version&gt;${junit-platform.version}&lt;/version&gt;\r\n    \t\t\t\t\t&lt;/dependency&gt;\r\n    \t\t\t\t\t&lt;!-- JUnit vintage engine to run JUnit 3 or JUnit 4 tests --&gt;\r\n    \t\t\t\t\t&lt;dependency&gt;\r\n    \t\t\t\t\t\t&lt;groupId&gt;org.junit.vintage&lt;/groupId&gt;\r\n    \t\t\t\t\t\t&lt;artifactId&gt;junit-vintage-engine&lt;/artifactId&gt;\r\n    \t\t\t\t\t\t&lt;version&gt;${junit-vintage-engine}&lt;/version&gt;\r\n    \t\t\t\t\t&lt;/dependency&gt;\r\n    \t\t\t\t\t&lt;!-- JUnit 5 engine to run JUnit 5 tests --&gt;\r\n    \t\t\t\t\t&lt;dependency&gt;\r\n    \t\t\t\t\t\t&lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\r\n    \t\t\t\t\t\t&lt;artifactId&gt;junit-jupiter-engine&lt;/artifactId&gt;\r\n    \t\t\t\t\t\t&lt;version&gt;${junit-jupiter.version}&lt;/version&gt;\r\n    \t\t\t\t\t&lt;/dependency&gt;\r\n    \t\t\t\t&lt;/dependencies&gt;\r\n    \t\t\t&lt;/plugin&gt;\r\n    \t\t&lt;/plugins&gt;\r\n    \t&lt;/build&gt;\r\n    &lt;/project&gt;\r\n\t\t\t\t \r\n\r\nNow `mvn test` compiles and runs both JUnit 4 and JUnit 5 tests.\r\n&lt;br&gt;\r\n\t\t\t \r\nNote 1 : the `junit-vintage-engine` (`4.12.1`) and the `junit` (`4.12`) dependencies don&#39;t  specify the same exact version.&lt;br&gt;\r\nThis is not an issue at all as :\r\n\r\n- their release are not related between them \r\n\r\n- `junit-vintage-engine` is designed to run any JUnit **3** or **4** tests.&lt;br&gt;\r\n\r\n\r\nNote 2 : maven-surefire-plugin with the `2.19.1` version matters whatever you want to compile JUnit 5 test classes or both JUnit 4 and JUnit 5 test classes.   \r\nNext version of the plugin causes indeed some exceptions during JUnit 5 tests execution but the `2.22.0` that at last solves the issue (see the first part of the answer : &quot;*Update : from Maven Surefire 2.22.0*&quot;).   \r\n\r\n\r\n  [1]: http://junit.org/junit5/docs/current/user-guide/#overview\r\n  [2]: https://junit.org/junit5/docs/snapshot/user-guide/#running-tests-build-maven\r\n  [3]: https://github.com/ebundy/junit4-and-5-minimal-maven-project","title":"Executing JUnit 4 and JUnit 5 tests in a same build","body":"<p>JUnit 5 provides <a href=\"http://junit.org/junit5/docs/current/user-guide/#overview\" rel=\"noreferrer\">a way out of the box</a>.<br></p>\n\n<blockquote>\n  <p>JUnit 5 = JUnit Platform + JUnit Jupiter + JUnit Vintage</p>\n</blockquote>\n\n<p>Each one is a distinct project and using all of them allows to compile and execute JUnit 4 and JUnit 5 tests in a same project.<br></p>\n\n<blockquote>\n  <p><strong>JUnit Jupiter</strong> is the combination of the new programming model and extension model for writing tests and extensions in JUnit 5.</p>\n  \n  <p><strong>JUnit Vintage</strong> provides a TestEngine for running JUnit 3 and JUnit 4 based tests on the platform.</p>\n  \n  <p><strong>The JUnit Platform</strong> serves as a foundation for launching testing frameworks on the JVM</p>\n</blockquote>\n\n<hr>\n\n<p><strong>Update : from Maven Surefire <code>2.22.0</code></strong>    </p>\n\n<p>From <a href=\"https://junit.org/junit5/docs/snapshot/user-guide/#running-tests-build-maven\" rel=\"noreferrer\">the JUnit 5 documentation</a> :</p>\n\n<blockquote>\n  <p>Starting with version <code>2.22.0</code>, Maven Surefire provides native support\n  for executing tests on the JUnit Platform.</p>\n</blockquote>\n\n<p>So the configuration is much simpler.<br>\nNote that the <code>junit-4</code> api dependency is optional as the <code>engine</code> dependencies that are now required already pull a default <code>api</code> version (it is the case for both junit 4 and 5).   </p>\n\n<p>Here is a sample <code>pom.xml</code>. </p>\n\n<pre><code>&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;groupId&gt;david&lt;/groupId&gt;\n    &lt;artifactId&gt;jupiter-4-and-5-same-build&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n\n    &lt;properties&gt;\n        &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;\n        &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;\n        &lt;junit-jupiter.version&gt;5.1.0&lt;/junit-jupiter.version&gt;\n        &lt;!-- optional : if we want to use a junit4 specific version --&gt;\n        &lt;junit.version&gt;4.12&lt;/junit.version&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;!--JUnit Jupiter Engine to depend on the JUnit5 engine and JUnit 5 API --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\n            &lt;artifactId&gt;junit-jupiter-engine&lt;/artifactId&gt;\n            &lt;version&gt;${junit-jupiter.version}&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;!--JUnit Jupiter Engine to depend on the JUnit4 engine and JUnit 4 API  --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.junit.vintage&lt;/groupId&gt;\n            &lt;artifactId&gt;junit-vintage-engine&lt;/artifactId&gt;\n            &lt;version&gt;${junit-jupiter.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!-- Optional : override the JUnit 4 API version provided by junit-vintage-engine --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;junit&lt;/groupId&gt;\n            &lt;artifactId&gt;junit&lt;/artifactId&gt;\n            &lt;version&gt;${junit.version}&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;\n                &lt;version&gt;2.22.0&lt;/version&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n</code></pre>\n\n<p>On my GitHub space I added a working sample maven project that you can browse/clone.\nURL: <a href=\"https://github.com/ebundy/junit4-and-5-minimal-maven-project\" rel=\"noreferrer\">https://github.com/ebundy/junit4-and-5-minimal-maven-project</a></p>\n\n<hr>\n\n<p><strong>Old way : for Maven Surefire below <code>2.22.0</code></strong>    </p>\n\n<p>Here is the minimal configuration to use with Maven to configure the project to compile and run both JUnit4 and JUnit5 tests :</p>\n\n<pre><code>&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;groupId&gt;mygroup&lt;/groupId&gt;\n    &lt;artifactId&gt;minimal-conf-junit4-5&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n\n    &lt;properties&gt;\n        &lt;!-- JUnit 5 depends on JDK 1.8 --&gt;\n        &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;\n        &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;\n        &lt;!--  JUnit dependency versions --&gt;\n        &lt;junit.version&gt;4.12&lt;/junit.version&gt;\n        &lt;junit-vintage-engine&gt;4.12.1&lt;/junit-vintage-engine&gt;\n        &lt;junit-jupiter.version&gt;5.0.1&lt;/junit-jupiter.version&gt;\n        &lt;junit-platform.version&gt;1.0.1&lt;/junit-platform.version&gt;\n    &lt;/properties&gt;\n\n    &lt;dependencies&gt;\n        &lt;!--JUnit Jupiter API to write and compile tests with JUnit5 --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\n            &lt;artifactId&gt;junit-jupiter-api&lt;/artifactId&gt;\n            &lt;version&gt;${junit-jupiter.version}&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;!-- JUnit 4 to make legacy JUnit 4 tests compile --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;junit&lt;/groupId&gt;\n            &lt;artifactId&gt;junit&lt;/artifactId&gt;\n            &lt;version&gt;${junit.version}&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;\n                &lt;version&gt;2.19.1&lt;/version&gt; &lt;!-- matters until now--&gt;\n                &lt;dependencies&gt;\n                    &lt;!-- to let surefire to run JUnit 4 but also JUnit 5 tests --&gt;\n                    &lt;dependency&gt;\n                        &lt;groupId&gt;org.junit.platform&lt;/groupId&gt;\n                        &lt;artifactId&gt;junit-platform-surefire-provider&lt;/artifactId&gt;\n                        &lt;version&gt;${junit-platform.version}&lt;/version&gt;\n                    &lt;/dependency&gt;\n                    &lt;!-- JUnit vintage engine to run JUnit 3 or JUnit 4 tests --&gt;\n                    &lt;dependency&gt;\n                        &lt;groupId&gt;org.junit.vintage&lt;/groupId&gt;\n                        &lt;artifactId&gt;junit-vintage-engine&lt;/artifactId&gt;\n                        &lt;version&gt;${junit-vintage-engine}&lt;/version&gt;\n                    &lt;/dependency&gt;\n                    &lt;!-- JUnit 5 engine to run JUnit 5 tests --&gt;\n                    &lt;dependency&gt;\n                        &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\n                        &lt;artifactId&gt;junit-jupiter-engine&lt;/artifactId&gt;\n                        &lt;version&gt;${junit-jupiter.version}&lt;/version&gt;\n                    &lt;/dependency&gt;\n                &lt;/dependencies&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n&lt;/project&gt;\n</code></pre>\n\n<p>Now <code>mvn test</code> compiles and runs both JUnit 4 and JUnit 5 tests.\n<br></p>\n\n<p>Note 1 : the <code>junit-vintage-engine</code> (<code>4.12.1</code>) and the <code>junit</code> (<code>4.12</code>) dependencies don't  specify the same exact version.<br>\nThis is not an issue at all as :</p>\n\n<ul>\n<li><p>their release are not related between them </p></li>\n<li><p><code>junit-vintage-engine</code> is designed to run any JUnit <strong>3</strong> or <strong>4</strong> tests.<br></p></li>\n</ul>\n\n<p>Note 2 : maven-surefire-plugin with the <code>2.19.1</code> version matters whatever you want to compile JUnit 5 test classes or both JUnit 4 and JUnit 5 test classes.<br>\nNext version of the plugin causes indeed some exceptions during JUnit 5 tests execution but the <code>2.22.0</code> that at last solves the issue (see the first part of the answer : \"<em>Update : from Maven Surefire 2.22.0</em>\").   </p>\n"},{"tags":[],"owner":{"account_id":6688303,"reputation":2926,"user_id":5158636,"display_name":"tschumann"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1617001400,"creation_date":1617001400,"answer_id":66849927,"question_id":47158583,"body_markdown":"JUnit have a number of example projects at https://github.com/junit-team/junit5-samples\r\n\r\nI had a Gradle project and following https://github.com/junit-team/junit5-samples/tree/main/junit5-migration-gradle worked for me.\r\n\r\nhttps://github.com/junit-team/junit5-samples/tree/main/junit5-migration-maven is the Maven equivalent - I have not tried it but I imagine that it works too.","title":"Executing JUnit 4 and JUnit 5 tests in a same build","body":"<p>JUnit have a number of example projects at <a href=\"https://github.com/junit-team/junit5-samples\" rel=\"nofollow noreferrer\">https://github.com/junit-team/junit5-samples</a></p>\n<p>I had a Gradle project and following <a href=\"https://github.com/junit-team/junit5-samples/tree/main/junit5-migration-gradle\" rel=\"nofollow noreferrer\">https://github.com/junit-team/junit5-samples/tree/main/junit5-migration-gradle</a> worked for me.</p>\n<p><a href=\"https://github.com/junit-team/junit5-samples/tree/main/junit5-migration-maven\" rel=\"nofollow noreferrer\">https://github.com/junit-team/junit5-samples/tree/main/junit5-migration-maven</a> is the Maven equivalent - I have not tried it but I imagine that it works too.</p>\n"},{"tags":[],"owner":{"account_id":7468655,"reputation":758,"user_id":5677294,"display_name":"Dave Kraczo"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1657117196,"creation_date":1657117196,"answer_id":72885200,"question_id":47158583,"body_markdown":"For gradle implementation. Just use junit 4 and junit vintage dependencies.\r\n\r\n    dependencies {\r\n    testImplementation &#39;junit:junit:4.13.1&#39;\r\n    testImplementation &#39;org.junit.vintage:junit-vintage-engine&#39;\r\n    }\r\n\r\nand also add test to use junitPlatform \r\n\r\n    test {\r\n        useJUnitPlatform()\r\n    }\r\n\r\nand then both junit4 and junit5 tests should works fine.","title":"Executing JUnit 4 and JUnit 5 tests in a same build","body":"<p>For gradle implementation. Just use junit 4 and junit vintage dependencies.</p>\n<pre><code>dependencies {\ntestImplementation 'junit:junit:4.13.1'\ntestImplementation 'org.junit.vintage:junit-vintage-engine'\n}\n</code></pre>\n<p>and also add test to use junitPlatform</p>\n<pre><code>test {\n    useJUnitPlatform()\n}\n</code></pre>\n<p>and then both junit4 and junit5 tests should works fine.</p>\n"},{"tags":[],"owner":{"account_id":11726648,"reputation":19523,"user_id":8583692,"display_name":"Mahozad"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694778567,"creation_date":1694778567,"answer_id":77112124,"question_id":47158583,"body_markdown":"Because the question title is general, here is the solution for Gradle using Kotlin DSL (build.gradle.**kts**):\r\n\r\n```kotlin\r\ntasks.withType&lt;Test&gt; {\r\n    useJUnitPlatform() // Enables JUnit Platform (JUnit 5 + JUnit 4)\r\n}\r\n\r\ndependencies {\r\n    // Aggregator dependency that also brings JUnit 5 parameterized tests etc.\r\n    testImplementation(&quot;org.junit.jupiter:junit-jupiter:5.10.0&quot;)\r\n    // The Vintage engine is needed to be able to run JUnit 4 tests\r\n    testImplementation(&quot;org.junit.vintage:junit-vintage-engine:5.10.0&quot;)\r\n}\r\n```\r\n\r\n```java\r\npublic class MyTestClass {\r\n    @org.junit.jupiter.api.Test // &lt;- JUnit 5 test\r\n    public void jUnit5test() { /* ... */ }\r\n\r\n    @org.junit.Test // &lt;- JUnit 4 test\r\n    public void jUnit4Test() { /* ... */ }\r\n}\r\n```\r\n\r\nExecute the tests by running the Gradle `test` or `check` task.","title":"Executing JUnit 4 and JUnit 5 tests in a same build","body":"<p>Because the question title is general, here is the solution for Gradle using Kotlin DSL (build.gradle.<strong>kts</strong>):</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>tasks.withType&lt;Test&gt; {\n    useJUnitPlatform() // Enables JUnit Platform (JUnit 5 + JUnit 4)\n}\n\ndependencies {\n    // Aggregator dependency that also brings JUnit 5 parameterized tests etc.\n    testImplementation(&quot;org.junit.jupiter:junit-jupiter:5.10.0&quot;)\n    // The Vintage engine is needed to be able to run JUnit 4 tests\n    testImplementation(&quot;org.junit.vintage:junit-vintage-engine:5.10.0&quot;)\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>public class MyTestClass {\n    @org.junit.jupiter.api.Test // &lt;- JUnit 5 test\n    public void jUnit5test() { /* ... */ }\n\n    @org.junit.Test // &lt;- JUnit 4 test\n    public void jUnit4Test() { /* ... */ }\n}\n</code></pre>\n<p>Execute the tests by running the Gradle <code>test</code> or <code>check</code> task.</p>\n"}],"owner":{"account_id":100270,"reputation":127154,"user_id":270371,"accept_rate":33,"display_name":"davidxxx"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":40994,"favorite_count":0,"down_vote_count":1,"up_vote_count":58,"answer_count":4,"score":57,"last_activity_date":1694778638,"creation_date":1510059406,"question_id":47158583,"body_markdown":"In Maven projects, I have some existing tests relying on JUnit 4. I cannot migrate these tests to JUnit 5 for multiple reasons.  \r\nEssentially, some tests depend on a library which uses JUnit 4 runner and code migration may take time.\r\n\r\nI would like all the same create new test classes with JUnit 5 that is now released and provides new interesting features.  \r\nHow to do that ?\r\n","title":"Executing JUnit 4 and JUnit 5 tests in a same build","body":"<p>In Maven projects, I have some existing tests relying on JUnit 4. I cannot migrate these tests to JUnit 5 for multiple reasons.<br />\nEssentially, some tests depend on a library which uses JUnit 4 runner and code migration may take time.</p>\n<p>I would like all the same create new test classes with JUnit 5 that is now released and provides new interesting features.<br />\nHow to do that ?</p>\n"},{"tags":["java","telegram","telegram-bot"],"answers":[{"tags":[],"owner":{"account_id":27326728,"reputation":21,"user_id":20839581,"display_name":"Azimjon Nazarov"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694778568,"creation_date":1694778568,"answer_id":77112125,"question_id":75934116,"body_markdown":"        GetUserProfilePhotos getUserProfilePhotos = new GetUserProfilePhotos();\r\n        getUserProfilePhotos.setUserId(update.getMessage().getChatId());\r\n\r\n        try {\r\n            UserProfilePhotos result= execute(getUserProfilePhotos);\r\n            \r\n            //show result             \r\n            System.out.println(result.getPhotos());\r\n\r\n        } catch (TelegramApiException e) {\r\n            throw new RuntimeException(e);\r\n        }","title":"How to get user avatar picture on Java telegram bot?","body":"<pre><code>    GetUserProfilePhotos getUserProfilePhotos = new GetUserProfilePhotos();\n    getUserProfilePhotos.setUserId(update.getMessage().getChatId());\n\n    try {\n        UserProfilePhotos result= execute(getUserProfilePhotos);\n        \n        //show result             \n        System.out.println(result.getPhotos());\n\n    } catch (TelegramApiException e) {\n        throw new RuntimeException(e);\n    }\n</code></pre>\n"}],"owner":{"account_id":21906837,"reputation":57,"user_id":16453810,"display_name":"Sergei Lobachev"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":54,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":1,"score":2,"last_activity_date":1694778568,"creation_date":1680645112,"question_id":75934116,"body_markdown":"I use Java and [telegrambots](https://mvnrepository.com/artifact/org.telegram/telegrambots) library. Please show an example of how to get the user&#39;s avatar.\r\n\r\n```\r\n        if (update.hasMessage() &amp;&amp; update.getMessage().hasText()) {\r\n\r\n            String massageText = update.getMessage().getText();\r\n            long chatId = update.getMessage().getChatId();\r\n            User user = update.getMessage().getFrom();\r\n            languageCode = user.getLanguageCode();\r\n            if (massageText.equals(&quot;/start&quot;)) {\r\n                System.out.println(&quot;UserAvatarPicture --&gt; &quot; + Avatar????);\r\n\r\n            } else {\r\n                sendMessage(chatId, localization.getLocalizedString(languageCode, &quot;commandWasNotRecognized&quot;));\r\n            }\r\n\r\n        }\r\n```\r\n","title":"How to get user avatar picture on Java telegram bot?","body":"<p>I use Java and <a href=\"https://mvnrepository.com/artifact/org.telegram/telegrambots\" rel=\"nofollow noreferrer\">telegrambots</a> library. Please show an example of how to get the user's avatar.</p>\n<pre><code>        if (update.hasMessage() &amp;&amp; update.getMessage().hasText()) {\n\n            String massageText = update.getMessage().getText();\n            long chatId = update.getMessage().getChatId();\n            User user = update.getMessage().getFrom();\n            languageCode = user.getLanguageCode();\n            if (massageText.equals(&quot;/start&quot;)) {\n                System.out.println(&quot;UserAvatarPicture --&gt; &quot; + Avatar????);\n\n            } else {\n                sendMessage(chatId, localization.getLocalizedString(languageCode, &quot;commandWasNotRecognized&quot;));\n            }\n\n        }\n</code></pre>\n"},{"tags":["java","spring-boot","tomcat","tomcat10"],"comments":[{"owner":{"account_id":13055830,"reputation":173,"user_id":9434729,"display_name":"Jelmen"},"score":0,"creation_date":1684736525,"post_id":76300621,"comment_id":134554642,"body_markdown":"Does the local and remote Tomcat server has the same configuration and version?","body":"Does the local and remote Tomcat server has the same configuration and version?"}],"answers":[{"tags":[],"owner":{"account_id":24736193,"reputation":21,"user_id":18623537,"display_name":"Ravi"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1684757864,"creation_date":1684757864,"answer_id":76306114,"question_id":76300621,"body_markdown":"I solved the above issue by replacing the hibernate-validator 8.0.0.Final and jakarta.validation-api 3.0.2 with below dependency:\r\n\r\n    &lt;dependency&gt;\r\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\r\n            &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;\r\n            &lt;version&gt;7.0.2.Final&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;jakarta.validation&lt;/groupId&gt;\r\n            &lt;artifactId&gt;jakarta.validation-api&lt;/artifactId&gt;\r\n            &lt;version&gt;3.0.1&lt;/version&gt;\r\n        &lt;/dependency&gt;","title":"Unable to create a Configuration, because no Jakarta Bean Validation provider could be found","body":"<p>I solved the above issue by replacing the hibernate-validator 8.0.0.Final and jakarta.validation-api 3.0.2 with below dependency:</p>\n<pre><code>&lt;dependency&gt;\n        &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n        &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;\n        &lt;version&gt;7.0.2.Final&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;jakarta.validation&lt;/groupId&gt;\n        &lt;artifactId&gt;jakarta.validation-api&lt;/artifactId&gt;\n        &lt;version&gt;3.0.1&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre>\n"}],"owner":{"account_id":24736193,"reputation":21,"user_id":18623537,"display_name":"Ravi"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":3036,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":76306114,"answer_count":1,"score":1,"last_activity_date":1694778437,"creation_date":1684682574,"question_id":76300621,"body_markdown":"I am using spring boot 3.0.0 and tomcat 10.0 and I am deploying my application on external tomcat server but I am getting below exception. However, my application is working fine on my local machine.\r\n\r\n    jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.\r\n        at jakarta.validation.Validation$GenericBootstrapImpl.configure(Validation.java:291) ~[jakarta.validation-api-3.0.2.jar:na]\r\n        at jakarta.validation.Validation.buildDefaultValidatorFactory(Validation.java:103) ~[jakarta.validation-api-3.0.2.jar:na]\r\n        at org.hibernate.cfg.beanvalidation.TypeSafeActivator.getValidatorFactory(TypeSafeActivator.java:479) ~[hibernate-core-6.1.5.Final.jar:6.1.5.Final]\r\n        at org.hibernate.cfg.beanvalidation.TypeSafeActivator.activate(TypeSafeActivator.java:82) ~[hibernate-core-6.1.5.Final.jar:6.1.5.Final]\r\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]\r\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]\r\n        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]\r\n        at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]\r\n        at org.hibernate.cfg.beanvalidation.BeanValidationIntegrator.integrate(BeanValidationIntegrator.java:137) ~[hibernate-core-6.1.5.Final.jar:6.1.5.Final]\r\n        at org.hibernate.internal.SessionFactoryImpl.&lt;init&gt;(SessionFactoryImpl.java:285) ~[hibernate-core-6.1.5.Final.jar:6.1.5.Final]\r\n        at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:415) ~[hibernate-core-6.1.5.Final.jar:6.1.5.Final]\r\n        at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1425) ~[hibernate-core-6.1.5.Final.jar:6.1.5.Final]\r\n        at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66) ~[spring-orm-6.0.2.jar:6.0.2]\r\n        at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:376) ~[spring-orm-6.0.2.jar:6.0.2]\r\n        at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:409) ~[spring-orm-6.0.2.jar:6.0.2]\r\n        at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:396) ~[spring-orm-6.0.2.jar:6.0.2]\r\n        at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:352) ~[spring-orm-6.0.2.jar:6.0.2]\r\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1797) ~[spring-beans-6.0.2.jar:6.0.2]\r\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1747) ~[spring-beans-6.0.2.jar:6.0.2]\r\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599) ~[spring-beans-6.0.2.jar:6.0.2]\r\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:521) ~[spring-beans-6.0.2.jar:6.0.2]\r\n        at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.0.2.jar:6.0.2]\r\n        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.0.2.jar:6.0.2]\r\n        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.0.2.jar:6.0.2]\r\n        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.0.2.jar:6.0.2]\r\n        at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1130) ~[spring-context-6.0.2.jar:6.0.2]\r\n        at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:905) ~[spring-context-6.0.2.jar:6.0.2]\r\n        at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:584) ~[spring-context-6.0.2.jar:6.0.2]\r\n        at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[spring-boot-3.0.0.jar:3.0.0]\r\n        \r\n        \r\n\r\nThese are my dependencies which I am using in my pom file.:\r\n\r\n    &lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;com.microsoft.sqlserver&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;mssql-jdbc&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;runtime&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;!-- https://mvnrepository.com/artifact/org.hibernate.validator/hibernate-validator --&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.hibernate.validator&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;8.0.0.Final&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n    &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;\r\n    &lt;scope&gt;provided&lt;/scope&gt;\r\n      &lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n      &lt;groupId&gt;com.fasterxml.jackson.datatype&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;jackson-datatype-jsr310&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t&lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t\r\n\r\n","title":"Unable to create a Configuration, because no Jakarta Bean Validation provider could be found","body":"<p>I am using spring boot 3.0.0 and tomcat 10.0 and I am deploying my application on external tomcat server but I am getting below exception. However, my application is working fine on my local machine.</p>\n<pre><code>jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.\n    at jakarta.validation.Validation$GenericBootstrapImpl.configure(Validation.java:291) ~[jakarta.validation-api-3.0.2.jar:na]\n    at jakarta.validation.Validation.buildDefaultValidatorFactory(Validation.java:103) ~[jakarta.validation-api-3.0.2.jar:na]\n    at org.hibernate.cfg.beanvalidation.TypeSafeActivator.getValidatorFactory(TypeSafeActivator.java:479) ~[hibernate-core-6.1.5.Final.jar:6.1.5.Final]\n    at org.hibernate.cfg.beanvalidation.TypeSafeActivator.activate(TypeSafeActivator.java:82) ~[hibernate-core-6.1.5.Final.jar:6.1.5.Final]\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]\n    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]\n    at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]\n    at org.hibernate.cfg.beanvalidation.BeanValidationIntegrator.integrate(BeanValidationIntegrator.java:137) ~[hibernate-core-6.1.5.Final.jar:6.1.5.Final]\n    at org.hibernate.internal.SessionFactoryImpl.&lt;init&gt;(SessionFactoryImpl.java:285) ~[hibernate-core-6.1.5.Final.jar:6.1.5.Final]\n    at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:415) ~[hibernate-core-6.1.5.Final.jar:6.1.5.Final]\n    at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1425) ~[hibernate-core-6.1.5.Final.jar:6.1.5.Final]\n    at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66) ~[spring-orm-6.0.2.jar:6.0.2]\n    at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:376) ~[spring-orm-6.0.2.jar:6.0.2]\n    at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:409) ~[spring-orm-6.0.2.jar:6.0.2]\n    at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:396) ~[spring-orm-6.0.2.jar:6.0.2]\n    at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:352) ~[spring-orm-6.0.2.jar:6.0.2]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1797) ~[spring-beans-6.0.2.jar:6.0.2]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1747) ~[spring-beans-6.0.2.jar:6.0.2]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599) ~[spring-beans-6.0.2.jar:6.0.2]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:521) ~[spring-beans-6.0.2.jar:6.0.2]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.0.2.jar:6.0.2]\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.0.2.jar:6.0.2]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.0.2.jar:6.0.2]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.0.2.jar:6.0.2]\n    at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1130) ~[spring-context-6.0.2.jar:6.0.2]\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:905) ~[spring-context-6.0.2.jar:6.0.2]\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:584) ~[spring-context-6.0.2.jar:6.0.2]\n    at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[spring-boot-3.0.0.jar:3.0.0]\n    \n    \n</code></pre>\n<p>These are my dependencies which I am using in my pom file.:</p>\n<pre><code>&lt;dependency&gt;\n        &lt;groupId&gt;com.microsoft.sqlserver&lt;/groupId&gt;\n        &lt;artifactId&gt;mssql-jdbc&lt;/artifactId&gt;\n        &lt;scope&gt;runtime&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;!-- https://mvnrepository.com/artifact/org.hibernate.validator/hibernate-validator --&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.hibernate.validator&lt;/groupId&gt;\n        &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;\n        &lt;version&gt;8.0.0.Final&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n        &lt;scope&gt;test&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n&lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;\n&lt;scope&gt;provided&lt;/scope&gt;\n  &lt;/dependency&gt;\n    &lt;dependency&gt;\n  &lt;groupId&gt;com.fasterxml.jackson.datatype&lt;/groupId&gt;\n        &lt;artifactId&gt;jackson-datatype-jsr310&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    \n</code></pre>\n"},{"tags":["java","android","kotlin","mobile","webview"],"comments":[{"owner":{"account_id":27699053,"reputation":2348,"user_id":21144042,"display_name":"Diego Borba"},"score":1,"creation_date":1694690104,"post_id":77104174,"comment_id":135925898,"body_markdown":"Please, provide a [MCVE].","body":"Please, provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}],"answers":[{"tags":[],"owner":{"account_id":3366602,"reputation":611,"user_id":2827025,"display_name":"anemomylos"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1694778291,"creation_date":1694778291,"answer_id":77112099,"question_id":77104174,"body_markdown":"I presume that right now you have extend `WebViewClient` and you override methods `onPageStarted` and `onPageFinished` to show/hide the progress bar. \r\n\r\nYou also need to extend `WebChromeClient` and override method `onProgressChanged` so that you can hide the progress bar after the first data has started to load in the webview - if that&#39;s what you want to do, it&#39;s not very clear what you want to achieve.\r\n\r\nTo set up your classes in the WebView you use, respectively, the methods `WebView.setWebViewClient` and `WebView.setWebChromeClient`.","title":"How do I hide the progress bar without waiting for the entire page to load in webview?","body":"<p>I presume that right now you have extend <code>WebViewClient</code> and you override methods <code>onPageStarted</code> and <code>onPageFinished</code> to show/hide the progress bar.</p>\n<p>You also need to extend <code>WebChromeClient</code> and override method <code>onProgressChanged</code> so that you can hide the progress bar after the first data has started to load in the webview - if that's what you want to do, it's not very clear what you want to achieve.</p>\n<p>To set up your classes in the WebView you use, respectively, the methods <code>WebView.setWebViewClient</code> and <code>WebView.setWebChromeClient</code>.</p>\n"}],"owner":{"account_id":17873203,"reputation":47,"user_id":12983940,"display_name":"Talha Saglam"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":35,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77112099,"answer_count":1,"score":0,"last_activity_date":1694778291,"creation_date":1694688527,"question_id":77104174,"body_markdown":"I have a webview page in my app. Also there is a progress bar for control of load page. The progress bar working until to load all of page but I wanna hide it after the first upload. How can I do that in kotlin or java ?","title":"How do I hide the progress bar without waiting for the entire page to load in webview?","body":"<p>I have a webview page in my app. Also there is a progress bar for control of load page. The progress bar working until to load all of page but I wanna hide it after the first upload. How can I do that in kotlin or java ?</p>\n"},{"tags":["java","unit-testing","junit","nested","junit5"],"comments":[{"owner":{"account_id":44195,"reputation":269033,"user_id":129570,"accept_rate":79,"display_name":"Oliver Charlesworth"},"score":12,"creation_date":1458912810,"post_id":36220889,"comment_id":60073259,"body_markdown":"To form logical groupings of test cases.","body":"To form logical groupings of test cases."},{"owner":{"account_id":5107530,"reputation":1799,"user_id":4095194,"display_name":"Dennis R"},"score":1,"creation_date":1458913201,"post_id":36220889,"comment_id":60073498,"body_markdown":"To add to that... Small example: EatsTest, BehaviourTest can be nested inside DogTest, etc. See http://junit.org/junit5/#nested-tests","body":"To add to that... Small example: EatsTest, BehaviourTest can be nested inside DogTest, etc. See <a href=\"http://junit.org/junit5/#nested-tests\" rel=\"nofollow noreferrer\">junit.org/junit5/#nested-tests</a>"},{"owner":{"account_id":165479,"reputation":30116,"user_id":388980,"display_name":"Sam Brannen"},"score":1,"creation_date":1461007168,"post_id":36220889,"comment_id":60992809,"body_markdown":"That link should be: http://junit.org/junit5/docs/current/user-guide/#nested-tests","body":"That link should be: <a href=\"http://junit.org/junit5/docs/current/user-guide/#nested-tests\" rel=\"nofollow noreferrer\">junit.org/junit5/docs/current/user-guide/#nested-tests</a>"},{"owner":{"account_id":302238,"reputation":708,"user_id":610501,"accept_rate":82,"display_name":"SelimOber"},"score":1,"creation_date":1463479079,"post_id":36220889,"comment_id":62071397,"body_markdown":"It also helps promoting Behaviour Driven Development style like rspec&#39;s describe/it:http://rspec.info/documentation/3.4/rspec-core/#Nested_Groups","body":"It also helps promoting Behaviour Driven Development style like rspec&#39;s describe/it:<a href=\"http://rspec.info/documentation/3.4/rspec-core/#Nested_Groups\" rel=\"nofollow noreferrer\">rspec.info/documentation/3.4/rspec-core/#Nested_&zwnj;&#8203;Groups</a>"}],"answers":[{"tags":[],"owner":{"account_id":2818342,"reputation":299828,"user_id":2422776,"display_name":"Mureinik"},"down_vote_count":0,"up_vote_count":33,"is_accepted":true,"score":33,"last_activity_date":1458912973,"creation_date":1458912973,"answer_id":36221004,"question_id":36220889,"body_markdown":"The `@Nested` annotation allows you to have an inner class that&#39;s essentially a test class, allowing you to group several test classes under the same parent (with the same initialization).","title":"What&#39;s the purpose of the JUnit 5 @Nested annotation?","body":"<p>The <code>@Nested</code> annotation allows you to have an inner class that's essentially a test class, allowing you to group several test classes under the same parent (with the same initialization).</p>\n"},{"tags":[],"owner":{"account_id":1041926,"reputation":26177,"user_id":1047788,"accept_rate":81,"display_name":"user7610"},"down_vote_count":0,"up_vote_count":9,"is_accepted":false,"score":9,"last_activity_date":1662470814,"creation_date":1468490808,"answer_id":38371307,"question_id":36220889,"body_markdown":"All my tests need a database server running. Most of my tests also need a `Users` table in the database, to be able to log in. In addition to that, some tests need the `Friends` table, to be able to login and query friends.\r\n\r\nEach resource has a setup and teardown. I have to start and stop server, create and delete tables.\r\n\r\nWith the `@Nested` annotation, I can group my tests in a hierarchy of nested classes so that every test gets the setup and teardown of all tests up the hierarchy.\r\n\r\nThis idea of nesting tests was popularized in Ruby. In Java is implemented for Junit 4 by the HierarchicalContextRunner. See the justification on its page https://github.com/bechte/junit-hierarchicalcontextrunner/wiki.","title":"What&#39;s the purpose of the JUnit 5 @Nested annotation?","body":"<p>All my tests need a database server running. Most of my tests also need a <code>Users</code> table in the database, to be able to log in. In addition to that, some tests need the <code>Friends</code> table, to be able to login and query friends.</p>\n<p>Each resource has a setup and teardown. I have to start and stop server, create and delete tables.</p>\n<p>With the <code>@Nested</code> annotation, I can group my tests in a hierarchy of nested classes so that every test gets the setup and teardown of all tests up the hierarchy.</p>\n<p>This idea of nesting tests was popularized in Ruby. In Java is implemented for Junit 4 by the HierarchicalContextRunner. See the justification on its page <a href=\"https://github.com/bechte/junit-hierarchicalcontextrunner/wiki\" rel=\"nofollow noreferrer\">https://github.com/bechte/junit-hierarchicalcontextrunner/wiki</a>.</p>\n"},{"tags":[],"owner":{"account_id":100270,"reputation":127154,"user_id":270371,"accept_rate":33,"display_name":"davidxxx"},"down_vote_count":0,"up_vote_count":56,"is_accepted":false,"score":56,"last_activity_date":1568660247,"creation_date":1534084522,"answer_id":51809805,"question_id":36220889,"body_markdown":"&gt; I just don&#39;t understand why we need to have nested test class in our\r\n&gt; test.\r\n\r\n`@Nested` makes really sense to organize big test classes.   \r\n\r\n**Typical use case**  \r\n\r\nVery often, developer teams define a test class by class to test. \r\nThat is a shared good practice but it also may make your test class very big and to count several hundred of lines.  You can indeed have classes to test with multiple methods to test, multiple scenarios for each one and also some initialization steps required in the unit test methods to test the scenarios.   \r\nAll of these will naturally increase the test class size.     \r\nAbove a threshold (maybe 500 lines or about), it becomes legitimate to ask yourself whether a refactoring is needed.    \r\n\r\nA big class (test class or not), even well organized is harder to read, maintain than multiple classes grouping things with high cohesion/relationship between.     \r\nIn the unit tests cases, it can be sometime still worse because you may not find a test scenario and write a new one while it existed but you didn&#39;t manage to find it because the test class is big.     \r\n\r\n**`@Nested` : the solution**  \r\n\r\n[`@Nested`][1] addresses this issue by giving the possibility to group multiple test methods inside multiple nested classes of a main(outer) test class.     \r\nThe test methods of all nested classes defined in the main(outer) test class are handled as any test methods. So `@BeforeEach`, `@AfterEach`, `@ExtendWith`... are applied for all the them.   \r\n[The single exception is  `@BeforeAll` and `@AfterAll`][2] :\r\n\r\n&gt; Only non-static nested classes (i.e. inner classes) can serve as\r\n&gt; `@Nested` test classes. Nesting can be arbitrarily deep, and those inner\r\n&gt; classes are considered to be full members of the test class family\r\n&gt; with one exception: `@BeforeAll` and `@AfterAll` methods do not work by\r\n&gt; default. The reason is that Java does not allow static members in\r\n&gt; inner classes. However, this restriction can be circumvented by\r\n&gt; annotating a `@Nested` test class with\r\n&gt; `@TestInstance(Lifecycle.PER_CLASS`) (see Test Instance Lifecycle).\r\n\r\nUsing `@Nested`  combined with [`@DisplayName`][3] that takes a `String` value becomes still finer as the display name will be used for test reporting in IDEs and build tools and may contain spaces, special characters, and even emoji.     \r\n\r\n\r\n**Example** \r\n\r\nI have a `FooService` with multiple methods and multiple scenarios. \r\nI can groups scenarios of the same concern inside nested classes of the unit test class.    \r\nHere I choose the method to test to group them (so I group by scenario) but the discriminator could be another thing if it makes sense.   \r\n\r\nFor example :   \r\n\r\n    public class FooServiceTest {\r\n    \r\n        Foo foo;\r\n    \r\n        // invoked for ALL test methods\r\n    \t@BeforeEach\r\n    \tpublic void beforeEach() {\r\n    \t\t Foo foo = new Foo(...);\r\n    \t}\r\n    \r\n    \t@Nested\r\n    \t@DisplayName(&quot;findWith methods&quot;)\r\n    \tclass FindMethods {\r\n    \t\t@Test\r\n    \t\tvoid findWith_when_X() throws Exception {\r\n                 //...\r\n                 foo.findWith(...);\r\n                 //...\r\n    \t\t}\r\n    \t\t@Test\r\n    \t\tvoid findWith_when_Y() throws Exception {\r\n                 //...\r\n                 foo.findWith(...);\r\n                 //...\r\n    \r\n    \t\t}\r\n    \t\t@Test\r\n    \t\tvoid findWith_when_Z() throws Exception {\r\n                 //...\r\n                 foo.findWith(...);\r\n                 //...\r\n    \t\t}\t\t\t\r\n    \t}\r\n    \t\r\n    \t@Nested\r\n    \t@DisplayName(&quot;findAll methods&quot;)\r\n    \tclass FindAllMethods {\r\n    \t\t@Test\r\n    \t\tvoid findAll_when_X() throws Exception {\r\n                 //...\r\n                 foo.findAll(...);\r\n                 //...\r\n    \t\t}\r\n    \t\t@Test\r\n    \t\tvoid findAll_when_Y() throws Exception {\r\n                 //...\r\n                 foo.findAll(...);\r\n                 //...\r\n    \r\n    \t\t}\r\n    \t\t@Test\r\n    \t\tvoid findAll_when_Z() throws Exception {\r\n                 //...\r\n                 foo.findAll(...);\r\n                 //...\r\n    \t\t}\t\r\n        }\t\r\n    \r\n    \t@Nested\r\n    \t@DisplayName(&quot;computeBar methods&quot;)\r\n    \tclass ComputeBarMethods {\t\r\n             //...\r\n    \t\t\r\n    \t}\r\n    \r\n    \t@Nested\r\n    \t@DisplayName(&quot;saveOrUpdate methods&quot;)\r\n    \tclass SaveOrUpdateMethods {\t\r\n             //...\r\n    \t\t\r\n    \t}\r\n    }\r\n\r\n**Sample renderings in the IDE**  \r\n\r\nChild methods of Nesteds are folded by default : \r\n\r\n[![Overview in JUnit Eclipse plugin][4]][4]\r\n\r\n\r\nIn case or test failure or on demand you can unfold child methods of Nesteds :   \r\n\r\n[![Unfold with a failure in JUnit Eclipse plugin][5]][5]\r\n\r\n\r\n  [1]: https://junit.org/junit5/docs/current/api/org/junit/jupiter/api/Nested.html\r\n  [2]: https://junit.org/junit5/docs/5.0.3/user-guide/#writing-tests-nested\r\n  [3]: https://junit.org/junit5/docs/current/api/org/junit/jupiter/api/DisplayName.html\r\n  [4]: https://i.stack.imgur.com/c9f3G.png\r\n  [5]: https://i.stack.imgur.com/BtQ8M.png","title":"What&#39;s the purpose of the JUnit 5 @Nested annotation?","body":"<blockquote>\n  <p>I just don't understand why we need to have nested test class in our\n  test.</p>\n</blockquote>\n\n<p><code>@Nested</code> makes really sense to organize big test classes.   </p>\n\n<p><strong>Typical use case</strong>  </p>\n\n<p>Very often, developer teams define a test class by class to test. \nThat is a shared good practice but it also may make your test class very big and to count several hundred of lines.  You can indeed have classes to test with multiple methods to test, multiple scenarios for each one and also some initialization steps required in the unit test methods to test the scenarios.<br>\nAll of these will naturally increase the test class size.<br>\nAbove a threshold (maybe 500 lines or about), it becomes legitimate to ask yourself whether a refactoring is needed.    </p>\n\n<p>A big class (test class or not), even well organized is harder to read, maintain than multiple classes grouping things with high cohesion/relationship between.<br>\nIn the unit tests cases, it can be sometime still worse because you may not find a test scenario and write a new one while it existed but you didn't manage to find it because the test class is big.     </p>\n\n<p><strong><code>@Nested</code> : the solution</strong>  </p>\n\n<p><a href=\"https://junit.org/junit5/docs/current/api/org/junit/jupiter/api/Nested.html\" rel=\"noreferrer\"><code>@Nested</code></a> addresses this issue by giving the possibility to group multiple test methods inside multiple nested classes of a main(outer) test class.<br>\nThe test methods of all nested classes defined in the main(outer) test class are handled as any test methods. So <code>@BeforeEach</code>, <code>@AfterEach</code>, <code>@ExtendWith</code>... are applied for all the them.<br>\n<a href=\"https://junit.org/junit5/docs/5.0.3/user-guide/#writing-tests-nested\" rel=\"noreferrer\">The single exception is  <code>@BeforeAll</code> and <code>@AfterAll</code></a> :</p>\n\n<blockquote>\n  <p>Only non-static nested classes (i.e. inner classes) can serve as\n  <code>@Nested</code> test classes. Nesting can be arbitrarily deep, and those inner\n  classes are considered to be full members of the test class family\n  with one exception: <code>@BeforeAll</code> and <code>@AfterAll</code> methods do not work by\n  default. The reason is that Java does not allow static members in\n  inner classes. However, this restriction can be circumvented by\n  annotating a <code>@Nested</code> test class with\n  <code>@TestInstance(Lifecycle.PER_CLASS</code>) (see Test Instance Lifecycle).</p>\n</blockquote>\n\n<p>Using <code>@Nested</code>  combined with <a href=\"https://junit.org/junit5/docs/current/api/org/junit/jupiter/api/DisplayName.html\" rel=\"noreferrer\"><code>@DisplayName</code></a> that takes a <code>String</code> value becomes still finer as the display name will be used for test reporting in IDEs and build tools and may contain spaces, special characters, and even emoji.     </p>\n\n<p><strong>Example</strong> </p>\n\n<p>I have a <code>FooService</code> with multiple methods and multiple scenarios. \nI can groups scenarios of the same concern inside nested classes of the unit test class.<br>\nHere I choose the method to test to group them (so I group by scenario) but the discriminator could be another thing if it makes sense.   </p>\n\n<p>For example :   </p>\n\n<pre><code>public class FooServiceTest {\n\n    Foo foo;\n\n    // invoked for ALL test methods\n    @BeforeEach\n    public void beforeEach() {\n         Foo foo = new Foo(...);\n    }\n\n    @Nested\n    @DisplayName(\"findWith methods\")\n    class FindMethods {\n        @Test\n        void findWith_when_X() throws Exception {\n             //...\n             foo.findWith(...);\n             //...\n        }\n        @Test\n        void findWith_when_Y() throws Exception {\n             //...\n             foo.findWith(...);\n             //...\n\n        }\n        @Test\n        void findWith_when_Z() throws Exception {\n             //...\n             foo.findWith(...);\n             //...\n        }           \n    }\n\n    @Nested\n    @DisplayName(\"findAll methods\")\n    class FindAllMethods {\n        @Test\n        void findAll_when_X() throws Exception {\n             //...\n             foo.findAll(...);\n             //...\n        }\n        @Test\n        void findAll_when_Y() throws Exception {\n             //...\n             foo.findAll(...);\n             //...\n\n        }\n        @Test\n        void findAll_when_Z() throws Exception {\n             //...\n             foo.findAll(...);\n             //...\n        }   \n    }   \n\n    @Nested\n    @DisplayName(\"computeBar methods\")\n    class ComputeBarMethods {   \n         //...\n\n    }\n\n    @Nested\n    @DisplayName(\"saveOrUpdate methods\")\n    class SaveOrUpdateMethods { \n         //...\n\n    }\n}\n</code></pre>\n\n<p><strong>Sample renderings in the IDE</strong>  </p>\n\n<p>Child methods of Nesteds are folded by default : </p>\n\n<p><a href=\"https://i.stack.imgur.com/c9f3G.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/c9f3G.png\" alt=\"Overview in JUnit Eclipse plugin\"></a></p>\n\n<p>In case or test failure or on demand you can unfold child methods of Nesteds :   </p>\n\n<p><a href=\"https://i.stack.imgur.com/BtQ8M.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/BtQ8M.png\" alt=\"Unfold with a failure in JUnit Eclipse plugin\"></a></p>\n"},{"tags":[],"owner":{"account_id":167705,"reputation":59,"user_id":2424855,"display_name":"Raj"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1592988416,"creation_date":1592988416,"answer_id":62551129,"question_id":36220889,"body_markdown":"@Nested - Mainly starts from Junit5, provides the continuation logic of a feature we are attempting to do. \r\nSplit the business test scenarios to multiple classes, @nested is in use.","title":"What&#39;s the purpose of the JUnit 5 @Nested annotation?","body":"<p>@Nested - Mainly starts from Junit5, provides the continuation logic of a feature we are attempting to do.\nSplit the business test scenarios to multiple classes, @nested is in use.</p>\n"},{"tags":[],"owner":{"account_id":11726648,"reputation":19523,"user_id":8583692,"display_name":"Mahozad"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694777984,"creation_date":1694777984,"answer_id":77112071,"question_id":36220889,"body_markdown":"It also makes it possible (using a workaround) to extract the classes to separate files but still showing them as sub-hierarchy of the top class in test views and test reports.\r\n\r\nMake sure the extracted classes are marked `abstract` to avoid running them twice. See https://github.com/junit-team/junit5/issues/1750\r\n\r\nHere is an example using Kotlin:\r\n\r\n```kotlin\r\nclass MyContainerTest {\r\n    @Nested inner class MyNestedTestsOne : MyNestedTest1()\r\n    @Nested inner class MyNestedTestsTwo : MyNestedTest2()\r\n\r\n    // Can also have regular unit tests\r\n    @Test\r\n    fun myUnitTestInContainer() { /* ... */ }\r\n}\r\n```\r\nMyNestedTest1.kt:\r\n```kotlin\r\nabstract class MyNestedTest1 {\r\n    @Test\r\n    fun myUnitTestInNestedClass1() { /* ... */ }\r\n}\r\n```\r\nMyNestedTest2.kt:\r\n```kotlin\r\nabstract class MyNestedTest2 {\r\n    @Test\r\n    fun myUnitTestInNestedClass2() { /* ... */ }\r\n}\r\n```\r\n","title":"What&#39;s the purpose of the JUnit 5 @Nested annotation?","body":"<p>It also makes it possible (using a workaround) to extract the classes to separate files but still showing them as sub-hierarchy of the top class in test views and test reports.</p>\n<p>Make sure the extracted classes are marked <code>abstract</code> to avoid running them twice. See <a href=\"https://github.com/junit-team/junit5/issues/1750\" rel=\"nofollow noreferrer\">https://github.com/junit-team/junit5/issues/1750</a></p>\n<p>Here is an example using Kotlin:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>class MyContainerTest {\n    @Nested inner class MyNestedTestsOne : MyNestedTest1()\n    @Nested inner class MyNestedTestsTwo : MyNestedTest2()\n\n    // Can also have regular unit tests\n    @Test\n    fun myUnitTestInContainer() { /* ... */ }\n}\n</code></pre>\n<p>MyNestedTest1.kt:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>abstract class MyNestedTest1 {\n    @Test\n    fun myUnitTestInNestedClass1() { /* ... */ }\n}\n</code></pre>\n<p>MyNestedTest2.kt:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>abstract class MyNestedTest2 {\n    @Test\n    fun myUnitTestInNestedClass2() { /* ... */ }\n}\n</code></pre>\n"}],"owner":{"account_id":3019275,"reputation":4542,"user_id":2560685,"accept_rate":70,"display_name":"sab"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":34581,"favorite_count":0,"down_vote_count":0,"up_vote_count":56,"accepted_answer_id":36221004,"answer_count":5,"score":56,"last_activity_date":1694778067,"creation_date":1458912567,"question_id":36220889,"body_markdown":"In JUnit 5, there is a new annotation: [`@Nested`](https://junit.org/junit5/docs/current/api/org.junit.jupiter.api/org/junit/jupiter/api/Nested.html).\r\n\r\nI understand how the annotation works, I understand why we use nested classes,\r\nI just don&#39;t understand why we need to have *nested test* classes.\r\n","title":"What&#39;s the purpose of the JUnit 5 @Nested annotation?","body":"<p>In JUnit 5, there is a new annotation: <a href=\"https://junit.org/junit5/docs/current/api/org.junit.jupiter.api/org/junit/jupiter/api/Nested.html\" rel=\"nofollow noreferrer\"><code>@Nested</code></a>.</p>\n<p>I understand how the annotation works, I understand why we use nested classes,\nI just don't understand why we need to have <em>nested test</em> classes.</p>\n"},{"tags":["java","apache-poi"],"comments":[{"owner":{"account_id":213468,"reputation":103494,"user_id":466862,"display_name":"Mark Rotteveel"},"score":3,"creation_date":1694761861,"post_id":77110306,"comment_id":135936350,"body_markdown":"The stacktrace provides no clues as to a problem (other than attempting to write to a closed writer), and given it is a writer (which is for text data), it is unlikely to be related to an Excel sheet, as that is binary data. The stacktrace also doesn&#39;t include any elements of POI or your application code. Please provide a [mre].","body":"The stacktrace provides no clues as to a problem (other than attempting to write to a closed writer), and given it is a writer (which is for text data), it is unlikely to be related to an Excel sheet, as that is binary data. The stacktrace also doesn&#39;t include any elements of POI or your application code. Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."},{"owner":{"account_id":213468,"reputation":103494,"user_id":466862,"display_name":"Mark Rotteveel"},"score":0,"creation_date":1694761881,"post_id":77110306,"comment_id":135936353,"body_markdown":"And yes, it is possible to write Excel sheets with little memory overhead, if you use the streaming variant (e.g. `SXSSFWorkbook`).","body":"And yes, it is possible to write Excel sheets with little memory overhead, if you use the streaming variant (e.g. <code>SXSSFWorkbook</code>)."},{"owner":{"account_id":6871197,"reputation":456,"user_id":5281466,"accept_rate":62,"display_name":"Matrix12"},"score":0,"creation_date":1694762278,"post_id":77110306,"comment_id":135936421,"body_markdown":"@MarkRotteveel I used that but still the same issue is. I received only single value in file","body":"@MarkRotteveel I used that but still the same issue is. I received only single value in file"},{"owner":{"account_id":7547772,"reputation":8583,"user_id":5730279,"display_name":"hc_dev"},"score":3,"creation_date":1694762540,"post_id":77110306,"comment_id":135936458,"body_markdown":"Can you also show the initialization and concrete type of your OutputStream `os` ? Note: the [`writeAvoidingTempFiles`](https://poi.apache.org/apidocs/dev/org/apache/poi/xssf/streaming/SXSSFWorkbook.html#writeAvoidingTempFiles-java.io.OutputStream-) method is marked `@Beta`, do you get the same error when using `write` instead.","body":"Can you also show the initialization and concrete type of your OutputStream <code>os</code> ? Note: the <a href=\"https://poi.apache.org/apidocs/dev/org/apache/poi/xssf/streaming/SXSSFWorkbook.html#writeAvoidingTempFiles-java.io.OutputStream-\" rel=\"nofollow noreferrer\"><code>writeAvoidingTempFiles</code></a> method is marked <code>@Beta</code>, do you get the same error when using <code>write</code> instead."},{"owner":{"account_id":7547772,"reputation":8583,"user_id":5730279,"display_name":"hc_dev"},"score":0,"creation_date":1694763024,"post_id":77110306,"comment_id":135936552,"body_markdown":"First and foremost, check your code executed before for any use of `close()` on the output-stream - as hinted by Mark already.","body":"First and foremost, check your code executed before for any use of <code>close()</code> on the output-stream - as hinted by Mark already."},{"owner":{"account_id":6871197,"reputation":456,"user_id":5281466,"accept_rate":62,"display_name":"Matrix12"},"score":0,"creation_date":1694766015,"post_id":77110306,"comment_id":135937059,"body_markdown":"The OutputStream type is org.apache.catalina.connector.CoyoteOutputStream. \nI didn&#39;t get the different issue when I used to write instead writeAvoidTempFiles, but my assumption was that maybe some of the internal classes close a stream.","body":"The OutputStream type is org.apache.catalina.connector.CoyoteOutputStream.  I didn&#39;t get the different issue when I used to write instead writeAvoidTempFiles, but my assumption was that maybe some of the internal classes close a stream."},{"owner":{"account_id":6871197,"reputation":456,"user_id":5281466,"accept_rate":62,"display_name":"Matrix12"},"score":0,"creation_date":1694768697,"post_id":77110306,"comment_id":135937577,"body_markdown":"Both methods - the same type of outputstream","body":"Both methods - the same type of outputstream"},{"owner":{"account_id":19118721,"reputation":6319,"user_id":13963086,"display_name":"k314159"},"score":1,"creation_date":1694769528,"post_id":77110306,"comment_id":135937728,"body_markdown":"How come you pass `httpServletResponse` to your `export` method when it takes an `OutputStream`? Are you calling a different `export` method than the one you&#39;re showing us?","body":"How come you pass <code>httpServletResponse</code> to your <code>export</code> method when it takes an <code>OutputStream</code>? Are you calling a different <code>export</code> method than the one you&#39;re showing us?"},{"owner":{"account_id":6871197,"reputation":456,"user_id":5281466,"accept_rate":62,"display_name":"Matrix12"},"score":0,"creation_date":1694771969,"post_id":77110306,"comment_id":135938211,"body_markdown":"Sorry yes I forgot add second version of method","body":"Sorry yes I forgot add second version of method"},{"owner":{"account_id":19118721,"reputation":6319,"user_id":13963086,"display_name":"k314159"},"score":1,"creation_date":1694776900,"post_id":77110306,"comment_id":135939031,"body_markdown":"Can you show the `TestBook.write` method?","body":"Can you show the <code>TestBook.write</code> method?"},{"owner":{"account_id":6871197,"reputation":456,"user_id":5281466,"accept_rate":62,"display_name":"Matrix12"},"score":0,"creation_date":1694777063,"post_id":77110306,"comment_id":135939048,"body_markdown":"This is standard method because I want to some how hack this method but at end of the end I kept original method.","body":"This is standard method because I want to some how hack this method but at end of the end I kept original method."},{"owner":{"account_id":19118721,"reputation":6319,"user_id":13963086,"display_name":"k314159"},"score":1,"creation_date":1694777165,"post_id":77110306,"comment_id":135939067,"body_markdown":"What do you mean by &quot;standard method&quot; and &quot;original method&quot;? In particular, does it use try-with-resources on the stream that is passed to it?","body":"What do you mean by &quot;standard method&quot; and &quot;original method&quot;? In particular, does it use try-with-resources on the stream that is passed to it?"},{"owner":{"account_id":6871197,"reputation":456,"user_id":5281466,"accept_rate":62,"display_name":"Matrix12"},"score":0,"creation_date":1694777397,"post_id":77110306,"comment_id":135939112,"body_markdown":"Updated description. You can see that there is not override this method...","body":"Updated description. You can see that there is not override this method..."},{"owner":{"account_id":964210,"reputation":1018,"user_id":987959,"display_name":"PJ Fanning"},"score":1,"creation_date":1694779513,"post_id":77110306,"comment_id":135939526,"body_markdown":"Have you considered an async API? The initial request specifies the inputs and a callback address. The xlsx is produced asynchronously and POSTed to the callback address when ready. There is also this sample - https://svn.apache.org/repos/asf/poi/trunk/poi-examples/src/main/java/org/apache/poi/examples/xssf/streaming/DeferredGeneration.java that might provide a synchronous solution.","body":"Have you considered an async API? The initial request specifies the inputs and a callback address. The xlsx is produced asynchronously and POSTed to the callback address when ready. There is also this sample - <a href=\"https://svn.apache.org/repos/asf/poi/trunk/poi-examples/src/main/java/org/apache/poi/examples/xssf/streaming/DeferredGeneration.java\" rel=\"nofollow noreferrer\">svn.apache.org/repos/asf/poi/trunk/poi-examples/src/main/jav&zwnj;&#8203;a/&hellip;</a> that might provide a synchronous solution."},{"owner":{"account_id":964210,"reputation":1018,"user_id":987959,"display_name":"PJ Fanning"},"score":1,"creation_date":1694779913,"post_id":77110306,"comment_id":135939602,"body_markdown":"You must note that xlsx file format is not designed for smooth streaming - it is basically a zip file with multiple files contained within it, that have linked data. If you want to stream large data, you should consider a more streamable format like CSV.","body":"You must note that xlsx file format is not designed for smooth streaming - it is basically a zip file with multiple files contained within it, that have linked data. If you want to stream large data, you should consider a more streamable format like CSV."},{"owner":{"account_id":6871197,"reputation":456,"user_id":5281466,"accept_rate":62,"display_name":"Matrix12"},"score":0,"creation_date":1695020735,"post_id":77110306,"comment_id":135962970,"body_markdown":"Async API doesn&#39;t help in that case because an issue is that if you have a million of records you have to put all of them into memory. Jackson has a streaming approach for CSV and is possible to flush the buffer after some page and that doesn&#39;t allocate memory so much. Time is not a problem but memory allocation does it.","body":"Async API doesn&#39;t help in that case because an issue is that if you have a million of records you have to put all of them into memory. Jackson has a streaming approach for CSV and is possible to flush the buffer after some page and that doesn&#39;t allocate memory so much. Time is not a problem but memory allocation does it."}],"answers":[{"tags":[],"owner":{"account_id":19118721,"reputation":6319,"user_id":13963086,"display_name":"k314159"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694777908,"creation_date":1694777908,"answer_id":77112058,"question_id":77110306,"body_markdown":"Your workbook is a subclass of `SXSSFWorkbook`. With that kind of class, you shouldn&#39;t call `write()` in a loop with the same output stream, because, as you can see from the source code, it passes the stream to `injectData` which wraps the stream into a ZipOutputStream, writes to it and then closes the ZipOutputStream which causes the underlying stream (_your_ stream) to also be closed.\r\n\r\nThe second iteration of your loop then calls `write()` with an already-closed output stream.\r\n\r\nYou should take the `write()` call outside of your for-loop and call it just after the loop.","title":"Apache POI streaming write XLSX directly to IO","body":"<p>Your workbook is a subclass of <code>SXSSFWorkbook</code>. With that kind of class, you shouldn't call <code>write()</code> in a loop with the same output stream, because, as you can see from the source code, it passes the stream to <code>injectData</code> which wraps the stream into a ZipOutputStream, writes to it and then closes the ZipOutputStream which causes the underlying stream (<em>your</em> stream) to also be closed.</p>\n<p>The second iteration of your loop then calls <code>write()</code> with an already-closed output stream.</p>\n<p>You should take the <code>write()</code> call outside of your for-loop and call it just after the loop.</p>\n"}],"owner":{"account_id":6871197,"reputation":456,"user_id":5281466,"accept_rate":62,"display_name":"Matrix12"},"comment_count":16,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":134,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1694777908,"creation_date":1694761640,"question_id":77110306,"body_markdown":"I have a web application where I want to return XLSX with a huge number of records without OOM. I want to write every page to OutputStream and flush in the loop. The problem is that I get an exception. \r\n```\r\njava.io.IOException: Stream closed\r\n\tat java.base/java.io.BufferedWriter.ensureOpen(BufferedWriter.java:132) ~[na:na]\r\n\tat java.base/java.io.BufferedWriter.implWrite(BufferedWriter.java:325) ~[na:na]\r\n\tat java.base/java.io.BufferedWriter.write(BufferedWriter.java:313) ~[na:na]\r\n\tat java.base/java.io.Writer.write(Writer.java:278) ~[na:na]\r\n```\r\n\r\nIs it possible to write data to OS page by page or only possible way is loading everything to memory?\r\n\r\n\r\n\r\nMy code is: \r\n\r\n```\r\n  public void export(final OutputStream os)  {\r\n        \r\n        try (SXSSFWorkbook workbook = new SXSSFWorkbook(-1)) {\r\n\r\n            final SXSSFSheet sheet = workbook.createSheet();\r\n\r\n\r\n            for (int i = 0; i &lt; 100; i++) {\r\n                final SXSSFRow row = sheet.createRow(i);\r\n                final SXSSFCell cell = row.createCell(0, CellType.STRING);\r\n                cell.setCellValue(&quot;Test&quot;);\r\n\r\n                try {\r\n                    workbook.writeAvoidingTempFiles(os);\r\n                    os.flush();\r\n                } catch (IOException e) {\r\n                    log.info(&quot;Error&quot;, e);\r\n                }\r\n\r\n            }\r\n            workbook.dispose();\r\n        } catch (IOException e) {\r\n            throw new RuntimeException(e);\r\n        }\r\n\r\n    }\r\n}\r\n\r\npublic void export(final HttpServletResponse httpServletResponse) throws IOException {\r\n        \r\n        try (TestBook workbook = new TestBook()) {\r\n\r\n            final SXSSFSheet sheet = workbook.createSheet();\r\n\r\n\r\n            for (int i = 0; i &lt; 100; i++) {\r\n                final SXSSFRow row = sheet.createRow(i);\r\n                final SXSSFCell cell = row.createCell(0, CellType.STRING);\r\n                cell.setCellValue(&quot;Test&quot;);\r\n                workbook.write(httpServletResponse.getOutputStream());\r\n                httpServletResponse.flushBuffer();\r\n            }\r\n        }\r\n    }\r\n\r\n```\r\n\r\n\r\nController code: \r\n\r\n```java\r\n@GetMapping(produces = MediaType.APPLICATION_OCTET_STREAM_VALUE, path = &quot;/1&quot;)\r\n    public ResponseEntity&lt;StreamingResponseBody&gt; download1() {\r\n return ResponseEntity .ok()\r\n                .contentType(MediaType.APPLICATION_OCTET_STREAM)\r\n                .header(HttpHeaders.CONTENT_DISPOSITION, &quot;inline;filename=\\&quot;&quot; +\r\n                       &quot;test&quot; +\r\n                        &quot;.xlsx\\&quot;&quot;)\r\n                .body(exportService::export);\r\n    }\r\n\r\n    @GetMapping(produces = MediaType.APPLICATION_OCTET_STREAM_VALUE, path = &quot;/2&quot;)\r\n    public void download2(final HttpServletResponse httpServletResponse) throws IOException {\r\n\r\n        httpServletResponse.setHeader(&quot;Content-Type&quot;, MediaType.APPLICATION_OCTET_STREAM_VALUE);\r\n        httpServletResponse.setHeader(HttpHeaders.CONTENT_DISPOSITION, &quot;inline;filename=\\&quot;&quot; +\r\n                &quot;test2&quot; +\r\n                &quot;.xlsx\\&quot;&quot;);\r\n\r\n        exportService.export(httpServletResponse);\r\n    }\r\n\r\n```\r\n```\r\nstatic class TestBook extends SXSSFWorkbook {\r\n        public TestBook() {\r\n            super(-1);\r\n        }\r\n    }\r\n```\r\n\r\n\r\n\r\noriginam write method looks like: \r\n```\r\n    public void write(OutputStream stream) throws IOException {\r\n        flushSheets();\r\n\r\n        //Save the template\r\n        File tmplFile = TempFile.createTempFile(&quot;poi-sxssf-template&quot;, &quot;.xlsx&quot;);\r\n        boolean deleted;\r\n        try {\r\n            try (FileOutputStream os = new FileOutputStream(tmplFile)) {\r\n                _wb.write(os);\r\n            }\r\n\r\n            //Substitute the template entries with the generated sheet data files\r\n            try (\r\n                    ZipSecureFile zf = new ZipSecureFile(tmplFile);\r\n                    ZipFileZipEntrySource source = new ZipFileZipEntrySource(zf)\r\n            ) {\r\n                injectData(source, stream);\r\n            }\r\n        } finally {\r\n            deleted = tmplFile.delete();\r\n        }\r\n        if (!deleted) {\r\n            throw new IOException(&quot;Could not delete temporary file after processing: &quot; + tmplFile);\r\n        }\r\n    }\r\n```\r\n  ","title":"Apache POI streaming write XLSX directly to IO","body":"<p>I have a web application where I want to return XLSX with a huge number of records without OOM. I want to write every page to OutputStream and flush in the loop. The problem is that I get an exception.</p>\n<pre><code>java.io.IOException: Stream closed\n    at java.base/java.io.BufferedWriter.ensureOpen(BufferedWriter.java:132) ~[na:na]\n    at java.base/java.io.BufferedWriter.implWrite(BufferedWriter.java:325) ~[na:na]\n    at java.base/java.io.BufferedWriter.write(BufferedWriter.java:313) ~[na:na]\n    at java.base/java.io.Writer.write(Writer.java:278) ~[na:na]\n</code></pre>\n<p>Is it possible to write data to OS page by page or only possible way is loading everything to memory?</p>\n<p>My code is:</p>\n<pre><code>  public void export(final OutputStream os)  {\n        \n        try (SXSSFWorkbook workbook = new SXSSFWorkbook(-1)) {\n\n            final SXSSFSheet sheet = workbook.createSheet();\n\n\n            for (int i = 0; i &lt; 100; i++) {\n                final SXSSFRow row = sheet.createRow(i);\n                final SXSSFCell cell = row.createCell(0, CellType.STRING);\n                cell.setCellValue(&quot;Test&quot;);\n\n                try {\n                    workbook.writeAvoidingTempFiles(os);\n                    os.flush();\n                } catch (IOException e) {\n                    log.info(&quot;Error&quot;, e);\n                }\n\n            }\n            workbook.dispose();\n        } catch (IOException e) {\n            throw new RuntimeException(e);\n        }\n\n    }\n}\n\npublic void export(final HttpServletResponse httpServletResponse) throws IOException {\n        \n        try (TestBook workbook = new TestBook()) {\n\n            final SXSSFSheet sheet = workbook.createSheet();\n\n\n            for (int i = 0; i &lt; 100; i++) {\n                final SXSSFRow row = sheet.createRow(i);\n                final SXSSFCell cell = row.createCell(0, CellType.STRING);\n                cell.setCellValue(&quot;Test&quot;);\n                workbook.write(httpServletResponse.getOutputStream());\n                httpServletResponse.flushBuffer();\n            }\n        }\n    }\n\n</code></pre>\n<p>Controller code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@GetMapping(produces = MediaType.APPLICATION_OCTET_STREAM_VALUE, path = &quot;/1&quot;)\n    public ResponseEntity&lt;StreamingResponseBody&gt; download1() {\n return ResponseEntity .ok()\n                .contentType(MediaType.APPLICATION_OCTET_STREAM)\n                .header(HttpHeaders.CONTENT_DISPOSITION, &quot;inline;filename=\\&quot;&quot; +\n                       &quot;test&quot; +\n                        &quot;.xlsx\\&quot;&quot;)\n                .body(exportService::export);\n    }\n\n    @GetMapping(produces = MediaType.APPLICATION_OCTET_STREAM_VALUE, path = &quot;/2&quot;)\n    public void download2(final HttpServletResponse httpServletResponse) throws IOException {\n\n        httpServletResponse.setHeader(&quot;Content-Type&quot;, MediaType.APPLICATION_OCTET_STREAM_VALUE);\n        httpServletResponse.setHeader(HttpHeaders.CONTENT_DISPOSITION, &quot;inline;filename=\\&quot;&quot; +\n                &quot;test2&quot; +\n                &quot;.xlsx\\&quot;&quot;);\n\n        exportService.export(httpServletResponse);\n    }\n\n</code></pre>\n<pre><code>static class TestBook extends SXSSFWorkbook {\n        public TestBook() {\n            super(-1);\n        }\n    }\n</code></pre>\n<p>originam write method looks like:</p>\n<pre><code>    public void write(OutputStream stream) throws IOException {\n        flushSheets();\n\n        //Save the template\n        File tmplFile = TempFile.createTempFile(&quot;poi-sxssf-template&quot;, &quot;.xlsx&quot;);\n        boolean deleted;\n        try {\n            try (FileOutputStream os = new FileOutputStream(tmplFile)) {\n                _wb.write(os);\n            }\n\n            //Substitute the template entries with the generated sheet data files\n            try (\n                    ZipSecureFile zf = new ZipSecureFile(tmplFile);\n                    ZipFileZipEntrySource source = new ZipFileZipEntrySource(zf)\n            ) {\n                injectData(source, stream);\n            }\n        } finally {\n            deleted = tmplFile.delete();\n        }\n        if (!deleted) {\n            throw new IOException(&quot;Could not delete temporary file after processing: &quot; + tmplFile);\n        }\n    }\n</code></pre>\n"},{"tags":["java","spring-boot","auth0"],"comments":[{"owner":{"account_id":25538,"reputation":8278,"user_id":65681,"accept_rate":73,"display_name":"Matt Raible"},"score":0,"creation_date":1693009404,"post_id":76980925,"comment_id":135707800,"body_markdown":"I&#39;d be happy to help! I work for Auth0 and I&#39;ve done a lot with Spring Security over the years. If you don&#39;t find an answer here, let me know.","body":"I&#39;d be happy to help! I work for Auth0 and I&#39;ve done a lot with Spring Security over the years. If you don&#39;t find an answer here, let me know."}],"answers":[{"tags":[],"owner":{"account_id":19741384,"reputation":77,"user_id":14454716,"display_name":"Kabil"},"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1693025880,"creation_date":1693025880,"answer_id":76981616,"question_id":76980925,"body_markdown":"recently I also found this difficult, but somehow I managed to tackle this by learning the [lambda][1] a little deeper.\r\n\r\n\r\nand this is how I configured the &#39;[securityFilterChain][2]()&#39;\r\n\r\n\r\n    @Configuration\r\n    @EnableWebSecurity\r\n    @RequiredArgsConstructor\r\n    public class SecurityConfiguration {\r\n    \r\n    \r\n        private final JwtAuthenticationFilter jwtAuthFilter;\r\n        private final AuthenticationProvider authProvider;\r\n    \r\n    \r\n        @Bean\r\n       public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\r\n            http\r\n                    .csrf(AbstractHttpConfigurer::disable);\r\n            http\r\n                    .authorizeHttpRequests(\r\n                            (request)-&gt;\r\n                                    request\r\n                    .requestMatchers(&quot;api/auth/**&quot;).permitAll().anyRequest().authenticated());\r\n            http\r\n                    .sessionManagement(\r\n                            (session)-&gt;\r\n                                    session\r\n                                            .sessionCreationPolicy(SessionCreationPolicy.STATELESS));\r\n            http\r\n                    .authenticationProvider(authProvider);\r\n            http\r\n                    .addFilterBefore(jwtAuthFilter, UsernamePasswordAuthenticationFilter.class);\r\n            return http.build();\r\n        }\r\n       }\r\n\r\n\r\n  [1]: https://www.youtube.com/playlist?list=PLqq-6Pq4lTTa9YGfyhyW2CqdtW9RtY-I3\r\n  [2]: https://www.youtube.com/watch?v=KxqlJblhzfI","title":"Spring Security deprecated methods","body":"<p>recently I also found this difficult, but somehow I managed to tackle this by learning the <a href=\"https://www.youtube.com/playlist?list=PLqq-6Pq4lTTa9YGfyhyW2CqdtW9RtY-I3\" rel=\"nofollow noreferrer\">lambda</a> a little deeper.</p>\n<p>and this is how I configured the '<a href=\"https://www.youtube.com/watch?v=KxqlJblhzfI\" rel=\"nofollow noreferrer\">securityFilterChain</a>()'</p>\n<pre><code>@Configuration\n@EnableWebSecurity\n@RequiredArgsConstructor\npublic class SecurityConfiguration {\n\n\n    private final JwtAuthenticationFilter jwtAuthFilter;\n    private final AuthenticationProvider authProvider;\n\n\n    @Bean\n   public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n        http\n                .csrf(AbstractHttpConfigurer::disable);\n        http\n                .authorizeHttpRequests(\n                        (request)-&gt;\n                                request\n                .requestMatchers(&quot;api/auth/**&quot;).permitAll().anyRequest().authenticated());\n        http\n                .sessionManagement(\n                        (session)-&gt;\n                                session\n                                        .sessionCreationPolicy(SessionCreationPolicy.STATELESS));\n        http\n                .authenticationProvider(authProvider);\n        http\n                .addFilterBefore(jwtAuthFilter, UsernamePasswordAuthenticationFilter.class);\n        return http.build();\n    }\n   }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4609024,"reputation":85,"user_id":3737666,"display_name":"Artur Uvarov"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1694777551,"creation_date":1694777551,"answer_id":77112007,"question_id":76980925,"body_markdown":"I encountered numerous errors while attempting to validate the token, with CORS-related issues being prominent among them.\r\n\r\nBy adding the following line to my app.properties, I discovered that the request method from my frontend was &quot;OPTIONS&quot; instead of the &quot;GET&quot; I had intended:\r\n\r\n    logging.level.org.springframework.security=TRACE\r\n\r\nTo address this, I included a specific line in my matchers. While this resolved the issue, I&#39;m uncertain about its security implications.\r\n\r\n    .requestMatchers(HttpMethod.OPTIONS, &quot;/places/**&quot;).permitAll()","title":"Spring Security deprecated methods","body":"<p>I encountered numerous errors while attempting to validate the token, with CORS-related issues being prominent among them.</p>\n<p>By adding the following line to my app.properties, I discovered that the request method from my frontend was &quot;OPTIONS&quot; instead of the &quot;GET&quot; I had intended:</p>\n<pre><code>logging.level.org.springframework.security=TRACE\n</code></pre>\n<p>To address this, I included a specific line in my matchers. While this resolved the issue, I'm uncertain about its security implications.</p>\n<pre><code>.requestMatchers(HttpMethod.OPTIONS, &quot;/places/**&quot;).permitAll()\n</code></pre>\n"}],"owner":{"account_id":4609024,"reputation":85,"user_id":3737666,"display_name":"Artur Uvarov"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":194,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77112007,"answer_count":2,"score":0,"last_activity_date":1694777551,"creation_date":1693004165,"question_id":76980925,"body_markdown":"Currently I&#39;m learning Java Spring Boot, and trying to implement auth0 in my backend app. I&#39;m stuck with configuring SecurityFilterChain - in tutorial at spring academy they use deprecated methods to configure filter chain, authorizeRequests not used without parameters, but through lambda function. I found how to implement simple login-password authorization, but I want to use JWT token which I receive after login in my react app\r\n\r\nWhere I can read about latest usage of spring security, because both spring and auth0 resources use deprecated components?\r\n\r\nThank you and sorry if it is a dumb question, I tried google it","title":"Spring Security deprecated methods","body":"<p>Currently I'm learning Java Spring Boot, and trying to implement auth0 in my backend app. I'm stuck with configuring SecurityFilterChain - in tutorial at spring academy they use deprecated methods to configure filter chain, authorizeRequests not used without parameters, but through lambda function. I found how to implement simple login-password authorization, but I want to use JWT token which I receive after login in my react app</p>\n<p>Where I can read about latest usage of spring security, because both spring and auth0 resources use deprecated components?</p>\n<p>Thank you and sorry if it is a dumb question, I tried google it</p>\n"},{"tags":["java","spring","spring-boot"],"comments":[{"owner":{"account_id":801373,"reputation":179,"user_id":865604,"accept_rate":50,"display_name":"Romain Moreau"},"score":0,"creation_date":1394720524,"post_id":22380119,"comment_id":34023655,"body_markdown":"Are you using Maven or Gradle ?","body":"Are you using Maven or Gradle ?"},{"owner":{"account_id":1311122,"reputation":56893,"user_id":1259109,"display_name":"Dave Syer"},"score":1,"creation_date":1394723807,"post_id":22380119,"comment_id":34026479,"body_markdown":"Your `ApplicationContext` is the wrong type (`AnnotationConfigApplicationContext`), so it&#39;s not a webapp. It should default to a value that depends on your classpath, so it looks like that is being set or defaulted the wrong way. Maybe you have an `application.properties` or an ENV var your are not showing?","body":"Your <code>ApplicationContext</code> is the wrong type (<code>AnnotationConfigApplicationContext</code>), so it&#39;s not a webapp. It should default to a value that depends on your classpath, so it looks like that is being set or defaulted the wrong way. Maybe you have an <code>application.properties</code> or an ENV var your are not showing?"},{"owner":{"account_id":936367,"reputation":4282,"user_id":965229,"accept_rate":84,"display_name":"johnsam"},"score":0,"creation_date":1394725098,"post_id":22380119,"comment_id":34027473,"body_markdown":"You are right. My ApplicationContext is incorrect. I don&#39;t have an application.properties file. How do I make it run the right ApplicationContext? Maybe a web ApplicationContext?","body":"You are right. My ApplicationContext is incorrect. I don&#39;t have an application.properties file. How do I make it run the right ApplicationContext? Maybe a web ApplicationContext?"},{"owner":{"account_id":1311122,"reputation":56893,"user_id":1259109,"display_name":"Dave Syer"},"score":0,"creation_date":1394726204,"post_id":22380119,"comment_id":34028366,"body_markdown":"Let&#39;s try and simplify the build. Can you remove all dependencies except spring-boot-starter-web, and then run with `--debug` on the command line and post the logs back here, please?","body":"Let&#39;s try and simplify the build. Can you remove all dependencies except spring-boot-starter-web, and then run with <code>--debug</code> on the command line and post the logs back here, please?"},{"owner":{"account_id":936367,"reputation":4282,"user_id":965229,"accept_rate":84,"display_name":"johnsam"},"score":0,"creation_date":1394726757,"post_id":22380119,"comment_id":34028808,"body_markdown":"Dave, I updated my original post since the responses were too long.","body":"Dave, I updated my original post since the responses were too long."},{"owner":{"account_id":1311122,"reputation":56893,"user_id":1259109,"display_name":"Dave Syer"},"score":0,"creation_date":1394727494,"post_id":22380119,"comment_id":34029304,"body_markdown":"It&#39;s not really telling us anything new (except that Jetty isn&#39;t the problem). Can you double check your environment (`env | grep -i spring` for instance)? And the output from `--debug` would really help so if you can paste it somewhere that would be great.","body":"It&#39;s not really telling us anything new (except that Jetty isn&#39;t the problem). Can you double check your environment (<code>env | grep -i spring</code> for instance)? And the output from <code>--debug</code> would really help so if you can paste it somewhere that would be great."},{"owner":{"account_id":936367,"reputation":4282,"user_id":965229,"accept_rate":84,"display_name":"johnsam"},"score":0,"creation_date":1394738897,"post_id":22380119,"comment_id":34037388,"body_markdown":"Dave, env | grep -i spring\nOLDPWD=/u/xxx/dev/gs-spring-boot\nPWD=/u/xxx/dev/gs-spring-boot/initial\njava  -jar --debug build/libs/gs-spring-boot-0.1.0.jar\nUnrecognized option: --debug\nCould not create the Java virtual machine.","body":"Dave, env | grep -i spring OLDPWD=/u/xxx/dev/gs-spring-boot PWD=/u/xxx/dev/gs-spring-boot/initial java  -jar --debug build/libs/gs-spring-boot-0.1.0.jar Unrecognized option: --debug Could not create the Java virtual machine."},{"owner":{"account_id":936367,"reputation":4282,"user_id":965229,"accept_rate":84,"display_name":"johnsam"},"score":0,"creation_date":1394741189,"post_id":22380119,"comment_id":34038678,"body_markdown":"Dave it is working now. There was a bad line in build.gradle. I&#39;ve updated my original post.","body":"Dave it is working now. There was a bad line in build.gradle. I&#39;ve updated my original post."},{"owner":{"account_id":4351632,"reputation":8739,"user_id":3551773,"accept_rate":10,"display_name":"Bravo"},"score":0,"creation_date":1517231177,"post_id":22380119,"comment_id":83997223,"body_markdown":"my spring boot app , has that dependency , but still is restarting , is their any other i need to check , can you please help me","body":"my spring boot app , has that dependency , but still is restarting , is their any other i need to check , can you please help me"}],"answers":[{"tags":[],"owner":{"account_id":1311122,"reputation":56893,"user_id":1259109,"display_name":"Dave Syer"},"down_vote_count":2,"up_vote_count":529,"is_accepted":true,"score":527,"last_activity_date":1469645227,"creation_date":1394811777,"answer_id":22409655,"question_id":22380119,"body_markdown":"Resolution: the app is not a webapp because it doesn&#39;t have an embedded container (e.g. Tomcat) on the classpath. Adding one fixed it. If you are using **Maven**, then add this in `pom.xml`:\r\n\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n    &lt;/dependency&gt;\r\n\r\nFor **Gradle** (`build.gradle`) it looks like\r\n\r\n    dependencies {\r\n        compile &#39;org.springframework.boot:spring-boot-starter-web&#39;\r\n    }","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>Resolution: the app is not a webapp because it doesn't have an embedded container (e.g. Tomcat) on the classpath. Adding one fixed it. If you are using <strong>Maven</strong>, then add this in <code>pom.xml</code>:</p>\n\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre>\n\n<p>For <strong>Gradle</strong> (<code>build.gradle</code>) it looks like</p>\n\n<pre><code>dependencies {\n    compile 'org.springframework.boot:spring-boot-starter-web'\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":6532405,"reputation":127,"user_id":5053142,"display_name":"Ajay Menon"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1482685234,"creation_date":1482685234,"answer_id":41322976,"question_id":22380119,"body_markdown":"I think the right answer was at https://stackoverflow.com/questions/24214224/why-does-spring-boot-web-app-close-immediately-after-starting about the starter-tomcat not being set and if set and running through the IDE, the provided scope should be commented off. Scope doesn&#39;t create an issue while running through command. I wonder why.\r\n\r\nAnyways just added my additional thoughts.","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>I think the right answer was at <a href=\"https://stackoverflow.com/questions/24214224/why-does-spring-boot-web-app-close-immediately-after-starting\">Why does Spring Boot web app close immediately after starting?</a> about the starter-tomcat not being set and if set and running through the IDE, the provided scope should be commented off. Scope doesn't create an issue while running through command. I wonder why.</p>\n\n<p>Anyways just added my additional thoughts.</p>\n"},{"tags":[],"owner":{"account_id":7836979,"reputation":1181,"user_id":7581696,"display_name":"N. berouain"},"down_vote_count":0,"up_vote_count":49,"is_accepted":false,"score":49,"last_activity_date":1684879995,"creation_date":1490878767,"answer_id":43118630,"question_id":22380119,"body_markdown":"I had the same problem but when I removed the below dependency it worked fine\r\n\r\n```xml\r\n&lt;dependency&gt;\r\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n    &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;\r\n    &lt;scope&gt;provided&lt;/scope&gt;\r\n&lt;/dependency&gt;\r\n\r\n```\r\n\r\nit started working again.","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>I had the same problem but when I removed the below dependency it worked fine</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;\n    &lt;scope&gt;provided&lt;/scope&gt;\n&lt;/dependency&gt;\n\n</code></pre>\n<p>it started working again.</p>\n"},{"tags":[],"owner":{"account_id":93940,"reputation":5106,"user_id":256770,"accept_rate":31,"display_name":"Farrukh Najmi"},"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1495022385,"creation_date":1494960516,"answer_id":44009328,"question_id":22380119,"body_markdown":"In my case the problem was introduced when I fixed a static analysis error that the return value of a method was not used.\r\n\r\nOld working code in my Application.java was:\r\n\r\n        public static void main(String[] args) {        \r\n          SpringApplication.run(Application.class, args);\r\n        }\r\n\r\nNew code that introduced the problem was:\r\n\r\n        public static void main(String[] args) {        \r\n          try (ConfigurableApplicationContext context = \r\n              SpringApplication.run(Application.class, args)) {\r\n            LOG.trace(&quot;context: &quot; + context);\r\n          }\r\n        }\r\n\r\nObviously, the try with resource block will close the context after starting the application which will result in the application exiting with status 0. This was a case where the resource leak error reported by snarqube static analysis should be ignored.","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>In my case the problem was introduced when I fixed a static analysis error that the return value of a method was not used.</p>\n\n<p>Old working code in my Application.java was:</p>\n\n<pre><code>    public static void main(String[] args) {        \n      SpringApplication.run(Application.class, args);\n    }\n</code></pre>\n\n<p>New code that introduced the problem was:</p>\n\n<pre><code>    public static void main(String[] args) {        \n      try (ConfigurableApplicationContext context = \n          SpringApplication.run(Application.class, args)) {\n        LOG.trace(\"context: \" + context);\n      }\n    }\n</code></pre>\n\n<p>Obviously, the try with resource block will close the context after starting the application which will result in the application exiting with status 0. This was a case where the resource leak error reported by snarqube static analysis should be ignored.</p>\n"},{"tags":[],"owner":{"account_id":330394,"reputation":671,"user_id":654487,"display_name":"chatsap"},"down_vote_count":0,"up_vote_count":39,"is_accepted":false,"score":39,"last_activity_date":1505726386,"creation_date":1505721174,"answer_id":46274214,"question_id":22380119,"body_markdown":"Here is how you can fix it:\r\n\r\n1. Check if you don&#39;t have dependency on spring-boot-starter-web in your pom.xml file. To get you pom.xml file right, use this link [start.spring.io][1]\r\n\r\n2. If you have above dependency, but still facing the issue, it is highly possible that your embedded tomcat jars are present. \r\nTo confirm this, run maven build in debug mode - \r\n\r\n&gt; `mvn spring-boot:run --debug`\r\n\r\n and look for messages like - \r\n\r\n&gt; `[WARNING] error reading\r\n&gt; /Users/sparrowmac1/.m2/repository/org/apache/tomcat/embed/tomcat-embed-core/8.5.20/tomcat-embed-core-8.5.20.jar;\r\n&gt; invalid LOC header (bad signature) [WARNING] error reading\r\n&gt; /Users/sparrowmac1/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.8.10/jackson-core-2.8.10.jar;\r\n&gt; invalid LOC header (bad signature)`\r\n\r\nIf such messages are present, purge your local maven repo and try again - \r\n\r\n&gt; `mvn dependency:purge-local-repository`\r\n\r\n\r\n  [1]: http://start.spring.io","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>Here is how you can fix it:</p>\n\n<ol>\n<li><p>Check if you don't have dependency on spring-boot-starter-web in your pom.xml file. To get you pom.xml file right, use this link <a href=\"http://start.spring.io\" rel=\"noreferrer\">start.spring.io</a></p></li>\n<li><p>If you have above dependency, but still facing the issue, it is highly possible that your embedded tomcat jars are present. \nTo confirm this, run maven build in debug mode - </p></li>\n</ol>\n\n<blockquote>\n  <p><code>mvn spring-boot:run --debug</code></p>\n</blockquote>\n\n<p>and look for messages like - </p>\n\n<blockquote>\n  <p><code>[WARNING] error reading\n  /Users/sparrowmac1/.m2/repository/org/apache/tomcat/embed/tomcat-embed-core/8.5.20/tomcat-embed-core-8.5.20.jar;\n  invalid LOC header (bad signature) [WARNING] error reading\n  /Users/sparrowmac1/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.8.10/jackson-core-2.8.10.jar;\n  invalid LOC header (bad signature)</code></p>\n</blockquote>\n\n<p>If such messages are present, purge your local maven repo and try again - </p>\n\n<blockquote>\n  <p><code>mvn dependency:purge-local-repository</code></p>\n</blockquote>\n"},{"tags":[],"owner":{"account_id":7172640,"reputation":1225,"user_id":5479655,"accept_rate":44,"display_name":"Guchelkaben"},"down_vote_count":1,"up_vote_count":9,"is_accepted":false,"score":8,"last_activity_date":1510685476,"creation_date":1510685476,"answer_id":47293212,"question_id":22380119,"body_markdown":"Maybe it does not fit to your code but i found out if you have a code snippet like this:\r\n\r\n    @SpringBootApplication\r\n    public class SpringBootApacheKafkaApplication {\r\n    \r\n    \tpublic static void main(String[] args) {\r\n    \t\tSpringApplication.run(SpringBootApacheKafkaApplication.class,args).close();\r\n    \t}\r\n    }\r\n\r\nthen just remove the close() method. That&#39;s fixed my problem! Maybe I can help someone with that","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>Maybe it does not fit to your code but i found out if you have a code snippet like this:</p>\n\n<pre><code>@SpringBootApplication\npublic class SpringBootApacheKafkaApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(SpringBootApacheKafkaApplication.class,args).close();\n    }\n}\n</code></pre>\n\n<p>then just remove the close() method. That's fixed my problem! Maybe I can help someone with that</p>\n"},{"tags":[],"owner":{"account_id":10593696,"reputation":114,"user_id":7803285,"display_name":"RAUL"},"down_vote_count":1,"up_vote_count":2,"is_accepted":false,"score":1,"last_activity_date":1521496336,"creation_date":1521496336,"answer_id":49372950,"question_id":22380119,"body_markdown":"this work with spring boot 2.0.0\r\n\r\nreplace\r\n\r\n      &lt;dependency&gt;\r\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n        &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;\r\n        &lt;scope&gt;provided&lt;/scope&gt;\r\n            &lt;/dependency&gt;\r\n\r\nwith\r\n\r\n    &lt;dependency&gt;\r\n    &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;\r\n    &lt;artifactId&gt;tomcat-embed-core&lt;/artifactId&gt;\r\n    &lt;version&gt;9.0.6&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n\r\n   ","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>this work with spring boot 2.0.0</p>\n\n<p>replace</p>\n\n<pre><code>  &lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;\n    &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n</code></pre>\n\n<p>with</p>\n\n<pre><code>&lt;dependency&gt;\n&lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;\n&lt;artifactId&gt;tomcat-embed-core&lt;/artifactId&gt;\n&lt;version&gt;9.0.6&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":11468218,"reputation":5521,"user_id":8405835,"display_name":"Abhijit Pritam Dutta"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1521718939,"creation_date":1521718939,"answer_id":49427779,"question_id":22380119,"body_markdown":"In my case I fixed this issue like below:-\r\n\r\n1. First I removed (apache) `C:\\Users\\myuserId\\.m2\\repository\\org\\apache`\r\n\r\n2. I added below dependencies in my `pom.xml` file\r\n\r\n        &lt;dependency&gt;\r\n\t\t    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n3. I have changed the default socket by adding below lines in resource file  `..\\yourprojectfolder\\src\\main\\resourcesand\\application.properties`(I manually created this file)\r\n\r\n         server.port=8099\r\n         spring.profiles.active=@spring.profiles.active@\r\n\r\n for that I have added below block in my `pom.xml` under `&lt;build&gt;` section.\r\n      \r\n\r\n\r\n          &lt;build&gt;\r\n          .\r\n          .\r\n         &lt;resources&gt;\r\n\t        &lt;resource&gt;\r\n\t            &lt;directory&gt;src/main/resources&lt;/directory&gt;\r\n\t            &lt;filtering&gt;true&lt;/filtering&gt;\r\n\t        &lt;/resource&gt;\r\n        &lt;/resources&gt;\r\n\t       .\r\n           .\t\r\n          &lt;/build&gt;\r\n\r\nMy final `pom.xml` file look like\r\n\r\n\t&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n\t&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n\t\txsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n\t\t&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n\r\n\t\t&lt;groupId&gt;com.bhaiti&lt;/groupId&gt;\r\n\t\t&lt;artifactId&gt;spring-boot-rest&lt;/artifactId&gt;\r\n\t\t&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\r\n\t\t&lt;packaging&gt;jar&lt;/packaging&gt;\r\n\r\n\t\t&lt;name&gt;spring-boot-rest&lt;/name&gt;\r\n\t\t&lt;description&gt;Welcome project for Spring Boot&lt;/description&gt;\r\n\r\n\t\t&lt;parent&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;2.0.0.RELEASE&lt;/version&gt;\r\n\t\t\t&lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\r\n\t\t&lt;/parent&gt;\r\n\r\n\t\t&lt;properties&gt;\r\n\t\t\t&lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\r\n\t\t\t&lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;\r\n\t\t\t&lt;java.version&gt;1.8&lt;/java.version&gt;\r\n\t\t&lt;/properties&gt;\r\n\r\n\t\t&lt;dependencies&gt;\r\n\t\t\r\n\t\t\t&lt;dependency&gt;\r\n\t\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\r\n\t\t\t&lt;/dependency&gt;\r\n\t\t\t\r\n\t\t\t&lt;dependency&gt;\r\n\t\t\t\t&lt;groupId&gt;org.springframework&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;spring-web&lt;/artifactId&gt;\r\n\t\t\t&lt;/dependency&gt;\r\n\t\t\t\r\n\t\t\t&lt;dependency&gt;\r\n\t\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n\t\t\t&lt;/dependency&gt;\t\t\r\n\t\t\t\r\n\t\t\t&lt;dependency&gt;\r\n\t\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\r\n\t\t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n\t\t\t&lt;/dependency&gt;\r\n\t\t\t\r\n\t\t&lt;/dependencies&gt;\r\n\r\n\t\t&lt;build&gt;\r\n\t\t\t&lt;plugins&gt;\r\n\t\t\t\t&lt;plugin&gt;\r\n\t\t\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t\t\t&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n\t\t\t\t&lt;/plugin&gt;\r\n\t\t\t&lt;/plugins&gt;\r\n\t\t\t&lt;resources&gt;\r\n\t\t\t\t&lt;resource&gt;\r\n\t\t\t\t\t&lt;directory&gt;src/main/resources&lt;/directory&gt;\r\n\t\t\t\t\t&lt;filtering&gt;true&lt;/filtering&gt;\r\n\t\t\t\t&lt;/resource&gt;\r\n\t\t\t&lt;/resources&gt;\r\n\t\t\t\r\n\t\t&lt;/build&gt;\r\n\r\n\r\n\t&lt;/project&gt;\r\n\r\n\r\n","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>In my case I fixed this issue like below:-</p>\n\n<ol>\n<li><p>First I removed (apache) <code>C:\\Users\\myuserId\\.m2\\repository\\org\\apache</code></p></li>\n<li><p>I added below dependencies in my <code>pom.xml</code> file</p>\n\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre></li>\n<li><p>I have changed the default socket by adding below lines in resource file  <code>..\\yourprojectfolder\\src\\main\\resourcesand\\application.properties</code>(I manually created this file)</p>\n\n<pre><code> server.port=8099\n spring.profiles.active=@spring.profiles.active@\n</code></pre>\n\n<p>for that I have added below block in my <code>pom.xml</code> under <code>&lt;build&gt;</code> section.</p>\n\n<pre><code>  &lt;build&gt;\n  .\n  .\n &lt;resources&gt;\n    &lt;resource&gt;\n        &lt;directory&gt;src/main/resources&lt;/directory&gt;\n        &lt;filtering&gt;true&lt;/filtering&gt;\n    &lt;/resource&gt;\n&lt;/resources&gt;\n   .\n   .    \n  &lt;/build&gt;\n</code></pre></li>\n</ol>\n\n<p>My final <code>pom.xml</code> file look like</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;groupId&gt;com.bhaiti&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-rest&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;packaging&gt;jar&lt;/packaging&gt;\n\n    &lt;name&gt;spring-boot-rest&lt;/name&gt;\n    &lt;description&gt;Welcome project for Spring Boot&lt;/description&gt;\n\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;2.0.0.RELEASE&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n\n    &lt;properties&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;\n        &lt;java.version&gt;1.8&lt;/java.version&gt;\n    &lt;/properties&gt;\n\n    &lt;dependencies&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;       \n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n        &lt;resources&gt;\n            &lt;resource&gt;\n                &lt;directory&gt;src/main/resources&lt;/directory&gt;\n                &lt;filtering&gt;true&lt;/filtering&gt;\n            &lt;/resource&gt;\n        &lt;/resources&gt;\n\n    &lt;/build&gt;\n\n\n&lt;/project&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1948237,"reputation":2616,"user_id":1752917,"accept_rate":14,"display_name":"Mohammed Rafeeq"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1537433920,"creation_date":1537433920,"answer_id":52421266,"question_id":22380119,"body_markdown":"Just another possibility, \r\n\r\nI replaced \r\n\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\r\n        &lt;/dependency&gt;\r\n\r\nwith \r\n\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n        &lt;/dependency&gt;\r\n\r\nand it started without any issues","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>Just another possibility, </p>\n\n<p>I replaced </p>\n\n<pre><code>    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n</code></pre>\n\n<p>with </p>\n\n<pre><code>    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n</code></pre>\n\n<p>and it started without any issues</p>\n"},{"tags":[],"owner":{"account_id":3568486,"reputation":4276,"user_id":2979435,"accept_rate":42,"display_name":"deFreitas"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1545500660,"creation_date":1545500660,"answer_id":53897990,"question_id":22380119,"body_markdown":"If you don&#39;t want to make your spring a web application then just add `@EnableAsync` or `@EnableScheduling` to your Starter\r\n\r\n\r\n    @EnableAsync\r\n    @SpringBootApplication\r\n    public class App {\r\n    \tpublic static void main(String[] args) {\r\n    \t\tSpringApplication.run(App.class, args);\r\n    \t}\r\n\r\n    }\r\n\r\n","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>If you don't want to make your spring a web application then just add <code>@EnableAsync</code> or <code>@EnableScheduling</code> to your Starter</p>\n\n<pre><code>@EnableAsync\n@SpringBootApplication\npublic class App {\n    public static void main(String[] args) {\n        SpringApplication.run(App.class, args);\n    }\n\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":904228,"reputation":578,"user_id":939496,"display_name":"Pedro Muniz"},"down_vote_count":0,"up_vote_count":7,"is_accepted":false,"score":7,"last_activity_date":1678209502,"creation_date":1563370828,"answer_id":57077292,"question_id":22380119,"body_markdown":"Using gradle, I just replaced this line at build.gradle.kts file in dependencies block\r\n\r\n    providedRuntime(&quot;org.springframework.boot:spring-boot-starter-tomcat&quot;)\r\n\r\nto this\r\n\r\n    compile(&quot;org.springframework.boot:spring-boot-starter-web&quot;)\r\n\r\nand it worked fine.","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>Using gradle, I just replaced this line at build.gradle.kts file in dependencies block</p>\n<pre><code>providedRuntime(&quot;org.springframework.boot:spring-boot-starter-tomcat&quot;)\n</code></pre>\n<p>to this</p>\n<pre><code>compile(&quot;org.springframework.boot:spring-boot-starter-web&quot;)\n</code></pre>\n<p>and it worked fine.</p>\n"},{"tags":[],"owner":{"account_id":5619551,"reputation":653,"user_id":4449859,"display_name":"abdel"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1578399126,"creation_date":1578399126,"answer_id":59628203,"question_id":22380119,"body_markdown":"in my case i already had the maven dependency to &#39;spring-boot-starter-web&#39; and the project would start fine without auto-stopping when i run it as springboot app **from within the IDE**. however, when i deploy it to **K8s**, the app would start and auto-stop immediately. So i modified my main app class to extend SpringBootServletInitializer and this seems to have fixed the auto-stopping.\r\n\r\n    @SpringBootApplication public class MyApp extends SpringBootServletInitializer {  public static void main(String[] args) {\r\n    SpringApplication.run(MyApp.class, args);  }}","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>in my case i already had the maven dependency to 'spring-boot-starter-web' and the project would start fine without auto-stopping when i run it as springboot app <strong>from within the IDE</strong>. however, when i deploy it to <strong>K8s</strong>, the app would start and auto-stop immediately. So i modified my main app class to extend SpringBootServletInitializer and this seems to have fixed the auto-stopping.</p>\n\n<pre><code>@SpringBootApplication public class MyApp extends SpringBootServletInitializer {  public static void main(String[] args) {\nSpringApplication.run(MyApp.class, args);  }}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":458224,"reputation":37507,"user_id":857994,"accept_rate":97,"display_name":"John Humphreys"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1596406774,"creation_date":1596406774,"answer_id":63221558,"question_id":22380119,"body_markdown":"I went through the answers here and elsewhere and still had issues.  It turned that (like the op), I was running in kubernetes, and the app was fine, but kubernetes had an issue.\r\n\r\nI forgot to have my app start based on my port environment variable.  So, kubernetes/helm was telling it to run on 8443 and to liveness probe that, but it was running on some other port (like 8123) from my application.properties.\r\n\r\nThe kubernetes events (get events) showed the live-ness probe was failing, so kubernetes was killing the pod/app every 30 seconds or so.","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>I went through the answers here and elsewhere and still had issues.  It turned that (like the op), I was running in kubernetes, and the app was fine, but kubernetes had an issue.</p>\n<p>I forgot to have my app start based on my port environment variable.  So, kubernetes/helm was telling it to run on 8443 and to liveness probe that, but it was running on some other port (like 8123) from my application.properties.</p>\n<p>The kubernetes events (get events) showed the live-ness probe was failing, so kubernetes was killing the pod/app every 30 seconds or so.</p>\n"},{"tags":[],"owner":{"account_id":6942466,"reputation":721,"user_id":5328286,"display_name":"Erangad"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1601187069,"creation_date":1601187069,"answer_id":64085393,"question_id":22380119,"body_markdown":"I was having a similar problem. I only had the following starter web package.  \r\n    \r\n    &lt;dependency&gt;\r\n      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n      &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n    &lt;/dependency&gt;\r\n\r\nBut it is not enough. You need to add a parent too to get other required dependencies.\r\n\r\n    &lt;parent&gt;\r\n\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\r\n\t\t&lt;version&gt;2.2.4.RELEASE&lt;/version&gt;\r\n\t\t&lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\r\n\t&lt;/parent&gt;","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>I was having a similar problem. I only had the following starter web package.</p>\n<pre><code>&lt;dependency&gt;\n  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n  &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>But it is not enough. You need to add a parent too to get other required dependencies.</p>\n<pre><code>&lt;parent&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n    &lt;version&gt;2.2.4.RELEASE&lt;/version&gt;\n    &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n&lt;/parent&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":3058979,"reputation":169,"user_id":2592073,"display_name":"Michael Couck"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1601814469,"creation_date":1601814469,"answer_id":64194593,"question_id":22380119,"body_markdown":"If you have a circular spring injected dependency it will fail without warning, depending on the level of logging, and a few other factors.\r\n\r\nClass A injects Class B, and Class B injects Class A. Via constructor, in this particular case.","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>If you have a circular spring injected dependency it will fail without warning, depending on the level of logging, and a few other factors.</p>\n<p>Class A injects Class B, and Class B injects Class A. Via constructor, in this particular case.</p>\n"},{"tags":[],"owner":{"account_id":9412458,"reputation":697,"user_id":7001067,"display_name":"Hourglasser"},"down_vote_count":0,"up_vote_count":8,"is_accepted":false,"score":8,"last_activity_date":1606571507,"creation_date":1606571507,"answer_id":65050293,"question_id":22380119,"body_markdown":"I initialized a new SPring boot project in IntelliJIdea with Spring Boot dev tools, but in pom.xml I had only dependency\r\n\r\n     ...\r\n     &lt;dependency&gt;\r\n         &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n         &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\r\n     &lt;/dependency&gt;\r\n     ...\r\n\r\n  \r\nYou need to have also artifact **spring-boot-starter-web**. Just add this dependency to pom.xml\r\n\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n    &lt;/dependency&gt;","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>I initialized a new SPring boot project in IntelliJIdea with Spring Boot dev tools, but in pom.xml I had only dependency</p>\n<pre><code> ...\n &lt;dependency&gt;\n     &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n     &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\n &lt;/dependency&gt;\n ...\n</code></pre>\n<p>You need to have also artifact <strong>spring-boot-starter-web</strong>. Just add this dependency to pom.xml</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":18479864,"reputation":349,"user_id":13462325,"display_name":"Prashant S"},"down_vote_count":0,"up_vote_count":10,"is_accepted":false,"score":10,"last_activity_date":1610542216,"creation_date":1610542216,"answer_id":65702342,"question_id":22380119,"body_markdown":"My application is Spring boot batch and commenting below line in application.properties resolved the problem\r\n\r\n    spring.main.web-application-type=none","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>My application is Spring boot batch and commenting below line in application.properties resolved the problem</p>\n<pre><code>spring.main.web-application-type=none\n</code></pre>\n"},{"tags":[],"owner":{"account_id":13616153,"reputation":362,"user_id":9822004,"display_name":"MJL"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1613933556,"creation_date":1613933556,"answer_id":66305895,"question_id":22380119,"body_markdown":"I had this problem, and in my case it was caused by a simple clumsy mistake: my class had:\r\n\r\n    @SpringBootApplication\r\n    public class MyApplication implements ApplicationRunner {\r\n\r\n    public static void main(String[] args) {\r\n        SpringApplication.run(MyApplication.class, args);\r\n    }\r\n\r\n    public void run(ApplicationArguments args) throws Exception {\r\n\r\n    }\r\n}\r\n\r\nI removed the &quot;implements ApplicationRunner&quot; and the run method (which were there due to a copy-paste mistake) and then it worked","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>I had this problem, and in my case it was caused by a simple clumsy mistake: my class had:</p>\n<pre><code>@SpringBootApplication\npublic class MyApplication implements ApplicationRunner {\n\npublic static void main(String[] args) {\n    SpringApplication.run(MyApplication.class, args);\n}\n\npublic void run(ApplicationArguments args) throws Exception {\n\n}\n</code></pre>\n<p>}</p>\n<p>I removed the &quot;implements ApplicationRunner&quot; and the run method (which were there due to a copy-paste mistake) and then it worked</p>\n"},{"tags":[],"owner":{"account_id":229478,"reputation":4806,"user_id":1874113,"accept_rate":67,"display_name":"walkeros"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1621412526,"creation_date":1621412526,"answer_id":67599468,"question_id":22380119,"body_markdown":"If you are using Java 9 JPMS it is not enough to add spring-boot-starter-web as a dependency, as tomcat-embed lib would not be available at runtime and spring boot will not detect the app as web app.\r\n\r\nTo fix this make tomcat embed available via following directive added to your module-info.java for *main app*\r\n\r\n     requires org.apache.tomcat.embed.core;\r\n     ","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>If you are using Java 9 JPMS it is not enough to add spring-boot-starter-web as a dependency, as tomcat-embed lib would not be available at runtime and spring boot will not detect the app as web app.</p>\n<p>To fix this make tomcat embed available via following directive added to your module-info.java for <em>main app</em></p>\n<pre><code> requires org.apache.tomcat.embed.core;\n \n</code></pre>\n"},{"tags":[],"owner":{"account_id":9873136,"reputation":41,"user_id":7311954,"display_name":"emsnguyen"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1660476365,"creation_date":1660476365,"answer_id":73351234,"question_id":22380119,"body_markdown":"In my case, the problem happened when I tried to insert 5000 records into database (it worked okay with fewer records)&lt;br/&gt;\r\nWhat worked for me: Uncomment devtools dependency in pom.xml file:&lt;br/&gt;\r\n```\r\n&lt;dependency&gt;\r\n\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;\r\n\t&lt;optional&gt;true&lt;/optional&gt;\r\n&lt;/dependency&gt;\r\n```","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>In my case, the problem happened when I tried to insert 5000 records into database (it worked okay with fewer records)<br/>\nWhat worked for me: Uncomment devtools dependency in pom.xml file:<br/></p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;\n    &lt;optional&gt;true&lt;/optional&gt;\n&lt;/dependency&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":8594459,"reputation":814,"user_id":6437920,"display_name":"Joel Wembo"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1662983728,"creation_date":1662983728,"answer_id":73688907,"question_id":22380119,"body_markdown":"Here is how you can fix it:\r\n\r\nCheck if you don&#39;t have dependency on spring-boot-starter-web in your pom.xml file. To get you pom.xml file right, use this link start.spring.io\r\n\r\nIf you have above dependency, but still facing the issue, it is highly possible that your embedded tomcat jars are present. To confirm this, run maven build in debug mode -\r\n\r\n    mvn spring-boot:run --debug","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>Here is how you can fix it:</p>\n<p>Check if you don't have dependency on spring-boot-starter-web in your pom.xml file. To get you pom.xml file right, use this link start.spring.io</p>\n<p>If you have above dependency, but still facing the issue, it is highly possible that your embedded tomcat jars are present. To confirm this, run maven build in debug mode -</p>\n<pre><code>mvn spring-boot:run --debug\n</code></pre>\n"},{"tags":[],"owner":{"account_id":7473996,"reputation":310,"user_id":5680977,"display_name":"Dhiraj Surve"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1673497974,"creation_date":1673497974,"answer_id":75091647,"question_id":22380119,"body_markdown":"if you want to see detail logs then you can run it with debug on using below command \r\n\r\n     java  -Ddebug -jar .\\app.jar\r\n\r\nFor me it was due to below exception \r\n\r\n     org.apache.logging.log4j.core.appender.AppenderLoggingException: java.lang.NoSuchMethodError: org.apache.logging.log4j.util.StackLocatorUtil.getCurrentStackTrace()Ljava/ut\r\n","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>if you want to see detail logs then you can run it with debug on using below command</p>\n<pre><code> java  -Ddebug -jar .\\app.jar\n</code></pre>\n<p>For me it was due to below exception</p>\n<pre><code> org.apache.logging.log4j.core.appender.AppenderLoggingException: java.lang.NoSuchMethodError: org.apache.logging.log4j.util.StackLocatorUtil.getCurrentStackTrace()Ljava/ut\n</code></pre>\n"},{"tags":[],"owner":{"account_id":21706289,"reputation":473,"user_id":16018684,"display_name":"Amos Machora"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1683393367,"creation_date":1683393367,"answer_id":76190162,"question_id":22380119,"body_markdown":"Removing this dependency worked for me\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;tomcat-embed-core&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;9.0.73&lt;/version&gt;\r\n\t\t&lt;/dependency&gt; ","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>Removing this dependency worked for me</p>\n<pre><code>    &lt;dependency&gt;\n        &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;\n        &lt;artifactId&gt;tomcat-embed-core&lt;/artifactId&gt;\n        &lt;version&gt;9.0.73&lt;/version&gt;\n    &lt;/dependency&gt; \n</code></pre>\n"},{"tags":[],"owner":{"account_id":2077320,"reputation":654,"user_id":1850297,"accept_rate":76,"display_name":"metzelder"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694777376,"creation_date":1694777376,"answer_id":77111988,"question_id":22380119,"body_markdown":"One more thing to check about this problem:\r\n\r\nIf you have opted-out web-application-type in your properties file, you have to remove it. Otherwise, application server does not start.\r\n\r\n      main:\r\n        web-application-type: none","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>One more thing to check about this problem:</p>\n<p>If you have opted-out web-application-type in your properties file, you have to remove it. Otherwise, application server does not start.</p>\n<pre><code>  main:\n    web-application-type: none\n</code></pre>\n"}],"owner":{"account_id":936367,"reputation":4282,"user_id":965229,"accept_rate":84,"display_name":"johnsam"},"comment_count":9,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":297800,"favorite_count":0,"down_vote_count":0,"up_vote_count":263,"accepted_answer_id":22409655,"answer_count":24,"score":263,"last_activity_date":1694777376,"creation_date":1394717238,"question_id":22380119,"body_markdown":"This is my first Spring Boot code. Unfortunately, it always shuts down. I was expecting it to run continuously so that my web client can get some data from the browser.\r\n\r\n    package hello;\r\n    import org.springframework.boot.*;\r\n    import org.springframework.boot.autoconfigure.*;\r\n    import org.springframework.stereotype.*;\r\n    import org.springframework.web.bind.annotation.*;\r\n    \r\n    @Controller\r\n    @EnableAutoConfiguration\r\n    public class SampleController {\r\n    \r\n        @RequestMapping(&quot;/&quot;)\r\n        @ResponseBody\r\n        String home() {\r\n            return &quot;Hello World!&quot;;\r\n        }\r\n    \r\n        public static void main(String[] args) throws Exception {\r\n            SpringApplication.run(SampleController.class, args);\r\n        }\r\n    }\r\n\r\n\r\n    [@localhost initial]$ java -jar build/libs/gs-spring-boot-0.1.0.jar\r\n    \r\n      .   ____          _            __ _ _\r\n     /\\\\ / ___&#39;_ __ _ _(_)_ __  __ _ \\ \\ \\ \\\r\n    ( ( )\\___ | &#39;_ | &#39;_| | &#39;_ \\/ _` | \\ \\ \\ \\\r\n     \\\\/  ___)| |_)| | | | | || (_| |  ) ) ) )\r\n      &#39;  |____| .__|_| |_|_| |_\\__, | / / / /\r\n     =========|_|==============|___/=/_/_/_/\r\n     :: Spring Boot ::            (v1.0.0.RC4)\r\n    \r\n    2014-03-13 09:20:24.805  INFO 14650 --- [           main] hello.SampleController                   : Starting SampleController on localhost.localdomain with PID 14650 (/home/xxx/dev/gs-spring-boot/initial/build/libs/gs-spring-boot-0.1.0.jar started by xxx)\r\n    2014-03-13 09:20:25.002  INFO 14650 --- [           main] s.c.a.AnnotationConfigApplicationContext : Refreshing org.springframework.context.annotation.AnnotationConfigApplicationContext@b9eec: startup date [Thu Mar 13 09:20:24 EDT 2014]; root of context hierarchy\r\n    2014-03-13 09:20:28.833  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Registering beans for JMX exposure on startup\r\n    2014-03-13 09:20:30.148  INFO 14650 --- [           main] o.s.c.support.DefaultLifecycleProcessor  : Starting beans in phase 0\r\n    2014-03-13 09:20:30.154  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean &#39;requestMappingEndpoint&#39;: registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=requestMappingEndpoint]\r\n    2014-03-13 09:20:30.316  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean &#39;environmentEndpoint&#39;: registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=environmentEndpoint]\r\n    2014-03-13 09:20:30.335  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean &#39;healthEndpoint&#39;: registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=healthEndpoint]\r\n    2014-03-13 09:20:30.351  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean &#39;beansEndpoint&#39;: registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=beansEndpoint]\r\n    2014-03-13 09:20:30.376  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean &#39;infoEndpoint&#39;: registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=infoEndpoint]\r\n    2014-03-13 09:20:30.400  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean &#39;metricsEndpoint&#39;: registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=metricsEndpoint]\r\n    2014-03-13 09:20:30.413  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean &#39;traceEndpoint&#39;: registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=traceEndpoint]\r\n    2014-03-13 09:20:30.428  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean &#39;dumpEndpoint&#39;: registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=dumpEndpoint]\r\n    2014-03-13 09:20:30.450  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean &#39;autoConfigurationAuditEndpoint&#39;: registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=autoConfigurationAuditEndpoint]\r\n    2014-03-13 09:20:30.465  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean &#39;shutdownEndpoint&#39;: registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=shutdownEndpoint]\r\n    2014-03-13 09:20:30.548  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean &#39;configurationPropertiesReportEndpoint&#39;: registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=configurationPropertiesReportEndpoint]\r\n    2014-03-13 09:20:30.589  INFO 14650 --- [           main] hello.SampleController                   : Started SampleController in 7.396 seconds (JVM running for 9.569)\r\n    2014-03-13 09:20:30.608  INFO 14650 --- [       Thread-2] s.c.a.AnnotationConfigApplicationContext : Closing org.springframework.context.annotation.AnnotationConfigApplicationContext@b9eec: startup date [Thu Mar 13 09:20:24 EDT 2014]; root of context hierarchy\r\n    2014-03-13 09:20:30.610  INFO 14650 --- [       Thread-2] o.s.c.support.DefaultLifecycleProcessor  : Stopping beans in phase 0\r\n    2014-03-13 09:20:30.624  INFO 14650 --- [       Thread-2] o.s.b.a.e.jmx.EndpointMBeanExporter      : Unregistering JMX-exposed beans on shutdown\r\n\r\nPlease advise. \r\n\r\nThanks\r\n\r\nP.S. build.gradle is the fault.\r\n\r\n    dependencies {\r\n        // tag::jetty[]\r\n        compile(&quot;org.springframework.boot:spring-boot-starter-web&quot;) {\r\n            **exclude module: &quot;spring-boot-starter-tomcat&quot;**\r\n        }\r\n\r\nOnce I took off the above line in bold, everything works. My application context now is correct. Thanks Dave\r\n\r\n\r\n      .   ____          _            __ _ _\r\n     /\\\\ / ___&#39;_ __ _ _(_)_ __  __ _ \\ \\ \\ \\\r\n    ( ( )\\___ | &#39;_ | &#39;_| | &#39;_ \\/ _` | \\ \\ \\ \\\r\n     \\\\/  ___)| |_)| | | | | || (_| |  ) ) ) )\r\n      &#39;  |____| .__|_| |_|_| |_\\__, | / / / /\r\n     =========|_|==============|___/=/_/_/_/\r\n     :: Spring Boot ::            (v1.0.0.RC4)\r\n    \r\n    2014-03-13 13:58:08.965  INFO 7307 --- [           main] hello.Application                        : Starting\r\n     Application on  with PID 7307 (/ladev/home/xxx/dev/gs-spring-boot/initial/build/libs/gs-spring-boo\r\n    t-0.1.0.jar started by xxx)\r\n    2014-03-13 13:58:09.021  INFO 7307 --- [           main] ationConfigEmbeddedWebApplicationContext : Refreshi\r\n    ng org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext@45490eb5: startup\r\n     date [Thu Mar 13 13:58:09 MDT 2014]; root of context hierarchy\r\n    2014-03-13 13:58:09.653  INFO 7307 --- [           main] o.s.b.f.s.DefaultListableBeanFactory     : Overridi\r\n    ng bean definition for bean &#39;beanNameViewResolver&#39;: replacing [Root bean: class [null]; scope=; abstract=fal\r\n    se; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanNam\r\n    e=org.springframework.boot.actuate.autoconfigure.ErrorMvcAutoConfiguration$WhitelabelErrorViewConfiguration;\r\n     factoryMethodName=beanNameViewResolver; initMethodName=null; destroyMethodName=(inferred); defined in class\r\n     path resource [org/springframework/boot/actuate/autoconfigure/ErrorMvcAutoConfiguration$WhitelabelErrorView\r\n    Configuration.class]] with [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3;\r\n     dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=org.springframework.boot.autoconf\r\n    igure.web.WebMvcAutoConfiguration$WebMvcAutoConfigurationAdapter; factoryMethodName=beanNameViewResolver; in\r\n    itMethodName=null; destroyMethodName=(inferred); defined in class path resource [org/springframework/boot/au\r\n    toconfigure/web/WebMvcAutoConfiguration$WebMvcAutoConfigurationAdapter.class]]\r\n\r\n","title":"Why does my Spring Boot App always shutdown immediately after starting?","body":"<p>This is my first Spring Boot code. Unfortunately, it always shuts down. I was expecting it to run continuously so that my web client can get some data from the browser.</p>\n\n<pre><code>package hello;\nimport org.springframework.boot.*;\nimport org.springframework.boot.autoconfigure.*;\nimport org.springframework.stereotype.*;\nimport org.springframework.web.bind.annotation.*;\n\n@Controller\n@EnableAutoConfiguration\npublic class SampleController {\n\n    @RequestMapping(\"/\")\n    @ResponseBody\n    String home() {\n        return \"Hello World!\";\n    }\n\n    public static void main(String[] args) throws Exception {\n        SpringApplication.run(SampleController.class, args);\n    }\n}\n\n\n[@localhost initial]$ java -jar build/libs/gs-spring-boot-0.1.0.jar\n\n  .   ____          _            __ _ _\n /\\\\ / ___'_ __ _ _(_)_ __  __ _ \\ \\ \\ \\\n( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\\n \\\\/  ___)| |_)| | | | | || (_| |  ) ) ) )\n  '  |____| .__|_| |_|_| |_\\__, | / / / /\n =========|_|==============|___/=/_/_/_/\n :: Spring Boot ::            (v1.0.0.RC4)\n\n2014-03-13 09:20:24.805  INFO 14650 --- [           main] hello.SampleController                   : Starting SampleController on localhost.localdomain with PID 14650 (/home/xxx/dev/gs-spring-boot/initial/build/libs/gs-spring-boot-0.1.0.jar started by xxx)\n2014-03-13 09:20:25.002  INFO 14650 --- [           main] s.c.a.AnnotationConfigApplicationContext : Refreshing org.springframework.context.annotation.AnnotationConfigApplicationContext@b9eec: startup date [Thu Mar 13 09:20:24 EDT 2014]; root of context hierarchy\n2014-03-13 09:20:28.833  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Registering beans for JMX exposure on startup\n2014-03-13 09:20:30.148  INFO 14650 --- [           main] o.s.c.support.DefaultLifecycleProcessor  : Starting beans in phase 0\n2014-03-13 09:20:30.154  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean 'requestMappingEndpoint': registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=requestMappingEndpoint]\n2014-03-13 09:20:30.316  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean 'environmentEndpoint': registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=environmentEndpoint]\n2014-03-13 09:20:30.335  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean 'healthEndpoint': registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=healthEndpoint]\n2014-03-13 09:20:30.351  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean 'beansEndpoint': registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=beansEndpoint]\n2014-03-13 09:20:30.376  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean 'infoEndpoint': registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=infoEndpoint]\n2014-03-13 09:20:30.400  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean 'metricsEndpoint': registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=metricsEndpoint]\n2014-03-13 09:20:30.413  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean 'traceEndpoint': registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=traceEndpoint]\n2014-03-13 09:20:30.428  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean 'dumpEndpoint': registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=dumpEndpoint]\n2014-03-13 09:20:30.450  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean 'autoConfigurationAuditEndpoint': registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=autoConfigurationAuditEndpoint]\n2014-03-13 09:20:30.465  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean 'shutdownEndpoint': registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=shutdownEndpoint]\n2014-03-13 09:20:30.548  INFO 14650 --- [           main] o.s.b.a.e.jmx.EndpointMBeanExporter      : Located managed bean 'configurationPropertiesReportEndpoint': registering with JMX server as MBean [org.springframework.boot:type=Endpoint,name=configurationPropertiesReportEndpoint]\n2014-03-13 09:20:30.589  INFO 14650 --- [           main] hello.SampleController                   : Started SampleController in 7.396 seconds (JVM running for 9.569)\n2014-03-13 09:20:30.608  INFO 14650 --- [       Thread-2] s.c.a.AnnotationConfigApplicationContext : Closing org.springframework.context.annotation.AnnotationConfigApplicationContext@b9eec: startup date [Thu Mar 13 09:20:24 EDT 2014]; root of context hierarchy\n2014-03-13 09:20:30.610  INFO 14650 --- [       Thread-2] o.s.c.support.DefaultLifecycleProcessor  : Stopping beans in phase 0\n2014-03-13 09:20:30.624  INFO 14650 --- [       Thread-2] o.s.b.a.e.jmx.EndpointMBeanExporter      : Unregistering JMX-exposed beans on shutdown\n</code></pre>\n\n<p>Please advise. </p>\n\n<p>Thanks</p>\n\n<p>P.S. build.gradle is the fault.</p>\n\n<pre><code>dependencies {\n    // tag::jetty[]\n    compile(\"org.springframework.boot:spring-boot-starter-web\") {\n        **exclude module: \"spring-boot-starter-tomcat\"**\n    }\n</code></pre>\n\n<p>Once I took off the above line in bold, everything works. My application context now is correct. Thanks Dave</p>\n\n<pre><code>  .   ____          _            __ _ _\n /\\\\ / ___'_ __ _ _(_)_ __  __ _ \\ \\ \\ \\\n( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\\n \\\\/  ___)| |_)| | | | | || (_| |  ) ) ) )\n  '  |____| .__|_| |_|_| |_\\__, | / / / /\n =========|_|==============|___/=/_/_/_/\n :: Spring Boot ::            (v1.0.0.RC4)\n\n2014-03-13 13:58:08.965  INFO 7307 --- [           main] hello.Application                        : Starting\n Application on  with PID 7307 (/ladev/home/xxx/dev/gs-spring-boot/initial/build/libs/gs-spring-boo\nt-0.1.0.jar started by xxx)\n2014-03-13 13:58:09.021  INFO 7307 --- [           main] ationConfigEmbeddedWebApplicationContext : Refreshi\nng org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext@45490eb5: startup\n date [Thu Mar 13 13:58:09 MDT 2014]; root of context hierarchy\n2014-03-13 13:58:09.653  INFO 7307 --- [           main] o.s.b.f.s.DefaultListableBeanFactory     : Overridi\nng bean definition for bean 'beanNameViewResolver': replacing [Root bean: class [null]; scope=; abstract=fal\nse; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanNam\ne=org.springframework.boot.actuate.autoconfigure.ErrorMvcAutoConfiguration$WhitelabelErrorViewConfiguration;\n factoryMethodName=beanNameViewResolver; initMethodName=null; destroyMethodName=(inferred); defined in class\n path resource [org/springframework/boot/actuate/autoconfigure/ErrorMvcAutoConfiguration$WhitelabelErrorView\nConfiguration.class]] with [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3;\n dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=org.springframework.boot.autoconf\nigure.web.WebMvcAutoConfiguration$WebMvcAutoConfigurationAdapter; factoryMethodName=beanNameViewResolver; in\nitMethodName=null; destroyMethodName=(inferred); defined in class path resource [org/springframework/boot/au\ntoconfigure/web/WebMvcAutoConfiguration$WebMvcAutoConfigurationAdapter.class]]\n</code></pre>\n"},{"tags":["java","spring-boot","javax.validation"],"answers":[{"tags":[],"owner":{"account_id":24440940,"reputation":3122,"user_id":18364656,"display_name":"Andrei Lisa"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694773618,"creation_date":1694769948,"answer_id":77111192,"question_id":77111088,"body_markdown":"Here you are passing `null` as a method argument and after it you are trying to invoke `isBlank()` from `String` but if you are going to check the java docs of `String` class, before of all there is writing.\r\n\r\n    ` * Unless otherwise noted, passing a {@code null} argument to a constructor\r\n     * or method in this class will cause a {@link NullPointerException} to be\r\n     * thrown.`\r\nit is the reason.\r\n\r\nBy the way I recommend you to check all answers of this [question][1] to have more details why. There also is present some good references to documentation.\r\n\r\n\r\nThe reason is simple:\r\n\r\n\r\n **Annotation has no effect because there’s no validator to enforce it.** in another way :\r\n\r\n**@NotNull is just an annotation. Annotations do nothing on their own. They need an annotation processor at compile time, or something that processes it at runtime.**\r\n\r\nIt is the reason why you got `NullPointerException` to fix it you also should invoke `ConstraintViolationException` as in second test-case\r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/23419087/stringutils-isblank-vs-string-isempty","title":"ConstraintsViolationException not getting triggered between 2 methods in the same Service Layer","body":"<p>Here you are passing <code>null</code> as a method argument and after it you are trying to invoke <code>isBlank()</code> from <code>String</code> but if you are going to check the java docs of <code>String</code> class, before of all there is writing.</p>\n<pre><code>` * Unless otherwise noted, passing a {@code null} argument to a constructor\n * or method in this class will cause a {@link NullPointerException} to be\n * thrown.`\n</code></pre>\n<p>it is the reason.</p>\n<p>By the way I recommend you to check all answers of this <a href=\"https://stackoverflow.com/questions/23419087/stringutils-isblank-vs-string-isempty\">question</a> to have more details why. There also is present some good references to documentation.</p>\n<p>The reason is simple:</p>\n<p><strong>Annotation has no effect because there’s no validator to enforce it.</strong> in another way :</p>\n<p><strong>@NotNull is just an annotation. Annotations do nothing on their own. They need an annotation processor at compile time, or something that processes it at runtime.</strong></p>\n<p>It is the reason why you got <code>NullPointerException</code> to fix it you also should invoke <code>ConstraintViolationException</code> as in second test-case</p>\n"},{"tags":[],"owner":{"account_id":17717155,"reputation":527,"user_id":12863192,"display_name":"Ishan"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694777165,"creation_date":1694776754,"answer_id":77111913,"question_id":77111088,"body_markdown":"From a `ValidateServiceTest` instance itself from one method `testValidation(String)` another method `this.testValidationNotNull(String)` is called, it does not process any annotation. This is a direct call from one method to the other. There is NO interceptor to process annotations. From one BEAN to another Autowired Bean if you call a method, then some framework comes into the picture and it intercepts that call and processes annotations like `@Transactional`, `@NotNull`, etc. But within a class, from one method to another method, nothing will happen.\r\n\r\nYour 2nd test calls `sut.testValidationNotNull(null)` where `sut` is an autowired bean. So, `@NotNull` is effective. But not from inside `ValidateService` instance itself when you call `this.testValidationNotNull` from `testValidation`\r\n\r\nWhen you want to enforce validation, call the method that has `@NotNull` from outside the Bean through an autowired (managed) instance. That&#39;s the only possibility. Remember, whenever from within the bean itself, if you call any other method on the same instance - that will get called directly - without any framework interception coming into the picture.\r\n\r\nI don&#39;t know the exact usecase, but from the looks of it, I believe you should not have method `testValidation` at all. Just have `public void testValidationNotNull(@NotNull String validated)` which always gets called from the outside (on a managed bean instance) and `@NotNull` will always be processed. Framework validates the parameter BEFORE actually reaching your method `testValidationNotNull` and raises constraint violation exception. INSIDE your method `testValidationNotNull`, you are 100% sure that the parameter is NOT NULL.\r\n\r\nYou can have `@Autowired smallBean` in the large bean.  Then call `smallBean.someSmallMethod(String)` - which would process annotations before calling `someSmallMethod`.\r\n\r\nThen have `@Autowired smallerBean` in the `smallBean` class. Call `smallerBean.someSmallerMethod(String)` - which would process annotations before actually reaching `someSmallerMethod`.","title":"ConstraintsViolationException not getting triggered between 2 methods in the same Service Layer","body":"<p>From a <code>ValidateServiceTest</code> instance itself from one method <code>testValidation(String)</code> another method <code>this.testValidationNotNull(String)</code> is called, it does not process any annotation. This is a direct call from one method to the other. There is NO interceptor to process annotations. From one BEAN to another Autowired Bean if you call a method, then some framework comes into the picture and it intercepts that call and processes annotations like <code>@Transactional</code>, <code>@NotNull</code>, etc. But within a class, from one method to another method, nothing will happen.</p>\n<p>Your 2nd test calls <code>sut.testValidationNotNull(null)</code> where <code>sut</code> is an autowired bean. So, <code>@NotNull</code> is effective. But not from inside <code>ValidateService</code> instance itself when you call <code>this.testValidationNotNull</code> from <code>testValidation</code></p>\n<p>When you want to enforce validation, call the method that has <code>@NotNull</code> from outside the Bean through an autowired (managed) instance. That's the only possibility. Remember, whenever from within the bean itself, if you call any other method on the same instance - that will get called directly - without any framework interception coming into the picture.</p>\n<p>I don't know the exact usecase, but from the looks of it, I believe you should not have method <code>testValidation</code> at all. Just have <code>public void testValidationNotNull(@NotNull String validated)</code> which always gets called from the outside (on a managed bean instance) and <code>@NotNull</code> will always be processed. Framework validates the parameter BEFORE actually reaching your method <code>testValidationNotNull</code> and raises constraint violation exception. INSIDE your method <code>testValidationNotNull</code>, you are 100% sure that the parameter is NOT NULL.</p>\n<p>You can have <code>@Autowired smallBean</code> in the large bean.  Then call <code>smallBean.someSmallMethod(String)</code> - which would process annotations before calling <code>someSmallMethod</code>.</p>\n<p>Then have <code>@Autowired smallerBean</code> in the <code>smallBean</code> class. Call <code>smallerBean.someSmallerMethod(String)</code> - which would process annotations before actually reaching <code>someSmallerMethod</code>.</p>\n"}],"owner":{"account_id":22591800,"reputation":1,"user_id":16774785,"display_name":"Ivo Pogace"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":65,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1694777165,"creation_date":1694768989,"question_id":77111088,"body_markdown":"```\r\n@Service\r\n@Validated\r\npublic class ValidateService {\r\n\r\n    public void testValidation(String notValidated) {\r\n        testValidationNotNull(notValidated);\r\n    }\r\n\r\n    public void testValidationNotNull(@NotNull String validated) {\r\n        validated.isBlank();\r\n    }\r\n\r\n}\r\n```\r\nI am expecting to get ConstraintViolationException when testValidation method is executed and notValidated string is null, but instead i get NPE since validated.isBlank() row is getting executed.\r\n\r\nIs this the wanted bahavior from javax.validation.constraints.NotNull when the method is being called from another method in the same service layer?\r\n\r\n\r\nBelow are 2 test methods: 1 triggers NPE, 2 triggers ConstraintViolationException\r\n\r\n\r\n```\r\n@SpringBootTest\r\npublic class ValidateServiceTest {\r\n\r\n    @Autowired\r\n    private ValidateService sut;\r\n\r\n    // test that triggers NPE instead of ConstraintViolationException\r\n    @Test\r\n    public void testValidation() {\r\n        sut.testValidation(null);\r\n    }\r\n\r\n    // green test which triggers ConstraintViolationException \r\n    @Test\r\n    public void testValidationNotNull_shouldThrowConstraintsViolationException() {\r\n        final ConstraintViolationException violationException = assertThrows(ConstraintViolationException.class, () -&gt;  sut.testValidationNotNull(null));\r\n        assertEquals(&quot;testValidationNotNull.validated: must not be null&quot;, violationException.getMessage());\r\n    }\r\n\r\n}\r\n```","title":"ConstraintsViolationException not getting triggered between 2 methods in the same Service Layer","body":"<pre><code>@Service\n@Validated\npublic class ValidateService {\n\n    public void testValidation(String notValidated) {\n        testValidationNotNull(notValidated);\n    }\n\n    public void testValidationNotNull(@NotNull String validated) {\n        validated.isBlank();\n    }\n\n}\n</code></pre>\n<p>I am expecting to get ConstraintViolationException when testValidation method is executed and notValidated string is null, but instead i get NPE since validated.isBlank() row is getting executed.</p>\n<p>Is this the wanted bahavior from javax.validation.constraints.NotNull when the method is being called from another method in the same service layer?</p>\n<p>Below are 2 test methods: 1 triggers NPE, 2 triggers ConstraintViolationException</p>\n<pre><code>@SpringBootTest\npublic class ValidateServiceTest {\n\n    @Autowired\n    private ValidateService sut;\n\n    // test that triggers NPE instead of ConstraintViolationException\n    @Test\n    public void testValidation() {\n        sut.testValidation(null);\n    }\n\n    // green test which triggers ConstraintViolationException \n    @Test\n    public void testValidationNotNull_shouldThrowConstraintsViolationException() {\n        final ConstraintViolationException violationException = assertThrows(ConstraintViolationException.class, () -&gt;  sut.testValidationNotNull(null));\n        assertEquals(&quot;testValidationNotNull.validated: must not be null&quot;, violationException.getMessage());\n    }\n\n}\n</code></pre>\n"},{"tags":["java","mysql","spring","hibernate","jpa"],"answers":[{"tags":[],"owner":{"account_id":18549439,"reputation":1201,"user_id":13515974,"display_name":"Zufar Sunagatov"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694776296,"creation_date":1694776296,"answer_id":77111873,"question_id":77111659,"body_markdown":"&gt; I want to get product information with product image by GET Method By Using JAVA spring JPA?\r\n\r\n\r\nYou can create DTO class for your entity class:\r\n```\r\n@Data\r\npublic class ProductDTO {\r\n    private int id;\r\n    private String name;\r\n    private BigDecimal price;\r\n    private String description;\r\n    private byte[] image;\r\n}\r\n```\r\n\r\nAnd then create HTTP GET RestApi method in your RestController:\r\n```\r\n..\r\n...\r\n....\r\n@GetMapping(&quot;/product/{id}&quot;)\r\npublic ResponseEntity&lt;ProductDTO&gt; getProduct(@PathVariable int id) {\r\n    Optional&lt;Products&gt; productOptional = productRepository.findById(id);\r\n    \r\n    if (productOptional.isPresent()) {\r\n        Products product = productOptional.get();\r\n        \r\n        ProductDTO productDTO = new ProductDTO();\r\n        productDTO.setId(product.getId());\r\n        productDTO.setName(product.getName());\r\n        productDTO.setPrice(product.getPrice());\r\n        productDTO.setDescription(product.getDescription());\r\n        productDTO.setImage(product.getImage());\r\n        \r\n        return ResponseEntity\r\n                  .ok(productDTO);\r\n    } else {\r\n        return ResponseEntity\r\n                  .notFound()\r\n                  .build();\r\n    }\r\n}\r\n```","title":"I want to get product information with product image by GET method by using Spring JPA?","body":"<blockquote>\n<p>I want to get product information with product image by GET Method By Using JAVA spring JPA?</p>\n</blockquote>\n<p>You can create DTO class for your entity class:</p>\n<pre><code>@Data\npublic class ProductDTO {\n    private int id;\n    private String name;\n    private BigDecimal price;\n    private String description;\n    private byte[] image;\n}\n</code></pre>\n<p>And then create HTTP GET RestApi method in your RestController:</p>\n<pre><code>..\n...\n....\n@GetMapping(&quot;/product/{id}&quot;)\npublic ResponseEntity&lt;ProductDTO&gt; getProduct(@PathVariable int id) {\n    Optional&lt;Products&gt; productOptional = productRepository.findById(id);\n    \n    if (productOptional.isPresent()) {\n        Products product = productOptional.get();\n        \n        ProductDTO productDTO = new ProductDTO();\n        productDTO.setId(product.getId());\n        productDTO.setName(product.getName());\n        productDTO.setPrice(product.getPrice());\n        productDTO.setDescription(product.getDescription());\n        productDTO.setImage(product.getImage());\n        \n        return ResponseEntity\n                  .ok(productDTO);\n    } else {\n        return ResponseEntity\n                  .notFound()\n                  .build();\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":26814819,"reputation":1,"user_id":20404911,"display_name":"MrStranger"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":34,"favorite_count":0,"down_vote_count":3,"up_vote_count":0,"answer_count":1,"score":-3,"last_activity_date":1694777141,"creation_date":1694774169,"question_id":77111659,"body_markdown":"\r\nHere is my entity class\r\n\r\n\r\n    @ToString\r\n    @Data\r\n    @Entity\r\n    public class Products {\r\n    \r\n    \t@Id\r\n    \t@GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    \tprivate int id;\r\n    \tprivate String name;\r\n    \tprivate BigDecimal price;\r\n    \tprivate String description;\r\n    \t@Lob\r\n    \t@Column(columnDefinition = &quot;LONGBLOB&quot;)\r\n    \tprivate byte[] image;\r\n    }\r\n\r\n\r\nHere is my Controller class where I post product information to the MySQL database with name , price , description and product image\r\n\r\n\r\n \r\n\r\n    @PostMappig(&quot;/product&quot;)\r\n    public Products uploadProducts(@RequestParam(&quot;name&quot;) String name, @RequestParam(&quot;price&quot;) BigDecimal price,\r\n\t\t\t@RequestParam(&quot;description&quot;) String description, @RequestParam(&quot;image&quot;) MultipartFile image,\r\n\t\t\t@RequestParam(&quot;categorys&quot;) Categorys thecategory) throws IOException {\r\n\r\n\t\tbyte[] imageData;\r\n\r\n\t\timageData = image.getBytes();\r\n\r\n\t\tProducts products = new Products();\r\n\r\n\t\tproducts.setName(name);\r\n\t\tproducts.setPrice(price);\r\n\t\tproducts.setDescription(description);\r\n\t\tproducts.setCategorys(thecategory);\r\n\t\tproducts.setImage(image);\r\n\r\n\t\treturn productRepository.save(products);\r\n\r\n\t}\r\n\r\n\r\n\r\n","title":"I want to get product information with product image by GET method by using Spring JPA?","body":"<p>Here is my entity class</p>\n<pre><code>@ToString\n@Data\n@Entity\npublic class Products {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private int id;\n    private String name;\n    private BigDecimal price;\n    private String description;\n    @Lob\n    @Column(columnDefinition = &quot;LONGBLOB&quot;)\n    private byte[] image;\n}\n</code></pre>\n<p>Here is my Controller class where I post product information to the MySQL database with name , price , description and product image</p>\n<pre><code>@PostMappig(&quot;/product&quot;)\npublic Products uploadProducts(@RequestParam(&quot;name&quot;) String name, @RequestParam(&quot;price&quot;) BigDecimal price,\n        @RequestParam(&quot;description&quot;) String description, @RequestParam(&quot;image&quot;) MultipartFile image,\n        @RequestParam(&quot;categorys&quot;) Categorys thecategory) throws IOException {\n\n    byte[] imageData;\n\n    imageData = image.getBytes();\n\n    Products products = new Products();\n\n    products.setName(name);\n    products.setPrice(price);\n    products.setDescription(description);\n    products.setCategorys(thecategory);\n    products.setImage(image);\n\n    return productRepository.save(products);\n\n}\n</code></pre>\n"},{"tags":["java","android","android-studio","gradle","build.gradle"],"comments":[{"owner":{"account_id":6617940,"reputation":3932,"user_id":5110595,"display_name":"Hemant Parmar"},"score":0,"creation_date":1519899927,"post_id":49047492,"comment_id":85099399,"body_markdown":"Possible duplicate of [How to generate buildConfigField with String type](https://stackoverflow.com/questions/30796533/how-to-generate-buildconfigfield-with-string-type)","body":"Possible duplicate of <a href=\"https://stackoverflow.com/questions/30796533/how-to-generate-buildconfigfield-with-string-type\">How to generate buildConfigField with String type</a>"},{"owner":{"account_id":11443053,"reputation":31,"user_id":8387933,"display_name":"Apoorva Naganalli"},"score":0,"creation_date":1519902437,"post_id":49047492,"comment_id":85100899,"body_markdown":"package com.gpads.gautham.imagetotextanalysis;\n\npublic final class BuildConfig {\n  public static final boolean DEBUG = Boolean.parseBoolean(&quot;true&quot;);\n  public static final String APPLICATION_ID = &quot;com.gpads.gautham.imagetotextanalysis&quot;;\n  public static final String BUILD_TYPE = &quot;debug&quot;;\n  public static final String FLAVOR = &quot;&quot;;\n  public static final int VERSION_CODE = 2;\n  public static final String VERSION_NAME = &quot;2.0&quot;;\n}\n @HemantParmar this is my BuildConfig.java","body":"package com.gpads.gautham.imagetotextanalysis;  public final class BuildConfig {   public static final boolean DEBUG = Boolean.parseBoolean(&quot;true&quot;);   public static final String APPLICATION_ID = &quot;com.gpads.gautham.imagetotextanalysis&quot;;   public static final String BUILD_TYPE = &quot;debug&quot;;   public static final String FLAVOR = &quot;&quot;;   public static final int VERSION_CODE = 2;   public static final String VERSION_NAME = &quot;2.0&quot;; }  @HemantParmar this is my BuildConfig.java"}],"answers":[{"tags":[],"owner":{"account_id":9324231,"reputation":87,"user_id":6922082,"display_name":"Osaf"},"down_vote_count":1,"up_vote_count":7,"is_accepted":false,"score":6,"last_activity_date":1529403950,"creation_date":1529403950,"answer_id":50926118,"question_id":49047492,"body_markdown":"Change this    buildConfigField(&quot;String&quot;, &quot;API_KEY&quot;, API_KEY)\r\nInto this\r\n                    \r\n        buildConfigField &quot;String&quot;, &quot;API_KEY&quot;, &quot;\\&quot; API_KEY\\&quot;&quot; ","title":"ERROR: Gradle sync failed: Could not get unknown property &#39;API_KEY&#39; for DefaultConfig_Decorated","body":"<p>Change this    buildConfigField(\"String\", \"API_KEY\", API_KEY)\nInto this</p>\n\n<pre><code>    buildConfigField \"String\", \"API_KEY\", \"\\\" API_KEY\\\"\" \n</code></pre>\n"},{"tags":[],"owner":{"account_id":5089468,"reputation":527,"user_id":5032983,"display_name":"Mirieri Mogaka"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1539075781,"creation_date":1539074555,"answer_id":52716781,"question_id":49047492,"body_markdown":"To avoid any errors with your code add this snippet, found this as a solution for my movie project: \r\n\r\n    def getProperty(String filename, String propName) {\r\n        def propsFile = rootProject.file(filename)\r\n        if (propsFile.exists()) {\r\n            def props = new Properties()\r\n            props.load(new FileInputStream(propsFile))\r\n            if (props[propName] != null) {\r\n                return props[propName]\r\n            } else {\r\n                print(&quot;No such property &quot; + propName + &quot; in file &quot; + filename);\r\n            }\r\n        } else {\r\n            print(filename + &quot; does not exist!&quot;)\r\n        }\r\n    }\r\n    android {\r\n        compileSdkVersion 27\r\n        buildToolsVersion &#39;27.0.2&#39;\r\n        defaultConfig {\r\n            buildConfigField &quot;String&quot;, &quot;API_KEY&quot;, &quot;\\&quot;${getProperty(&quot;local.properties&quot;, API_KEY)}\\&quot;&quot;\r\n            buildConfigField &quot;String&quot;, &quot;\\&quot;${getProperty(&quot;local.properties&quot;, ER_API_KEY)}\\&quot;&quot;\r\n            applicationId &quot;com.gpads.gautham.imagetotextanalysis&quot;\r\n            minSdkVersion 15\r\n            targetSdkVersion 27\r\n            versionCode 2\r\n            versionName &quot;2.0&quot;\r\n            testInstrumentationRunner &quot;android.support.test.runner.AndroidJUnitRunner&quot;\r\n        }\r\n    }","title":"ERROR: Gradle sync failed: Could not get unknown property &#39;API_KEY&#39; for DefaultConfig_Decorated","body":"<p>To avoid any errors with your code add this snippet, found this as a solution for my movie project: </p>\n\n<pre><code>def getProperty(String filename, String propName) {\n    def propsFile = rootProject.file(filename)\n    if (propsFile.exists()) {\n        def props = new Properties()\n        props.load(new FileInputStream(propsFile))\n        if (props[propName] != null) {\n            return props[propName]\n        } else {\n            print(\"No such property \" + propName + \" in file \" + filename);\n        }\n    } else {\n        print(filename + \" does not exist!\")\n    }\n}\nandroid {\n    compileSdkVersion 27\n    buildToolsVersion '27.0.2'\n    defaultConfig {\n        buildConfigField \"String\", \"API_KEY\", \"\\\"${getProperty(\"local.properties\", API_KEY)}\\\"\"\n        buildConfigField \"String\", \"\\\"${getProperty(\"local.properties\", ER_API_KEY)}\\\"\"\n        applicationId \"com.gpads.gautham.imagetotextanalysis\"\n        minSdkVersion 15\n        targetSdkVersion 27\n        versionCode 2\n        versionName \"2.0\"\n        testInstrumentationRunner \"android.support.test.runner.AndroidJUnitRunner\"\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":6868647,"reputation":22249,"user_id":5279996,"display_name":"Braian Coronel"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1594225825,"creation_date":1594225825,"answer_id":62799357,"question_id":49047492,"body_markdown":"The error is that **you are trying to use something you did not define.**\r\n\r\nAs a solution, you have several ways to initialize the configuration field: \r\n\r\n--------\r\n\r\n . In the same scope it could be:\r\n\r\nLook at the following code where `API_KEY_2` is defined.\r\n\r\n\r\n    android {\r\n        //...\r\n        defaultConfig {\r\n            //...\r\n            def API_KEY_2 = &quot;API_KEY_2&quot;\r\n            buildConfigField(&quot;String&quot;, &quot;API_KEY&quot;, API_KEY_2)\r\n        }\r\n    }\r\n\r\n--------\r\n\r\n . Or in a global scope:\r\n\r\n\r\n## build.gradle ##\r\n\r\n    class Globals {\r\n        static String API_KEY_2 = &quot;API_KEY_2&quot;\r\n    }\r\n\r\n    android {\r\n        //...\r\n        defaultConfig {\r\n            //...\r\n            def API_KEY_2 = &quot;API_KEY_2&quot;\r\n            buildConfigField(&quot;String&quot;, &quot;API_KEY&quot;, API_KEY_2)\r\n        }\r\n    }\r\n\r\n*Note:* I don&#39;t recommend using `BuildConfig.SOMETHING` to initialize a buildConfigField\r\n\r\nGL\r\n","title":"ERROR: Gradle sync failed: Could not get unknown property &#39;API_KEY&#39; for DefaultConfig_Decorated","body":"<p>The error is that <strong>you are trying to use something you did not define.</strong></p>\n<p>As a solution, you have several ways to initialize the configuration field:</p>\n<hr />\n<p>. In the same scope it could be:</p>\n<p>Look at the following code where <code>API_KEY_2</code> is defined.</p>\n<pre><code>android {\n    //...\n    defaultConfig {\n        //...\n        def API_KEY_2 = &quot;API_KEY_2&quot;\n        buildConfigField(&quot;String&quot;, &quot;API_KEY&quot;, API_KEY_2)\n    }\n}\n</code></pre>\n<hr />\n<p>. Or in a global scope:</p>\n<h2>build.gradle</h2>\n<pre><code>class Globals {\n    static String API_KEY_2 = &quot;API_KEY_2&quot;\n}\n\nandroid {\n    //...\n    defaultConfig {\n        //...\n        def API_KEY_2 = &quot;API_KEY_2&quot;\n        buildConfigField(&quot;String&quot;, &quot;API_KEY&quot;, API_KEY_2)\n    }\n}\n</code></pre>\n<p><em>Note:</em> I don't recommend using <code>BuildConfig.SOMETHING</code> to initialize a buildConfigField</p>\n<p>GL</p>\n"},{"tags":[],"owner":{"account_id":4282799,"reputation":43,"user_id":3501627,"accept_rate":75,"display_name":"harika"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694776617,"creation_date":1694763066,"answer_id":77110456,"question_id":49047492,"body_markdown":"If you get an `&quot;illegal start of expression&quot;` using [Braian Coronel&#39;s answer](https://stackoverflow.com/a/62799357), you can try to escape the quotes with:\r\n```\r\ndef API_KEY_2 = &quot;your api key&quot;\r\nbuildConfigField(&quot;String&quot;, &quot;API_KEY&quot;, &quot;\\&quot;API_KEY_2 \\&quot;&quot;)\r\n```","title":"ERROR: Gradle sync failed: Could not get unknown property &#39;API_KEY&#39; for DefaultConfig_Decorated","body":"<p>If you get an <code>&quot;illegal start of expression&quot;</code> using <a href=\"https://stackoverflow.com/a/62799357\">Braian Coronel's answer</a>, you can try to escape the quotes with:</p>\n<pre><code>def API_KEY_2 = &quot;your api key&quot;\nbuildConfigField(&quot;String&quot;, &quot;API_KEY&quot;, &quot;\\&quot;API_KEY_2 \\&quot;&quot;)\n</code></pre>\n"}],"owner":{"account_id":11443053,"reputation":31,"user_id":8387933,"display_name":"Apoorva Naganalli"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":9851,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"answer_count":4,"score":3,"last_activity_date":1694776617,"creation_date":1519899711,"question_id":49047492,"body_markdown":"&gt; ERROR: Could not get unknown property &#39;API_KEY&#39; for DefaultConfig_Decorated{name=main, dimension=null, minSdkVersion=null, targetSdkVersion=null, renderscriptTargetApi=null, renderscriptSupportModeEnabled=null, renderscriptSupportModeBlasEnabled=null, renderscriptNdkModeEnabled=null, versionCode=null, versionName=null, applicationId=null, testApplicationId=null, testInstrumentationRunner=null, testInstrumentationRunnerArguments={}, testHandleProfiling=null, testFunctionalTest=null, signingConfig=null, resConfig=null, mBuildConfigFields={}, mResValues={}, mProguardFiles=[], mConsumerProguardFiles=[], mManifestPlaceholders={}, mWearAppUnbundled=null} of type com.android.build.gradle.internal.dsl.DefaultConfig.\r\n    apply plugin: &#39;com.android.application&#39;\r\n    \r\n    android {\r\n        compileSdkVersion 27\r\n        buildToolsVersion &#39;27.0.2&#39;\r\n        defaultConfig {\r\n            buildConfigField(&quot;String&quot;, &quot;API_KEY&quot;, API_KEY)        //error here\r\n            buildConfigField(&quot;String&quot;, &quot;ER_API_KEY&quot;, ER_API_KEY)\r\n            applicationId &quot;com.gpads.gautham.imagetotextanalysis&quot;\r\n            minSdkVersion 15\r\n            targetSdkVersion 27\r\n            versionCode 2\r\n            versionName &quot;2.0&quot;\r\n            testInstrumentationRunner &quot;android.support.test.runner.AndroidJUnitRunner&quot;\r\n        }\r\n        // ... other values\r\n    }\r\n        ","title":"ERROR: Gradle sync failed: Could not get unknown property &#39;API_KEY&#39; for DefaultConfig_Decorated","body":"<blockquote>\n  <p>ERROR: Could not get unknown property 'API_KEY' for DefaultConfig_Decorated{name=main, dimension=null, minSdkVersion=null, targetSdkVersion=null, renderscriptTargetApi=null, renderscriptSupportModeEnabled=null, renderscriptSupportModeBlasEnabled=null, renderscriptNdkModeEnabled=null, versionCode=null, versionName=null, applicationId=null, testApplicationId=null, testInstrumentationRunner=null, testInstrumentationRunnerArguments={}, testHandleProfiling=null, testFunctionalTest=null, signingConfig=null, resConfig=null, mBuildConfigFields={}, mResValues={}, mProguardFiles=[], mConsumerProguardFiles=[], mManifestPlaceholders={}, mWearAppUnbundled=null} of type com.android.build.gradle.internal.dsl.DefaultConfig.\n      apply plugin: 'com.android.application'</p>\n</blockquote>\n\n<pre><code>android {\n    compileSdkVersion 27\n    buildToolsVersion '27.0.2'\n    defaultConfig {\n        buildConfigField(\"String\", \"API_KEY\", API_KEY)        //error here\n        buildConfigField(\"String\", \"ER_API_KEY\", ER_API_KEY)\n        applicationId \"com.gpads.gautham.imagetotextanalysis\"\n        minSdkVersion 15\n        targetSdkVersion 27\n        versionCode 2\n        versionName \"2.0\"\n        testInstrumentationRunner \"android.support.test.runner.AndroidJUnitRunner\"\n    }\n    // ... other values\n}\n</code></pre>\n"},{"tags":["java","android","xml","android-drawable"],"answers":[{"tags":[],"owner":{"account_id":29439484,"reputation":94,"user_id":22557788,"display_name":"Davit Hovhannisyan"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1694776072,"creation_date":1694776072,"answer_id":77111851,"question_id":77111220,"body_markdown":"I can see that you want to change the progress bar&#39;s color to green when the progress value is bigger than 50. To do that you need to change the inside color of the progress bar, you need to modify the @color/progressCloseLimit in your progress bar drawable like this:\r\n\r\n    &lt;resources&gt;\r\n        &lt;color name=&quot;progressOutside&quot;&gt;@color/your_color&lt;/color&gt;\r\n        &lt;color name=&quot;progressInsideGreen&quot;&gt;@color/your_color&lt;/color&gt;\r\n    &lt;/resources&gt;\r\n\r\nModify your progress bar drawable (@drawable/circular_progress_bar) to use the progressInsideGreen color when the progress is in the specified range. You can do this by creating different drawables for the inside and outside shapes and using a selector drawable to switch between them based on the progress value.\r\nHere&#39;s an example of how your progress bar drawable (circular_progress_bar.xml) might look like:\r\n\r\n    &lt;layer-list xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;\r\n        &lt;!-- Outside color --&gt;\r\n        &lt;item&gt;\r\n            &lt;shape\r\n                android:shape=&quot;ring&quot;\r\n                android:useLevel=&quot;false&quot;\r\n                android:thicknessRatio=&quot;16&quot; &gt;\r\n                &lt;solid android:color=&quot;@color/progressOutside&quot; /&gt;\r\n            &lt;/shape&gt;\r\n        &lt;/item&gt;\r\n        \r\n        &lt;!-- Inside color --&gt;\r\n        &lt;item android:id=&quot;@android:id/progress&quot;&gt;\r\n            &lt;selector&gt;\r\n                &lt;!-- When progress is between 50 and 100, use green color --&gt;\r\n                &lt;item android:state_progress=&quot;true&quot; android:state_after=&quot;50&quot;&gt;\r\n                    &lt;shape\r\n                        android:shape=&quot;ring&quot;\r\n                        android:useLevel=&quot;true&quot;\r\n                        android:thicknessRatio=&quot;16&quot;&gt;\r\n                        &lt;solid android:color=&quot;@color/progressInsideGreen&quot; /&gt;\r\n                    &lt;/shape&gt;\r\n                &lt;/item&gt;\r\n                &lt;!-- Default, when progress is not in the specified range, use orange color --&gt;\r\n                &lt;item&gt;\r\n                    &lt;shape\r\n                        android:shape=&quot;ring&quot;\r\n                        android:useLevel=&quot;true&quot;\r\n                        android:thicknessRatio=&quot;16&quot;&gt;\r\n                        &lt;solid android:color=&quot;@color/progressCloseLimit&quot; /&gt;\r\n                    &lt;/shape&gt;\r\n                &lt;/item&gt;\r\n            &lt;/selector&gt;\r\n        &lt;/item&gt;\r\n    &lt;/layer-list&gt;\r\n\r\n\r\nWith these changes, you don&#39;t need to programmatically change the progress bar&#39;s color; it will automatically change based on the progress value. Just make sure to define the appropriate colors in your colors.xml file.\r\n\r\n","title":"How to change progress drawable of progress bar during program","body":"<p>I can see that you want to change the progress bar's color to green when the progress value is bigger than 50. To do that you need to change the inside color of the progress bar, you need to modify the @color/progressCloseLimit in your progress bar drawable like this:</p>\n<pre><code>&lt;resources&gt;\n    &lt;color name=&quot;progressOutside&quot;&gt;@color/your_color&lt;/color&gt;\n    &lt;color name=&quot;progressInsideGreen&quot;&gt;@color/your_color&lt;/color&gt;\n&lt;/resources&gt;\n</code></pre>\n<p>Modify your progress bar drawable (@drawable/circular_progress_bar) to use the progressInsideGreen color when the progress is in the specified range. You can do this by creating different drawables for the inside and outside shapes and using a selector drawable to switch between them based on the progress value.\nHere's an example of how your progress bar drawable (circular_progress_bar.xml) might look like:</p>\n<pre><code>&lt;layer-list xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;\n    &lt;!-- Outside color --&gt;\n    &lt;item&gt;\n        &lt;shape\n            android:shape=&quot;ring&quot;\n            android:useLevel=&quot;false&quot;\n            android:thicknessRatio=&quot;16&quot; &gt;\n            &lt;solid android:color=&quot;@color/progressOutside&quot; /&gt;\n        &lt;/shape&gt;\n    &lt;/item&gt;\n    \n    &lt;!-- Inside color --&gt;\n    &lt;item android:id=&quot;@android:id/progress&quot;&gt;\n        &lt;selector&gt;\n            &lt;!-- When progress is between 50 and 100, use green color --&gt;\n            &lt;item android:state_progress=&quot;true&quot; android:state_after=&quot;50&quot;&gt;\n                &lt;shape\n                    android:shape=&quot;ring&quot;\n                    android:useLevel=&quot;true&quot;\n                    android:thicknessRatio=&quot;16&quot;&gt;\n                    &lt;solid android:color=&quot;@color/progressInsideGreen&quot; /&gt;\n                &lt;/shape&gt;\n            &lt;/item&gt;\n            &lt;!-- Default, when progress is not in the specified range, use orange color --&gt;\n            &lt;item&gt;\n                &lt;shape\n                    android:shape=&quot;ring&quot;\n                    android:useLevel=&quot;true&quot;\n                    android:thicknessRatio=&quot;16&quot;&gt;\n                    &lt;solid android:color=&quot;@color/progressCloseLimit&quot; /&gt;\n                &lt;/shape&gt;\n            &lt;/item&gt;\n        &lt;/selector&gt;\n    &lt;/item&gt;\n&lt;/layer-list&gt;\n</code></pre>\n<p>With these changes, you don't need to programmatically change the progress bar's color; it will automatically change based on the progress value. Just make sure to define the appropriate colors in your colors.xml file.</p>\n"}],"owner":{"account_id":28711018,"reputation":1,"user_id":21986511,"display_name":"newbie123"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":34,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1694776072,"creation_date":1694770210,"question_id":77111220,"body_markdown":"I&#39;m trying to change progress bar inside color if value is close to max, basically default progress color is orange and i want to change it to green, how do i make it work?\r\n\r\nFunction:\r\n\r\n```\r\npublic static void changeProgressColor(ProgressBar progressBar){\r\n    int progress = progressBar.getProgress();\r\n    if(progressBar.getProgress() &gt;= 50 &amp;&amp; progressBar.getProgress() &lt;= 100){\r\n        progressBar.setForeground(ContextCompat.getDrawable(progressBar.getContext(), R.drawable.progress_inside_green));\r\n        progressBar.setProgress(progress);\r\n    }\r\n}\r\n```\r\n\r\nXML:\r\n\r\n```\r\n&lt;ProgressBar\r\n    android:id=&quot;@+id/progressBarEnergy&quot;\r\n    android:layout_width=&quot;match_parent&quot;\r\n    android:layout_height=&quot;match_parent&quot;\r\n    android:indeterminateOnly=&quot;false&quot;\r\n    android:progressDrawable=&quot;@drawable/circular_progress_bar&quot;\r\n    android:progress=&quot;50&quot; /&gt;\r\n```\r\n\r\nDrawable (green one, orange one is the same except inside color):\r\n\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\r\n&lt;layer-list xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;\r\n    &lt;item&gt;\r\n        &lt;shape\r\n            android:shape=&quot;ring&quot;\r\n            android:useLevel=&quot;false&quot;\r\n            android:thicknessRatio=&quot;16&quot; &gt;\r\n            &lt;solid android:color=&quot;@color/progressOutside&quot; /&gt;\r\n        &lt;/shape&gt;\r\n    &lt;/item&gt;\r\n    &lt;item&gt;\r\n        &lt;rotate\r\n            android:fromDegrees=&quot;90&quot;\r\n            android:toDegrees=&quot;90&quot;&gt;\r\n            &lt;shape\r\n                android:shape=&quot;ring&quot;\r\n                android:useLevel=&quot;true&quot;\r\n                android:thicknessRatio=&quot;16&quot;&gt;\r\n                &lt;solid android:color=&quot;@color/progressCloseLimit&quot; /&gt;\r\n            &lt;/shape&gt;\r\n        &lt;/rotate&gt;\r\n    &lt;/item&gt;\r\n&lt;/layer-list&gt;\r\n```","title":"How to change progress drawable of progress bar during program","body":"<p>I'm trying to change progress bar inside color if value is close to max, basically default progress color is orange and i want to change it to green, how do i make it work?</p>\n<p>Function:</p>\n<pre><code>public static void changeProgressColor(ProgressBar progressBar){\n    int progress = progressBar.getProgress();\n    if(progressBar.getProgress() &gt;= 50 &amp;&amp; progressBar.getProgress() &lt;= 100){\n        progressBar.setForeground(ContextCompat.getDrawable(progressBar.getContext(), R.drawable.progress_inside_green));\n        progressBar.setProgress(progress);\n    }\n}\n</code></pre>\n<p>XML:</p>\n<pre><code>&lt;ProgressBar\n    android:id=&quot;@+id/progressBarEnergy&quot;\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;match_parent&quot;\n    android:indeterminateOnly=&quot;false&quot;\n    android:progressDrawable=&quot;@drawable/circular_progress_bar&quot;\n    android:progress=&quot;50&quot; /&gt;\n</code></pre>\n<p>Drawable (green one, orange one is the same except inside color):</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;layer-list xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;\n    &lt;item&gt;\n        &lt;shape\n            android:shape=&quot;ring&quot;\n            android:useLevel=&quot;false&quot;\n            android:thicknessRatio=&quot;16&quot; &gt;\n            &lt;solid android:color=&quot;@color/progressOutside&quot; /&gt;\n        &lt;/shape&gt;\n    &lt;/item&gt;\n    &lt;item&gt;\n        &lt;rotate\n            android:fromDegrees=&quot;90&quot;\n            android:toDegrees=&quot;90&quot;&gt;\n            &lt;shape\n                android:shape=&quot;ring&quot;\n                android:useLevel=&quot;true&quot;\n                android:thicknessRatio=&quot;16&quot;&gt;\n                &lt;solid android:color=&quot;@color/progressCloseLimit&quot; /&gt;\n            &lt;/shape&gt;\n        &lt;/rotate&gt;\n    &lt;/item&gt;\n&lt;/layer-list&gt;\n</code></pre>\n"}],"has_more":true,"quota_max":10000,"quota_remaining":9811,"page":181,"page_size":100}
