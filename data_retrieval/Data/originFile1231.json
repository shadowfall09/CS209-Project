{"items":[{"tags":["java","date","iso8601"],"comments":[{"owner":{"account_id":288478,"reputation":17040,"user_id":588916,"accept_rate":60,"display_name":"collapsar"},"score":0,"creation_date":1656347469,"post_id":72775433,"comment_id":128544407,"body_markdown":"Does this answer your question? [How to get current moment in ISO 8601 format with date, hour, and minute?](https://stackoverflow.com/questions/3914404/how-to-get-current-moment-in-iso-8601-format-with-date-hour-and-minute)","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/3914404/how-to-get-current-moment-in-iso-8601-format-with-date-hour-and-minute\">How to get current moment in ISO 8601 format with date, hour, and minute?</a>"},{"owner":{"account_id":7612423,"reputation":82486,"user_id":5772882,"display_name":"Anonymous"},"score":0,"creation_date":1656347698,"post_id":72775433,"comment_id":128544508,"body_markdown":"In which way precisely did not work?? Your attempt is correct, it’s the best you can do. However the precision of the result of calling `now()` depends on the underlying Java version, operating system, hardware and the integration of all of those. You may not be able to get finer than milliseconds or even coarser on your setup.","body":"In which way precisely did not work?? Your attempt is correct, it’s the best you can do. However the precision of the result of calling <code>now()</code> depends on the underlying Java version, operating system, hardware and the integration of all of those. You may not be able to get finer than milliseconds or even coarser on your setup."},{"owner":{"account_id":7612423,"reputation":82486,"user_id":5772882,"display_name":"Anonymous"},"score":0,"creation_date":1656347861,"post_id":72775433,"comment_id":128544576,"body_markdown":"Welcome to Stack Overflow. Since you’re new it’s OK that you did not know: We can’t really do anything with “did not work”, cannot help you. We need an example of your expected output and an example of how precisely your observed output differed. Please [edit](https://stackoverflow.com/posts/72775433/edit) your question and add this information. So that we may help you.","body":"Welcome to Stack Overflow. Since you’re new it’s OK that you did not know: We can’t really do anything with “did not work”, cannot help you. We need an example of your expected output and an example of how precisely your observed output differed. Please <a href=\"https://stackoverflow.com/posts/72775433/edit\">edit</a> your question and add this information. So that we may help you."},{"owner":{"account_id":25325051,"reputation":5,"user_id":19184481,"display_name":"abcd efgh"},"score":0,"creation_date":1656347931,"post_id":72775433,"comment_id":128544601,"body_markdown":"@OleV.V. this is the timestamp I&#39;m that I timestamp I get &quot;:&quot;2022-06-27T07:05:13.277Z&quot;","body":"@OleV.V. this is the timestamp I&#39;m that I timestamp I get &quot;:&quot;2022-06-27T07:05:13.277Z&quot;"},{"owner":{"account_id":7612423,"reputation":82486,"user_id":5772882,"display_name":"Anonymous"},"score":0,"creation_date":1656348007,"post_id":72775433,"comment_id":128544631,"body_markdown":"If I were to tease you, I’d just point out that `2022-06-27T07:05:13.277Z` is the same as `2022-06-27T07:05:13.277000Z`, so we can’t really tell from the output that you didn’t get microseconds. You are correct, of course, it’s still likely that you cannot get a precision beyond milliseconds on your Java. Which Java version are you using? On which OS?","body":"If I were to tease you, I’d just point out that <code>2022-06-27T07:05:13.277Z</code> is the same as <code>2022-06-27T07:05:13.277000Z</code>, so we can’t really tell from the output that you didn’t get microseconds. You are correct, of course, it’s still likely that you cannot get a precision beyond milliseconds on your Java. Which Java version are you using? On which OS?"},{"owner":{"account_id":25325051,"reputation":5,"user_id":19184481,"display_name":"abcd efgh"},"score":0,"creation_date":1656348211,"post_id":72775433,"comment_id":128544721,"body_markdown":"This is the version of java 1.6.0_18 on windows. \nI make a loop and all the timestamp are like this 2022-06-27T07:05:13.277Z 2022-06-27T07:05:13.278Z  2022-06-27T07:05:13.279Z ...","body":"This is the version of java 1.6.0_18 on windows.  I make a loop and all the timestamp are like this 2022-06-27T07:05:13.277Z 2022-06-27T07:05:13.278Z  2022-06-27T07:05:13.279Z ..."},{"owner":{"account_id":17835,"reputation":303895,"user_id":40342,"accept_rate":62,"display_name":"Joachim Sauer"},"score":0,"creation_date":1656348531,"post_id":72775433,"comment_id":128544840,"body_markdown":"@abcdefgh: are you **sure** that this is on 1.6.0_18? Because `Instant` wasn&#39;t introduced until Java 8 (i.e. 1.8.0). Also: why the *heck* would you run such an ancient version of Java? That&#39;s a security, stability, compatibility and supportability-risk all in one neat little ancient package!","body":"@abcdefgh: are you <b>sure</b> that this is on 1.6.0_18? Because <code>Instant</code> wasn&#39;t introduced until Java 8 (i.e. 1.8.0). Also: why the <i>heck</i> would you run such an ancient version of Java? That&#39;s a security, stability, compatibility and supportability-risk all in one neat little ancient package!"},{"owner":{"account_id":25325051,"reputation":5,"user_id":19184481,"display_name":"abcd efgh"},"score":0,"creation_date":1656348695,"post_id":72775433,"comment_id":128544896,"body_markdown":"Okay I&#39;m will update java right now, yes this is the version I get after running this command java -version.","body":"Okay I&#39;m will update java right now, yes this is the version I get after running this command java -version."},{"owner":{"account_id":7612423,"reputation":82486,"user_id":5772882,"display_name":"Anonymous"},"score":1,"creation_date":1656351282,"post_id":72775433,"comment_id":128545787,"body_markdown":"@JoachimSauer The OP may be using the [ThreeTen Backport](https://www.threeten.org/threetenbp/), the backport of java.time to Java 1.6 and 1.7. abcd efgh, are you importing `java.time.Instant` or `org.threeten.bp.Instant`?","body":"@JoachimSauer The OP may be using the <a href=\"https://www.threeten.org/threetenbp/\" rel=\"nofollow noreferrer\">ThreeTen Backport</a>, the backport of java.time to Java 1.6 and 1.7. abcd efgh, are you importing <code>java.time.Instant</code> or <code>org.threeten.bp.Instant</code>?"},{"owner":{"account_id":7612423,"reputation":82486,"user_id":5772882,"display_name":"Anonymous"},"score":0,"creation_date":1656351403,"post_id":72775433,"comment_id":128545837,"body_markdown":"If it’s a matter of getting 6 decimals printed, you may use `OffsetDateTime.now(ZoneOffset.UTC).format(DateTimeFormatter.ofPattern(&quot;uuuu-MM-dd&#39;T&#39;HH:mm:ss.SSSSSSX&quot;))` to get like `2022-06-27T17:36:04.516000Z`.","body":"If it’s a matter of getting 6 decimals printed, you may use <code>OffsetDateTime.now(ZoneOffset.UTC).format(DateTimeFormatter.&zwnj;&#8203;ofPattern(&quot;uuuu-MM-d&zwnj;&#8203;d&#39;T&#39;HH:mm:ss.SSSSSSX&zwnj;&#8203;&quot;))</code> to get like <code>2022-06-27T17:36:04.516000Z</code>."},{"owner":{"account_id":25325051,"reputation":5,"user_id":19184481,"display_name":"abcd efgh"},"score":0,"creation_date":1656407034,"post_id":72775433,"comment_id":128558326,"body_markdown":"Thanks for your help @OleV.V. I used your suggestion and it worked, please can you add it as answer so I can mark this question as answered.","body":"Thanks for your help @OleV.V. I used your suggestion and it worked, please can you add it as answer so I can mark this question as answered."},{"owner":{"account_id":7612423,"reputation":82486,"user_id":5772882,"display_name":"Anonymous"},"score":0,"creation_date":1656423701,"post_id":72775433,"comment_id":128565012,"body_markdown":"Glad that it was helpful. I am no longer contributing answers to Stack Overflow (for reasons that I try to explain in [my profile](https://stackoverflow.com/users/5772882/ole-v-v)). Feel free to post it as an answer yourself, and I shall be happy to upvote. You can also accept your own answer after a period (I think it’s 12 hours).","body":"Glad that it was helpful. I am no longer contributing answers to Stack Overflow (for reasons that I try to explain in <a href=\"https://stackoverflow.com/users/5772882/ole-v-v\">my profile</a>). Feel free to post it as an answer yourself, and I shall be happy to upvote. You can also accept your own answer after a period (I think it’s 12 hours)."}],"owner":{"account_id":25325051,"reputation":5,"user_id":19184481,"display_name":"abcd efgh"},"comment_count":12,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":319,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1656348363,"creation_date":1656347262,"question_id":72775433,"body_markdown":"I want to get current timestamp in ISO 8601 format with microseconds, like this format:\r\n\r\n&gt; 2021-12-15T16:06:24.400087Z\r\n\r\nI tried this but it did not work.\r\n\r\n    Instant ins = Instant.now().truncatedTo(ChronoUnit.MICROS);\r\n\r\nThis is the timestamp that I get:\r\n\r\n&gt; 2022-06-27T07:05:13.277Z","title":"Get timestamp iso 8601 in microseconds","body":"<p>I want to get current timestamp in ISO 8601 format with microseconds, like this format:</p>\n<blockquote>\n<p>2021-12-15T16:06:24.400087Z</p>\n</blockquote>\n<p>I tried this but it did not work.</p>\n<pre><code>Instant ins = Instant.now().truncatedTo(ChronoUnit.MICROS);\n</code></pre>\n<p>This is the timestamp that I get:</p>\n<blockquote>\n<p>2022-06-27T07:05:13.277Z</p>\n</blockquote>\n"},{"tags":["java","logging","log4j"],"comments":[{"owner":{"account_id":1317825,"reputation":12193,"user_id":1264321,"accept_rate":92,"display_name":"Stefan"},"score":0,"creation_date":1437386234,"post_id":31513314,"comment_id":50988619,"body_markdown":"Its a text file, just update it.","body":"Its a text file, just update it."}],"answers":[{"tags":[],"owner":{"account_id":1421913,"reputation":11238,"user_id":1346369,"accept_rate":57,"display_name":"vels4j"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1437385906,"creation_date":1437385906,"answer_id":31513444,"question_id":31513314,"body_markdown":"You can acheive this by [PropertyConfigurator configure and watch](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/PropertyConfigurator.html#configureAndWatch%28java.lang.String,%20long%29). \r\n\r\n   &gt;Read the configuration file configFilename if it exists. Moreover, a thread will be created that will periodically check if configFilename has been created or modified. The period is determined by the delay argument. If a change or file creation is detected, then configFilename is read to configure log4j. ","title":"Can I update log4j 1.2 xml configuration file programmatically?","body":"<p>You can acheive this by <a href=\"http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/PropertyConfigurator.html#configureAndWatch%28java.lang.String,%20long%29\" rel=\"nofollow\">PropertyConfigurator configure and watch</a>. </p>\n\n<blockquote>\n  <p>Read the configuration file configFilename if it exists. Moreover, a thread will be created that will periodically check if configFilename has been created or modified. The period is determined by the delay argument. If a change or file creation is detected, then configFilename is read to configure log4j. </p>\n</blockquote>\n"},{"tags":[],"owner":{"account_id":25622912,"reputation":11,"user_id":19394500,"display_name":"jenzinas"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656348341,"creation_date":1655931354,"answer_id":72721911,"question_id":31513314,"body_markdown":"for any chump who finds themselves stuck dealing with this, it is possible to write out the data as properties using \r\n\r\n```\r\norg.apache.log4j.config.PropertyPrinter;\r\n```","title":"Can I update log4j 1.2 xml configuration file programmatically?","body":"<p>for any chump who finds themselves stuck dealing with this, it is possible to write out the data as properties using</p>\n<pre><code>org.apache.log4j.config.PropertyPrinter;\n</code></pre>\n"}],"owner":{"account_id":5395600,"reputation":3,"user_id":4296921,"display_name":"Iain Duff"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":433,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1656348341,"creation_date":1437385519,"question_id":31513314,"body_markdown":"I know it is possible to reload log4j&#39;s xml configuration while the application is running, but the searching I&#39;ve done only shows how to do this when the XML config file is edited manually via a text editor. \r\n\r\nI want to be able to dynamically change the level of the root logger in my application via a web page and persist that change to the log4j XML configuration, so I won&#39;t have to change the log level again if I restart the application. Is it possible to do this, or can the log4j XML file only be updated manually?\r\n\r\nI am using log4j 1.2 in my application. \r\n\r\nMany thanks in advance! \r\n","title":"Can I update log4j 1.2 xml configuration file programmatically?","body":"<p>I know it is possible to reload log4j's xml configuration while the application is running, but the searching I've done only shows how to do this when the XML config file is edited manually via a text editor. </p>\n\n<p>I want to be able to dynamically change the level of the root logger in my application via a web page and persist that change to the log4j XML configuration, so I won't have to change the log level again if I restart the application. Is it possible to do this, or can the log4j XML file only be updated manually?</p>\n\n<p>I am using log4j 1.2 in my application. </p>\n\n<p>Many thanks in advance! </p>\n"},{"tags":["java","jakarta-mail"],"answers":[{"tags":[],"owner":{"account_id":1211967,"reputation":7024,"user_id":1180351,"display_name":"Rob Spoor"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1656347966,"creation_date":1656347966,"answer_id":72775573,"question_id":72775419,"body_markdown":"Your `Session` import is the wrong one. Replace the import for `android.se.omapi.Session` with `javax.mail.Session`. If that causes other issues, because you need both imports, then for one of them you to use the fully qualified name. For instance:\r\n\r\n    javax.mail.Session session = javax.mail.Session.getDefaultInstance(properties, null);\r\n\r\n---\r\n\r\nThe other issue is the `Uri` argument. There is no `MimeMessage` constructor that takes a `URI` or `Uri` argument. I assume that you have an existing message as a file and want to read from it. You&#39;d need to convert the `Uri` to an `InputStream`. I couldn&#39;t find anything for that in https://developer.android.com/reference/android/net/Uri. I&#39;d see if you can get rid of the `Uri` argument completely and replace it with an `InputStream` or something that can be converted to an `InputStream`.","title":"issue with getDefaultInstance and javax.mail.Session, java.io.InputStream","body":"<p>Your <code>Session</code> import is the wrong one. Replace the import for <code>android.se.omapi.Session</code> with <code>javax.mail.Session</code>. If that causes other issues, because you need both imports, then for one of them you to use the fully qualified name. For instance:</p>\n<pre><code>javax.mail.Session session = javax.mail.Session.getDefaultInstance(properties, null);\n</code></pre>\n<hr />\n<p>The other issue is the <code>Uri</code> argument. There is no <code>MimeMessage</code> constructor that takes a <code>URI</code> or <code>Uri</code> argument. I assume that you have an existing message as a file and want to read from it. You'd need to convert the <code>Uri</code> to an <code>InputStream</code>. I couldn't find anything for that in <a href=\"https://developer.android.com/reference/android/net/Uri\" rel=\"nofollow noreferrer\">https://developer.android.com/reference/android/net/Uri</a>. I'd see if you can get rid of the <code>Uri</code> argument completely and replace it with an <code>InputStream</code> or something that can be converted to an <code>InputStream</code>.</p>\n"}],"owner":{"account_id":23287046,"reputation":3,"user_id":17369716,"display_name":"Soccer05"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":366,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":72775573,"answer_count":1,"score":0,"last_activity_date":1656347966,"creation_date":1656347211,"question_id":72775419,"body_markdown":"I have looking around for answer to these two errors, and have not found the solution.\r\n\r\n    Cannot resolve method &#39;getDefaultInstance&#39; in &#39;Session&#39;\r\n    &#39;MimeMessage(javax.mail.Session, java.io.InputStream)&#39; in &#39;javax.mail.internet.MimeMessage&#39; cannot be applied to &#39;(android.se.omapi.Session, android.net.Uri)&#39;\r\n\r\nAm I missing something as to using the package?\r\n\r\n    public void getBodySignature(Uri uri) throws Exception {\r\n            Properties properties = System.getProperties();\r\n    \r\n            Session session = Session.getDefaultInstance(properties, null);\r\n            MimeMessage msg = new MimeMessage(session, uri);\r\n            SMIMESigned signedMessage;\r\n            // multipart/signed message\r\n            // two parts- one part for the content that was signed and one part for the actual signature.\r\n            if (msg.isMimeType(&quot;multipart/signed&quot;)) {\r\n                signedMessage = new SMIMESigned((MimeMultipart) msg.getContent());\r\n            } else if (msg.isMimeType(&quot;text/plain&quot;) || msg.isMimeType(&quot;application/pkcs7-signature&quot;)) {\r\n                // in this case the content is wrapped in the signature block.\r\n                signedMessage = new SMIMESigned(msg);\r\n            } else {\r\n                throw new IllegalArgumentException(&quot;Not a signed message!&quot;);\r\n            }","title":"issue with getDefaultInstance and javax.mail.Session, java.io.InputStream","body":"<p>I have looking around for answer to these two errors, and have not found the solution.</p>\n<pre><code>Cannot resolve method 'getDefaultInstance' in 'Session'\n'MimeMessage(javax.mail.Session, java.io.InputStream)' in 'javax.mail.internet.MimeMessage' cannot be applied to '(android.se.omapi.Session, android.net.Uri)'\n</code></pre>\n<p>Am I missing something as to using the package?</p>\n<pre><code>public void getBodySignature(Uri uri) throws Exception {\n        Properties properties = System.getProperties();\n\n        Session session = Session.getDefaultInstance(properties, null);\n        MimeMessage msg = new MimeMessage(session, uri);\n        SMIMESigned signedMessage;\n        // multipart/signed message\n        // two parts- one part for the content that was signed and one part for the actual signature.\n        if (msg.isMimeType(&quot;multipart/signed&quot;)) {\n            signedMessage = new SMIMESigned((MimeMultipart) msg.getContent());\n        } else if (msg.isMimeType(&quot;text/plain&quot;) || msg.isMimeType(&quot;application/pkcs7-signature&quot;)) {\n            // in this case the content is wrapped in the signature block.\n            signedMessage = new SMIMESigned(msg);\n        } else {\n            throw new IllegalArgumentException(&quot;Not a signed message!&quot;);\n        }\n</code></pre>\n"},{"tags":["java","spring","spring-boot","intellij-idea","h2"],"comments":[{"owner":{"account_id":2647801,"reputation":1383,"user_id":2290153,"display_name":"Matthias Wiedemann"},"score":1,"creation_date":1656345455,"post_id":72774835,"comment_id":128543658,"body_markdown":"Have you started the db server? See http://h2database.com/html/cheatSheet.html or check https://stackoverflow.com/a/55847035/2290153","body":"Have you started the db server? See <a href=\"http://h2database.com/html/cheatSheet.html\" rel=\"nofollow noreferrer\">h2database.com/html/cheatSheet.html</a> or check <a href=\"https://stackoverflow.com/a/55847035/2290153\">stackoverflow.com/a/55847035/2290153</a>"},{"owner":{"display_name":"user19254373"},"score":0,"creation_date":1656351263,"post_id":72774835,"comment_id":128545781,"body_markdown":"Amigo, I solved the problem by applying the suggestions on [this](https://stackoverflow.com/questions/43256295/how-to-access-in-memory-h2-database-of-one-spring-boot-application-from-another/43276769#43276769) page, thanks.","body":"Amigo, I solved the problem by applying the suggestions on <a href=\"https://stackoverflow.com/questions/43256295/how-to-access-in-memory-h2-database-of-one-spring-boot-application-from-another/43276769#43276769\">this</a> page, thanks."}],"answers":[{"tags":[],"owner":{"account_id":401843,"reputation":89788,"user_id":768644,"display_name":"rzwitserloot"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656347939,"creation_date":1656347939,"answer_id":72775566,"question_id":72774835,"body_markdown":"You seem to be a little confused.\r\n\r\nH2 can run in two different &#39;modes&#39;.\r\n\r\n### Local mode\r\n\r\nLocal mode means H2 &#39;just works&#39;, and you access this mode with the `file:` thing in the JDBC connect URL. The JDBC driver itself does all the database work, as in, it opens files, writes data, it does it all. _There is no &#39;database server&#39;_ at all. Or, if you prefer, the JDBC driver is its own server though it opens no ports.\r\n\r\n## Server mode\r\n\r\nIn this case __you need a (separate) JVM and separately fire up H2 in server mode__ and then you can use the same library (still `h2.jar`) to serve as a JDBC server. In this mode, the two things are __completely separate__ - if you want, you can run h2.jar on one machine to be the server, and run the same h2.jar on a completely different machine just to connect to the other H2 machine. The database server machine does the bulk of the work, with the &#39;client&#39; H2 just being the JDBC driver. H2 is no different than e.g. mysql or postgres in such a mode: You have one &#39;app&#39; / JVM process that runs as a database engine, allowing multiple different processes, even coming from completely different machines halfway around the world if you want to, to connect to it.\r\n\r\nYou access this mode with the `tcp:` thing in the JDBC string.\r\n\r\nIf you really want, you can run this mode and still have it all on a single machine, even a single JVM, but why would you want to? Whatever made you think this will &#39;solve lock errors&#39; wouldn&#39;t be fixed by running all this stuff on a single JVM. There are only two options:\r\n\r\n* You&#39;re mis-analysing the problem.\r\n* You really do have multiple separate JVM processes (either one machine with 2 `java` processes in the activity monitor / `ps auxww` output / task manager, or 2+ machines) all trying to connect to a single database in which case you certainly do need this, yes.\r\n\r\n## How to do server mode right\r\n\r\nYou most likely want a separate JVM that starts before and that hosts the h2 database; it needs to run before the &#39;client&#39; JVMs (the ones that will connect to it) start running. Catalina is not the &#39;server&#39; you are looking for, it is `org.h2.tools.Server`, and if it says &#39;not found&#39; you need to fix your maven imports. This needs be a separate JVM (you COULD write code that goes: Oh, hey, there isn&#39;t a separate JVM running with the h2 server so I&#39;ll start it in-process right here right now, but that means that process needs to stay in the air forever, which is just weird. Hence, you _want_ a separate JVM process for this).\r\n\r\nYou haven&#39;t explained what you&#39;re doing. But, let&#39;s say what you&#39;re doing is this:\r\n\r\n* I have a CI script that fires up multiple separate JVMs, some in parallel even, which runs a bunch of integration and unit tests in parallel.\r\n* Even though they run in parallel (or perhaps intentionally so), you all want to run this off of a single DB. This is usually a really bad idea (you want tests to be isolated; that running them on their own continues to behave identically. You don&#39;t want a test to fail in a way that can only be reproduced if you run the same batch of 18 separate tests using the same run code, where one unrelated test fails in a specific fashion, whilst it&#39;s Tuesday, a full moon, and Beethoven is playing in your music player, and it&#39;s warmer than 24&#186; in the room affecting the CPU&#39;s throttling, of course. Which is exactly what tends to happen if you try to re-use resources in multiple tests!) – still, you somehow really want this.\r\n* ... then, edit the CI script to first Launch a JVM that hosts a H2 server, and once that&#39;s up and running, presumably run a process that fills this database with test data, and once that&#39;s done, then run all tests in parallel, and once those are all done, shut down the JVM, and delete the DB file.\r\n\r\n\r\nExactly how to do the third part is a separate question - if you need help with that, ask a new question and name the relevant tool(s) you are using to run this stuff, paste the config files, etc.\r\n","title":"Cannot connect to H2 database","body":"<p>You seem to be a little confused.</p>\n<p>H2 can run in two different 'modes'.</p>\n<h3>Local mode</h3>\n<p>Local mode means H2 'just works', and you access this mode with the <code>file:</code> thing in the JDBC connect URL. The JDBC driver itself does all the database work, as in, it opens files, writes data, it does it all. <em>There is no 'database server'</em> at all. Or, if you prefer, the JDBC driver is its own server though it opens no ports.</p>\n<h2>Server mode</h2>\n<p>In this case <strong>you need a (separate) JVM and separately fire up H2 in server mode</strong> and then you can use the same library (still <code>h2.jar</code>) to serve as a JDBC server. In this mode, the two things are <strong>completely separate</strong> - if you want, you can run h2.jar on one machine to be the server, and run the same h2.jar on a completely different machine just to connect to the other H2 machine. The database server machine does the bulk of the work, with the 'client' H2 just being the JDBC driver. H2 is no different than e.g. mysql or postgres in such a mode: You have one 'app' / JVM process that runs as a database engine, allowing multiple different processes, even coming from completely different machines halfway around the world if you want to, to connect to it.</p>\n<p>You access this mode with the <code>tcp:</code> thing in the JDBC string.</p>\n<p>If you really want, you can run this mode and still have it all on a single machine, even a single JVM, but why would you want to? Whatever made you think this will 'solve lock errors' wouldn't be fixed by running all this stuff on a single JVM. There are only two options:</p>\n<ul>\n<li>You're mis-analysing the problem.</li>\n<li>You really do have multiple separate JVM processes (either one machine with 2 <code>java</code> processes in the activity monitor / <code>ps auxww</code> output / task manager, or 2+ machines) all trying to connect to a single database in which case you certainly do need this, yes.</li>\n</ul>\n<h2>How to do server mode right</h2>\n<p>You most likely want a separate JVM that starts before and that hosts the h2 database; it needs to run before the 'client' JVMs (the ones that will connect to it) start running. Catalina is not the 'server' you are looking for, it is <code>org.h2.tools.Server</code>, and if it says 'not found' you need to fix your maven imports. This needs be a separate JVM (you COULD write code that goes: Oh, hey, there isn't a separate JVM running with the h2 server so I'll start it in-process right here right now, but that means that process needs to stay in the air forever, which is just weird. Hence, you <em>want</em> a separate JVM process for this).</p>\n<p>You haven't explained what you're doing. But, let's say what you're doing is this:</p>\n<ul>\n<li>I have a CI script that fires up multiple separate JVMs, some in parallel even, which runs a bunch of integration and unit tests in parallel.</li>\n<li>Even though they run in parallel (or perhaps intentionally so), you all want to run this off of a single DB. This is usually a really bad idea (you want tests to be isolated; that running them on their own continues to behave identically. You don't want a test to fail in a way that can only be reproduced if you run the same batch of 18 separate tests using the same run code, where one unrelated test fails in a specific fashion, whilst it's Tuesday, a full moon, and Beethoven is playing in your music player, and it's warmer than 24º in the room affecting the CPU's throttling, of course. Which is exactly what tends to happen if you try to re-use resources in multiple tests!) – still, you somehow really want this.</li>\n<li>... then, edit the CI script to first Launch a JVM that hosts a H2 server, and once that's up and running, presumably run a process that fills this database with test data, and once that's done, then run all tests in parallel, and once those are all done, shut down the JVM, and delete the DB file.</li>\n</ul>\n<p>Exactly how to do the third part is a separate question - if you need help with that, ask a new question and name the relevant tool(s) you are using to run this stuff, paste the config files, etc.</p>\n"}],"owner":{"display_name":"user19254373"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":1373,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1656347948,"creation_date":1656344542,"question_id":72774835,"body_markdown":"I have been getting struggle to connect H2 database from a Spring Boot app by using the following connection string as mentioned on [Database URL Overview](http://h2database.com/html/features.html?highlight=server&amp;search=server#connection_modes) section:\r\n\r\n```\r\nspring.datasource.url=jdbc:h2:tcp://localhost:9092/~/test-db\r\n```\r\n\r\nI also tried many different combination for tcp (server mode) connection, but still get error e.g. &quot;*Connection is broken: &quot;java.net.SocketTimeoutException: connect timed out: localhost:9092&quot;* when running Spring Boot app.\r\n\r\n\r\n```\r\n@SpringBootApplication\r\npublic class Application {\r\n\r\n\t// code omitted\r\n\t\r\n\t@Bean(initMethod = &quot;start&quot;, destroyMethod = &quot;stop&quot;)\r\n\tpublic Server h2Server() throws SQLException {\r\n\t\treturn Server.createTcpServer(&quot;-tcp&quot;, &quot;-tcpAllowOthers&quot;, &quot;-tcpPort&quot;, &quot;9092&quot;);\r\n\t}\r\n}\r\n```\r\n\r\nSo, how can I fix this problem and connect to H2 database via server mode?","title":"Cannot connect to H2 database","body":"<p>I have been getting struggle to connect H2 database from a Spring Boot app by using the following connection string as mentioned on <a href=\"http://h2database.com/html/features.html?highlight=server&amp;search=server#connection_modes\" rel=\"nofollow noreferrer\">Database URL Overview</a> section:</p>\n<pre><code>spring.datasource.url=jdbc:h2:tcp://localhost:9092/~/test-db\n</code></pre>\n<p>I also tried many different combination for tcp (server mode) connection, but still get error e.g. &quot;<em>Connection is broken: &quot;java.net.SocketTimeoutException: connect timed out: localhost:9092&quot;</em> when running Spring Boot app.</p>\n<pre><code>@SpringBootApplication\npublic class Application {\n\n    // code omitted\n    \n    @Bean(initMethod = &quot;start&quot;, destroyMethod = &quot;stop&quot;)\n    public Server h2Server() throws SQLException {\n        return Server.createTcpServer(&quot;-tcp&quot;, &quot;-tcpAllowOthers&quot;, &quot;-tcpPort&quot;, &quot;9092&quot;);\n    }\n}\n</code></pre>\n<p>So, how can I fix this problem and connect to H2 database via server mode?</p>\n"},{"tags":["java","json"],"comments":[{"owner":{"account_id":3741438,"reputation":12025,"user_id":3111149,"accept_rate":87,"display_name":"Matteo NNZ"},"score":0,"creation_date":1656346318,"post_id":72775010,"comment_id":128543972,"body_markdown":"I don&#39;t know very well the javax&#39;s Json (I use Jackson), but your method `convertToJSONArray` is clearly creating a new array before adding the element, so it&#39;s normal that you always have the last element of the loop. I think you rather want to take a `JsonArray` in input and add the element to this.","body":"I don&#39;t know very well the javax&#39;s Json (I use Jackson), but your method <code>convertToJSONArray</code> is clearly creating a new array before adding the element, so it&#39;s normal that you always have the last element of the loop. I think you rather want to take a <code>JsonArray</code> in input and add the element to this."}],"answers":[{"tags":[],"owner":{"account_id":1507181,"reputation":13906,"user_id":1410303,"accept_rate":40,"display_name":"SomeDude"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1656346889,"creation_date":1656346406,"answer_id":72775243,"question_id":72775010,"body_markdown":"You need to create an [`JsonArrayBuilder`](https://docs.oracle.com/javaee/7/api/javax/json/JsonArrayBuilder.html) inside for loop instead of creating JsonArray at each step. Then build the builder outside of for loop like:\r\n    \r\n   \r\n    \r\n\r\n\r\n    JsonArrayBuilder arrayBuilder = null;\r\n    for (int i = 0; i &lt; 2; i++) {\r\n          testRun = new TestRun(faker.name().firstName(), faker.number().numberBetween(1, 200));\r\n          JsonObject jsonObject = testRun.convertToJSONObject();\r\n          if (arrayBuilder == null) {\r\n             arrayBuilder = Json.createArrayBuilder().add(jsonObject);\r\n          } else {\r\n             arrayBuilder = arrayBuilder.add(jsonObject);\r\n          }\r\n\r\n    }\r\n    \r\n    jsonArray = arrayBuilder.build();\r\n","title":"JsonArray is not adding all JsonObjects","body":"<p>You need to create an <a href=\"https://docs.oracle.com/javaee/7/api/javax/json/JsonArrayBuilder.html\" rel=\"nofollow noreferrer\"><code>JsonArrayBuilder</code></a> inside for loop instead of creating JsonArray at each step. Then build the builder outside of for loop like:</p>\n<pre><code>JsonArrayBuilder arrayBuilder = null;\nfor (int i = 0; i &lt; 2; i++) {\n      testRun = new TestRun(faker.name().firstName(), faker.number().numberBetween(1, 200));\n      JsonObject jsonObject = testRun.convertToJSONObject();\n      if (arrayBuilder == null) {\n         arrayBuilder = Json.createArrayBuilder().add(jsonObject);\n      } else {\n         arrayBuilder = arrayBuilder.add(jsonObject);\n      }\n\n}\n\njsonArray = arrayBuilder.build();\n</code></pre>\n"},{"tags":[],"owner":{"account_id":5535028,"reputation":1362,"user_id":4393666,"display_name":"Andrey Kotov"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656347846,"creation_date":1656347846,"answer_id":72775547,"question_id":72775010,"body_markdown":"TestRun.java\r\n\r\n    import javax.json.Json;\r\n    import javax.json.JsonObject;\r\n    import java.time.ZonedDateTime;\r\n    \r\n    public class TestRun {\r\n        private String name;\r\n        private Integer value;\r\n        private ZonedDateTime timestamp;\r\n    \r\n        public TestRun(String name, Integer value, ZonedDateTime timestamp) {\r\n            this.name = name;\r\n            this.value = value;\r\n            this.timestamp = timestamp;\r\n        }\r\n    \r\n        public JsonObject convertToJSONObject() {\r\n            return Json.createObjectBuilder()\r\n                    .add(&quot;name&quot;, name)\r\n                    .add(&quot;value&quot;, value)\r\n                    .add(&quot;timestamp&quot;, convertZonedDateTime())\r\n                    .build();\r\n        }\r\n    \r\n        private String convertZonedDateTime() {\r\n            return timestamp.toString(); // replace with yours code\r\n        }\r\n    }\r\n\r\nClass with `main` method:\r\n\r\n    import com.github.javafaker.Faker;\r\n    import javax.json.Json;\r\n    import javax.json.JsonArrayBuilder;\r\n    import javax.json.JsonObject;\r\n    import java.time.ZonedDateTime;\r\n    \r\n    public class FakerExample {\r\n    \r\n        public static void main(String[] args) {\r\n            Faker faker = new Faker();\r\n            JsonArrayBuilder jsonArrayBuilder = Json.createArrayBuilder();\r\n    \r\n            for (int i = 0; i &lt; 2; i++) {\r\n                var testRun = new TestRun(faker.name().firstName(), faker.number().numberBetween(1, 200), ZonedDateTime.now());\r\n                JsonObject object = testRun.convertToJSONObject();\r\n                jsonArrayBuilder.add(object);\r\n            }\r\n    \r\n            System.out.println(jsonArrayBuilder.build());\r\n        }\r\n    }","title":"JsonArray is not adding all JsonObjects","body":"<p>TestRun.java</p>\n<pre><code>import javax.json.Json;\nimport javax.json.JsonObject;\nimport java.time.ZonedDateTime;\n\npublic class TestRun {\n    private String name;\n    private Integer value;\n    private ZonedDateTime timestamp;\n\n    public TestRun(String name, Integer value, ZonedDateTime timestamp) {\n        this.name = name;\n        this.value = value;\n        this.timestamp = timestamp;\n    }\n\n    public JsonObject convertToJSONObject() {\n        return Json.createObjectBuilder()\n                .add(&quot;name&quot;, name)\n                .add(&quot;value&quot;, value)\n                .add(&quot;timestamp&quot;, convertZonedDateTime())\n                .build();\n    }\n\n    private String convertZonedDateTime() {\n        return timestamp.toString(); // replace with yours code\n    }\n}\n</code></pre>\n<p>Class with <code>main</code> method:</p>\n<pre><code>import com.github.javafaker.Faker;\nimport javax.json.Json;\nimport javax.json.JsonArrayBuilder;\nimport javax.json.JsonObject;\nimport java.time.ZonedDateTime;\n\npublic class FakerExample {\n\n    public static void main(String[] args) {\n        Faker faker = new Faker();\n        JsonArrayBuilder jsonArrayBuilder = Json.createArrayBuilder();\n\n        for (int i = 0; i &lt; 2; i++) {\n            var testRun = new TestRun(faker.name().firstName(), faker.number().numberBetween(1, 200), ZonedDateTime.now());\n            JsonObject object = testRun.convertToJSONObject();\n            jsonArrayBuilder.add(object);\n        }\n\n        System.out.println(jsonArrayBuilder.build());\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":25502779,"reputation":109,"user_id":19295685,"display_name":"seju"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":109,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":72775243,"answer_count":2,"score":1,"last_activity_date":1656347846,"creation_date":1656345349,"question_id":72775010,"body_markdown":"When I add a list of test JsonObjects, only the last JsonObject is add to the JsonArray. I do not understand why because I am following documentation from oracle. https://docs.oracle.com/javaee/7/api/javax/json/JsonArray.html\r\n\r\nMethods from class called TestRun\r\n\r\n    public JsonObject convertToJSONObject() {\r\n            return Json.createObjectBuilder()\r\n                    .add(&quot;name&quot;, name)\r\n                    .add(&quot;value&quot;, value)\r\n                    .add(&quot;timestamp&quot;, convertZonedDateTime())\r\n                    .build();\r\n        }\r\n    \r\n        public JsonArray convertToJSONArray(JsonObject object) {\r\n            return Json.createArrayBuilder()\r\n                    .add(object)\r\n                    .build();\r\n        }\r\n\r\nMain (Note: I am using faker to generate random info)\r\n\r\n    TestRun testRun;\r\n            Faker faker = new Faker(); //Faker to generate random level_name\r\n            JsonArray jsonArray = null;\r\n    \r\n    \r\n            for (int i = 0; i &lt; 2; i++) {\r\n                testRun = new TestRun(faker.name().firstName(), faker.number().numberBetween(1, 200));\r\n                JsonObject object = testRun.convertToJSONObject();\r\n                jsonArray = testRun.convertToJSONArray(object);\r\n            }\r\n            System.out.println(jsonArray);","title":"JsonArray is not adding all JsonObjects","body":"<p>When I add a list of test JsonObjects, only the last JsonObject is add to the JsonArray. I do not understand why because I am following documentation from oracle. <a href=\"https://docs.oracle.com/javaee/7/api/javax/json/JsonArray.html\" rel=\"nofollow noreferrer\">https://docs.oracle.com/javaee/7/api/javax/json/JsonArray.html</a></p>\n<p>Methods from class called TestRun</p>\n<pre><code>public JsonObject convertToJSONObject() {\n        return Json.createObjectBuilder()\n                .add(&quot;name&quot;, name)\n                .add(&quot;value&quot;, value)\n                .add(&quot;timestamp&quot;, convertZonedDateTime())\n                .build();\n    }\n\n    public JsonArray convertToJSONArray(JsonObject object) {\n        return Json.createArrayBuilder()\n                .add(object)\n                .build();\n    }\n</code></pre>\n<p>Main (Note: I am using faker to generate random info)</p>\n<pre><code>TestRun testRun;\n        Faker faker = new Faker(); //Faker to generate random level_name\n        JsonArray jsonArray = null;\n\n\n        for (int i = 0; i &lt; 2; i++) {\n            testRun = new TestRun(faker.name().firstName(), faker.number().numberBetween(1, 200));\n            JsonObject object = testRun.convertToJSONObject();\n            jsonArray = testRun.convertToJSONArray(object);\n        }\n        System.out.println(jsonArray);\n</code></pre>\n"},{"tags":["java","jackson","jackson-databind","jackson-dataformat-xml"],"comments":[{"owner":{"account_id":10329025,"reputation":1640,"user_id":7619578,"accept_rate":67,"display_name":"Int&#39;l Man Of Coding Mystery"},"score":0,"creation_date":1647033216,"post_id":71442485,"comment_id":126279758,"body_markdown":"I ended up using the `@JsonInclude(Include.NON_NULL)` and then used a conditional in the constructor to optionally set the address. But curious if there&#39;s a better way","body":"I ended up using the <code>@JsonInclude(Include.NON_NULL)</code> and then used a conditional in the constructor to optionally set the address. But curious if there&#39;s a better way"}],"answers":[{"tags":[],"owner":{"account_id":10329025,"reputation":1640,"user_id":7619578,"accept_rate":67,"display_name":"Int&#39;l Man Of Coding Mystery"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1656347806,"creation_date":1656347806,"answer_id":72775537,"question_id":71442485,"body_markdown":"I ended up using the @JsonInclude(Include.NON_NULL) and then used a conditional in the constructor to optionally set the address.","title":"@JsonInclude filtering by class&#39; attribute","body":"<p>I ended up using the @JsonInclude(Include.NON_NULL) and then used a conditional in the constructor to optionally set the address.</p>\n"}],"owner":{"account_id":10329025,"reputation":1640,"user_id":7619578,"accept_rate":67,"display_name":"Int&#39;l Man Of Coding Mystery"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":654,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":72775537,"answer_count":1,"score":2,"last_activity_date":1656347806,"creation_date":1647019885,"question_id":71442485,"body_markdown":"I am working on serializing classes to XML. I&#39;ve found `@JsonInclude` to be immensely helpful. However, I am having issues on filtering a class by its attribute. In the xml, if it&#39;s a US address I need to have one set of annotations for the fields using `@JsonProperty`. Because of this, I&#39;m trying to use the `Include` annotation to only show the relevant field based on the country. \r\n\r\nThe US address needs to have `USAddress` as the wrapper element name. Foreign Addresses need to have `ForeignAddress` as the wrapper element name as well as different element names for state/zip. \r\n\r\nIs there a way to access the class and it&#39;s attributes in the filter? I&#39;ve tried using the super class for both types of addresses, but with Bazel, I run into circular dependency issues when doing that. Im super new to bazel :P \r\n\r\n```java\r\npublic class Thing {\r\n  @JsonInclude(value = Include.CUSTOM, valueFilter = CountryFilter.class)\r\n  private final USAddress usAddress = new USAddress({line1: &quot;123 MockingBird Ln&quot;, country: &quot;US&quot;});\r\n  @JsonInclude(value = Include.CUSTOM, valueFilter = CountryFilter.class)\r\n  private final ForeignAddress foreignAddress = new ForeignAddress({line1: &quot;123 MockingBird Ln&quot;, country: &quot;DE&quot;});\r\n}\r\n\r\npublic class CountryFilter {\r\n  @Override\r\n  public boolean equals(Object obj) {\r\n    return ...; // This is where I&#39;m having issues. Would like it to do something like obj.getCountry().equals(&quot;US&quot;).\r\n  }\r\n}\r\n```","title":"@JsonInclude filtering by class&#39; attribute","body":"<p>I am working on serializing classes to XML. I've found <code>@JsonInclude</code> to be immensely helpful. However, I am having issues on filtering a class by its attribute. In the xml, if it's a US address I need to have one set of annotations for the fields using <code>@JsonProperty</code>. Because of this, I'm trying to use the <code>Include</code> annotation to only show the relevant field based on the country.</p>\n<p>The US address needs to have <code>USAddress</code> as the wrapper element name. Foreign Addresses need to have <code>ForeignAddress</code> as the wrapper element name as well as different element names for state/zip.</p>\n<p>Is there a way to access the class and it's attributes in the filter? I've tried using the super class for both types of addresses, but with Bazel, I run into circular dependency issues when doing that. Im super new to bazel :P</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Thing {\n  @JsonInclude(value = Include.CUSTOM, valueFilter = CountryFilter.class)\n  private final USAddress usAddress = new USAddress({line1: &quot;123 MockingBird Ln&quot;, country: &quot;US&quot;});\n  @JsonInclude(value = Include.CUSTOM, valueFilter = CountryFilter.class)\n  private final ForeignAddress foreignAddress = new ForeignAddress({line1: &quot;123 MockingBird Ln&quot;, country: &quot;DE&quot;});\n}\n\npublic class CountryFilter {\n  @Override\n  public boolean equals(Object obj) {\n    return ...; // This is where I'm having issues. Would like it to do something like obj.getCountry().equals(&quot;US&quot;).\n  }\n}\n</code></pre>\n"},{"tags":["java","spring","validation","option-type"],"comments":[{"owner":{"account_id":3211603,"reputation":289297,"user_id":2711488,"display_name":"Holger"},"score":1,"creation_date":1656407929,"post_id":72773784,"comment_id":128558669,"body_markdown":"Don’t waste you time by thinking whether an “optional is destroyed”, that’s not different to all the other billion objects that get “destroyed” without you ever thinking about them. Instead, think about the “Check-then-Act” antipattern and why it is a problem and whether `save` doesn’t already throw an exception when an ID doesn’t exist (or at least, should have an option to do so).","body":"Don’t waste you time by thinking whether an “optional is destroyed”, that’s not different to all the other billion objects that get “destroyed” without you ever thinking about them. Instead, think about the “Check-then-Act” antipattern and why it is a problem and whether <code>save</code> doesn’t already throw an exception when an ID doesn’t exist (or at least, should have an option to do so)."}],"answers":[{"tags":[],"owner":{"account_id":1100252,"reputation":10087,"user_id":1092818,"display_name":"crizzis"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1656347371,"creation_date":1656346963,"answer_id":72775368,"question_id":72773784,"body_markdown":"What do you mean by &#39;optional gets destroyed&#39;? \r\n\r\nYou want `CallCounselEntity entity = getCallCounselByUserId(...).orElseThrow(...)`. If the code doesn&#39;t throw, then the method continues with `entity` now being assigned a non-optional value which you can use to make the update. If the code throws, then, well, any remaining code in your method referencing `entity` will never be reached. That&#39;s the whole point. \r\n\r\nSo, to sum up, the following is perfectly valid code for your scenario: \r\n\r\n```\r\nCallCounselEntity entity = getCallCounselByUserId(...).orElseThrow(...)\r\n/* perform your update here */\r\n```\r\n\r\nAlternatively, you can use: \r\n```\r\ngetCallCounselByUserId(...).ifPresent(existingCounsel -&gt; { \r\n    /* perform your update here */ \r\n})\r\n```\r\n\r\nor \r\n```\r\ngetCallCounselByUserId(...).ifPresentOrElse(existingCounsel -&gt; { \r\n    /* perform your update here */ \r\n}, () -&gt; throw new RuntimeException(...))\r\n```\r\nif you still want to throw the exception for non-existent entities. ","title":"Wouldn&#39;t it be against the use of an optional object for validation?","body":"<p>What do you mean by 'optional gets destroyed'?</p>\n<p>You want <code>CallCounselEntity entity = getCallCounselByUserId(...).orElseThrow(...)</code>. If the code doesn't throw, then the method continues with <code>entity</code> now being assigned a non-optional value which you can use to make the update. If the code throws, then, well, any remaining code in your method referencing <code>entity</code> will never be reached. That's the whole point.</p>\n<p>So, to sum up, the following is perfectly valid code for your scenario:</p>\n<pre><code>CallCounselEntity entity = getCallCounselByUserId(...).orElseThrow(...)\n/* perform your update here */\n</code></pre>\n<p>Alternatively, you can use:</p>\n<pre><code>getCallCounselByUserId(...).ifPresent(existingCounsel -&gt; { \n    /* perform your update here */ \n})\n</code></pre>\n<p>or</p>\n<pre><code>getCallCounselByUserId(...).ifPresentOrElse(existingCounsel -&gt; { \n    /* perform your update here */ \n}, () -&gt; throw new RuntimeException(...))\n</code></pre>\n<p>if you still want to throw the exception for non-existent entities.</p>\n"}],"owner":{"account_id":16126285,"reputation":159,"user_id":11640962,"display_name":"바보린"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":136,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":72775368,"answer_count":1,"score":0,"last_activity_date":1656347371,"creation_date":1656340159,"question_id":72773784,"body_markdown":"I have a CRUD job.\r\n\r\nRead -&gt; Retrieves one object. Most have a value, but if an incorrect ID is entered, there may be no return value.\r\n\r\nSo we wrap it in an Optional object and return it.\r\n\r\nCreate -&gt; Let&#39;s pass.\r\n\r\nUpdate -&gt; Update the object mentioned in Read.\r\n\r\nDelete -&gt; Deletes the object mentioned in Read.\r\n\r\n\r\nHere, there is an ID that specifies the object to be updated or deleted (data row in DB).\r\n\r\nThe problem is I&#39;m not sure if an object with this id exists in the DB or not.\r\n\r\nI want to perform update or delete only when there is a value with ID in the DB.\r\n\r\nThe method I thought of at this time is to execute the first-mentioned Read method, receive an object wrapped in Optional, and pass if it is through orElseThrow().\r\n\r\nIf not, I used a method that raises a Throw exception.\r\n\r\nBut something seems wrong with this.\r\n\r\n1. Optional returned after inquiry is destroyed after only checking whether there is a value or not.\r\n\r\n2. But other than this, I can&#39;t think of a way to know if the DB really has a value.\r\n\r\n3. Wouldn&#39;t it be better to write if == null instead?\r\n\r\nBelow is the code I implemented.\r\n\r\nPlease suggest a good way.\r\n\r\n\r\n    public Optional&lt;CallCounselEntity&gt; getCallCounselByUserId(UUID userId, UUID counselId) {\r\n            return return callCounselRepository.findByUserId(userId, counselId);\r\n        }\r\n\r\n\r\n\r\n    public CallCounselEntity updateCallCounsel(CallCounselEntity callCounsel) {\r\n            **getCallCounselByUserId(callCounsel.getUserId(),callCounsel.getCounselId()).orElseThrow(() -&gt; new NoSuchElementException(&quot;No Search Data&quot;));**\r\n            callCounselRepository.save(callCounsel));\r\n    \r\n            return callCounsel;\r\n    }","title":"Wouldn&#39;t it be against the use of an optional object for validation?","body":"<p>I have a CRUD job.</p>\n<p>Read -&gt; Retrieves one object. Most have a value, but if an incorrect ID is entered, there may be no return value.</p>\n<p>So we wrap it in an Optional object and return it.</p>\n<p>Create -&gt; Let's pass.</p>\n<p>Update -&gt; Update the object mentioned in Read.</p>\n<p>Delete -&gt; Deletes the object mentioned in Read.</p>\n<p>Here, there is an ID that specifies the object to be updated or deleted (data row in DB).</p>\n<p>The problem is I'm not sure if an object with this id exists in the DB or not.</p>\n<p>I want to perform update or delete only when there is a value with ID in the DB.</p>\n<p>The method I thought of at this time is to execute the first-mentioned Read method, receive an object wrapped in Optional, and pass if it is through orElseThrow().</p>\n<p>If not, I used a method that raises a Throw exception.</p>\n<p>But something seems wrong with this.</p>\n<ol>\n<li><p>Optional returned after inquiry is destroyed after only checking whether there is a value or not.</p>\n</li>\n<li><p>But other than this, I can't think of a way to know if the DB really has a value.</p>\n</li>\n<li><p>Wouldn't it be better to write if == null instead?</p>\n</li>\n</ol>\n<p>Below is the code I implemented.</p>\n<p>Please suggest a good way.</p>\n<pre><code>public Optional&lt;CallCounselEntity&gt; getCallCounselByUserId(UUID userId, UUID counselId) {\n        return return callCounselRepository.findByUserId(userId, counselId);\n    }\n\n\n\npublic CallCounselEntity updateCallCounsel(CallCounselEntity callCounsel) {\n        **getCallCounselByUserId(callCounsel.getUserId(),callCounsel.getCounselId()).orElseThrow(() -&gt; new NoSuchElementException(&quot;No Search Data&quot;));**\n        callCounselRepository.save(callCounsel));\n\n        return callCounsel;\n}\n</code></pre>\n"},{"tags":["java","apache-kafka","kafka-consumer-api","apache-kafka-streams"],"comments":[{"owner":{"account_id":2671330,"reputation":183376,"user_id":2308683,"accept_rate":90,"display_name":"OneCricketeer"},"score":0,"creation_date":1656346843,"post_id":72772603,"comment_id":128544161,"body_markdown":"To fix the values going above 50, you would need to replace `.count()` with `.reduce` and implement your own aggregation functions. Also, depending on how high the value can go, you might want to use `Long` rather than `Integer`","body":"To fix the values going above 50, you would need to replace <code>.count()</code> with <code>.reduce</code> and implement your own aggregation functions. Also, depending on how high the value can go, you might want to use <code>Long</code> rather than <code>Integer</code>"},{"owner":{"account_id":4019117,"reputation":457,"user_id":3310135,"accept_rate":75,"display_name":"Abhijith Gururaj"},"score":0,"creation_date":1656351153,"post_id":72772603,"comment_id":128545749,"body_markdown":"@OneCricketeer Thanks, I will try that. We have a good cleanup and retention policy in the cluster (on both input and output topics for this builder). I know long datatype will handle the event count value but somehow it doesn&#39;t feel right to maintain the ever-increasing count value for this use-case. Also, is there anyway we can define a custom tumbling window based on the count of events occurred in the topic? The window should reset after every 50th event of a particular node(denoted by the hostname field).","body":"@OneCricketeer Thanks, I will try that. We have a good cleanup and retention policy in the cluster (on both input and output topics for this builder). I know long datatype will handle the event count value but somehow it doesn&#39;t feel right to maintain the ever-increasing count value for this use-case. Also, is there anyway we can define a custom tumbling window based on the count of events occurred in the topic? The window should reset after every 50th event of a particular node(denoted by the hostname field)."},{"owner":{"account_id":2671330,"reputation":183376,"user_id":2308683,"accept_rate":90,"display_name":"OneCricketeer"},"score":0,"creation_date":1656351929,"post_id":72772603,"comment_id":128545990,"body_markdown":"That would need to be done with session windows, but I dont think you can define a &quot;size&quot; for them. At least, not via DSL methods.","body":"That would need to be done with session windows, but I dont think you can define a &quot;size&quot; for them. At least, not via DSL methods."},{"owner":{"account_id":4019117,"reputation":457,"user_id":3310135,"accept_rate":75,"display_name":"Abhijith Gururaj"},"score":1,"creation_date":1656353012,"post_id":72772603,"comment_id":128546386,"body_markdown":"I think the following works now. \n`.groupByKey().reduce((value1, value2) -&gt; (value1 + value2) % 50L).toStream().filter((key, value) -&gt; value == 0)`\nThis should ensure the aggregate value never crosses, 50. Thanks!","body":"I think the following works now.  <code>.groupByKey().reduce((value1, value2) -&gt; (value1 + value2) % 50L).toStream().filter((key, value) -&gt; value == 0)</code> This should ensure the aggregate value never crosses, 50. Thanks!"},{"owner":{"account_id":2671330,"reputation":183376,"user_id":2308683,"accept_rate":90,"display_name":"OneCricketeer"},"score":0,"creation_date":1656353191,"post_id":72772603,"comment_id":128546446,"body_markdown":"Another solution, depending on what you need, would be to give an initializer of an arraylist, then add each value to the list in the combiner, making sure it never grows beyond 50 items. Then you can `mapValues(v -&gt; v.size())` if you wanted the size of the grouping","body":"Another solution, depending on what you need, would be to give an initializer of an arraylist, then add each value to the list in the combiner, making sure it never grows beyond 50 items. Then you can <code>mapValues(v -&gt; v.size())</code> if you wanted the size of the grouping"},{"owner":{"account_id":2671330,"reputation":183376,"user_id":2308683,"accept_rate":90,"display_name":"OneCricketeer"},"score":1,"creation_date":1656353341,"post_id":72772603,"comment_id":128546515,"body_markdown":"Also, you shouldn&#39;t need a `flatmap` as your list only has one item. Just `map` and `return new KeyValue&lt;&gt;(hostname, 1)` or `new KeyValue&lt;&gt;(hostname, gridClusterEvent)`","body":"Also, you shouldn&#39;t need a <code>flatmap</code> as your list only has one item. Just <code>map</code> and <code>return new KeyValue&lt;&gt;(hostname, 1)</code> or <code>new KeyValue&lt;&gt;(hostname, gridClusterEvent)</code>"}],"owner":{"account_id":4019117,"reputation":457,"user_id":3310135,"accept_rate":75,"display_name":"Abhijith Gururaj"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":404,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1656346738,"creation_date":1656335101,"question_id":72772603,"body_markdown":"I have a topic where I receive the following events from multiple nodes:\r\n\r\n    { eventName : &quot;script_execution_complete&quot;, eventTime : &quot;&lt;time_in_iso_format&gt;&quot;, hostname : &quot;hostA&quot; } \r\n    { eventName : &quot;script_execution_complete&quot;, eventTime : &quot;&lt;time_in_iso_format&gt;&quot;, hostname : &quot;hostB&quot; }\r\n    { eventName : &quot;script_execution_complete&quot;, eventTime : &quot;&lt;time_in_iso_format&gt;&quot;, hostname : &quot;hostC&quot; }\r\n    { eventName : &quot;script_execution_complete&quot;, eventTime : &quot;&lt;time_in_iso_format&gt;&quot;, hostname : &quot;hostA&quot; }\r\n    { eventName : &quot;script_execution_complete&quot;, eventTime : &quot;&lt;time_in_iso_format&gt;&quot;, hostname : &quot;hostB&quot; }\r\n    { eventName : &quot;script_execution_complete&quot;, eventTime : &quot;&lt;time_in_iso_format&gt;&quot;, hostname : &quot;hostC&quot; }\r\n\r\nI want to send a special event to another for every 50 occurrences of the above event for each host. For example, For every 50th/100th/150th occurrence of the &quot;script_execution_complete&quot; event for the &quot;hostA&quot;, I want to send the following event to another topic from the streams application.\r\n\r\n    { eventName : &quot;grid_node_restart&quot;, eventTime : &quot;&lt;time_in_iso_format&gt;&quot;, hostname : &quot;hostA&quot; }\r\n\r\nHow do I do this in Kafka Streams? I cannot define a particular Window with a time frame as we don&#39;t know how long will it take to receive the 50th event (or 100th/150th event) for a given node. \r\n\r\nWill a simple count() aggregation work after grouping them by hostnames? Is this scalable? My attempt to solve this is following:\r\n\r\n```\r\nstreamsBuilder.stream(topic, Consumed.with(Serdes.String(), gridJobEventSerde,\r\n                new AutomationEventTimestampExtractor(), null))\r\n                .filter((key, value) -&gt;\r\n                        value.getEventName().equals(&quot;script_execution_complete&quot;))\r\n                .flatMap((key, value) -&gt; {\r\n                    String hostname = value.getPayload().getHostname();\r\n                    if(hostname != null){\r\n                        hostname = hostname.trim().replace(&quot;\\n&quot;, &quot;&quot;).replace(&quot;\\r&quot;, &quot;&quot;);\r\n                    }\r\n                    List&lt;KeyValue&lt;String, Integer&gt;&gt; result = new ArrayList&lt;&gt;();\r\n\r\n                    result.add(new KeyValue&lt;&gt;(hostname, 1));\r\n                    return result;\r\n                })\r\n                .groupByKey()\r\n                .count()\r\n                .toStream()\r\n                .filter((key, value) -&gt; value % 50 == 0)\r\n                .flatMap((hostname, value) -&gt; {\r\n                    int errorCount = Math.toIntExact(value);\r\n                    GridClusterEventPayload payload = new GridClusterEventPayload();\r\n                    payload.setHostname(hostname);\r\n                    GridClusterEvent gridClusterEvent = new GridClusterEvent();\r\n                    gridClusterEvent.setEventName(&quot;grid_node_restart&quot;);\r\n                    gridClusterEvent.setEventTime(new Date());\r\n                    gridClusterEvent.setPayload(payload);\r\n                    List&lt;KeyValue&lt;String, GridClusterEvent&gt;&gt; result = new ArrayList&lt;&gt;();\r\n                    result.add(new KeyValue&lt;&gt;(hostname, gridClusterEvent));\r\n                    return result;\r\n                })\r\n                .to(&quot;grid_cluster&quot;, Produced.with(Serdes.String(), gridClusterEventSerdes));\r\n```\r\nThe count of events will easily go very high very fast. I feel the above solution is not a scalable one as more and more events would be processed and the count would increased. \r\n\r\n\r\nI want to reset the &quot;count&quot; of these events after every 50th event. Is this possible by defining a window without specifying time frames?  Is there a better way to implement this?\r\n\r\nEDIT:\r\nEven if a time window needs to specified, How can I send the restart event when either the 50th event has occured OR when the time window is expired? In the later case, even though the 50th event has not occurred, I would like to send the restart event after a window is expired and the count should reset in the next window.","title":"Kafka Streams: Send an event for every 50 records of a particular field in a topic","body":"<p>I have a topic where I receive the following events from multiple nodes:</p>\n<pre><code>{ eventName : &quot;script_execution_complete&quot;, eventTime : &quot;&lt;time_in_iso_format&gt;&quot;, hostname : &quot;hostA&quot; } \n{ eventName : &quot;script_execution_complete&quot;, eventTime : &quot;&lt;time_in_iso_format&gt;&quot;, hostname : &quot;hostB&quot; }\n{ eventName : &quot;script_execution_complete&quot;, eventTime : &quot;&lt;time_in_iso_format&gt;&quot;, hostname : &quot;hostC&quot; }\n{ eventName : &quot;script_execution_complete&quot;, eventTime : &quot;&lt;time_in_iso_format&gt;&quot;, hostname : &quot;hostA&quot; }\n{ eventName : &quot;script_execution_complete&quot;, eventTime : &quot;&lt;time_in_iso_format&gt;&quot;, hostname : &quot;hostB&quot; }\n{ eventName : &quot;script_execution_complete&quot;, eventTime : &quot;&lt;time_in_iso_format&gt;&quot;, hostname : &quot;hostC&quot; }\n</code></pre>\n<p>I want to send a special event to another for every 50 occurrences of the above event for each host. For example, For every 50th/100th/150th occurrence of the &quot;script_execution_complete&quot; event for the &quot;hostA&quot;, I want to send the following event to another topic from the streams application.</p>\n<pre><code>{ eventName : &quot;grid_node_restart&quot;, eventTime : &quot;&lt;time_in_iso_format&gt;&quot;, hostname : &quot;hostA&quot; }\n</code></pre>\n<p>How do I do this in Kafka Streams? I cannot define a particular Window with a time frame as we don't know how long will it take to receive the 50th event (or 100th/150th event) for a given node.</p>\n<p>Will a simple count() aggregation work after grouping them by hostnames? Is this scalable? My attempt to solve this is following:</p>\n<pre><code>streamsBuilder.stream(topic, Consumed.with(Serdes.String(), gridJobEventSerde,\n                new AutomationEventTimestampExtractor(), null))\n                .filter((key, value) -&gt;\n                        value.getEventName().equals(&quot;script_execution_complete&quot;))\n                .flatMap((key, value) -&gt; {\n                    String hostname = value.getPayload().getHostname();\n                    if(hostname != null){\n                        hostname = hostname.trim().replace(&quot;\\n&quot;, &quot;&quot;).replace(&quot;\\r&quot;, &quot;&quot;);\n                    }\n                    List&lt;KeyValue&lt;String, Integer&gt;&gt; result = new ArrayList&lt;&gt;();\n\n                    result.add(new KeyValue&lt;&gt;(hostname, 1));\n                    return result;\n                })\n                .groupByKey()\n                .count()\n                .toStream()\n                .filter((key, value) -&gt; value % 50 == 0)\n                .flatMap((hostname, value) -&gt; {\n                    int errorCount = Math.toIntExact(value);\n                    GridClusterEventPayload payload = new GridClusterEventPayload();\n                    payload.setHostname(hostname);\n                    GridClusterEvent gridClusterEvent = new GridClusterEvent();\n                    gridClusterEvent.setEventName(&quot;grid_node_restart&quot;);\n                    gridClusterEvent.setEventTime(new Date());\n                    gridClusterEvent.setPayload(payload);\n                    List&lt;KeyValue&lt;String, GridClusterEvent&gt;&gt; result = new ArrayList&lt;&gt;();\n                    result.add(new KeyValue&lt;&gt;(hostname, gridClusterEvent));\n                    return result;\n                })\n                .to(&quot;grid_cluster&quot;, Produced.with(Serdes.String(), gridClusterEventSerdes));\n</code></pre>\n<p>The count of events will easily go very high very fast. I feel the above solution is not a scalable one as more and more events would be processed and the count would increased.</p>\n<p>I want to reset the &quot;count&quot; of these events after every 50th event. Is this possible by defining a window without specifying time frames?  Is there a better way to implement this?</p>\n<p>EDIT:\nEven if a time window needs to specified, How can I send the restart event when either the 50th event has occured OR when the time window is expired? In the later case, even though the 50th event has not occurred, I would like to send the restart event after a window is expired and the count should reset in the next window.</p>\n"},{"tags":["java","floating-point","double"],"answers":[{"tags":[],"owner":{"account_id":11683,"reputation":1438179,"user_id":22656,"accept_rate":86,"display_name":"Jon Skeet"},"down_vote_count":1,"up_vote_count":145,"is_accepted":true,"score":144,"last_activity_date":1548659255,"creation_date":1243435359,"answer_id":916110,"question_id":916081,"body_markdown":"It&#39;s not that you&#39;re *actually* getting extra precision - it&#39;s that the float didn&#39;t accurately represent the number you were aiming for originally. The double *is* representing the original float accurately; `toString` is showing the &quot;extra&quot; data which was already present.\r\n\r\nFor example (and these numbers aren&#39;t right, I&#39;m just making things up) suppose you had:\r\n\r\n    float f = 0.1F;\r\n    double d = f;\r\n\r\nThen the value of `f` might be exactly 0.100000234523. `d` will have exactly the same value, but when you convert it to a string it will &quot;trust&quot; that it&#39;s accurate to a higher precision, so won&#39;t round off as early, and you&#39;ll see the &quot;extra digits&quot; which were already there, but hidden from you.\r\n\r\nWhen you convert to a string and back, you&#39;re ending up with a double value which is closer to the string value than the original float was - but that&#39;s only good *if* you really believe that the string value is what you really wanted.\r\n\r\nAre you sure that float/double are the appropriate types to use here instead of `BigDecimal`? If you&#39;re trying to use numbers which have precise decimal values (e.g. money), then `BigDecimal` is a more appropriate type IMO.","title":"Convert float to double without losing precision","body":"<p>It's not that you're <em>actually</em> getting extra precision - it's that the float didn't accurately represent the number you were aiming for originally. The double <em>is</em> representing the original float accurately; <code>toString</code> is showing the \"extra\" data which was already present.</p>\n\n<p>For example (and these numbers aren't right, I'm just making things up) suppose you had:</p>\n\n<pre><code>float f = 0.1F;\ndouble d = f;\n</code></pre>\n\n<p>Then the value of <code>f</code> might be exactly 0.100000234523. <code>d</code> will have exactly the same value, but when you convert it to a string it will \"trust\" that it's accurate to a higher precision, so won't round off as early, and you'll see the \"extra digits\" which were already there, but hidden from you.</p>\n\n<p>When you convert to a string and back, you're ending up with a double value which is closer to the string value than the original float was - but that's only good <em>if</em> you really believe that the string value is what you really wanted.</p>\n\n<p>Are you sure that float/double are the appropriate types to use here instead of <code>BigDecimal</code>? If you're trying to use numbers which have precise decimal values (e.g. money), then <code>BigDecimal</code> is a more appropriate type IMO.</p>\n"},{"tags":[],"owner":{"account_id":15903,"reputation":323433,"user_id":34088,"accept_rate":77,"display_name":"Aaron Digulla"},"down_vote_count":1,"up_vote_count":8,"is_accepted":false,"score":7,"last_activity_date":1471352618,"creation_date":1243435528,"answer_id":916136,"question_id":916081,"body_markdown":"Use a `BigDecimal` instead of `float`/`double`. There are a lot of numbers which can&#39;t be represented as binary floating point (for example, `0.1`). So you either must always round the result to a known precision or use `BigDecimal`.\r\n\r\nSee http://en.wikipedia.org/wiki/Floating_point for more information.","title":"Convert float to double without losing precision","body":"<p>Use a <code>BigDecimal</code> instead of <code>float</code>/<code>double</code>. There are a lot of numbers which can't be represented as binary floating point (for example, <code>0.1</code>). So you either must always round the result to a known precision or use <code>BigDecimal</code>.</p>\n\n<p>See <a href=\"http://en.wikipedia.org/wiki/Floating_point\" rel=\"nofollow noreferrer\">http://en.wikipedia.org/wiki/Floating_point</a> for more information.</p>\n"},{"tags":[],"owner":{"account_id":1771,"reputation":87476,"user_id":2424,"accept_rate":97,"display_name":"NotMe"},"down_vote_count":2,"up_vote_count":3,"is_accepted":false,"score":1,"last_activity_date":1243436136,"creation_date":1243436136,"answer_id":916221,"question_id":916081,"body_markdown":"Floats, by nature, are imprecise and always have neat rounding &quot;issues&quot;.  If precision is important then you might consider refactoring your application to use Decimal or BigDecimal.  \r\n\r\nYes, floats are computationally faster than decimals because of the on processor support.  However, do you want fast or accurate?\r\n\r\n","title":"Convert float to double without losing precision","body":"<p>Floats, by nature, are imprecise and always have neat rounding \"issues\".  If precision is important then you might consider refactoring your application to use Decimal or BigDecimal.  </p>\n\n<p>Yes, floats are computationally faster than decimals because of the on processor support.  However, do you want fast or accurate?</p>\n"},{"tags":[],"owner":{"account_id":2496,"reputation":266234,"user_id":3474,"accept_rate":83,"display_name":"erickson"},"down_vote_count":0,"up_vote_count":26,"is_accepted":false,"score":26,"last_activity_date":1243436164,"creation_date":1243436164,"answer_id":916225,"question_id":916081,"body_markdown":"This is due the contract of [`Float.toString(float)`,][1] which says in part: \r\n\r\n&gt; How many digits must be printed for\r\n&gt; the fractional part [&amp;hellip;]? There\r\n&gt; must be at least one digit to\r\n&gt; represent the fractional part, and\r\n&gt; beyond that as many, **but only as many,**\r\n&gt; *more digits as are needed to uniquely\r\n&gt; distinguish the argument value from\r\n&gt; adjacent values of type float.* That\r\n&gt; is, suppose that x is the exact\r\n&gt; mathematical value represented by the\r\n&gt; decimal representation produced by\r\n&gt; this method for a finite nonzero\r\n&gt; argument f. Then f must be the float \r\n&gt; value nearest to x; or, if two float\r\n&gt; values are equally close to x, then f\r\n&gt; must be one of them and the least\r\n&gt; significant bit of the significand of\r\n&gt; f must be 0.\r\n\r\n  [1]: http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Float.html#toString(float)","title":"Convert float to double without losing precision","body":"<p>This is due the contract of <a href=\"http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Float.html#toString(float)\" rel=\"noreferrer\"><code>Float.toString(float)</code>,</a> which says in part: </p>\n\n<blockquote>\n  <p>How many digits must be printed for\n  the fractional part [&hellip;]? There\n  must be at least one digit to\n  represent the fractional part, and\n  beyond that as many, <strong>but only as many,</strong>\n  <em>more digits as are needed to uniquely\n  distinguish the argument value from\n  adjacent values of type float.</em> That\n  is, suppose that x is the exact\n  mathematical value represented by the\n  decimal representation produced by\n  this method for a finite nonzero\n  argument f. Then f must be the float \n  value nearest to x; or, if two float\n  values are equally close to x, then f\n  must be one of them and the least\n  significant bit of the significand of\n  f must be 0.</p>\n</blockquote>\n"},{"tags":[],"owner":{"account_id":32722,"reputation":8502,"user_id":91012,"accept_rate":67,"display_name":"mR_fr0g"},"down_vote_count":1,"up_vote_count":2,"is_accepted":false,"score":1,"last_activity_date":1243436743,"creation_date":1243436743,"answer_id":916287,"question_id":916081,"body_markdown":"For information this comes under Item 48 - Avoid float and double when exact values are required, of Effective Java 2nd edition by Joshua Bloch. This book is jam packed with good stuff and definitely worth a look. ","title":"Convert float to double without losing precision","body":"<p>For information this comes under Item 48 - Avoid float and double when exact values are required, of Effective Java 2nd edition by Joshua Bloch. This book is jam packed with good stuff and definitely worth a look. </p>\n"},{"tags":[],"owner":{"account_id":343306,"reputation":1239,"user_id":674927,"accept_rate":38,"display_name":"Brecht Yperman"},"down_vote_count":0,"up_vote_count":53,"is_accepted":false,"score":53,"last_activity_date":1460236965,"creation_date":1328604344,"answer_id":9173262,"question_id":916081,"body_markdown":"I find converting to the binary representation easier to grasp this problem.\r\n\r\n    float f = 0.27f;\r\n    double d2 = (double) f;\r\n    double d3 = 0.27d;\r\n\t\t\r\n    System.out.println(Integer.toBinaryString(Float.floatToRawIntBits(f)));\r\n    System.out.println(Long.toBinaryString(Double.doubleToRawLongBits(d2)));\r\n    System.out.println(Long.toBinaryString(Double.doubleToRawLongBits(d3)));\r\n\r\nYou can see the float is expanded to the double by adding 0s to the end, but that the double representation of 0.27 is &#39;more accurate&#39;, hence the problem.\r\n\r\n\r\n       111110100010100011110101110001\r\n    11111111010001010001111010111000100000000000000000000000000000\r\n    11111111010001010001111010111000010100011110101110000101001000\r\n","title":"Convert float to double without losing precision","body":"<p>I find converting to the binary representation easier to grasp this problem.</p>\n\n<pre><code>float f = 0.27f;\ndouble d2 = (double) f;\ndouble d3 = 0.27d;\n\nSystem.out.println(Integer.toBinaryString(Float.floatToRawIntBits(f)));\nSystem.out.println(Long.toBinaryString(Double.doubleToRawLongBits(d2)));\nSystem.out.println(Long.toBinaryString(Double.doubleToRawLongBits(d3)));\n</code></pre>\n\n<p>You can see the float is expanded to the double by adding 0s to the end, but that the double representation of 0.27 is 'more accurate', hence the problem.</p>\n\n<pre><code>   111110100010100011110101110001\n11111111010001010001111010111000100000000000000000000000000000\n11111111010001010001111010111000010100011110101110000101001000\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2197558,"reputation":187,"user_id":1942845,"display_name":"Andrew"},"down_vote_count":2,"up_vote_count":19,"is_accepted":false,"score":17,"last_activity_date":1357129495,"creation_date":1357129495,"answer_id":14121994,"question_id":916081,"body_markdown":"I&#39;ve encountered this issue today and could not use refactor to BigDecimal, because the project is really huge. However I found solution using\r\n\r\n    Float result = new Float(5623.23)\r\n    Double doubleResult = new FloatingDecimal(result.floatValue()).doubleValue()\r\n\r\nAnd this works.\r\n\r\nNote that calling result.doubleValue() returns 5623.22998046875\r\n\r\nBut calling doubleResult.doubleValue() returns correctly 5623.23\r\n\r\nBut I am not entirely sure if its a correct solution.","title":"Convert float to double without losing precision","body":"<p>I've encountered this issue today and could not use refactor to BigDecimal, because the project is really huge. However I found solution using</p>\n\n<pre><code>Float result = new Float(5623.23)\nDouble doubleResult = new FloatingDecimal(result.floatValue()).doubleValue()\n</code></pre>\n\n<p>And this works.</p>\n\n<p>Note that calling result.doubleValue() returns 5623.22998046875</p>\n\n<p>But calling doubleResult.doubleValue() returns correctly 5623.23</p>\n\n<p>But I am not entirely sure if its a correct solution.</p>\n"},{"tags":[],"owner":{"account_id":7974674,"reputation":9,"user_id":6018246,"display_name":"AesmaDiv"},"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1457127084,"creation_date":1457093895,"answer_id":35795894,"question_id":916081,"body_markdown":"Does this work?\r\n\r\n    float flt = 145.664454;\r\n\r\n    Double dbl = 0.0;\r\n    dbl += flt;\r\n\r\n","title":"Convert float to double without losing precision","body":"<p>Does this work?</p>\n\n<pre><code>float flt = 145.664454;\n\nDouble dbl = 0.0;\ndbl += flt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1793578,"reputation":178,"user_id":1633493,"display_name":"GSD.Aaz"},"down_vote_count":1,"up_vote_count":13,"is_accepted":false,"score":12,"last_activity_date":1485361259,"creation_date":1485361259,"answer_id":41856558,"question_id":916081,"body_markdown":"I found the following solution:\r\n\r\n\tpublic static Double getFloatAsDouble(Float fValue) {\r\n\t\treturn Double.valueOf(fValue.toString());\r\n\t}\r\n\r\nIf you use *float* and *double* instead of *Float* and *Double* use the following:\r\n\r\n\tpublic static double getFloatAsDouble(float value) {\r\n\t\treturn Double.valueOf(Float.valueOf(value).toString()).doubleValue();\r\n\t}\r\n","title":"Convert float to double without losing precision","body":"<p>I found the following solution:</p>\n\n<pre><code>public static Double getFloatAsDouble(Float fValue) {\n    return Double.valueOf(fValue.toString());\n}\n</code></pre>\n\n<p>If you use <em>float</em> and <em>double</em> instead of <em>Float</em> and <em>Double</em> use the following:</p>\n\n<pre><code>public static double getFloatAsDouble(float value) {\n    return Double.valueOf(Float.valueOf(value).toString()).doubleValue();\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":3119418,"reputation":4685,"user_id":2639515,"accept_rate":45,"display_name":"Alessandro Roaro"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1590169931,"creation_date":1590072904,"answer_id":61937328,"question_id":916081,"body_markdown":"A simple solution that works well, is to parse the double from the string representation of the float:\r\n\r\n    double val = Double.valueOf(String.valueOf(yourFloat));\r\n\r\nNot super efficient, but it works!","title":"Convert float to double without losing precision","body":"<p>A simple solution that works well, is to parse the double from the string representation of the float:</p>\n\n<pre><code>double val = Double.valueOf(String.valueOf(yourFloat));\n</code></pre>\n\n<p>Not super efficient, but it works!</p>\n"},{"tags":[],"owner":{"account_id":25662310,"reputation":1,"user_id":19427903,"display_name":"clog02"},"down_vote_count":2,"up_vote_count":0,"is_accepted":false,"score":-2,"last_activity_date":1656346727,"creation_date":1656346727,"answer_id":72775312,"question_id":916081,"body_markdown":"There is a way to convert Float value into Double without adding the extra precision \r\n\r\n    Float aFloat= new Float(0.11);\r\n    String s = aFloat.toString();\r\n    Double aDouble = Double.parseDouble(s);\r\n\r\nThis Approach will not add an extra precisions to your Float value while converting. The only Problem with this approach is memory usage of the JVM by creating an extra tamp String object.\r\n\r\nWhen calling an toString() (aDouble.toString()) on Double will never add an extra precisions. The precisions will be added while type conversion.\r\n","title":"Convert float to double without losing precision","body":"<p>There is a way to convert Float value into Double without adding the extra precision</p>\n<pre><code>Float aFloat= new Float(0.11);\nString s = aFloat.toString();\nDouble aDouble = Double.parseDouble(s);\n</code></pre>\n<p>This Approach will not add an extra precisions to your Float value while converting. The only Problem with this approach is memory usage of the JVM by creating an extra tamp String object.</p>\n<p>When calling an toString() (aDouble.toString()) on Double will never add an extra precisions. The precisions will be added while type conversion.</p>\n"}],"owner":{"account_id":13853,"reputation":5322,"user_id":28038,"accept_rate":86,"display_name":"Steve Armstrong"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":300196,"favorite_count":0,"down_vote_count":0,"up_vote_count":125,"accepted_answer_id":916110,"answer_count":11,"score":125,"last_activity_date":1656346727,"creation_date":1243435156,"question_id":916081,"body_markdown":"I have a primitive float and I need as a primitive double. Simply casting the float to double gives me weird extra precision. For example:\r\n\r\n    float temp = 14009.35F;\r\n    System.out.println(Float.toString(temp)); // Prints 14009.35\r\n    System.out.println(Double.toString((double)temp)); // Prints 14009.349609375\r\n\r\nHowever, if instead of casting, I output the float as a string, and parse the string as a double, I get what I want:\r\n\r\n    System.out.println(Double.toString(Double.parseDouble(Float.toString(temp))));\r\n    // Prints 14009.35\r\n\r\nIs there a better way than to go to String and back?","title":"Convert float to double without losing precision","body":"<p>I have a primitive float and I need as a primitive double. Simply casting the float to double gives me weird extra precision. For example:</p>\n\n<pre><code>float temp = 14009.35F;\nSystem.out.println(Float.toString(temp)); // Prints 14009.35\nSystem.out.println(Double.toString((double)temp)); // Prints 14009.349609375\n</code></pre>\n\n<p>However, if instead of casting, I output the float as a string, and parse the string as a double, I get what I want:</p>\n\n<pre><code>System.out.println(Double.toString(Double.parseDouble(Float.toString(temp))));\n// Prints 14009.35\n</code></pre>\n\n<p>Is there a better way than to go to String and back?</p>\n"},{"tags":["java","angular","selenium","testing","primeng"],"answers":[{"tags":[],"owner":{"account_id":6990353,"reputation":1340,"user_id":5359846,"accept_rate":23,"display_name":"Tal Angel"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1656346633,"creation_date":1618846847,"answer_id":67165126,"question_id":67164392,"body_markdown":"Interesting problem.\r\n\r\nWell you have the handle object:\r\n\r\ndiv[class*=&#39;p-colorpicker-hue-handle&#39;]\r\n\r\nYou can try to drag it via Selenium up or down\r\n\r\nFor selecting colors you can find the &quot;main&quot; color picker and click not on the center of it, but by giving it offset:\r\n\r\n    String cssExpression = &quot;div[class=&#39;ng-trigger-overlayAnimation&#39;]\r\n    [class=&#39;p-colorpicker-panel&#39;]&quot;;\r\n    WebElement element = browser.findElement(By.\r\n    cssSelector(cssExpression));\r\n    Actions builder = new Actions(browser);\r\n    Action action = builder.moveToElement\r\n    (element, -20, -20).click().build();\r\n    action.perform();\r\n\r\nYou can play with the values and move in the X -50, and in Y -70 for example.\r\n\r\n\r\n","title":"How to interact with Angular ColorPicker components using Selenium WebDriver?","body":"<p>Interesting problem.</p>\n<p>Well you have the handle object:</p>\n<p>div[class*='p-colorpicker-hue-handle']</p>\n<p>You can try to drag it via Selenium up or down</p>\n<p>For selecting colors you can find the &quot;main&quot; color picker and click not on the center of it, but by giving it offset:</p>\n<pre><code>String cssExpression = &quot;div[class='ng-trigger-overlayAnimation']\n[class='p-colorpicker-panel']&quot;;\nWebElement element = browser.findElement(By.\ncssSelector(cssExpression));\nActions builder = new Actions(browser);\nAction action = builder.moveToElement\n(element, -20, -20).click().build();\naction.perform();\n</code></pre>\n<p>You can play with the values and move in the X -50, and in Y -70 for example.</p>\n"}],"owner":{"account_id":8818483,"reputation":64,"user_id":6589144,"display_name":"ZakaRia Janah"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":286,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"accepted_answer_id":67165126,"answer_count":1,"score":0,"last_activity_date":1656346633,"creation_date":1618844220,"question_id":67164392,"body_markdown":"How to interact with Angular ColorPicker components using Selenium WebDriver? There&#39;s no text field input for hex codes, and it&#39;s operated purely by mouse clicks. An example of it can be seen here: &lt;https://www.primefaces.org/primeng/showcase/#/colorpicker&gt;","title":"How to interact with Angular ColorPicker components using Selenium WebDriver?","body":"<p>How to interact with Angular ColorPicker components using Selenium WebDriver? There's no text field input for hex codes, and it's operated purely by mouse clicks. An example of it can be seen here: <a href=\"https://www.primefaces.org/primeng/showcase/#/colorpicker\" rel=\"nofollow noreferrer\">https://www.primefaces.org/primeng/showcase/#/colorpicker</a></p>\n"},{"tags":["java","jersey","jax-rs","embedded-jetty","jetty-9"],"comments":[{"owner":{"account_id":406289,"reputation":47511,"user_id":775715,"accept_rate":100,"display_name":"Joakim Erdfelt"},"score":0,"creation_date":1595857043,"post_id":63115860,"comment_id":111611004,"body_markdown":"Your code works fine, it can handle requests (using persistent connections or not) in the millions.   Note: there&#39;s plenty of stuff in your code that does nothing, and other things you are using that actually undoes security settings.   But nothing about it is causing only 2000 requests like you are describing.","body":"Your code works fine, it can handle requests (using persistent connections or not) in the millions.   Note: there&#39;s plenty of stuff in your code that does nothing, and other things you are using that actually undoes security settings.   But nothing about it is causing only 2000 requests like you are describing."},{"owner":{"account_id":406289,"reputation":47511,"user_id":775715,"accept_rate":100,"display_name":"Joakim Erdfelt"},"score":0,"creation_date":1595857321,"post_id":63115860,"comment_id":111611163,"body_markdown":"Because of your `/*` url-pattern on jersey, that means that Jersey is responsible for serving *ALL* content that you request, nothing from DefaultServlet or ResourceHandler.   This url-pattern is really not helping you diagnose things on the Jetty side, as it has very little to do.  You can prove this out by moving the jersey url-pattern to something like `/api/*` and when you hit the limit you experience, request something from jetty like `/index.html`, if you get a response, Jetty is healthy.","body":"Because of your <code>&#47;*</code> url-pattern on jersey, that means that Jersey is responsible for serving <i>ALL</i> content that you request, nothing from DefaultServlet or ResourceHandler.   This url-pattern is really not helping you diagnose things on the Jetty side, as it has very little to do.  You can prove this out by moving the jersey url-pattern to something like <code>&#47;api&#47;*</code> and when you hit the limit you experience, request something from jetty like <code>&#47;index.html</code>, if you get a response, Jetty is healthy."}],"owner":{"account_id":16053809,"reputation":111,"user_id":11586886,"display_name":"Mohammadsadegh"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":436,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1656346281,"creation_date":1595854766,"question_id":63115860,"body_markdown":"I&#39;m developing an embedded jetty server with REST compatibility with JAX-RS library.\r\nBut weirdly server stops responding after 1800 to 2000 requests without any error code or throwing an exception.\r\nThe data transferring is a bunch of protobuff MapBox vector tiles. Although with passing even empty data to the client the problem exists and I&#39;m almost confident that the problem isn&#39;t because of database connection pooling.\r\nJetty version is 9.4.30.v20200611 and the code to start the server is as follows:\r\n```\r\npackage org.maps.server;\r\n\r\nimport org.eclipse.jetty.server.*;\r\nimport org.eclipse.jetty.server.handler.DefaultHandler;\r\nimport org.eclipse.jetty.server.handler.HandlerList;\r\nimport org.eclipse.jetty.server.handler.ResourceHandler;\r\nimport org.eclipse.jetty.servlet.DefaultServlet;\r\nimport org.eclipse.jetty.servlet.FilterHolder;\r\nimport org.eclipse.jetty.servlet.ServletContextHandler;\r\nimport org.eclipse.jetty.servlet.ServletHolder;\r\nimport org.eclipse.jetty.servlets.CrossOriginFilter;\r\nimport org.eclipse.jetty.util.ssl.SslContextFactory;\r\nimport org.eclipse.jetty.util.thread.QueuedThreadPool;\r\nimport org.glassfish.jersey.servlet.ServletContainer;\r\nimport org.maps.server.rest.MBTiles;\r\nimport org.maps.server.rest.MapLayers;\r\n\r\n\r\nimport javax.servlet.DispatcherType;\r\nimport java.util.EnumSet;\r\nimport java.util.Objects;\r\n\r\n\r\npublic class JettyServerApp {\r\n    public static void main(String[] args) throws Exception {\r\n\r\n        ServletContextHandler contextHandler = new ServletContextHandler(ServletContextHandler.NO_SESSIONS | ServletContextHandler.NO_SECURITY);\r\n        contextHandler.setContextPath(&quot;/&quot;);\r\n\r\n        //Enable CORS\r\n        FilterHolder cors = contextHandler.addFilter(CrossOriginFilter.class, &quot;/*&quot;, EnumSet.of(DispatcherType.REQUEST));\r\n        cors.setInitParameter(CrossOriginFilter.ALLOWED_ORIGINS_PARAM, &quot;*&quot;);\r\n        cors.setInitParameter(CrossOriginFilter.ACCESS_CONTROL_ALLOW_ORIGIN_HEADER, &quot;*&quot;);\r\n        cors.setInitParameter(CrossOriginFilter.ALLOWED_METHODS_PARAM, &quot;GET,POST,HEAD&quot;);\r\n        cors.setInitParameter(CrossOriginFilter.ALLOWED_HEADERS_PARAM, &quot;X-Requested-With,Content-Type,Accept,Origin&quot;);\r\n\r\n//      Welcome files\r\n        ServletHolder def = new ServletHolder(&quot;default&quot;, DefaultServlet.class);\r\n        def.setInitParameter(&quot;resourceBase&quot;, &quot;./http/&quot;);\r\n        def.setInitParameter(&quot;dirAllowed&quot;, &quot;false&quot;);\r\n        contextHandler.addServlet(def, &quot;/&quot;);\r\n        contextHandler.setWelcomeFiles(new String[]{&quot;index.html&quot;});\r\n\r\n        ResourceHandler resourceHandler = new ResourceHandler();\r\n        resourceHandler.setDirectoriesListed(true);\r\n        resourceHandler.setWelcomeFiles(new String[]{&quot;index.html&quot;});\r\n\r\n        HandlerList handlers = new HandlerList();\r\n        handlers.setHandlers(new Handler[]{contextHandler, new DefaultHandler()});\r\n\r\n        // initializing thread pool\r\n        QueuedThreadPool threadPool = new QueuedThreadPool();\r\n        threadPool.setMinThreads(10);\r\n        threadPool.setMaxThreads(1000);\r\n        threadPool.setIdleTimeout(120);\r\n\r\n        Server jettyServer = new Server(threadPool);\r\n        jettyServer.setHandler(handlers);\r\n\r\n        ServerConnector http = new ServerConnector(jettyServer);\r\n        http.setPort(9003);\r\n        jettyServer.addConnector(http);\r\n\r\n        // Enabling SSL in Embedded Jetty\r\n        HttpConfiguration httpConfig = new HttpConfiguration();\r\n        httpConfig.setSecureScheme(&quot;https&quot;);\r\n        httpConfig.setSecurePort(Integer.parseInt(Objects.requireNonNull(PropertyValues.getProperty(&quot;port&quot;))));\r\n\r\n        HttpConfiguration httpsConfig = new HttpConfiguration(httpConfig);\r\n        httpsConfig.addCustomizer(new SecureRequestCustomizer());\r\n\r\n        SslContextFactory.Server sslContextFactory = new SslContextFactory.Server();\r\n        sslContextFactory.setExcludeCipherSuites(&quot;^.*_(MD5|SHA|SHA1)$&quot;);\r\n\r\n        ServletHolder jerseyServlet = contextHandler.addServlet(\r\n                ServletContainer.class, &quot;/*&quot;);\r\n\r\n        jerseyServlet.setInitParameter(\r\n                &quot;jersey.config.server.provider.classnames&quot;,\r\n                MBTiles.class.getCanonicalName() +\r\n                        &quot;,&quot; + MainPage.class.getCanonicalName() +\r\n                        &quot;,&quot; + MapLayers.class.getCanonicalName());\r\n\r\n\r\n        try {\r\n            jettyServer.start();\r\n            jettyServer.join();\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n            jettyServer.stop();\r\n            jettyServer.destroy();\r\n        }\r\n    }\r\n}\r\n```\r\n\r\n","title":"Jetty server 9.4.30 stops responding after a specific number of requests","body":"<p>I'm developing an embedded jetty server with REST compatibility with JAX-RS library.\nBut weirdly server stops responding after 1800 to 2000 requests without any error code or throwing an exception.\nThe data transferring is a bunch of protobuff MapBox vector tiles. Although with passing even empty data to the client the problem exists and I'm almost confident that the problem isn't because of database connection pooling.\nJetty version is 9.4.30.v20200611 and the code to start the server is as follows:</p>\n<pre><code>package org.maps.server;\n\nimport org.eclipse.jetty.server.*;\nimport org.eclipse.jetty.server.handler.DefaultHandler;\nimport org.eclipse.jetty.server.handler.HandlerList;\nimport org.eclipse.jetty.server.handler.ResourceHandler;\nimport org.eclipse.jetty.servlet.DefaultServlet;\nimport org.eclipse.jetty.servlet.FilterHolder;\nimport org.eclipse.jetty.servlet.ServletContextHandler;\nimport org.eclipse.jetty.servlet.ServletHolder;\nimport org.eclipse.jetty.servlets.CrossOriginFilter;\nimport org.eclipse.jetty.util.ssl.SslContextFactory;\nimport org.eclipse.jetty.util.thread.QueuedThreadPool;\nimport org.glassfish.jersey.servlet.ServletContainer;\nimport org.maps.server.rest.MBTiles;\nimport org.maps.server.rest.MapLayers;\n\n\nimport javax.servlet.DispatcherType;\nimport java.util.EnumSet;\nimport java.util.Objects;\n\n\npublic class JettyServerApp {\n    public static void main(String[] args) throws Exception {\n\n        ServletContextHandler contextHandler = new ServletContextHandler(ServletContextHandler.NO_SESSIONS | ServletContextHandler.NO_SECURITY);\n        contextHandler.setContextPath(&quot;/&quot;);\n\n        //Enable CORS\n        FilterHolder cors = contextHandler.addFilter(CrossOriginFilter.class, &quot;/*&quot;, EnumSet.of(DispatcherType.REQUEST));\n        cors.setInitParameter(CrossOriginFilter.ALLOWED_ORIGINS_PARAM, &quot;*&quot;);\n        cors.setInitParameter(CrossOriginFilter.ACCESS_CONTROL_ALLOW_ORIGIN_HEADER, &quot;*&quot;);\n        cors.setInitParameter(CrossOriginFilter.ALLOWED_METHODS_PARAM, &quot;GET,POST,HEAD&quot;);\n        cors.setInitParameter(CrossOriginFilter.ALLOWED_HEADERS_PARAM, &quot;X-Requested-With,Content-Type,Accept,Origin&quot;);\n\n//      Welcome files\n        ServletHolder def = new ServletHolder(&quot;default&quot;, DefaultServlet.class);\n        def.setInitParameter(&quot;resourceBase&quot;, &quot;./http/&quot;);\n        def.setInitParameter(&quot;dirAllowed&quot;, &quot;false&quot;);\n        contextHandler.addServlet(def, &quot;/&quot;);\n        contextHandler.setWelcomeFiles(new String[]{&quot;index.html&quot;});\n\n        ResourceHandler resourceHandler = new ResourceHandler();\n        resourceHandler.setDirectoriesListed(true);\n        resourceHandler.setWelcomeFiles(new String[]{&quot;index.html&quot;});\n\n        HandlerList handlers = new HandlerList();\n        handlers.setHandlers(new Handler[]{contextHandler, new DefaultHandler()});\n\n        // initializing thread pool\n        QueuedThreadPool threadPool = new QueuedThreadPool();\n        threadPool.setMinThreads(10);\n        threadPool.setMaxThreads(1000);\n        threadPool.setIdleTimeout(120);\n\n        Server jettyServer = new Server(threadPool);\n        jettyServer.setHandler(handlers);\n\n        ServerConnector http = new ServerConnector(jettyServer);\n        http.setPort(9003);\n        jettyServer.addConnector(http);\n\n        // Enabling SSL in Embedded Jetty\n        HttpConfiguration httpConfig = new HttpConfiguration();\n        httpConfig.setSecureScheme(&quot;https&quot;);\n        httpConfig.setSecurePort(Integer.parseInt(Objects.requireNonNull(PropertyValues.getProperty(&quot;port&quot;))));\n\n        HttpConfiguration httpsConfig = new HttpConfiguration(httpConfig);\n        httpsConfig.addCustomizer(new SecureRequestCustomizer());\n\n        SslContextFactory.Server sslContextFactory = new SslContextFactory.Server();\n        sslContextFactory.setExcludeCipherSuites(&quot;^.*_(MD5|SHA|SHA1)$&quot;);\n\n        ServletHolder jerseyServlet = contextHandler.addServlet(\n                ServletContainer.class, &quot;/*&quot;);\n\n        jerseyServlet.setInitParameter(\n                &quot;jersey.config.server.provider.classnames&quot;,\n                MBTiles.class.getCanonicalName() +\n                        &quot;,&quot; + MainPage.class.getCanonicalName() +\n                        &quot;,&quot; + MapLayers.class.getCanonicalName());\n\n\n        try {\n            jettyServer.start();\n            jettyServer.join();\n        } catch (Exception e) {\n            e.printStackTrace();\n            jettyServer.stop();\n            jettyServer.destroy();\n        }\n    }\n}\n</code></pre>\n"},{"tags":["java","spring-boot","jpa","locking","jdbctemplate"],"comments":[{"owner":{"account_id":2647801,"reputation":1383,"user_id":2290153,"display_name":"Matthias Wiedemann"},"score":0,"creation_date":1656346648,"post_id":72774900,"comment_id":128544083,"body_markdown":"Not sure what is blocking you from using annotations on repository level, but you can handle locking programmatically on entityManager api. Compare i.e. https://dzone.com/articles/concurrency-and-locking-with-jpa-everything-you-ne","body":"Not sure what is blocking you from using annotations on repository level, but you can handle locking programmatically on entityManager api. Compare i.e. <a href=\"https://dzone.com/articles/concurrency-and-locking-with-jpa-everything-you-ne\" rel=\"nofollow noreferrer\">dzone.com/articles/&hellip;</a>"},{"owner":{"account_id":5876779,"reputation":1572,"user_id":4627382,"accept_rate":27,"display_name":"sparsh610"},"score":0,"creation_date":1656347065,"post_id":72774900,"comment_id":128544242,"body_markdown":"@MatthiasWiedemann Hi thanks for reply. I am exchanging lots of data from one table to other using exchange command for that I am Disable and enable constraint At service level. Not sure how to do the same while doing a repository level","body":"@MatthiasWiedemann Hi thanks for reply. I am exchanging lots of data from one table to other using exchange command for that I am Disable and enable constraint At service level. Not sure how to do the same while doing a repository level"},{"owner":{"account_id":2647801,"reputation":1383,"user_id":2290153,"display_name":"Matthias Wiedemann"},"score":0,"creation_date":1656361085,"post_id":72774900,"comment_id":128548850,"body_markdown":"Ok locking the whole table seems not supported by jpa. See solution with lockEntity suggested in https://stackoverflow.com/a/32348554/2290153","body":"Ok locking the whole table seems not supported by jpa. See solution with lockEntity suggested in <a href=\"https://stackoverflow.com/a/32348554/2290153\">stackoverflow.com/a/32348554/2290153</a>"},{"owner":{"account_id":2647801,"reputation":1383,"user_id":2290153,"display_name":"Matthias Wiedemann"},"score":0,"creation_date":1656361414,"post_id":72774900,"comment_id":128548945,"body_markdown":"Another locking implementation technique other than jpa could be hazelcast https://docs.hazelcast.com/imdg/4.2/data-structures/fencedlock","body":"Another locking implementation technique other than jpa could be hazelcast <a href=\"https://docs.hazelcast.com/imdg/4.2/data-structures/fencedlock\" rel=\"nofollow noreferrer\">docs.hazelcast.com/imdg/4.2/data-structures/fencedlock</a>"}],"owner":{"account_id":5876779,"reputation":1572,"user_id":4627382,"accept_rate":27,"display_name":"sparsh610"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":531,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1656346266,"creation_date":1656344927,"question_id":72774900,"body_markdown":"In my project I am using springboot and JPA.\r\n\r\nIn my project I have a table T, which can be updated from two methods A and B. A &amp; B are implemented in service layer So I cannot use lock annotation as we can use lock annotation only on repository level.\r\n\r\nA() { \r\n\r\nUpdating table T\r\n\r\n}\r\n\r\nB() {\r\nUpdating table T\r\n\r\n}\r\n\r\nMethod A and B are called from two different API. I need to acquire lock on table T while my method B is executing and if in meantime someone calls method A then he should wait until method B complete.\r\n\r\nI also have JDBCtemplate instance In my project, in case if we can achieve locking by JDBC.\r\n\r\nIn my method B I am disabling and enabling my constraint So I want to acquire lock on table so there will be no chance of duplicate records.\r\n\r\nPlease help","title":"JPA : How to acquire lock on table without lock annotation in repository","body":"<p>In my project I am using springboot and JPA.</p>\n<p>In my project I have a table T, which can be updated from two methods A and B. A &amp; B are implemented in service layer So I cannot use lock annotation as we can use lock annotation only on repository level.</p>\n<p>A() {</p>\n<p>Updating table T</p>\n<p>}</p>\n<p>B() {\nUpdating table T</p>\n<p>}</p>\n<p>Method A and B are called from two different API. I need to acquire lock on table T while my method B is executing and if in meantime someone calls method A then he should wait until method B complete.</p>\n<p>I also have JDBCtemplate instance In my project, in case if we can achieve locking by JDBC.</p>\n<p>In my method B I am disabling and enabling my constraint So I want to acquire lock on table so there will be no chance of duplicate records.</p>\n<p>Please help</p>\n"},{"tags":["java","spring-boot","mockito","apache-httpcomponents"],"answers":[{"tags":[],"owner":{"account_id":11856842,"reputation":46,"user_id":8676641,"display_name":"Roberto Foglia"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1655407548,"creation_date":1655407548,"answer_id":72650957,"question_id":72649574,"body_markdown":"The created mocks aren&#39;t used in the ProductService because they aren&#39;t passed in the construct. The class dependencies should be injected through the construct because they are mandatory.\r\n\r\nIt would help if you changed the implementation like the following. The code is incomplete.\r\n\r\n```java\r\npublic class ProductService {\r\n\r\n    private final VaultConfig vaultConfig;\r\n    private final AppConfig appConfig;\r\n    private final CloseableHttpClient client;\r\n\r\n    public ProductService(VaultConfig vaultConfig,\r\n                          @Autowired AppConfig appConfig, CloseableHttpClient client) {\r\n            this.vaultConfig = vaultConfig;\r\n            this.appConfig = appConfig;\r\n    }\r\n\r\n    private void createAccessToken() {\r\n        String httpUrl = MessageFormat.format(&quot;{0}/api/v1/authentication/login&quot;,\r\n            appConfig.getProductServerUrl());\r\n        HttpPost httpPost = new HttpPost(httpUrl);\r\n        List&lt;NameValuePair&gt; httpParams = new ArrayList&lt;NameValuePair&gt;();\r\n        httpParams.add(new BasicNameValuePair(&quot;username&quot;, this.vaultConfig.getProductAdminUsername()));\r\n        httpParams.add(new BasicNameValuePair(&quot;password&quot;, this.vaultConfig.getProductAdminPassword()));\r\n\r\n        try {\r\n            httpPost.setEntity(new UrlEncodedFormEntity(httpParams));\r\n            CloseableHttpResponse closeableHttpResponse = client.execute(httpPost);\r\n            HttpEntity entity = closeableHttpResponse.getEntity();\r\n            String tokenDataJson = EntityUtils.toString(entity, &quot;UTF-8&quot;);\r\n            String newAccessToken = new Gson().fromJson(tokenDataJson, Map.class).get(&quot;access_token&quot;).toString();\r\n            this.vaultConfig.setProductAccessToken(newAccessToken);\r\n        } catch (Exception e) {\r\n            logger.error(&quot;Unable to create access token: &quot; + e.getMessage());\r\n        }\r\n    }\r\n```\r\n\r\n```java\r\n\r\npublic class ProductServiceTest {\r\n\r\n    @InjectMocks\r\n    private ProductService productService;\r\n    @Mock\r\n    CloseableHttpClient closeableHttpClient;\r\n    @Mock\r\n    private VaultConfig vaultConfig;\r\n    @Mock\r\n    private AppConfig appConfig;\r\n    @Mock\r\n    CloseableHttpResponse closeableHttpResponse;\r\n    @Mock\r\n    HttpEntity entity\r\n\r\n    @BeforeEach\r\n    public void initialize() {\r\n        MockitoAnnotations.openMocks(this);\r\n    }\r\n\r\n\r\n   void getAccessTokenWhenEmpty() throws IOException {\r\n        //given\r\n        String expectedProductAccessToken = &quot;ABC&quot;;\r\n\r\n        //and:\r\n        given(appConfig.getProductServerUrl()).willReturn(&quot;https://test.abcd.com&quot;);\r\n        given(closeableHttpClient.execute(httpPost)).willReturn(closeableHttpResponse);\r\n        given(vaultConfig.getProductAccessToken()).willReturn(&quot;&quot;);\r\n\r\n        // my additional code\r\n        given(closeableHttpResponse.getEntity()).willReturn(entity);\r\n        given(entity.....).willReturn(....)   // mock the entity for the EntityUtils.toString(entity, &quot;UTF-8&quot;);\r\n\r\n        //when\r\n        String actualProductAccessToken = ProductService.getAccessToken();\r\n\r\n        //then\r\n        Assertions.assertEquals(actualProductAccessToken,expectedProductAccessToken);\r\n    }\r\n```\r\n ","title":"Mocking Apache Post HTTPClient using Mockito","body":"<p>The created mocks aren't used in the ProductService because they aren't passed in the construct. The class dependencies should be injected through the construct because they are mandatory.</p>\n<p>It would help if you changed the implementation like the following. The code is incomplete.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class ProductService {\n\n    private final VaultConfig vaultConfig;\n    private final AppConfig appConfig;\n    private final CloseableHttpClient client;\n\n    public ProductService(VaultConfig vaultConfig,\n                          @Autowired AppConfig appConfig, CloseableHttpClient client) {\n            this.vaultConfig = vaultConfig;\n            this.appConfig = appConfig;\n    }\n\n    private void createAccessToken() {\n        String httpUrl = MessageFormat.format(&quot;{0}/api/v1/authentication/login&quot;,\n            appConfig.getProductServerUrl());\n        HttpPost httpPost = new HttpPost(httpUrl);\n        List&lt;NameValuePair&gt; httpParams = new ArrayList&lt;NameValuePair&gt;();\n        httpParams.add(new BasicNameValuePair(&quot;username&quot;, this.vaultConfig.getProductAdminUsername()));\n        httpParams.add(new BasicNameValuePair(&quot;password&quot;, this.vaultConfig.getProductAdminPassword()));\n\n        try {\n            httpPost.setEntity(new UrlEncodedFormEntity(httpParams));\n            CloseableHttpResponse closeableHttpResponse = client.execute(httpPost);\n            HttpEntity entity = closeableHttpResponse.getEntity();\n            String tokenDataJson = EntityUtils.toString(entity, &quot;UTF-8&quot;);\n            String newAccessToken = new Gson().fromJson(tokenDataJson, Map.class).get(&quot;access_token&quot;).toString();\n            this.vaultConfig.setProductAccessToken(newAccessToken);\n        } catch (Exception e) {\n            logger.error(&quot;Unable to create access token: &quot; + e.getMessage());\n        }\n    }\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>\npublic class ProductServiceTest {\n\n    @InjectMocks\n    private ProductService productService;\n    @Mock\n    CloseableHttpClient closeableHttpClient;\n    @Mock\n    private VaultConfig vaultConfig;\n    @Mock\n    private AppConfig appConfig;\n    @Mock\n    CloseableHttpResponse closeableHttpResponse;\n    @Mock\n    HttpEntity entity\n\n    @BeforeEach\n    public void initialize() {\n        MockitoAnnotations.openMocks(this);\n    }\n\n\n   void getAccessTokenWhenEmpty() throws IOException {\n        //given\n        String expectedProductAccessToken = &quot;ABC&quot;;\n\n        //and:\n        given(appConfig.getProductServerUrl()).willReturn(&quot;https://test.abcd.com&quot;);\n        given(closeableHttpClient.execute(httpPost)).willReturn(closeableHttpResponse);\n        given(vaultConfig.getProductAccessToken()).willReturn(&quot;&quot;);\n\n        // my additional code\n        given(closeableHttpResponse.getEntity()).willReturn(entity);\n        given(entity.....).willReturn(....)   // mock the entity for the EntityUtils.toString(entity, &quot;UTF-8&quot;);\n\n        //when\n        String actualProductAccessToken = ProductService.getAccessToken();\n\n        //then\n        Assertions.assertEquals(actualProductAccessToken,expectedProductAccessToken);\n    }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4741976,"reputation":5385,"user_id":3834413,"display_name":"Eugene"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656023147,"creation_date":1656023147,"answer_id":72737203,"question_id":72649574,"body_markdown":"In case you do not want to change the implementation, and do not want to add the constructor or additional method for creation `CloseableHttpClient`. \r\n&lt;br&gt;You need to mock static method `HttpClients.createDefault()`!\r\n\r\n**Solution 1: [mock static method via Mockito][1]**\r\n&lt;br&gt;Mockito since 3.4.0 version support mocking static methods.\r\n```java\r\n        try (MockedStatic mocked = mockStatic(Foo.class)) {\r\n            mocked.when(Foo::method).thenReturn(&quot;bar&quot;);\r\n            assertEquals(&quot;bar&quot;, Foo.method());\r\n            mocked.verify(Foo::method);\r\n        }\r\n```\r\nFirst of all you need to add [mockito-inline][2] to your project\r\n```xml\r\n&lt;dependency&gt;\r\n    &lt;groupId&gt;org.mockito&lt;/groupId&gt;\r\n    &lt;artifactId&gt;mockito-inline&lt;/artifactId&gt;\r\n    &lt;version&gt;4.6.1&lt;/version&gt;\r\n    &lt;scope&gt;test&lt;/scope&gt;\r\n&lt;/dependency&gt;\r\n```\r\nImplementation:\r\n```java\r\npublic class ProductServiceTest {\r\n\r\n    private ProductService productService;\r\n\r\n    MockedStatic&lt;HttpClients&gt; httpClientsStaticMock;\r\n\r\n    @Mock\r\n    CloseableHttpClient closeableHttpClient;\r\n    @Mock\r\n    HttpPost httpPost;\r\n    @Mock\r\n    CloseableHttpResponse closeableHttpResponse;\r\n    @Mock\r\n    private VaultConfig vaultConfig;\r\n    @Mock\r\n    private AppConfig appConfig;\r\n\r\n    @BeforeEach\r\n    public void initialize() {\r\n        MockitoAnnotations.openMocks(this);\r\n        productService = new ProductService(vaultConfig, appConfig);\r\n        //create static Mock\r\n        httpClientsStaticMock = mockStatic(HttpClients.class);\r\n        //when HttpClients.createDefault() called return mock of CloseableHttpClient\r\n        httpClientsStaticMock.when(HttpClients::createDefault).thenReturn(closeableHttpClient);\r\n    }\r\n\r\n    void getAccessTokenWhenEmpty() throws IOException {\r\n        //given\r\n        String expectedProductAccessToken = &quot;ABC&quot;;\r\n\r\n        //and:\r\n        given(appConfig.getProductServerUrl()).willReturn(&quot;https://test.abcd.com&quot;);\r\n        given(closeableHttpClient.execute(httpPost)).willReturn(closeableHttpResponse);\r\n        given(vaultConfig.getProductAccessToken()).willReturn(&quot;&quot;);\r\n\r\n        //when\r\n        String actualProductAccessToken = ProductService.getAccessToken();\r\n\r\n        //then\r\n        Assertions.assertEquals(actualProductAccessToken, expectedProductAccessToken);\r\n    }\r\n\r\n    @AfterEach\r\n    public void afterTest() {\r\n        //close static Mock\r\n        httpClientsStaticMock.close();\r\n    }\r\n}\r\n```\r\n**Solution 2: [mock static methods via PowerMock][3]**\r\n&lt;br&gt;Dependencies:\r\n```xml\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.powermock&lt;/groupId&gt;\r\n            &lt;artifactId&gt;powermock-module-junit4&lt;/artifactId&gt;\r\n            &lt;version&gt;2.0.9&lt;/version&gt;\r\n            &lt;scope&gt;test&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.powermock&lt;/groupId&gt;\r\n            &lt;artifactId&gt;powermock-api-mockito2&lt;/artifactId&gt;\r\n            &lt;version&gt;2.0.9&lt;/version&gt;\r\n            &lt;scope&gt;test&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\n```\r\nImplementation:\r\n```java\r\n@RunWith(PowerMockRunner.class)\r\n@PrepareForTest({ ProductService.class, HttpClients.class})\r\npublic class ProductServiceTest {\r\n\r\n    private ProductService productService;\r\n\r\n    @Mock\r\n    CloseableHttpClient closeableHttpClient;\r\n    @Mock\r\n    HttpPost httpPost;\r\n    @Mock\r\n    CloseableHttpResponse closeableHttpResponse;\r\n    @Mock\r\n    private VaultConfig vaultConfig;\r\n    @Mock\r\n    private AppConfig appConfig;\r\n\r\n    @BeforeEach\r\n    public void initialize() {\r\n        MockitoAnnotations.openMocks(this);\r\n        productService = new ProductService(vaultConfig, appConfig);\r\n        //create static Mock\r\n        PowerMockito.mockStatic(HttpClients.class);\r\n        //when HttpClients.createDefault() called return mock of CloseableHttpClient\r\n        when(HttpClients.createDefault()).thenReturn(closeableHttpClient);\r\n    }\r\n\r\n    void getAccessTokenWhenEmpty() throws IOException {\r\n        //given\r\n        String expectedProductAccessToken = &quot;ABC&quot;;\r\n\r\n        //and:\r\n        given(appConfig.getProductServerUrl()).willReturn(&quot;https://test.abcd.com&quot;);\r\n        given(closeableHttpClient.execute(httpPost)).willReturn(closeableHttpResponse);\r\n        given(vaultConfig.getProductAccessToken()).willReturn(&quot;&quot;);\r\n\r\n        //when\r\n        String actualProductAccessToken = ProductService.getAccessToken();\r\n\r\n        //then\r\n        Assertions.assertEquals(actualProductAccessToken, expectedProductAccessToken);\r\n    }\r\n}\r\n```\r\n\r\n  [1]: https://javadoc.io/doc/org.mockito/mockito-core/latest/org/mockito/Mockito.html#static_mocks\r\n  [2]: https://mvnrepository.com/artifact/org.mockito/mockito-inline/4.6.1\r\n  [3]: https://github.com/powermock/powermock/wiki/MockStatic","title":"Mocking Apache Post HTTPClient using Mockito","body":"<p>In case you do not want to change the implementation, and do not want to add the constructor or additional method for creation <code>CloseableHttpClient</code>.\n<br>You need to mock static method <code>HttpClients.createDefault()</code>!</p>\n<p><strong>Solution 1: <a href=\"https://javadoc.io/doc/org.mockito/mockito-core/latest/org/mockito/Mockito.html#static_mocks\" rel=\"nofollow noreferrer\">mock static method via Mockito</a></strong>\n<br>Mockito since 3.4.0 version support mocking static methods.</p>\n<pre class=\"lang-java prettyprint-override\"><code>        try (MockedStatic mocked = mockStatic(Foo.class)) {\n            mocked.when(Foo::method).thenReturn(&quot;bar&quot;);\n            assertEquals(&quot;bar&quot;, Foo.method());\n            mocked.verify(Foo::method);\n        }\n</code></pre>\n<p>First of all you need to add <a href=\"https://mvnrepository.com/artifact/org.mockito/mockito-inline/4.6.1\" rel=\"nofollow noreferrer\">mockito-inline</a> to your project</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.mockito&lt;/groupId&gt;\n    &lt;artifactId&gt;mockito-inline&lt;/artifactId&gt;\n    &lt;version&gt;4.6.1&lt;/version&gt;\n    &lt;scope&gt;test&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>Implementation:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class ProductServiceTest {\n\n    private ProductService productService;\n\n    MockedStatic&lt;HttpClients&gt; httpClientsStaticMock;\n\n    @Mock\n    CloseableHttpClient closeableHttpClient;\n    @Mock\n    HttpPost httpPost;\n    @Mock\n    CloseableHttpResponse closeableHttpResponse;\n    @Mock\n    private VaultConfig vaultConfig;\n    @Mock\n    private AppConfig appConfig;\n\n    @BeforeEach\n    public void initialize() {\n        MockitoAnnotations.openMocks(this);\n        productService = new ProductService(vaultConfig, appConfig);\n        //create static Mock\n        httpClientsStaticMock = mockStatic(HttpClients.class);\n        //when HttpClients.createDefault() called return mock of CloseableHttpClient\n        httpClientsStaticMock.when(HttpClients::createDefault).thenReturn(closeableHttpClient);\n    }\n\n    void getAccessTokenWhenEmpty() throws IOException {\n        //given\n        String expectedProductAccessToken = &quot;ABC&quot;;\n\n        //and:\n        given(appConfig.getProductServerUrl()).willReturn(&quot;https://test.abcd.com&quot;);\n        given(closeableHttpClient.execute(httpPost)).willReturn(closeableHttpResponse);\n        given(vaultConfig.getProductAccessToken()).willReturn(&quot;&quot;);\n\n        //when\n        String actualProductAccessToken = ProductService.getAccessToken();\n\n        //then\n        Assertions.assertEquals(actualProductAccessToken, expectedProductAccessToken);\n    }\n\n    @AfterEach\n    public void afterTest() {\n        //close static Mock\n        httpClientsStaticMock.close();\n    }\n}\n</code></pre>\n<p><strong>Solution 2: <a href=\"https://github.com/powermock/powermock/wiki/MockStatic\" rel=\"nofollow noreferrer\">mock static methods via PowerMock</a></strong>\n<br>Dependencies:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>        &lt;dependency&gt;\n            &lt;groupId&gt;org.powermock&lt;/groupId&gt;\n            &lt;artifactId&gt;powermock-module-junit4&lt;/artifactId&gt;\n            &lt;version&gt;2.0.9&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.powermock&lt;/groupId&gt;\n            &lt;artifactId&gt;powermock-api-mockito2&lt;/artifactId&gt;\n            &lt;version&gt;2.0.9&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n</code></pre>\n<p>Implementation:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@RunWith(PowerMockRunner.class)\n@PrepareForTest({ ProductService.class, HttpClients.class})\npublic class ProductServiceTest {\n\n    private ProductService productService;\n\n    @Mock\n    CloseableHttpClient closeableHttpClient;\n    @Mock\n    HttpPost httpPost;\n    @Mock\n    CloseableHttpResponse closeableHttpResponse;\n    @Mock\n    private VaultConfig vaultConfig;\n    @Mock\n    private AppConfig appConfig;\n\n    @BeforeEach\n    public void initialize() {\n        MockitoAnnotations.openMocks(this);\n        productService = new ProductService(vaultConfig, appConfig);\n        //create static Mock\n        PowerMockito.mockStatic(HttpClients.class);\n        //when HttpClients.createDefault() called return mock of CloseableHttpClient\n        when(HttpClients.createDefault()).thenReturn(closeableHttpClient);\n    }\n\n    void getAccessTokenWhenEmpty() throws IOException {\n        //given\n        String expectedProductAccessToken = &quot;ABC&quot;;\n\n        //and:\n        given(appConfig.getProductServerUrl()).willReturn(&quot;https://test.abcd.com&quot;);\n        given(closeableHttpClient.execute(httpPost)).willReturn(closeableHttpResponse);\n        given(vaultConfig.getProductAccessToken()).willReturn(&quot;&quot;);\n\n        //when\n        String actualProductAccessToken = ProductService.getAccessToken();\n\n        //then\n        Assertions.assertEquals(actualProductAccessToken, expectedProductAccessToken);\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":12455565,"reputation":5317,"user_id":9068895,"display_name":"Alex"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656043301,"creation_date":1656043301,"answer_id":72738865,"question_id":72649574,"body_markdown":"I would propose a little bit different approach for testing http clients. Unit testing `HttpClient` has very low ROI and could be very tricky and error-prone. Even if you could cover some simple positive cases, it would be very hard to test more complex scenarios, like error handling, retries. Also your tests could depend on the internal implementation of the client that could change in the future.\r\nAlso, mocking static methods usually considered as an anti-pattern and should be avoided.\r\n\r\n\r\nI would recommend to look at [WireMock](https://wiremock.org/) which provides a very good API for testing web clients. Here are some examples\r\n\r\n\r\nBasically, you need to start Wiremock server and then point your `HttpClient` to this URL\r\n\r\n```\r\nWireMockServer wireMockServer = new WireMockServer(wireMockConfig().dynamicPort());\r\nwireMockServer.start();\r\nWireMock.configureFor(wireMockServer.port());\r\n\r\nvar baseUrl = &quot;http://localhost:&quot; + wireMockServer.port();\r\n\r\ngiven(appConfig.getProductServerUrl()).willReturn(baseUrl);\r\n```\r\n\r\nAfter that you could define server stubs (responses), send real requests from your `HttpClient` and then validate responses\r\n```\r\nstubFor(get(&quot;/api&quot;)\r\n        .willReturn(aResponse()\r\n                .withHeader(&quot;Content-Type&quot;, MediaType.APPLICATION_JSON_VALUE)\r\n                .withStatus(200)\r\n                .withBody(...)\r\n        )\r\n);\r\n```\r\n\r\nYou could easily test both positive and negative scenarios by providing different stubs\r\n```\r\nstubFor(get(&quot;/api&quot;)\r\n        .willReturn(aResponse()\r\n                .withHeader(&quot;Content-Type&quot;, MediaType.APPLICATION_JSON_VALUE)\r\n                .withStatus(500)\r\n        )\r\n);\r\n```\r\n\r\nAlso, you could test retry logic using [Scenarios](https://wiremock.org/docs/stateful-behaviour/) or even simulate timeouts using [Delays](https://wiremock.org/docs/simulating-faults/).\r\n\r\n ","title":"Mocking Apache Post HTTPClient using Mockito","body":"<p>I would propose a little bit different approach for testing http clients. Unit testing <code>HttpClient</code> has very low ROI and could be very tricky and error-prone. Even if you could cover some simple positive cases, it would be very hard to test more complex scenarios, like error handling, retries. Also your tests could depend on the internal implementation of the client that could change in the future.\nAlso, mocking static methods usually considered as an anti-pattern and should be avoided.</p>\n<p>I would recommend to look at <a href=\"https://wiremock.org/\" rel=\"nofollow noreferrer\">WireMock</a> which provides a very good API for testing web clients. Here are some examples</p>\n<p>Basically, you need to start Wiremock server and then point your <code>HttpClient</code> to this URL</p>\n<pre><code>WireMockServer wireMockServer = new WireMockServer(wireMockConfig().dynamicPort());\nwireMockServer.start();\nWireMock.configureFor(wireMockServer.port());\n\nvar baseUrl = &quot;http://localhost:&quot; + wireMockServer.port();\n\ngiven(appConfig.getProductServerUrl()).willReturn(baseUrl);\n</code></pre>\n<p>After that you could define server stubs (responses), send real requests from your <code>HttpClient</code> and then validate responses</p>\n<pre><code>stubFor(get(&quot;/api&quot;)\n        .willReturn(aResponse()\n                .withHeader(&quot;Content-Type&quot;, MediaType.APPLICATION_JSON_VALUE)\n                .withStatus(200)\n                .withBody(...)\n        )\n);\n</code></pre>\n<p>You could easily test both positive and negative scenarios by providing different stubs</p>\n<pre><code>stubFor(get(&quot;/api&quot;)\n        .willReturn(aResponse()\n                .withHeader(&quot;Content-Type&quot;, MediaType.APPLICATION_JSON_VALUE)\n                .withStatus(500)\n        )\n);\n</code></pre>\n<p>Also, you could test retry logic using <a href=\"https://wiremock.org/docs/stateful-behaviour/\" rel=\"nofollow noreferrer\">Scenarios</a> or even simulate timeouts using <a href=\"https://wiremock.org/docs/simulating-faults/\" rel=\"nofollow noreferrer\">Delays</a>.</p>\n"},{"tags":[],"owner":{"account_id":136251,"reputation":87506,"user_id":339637,"accept_rate":55,"display_name":"Ken Chan"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1656346229,"creation_date":1656150648,"answer_id":72752857,"question_id":72649574,"body_markdown":"A easier, cleaner and less fragile approach is don&#39;t mock the `HttpClient`. It just causes your test codes to have the pattern &quot;mock return mock and the returned mock return anther mock which in turn return another mock which return ......&quot; which looks very ugly and is a code smell to me.\r\n\r\nInstead , use a real `HTTPClient` instance and mock the external API using tools likes [WireMock][1] or [MockWebServer][2] \r\n\r\nMy favourite is MockWebServer which you can do something likes: \r\n\r\n``` java\r\npublic class ProductServiceTest {\r\n\t\r\n\t\r\n\tprivate ProductService productService;\r\n\r\n\t@Mock\r\n    private AppConfig appConfig;\r\n\r\n    private MockWebServer server;\r\n\r\n    @Test\r\n    public void getAccessTokenWhenEmpty(){\r\n\r\n\r\n\t    server.start();\r\n\t    HttpUrl baseUrl = server.url(&quot;/api/v1/authentication/login&quot;);\r\n\r\n\t    given(appConfig.getProductServerUrl()).willReturn(&quot;http://&quot; + baseUrl.host() +&quot;:&quot; + baseUrl.port());\r\n        productService = new ProductService(vaultConfig, appConfig);\r\n   \t\t\r\n   \t\t//stub the server to return the access token response\r\n        server.enqueue(new MockResponse().setBody(&quot;{\\&quot;access_token\\&quot;:\\&quot;ABC\\&quot;}&quot;));\r\n\r\n       //continues execute your test\r\n\r\n    }\r\n\r\n\r\n}\r\n```\r\n\r\n\r\n  [1]: https://github.com/wiremock/wiremock\r\n  [2]: https://github.com/square/okhttp/tree/master/mockwebserver","title":"Mocking Apache Post HTTPClient using Mockito","body":"<p>A easier, cleaner and less fragile approach is don't mock the <code>HttpClient</code>. It just causes your test codes to have the pattern &quot;mock return mock and the returned mock return anther mock which in turn return another mock which return ......&quot; which looks very ugly and is a code smell to me.</p>\n<p>Instead , use a real <code>HTTPClient</code> instance and mock the external API using tools likes <a href=\"https://github.com/wiremock/wiremock\" rel=\"nofollow noreferrer\">WireMock</a> or <a href=\"https://github.com/square/okhttp/tree/master/mockwebserver\" rel=\"nofollow noreferrer\">MockWebServer</a></p>\n<p>My favourite is MockWebServer which you can do something likes:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class ProductServiceTest {\n    \n    \n    private ProductService productService;\n\n    @Mock\n    private AppConfig appConfig;\n\n    private MockWebServer server;\n\n    @Test\n    public void getAccessTokenWhenEmpty(){\n\n\n        server.start();\n        HttpUrl baseUrl = server.url(&quot;/api/v1/authentication/login&quot;);\n\n        given(appConfig.getProductServerUrl()).willReturn(&quot;http://&quot; + baseUrl.host() +&quot;:&quot; + baseUrl.port());\n        productService = new ProductService(vaultConfig, appConfig);\n        \n        //stub the server to return the access token response\n        server.enqueue(new MockResponse().setBody(&quot;{\\&quot;access_token\\&quot;:\\&quot;ABC\\&quot;}&quot;));\n\n       //continues execute your test\n\n    }\n\n\n}\n</code></pre>\n"}],"owner":{"account_id":21004999,"reputation":788,"user_id":15435022,"display_name":"mattsmith5"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1474,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":72752857,"answer_count":4,"score":1,"last_activity_date":1656346229,"creation_date":1655399563,"question_id":72649574,"body_markdown":"I am trying to test HttpClient using Mockito and this article. I am receiving the error below, and not sure how to fix. The error is below. I am following the contents of article very similarly. Its failing on `CloseableHttpResponse closeableHttpResponse = client.execute(httpPost)`\r\n, when I already mocked it.\r\n\r\nResource: https://stackoverflow.com/questions/20542361/mocking-apache-httpclient-using-mockito\r\n\r\n**Main Code:**\r\n\r\n    public class ProductService {\r\n    \r\n        private final VaultConfig vaultConfig;\r\n        private final AppConfig appConfig;\r\n    \r\n        public ProductService(VaultConfig vaultConfig,\r\n                              @Autowired AppConfig appConfig) {\r\n                this.vaultConfig = vaultConfig;\r\n                this.appConfig = appConfig;\r\n        }\r\n    \r\n        private void createAccessToken() {\r\n            String httpUrl = MessageFormat.format(&quot;{0}/api/v1/authentication/login&quot;,\r\n                appConfig.getProductServerUrl());\r\n            CloseableHttpClient client = HttpClients.createDefault();\r\n            HttpPost httpPost = new HttpPost(httpUrl);\r\n            List&lt;NameValuePair&gt; httpParams = new ArrayList&lt;NameValuePair&gt;();\r\n            httpParams.add(new BasicNameValuePair(&quot;username&quot;, this.vaultConfig.getProductAdminUsername()));\r\n            httpParams.add(new BasicNameValuePair(&quot;password&quot;, this.vaultConfig.getProductAdminPassword()));\r\n\r\n            try {\r\n                httpPost.setEntity(new UrlEncodedFormEntity(httpParams));\r\n                CloseableHttpResponse closeableHttpResponse = client.execute(httpPost);\r\n                HttpEntity entity = closeableHttpResponse.getEntity();\r\n                String tokenDataJson = EntityUtils.toString(entity, &quot;UTF-8&quot;);\r\n                String newAccessToken = new Gson().fromJson(tokenDataJson, Map.class).get(&quot;access_token&quot;).toString();\r\n                this.vaultConfig.setProductAccessToken(newAccessToken);\r\n            } catch (Exception e) {\r\n                logger.error(&quot;Unable to create access token: &quot; + e.getMessage());\r\n            }\r\n        }\r\n\r\n\r\n**Test Attempt:**\r\n\r\n    public class ProductServiceTest {\r\n    \r\n        private ProductService productService;\r\n        @Mock\r\n        HttpClients httpClients;\r\n        @Mock\r\n        CloseableHttpClient closeableHttpClient;\r\n        @Mock\r\n        HttpPost httpPost;\r\n        @Mock\r\n        CloseableHttpResponse closeableHttpResponse;\r\n        @Mock\r\n        private VaultConfig vaultConfig;\r\n        @Mock\r\n        private AppConfig appConfig;\r\n    \r\n        @BeforeEach\r\n        public void initialize() {\r\n            MockitoAnnotations.openMocks(this);\r\n            productService = new ProductService(vaultConfig, appConfig);\r\n        }\r\n    \r\n    \r\n       void getAccessTokenWhenEmpty() throws IOException {\r\n            //given\r\n            String expectedProductAccessToken = &quot;ABC&quot;;\r\n    \r\n            //and:\r\n            given(appConfig.getProductServerUrl()).willReturn(&quot;https://test.abcd.com&quot;);\r\n            given(closeableHttpClient.execute(httpPost)).willReturn(closeableHttpResponse);\r\n            given(vaultConfig.getProductAccessToken()).willReturn(&quot;&quot;);\r\n    \r\n            //when\r\n            String actualProductAccessToken = ProductService.getAccessToken();\r\n    \r\n            //then\r\n            Assertions.assertEquals(actualProductAccessToken,expectedProductAccessToken);\r\n        }\r\n\r\n**Error:** \r\n\r\n\r\n        } catch (Exception e) {\r\n\r\n    java.net.UnknownHostException: test.abcd.com: unknown error","title":"Mocking Apache Post HTTPClient using Mockito","body":"<p>I am trying to test HttpClient using Mockito and this article. I am receiving the error below, and not sure how to fix. The error is below. I am following the contents of article very similarly. Its failing on <code>CloseableHttpResponse closeableHttpResponse = client.execute(httpPost)</code>\n, when I already mocked it.</p>\n<p>Resource: <a href=\"https://stackoverflow.com/questions/20542361/mocking-apache-httpclient-using-mockito\">Mocking Apache HTTPClient using Mockito</a></p>\n<p><strong>Main Code:</strong></p>\n<pre><code>public class ProductService {\n\n    private final VaultConfig vaultConfig;\n    private final AppConfig appConfig;\n\n    public ProductService(VaultConfig vaultConfig,\n                          @Autowired AppConfig appConfig) {\n            this.vaultConfig = vaultConfig;\n            this.appConfig = appConfig;\n    }\n\n    private void createAccessToken() {\n        String httpUrl = MessageFormat.format(&quot;{0}/api/v1/authentication/login&quot;,\n            appConfig.getProductServerUrl());\n        CloseableHttpClient client = HttpClients.createDefault();\n        HttpPost httpPost = new HttpPost(httpUrl);\n        List&lt;NameValuePair&gt; httpParams = new ArrayList&lt;NameValuePair&gt;();\n        httpParams.add(new BasicNameValuePair(&quot;username&quot;, this.vaultConfig.getProductAdminUsername()));\n        httpParams.add(new BasicNameValuePair(&quot;password&quot;, this.vaultConfig.getProductAdminPassword()));\n\n        try {\n            httpPost.setEntity(new UrlEncodedFormEntity(httpParams));\n            CloseableHttpResponse closeableHttpResponse = client.execute(httpPost);\n            HttpEntity entity = closeableHttpResponse.getEntity();\n            String tokenDataJson = EntityUtils.toString(entity, &quot;UTF-8&quot;);\n            String newAccessToken = new Gson().fromJson(tokenDataJson, Map.class).get(&quot;access_token&quot;).toString();\n            this.vaultConfig.setProductAccessToken(newAccessToken);\n        } catch (Exception e) {\n            logger.error(&quot;Unable to create access token: &quot; + e.getMessage());\n        }\n    }\n</code></pre>\n<p><strong>Test Attempt:</strong></p>\n<pre><code>public class ProductServiceTest {\n\n    private ProductService productService;\n    @Mock\n    HttpClients httpClients;\n    @Mock\n    CloseableHttpClient closeableHttpClient;\n    @Mock\n    HttpPost httpPost;\n    @Mock\n    CloseableHttpResponse closeableHttpResponse;\n    @Mock\n    private VaultConfig vaultConfig;\n    @Mock\n    private AppConfig appConfig;\n\n    @BeforeEach\n    public void initialize() {\n        MockitoAnnotations.openMocks(this);\n        productService = new ProductService(vaultConfig, appConfig);\n    }\n\n\n   void getAccessTokenWhenEmpty() throws IOException {\n        //given\n        String expectedProductAccessToken = &quot;ABC&quot;;\n\n        //and:\n        given(appConfig.getProductServerUrl()).willReturn(&quot;https://test.abcd.com&quot;);\n        given(closeableHttpClient.execute(httpPost)).willReturn(closeableHttpResponse);\n        given(vaultConfig.getProductAccessToken()).willReturn(&quot;&quot;);\n\n        //when\n        String actualProductAccessToken = ProductService.getAccessToken();\n\n        //then\n        Assertions.assertEquals(actualProductAccessToken,expectedProductAccessToken);\n    }\n</code></pre>\n<p><strong>Error:</strong></p>\n<pre><code>    } catch (Exception e) {\n\njava.net.UnknownHostException: test.abcd.com: unknown error\n</code></pre>\n"},{"tags":["java","inheritance","subclass"],"answers":[{"tags":[],"owner":{"account_id":13804005,"reputation":657,"user_id":9963355,"display_name":"xxMrPHDxx"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1656345271,"creation_date":1656343736,"answer_id":72774667,"question_id":72774587,"body_markdown":"You should take a look at [Java Generics](https://docs.oracle.com/javase/tutorial/java/generics/).\r\n\r\nAlso, you no longer need to define MySubClass unless you wanna add extra methods or properties to it.\r\n```java\r\nclass MyClass&lt;T extends MyAttribute&gt; {\r\n  T myAttribute;\r\n  MyClass(T myAttribute) {\r\n    this.myAttribute = myAttribute;\r\n  }\r\n\r\n  T getMyAttribute() {\r\n    return myAttribute;\r\n  }\r\n}\r\n\r\n\r\nclass MyAttribute {\r\n  void doSomething() {\r\n    System.out.println(&quot;Doing something...&quot;);\r\n  }\r\n}\r\n\r\nclass MySubAttribute extends MyAttribute {\r\n  void doSomethingElse() {\r\n    System.out.println(&quot;Doing something else...&quot;);\r\n  }\r\n}\r\n\r\n// You would instantiate `mySubClass` as follows\r\nMyClass&lt;MySubAttribute&gt; mySubClass = new MyClass&lt;&gt;(new MySubAttribute());\r\nmySubClass.getMyAttribute().doSomethingElse();\r\n```","title":"java - class attribute type change with inheritance","body":"<p>You should take a look at <a href=\"https://docs.oracle.com/javase/tutorial/java/generics/\" rel=\"nofollow noreferrer\">Java Generics</a>.</p>\n<p>Also, you no longer need to define MySubClass unless you wanna add extra methods or properties to it.</p>\n<pre class=\"lang-java prettyprint-override\"><code>class MyClass&lt;T extends MyAttribute&gt; {\n  T myAttribute;\n  MyClass(T myAttribute) {\n    this.myAttribute = myAttribute;\n  }\n\n  T getMyAttribute() {\n    return myAttribute;\n  }\n}\n\n\nclass MyAttribute {\n  void doSomething() {\n    System.out.println(&quot;Doing something...&quot;);\n  }\n}\n\nclass MySubAttribute extends MyAttribute {\n  void doSomethingElse() {\n    System.out.println(&quot;Doing something else...&quot;);\n  }\n}\n\n// You would instantiate `mySubClass` as follows\nMyClass&lt;MySubAttribute&gt; mySubClass = new MyClass&lt;&gt;(new MySubAttribute());\nmySubClass.getMyAttribute().doSomethingElse();\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4327054,"reputation":26992,"user_id":3533584,"display_name":"Jeff Scott Brown"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656343889,"creation_date":1656343889,"answer_id":72774701,"question_id":72774587,"body_markdown":"You could add something like this to `MySubClass`:\r\n\r\n    @Override\r\n    MySubAttribute getMyAttribute() {\r\n        return new MySubAttribute();\r\n    }\r\n","title":"java - class attribute type change with inheritance","body":"<p>You could add something like this to <code>MySubClass</code>:</p>\n<pre><code>@Override\nMySubAttribute getMyAttribute() {\n    return new MySubAttribute();\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":61566,"reputation":68924,"user_id":183406,"accept_rate":74,"display_name":"meriton"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656345584,"creation_date":1656345584,"answer_id":72775076,"question_id":72774587,"body_markdown":"The usual solution is generics:\r\n\r\n```\r\nclass MyClass&lt;A extends MyAttribute&gt; {\r\n    A myAttribute;\r\n    MyClass(A myAttribute) {\r\n        this.myAttribute = myAttribute;\r\n    }\r\n\r\n    A getMyAttribute() {\r\n        return myAttribute;\r\n    }\r\n}\r\n\r\nclass MySubClass extends MyClass&lt;MySubAttribute&gt; {\r\n```\r\n\r\nAlternatively, you could have MySubClass override the getter with a narrower return type:\r\n\r\n```\r\n    @Override\r\n    MySubAttribute getMyAttribute() {\r\n        // we know the cast succeeds because we have set a MySubAttribute in the constructor\r\n        return (MySubAttribute) myAttribute; \r\n    }\r\n```\r\n\r\nThe generic solution offers better compile time checking of the implementing class, and allows a caller to refer to the type of the attribute even if they don&#39;t know the subtype of `MyClass` by writing `MyClass&lt;MySubAttribute&gt;`. On the other hand, the generic solution does require callers to write a type parameter (even if just `MyClass&lt;?&gt;`), so calling code gets slightly more verbose.","title":"java - class attribute type change with inheritance","body":"<p>The usual solution is generics:</p>\n<pre><code>class MyClass&lt;A extends MyAttribute&gt; {\n    A myAttribute;\n    MyClass(A myAttribute) {\n        this.myAttribute = myAttribute;\n    }\n\n    A getMyAttribute() {\n        return myAttribute;\n    }\n}\n\nclass MySubClass extends MyClass&lt;MySubAttribute&gt; {\n</code></pre>\n<p>Alternatively, you could have MySubClass override the getter with a narrower return type:</p>\n<pre><code>    @Override\n    MySubAttribute getMyAttribute() {\n        // we know the cast succeeds because we have set a MySubAttribute in the constructor\n        return (MySubAttribute) myAttribute; \n    }\n</code></pre>\n<p>The generic solution offers better compile time checking of the implementing class, and allows a caller to refer to the type of the attribute even if they don't know the subtype of <code>MyClass</code> by writing <code>MyClass&lt;MySubAttribute&gt;</code>. On the other hand, the generic solution does require callers to write a type parameter (even if just <code>MyClass&lt;?&gt;</code>), so calling code gets slightly more verbose.</p>\n"},{"tags":[],"owner":{"account_id":1100252,"reputation":10087,"user_id":1092818,"display_name":"crizzis"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1656345604,"creation_date":1656345604,"answer_id":72775084,"question_id":72774587,"body_markdown":"If I understand correctly, then you&#39;re asking for: \r\n\r\n```\r\npublic interface HasMyAttribute {\r\n    MyAttribute getMyAttribute();\r\n}\r\n\r\npublic class MyClass implements HasMyAttribute {\r\n    private MyAttribute myAttribute;\r\n\r\n    public MyClass(MyAttribute myAttribute) {\r\n        this.myAttribute = myAttribute;\r\n    }\r\n\r\n    @Override\r\n    public MyAttribute getMyAttribute() {\r\n        return this.myAttribute;\r\n    }\r\n}\r\n\r\npublic class MySubClass extends MyClass implements HasMyAttribute {\r\n\r\n    private MySubAttribute mySubAttribute;\r\n\r\n    public MySubClass(MySubAttribute mySubAttribute) {\r\n        super(mySubAttribute);\r\n        this.mySubAttribute = mySubAttribute;\r\n    }\r\n\r\n    @Override\r\n    public MySubAttribute getMyAttribute() {\r\n        return mySubAttribute;\r\n    }\r\n}\r\n\r\n```\r\n\r\n(though, if you don&#39;t need two distinct concrete classes, @xxMrPHDxx&#39;s answer is much better)","title":"java - class attribute type change with inheritance","body":"<p>If I understand correctly, then you're asking for:</p>\n<pre><code>public interface HasMyAttribute {\n    MyAttribute getMyAttribute();\n}\n\npublic class MyClass implements HasMyAttribute {\n    private MyAttribute myAttribute;\n\n    public MyClass(MyAttribute myAttribute) {\n        this.myAttribute = myAttribute;\n    }\n\n    @Override\n    public MyAttribute getMyAttribute() {\n        return this.myAttribute;\n    }\n}\n\npublic class MySubClass extends MyClass implements HasMyAttribute {\n\n    private MySubAttribute mySubAttribute;\n\n    public MySubClass(MySubAttribute mySubAttribute) {\n        super(mySubAttribute);\n        this.mySubAttribute = mySubAttribute;\n    }\n\n    @Override\n    public MySubAttribute getMyAttribute() {\n        return mySubAttribute;\n    }\n}\n\n</code></pre>\n<p>(though, if you don't need two distinct concrete classes, @xxMrPHDxx's answer is much better)</p>\n"}],"owner":{"account_id":20955267,"reputation":63,"user_id":15395946,"display_name":"emerick biron"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":523,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":72774667,"answer_count":4,"score":0,"last_activity_date":1656345604,"creation_date":1656343379,"question_id":72774587,"body_markdown":"I have a MyClass which has an attribute of type MyAttribute.\r\nThis class is inherited by MySubClass which has an attribute of type MySubAttribute.\r\nMySubAttribute is a subclass of  MyAttribute : \r\n```java\r\nclass MyClass {\r\n    MyAttribute myAttribute;\r\n    MyClass(MyAttribute myAttribute) {\r\n        this.myAttribute = myAttribute;\r\n    }\r\n\r\n    MyAttribute getMyAttribute() {\r\n        return myAttribute;\r\n    }\r\n}\r\n\r\nclass MySubClass extends MyClass {\r\n    MySubClass(MySubAttribute mySubAttribute) {\r\n        super(mySubAttribute);\r\n    }\r\n}\r\n\r\n\r\nclass MyAttribute {\r\n    void doSomething() {\r\n    }\r\n}\r\n\r\nclass MySubAttribute extends MyAttribute {\r\n    @Override\r\n    void doSomething() {\r\n        super.doSomething();\r\n    }\r\n    void doSomethingElse() {\r\n    }\r\n}\r\n```\r\n\r\nNow imagine that I have the following code:\r\n\r\n    mySubClass.getMyAttribute();\r\n\r\nHow to make the returned value of type MySubAttribute?","title":"java - class attribute type change with inheritance","body":"<p>I have a MyClass which has an attribute of type MyAttribute.\nThis class is inherited by MySubClass which has an attribute of type MySubAttribute.\nMySubAttribute is a subclass of  MyAttribute :</p>\n<pre class=\"lang-java prettyprint-override\"><code>class MyClass {\n    MyAttribute myAttribute;\n    MyClass(MyAttribute myAttribute) {\n        this.myAttribute = myAttribute;\n    }\n\n    MyAttribute getMyAttribute() {\n        return myAttribute;\n    }\n}\n\nclass MySubClass extends MyClass {\n    MySubClass(MySubAttribute mySubAttribute) {\n        super(mySubAttribute);\n    }\n}\n\n\nclass MyAttribute {\n    void doSomething() {\n    }\n}\n\nclass MySubAttribute extends MyAttribute {\n    @Override\n    void doSomething() {\n        super.doSomething();\n    }\n    void doSomethingElse() {\n    }\n}\n</code></pre>\n<p>Now imagine that I have the following code:</p>\n<pre><code>mySubClass.getMyAttribute();\n</code></pre>\n<p>How to make the returned value of type MySubAttribute?</p>\n"},{"tags":["java","nullpointerexception","apache-poi"],"answers":[{"tags":[],"owner":{"account_id":461470,"reputation":2375,"user_id":863180,"accept_rate":34,"display_name":"cremersstijn"},"down_vote_count":1,"up_vote_count":23,"is_accepted":true,"score":22,"last_activity_date":1585748979,"creation_date":1359018347,"answer_id":14497475,"question_id":14497082,"body_markdown":"You need to make sure every cell has a value.\r\n\r\nWe use the following code to set a string value to a cell:\r\n\r\n    Cell c = row.createCell(i);\r\n    c.setCellValue(text == null ? &quot;&quot; : text );\r\n\r\n** Cell should never be null values else it throws NullPointerException. Hence set the value as shown above.\r\n\r\nThanks a lot, this helped!!","title":"AutosizeColumns on SXSSFWorkbook","body":"<p>You need to make sure every cell has a value.</p>\n\n<p>We use the following code to set a string value to a cell:</p>\n\n<pre><code>Cell c = row.createCell(i);\nc.setCellValue(text == null ? \"\" : text );\n</code></pre>\n\n<p>** Cell should never be null values else it throws NullPointerException. Hence set the value as shown above.</p>\n\n<p>Thanks a lot, this helped!!</p>\n"},{"tags":[],"owner":{"account_id":9177643,"reputation":99,"user_id":6822729,"display_name":"Virendra khade"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1571391014,"creation_date":1571391014,"answer_id":58447964,"question_id":14497082,"body_markdown":"Use **sheet.isColumnTrackedForAutoSizing(0);**\r\n for first and subsequently used for other column, i have faced exception whenever code executed autoSizeColumn(0) get executed. by using above code i have resolved the issue and it&#39;s good to expand the column width too based on the text.","title":"AutosizeColumns on SXSSFWorkbook","body":"<p>Use <strong>sheet.isColumnTrackedForAutoSizing(0);</strong>\n for first and subsequently used for other column, i have faced exception whenever code executed autoSizeColumn(0) get executed. by using above code i have resolved the issue and it's good to expand the column width too based on the text.</p>\n"},{"tags":[],"owner":{"account_id":18127684,"reputation":1,"user_id":13183081,"display_name":"Srini Yedire"},"down_vote_count":2,"up_vote_count":0,"is_accepted":false,"score":-2,"last_activity_date":1585748865,"creation_date":1585741562,"answer_id":60970127,"question_id":14497082,"body_markdown":"**Error: NullPointerException** on `org.apache.poi.ss.util.SheetUtil.getCellWidth(SheetUtil.java:122)`\r\n\r\nFix: Always set value to Cell as shown below, it throws NullPointerException when there is null in Cell, so set the value as:\r\n\r\n    Cell c = row.createCell(i);\r\n    c.setCellValue(text == null ? &quot;&quot; : text );","title":"AutosizeColumns on SXSSFWorkbook","body":"<p><strong>Error: NullPointerException</strong> on <code>org.apache.poi.ss.util.SheetUtil.getCellWidth(SheetUtil.java:122)</code></p>\n\n<p>Fix: Always set value to Cell as shown below, it throws NullPointerException when there is null in Cell, so set the value as:</p>\n\n<pre><code>Cell c = row.createCell(i);\nc.setCellValue(text == null ? \"\" : text );\n</code></pre>\n"},{"tags":[],"owner":{"account_id":7141983,"reputation":261,"user_id":5459233,"display_name":"Lof"},"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1653572294,"creation_date":1653572294,"answer_id":72392754,"question_id":14497082,"body_markdown":"sheet.trackAllColumnsForAutoSizing();","title":"AutosizeColumns on SXSSFWorkbook","body":"<p>sheet.trackAllColumnsForAutoSizing();</p>\n"},{"tags":[],"owner":{"account_id":15904122,"reputation":11,"user_id":11475794,"display_name":"Ravi Chhetri"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656345510,"creation_date":1656345510,"answer_id":72775051,"question_id":14497082,"body_markdown":"sheet.trackAllColumnsForAutoSizing(), this works but it is truly not a good approach. Because if you are working with lakhs of data, it delays the process of writing to file by huge margin\r\n","title":"AutosizeColumns on SXSSFWorkbook","body":"<p>sheet.trackAllColumnsForAutoSizing(), this works but it is truly not a good approach. Because if you are working with lakhs of data, it delays the process of writing to file by huge margin</p>\n"}],"owner":{"account_id":307873,"reputation":543,"user_id":619419,"display_name":"sterym"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":38329,"favorite_count":0,"down_vote_count":0,"up_vote_count":24,"accepted_answer_id":14497475,"answer_count":5,"score":24,"last_activity_date":1656345510,"creation_date":1359016944,"question_id":14497082,"body_markdown":"Is it possible to autoSizeColumns on a streaming SXSSFWorkbook?\r\nI implemented an export functionality to export a list of objects to excel. At first I used the XSSFWorkbook (not streaming) and after all the cells were created, I autosized all the columns, resulting in a nice excel file.\r\n\r\nFor performance issues we wanted to change the workbook to the streaming version, but this resulted in a NullPointer at org.apache.poi.ss.util.SheetUtil.getCellWidth.\r\n\r\nIs it possible to call autoSizeColumns for a SXSSFWorkbook?\r\n\r\nIm using poi-ooxml 3.9, but I have the same issue in 3.8.","title":"AutosizeColumns on SXSSFWorkbook","body":"<p>Is it possible to autoSizeColumns on a streaming SXSSFWorkbook?\nI implemented an export functionality to export a list of objects to excel. At first I used the XSSFWorkbook (not streaming) and after all the cells were created, I autosized all the columns, resulting in a nice excel file.</p>\n\n<p>For performance issues we wanted to change the workbook to the streaming version, but this resulted in a NullPointer at org.apache.poi.ss.util.SheetUtil.getCellWidth.</p>\n\n<p>Is it possible to call autoSizeColumns for a SXSSFWorkbook?</p>\n\n<p>Im using poi-ooxml 3.9, but I have the same issue in 3.8.</p>\n"},{"tags":["java","recursion"],"comments":[{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":1,"creation_date":1656342493,"post_id":72774357,"comment_id":128542511,"body_markdown":"What output were you expecting (and why) and what are you getting instead?","body":"What output were you expecting (and why) and what are you getting instead?"},{"owner":{"account_id":7821678,"reputation":2208,"user_id":5914654,"display_name":"vincrichaud"},"score":0,"creation_date":1656342766,"post_id":72774357,"comment_id":128542636,"body_markdown":"This looks like it will run forever and never exit. Since in your example `part(6, 4)` will go to the else-block and call `part(6, 4)` and so on","body":"This looks like it will run forever and never exit. Since in your example <code>part(6, 4)</code> will go to the else-block and call <code>part(6, 4)</code> and so on"},{"owner":{"account_id":24395089,"reputation":29,"user_id":18324544,"display_name":"Nuva_rad"},"score":0,"creation_date":1656342820,"post_id":72774357,"comment_id":128542660,"body_markdown":"im getting a stack trace but im ment to get 9 partitions","body":"im getting a stack trace but im ment to get 9 partitions"},{"owner":{"account_id":2562742,"reputation":5917,"user_id":2851311,"display_name":"hfontanez"},"score":1,"creation_date":1656343198,"post_id":72774357,"comment_id":128542818,"body_markdown":"You don&#39;t need a base case. You already have two base cases. What you need (apparently) is a way to to reduce _m_ and/or _n_ down to zero to escape the recursive calls.","body":"You don&#39;t need a base case. You already have two base cases. What you need (apparently) is a way to to reduce <i>m</i> and/or <i>n</i> down to zero to escape the recursive calls."},{"owner":{"account_id":24395089,"reputation":29,"user_id":18324544,"display_name":"Nuva_rad"},"score":0,"creation_date":1656343467,"post_id":72774357,"comment_id":128542939,"body_markdown":"like a  m-- n-- at bottom","body":"like a  m-- n-- at bottom"},{"owner":{"account_id":7821678,"reputation":2208,"user_id":5914654,"display_name":"vincrichaud"},"score":0,"creation_date":1656343611,"post_id":72774357,"comment_id":128543005,"body_markdown":"Isn&#39;t the math rule behind that `part(n, m) = part(n-1, m) + part(n-1, m-1)` ?","body":"Isn&#39;t the math rule behind that <code>part(n, m) = part(n-1, m) + part(n-1, m-1)</code> ?"},{"owner":{"account_id":2562742,"reputation":5917,"user_id":2851311,"display_name":"hfontanez"},"score":0,"creation_date":1656343722,"post_id":72774357,"comment_id":128543048,"body_markdown":"@vincrichaud `m-1` and `n-1` won&#39;t do it because the result will not be stored back in the variables. You need `m--` and `n--`.","body":"@vincrichaud <code>m-1</code> and <code>n-1</code> won&#39;t do it because the result will not be stored back in the variables. You need <code>m--</code> and <code>n--</code>."},{"owner":{"account_id":7821678,"reputation":2208,"user_id":5914654,"display_name":"vincrichaud"},"score":1,"creation_date":1656343811,"post_id":72774357,"comment_id":128543085,"body_markdown":"@hfontanez no need to store it there, it won&#39;t get re-used","body":"@hfontanez no need to store it there, it won&#39;t get re-used"},{"owner":{"account_id":2562742,"reputation":5917,"user_id":2851311,"display_name":"hfontanez"},"score":0,"creation_date":1656344467,"post_id":72774357,"comment_id":128543311,"body_markdown":"@Nuva_rad I answered your question. As you indicated, the function returns 9. You need to test with other values to make sure the solution is indeed correct and not just working by chance. I will appreciate if you upvote and select my answer.","body":"@Nuva_rad I answered your question. As you indicated, the function returns 9. You need to test with other values to make sure the solution is indeed correct and not just working by chance. I will appreciate if you upvote and select my answer."}],"answers":[{"tags":[],"owner":{"account_id":2562742,"reputation":5917,"user_id":2851311,"display_name":"hfontanez"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1656344065,"creation_date":1656344065,"answer_id":72774737,"question_id":72774357,"body_markdown":"You need to reduce `m` only for the problem to return 9 as you indicated.\r\n\r\n```\r\npublic static int part (int n, int m) {\r\n\tif (n == 0) {\r\n\t\treturn 1;\r\n\t} else if (m == 0 || n &lt; 0) {\r\n\t\treturn 0;\r\n\t} else {\r\n\t\treturn part(n - m, m--) + part(n, m);\r\n    }\r\n}\r\n```","title":"function to find number of ways u can split n objects using parts up to m","body":"<p>You need to reduce <code>m</code> only for the problem to return 9 as you indicated.</p>\n<pre><code>public static int part (int n, int m) {\n    if (n == 0) {\n        return 1;\n    } else if (m == 0 || n &lt; 0) {\n        return 0;\n    } else {\n        return part(n - m, m--) + part(n, m);\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":7821678,"reputation":2208,"user_id":5914654,"display_name":"vincrichaud"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1656345294,"creation_date":1656345294,"answer_id":72774995,"question_id":72774357,"body_markdown":"I&#39;m not sure what you&#39;re trying to do, but if it is to compute the [combination](https://en.wikipedia.org/wiki/Combination) it should look like this :\r\n\r\n    public static int part(int n, int m) {\r\n        if(m&gt;n) { //This prevent a wrong input from the user\r\n            return part(m, n);\r\n        } else if (m==0 || m==n) { //This is your base case\r\n            return 1;\r\n        } else if(m &lt; 0 || n&lt;0) { //this should not happened, but you never know\r\n            return 0;\r\n        }  else { //this is where you&#39;re making mistake(s)\r\n            //I don&#39;t know if I&#39;m using the formula you are looking for\r\n            //But if not, make sure yours do not use part(n, m) otherwise it will run forever\r\n            return part(n-1, m) + part(n-1, m-1);\r\n        }\r\n    }","title":"function to find number of ways u can split n objects using parts up to m","body":"<p>I'm not sure what you're trying to do, but if it is to compute the <a href=\"https://en.wikipedia.org/wiki/Combination\" rel=\"nofollow noreferrer\">combination</a> it should look like this :</p>\n<pre><code>public static int part(int n, int m) {\n    if(m&gt;n) { //This prevent a wrong input from the user\n        return part(m, n);\n    } else if (m==0 || m==n) { //This is your base case\n        return 1;\n    } else if(m &lt; 0 || n&lt;0) { //this should not happened, but you never know\n        return 0;\n    }  else { //this is where you're making mistake(s)\n        //I don't know if I'm using the formula you are looking for\n        //But if not, make sure yours do not use part(n, m) otherwise it will run forever\n        return part(n-1, m) + part(n-1, m-1);\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":24395089,"reputation":29,"user_id":18324544,"display_name":"Nuva_rad"},"comment_count":9,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":111,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":72774737,"answer_count":2,"score":1,"last_activity_date":1656345294,"creation_date":1656342390,"question_id":72774357,"body_markdown":"I&#39;m using recursion to solve the problem. On paper my answer should work so I went wrong with the code. However, I can&#39;t figure exactly where the problem is.\r\n```\r\npublic class Partition {\r\n    public static void main(String[] args) {\r\n\t    System.out.println(part(6,4));\r\n    }\r\n\r\n    public static int part(int n, int m) {\r\n    \tif (n==0) {\r\n\t\t    return 1;\r\n\t    }\r\n\t    else if(m == 0 || n&lt;0) {\r\n\t\t    return 0;\r\n\t    }\r\n\t    else {\r\n\t\t    return part(n-m, m) + part(n, m);\r\n\t    }\r\n    }\r\n}\r\n```","title":"function to find number of ways u can split n objects using parts up to m","body":"<p>I'm using recursion to solve the problem. On paper my answer should work so I went wrong with the code. However, I can't figure exactly where the problem is.</p>\n<pre><code>public class Partition {\n    public static void main(String[] args) {\n        System.out.println(part(6,4));\n    }\n\n    public static int part(int n, int m) {\n        if (n==0) {\n            return 1;\n        }\n        else if(m == 0 || n&lt;0) {\n            return 0;\n        }\n        else {\n            return part(n-m, m) + part(n, m);\n        }\n    }\n}\n</code></pre>\n"},{"tags":["java","swing","jframe","jpanel","jbutton"],"comments":[{"owner":{"account_id":1689973,"reputation":37280,"user_id":1552534,"display_name":"WJS"},"score":2,"creation_date":1656344855,"post_id":72774827,"comment_id":128543452,"body_markdown":"Where is your `Main.java` file?   And you realize you can put other classes and the main in the same file (makes it easier to work on imo).  And please don&#39;t post images or links to outside code.","body":"Where is your <code>Main.java</code> file?   And you realize you can put other classes and the main in the same file (makes it easier to work on imo).  And please don&#39;t post images or links to outside code."},{"owner":{"account_id":81822,"reputation":204250,"user_id":230513,"accept_rate":100,"display_name":"trashgod"},"score":0,"creation_date":1656345219,"post_id":72774827,"comment_id":128543590,"body_markdown":"Construct and manipulate Swing GUI objects _only_ on the [event dispatch thread](https://docs.oracle.com/javase/tutorial/uiswing/concurrency/initial.html); more [here](https://stackoverflow.com/a/7158505/230513).","body":"Construct and manipulate Swing GUI objects <i>only</i> on the <a href=\"https://docs.oracle.com/javase/tutorial/uiswing/concurrency/initial.html\" rel=\"nofollow noreferrer\">event dispatch thread</a>; more <a href=\"https://stackoverflow.com/a/7158505/230513\">here</a>."},{"owner":{"account_id":25662348,"reputation":1,"user_id":19427935,"display_name":"Syneptic"},"score":0,"creation_date":1656345248,"post_id":72774827,"comment_id":128543600,"body_markdown":"@WJS The Main.java is in the same src folder as TicTacToe.java. Well I did realize that, it&#39;s just that&#39;s how they did it in the tutorial","body":"@WJS The Main.java is in the same src folder as TicTacToe.java. Well I did realize that, it&#39;s just that&#39;s how they did it in the tutorial"},{"owner":{"account_id":1689973,"reputation":37280,"user_id":1552534,"display_name":"WJS"},"score":0,"creation_date":1656345680,"post_id":72774827,"comment_id":128543736,"body_markdown":"Why don&#39;t you move `setVisible(true)` right before `firstTurn()`. Why make anything visible before you are done setting up?  And why are you sleeping for 2 seconds?","body":"Why don&#39;t you move <code>setVisible(true)</code> right before <code>firstTurn()</code>. Why make anything visible before you are done setting up?  And why are you sleeping for 2 seconds?"},{"owner":{"account_id":22057425,"reputation":135,"user_id":16320675,"display_name":"user16320675"},"score":5,"creation_date":1656345868,"post_id":72774827,"comment_id":128543802,"body_markdown":"instead of videos, I would strongly recommend WRITTEN tutorials, specially the Oracle&#39;s  one: [The Java™ Tutorials](https://docs.oracle.com/javase/tutorial/) (kind of the developers of Java)","body":"instead of videos, I would strongly recommend WRITTEN tutorials, specially the Oracle&#39;s  one: <a href=\"https://docs.oracle.com/javase/tutorial/\" rel=\"nofollow noreferrer\">The Java™ Tutorials</a> (kind of the developers of Java)"},{"owner":{"account_id":1689973,"reputation":37280,"user_id":1552534,"display_name":"WJS"},"score":0,"creation_date":1656345872,"post_id":72774827,"comment_id":128543804,"body_markdown":"@trashgod  I would agree except for construct.  Constructing a JButton via new isn&#39;t done on the EDT. Perhaps I misunderstood what you meant.","body":"@trashgod  I would agree except for construct.  Constructing a JButton via new isn&#39;t done on the EDT. Perhaps I misunderstood what you meant."},{"owner":{"account_id":25662348,"reputation":1,"user_id":19427935,"display_name":"Syneptic"},"score":1,"creation_date":1656345928,"post_id":72774827,"comment_id":128543829,"body_markdown":"@WJS that&#39;s working!!! Idk man, it was working in the video for the guy, I don&#39;t see why it shouldn&#39;t work on my PC the same way, everything else does. Well, thanks a lot! This did the trick","body":"@WJS that&#39;s working!!! Idk man, it was working in the video for the guy, I don&#39;t see why it shouldn&#39;t work on my PC the same way, everything else does. Well, thanks a lot! This did the trick"},{"owner":{"account_id":1689973,"reputation":37280,"user_id":1552534,"display_name":"WJS"},"score":0,"creation_date":1656345970,"post_id":72774827,"comment_id":128543850,"body_markdown":"BTW, I learn lots of things from YouTube.  But I have never found it a good source for learning to code (imho).  I suggest you start by looking  at answers on this site to see how to do graphics.  There are lots of good examples.  Personally, I prefer books.","body":"BTW, I learn lots of things from YouTube.  But I have never found it a good source for learning to code (imho).  I suggest you start by looking  at answers on this site to see how to do graphics.  There are lots of good examples.  Personally, I prefer books."},{"owner":{"account_id":25662348,"reputation":1,"user_id":19427935,"display_name":"Syneptic"},"score":0,"creation_date":1656346250,"post_id":72774827,"comment_id":128543952,"body_markdown":"@WJS I do try to get a lot of infos from here. I&#39;m still pretty new to the whole coding world. YouTube is a pretty good spot to find broad information and then head over to stack overflow to specify questions and tasks. By the way, I had no idea stack overflow had such an incredible response time. You guys responded within the first couple minutes. I definitely wouldn&#39;t have expected that.","body":"@WJS I do try to get a lot of infos from here. I&#39;m still pretty new to the whole coding world. YouTube is a pretty good spot to find broad information and then head over to stack overflow to specify questions and tasks. By the way, I had no idea stack overflow had such an incredible response time. You guys responded within the first couple minutes. I definitely wouldn&#39;t have expected that."},{"owner":{"account_id":1689973,"reputation":37280,"user_id":1552534,"display_name":"WJS"},"score":0,"creation_date":1656346254,"post_id":72774827,"comment_id":128543956,"body_markdown":"@Syneptic * that&#39;s working!!! Idk man, it was working in the video for the guy,*  Perhaps his PC was faster.","body":"@Syneptic * that&#39;s working!!! Idk man, it was working in the video for the guy,*  Perhaps his PC was faster."},{"owner":{"account_id":1689973,"reputation":37280,"user_id":1552534,"display_name":"WJS"},"score":0,"creation_date":1656346359,"post_id":72774827,"comment_id":128543987,"body_markdown":"BTW, Welcome to StackOverFlow.  Recommend you take the [tour].","body":"BTW, Welcome to StackOverFlow.  Recommend you take the <a href=\"https://stackoverflow.com/tour\">tour</a>."},{"owner":{"account_id":25662348,"reputation":1,"user_id":19427935,"display_name":"Syneptic"},"score":0,"creation_date":1656346365,"post_id":72774827,"comment_id":128543991,"body_markdown":"@WJS while that could be the a possibility, it wouldn&#39;t really make sense to me. Note how it wouldn&#39;t work at all at first until I resized the window which caused it to display the text. It wasn&#39;t a question of time but instead giving it a &#39;trigger&#39;","body":"@WJS while that could be the a possibility, it wouldn&#39;t really make sense to me. Note how it wouldn&#39;t work at all at first until I resized the window which caused it to display the text. It wasn&#39;t a question of time but instead giving it a &#39;trigger&#39;"},{"owner":{"account_id":25662348,"reputation":1,"user_id":19427935,"display_name":"Syneptic"},"score":0,"creation_date":1656346396,"post_id":72774827,"comment_id":128544000,"body_markdown":"@WJS much appreciated, I&#39;ll look into the Tour.","body":"@WJS much appreciated, I&#39;ll look into the Tour."},{"owner":{"account_id":81822,"reputation":204250,"user_id":230513,"accept_rate":100,"display_name":"trashgod"},"score":1,"creation_date":1656346578,"post_id":72774827,"comment_id":128544056,"body_markdown":"@WJS: I&#39;m paraphrasing the quote [here](https://stackoverflow.com/a/7158505/230513). I share your skepticism of coding videos. Good eye on premature `setVisible()`; it&#39;s a common error.","body":"@WJS: I&#39;m paraphrasing the quote <a href=\"https://stackoverflow.com/a/7158505/230513\">here</a>. I share your skepticism of coding videos. Good eye on premature <code>setVisible()</code>; it&#39;s a common error."},{"owner":{"account_id":1689973,"reputation":37280,"user_id":1552534,"display_name":"WJS"},"score":0,"creation_date":1656347506,"post_id":72774827,"comment_id":128544422,"body_markdown":"I just noted your test for victory.  I recommend you rewrite your `check()` method to use `if/else` clauses.  Once a check is successful, why keep on checking after you return from declaring the winner? And consider this.  Why check for both X and 0 wins in the same method?  If one player  just went the other player would have already won or not gone yet.  One way this could be done by passing a `boolean` to determine which player to check.  This may not be an issue now, but it could be in the future when you reset for another game.","body":"I just noted your test for victory.  I recommend you rewrite your <code>check()</code> method to use <code>if&#47;else</code> clauses.  Once a check is successful, why keep on checking after you return from declaring the winner? And consider this.  Why check for both X and 0 wins in the same method?  If one player  just went the other player would have already won or not gone yet.  One way this could be done by passing a <code>boolean</code> to determine which player to check.  This may not be an issue now, but it could be in the future when you reset for another game."},{"owner":{"account_id":25662348,"reputation":1,"user_id":19427935,"display_name":"Syneptic"},"score":0,"creation_date":1656347877,"post_id":72774827,"comment_id":128544583,"body_markdown":"@WJS I haven&#39;t gotten to that part (in the video) yet but I&#39;ll try your suggestion. :) thx for the hint","body":"@WJS I haven&#39;t gotten to that part (in the video) yet but I&#39;ll try your suggestion. :) thx for the hint"},{"owner":{"account_id":1689973,"reputation":37280,"user_id":1552534,"display_name":"WJS"},"score":2,"creation_date":1656349375,"post_id":72774827,"comment_id":128545127,"body_markdown":"And this will be my last comment.  :)  Don&#39;t be using `==` to test Strings or any other `Object` for equality.  Use  `.equals`.  You can use `==` for primitives or to test objects for `null`.  Your program works because Strings are interned (cached) so all the X&#39;s  are the same object as are Y&#39;s.  And I checked the video and the in spite of good intentions, some bad techniques are being demonstrated there.","body":"And this will be my last comment.  :)  Don&#39;t be using <code>==</code> to test Strings or any other <code>Object</code> for equality.  Use  <code>.equals</code>.  You can use <code>==</code> for primitives or to test objects for <code>null</code>.  Your program works because Strings are interned (cached) so all the X&#39;s  are the same object as are Y&#39;s.  And I checked the video and the in spite of good intentions, some bad techniques are being demonstrated there."},{"owner":{"account_id":25662348,"reputation":1,"user_id":19427935,"display_name":"Syneptic"},"score":0,"creation_date":1656351128,"post_id":72774827,"comment_id":128545736,"body_markdown":"@WJS true he actually said that he did some sub-optimal coding because he didn&#39;t think the video would get that much traction. and yes, I did learn about that in a Udemy Java course! Good reminder, thanks :)","body":"@WJS true he actually said that he did some sub-optimal coding because he didn&#39;t think the video would get that much traction. and yes, I did learn about that in a Udemy Java course! Good reminder, thanks :)"}],"owner":{"account_id":25662348,"reputation":1,"user_id":19427935,"display_name":"Syneptic"},"comment_count":18,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":135,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1656345202,"creation_date":1656344473,"question_id":72774827,"body_markdown":"I&#39;m a beginner to coding. I&#39;m using IntelliJ on a MacBook M1 Pro. So far most things went great and the compiling time is fast. Apps where everything runs in the Terminal work perfectly.\r\n\r\nUnfortunately, when I use Swing instances like JPanel &amp; JFrame there seems to be a delay or complete bug.\r\nI&#39;m watching this tutorial on a Tic Tac Toe game. I&#39;ve done everything the exact same but at this point when I run it only a gray square panel with a white top panel is being displayed. No text.\r\n\r\nWeirdly, when I resize the window, there is a short freeze of the window, followed by the spinning loading wheel and then the text &quot;Tic-Tac-Toe&quot; appears on the top with the correct back-&amp;foreground colors.\r\n\r\nWhen I copy the whole final code from the video it works for some reason. I&#39;ve triple checked everything, so far it&#39;s identical but it&#39;s not working correctly for some reason.\r\n\r\nThere&#39;s a TicTacToe.java and Main.java file in the project.\r\n\r\nMy code so far in TicTacToe.java :\r\n``` \r\nimport java.awt.*;\r\nimport java.awt.event.*;\r\nimport java.util.*;\r\nimport javax.swing.*;\r\n\r\n\r\n    public class TicTacToe implements ActionListener {\r\n\r\n        Random random = new Random();\r\n        JFrame frame = new JFrame();\r\n        JPanel title_panel = new JPanel();\r\n        JPanel button_panel = new JPanel();\r\n        JLabel textfield = new JLabel();\r\n        JButton[] buttons = new JButton[9];\r\n        boolean player1_turn;\r\n\r\n\r\n        TicTacToe() {\r\n            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\r\n            frame.setSize(800, 800);\r\n            frame.getContentPane().setBackground(new Color(50,50,50));\r\n            frame.setLocationRelativeTo(null);\r\n            frame.setLayout(new BorderLayout());\r\n            frame.setVisible(true);\r\n\r\n\r\n            textfield.setBackground(new Color(9, 21, 227));\r\n            textfield.setForeground(new Color(25, 255, 0));\r\n            textfield.setFont(new Font(&quot;Ink Free&quot;, Font.BOLD, 75));\r\n            textfield.setHorizontalAlignment(JLabel.CENTER);\r\n            textfield.setText(&quot;Tic-Tac-Toe&quot;);\r\n            textfield.setOpaque(true);\r\n\r\n            title_panel.setLayout(new BorderLayout());\r\n            title_panel.setBounds(0,0,800,100);\r\n\r\n            title_panel.add(textfield);\r\n            frame.add(title_panel,BorderLayout.NORTH);\r\n            \r\n\r\n        }\r\n\r\n\r\n        @Override\r\n        public void actionPerformed(ActionEvent e) {\r\n\r\n        }\r\n\r\n        public void firstTurn() {\r\n\r\n        }\r\n\r\n        public void check() {\r\n\r\n        }\r\n\r\n        public void xWins(int a, int b, int c) {\r\n\r\n        }\r\n\r\n        public void oWins(int a, int b, int c) {\r\n\r\n        }\r\n    }\r\n``` \r\n\r\nThe video tutorial&#39;s code:\r\n``` \r\nimport java.awt.*;\r\nimport java.awt.event.*;\r\nimport java.util.*;\r\nimport javax.swing.*;\r\n\r\npublic class TicTacToe implements ActionListener{\r\n\r\n\tRandom random = new Random();\r\n\tJFrame frame = new JFrame();\r\n\tJPanel title_panel = new JPanel();\r\n\tJPanel button_panel = new JPanel();\r\n\tJLabel textfield = new JLabel();\r\n\tJButton[] buttons = new JButton[9];\r\n\tboolean player1_turn;\r\n\r\n\tTicTacToe(){\r\n\t\t\r\n\t\tframe.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\r\n\t\tframe.setSize(800,800);\r\n\t\tframe.getContentPane().setBackground(new Color(50,50,50));\r\n\t\tframe.setLayout(new BorderLayout());\r\n\t\tframe.setVisible(true);\r\n\t\t\r\n\t\ttextfield.setBackground(new Color(25,25,25));\r\n\t\ttextfield.setForeground(new Color(25,255,0));\r\n\t\ttextfield.setFont(new Font(&quot;Ink Free&quot;,Font.BOLD,75));\r\n\t\ttextfield.setHorizontalAlignment(JLabel.CENTER);\r\n\t\ttextfield.setText(&quot;Tic-Tac-Toe&quot;);\r\n\t\ttextfield.setOpaque(true);\r\n\t\t\r\n\t\ttitle_panel.setLayout(new BorderLayout());\r\n\t\ttitle_panel.setBounds(0,0,800,100);\r\n\t\t\r\n\t\tbutton_panel.setLayout(new GridLayout(3,3));\r\n\t\tbutton_panel.setBackground(new Color(150,150,150));\r\n\t\t\r\n\t\tfor(int i=0;i&lt;9;i++) {\r\n\t\t\tbuttons[i] = new JButton();\r\n\t\t\tbutton_panel.add(buttons[i]);\r\n\t\t\tbuttons[i].setFont(new Font(&quot;MV Boli&quot;,Font.BOLD,120));\r\n\t\t\tbuttons[i].setFocusable(false);\r\n\t\t\tbuttons[i].addActionListener(this);\r\n\t\t}\r\n\t\t\r\n\t\ttitle_panel.add(textfield);\r\n\t\tframe.add(title_panel,BorderLayout.NORTH);\r\n\t\tframe.add(button_panel);\r\n\t\t\r\n\t\tfirstTurn();\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void actionPerformed(ActionEvent e) {\r\n\t\t\r\n\t\tfor(int i=0;i&lt;9;i++) {\r\n\t\t\tif(e.getSource()==buttons[i]) {\r\n\t\t\t\tif(player1_turn) {\r\n\t\t\t\t\tif(buttons[i].getText()==&quot;&quot;) {\r\n\t\t\t\t\t\tbuttons[i].setForeground(new Color(255,0,0));\r\n\t\t\t\t\t\tbuttons[i].setText(&quot;X&quot;);\r\n\t\t\t\t\t\tplayer1_turn=false;\r\n\t\t\t\t\t\ttextfield.setText(&quot;O turn&quot;);\r\n\t\t\t\t\t\tcheck();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif(buttons[i].getText()==&quot;&quot;) {\r\n\t\t\t\t\t\tbuttons[i].setForeground(new Color(0,0,255));\r\n\t\t\t\t\t\tbuttons[i].setText(&quot;O&quot;);\r\n\t\t\t\t\t\tplayer1_turn=true;\r\n\t\t\t\t\t\ttextfield.setText(&quot;X turn&quot;);\r\n\t\t\t\t\t\tcheck();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic void firstTurn() {\r\n\t\t\r\n\t\ttry {\r\n\t\t\tThread.sleep(2000);\r\n\t\t} catch (InterruptedException e) {\r\n\t\t\t// TODO Auto-generated catch block\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\t\t\r\n\t\tif(random.nextInt(2)==0) {\r\n\t\t\tplayer1_turn=true;\r\n\t\t\ttextfield.setText(&quot;X turn&quot;);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tplayer1_turn=false;\r\n\t\t\ttextfield.setText(&quot;O turn&quot;);\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic void check() {\r\n\t\t//check X win conditions\r\n\t\tif(\r\n\t\t\t\t(buttons[0].getText()==&quot;X&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[1].getText()==&quot;X&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[2].getText()==&quot;X&quot;)\r\n\t\t\t\t) {\r\n\t\t\txWins(0,1,2);\r\n\t\t}\r\n\t\tif(\r\n\t\t\t\t(buttons[3].getText()==&quot;X&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[4].getText()==&quot;X&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[5].getText()==&quot;X&quot;)\r\n\t\t\t\t) {\r\n\t\t\txWins(3,4,5);\r\n\t\t}\r\n\t\tif(\r\n\t\t\t\t(buttons[6].getText()==&quot;X&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[7].getText()==&quot;X&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[8].getText()==&quot;X&quot;)\r\n\t\t\t\t) {\r\n\t\t\txWins(6,7,8);\r\n\t\t}\r\n\t\tif(\r\n\t\t\t\t(buttons[0].getText()==&quot;X&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[3].getText()==&quot;X&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[6].getText()==&quot;X&quot;)\r\n\t\t\t\t) {\r\n\t\t\txWins(0,3,6);\r\n\t\t}\r\n\t\tif(\r\n\t\t\t\t(buttons[1].getText()==&quot;X&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[4].getText()==&quot;X&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[7].getText()==&quot;X&quot;)\r\n\t\t\t\t) {\r\n\t\t\txWins(1,4,7);\r\n\t\t}\r\n\t\tif(\r\n\t\t\t\t(buttons[2].getText()==&quot;X&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[5].getText()==&quot;X&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[8].getText()==&quot;X&quot;)\r\n\t\t\t\t) {\r\n\t\t\txWins(2,5,8);\r\n\t\t}\r\n\t\tif(\r\n\t\t\t\t(buttons[0].getText()==&quot;X&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[4].getText()==&quot;X&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[8].getText()==&quot;X&quot;)\r\n\t\t\t\t) {\r\n\t\t\txWins(0,4,8);\r\n\t\t}\r\n\t\tif(\r\n\t\t\t\t(buttons[2].getText()==&quot;X&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[4].getText()==&quot;X&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[6].getText()==&quot;X&quot;)\r\n\t\t\t\t) {\r\n\t\t\txWins(2,4,6);\r\n\t\t}\r\n\t\t//check O win conditions\r\n\t\tif(\r\n\t\t\t\t(buttons[0].getText()==&quot;O&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[1].getText()==&quot;O&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[2].getText()==&quot;O&quot;)\r\n\t\t\t\t) {\r\n\t\t\toWins(0,1,2);\r\n\t\t}\r\n\t\tif(\r\n\t\t\t\t(buttons[3].getText()==&quot;O&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[4].getText()==&quot;O&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[5].getText()==&quot;O&quot;)\r\n\t\t\t\t) {\r\n\t\t\toWins(3,4,5);\r\n\t\t}\r\n\t\tif(\r\n\t\t\t\t(buttons[6].getText()==&quot;O&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[7].getText()==&quot;O&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[8].getText()==&quot;O&quot;)\r\n\t\t\t\t) {\r\n\t\t\toWins(6,7,8);\r\n\t\t}\r\n\t\tif(\r\n\t\t\t\t(buttons[0].getText()==&quot;O&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[3].getText()==&quot;O&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[6].getText()==&quot;O&quot;)\r\n\t\t\t\t) {\r\n\t\t\toWins(0,3,6);\r\n\t\t}\r\n\t\tif(\r\n\t\t\t\t(buttons[1].getText()==&quot;O&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[4].getText()==&quot;O&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[7].getText()==&quot;O&quot;)\r\n\t\t\t\t) {\r\n\t\t\toWins(1,4,7);\r\n\t\t}\r\n\t\tif(\r\n\t\t\t\t(buttons[2].getText()==&quot;O&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[5].getText()==&quot;O&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[8].getText()==&quot;O&quot;)\r\n\t\t\t\t) {\r\n\t\t\toWins(2,5,8);\r\n\t\t}\r\n\t\tif(\r\n\t\t\t\t(buttons[0].getText()==&quot;O&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[4].getText()==&quot;O&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[8].getText()==&quot;O&quot;)\r\n\t\t\t\t) {\r\n\t\t\toWins(0,4,8);\r\n\t\t}\r\n\t\tif(\r\n\t\t\t\t(buttons[2].getText()==&quot;O&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[4].getText()==&quot;O&quot;) &amp;&amp;\r\n\t\t\t\t(buttons[6].getText()==&quot;O&quot;)\r\n\t\t\t\t) {\r\n\t\t\toWins(2,4,6);\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic void xWins(int a,int b,int c) {\r\n\t\tbuttons[a].setBackground(Color.GREEN);\r\n\t\tbuttons[b].setBackground(Color.GREEN);\r\n\t\tbuttons[c].setBackground(Color.GREEN);\r\n\t\t\r\n\t\tfor(int i=0;i&lt;9;i++) {\r\n\t\t\tbuttons[i].setEnabled(false);\r\n\t\t}\r\n\t\ttextfield.setText(&quot;X wins&quot;);\r\n\t}\r\n\tpublic void oWins(int a,int b,int c) {\r\n\t\tbuttons[a].setBackground(Color.GREEN);\r\n\t\tbuttons[b].setBackground(Color.GREEN);\r\n\t\tbuttons[c].setBackground(Color.GREEN);\r\n\t\t\r\n\t\tfor(int i=0;i&lt;9;i++) {\r\n\t\t\tbuttons[i].setEnabled(false);\r\n\t\t}\r\n\t\ttextfield.setText(&quot;O wins&quot;);\r\n\t}\r\n}\r\n``` \r\n\r\nI&#39;m thinking it&#39;s something with perhaps the JDK or an incompatibility with mac and IntelliJ, I dont know. I&#39;ve already reinstalled IntelliJ and reset it to factory settings.\r\n\r\nIf anyone has any ideas please share. I&#39;ve googled a lot and couldn&#39;t find any solution.\r\n","title":"There is always a delay or bug when running JPanel &amp; JFrame instances (Mac M1 Pro)","body":"<p>I'm a beginner to coding. I'm using IntelliJ on a MacBook M1 Pro. So far most things went great and the compiling time is fast. Apps where everything runs in the Terminal work perfectly.</p>\n<p>Unfortunately, when I use Swing instances like JPanel &amp; JFrame there seems to be a delay or complete bug.\nI'm watching this tutorial on a Tic Tac Toe game. I've done everything the exact same but at this point when I run it only a gray square panel with a white top panel is being displayed. No text.</p>\n<p>Weirdly, when I resize the window, there is a short freeze of the window, followed by the spinning loading wheel and then the text &quot;Tic-Tac-Toe&quot; appears on the top with the correct back-&amp;foreground colors.</p>\n<p>When I copy the whole final code from the video it works for some reason. I've triple checked everything, so far it's identical but it's not working correctly for some reason.</p>\n<p>There's a TicTacToe.java and Main.java file in the project.</p>\n<p>My code so far in TicTacToe.java :</p>\n<pre><code>import java.awt.*;\nimport java.awt.event.*;\nimport java.util.*;\nimport javax.swing.*;\n\n\n    public class TicTacToe implements ActionListener {\n\n        Random random = new Random();\n        JFrame frame = new JFrame();\n        JPanel title_panel = new JPanel();\n        JPanel button_panel = new JPanel();\n        JLabel textfield = new JLabel();\n        JButton[] buttons = new JButton[9];\n        boolean player1_turn;\n\n\n        TicTacToe() {\n            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n            frame.setSize(800, 800);\n            frame.getContentPane().setBackground(new Color(50,50,50));\n            frame.setLocationRelativeTo(null);\n            frame.setLayout(new BorderLayout());\n            frame.setVisible(true);\n\n\n            textfield.setBackground(new Color(9, 21, 227));\n            textfield.setForeground(new Color(25, 255, 0));\n            textfield.setFont(new Font(&quot;Ink Free&quot;, Font.BOLD, 75));\n            textfield.setHorizontalAlignment(JLabel.CENTER);\n            textfield.setText(&quot;Tic-Tac-Toe&quot;);\n            textfield.setOpaque(true);\n\n            title_panel.setLayout(new BorderLayout());\n            title_panel.setBounds(0,0,800,100);\n\n            title_panel.add(textfield);\n            frame.add(title_panel,BorderLayout.NORTH);\n            \n\n        }\n\n\n        @Override\n        public void actionPerformed(ActionEvent e) {\n\n        }\n\n        public void firstTurn() {\n\n        }\n\n        public void check() {\n\n        }\n\n        public void xWins(int a, int b, int c) {\n\n        }\n\n        public void oWins(int a, int b, int c) {\n\n        }\n    }\n</code></pre>\n<p>The video tutorial's code:</p>\n<pre><code>import java.awt.*;\nimport java.awt.event.*;\nimport java.util.*;\nimport javax.swing.*;\n\npublic class TicTacToe implements ActionListener{\n\n    Random random = new Random();\n    JFrame frame = new JFrame();\n    JPanel title_panel = new JPanel();\n    JPanel button_panel = new JPanel();\n    JLabel textfield = new JLabel();\n    JButton[] buttons = new JButton[9];\n    boolean player1_turn;\n\n    TicTacToe(){\n        \n        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n        frame.setSize(800,800);\n        frame.getContentPane().setBackground(new Color(50,50,50));\n        frame.setLayout(new BorderLayout());\n        frame.setVisible(true);\n        \n        textfield.setBackground(new Color(25,25,25));\n        textfield.setForeground(new Color(25,255,0));\n        textfield.setFont(new Font(&quot;Ink Free&quot;,Font.BOLD,75));\n        textfield.setHorizontalAlignment(JLabel.CENTER);\n        textfield.setText(&quot;Tic-Tac-Toe&quot;);\n        textfield.setOpaque(true);\n        \n        title_panel.setLayout(new BorderLayout());\n        title_panel.setBounds(0,0,800,100);\n        \n        button_panel.setLayout(new GridLayout(3,3));\n        button_panel.setBackground(new Color(150,150,150));\n        \n        for(int i=0;i&lt;9;i++) {\n            buttons[i] = new JButton();\n            button_panel.add(buttons[i]);\n            buttons[i].setFont(new Font(&quot;MV Boli&quot;,Font.BOLD,120));\n            buttons[i].setFocusable(false);\n            buttons[i].addActionListener(this);\n        }\n        \n        title_panel.add(textfield);\n        frame.add(title_panel,BorderLayout.NORTH);\n        frame.add(button_panel);\n        \n        firstTurn();\n    }\n\n    @Override\n    public void actionPerformed(ActionEvent e) {\n        \n        for(int i=0;i&lt;9;i++) {\n            if(e.getSource()==buttons[i]) {\n                if(player1_turn) {\n                    if(buttons[i].getText()==&quot;&quot;) {\n                        buttons[i].setForeground(new Color(255,0,0));\n                        buttons[i].setText(&quot;X&quot;);\n                        player1_turn=false;\n                        textfield.setText(&quot;O turn&quot;);\n                        check();\n                    }\n                }\n                else {\n                    if(buttons[i].getText()==&quot;&quot;) {\n                        buttons[i].setForeground(new Color(0,0,255));\n                        buttons[i].setText(&quot;O&quot;);\n                        player1_turn=true;\n                        textfield.setText(&quot;X turn&quot;);\n                        check();\n                    }\n                }\n            }           \n        }\n    }\n    \n    public void firstTurn() {\n        \n        try {\n            Thread.sleep(2000);\n        } catch (InterruptedException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        }\n        \n        if(random.nextInt(2)==0) {\n            player1_turn=true;\n            textfield.setText(&quot;X turn&quot;);\n        }\n        else {\n            player1_turn=false;\n            textfield.setText(&quot;O turn&quot;);\n        }\n    }\n    \n    public void check() {\n        //check X win conditions\n        if(\n                (buttons[0].getText()==&quot;X&quot;) &amp;&amp;\n                (buttons[1].getText()==&quot;X&quot;) &amp;&amp;\n                (buttons[2].getText()==&quot;X&quot;)\n                ) {\n            xWins(0,1,2);\n        }\n        if(\n                (buttons[3].getText()==&quot;X&quot;) &amp;&amp;\n                (buttons[4].getText()==&quot;X&quot;) &amp;&amp;\n                (buttons[5].getText()==&quot;X&quot;)\n                ) {\n            xWins(3,4,5);\n        }\n        if(\n                (buttons[6].getText()==&quot;X&quot;) &amp;&amp;\n                (buttons[7].getText()==&quot;X&quot;) &amp;&amp;\n                (buttons[8].getText()==&quot;X&quot;)\n                ) {\n            xWins(6,7,8);\n        }\n        if(\n                (buttons[0].getText()==&quot;X&quot;) &amp;&amp;\n                (buttons[3].getText()==&quot;X&quot;) &amp;&amp;\n                (buttons[6].getText()==&quot;X&quot;)\n                ) {\n            xWins(0,3,6);\n        }\n        if(\n                (buttons[1].getText()==&quot;X&quot;) &amp;&amp;\n                (buttons[4].getText()==&quot;X&quot;) &amp;&amp;\n                (buttons[7].getText()==&quot;X&quot;)\n                ) {\n            xWins(1,4,7);\n        }\n        if(\n                (buttons[2].getText()==&quot;X&quot;) &amp;&amp;\n                (buttons[5].getText()==&quot;X&quot;) &amp;&amp;\n                (buttons[8].getText()==&quot;X&quot;)\n                ) {\n            xWins(2,5,8);\n        }\n        if(\n                (buttons[0].getText()==&quot;X&quot;) &amp;&amp;\n                (buttons[4].getText()==&quot;X&quot;) &amp;&amp;\n                (buttons[8].getText()==&quot;X&quot;)\n                ) {\n            xWins(0,4,8);\n        }\n        if(\n                (buttons[2].getText()==&quot;X&quot;) &amp;&amp;\n                (buttons[4].getText()==&quot;X&quot;) &amp;&amp;\n                (buttons[6].getText()==&quot;X&quot;)\n                ) {\n            xWins(2,4,6);\n        }\n        //check O win conditions\n        if(\n                (buttons[0].getText()==&quot;O&quot;) &amp;&amp;\n                (buttons[1].getText()==&quot;O&quot;) &amp;&amp;\n                (buttons[2].getText()==&quot;O&quot;)\n                ) {\n            oWins(0,1,2);\n        }\n        if(\n                (buttons[3].getText()==&quot;O&quot;) &amp;&amp;\n                (buttons[4].getText()==&quot;O&quot;) &amp;&amp;\n                (buttons[5].getText()==&quot;O&quot;)\n                ) {\n            oWins(3,4,5);\n        }\n        if(\n                (buttons[6].getText()==&quot;O&quot;) &amp;&amp;\n                (buttons[7].getText()==&quot;O&quot;) &amp;&amp;\n                (buttons[8].getText()==&quot;O&quot;)\n                ) {\n            oWins(6,7,8);\n        }\n        if(\n                (buttons[0].getText()==&quot;O&quot;) &amp;&amp;\n                (buttons[3].getText()==&quot;O&quot;) &amp;&amp;\n                (buttons[6].getText()==&quot;O&quot;)\n                ) {\n            oWins(0,3,6);\n        }\n        if(\n                (buttons[1].getText()==&quot;O&quot;) &amp;&amp;\n                (buttons[4].getText()==&quot;O&quot;) &amp;&amp;\n                (buttons[7].getText()==&quot;O&quot;)\n                ) {\n            oWins(1,4,7);\n        }\n        if(\n                (buttons[2].getText()==&quot;O&quot;) &amp;&amp;\n                (buttons[5].getText()==&quot;O&quot;) &amp;&amp;\n                (buttons[8].getText()==&quot;O&quot;)\n                ) {\n            oWins(2,5,8);\n        }\n        if(\n                (buttons[0].getText()==&quot;O&quot;) &amp;&amp;\n                (buttons[4].getText()==&quot;O&quot;) &amp;&amp;\n                (buttons[8].getText()==&quot;O&quot;)\n                ) {\n            oWins(0,4,8);\n        }\n        if(\n                (buttons[2].getText()==&quot;O&quot;) &amp;&amp;\n                (buttons[4].getText()==&quot;O&quot;) &amp;&amp;\n                (buttons[6].getText()==&quot;O&quot;)\n                ) {\n            oWins(2,4,6);\n        }\n    }\n    \n    public void xWins(int a,int b,int c) {\n        buttons[a].setBackground(Color.GREEN);\n        buttons[b].setBackground(Color.GREEN);\n        buttons[c].setBackground(Color.GREEN);\n        \n        for(int i=0;i&lt;9;i++) {\n            buttons[i].setEnabled(false);\n        }\n        textfield.setText(&quot;X wins&quot;);\n    }\n    public void oWins(int a,int b,int c) {\n        buttons[a].setBackground(Color.GREEN);\n        buttons[b].setBackground(Color.GREEN);\n        buttons[c].setBackground(Color.GREEN);\n        \n        for(int i=0;i&lt;9;i++) {\n            buttons[i].setEnabled(false);\n        }\n        textfield.setText(&quot;O wins&quot;);\n    }\n}\n</code></pre>\n<p>I'm thinking it's something with perhaps the JDK or an incompatibility with mac and IntelliJ, I dont know. I've already reinstalled IntelliJ and reset it to factory settings.</p>\n<p>If anyone has any ideas please share. I've googled a lot and couldn't find any solution.</p>\n"},{"tags":["java","arrays","mime-types"],"comments":[{"owner":{"account_id":4254130,"reputation":13758,"user_id":3480246,"display_name":"Jan"},"score":1,"creation_date":1448885888,"post_id":33998407,"comment_id":55752386,"body_markdown":"byte[] contains a MIME Type? Please give more (much more!) details. And some source as example please.","body":"byte[] contains a MIME Type? Please give more (much more!) details. And some source as example please."}],"answers":[{"tags":[],"owner":{"account_id":7227751,"reputation":638,"user_id":5515739,"display_name":"mayank agrawal"},"down_vote_count":0,"up_vote_count":23,"is_accepted":true,"score":23,"last_activity_date":1584987075,"creation_date":1448886270,"answer_id":33998633,"question_id":33998407,"body_markdown":"   You can use the [`MimetypesFileTypeMap`][1] provided class from Java 6. This class is exclusively used to fetch the *MIME type*.\r\n\r\nUse it to fetch the MIME type as shown below:\r\n       \r\n    byte[] content = ;\r\n    InputStream is = new BufferedInputStream(new ByteArrayInputStream(content));\r\n    String mimeType = URLConnection.guessContentTypeFromStream(is);\r\n\r\nFor fetching from File you can use below code:\r\n    \r\n    MimetypesFileTypeMap mimeTypesMap = new MimetypesFileTypeMap();\r\n    String mime = mimeTypesMap.getContentType(file);\r\n\r\n\r\n  [1]: https://docs.oracle.com/javase/6/docs/api/javax/activation/MimetypesFileTypeMap.html","title":"How to fetch the MIME type from byte array in Java 6?","body":"<p>You can use the <a href=\"https://docs.oracle.com/javase/6/docs/api/javax/activation/MimetypesFileTypeMap.html\" rel=\"noreferrer\"><code>MimetypesFileTypeMap</code></a> provided class from Java 6. This class is exclusively used to fetch the <em>MIME type</em>.</p>\n\n<p>Use it to fetch the MIME type as shown below:</p>\n\n<pre><code>byte[] content = ;\nInputStream is = new BufferedInputStream(new ByteArrayInputStream(content));\nString mimeType = URLConnection.guessContentTypeFromStream(is);\n</code></pre>\n\n<p>For fetching from File you can use below code:</p>\n\n<pre><code>MimetypesFileTypeMap mimeTypesMap = new MimetypesFileTypeMap();\nString mime = mimeTypesMap.getContentType(file);\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2402568,"reputation":1540,"user_id":2099917,"display_name":"MrSpock"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1581967600,"creation_date":1581967600,"answer_id":60269183,"question_id":33998407,"body_markdown":"Good working library https://github.com/overview/mime-types\r\n\r\nImport (via gradle.kts):\r\n\r\n    implementation(&quot;org.overviewproject:mime-types:0.1.3&quot;)\r\n\r\nUsage\r\n\r\n    // input\r\n    final var fileName = &quot;somefile.html&quot;;\r\n    final var content = &quot;&lt;html&gt;&lt;/html&gt;&quot;.getBytes();\r\n\r\n    final var mimeTypeDetector = new MimeTypeDetector(); // initialize only once, reuse!\r\n    final var mimeType = mimeTypeDetector.detectMimeType(fileName, () -&gt; content);\r\n\r\n    System.out.println(mimeType); // prints: text/html\r\n","title":"How to fetch the MIME type from byte array in Java 6?","body":"<p>Good working library <a href=\"https://github.com/overview/mime-types\" rel=\"nofollow noreferrer\">https://github.com/overview/mime-types</a></p>\n\n<p>Import (via gradle.kts):</p>\n\n<pre><code>implementation(\"org.overviewproject:mime-types:0.1.3\")\n</code></pre>\n\n<p>Usage</p>\n\n<pre><code>// input\nfinal var fileName = \"somefile.html\";\nfinal var content = \"&lt;html&gt;&lt;/html&gt;\".getBytes();\n\nfinal var mimeTypeDetector = new MimeTypeDetector(); // initialize only once, reuse!\nfinal var mimeType = mimeTypeDetector.detectMimeType(fileName, () -&gt; content);\n\nSystem.out.println(mimeType); // prints: text/html\n</code></pre>\n"},{"tags":[],"owner":{"account_id":5396458,"reputation":1476,"user_id":4297541,"display_name":"PoorInRichfield"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656345103,"creation_date":1656345103,"answer_id":72774947,"question_id":33998407,"body_markdown":"[Apache Tika library][1] is proving to be the most accurate in detecting proper MIME type from a byte array in my tests, much better than Java&#39;s `URLConnection.guessContentTypeFromStream()` which has proven not very reliable for me.\r\n\r\n\r\n  [1]: https://tika.apache.org/","title":"How to fetch the MIME type from byte array in Java 6?","body":"<p><a href=\"https://tika.apache.org/\" rel=\"nofollow noreferrer\">Apache Tika library</a> is proving to be the most accurate in detecting proper MIME type from a byte array in my tests, much better than Java's <code>URLConnection.guessContentTypeFromStream()</code> which has proven not very reliable for me.</p>\n"}],"owner":{"account_id":7321995,"reputation":148,"user_id":5577718,"display_name":"Dinesh Padmanabhan"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":32460,"favorite_count":0,"down_vote_count":0,"up_vote_count":11,"accepted_answer_id":33998633,"answer_count":3,"score":11,"last_activity_date":1656345103,"creation_date":1448885486,"question_id":33998407,"body_markdown":"I have been trying to figure out how to fetch the *MIME type* from byte array in Java 6, but unfortunately have not been able fetch the MIME type yet.\r\n\r\nCan someone help me get out of this?\r\n","title":"How to fetch the MIME type from byte array in Java 6?","body":"<p>I have been trying to figure out how to fetch the <em>MIME type</em> from byte array in Java 6, but unfortunately have not been able fetch the MIME type yet.</p>\n\n<p>Can someone help me get out of this?</p>\n"},{"tags":["java","exception","runnable","throw"],"comments":[{"owner":{"account_id":1324952,"reputation":5977,"user_id":1270000,"accept_rate":100,"display_name":"sorifiend"},"score":0,"creation_date":1656297948,"post_id":72766457,"comment_id":128529066,"body_markdown":"The run method in the `Runnable` class does not have `throws Exception` so you can not override it like that. To fix this simply remove `throws Exception` from here `public void run() throws Exception {` like so `public void run() {` and instead throw the exception from within the method as you are already doing.","body":"The run method in the <code>Runnable</code> class does not have <code>throws Exception</code> so you can not override it like that. To fix this simply remove <code>throws Exception</code> from here <code>public void run() throws Exception {</code> like so <code>public void run() {</code> and instead throw the exception from within the method as you are already doing."}],"answers":[{"tags":[],"owner":{"account_id":23667337,"reputation":1467,"user_id":17694626,"display_name":"Cheng Thao"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1656297632,"creation_date":1656297632,"answer_id":72766520,"question_id":72766457,"body_markdown":"Looks like a similar question has been asked before:  https://stackoverflow.com/questions/21333260/java-how-to-override-a-method-and-throw-exception\r\n\r\nWould throwing a RuntimeException meet your requirement? \r\n\r\n```\r\n  class ExceptionRunnable implements Runnable {\r\n    @Override\r\n    public void run() {\r\n      throw new RuntimeException(&quot;ExceptionRunnable&quot;);\r\n    }\r\n  }\r\n```","title":"Jdk failed to compile my code that throws exception inside Runnable","body":"<p>Looks like a similar question has been asked before:  <a href=\"https://stackoverflow.com/questions/21333260/java-how-to-override-a-method-and-throw-exception\">Java : How to override a method and throw exception?</a></p>\n<p>Would throwing a RuntimeException meet your requirement?</p>\n<pre><code>  class ExceptionRunnable implements Runnable {\n    @Override\n    public void run() {\n      throw new RuntimeException(&quot;ExceptionRunnable&quot;);\n    }\n  }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":7413926,"reputation":5474,"user_id":11374957,"display_name":"Kaan"},"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1656298441,"creation_date":1656298441,"answer_id":72766584,"question_id":72766457,"body_markdown":"When compiling your code:\r\n```\r\nclass ExceptionRunnable implements Runnable {\r\n    @Override\r\n    public void run() throws Exception {\r\n        throw new Exception(&quot;ExceptionRunnable&quot;);\r\n    }\r\n}\r\n```\r\nThe compiler shows the following error:\r\n```\r\njava: run() in ExceptionRunnable cannot implement run() in java.lang.Runnable\r\n  overridden method does not throw java.lang.Exception\r\n```\r\n\r\nWhy? Because the method you&#39;re overriding - [`Runnable.run()`](https://docs.oracle.com/javase/8/docs/api/java/lang/Runnable.html#run--) - has this signature (note the absence of a `throws` clause):\r\n```\r\nvoid run()\r\n```\r\n\r\nTo fix the first issue then, change your code from this:\r\n```\r\npublic void run() throws Exception {\r\n```\r\nto this, so that the signatures match:\r\n```\r\npublic void run() {\r\n```\r\n\r\nAfter making that change, you will uncover the next compiler error:\r\n```\r\njava: unreported exception java.lang.Exception; must be caught or declared to be thrown\r\n```\r\nThis is saying that your own code is throwing an `Exception` which is both not caught and not declared in the throws clause. You&#39;ve already found that you can&#39;t add it to the throws clause though – that&#39;s what you initially tried to do. So the other option would be to catch the exception in your `run()` method, like below:\r\n```\r\n@Override\r\npublic void run() {\r\n    try {\r\n        throw new Exception(&quot;ExceptionRunnable&quot;);\r\n    } catch (Exception e) {\r\n        e.printStackTrace();\r\n    }\r\n}\r\n```\r\nAnother option would be to throw a [`RuntimeException`](https://docs.oracle.com/javase/8/docs/api/java/lang/RuntimeException.html), like below, but you should _only_ do this with intention, fully understanding what it means to introduce unchecked exceptions into your code.\r\n```\r\n@Override\r\npublic void run() {\r\n    throw new RuntimeException(&quot;ExceptionRunnable&quot;);\r\n}\r\n```\r\n","title":"Jdk failed to compile my code that throws exception inside Runnable","body":"<p>When compiling your code:</p>\n<pre><code>class ExceptionRunnable implements Runnable {\n    @Override\n    public void run() throws Exception {\n        throw new Exception(&quot;ExceptionRunnable&quot;);\n    }\n}\n</code></pre>\n<p>The compiler shows the following error:</p>\n<pre><code>java: run() in ExceptionRunnable cannot implement run() in java.lang.Runnable\n  overridden method does not throw java.lang.Exception\n</code></pre>\n<p>Why? Because the method you're overriding - <a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/Runnable.html#run--\" rel=\"nofollow noreferrer\"><code>Runnable.run()</code></a> - has this signature (note the absence of a <code>throws</code> clause):</p>\n<pre><code>void run()\n</code></pre>\n<p>To fix the first issue then, change your code from this:</p>\n<pre><code>public void run() throws Exception {\n</code></pre>\n<p>to this, so that the signatures match:</p>\n<pre><code>public void run() {\n</code></pre>\n<p>After making that change, you will uncover the next compiler error:</p>\n<pre><code>java: unreported exception java.lang.Exception; must be caught or declared to be thrown\n</code></pre>\n<p>This is saying that your own code is throwing an <code>Exception</code> which is both not caught and not declared in the throws clause. You've already found that you can't add it to the throws clause though – that's what you initially tried to do. So the other option would be to catch the exception in your <code>run()</code> method, like below:</p>\n<pre><code>@Override\npublic void run() {\n    try {\n        throw new Exception(&quot;ExceptionRunnable&quot;);\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n}\n</code></pre>\n<p>Another option would be to throw a <a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/RuntimeException.html\" rel=\"nofollow noreferrer\"><code>RuntimeException</code></a>, like below, but you should <em>only</em> do this with intention, fully understanding what it means to introduce unchecked exceptions into your code.</p>\n<pre><code>@Override\npublic void run() {\n    throw new RuntimeException(&quot;ExceptionRunnable&quot;);\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":23959668,"reputation":26587,"user_id":17949945,"display_name":"Alexander Ivanchenko"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656309050,"creation_date":1656309050,"answer_id":72767461,"question_id":72766457,"body_markdown":"According to the rules of *method overriding* can not declare to throw **checked exceptions** (or their super types up to `Throwable`) that not declared by parent while overriding the method in the subclass. \r\n\r\nA quote from the [*Language specification*](https://docs.oracle.com/javase/specs/jls/se17/html/jls-8.html#jls-8.4.8.3):\r\n\r\n&gt; If m2 has a **throws clause** that mentions any **checked exception** types,\r\n&gt; then m1 must have a throws clause, or a **compile-time error occurs**.\r\n\r\nSuch situation when child has less safe behavior that its parent also voilates the [*Liskov substitution principle*](https://en.wikipedia.org/wiki/Liskov_substitution_principle), which states that client code that expects an instance of the parent should be able to use its child without knowing it. Because in case when child has less safe behavior, the client would not be to handle it with the code that is suitable for the parent.\r\n\r\nSuper type `Exception` is *checked* (i.e. compiler should ensure that it&#39;s handled properly whenever might occur) and method `run()` doesn&#39;t declare to throw any *checked exception*, therefore you can&#39;t override `run()` by including `Exception` in the `throws` close.\r\n\r\nYou can include any type of *unchecked exception* in the `throws` close of `run()`. The code below is valid and would compile:\r\n\r\n    class MyRunnable implements Runnable {\r\n        @Override\r\n        public void run() throws RuntimeException {\r\n            // todo\r\n        }\r\n    }\r\n\r\nAll *checked exceptions* that your code might throw should be handled inside `run()` and can not be propagated to the caller:\r\n\r\n    class MyRunnable implements Runnable {\r\n        @Override\r\n        public void run() throws RuntimeException {\r\n            try {\r\n                Thread.sleep(1_000);\r\n            } catch (InterruptedException e) {\r\n                e.printStackTrace();\r\n            }\r\n        }\r\n    }\r\n\r\n*Note:* avoid declare to `throw` as well as avoid catching super types like `Exception`, or `Throwable`, it&#39;s a bad habit. Be as much specific as it&#39;s possible","title":"Jdk failed to compile my code that throws exception inside Runnable","body":"<p>According to the rules of <em>method overriding</em> can not declare to throw <strong>checked exceptions</strong> (or their super types up to <code>Throwable</code>) that not declared by parent while overriding the method in the subclass.</p>\n<p>A quote from the <a href=\"https://docs.oracle.com/javase/specs/jls/se17/html/jls-8.html#jls-8.4.8.3\" rel=\"nofollow noreferrer\"><em>Language specification</em></a>:</p>\n<blockquote>\n<p>If m2 has a <strong>throws clause</strong> that mentions any <strong>checked exception</strong> types,\nthen m1 must have a throws clause, or a <strong>compile-time error occurs</strong>.</p>\n</blockquote>\n<p>Such situation when child has less safe behavior that its parent also voilates the <a href=\"https://en.wikipedia.org/wiki/Liskov_substitution_principle\" rel=\"nofollow noreferrer\"><em>Liskov substitution principle</em></a>, which states that client code that expects an instance of the parent should be able to use its child without knowing it. Because in case when child has less safe behavior, the client would not be to handle it with the code that is suitable for the parent.</p>\n<p>Super type <code>Exception</code> is <em>checked</em> (i.e. compiler should ensure that it's handled properly whenever might occur) and method <code>run()</code> doesn't declare to throw any <em>checked exception</em>, therefore you can't override <code>run()</code> by including <code>Exception</code> in the <code>throws</code> close.</p>\n<p>You can include any type of <em>unchecked exception</em> in the <code>throws</code> close of <code>run()</code>. The code below is valid and would compile:</p>\n<pre><code>class MyRunnable implements Runnable {\n    @Override\n    public void run() throws RuntimeException {\n        // todo\n    }\n}\n</code></pre>\n<p>All <em>checked exceptions</em> that your code might throw should be handled inside <code>run()</code> and can not be propagated to the caller:</p>\n<pre><code>class MyRunnable implements Runnable {\n    @Override\n    public void run() throws RuntimeException {\n        try {\n            Thread.sleep(1_000);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>\n<p><em>Note:</em> avoid declare to <code>throw</code> as well as avoid catching super types like <code>Exception</code>, or <code>Throwable</code>, it's a bad habit. Be as much specific as it's possible</p>\n"}],"owner":{"account_id":8189476,"reputation":7627,"user_id":6164172,"accept_rate":92,"display_name":"Troskyvs"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":308,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"closed_date":1656325845,"accepted_answer_id":72766584,"answer_count":3,"score":2,"last_activity_date":1656344615,"creation_date":1656296757,"question_id":72766457,"body_markdown":"I&#39;m trying to throw exception from within a Runnable object, like this:\r\n```\r\n  class ExceptionRunnable implements Runnable {\r\n    @Override\r\n    public void run() throws Exception {\r\n      throw new Exception(&quot;ExceptionRunnable&quot;);\r\n    }\r\n  }\r\n```\r\n\r\nCompilation error: xxx.ExceptionRunnable.run() doesn&#39;t implement java.lang.Runnable.run(). The overriden run() doesn&#39;t throw java.lang.InterruptedException.\r\n\r\nThis is really odd, I&#39;m throwing a ```new Exception``` in the ```run``` function, but compiler said I didn&#39;t throw anything. I&#39;m using jdk1.8 on windows.\r\n\r\nHow to handle this?\r\n","title":"Jdk failed to compile my code that throws exception inside Runnable","body":"<p>I'm trying to throw exception from within a Runnable object, like this:</p>\n<pre><code>  class ExceptionRunnable implements Runnable {\n    @Override\n    public void run() throws Exception {\n      throw new Exception(&quot;ExceptionRunnable&quot;);\n    }\n  }\n</code></pre>\n<p>Compilation error: xxx.ExceptionRunnable.run() doesn't implement java.lang.Runnable.run(). The overriden run() doesn't throw java.lang.InterruptedException.</p>\n<p>This is really odd, I'm throwing a <code>new Exception</code> in the <code>run</code> function, but compiler said I didn't throw anything. I'm using jdk1.8 on windows.</p>\n<p>How to handle this?</p>\n"},{"tags":["java","arrays","arraylist"],"answers":[{"tags":[],"owner":{"account_id":10595663,"reputation":4835,"user_id":7804477,"display_name":"Gautham M"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1617616341,"creation_date":1617616341,"answer_id":66951136,"question_id":66950972,"body_markdown":"The line `users.clear();` is causing the issue. \r\n\r\nIn the first iteration you add users 1 and 2 to that list. Then in the constructor you are passing this list.\r\n```java\r\nGroupUserMapping groupUserMapping = new GroupUserMapping(group,users);\r\n```\r\n\r\nNow in the second iteration, you clear the loop and then add users 2 and 3. Since the first group has the reference to the same list, G1&#39;s user list is also cleared and user 2 and 3 are added.\r\n\r\nYou need to replace the `users.clear();` with \r\n```java\r\nusers = new ArrayList&lt;String&gt;();\r\n```\r\n\r\nIn the above case, the data is unchanged, only the `users` variable now points to a different location. Hence there won&#39;t be any changes to the list of G1.","title":"Adding elements to a array list/Pojo","body":"<p>The line <code>users.clear();</code> is causing the issue.</p>\n<p>In the first iteration you add users 1 and 2 to that list. Then in the constructor you are passing this list.</p>\n<pre class=\"lang-java prettyprint-override\"><code>GroupUserMapping groupUserMapping = new GroupUserMapping(group,users);\n</code></pre>\n<p>Now in the second iteration, you clear the loop and then add users 2 and 3. Since the first group has the reference to the same list, G1's user list is also cleared and user 2 and 3 are added.</p>\n<p>You need to replace the <code>users.clear();</code> with</p>\n<pre class=\"lang-java prettyprint-override\"><code>users = new ArrayList&lt;String&gt;();\n</code></pre>\n<p>In the above case, the data is unchanged, only the <code>users</code> variable now points to a different location. Hence there won't be any changes to the list of G1.</p>\n"}],"owner":{"account_id":5832968,"reputation":90,"user_id":4596918,"display_name":"Susmitha Thallapally"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":595,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":66951136,"answer_count":1,"score":1,"last_activity_date":1656344521,"creation_date":1617615629,"question_id":66950972,"body_markdown":"I am having an issue with adding elements to an ArrayList. I created a POJO like my array list.\r\n```\r\npublic class GroupUserMapping {\r\n    String group;\r\n    ArrayList&lt;String&gt; users;\r\n//setters getters constructor\r\n}\r\n```\r\n\r\nI have a function where I am reading a text file to get Groups which I stored in groups array now for those groups I need to loop through all the records in other text file and get all the users who have this group mapping and according to my condition I am trying to add elements to the Pojo ArrayList like this:\r\n```\r\n ArrayList&lt;GroupUserMapping&gt; usergroups = new ArrayList&lt; GroupUserMapping &gt;();\r\n        ArrayList&lt;String&gt; users = new ArrayList&lt;&gt;();\r\n        ArrayList&lt;String&gt; groups = getGroups();// This used for lopping I have certain groups.\r\n        Scanner s = null;\r\n\r\n        String group=&quot;&quot;;\r\n       for(int i= 0;i&lt;groups.size();i++ ){\r\n           s = new Scanner(new File(getClass().getClassLoader().getResource(mappingFile).getFile()));\r\n           s.useDelimiter(&quot;\\r\\n&quot;);\r\n           group=groups.get(i);\r\n           users.clear();\r\n           while (s.hasNext()) {\r\n               String aLine = s.next();\r\n               String[] value = aLine.split(&quot;:&quot;);\r\n\r\n               if(group.equalsIgnoreCase(value[0]))\r\n               {\r\n                   LOGGER.info(group+&quot;:&quot;+value[1]);\r\n                   users.add(value[1]);\r\n               }\r\n           }\r\n            GroupUserMapping groupUserMapping = new GroupUserMapping(group,users);\r\n          \r\n            usergroups.add(groupUserMapping);\r\n           s.close();\r\n```\r\n\r\nThe issue is when I am reading for Group say G1 I got users u1,u2 and these mapping is correctly stored in usergroups but next loop when I am searching for Group G2 I have users U2,U3. Here in the 2nd loop, it is also updating 1st Group values as well. Ideally my elements should be G1-&gt;U1,U2 and G2-&gt; U2,U3 but my code is adding elements like this. G1-&gt;U2,U3  G2-&gt; U2,U3. What I am doing wrong here?","title":"Adding elements to a array list/Pojo","body":"<p>I am having an issue with adding elements to an ArrayList. I created a POJO like my array list.</p>\n<pre><code>public class GroupUserMapping {\n    String group;\n    ArrayList&lt;String&gt; users;\n//setters getters constructor\n}\n</code></pre>\n<p>I have a function where I am reading a text file to get Groups which I stored in groups array now for those groups I need to loop through all the records in other text file and get all the users who have this group mapping and according to my condition I am trying to add elements to the Pojo ArrayList like this:</p>\n<pre><code> ArrayList&lt;GroupUserMapping&gt; usergroups = new ArrayList&lt; GroupUserMapping &gt;();\n        ArrayList&lt;String&gt; users = new ArrayList&lt;&gt;();\n        ArrayList&lt;String&gt; groups = getGroups();// This used for lopping I have certain groups.\n        Scanner s = null;\n\n        String group=&quot;&quot;;\n       for(int i= 0;i&lt;groups.size();i++ ){\n           s = new Scanner(new File(getClass().getClassLoader().getResource(mappingFile).getFile()));\n           s.useDelimiter(&quot;\\r\\n&quot;);\n           group=groups.get(i);\n           users.clear();\n           while (s.hasNext()) {\n               String aLine = s.next();\n               String[] value = aLine.split(&quot;:&quot;);\n\n               if(group.equalsIgnoreCase(value[0]))\n               {\n                   LOGGER.info(group+&quot;:&quot;+value[1]);\n                   users.add(value[1]);\n               }\n           }\n            GroupUserMapping groupUserMapping = new GroupUserMapping(group,users);\n          \n            usergroups.add(groupUserMapping);\n           s.close();\n</code></pre>\n<p>The issue is when I am reading for Group say G1 I got users u1,u2 and these mapping is correctly stored in usergroups but next loop when I am searching for Group G2 I have users U2,U3. Here in the 2nd loop, it is also updating 1st Group values as well. Ideally my elements should be G1-&gt;U1,U2 and G2-&gt; U2,U3 but my code is adding elements like this. G1-&gt;U2,U3  G2-&gt; U2,U3. What I am doing wrong here?</p>\n"},{"tags":["java","kubernetes","quarkus","graalvm","jaeger"],"comments":[{"owner":{"account_id":2922228,"reputation":61034,"user_id":2504224,"display_name":"geoand"},"score":0,"creation_date":1656396309,"post_id":72774603,"comment_id":128554843,"body_markdown":"I vaguely remember someone reporting a similar issue on Github. Have you checked?","body":"I vaguely remember someone reporting a similar issue on Github. Have you checked?"},{"owner":{"account_id":16016597,"reputation":743,"user_id":11559150,"display_name":"Cesar Justo"},"score":0,"creation_date":1656428825,"post_id":72774603,"comment_id":128567349,"body_markdown":"Didn&#39;t get a response anywhere.","body":"Didn&#39;t get a response anywhere."},{"owner":{"account_id":58650,"reputation":3399,"user_id":175554,"accept_rate":40,"display_name":"ozkanpakdil"},"score":0,"creation_date":1656927057,"post_id":72774603,"comment_id":128681842,"body_markdown":"can you put a reproducer in github ?","body":"can you put a reproducer in github ?"}],"owner":{"account_id":16016597,"reputation":743,"user_id":11559150,"display_name":"Cesar Justo"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":138,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1656343432,"creation_date":1656343432,"question_id":72774603,"body_markdown":"I am trying to compile an application in Quarkus Native and monitor it using Jaeger Traicing, however, I am encountering a problem that when compiling it is taking the wrong url and not the one I should use to work with opentracing:\r\n\r\nExample application.properties file:\r\n\r\n    quarkus.datasource.db-kind=oracle\r\n    quarkus.datasource.jdbc.driver=io.opentracing.contrib.jdbc.TracingDriver\r\n    quarkus.datasource.jdbc.url=jdbc:tracing:oracle:thin:@172.28.2.134:1522/IVR\r\n    quarkus.datasource.username=${USERNAME_CONNECTION_BD:xxxxxxxxxxxxx}\r\n    quarkus.datasource.password=${PASSWORD_CONNECTION_BD:xxxxxxxxxx}\r\n    quarkus.http.port=${PORT:8082}\r\n    quarkus.http.ssl-port=${PORT-SSl:8083}\r\n    quarkus.jaeger.service-name=find-puk-code-tracing\r\n    quarkus.jaeger.sampler-type=const\r\n    quarkus.jaeger.sampler-param=1\r\n    quarkus.jaeger.endpoint=${URL_JAEGER:http://10.161.169.24:14268/api/traces}\r\n    quarkus.native.add-all-charsets=true\r\n    quarkus.swagger-ui.path=/api/FindPukCodeBS/swagger-ui\r\n    quarkus.smallrye-openapi.path=/api/FindPukCodeBS/swagger\r\n    quarkus.swagger-ui.always-include=true\r\n\r\n\r\nLocally it works wonderfully, but when I deploy at the kubernetes level it is not taking the url correctly, as follows::\r\n\r\n    quarkus.datasource.jdbc.url=jdbc:tracing:oracle:thin:@172.28.2.134:1522/IVR\r\n\r\nIn the logs that appear to me it seems to take the url without the word tracing, however as you can see at the log level it prints the url that is being passed in the application.properties:\r\n\r\n[![enter image description here][1]][1]\r\n\r\nThat could be happening? I don&#39;t understand, and I don&#39;t have the value burned anywhere, I&#39;m taking it directly from the application.properties.\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/CBm98.png","title":"Quarkus error after compiling native with Jaeger Tracing","body":"<p>I am trying to compile an application in Quarkus Native and monitor it using Jaeger Traicing, however, I am encountering a problem that when compiling it is taking the wrong url and not the one I should use to work with opentracing:</p>\n<p>Example application.properties file:</p>\n<pre><code>quarkus.datasource.db-kind=oracle\nquarkus.datasource.jdbc.driver=io.opentracing.contrib.jdbc.TracingDriver\nquarkus.datasource.jdbc.url=jdbc:tracing:oracle:thin:@172.28.2.134:1522/IVR\nquarkus.datasource.username=${USERNAME_CONNECTION_BD:xxxxxxxxxxxxx}\nquarkus.datasource.password=${PASSWORD_CONNECTION_BD:xxxxxxxxxx}\nquarkus.http.port=${PORT:8082}\nquarkus.http.ssl-port=${PORT-SSl:8083}\nquarkus.jaeger.service-name=find-puk-code-tracing\nquarkus.jaeger.sampler-type=const\nquarkus.jaeger.sampler-param=1\nquarkus.jaeger.endpoint=${URL_JAEGER:http://10.161.169.24:14268/api/traces}\nquarkus.native.add-all-charsets=true\nquarkus.swagger-ui.path=/api/FindPukCodeBS/swagger-ui\nquarkus.smallrye-openapi.path=/api/FindPukCodeBS/swagger\nquarkus.swagger-ui.always-include=true\n</code></pre>\n<p>Locally it works wonderfully, but when I deploy at the kubernetes level it is not taking the url correctly, as follows::</p>\n<pre><code>quarkus.datasource.jdbc.url=jdbc:tracing:oracle:thin:@172.28.2.134:1522/IVR\n</code></pre>\n<p>In the logs that appear to me it seems to take the url without the word tracing, however as you can see at the log level it prints the url that is being passed in the application.properties:</p>\n<p><a href=\"https://i.stack.imgur.com/CBm98.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CBm98.png\" alt=\"enter image description here\" /></a></p>\n<p>That could be happening? I don't understand, and I don't have the value burned anywhere, I'm taking it directly from the application.properties.</p>\n"},{"tags":["java","intellij-idea"],"comments":[{"owner":{"account_id":36734,"reputation":392127,"user_id":104891,"display_name":"CrazyCoder"},"score":0,"creation_date":1656344160,"post_id":72774578,"comment_id":128543193,"body_markdown":"Please provide the [Minimal, Complete, and Verifiable example](https://stackoverflow.com/help/mcve).","body":"Please provide the <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}],"owner":{"account_id":23710186,"reputation":85,"user_id":17732139,"display_name":"Joel"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":70,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1656343348,"creation_date":1656343348,"question_id":72774578,"body_markdown":"I am using IntelliJ and I have project with module called &quot;customers&quot;, now inside this module\r\nthere is a src, testsrc and web folder. Now the src folder is marked as  &quot;Source folder&quot;, \r\n&quot;testsrc&quot; and &quot;web\\testSrc&quot; are marked as Test folders and the web folder is not marked with anything. In this module I am trying from the class located at the `testsrc` folder \r\n :```com.loyalty.constants.MyTest.java``` to import the class from the `web` folder : ```com.data.v2.controller.MyController.java``` and I did this by selecting the folder where the .class file is generated for MyController.java in IntelliJ idea, however during ```ant all``` I get an exception that MyTest.java cannot import MyController.java because it doesn&#39;t know it exists. Importing jars and modules seems fine, but importing folders containing .class files results in the .class not being able to be recognized. Any suggestions or tips how can I solve this issue or where the problem it might be? I have tried invalidating caches but it didnt&#39;t work, also I tried reimporting the project again in IntelliJ .","title":"Class file not imported in the same module","body":"<p>I am using IntelliJ and I have project with module called &quot;customers&quot;, now inside this module\nthere is a src, testsrc and web folder. Now the src folder is marked as  &quot;Source folder&quot;,\n&quot;testsrc&quot; and &quot;web\\testSrc&quot; are marked as Test folders and the web folder is not marked with anything. In this module I am trying from the class located at the <code>testsrc</code> folder\n:<code>com.loyalty.constants.MyTest.java</code> to import the class from the <code>web</code> folder : <code>com.data.v2.controller.MyController.java</code> and I did this by selecting the folder where the .class file is generated for MyController.java in IntelliJ idea, however during <code>ant all</code> I get an exception that MyTest.java cannot import MyController.java because it doesn't know it exists. Importing jars and modules seems fine, but importing folders containing .class files results in the .class not being able to be recognized. Any suggestions or tips how can I solve this issue or where the problem it might be? I have tried invalidating caches but it didnt't work, also I tried reimporting the project again in IntelliJ .</p>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":2843847,"reputation":55833,"user_id":2442804,"accept_rate":80,"display_name":"luk2302"},"score":0,"creation_date":1656340705,"post_id":72773868,"comment_id":128541696,"body_markdown":"Sounds like you are only missing the check for a primitive array!?","body":"Sounds like you are only missing the check for a primitive array!?"}],"answers":[{"tags":[],"owner":{"account_id":23959668,"reputation":26587,"user_id":17949945,"display_name":"Alexander Ivanchenko"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656342682,"creation_date":1656342194,"answer_id":72774297,"question_id":72773868,"body_markdown":"&gt; an `Object` of which I know that it is either a `Collection`, something\r\n&gt; that extends `Object[]` or any **primitive array**\r\n\r\nThe overall problem statement sounds very smelly. Even if you didn&#39;t develop this code, but inherited from your predecessor, I strongly advise you to replace it with something more viable.\r\n\r\nBut you can deal with an array of arbitrary type using reflection:\r\n\r\n```\r\nint[] nums = {1, 2, 3};\r\nObject arr = nums;\r\n\r\nif (!(arr instanceof Collection&lt;?&gt;)) {\r\n    int len = Array.getLength(arr);\r\n    for (int i = 0; i &lt; len; i++) {\r\n        System.out.println(Array.get(arr, i));\r\n    }\r\n}\r\n```\r\n*Output:*\r\n```\r\n1\r\n2\r\n3\r\n```","title":"How to turn an Object that may be an array or any Collection to a String?","body":"<blockquote>\n<p>an <code>Object</code> of which I know that it is either a <code>Collection</code>, something\nthat extends <code>Object[]</code> or any <strong>primitive array</strong></p>\n</blockquote>\n<p>The overall problem statement sounds very smelly. Even if you didn't develop this code, but inherited from your predecessor, I strongly advise you to replace it with something more viable.</p>\n<p>But you can deal with an array of arbitrary type using reflection:</p>\n<pre><code>int[] nums = {1, 2, 3};\nObject arr = nums;\n\nif (!(arr instanceof Collection&lt;?&gt;)) {\n    int len = Array.getLength(arr);\n    for (int i = 0; i &lt; len; i++) {\n        System.out.println(Array.get(arr, i));\n    }\n}\n</code></pre>\n<p><em>Output:</em></p>\n<pre><code>1\n2\n3\n</code></pre>\n"},{"tags":[],"owner":{"account_id":11380920,"reputation":8254,"user_id":8343843,"display_name":"Alexey R."},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656343161,"creation_date":1656343161,"answer_id":72774544,"question_id":72773868,"body_markdown":"You can make a class like `PrintTools` like this:\r\n\r\n```java\r\npublic class PrintTools {\r\n    \r\n    public static String print(Collection c){\r\n        return c.toString();\r\n    }\r\n    \r\n    public static String print(Object... o){\r\n        return Arrays.deepToString(o);\r\n    }\r\n    \r\n}\r\n```\r\n\r\nSo that you will be taken to a proper method depending on argument type.\r\n\r\nSo your test could be the following:\r\n\r\n```java\r\npublic class TestPrintTools {\r\n\r\n    public static void main(String[] args) {\r\n        A[] a1 = {new A(1), new A(2)};\r\n        int[] a2 = {3, 4};\r\n        List&lt;A&gt; a3 = List.of(new A(5), new A(6));\r\n        System.out.println(PrintTools.print(a1));\r\n        System.out.println(PrintTools.print(a2));\r\n        System.out.println(PrintTools.print(a3));\r\n    }\r\n\r\n}\r\n\r\nclass A{\r\n    int a;\r\n\r\n    public A(int a) {\r\n        this.a = a;\r\n    }\r\n\r\n    @Override\r\n    public String toString() {\r\n        return &quot;A{&quot; +\r\n                &quot;a=&quot; + a +\r\n                &#39;}&#39;;\r\n    }\r\n}\r\n```\r\n\r\nwith the output:\r\n\r\n```\r\n[A{a=1}, A{a=2}]\r\n[[3, 4]]\r\n[A{a=5}, A{a=6}]\r\n```","title":"How to turn an Object that may be an array or any Collection to a String?","body":"<p>You can make a class like <code>PrintTools</code> like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class PrintTools {\n    \n    public static String print(Collection c){\n        return c.toString();\n    }\n    \n    public static String print(Object... o){\n        return Arrays.deepToString(o);\n    }\n    \n}\n</code></pre>\n<p>So that you will be taken to a proper method depending on argument type.</p>\n<p>So your test could be the following:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class TestPrintTools {\n\n    public static void main(String[] args) {\n        A[] a1 = {new A(1), new A(2)};\n        int[] a2 = {3, 4};\n        List&lt;A&gt; a3 = List.of(new A(5), new A(6));\n        System.out.println(PrintTools.print(a1));\n        System.out.println(PrintTools.print(a2));\n        System.out.println(PrintTools.print(a3));\n    }\n\n}\n\nclass A{\n    int a;\n\n    public A(int a) {\n        this.a = a;\n    }\n\n    @Override\n    public String toString() {\n        return &quot;A{&quot; +\n                &quot;a=&quot; + a +\n                '}';\n    }\n}\n</code></pre>\n<p>with the output:</p>\n<pre><code>[A{a=1}, A{a=2}]\n[[3, 4]]\n[A{a=5}, A{a=6}]\n</code></pre>\n"}],"owner":{"account_id":23646042,"reputation":447,"user_id":18197654,"display_name":"xtay2"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":50,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1656343161,"creation_date":1656340507,"question_id":72773868,"body_markdown":"I have an Object of which i know that it is either a Collection, something that extends Object[] or any primitive array, and I want to get its String-representation: `[e1, e2, ..., en]`\r\n\r\n - `String.valueOf(object);` Doesn&#39;t work for arrays and foreign Collections with different `toString` methods.\r\n - `object.getClass().isArray() ? Arrays.toString((Object[]) object) : String.valueOf(object);` Throws a ClassCastException when a primitive array gets passed.\r\n - `&quot;[&quot; + Stream.of(object).map(v -&gt; v.toString()).collect(Collectors.joining(&quot;, &quot;)) + &quot;]&quot;;` Interprets the passed object as one element and creates a Stream of that.\r\n\r\nI&#39;m looking for a fast solution, preferably one that doesn&#39;t rely on libraries. And it shouldn&#39;t involve a gigantic if-else/switch block for type checking.\r\n","title":"How to turn an Object that may be an array or any Collection to a String?","body":"<p>I have an Object of which i know that it is either a Collection, something that extends Object[] or any primitive array, and I want to get its String-representation: <code>[e1, e2, ..., en]</code></p>\n<ul>\n<li><code>String.valueOf(object);</code> Doesn't work for arrays and foreign Collections with different <code>toString</code> methods.</li>\n<li><code>object.getClass().isArray() ? Arrays.toString((Object[]) object) : String.valueOf(object);</code> Throws a ClassCastException when a primitive array gets passed.</li>\n<li><code>&quot;[&quot; + Stream.of(object).map(v -&gt; v.toString()).collect(Collectors.joining(&quot;, &quot;)) + &quot;]&quot;;</code> Interprets the passed object as one element and creates a Stream of that.</li>\n</ul>\n<p>I'm looking for a fast solution, preferably one that doesn't rely on libraries. And it shouldn't involve a gigantic if-else/switch block for type checking.</p>\n"},{"tags":["java","eclipse","equals","instanceof"],"comments":[{"owner":{"account_id":33655,"reputation":26403,"user_id":94363,"accept_rate":74,"display_name":"rds"},"score":2,"creation_date":1504694800,"post_id":596462,"comment_id":79106991,"body_markdown":"The expression `x instanceof SomeClass` is false if `x` is `null`. Hence, the second syntax doens&#39;t need the null check.","body":"The expression <code>x instanceof SomeClass</code> is false if <code>x</code> is <code>null</code>. Hence, the second syntax doens&#39;t need the null check."},{"owner":{"account_id":9921,"reputation":107684,"user_id":18511,"accept_rate":92,"display_name":"Kip"},"score":7,"creation_date":1504706275,"post_id":596462,"comment_id":79115563,"body_markdown":"@rds Yes, the paragraph immediately after the code snippet says this as well. It is in the code snippet because that is what Eclipse generates.","body":"@rds Yes, the paragraph immediately after the code snippet says this as well. It is in the code snippet because that is what Eclipse generates."}],"answers":[{"tags":[],"owner":{"account_id":7745,"reputation":189755,"user_id":13531,"accept_rate":75,"display_name":"Michael Myers"},"down_vote_count":2,"up_vote_count":193,"is_accepted":false,"score":191,"last_activity_date":1235766115,"creation_date":1235766115,"answer_id":596507,"question_id":596462,"body_markdown":"[Josh Bloch][1] favors your approach:\r\n\r\n&gt;The reason that I favor the `instanceof` approach is that when you use the `getClass` approach, you have the restriction that objects are only equal to other objects of the same class, the same run time type. If you extend a class and add a couple of innocuous methods to it, then check to see whether some object of the subclass is equal to an object of the super class, even if the objects are equal in all important aspects, you will get the surprising answer that they aren&#39;t equal. In fact, this violates a strict interpretation of the *Liskov substitution principle*, and can lead to very surprising behavior. In Java, it&#39;s particularly important because most of the collections (`HashTable`, etc.) are based on the equals method. If you put a member of the super class in a hash table as the key and then look it up using a subclass instance, you won&#39;t find it, because they are not equal.\r\n\r\nSee also [this SO answer][2].\r\n\r\nEffective Java [chapter 3][3] also covers this.\r\n\r\n\r\n  [1]: http://www.artima.com/intv/bloch17.html\r\n  [2]: https://stackoverflow.com/questions/27581/overriding-equals-and-hashcode-in-java/32223#32223\r\n  [3]: http://java.sun.com/developer/Books/effectivejava/Chapter3.pdf","title":"Any reason to prefer getClass() over instanceof when generating .equals()?","body":"<p><a href=\"http://www.artima.com/intv/bloch17.html\" rel=\"noreferrer\">Josh Bloch</a> favors your approach:</p>\n\n<blockquote>\n  <p>The reason that I favor the <code>instanceof</code> approach is that when you use the <code>getClass</code> approach, you have the restriction that objects are only equal to other objects of the same class, the same run time type. If you extend a class and add a couple of innocuous methods to it, then check to see whether some object of the subclass is equal to an object of the super class, even if the objects are equal in all important aspects, you will get the surprising answer that they aren't equal. In fact, this violates a strict interpretation of the <em>Liskov substitution principle</em>, and can lead to very surprising behavior. In Java, it's particularly important because most of the collections (<code>HashTable</code>, etc.) are based on the equals method. If you put a member of the super class in a hash table as the key and then look it up using a subclass instance, you won't find it, because they are not equal.</p>\n</blockquote>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/27581/overriding-equals-and-hashcode-in-java/32223#32223\">this SO answer</a>.</p>\n\n<p>Effective Java <a href=\"http://java.sun.com/developer/Books/effectivejava/Chapter3.pdf\" rel=\"noreferrer\">chapter 3</a> also covers this.</p>\n"},{"tags":[],"owner":{"account_id":25027,"reputation":9018,"user_id":64044,"display_name":"Clint"},"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1235766288,"creation_date":1235766288,"answer_id":596524,"question_id":596462,"body_markdown":"If you want to ensure only that class will match then use `getClass() ==`.  If you want to match subclasses then `instanceof` is needed.\r\n\r\nAlso, instanceof will not match against a null but is safe to compare against a null.  So you don&#39;t have to null check it.\r\n\r\n    if ( ! (obj instanceof MyClass) ) { return false; }","title":"Any reason to prefer getClass() over instanceof when generating .equals()?","body":"<p>If you want to ensure only that class will match then use <code>getClass() ==</code>.  If you want to match subclasses then <code>instanceof</code> is needed.</p>\n\n<p>Also, instanceof will not match against a null but is safe to compare against a null.  So you don't have to null check it.</p>\n\n<pre><code>if ( ! (obj instanceof MyClass) ) { return false; }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":23234,"reputation":34600,"user_id":58082,"accept_rate":78,"display_name":"Pierre"},"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1235766319,"creation_date":1235766319,"answer_id":596530,"question_id":596462,"body_markdown":"It depends if you consider if a subclass of a given class is equals to its parent.\r\n\r\n    class LastName\r\n    {\r\n    (...)\r\n    }\r\n    \r\n    \r\n    class FamilyName\r\n    extends LastName\r\n    {\r\n    (..)\r\n    }\r\n\r\nhere I would use &#39;instanceof&#39;, because I want a LastName to be compared to FamilyName\r\n\r\n    class Organism\r\n    {\r\n    }\r\n    \r\n    class Gorilla extends Organism\r\n    {\r\n    }\r\n\r\n\r\nhere I would use &#39;getClass&#39;, because the class already says that the two instances are not equivalent.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","title":"Any reason to prefer getClass() over instanceof when generating .equals()?","body":"<p>It depends if you consider if a subclass of a given class is equals to its parent.</p>\n\n<pre><code>class LastName\n{\n(...)\n}\n\n\nclass FamilyName\nextends LastName\n{\n(..)\n}\n</code></pre>\n\n<p>here I would use 'instanceof', because I want a LastName to be compared to FamilyName</p>\n\n<pre><code>class Organism\n{\n}\n\nclass Gorilla extends Organism\n{\n}\n</code></pre>\n\n<p>here I would use 'getClass', because the class already says that the two instances are not equivalent.</p>\n"},{"tags":[],"owner":{"account_id":10836,"reputation":196641,"user_id":20654,"accept_rate":80,"display_name":"OscarRyz"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1235766809,"creation_date":1235766809,"answer_id":596558,"question_id":596462,"body_markdown":"**instanceof** works for instences of the same class **or** its subclasses\r\n\r\n&gt;*You can use it to test if an object is an instance of a class, an instance of a subclass, or an instance of a class that implements a particular interface.*\r\n\r\n\r\nArryaList and RoleList are both **instanceof** List\r\n\r\nWhile \r\n\r\n\r\n**getClass() == o.getClass()** will be  true only if both objects ( this and o ) belongs to exactly the same class.\r\n\r\n\r\nSo depending on what you need to compare you could use one or the other. \r\n\r\nIf your logic is: &quot;One objects is equals to other only if they are both the same class&quot; you should go for the &quot;equals&quot;, which I think is most of the cases. ","title":"Any reason to prefer getClass() over instanceof when generating .equals()?","body":"<p><strong>instanceof</strong> works for instences of the same class <strong>or</strong> its subclasses</p>\n\n<blockquote>\n  <p><em>You can use it to test if an object is an instance of a class, an instance of a subclass, or an instance of a class that implements a particular interface.</em></p>\n</blockquote>\n\n<p>ArryaList and RoleList are both <strong>instanceof</strong> List</p>\n\n<p>While </p>\n\n<p><strong>getClass() == o.getClass()</strong> will be  true only if both objects ( this and o ) belongs to exactly the same class.</p>\n\n<p>So depending on what you need to compare you could use one or the other. </p>\n\n<p>If your logic is: \"One objects is equals to other only if they are both the same class\" you should go for the \"equals\", which I think is most of the cases. </p>\n"},{"tags":[],"owner":{"account_id":2496,"reputation":266234,"user_id":3474,"accept_rate":83,"display_name":"erickson"},"down_vote_count":2,"up_vote_count":112,"is_accepted":true,"score":110,"last_activity_date":1656342877,"creation_date":1235769111,"answer_id":596707,"question_id":596462,"body_markdown":"If you use `instanceof`, making your `equals` implementation `final` will preserve the symmetry contract of the method: `x.equals(y) == y.equals(x)`. If `final` seems restrictive, carefully examine your notion of object equivalence to make sure that your overriding implementations fully maintain the contract established by the `Object` class.\r\n\r\n---\r\n\r\nWhat I&#39;m trying to get at here is that if you believe `getClass()` is the only reliable way to preserve symmetry, you are probably using `equals()` the wrong way. \r\n\r\nSure, it&#39;s easy to use `getClass()` to preserve the symmetry required of `equals()`, but only because `x.equals(y)` and `y.equals(x)` are always false. Liskov substitutability would encourage you to find a symmetry-preserving implementation that can yield `true` when it makes sense. If a subclass has a radically different notion of equality, is it really a subclass?","title":"Any reason to prefer getClass() over instanceof when generating .equals()?","body":"<p>If you use <code>instanceof</code>, making your <code>equals</code> implementation <code>final</code> will preserve the symmetry contract of the method: <code>x.equals(y) == y.equals(x)</code>. If <code>final</code> seems restrictive, carefully examine your notion of object equivalence to make sure that your overriding implementations fully maintain the contract established by the <code>Object</code> class.</p>\n<hr />\n<p>What I'm trying to get at here is that if you believe <code>getClass()</code> is the only reliable way to preserve symmetry, you are probably using <code>equals()</code> the wrong way.</p>\n<p>Sure, it's easy to use <code>getClass()</code> to preserve the symmetry required of <code>equals()</code>, but only because <code>x.equals(y)</code> and <code>y.equals(x)</code> are always false. Liskov substitutability would encourage you to find a symmetry-preserving implementation that can yield <code>true</code> when it makes sense. If a subclass has a radically different notion of equality, is it really a subclass?</p>\n"},{"tags":[],"owner":{"account_id":12404,"reputation":62016,"user_id":24396,"accept_rate":74,"display_name":"Steve Kuo"},"down_vote_count":1,"up_vote_count":71,"is_accepted":false,"score":70,"last_activity_date":1360336837,"creation_date":1235770461,"answer_id":596766,"question_id":596462,"body_markdown":"The reason to use `getClass` is to ensure the symmetric property of the `equals` contract. From equals&#39; JavaDocs:\r\n\r\n&gt; It is symmetric: for any non-null\r\n&gt; reference values x and y, x.equals(y)\r\n&gt; should return true if and only if\r\n&gt; y.equals(x) returns true.\r\n\r\nBy using instanceof, it&#39;s possible to not be symmetric. Consider the example:\r\nDog extends Animal.\r\nAnimal&#39;s `equals` does an `instanceof` check of Animal.\r\nDog&#39;s `equals` does an `instanceof` check of Dog.\r\nGive Animal **a** and Dog **d** (with other fields the same):\r\n\r\n    a.equals(d) --&gt; true\r\n    d.equals(a) --&gt; false\r\n\r\nThis violates the symmetric property.\r\n\r\nTo strictly follow equal&#39;s contract, symmetry must be ensured, and thus the class needs to be the same.\r\n\r\n","title":"Any reason to prefer getClass() over instanceof when generating .equals()?","body":"<p>The reason to use <code>getClass</code> is to ensure the symmetric property of the <code>equals</code> contract. From equals' JavaDocs:</p>\n\n<blockquote>\n  <p>It is symmetric: for any non-null\n  reference values x and y, x.equals(y)\n  should return true if and only if\n  y.equals(x) returns true.</p>\n</blockquote>\n\n<p>By using instanceof, it's possible to not be symmetric. Consider the example:\nDog extends Animal.\nAnimal's <code>equals</code> does an <code>instanceof</code> check of Animal.\nDog's <code>equals</code> does an <code>instanceof</code> check of Dog.\nGive Animal <strong>a</strong> and Dog <strong>d</strong> (with other fields the same):</p>\n\n<pre><code>a.equals(d) --&gt; true\nd.equals(a) --&gt; false\n</code></pre>\n\n<p>This violates the symmetric property.</p>\n\n<p>To strictly follow equal's contract, symmetry must be ensured, and thus the class needs to be the same.</p>\n"},{"tags":[],"owner":{"account_id":16029,"reputation":498825,"user_id":34509,"accept_rate":62,"display_name":"Johannes Schaub - litb"},"down_vote_count":0,"up_vote_count":70,"is_accepted":false,"score":70,"last_activity_date":1235771902,"creation_date":1235771559,"answer_id":596828,"question_id":596462,"body_markdown":"Angelika Langers [**Secrets of equals**](http://www.angelikalanger.com/Articles/JavaSolutions/SecretsOfEquals/Equals.html) gets into that with a long and detailed discussion for a few common and well-known examples, including by Josh Bloch and Barbara Liskov, discovering a couple of problems in most of them. She also gets into the `instanceof` vs `getClass`. Some quote from it\n\n&gt; Conclusions\n&gt;\n&gt; Having dissected the four arbitrarily chosen examples of implementations of equals() , what do we conclude?\n&gt;\n&gt; First of all: there are two substantially different ways of performing the check for type match in an implementation of equals() . A class can allow mixed-type comparison between super- and subclass objects by means of the instanceof operator, or a class can treat objects of different type as non-equal by means of the getClass() test. The examples above illustrated nicely that implementations of equals() using getClass() are generally more robust than those implementations using instanceof .\n&gt;\n&gt; The instanceof test is correct only for final classes or if at least method equals() is final in a superclass. The latter essentially implies that no subclass must extend the superclass&#39;s state, but can only add functionality or fields that are irrelevant for the object&#39;s state and behavior, such as transient or static fields.\n&gt;\n&gt; Implementations using the getClass() test on the other hand always comply to the equals() contract; they are correct and robust. They are, however, semantically very different from implementations that use the instanceof test. Implementations using getClass() do not allow comparison of sub- with superclass objects, not even when the subclass does not add any fields and would not even want to override equals() . Such a &quot;trivial&quot; class extension would for instance be the addition of a debug-print method in a subclass defined for exactly this &quot;trivial&quot; purpose. If the superclass prohibits mixed-type comparison via the getClass() check, then the trivial extension would not be comparable to its superclass. Whether or not this is a problem fully depends on the semantics of the class and the purpose of the extension. ","title":"Any reason to prefer getClass() over instanceof when generating .equals()?","body":"<p>Angelika Langers <a href=\"http://www.angelikalanger.com/Articles/JavaSolutions/SecretsOfEquals/Equals.html\" rel=\"noreferrer\"><strong>Secrets of equals</strong></a> gets into that with a long and detailed discussion for a few common and well-known examples, including by Josh Bloch and Barbara Liskov, discovering a couple of problems in most of them. She also gets into the <code>instanceof</code> vs <code>getClass</code>. Some quote from it</p>\n<blockquote>\n<p>Conclusions</p>\n<p>Having dissected the four arbitrarily chosen examples of implementations of equals() , what do we conclude?</p>\n<p>First of all: there are two substantially different ways of performing the check for type match in an implementation of equals() . A class can allow mixed-type comparison between super- and subclass objects by means of the instanceof operator, or a class can treat objects of different type as non-equal by means of the getClass() test. The examples above illustrated nicely that implementations of equals() using getClass() are generally more robust than those implementations using instanceof .</p>\n<p>The instanceof test is correct only for final classes or if at least method equals() is final in a superclass. The latter essentially implies that no subclass must extend the superclass's state, but can only add functionality or fields that are irrelevant for the object's state and behavior, such as transient or static fields.</p>\n<p>Implementations using the getClass() test on the other hand always comply to the equals() contract; they are correct and robust. They are, however, semantically very different from implementations that use the instanceof test. Implementations using getClass() do not allow comparison of sub- with superclass objects, not even when the subclass does not add any fields and would not even want to override equals() . Such a &quot;trivial&quot; class extension would for instance be the addition of a debug-print method in a subclass defined for exactly this &quot;trivial&quot; purpose. If the superclass prohibits mixed-type comparison via the getClass() check, then the trivial extension would not be comparable to its superclass. Whether or not this is a problem fully depends on the semantics of the class and the purpose of the extension.</p>\n</blockquote>\n"},{"tags":[],"owner":{"account_id":18062,"reputation":2058,"user_id":41039,"display_name":"James"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1235772370,"creation_date":1235772370,"answer_id":596869,"question_id":596462,"body_markdown":"Both methods have their problems.  \r\n\r\nIf the subclass changes the identity, then you need to compare their actual classes.  Otherwise, you violate the symmetric property.  For instance, different types of `Person`s should not be considered equivalent, even if they have the same name.\r\n\r\nHowever, some subclasses don&#39;t change identity and these need to use `instanceof`.  For instance, if we have a bunch of immutable `Shape` objects, then a `Rectangle` with length and width of 1 should be equal to the unit `Square`.\r\n\r\nIn practice, I think the former case is more likely to be true.  Usually, subclassing is a fundamental part of your identity and being exactly like your parent except you can do one little thing does not make you equal.","title":"Any reason to prefer getClass() over instanceof when generating .equals()?","body":"<p>Both methods have their problems.  </p>\n\n<p>If the subclass changes the identity, then you need to compare their actual classes.  Otherwise, you violate the symmetric property.  For instance, different types of <code>Person</code>s should not be considered equivalent, even if they have the same name.</p>\n\n<p>However, some subclasses don't change identity and these need to use <code>instanceof</code>.  For instance, if we have a bunch of immutable <code>Shape</code> objects, then a <code>Rectangle</code> with length and width of 1 should be equal to the unit <code>Square</code>.</p>\n\n<p>In practice, I think the former case is more likely to be true.  Usually, subclassing is a fundamental part of your identity and being exactly like your parent except you can do one little thing does not make you equal.</p>\n"},{"tags":[],"owner":{"account_id":246,"reputation":107903,"user_id":304,"accept_rate":40,"display_name":"McDowell"},"down_vote_count":1,"up_vote_count":29,"is_accepted":false,"score":28,"last_activity_date":1429098409,"creation_date":1235772914,"answer_id":596885,"question_id":596462,"body_markdown":"This is something of a religious debate. Both approaches have their problems.\r\n\r\n - Use *instanceof* and you can never add significant members to subclasses.\r\n - Use *getClass* and you violate the Liskov substitution principle.\r\n\r\n[Bloch][1] has another relevant piece of advice in [Effective Java Second Edition][2]:\r\n\r\n - **Item 17: Design and document for inheritance or prohibit it**\r\n\r\n\r\n  [1]: http://en.wikipedia.org/wiki/Joshua_Bloch\r\n  [2]: http://wayback.archive.org/web/20100827151804/http://java.sun.com/docs/books/effective/","title":"Any reason to prefer getClass() over instanceof when generating .equals()?","body":"<p>This is something of a religious debate. Both approaches have their problems.</p>\n\n<ul>\n<li>Use <em>instanceof</em> and you can never add significant members to subclasses.</li>\n<li>Use <em>getClass</em> and you violate the Liskov substitution principle.</li>\n</ul>\n\n<p><a href=\"http://en.wikipedia.org/wiki/Joshua_Bloch\" rel=\"noreferrer\">Bloch</a> has another relevant piece of advice in <a href=\"http://wayback.archive.org/web/20100827151804/http://java.sun.com/docs/books/effective/\" rel=\"noreferrer\">Effective Java Second Edition</a>:</p>\n\n<ul>\n<li><strong>Item 17: Design and document for inheritance or prohibit it</strong></li>\n</ul>\n"},{"tags":[],"owner":{"account_id":42768,"reputation":6215,"user_id":124708,"accept_rate":79,"display_name":"TraderJoeChicago"},"down_vote_count":0,"up_vote_count":25,"is_accepted":false,"score":25,"last_activity_date":1405209721,"creation_date":1319605414,"answer_id":7898885,"question_id":596462,"body_markdown":"Correct me if I am wrong, but getClass() will be useful when you want to make sure your instance is NOT a subclass of the class you are comparing with. If you use instanceof in that situation you can NOT know that because:\r\n\r\n    class A { }\r\n    \r\n    class B extends A { }\r\n    \r\n    Object oA = new A();\r\n    Object oB = new B();\r\n    \r\n    oA instanceof A =&gt; true\r\n    oA instanceof B =&gt; false\r\n    oB instanceof A =&gt; true // &lt;================ HERE\r\n    oB instanceof B =&gt; true\r\n    \r\n    oA.getClass().equals(A.class) =&gt; true\r\n    oA.getClass().equals(B.class) =&gt; false\r\n    oB.getClass().equals(A.class) =&gt; false // &lt;===============HERE\r\n    oB.getClass().equals(B.class) =&gt; true\r\n\r\n","title":"Any reason to prefer getClass() over instanceof when generating .equals()?","body":"<p>Correct me if I am wrong, but getClass() will be useful when you want to make sure your instance is NOT a subclass of the class you are comparing with. If you use instanceof in that situation you can NOT know that because:</p>\n\n<pre><code>class A { }\n\nclass B extends A { }\n\nObject oA = new A();\nObject oB = new B();\n\noA instanceof A =&gt; true\noA instanceof B =&gt; false\noB instanceof A =&gt; true // &lt;================ HERE\noB instanceof B =&gt; true\n\noA.getClass().equals(A.class) =&gt; true\noA.getClass().equals(B.class) =&gt; false\noB.getClass().equals(A.class) =&gt; false // &lt;===============HERE\noB.getClass().equals(B.class) =&gt; true\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1861044,"reputation":1917,"user_id":1901896,"display_name":"Akash5288"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1448976452,"creation_date":1448976452,"answer_id":34021603,"question_id":596462,"body_markdown":"Actually instanceof check where an object belongs to some hierarchy or not. ex: Car object belongs to Vehical class. So &quot;new Car() instance of Vehical&quot; returns true. And &quot;new Car().getClass().equals(Vehical.class)&quot; return false, though Car object belongs to Vehical class but it&#39;s categorized as a separate type.","title":"Any reason to prefer getClass() over instanceof when generating .equals()?","body":"<p>Actually instanceof check where an object belongs to some hierarchy or not. ex: Car object belongs to Vehical class. So \"new Car() instance of Vehical\" returns true. And \"new Car().getClass().equals(Vehical.class)\" return false, though Car object belongs to Vehical class but it's categorized as a separate type.</p>\n"}],"owner":{"account_id":9921,"reputation":107684,"user_id":18511,"accept_rate":92,"display_name":"Kip"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":142417,"favorite_count":0,"down_vote_count":0,"up_vote_count":197,"accepted_answer_id":596707,"answer_count":11,"score":197,"last_activity_date":1656342877,"creation_date":1235765677,"question_id":596462,"body_markdown":"I&#39;m using Eclipse to generate `.equals()` and `.hashCode()`, and there is an option labeled &quot;Use &#39;instanceof&#39; to compare types&quot;.  The default is for this option to be unchecked and use `.getClass()` to compare types.  Is there any reason I should prefer `.getClass()` over `instanceof`?\r\n\r\nWithout using `instanceof`:\r\n\r\n    if (obj == null)\r\n      return false;\r\n    if (getClass() != obj.getClass())\r\n      return false;\r\n\r\nUsing `instanceof`:\r\n\r\n    if (obj == null)\r\n      return false;\r\n    if (!(obj instanceof MyClass))\r\n      return false;\r\n\r\nI usually check the `instanceof` option, and then go in and remove the &quot;`if (obj == null)`&quot; check. (It is redundant since null objects will always fail `instanceof`.)  Is there any reason that&#39;s a bad idea?","title":"Any reason to prefer getClass() over instanceof when generating .equals()?","body":"<p>I'm using Eclipse to generate <code>.equals()</code> and <code>.hashCode()</code>, and there is an option labeled \"Use 'instanceof' to compare types\".  The default is for this option to be unchecked and use <code>.getClass()</code> to compare types.  Is there any reason I should prefer <code>.getClass()</code> over <code>instanceof</code>?</p>\n\n<p>Without using <code>instanceof</code>:</p>\n\n<pre><code>if (obj == null)\n  return false;\nif (getClass() != obj.getClass())\n  return false;\n</code></pre>\n\n<p>Using <code>instanceof</code>:</p>\n\n<pre><code>if (obj == null)\n  return false;\nif (!(obj instanceof MyClass))\n  return false;\n</code></pre>\n\n<p>I usually check the <code>instanceof</code> option, and then go in and remove the \"<code>if (obj == null)</code>\" check. (It is redundant since null objects will always fail <code>instanceof</code>.)  Is there any reason that's a bad idea?</p>\n"},{"tags":["java","spring-webflux"],"answers":[{"tags":[],"owner":{"account_id":12455565,"reputation":5317,"user_id":9068895,"display_name":"Alex"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656342522,"creation_date":1655138528,"answer_id":72606284,"question_id":72601314,"body_markdown":"You could use [`WebTestClient`](https://spring.getdocs.org/en-US/spring-framework-docs/docs/testing/integration-testing/webtestclient.html) that provides fluent API for verifying responses. Here is a short example\r\n\r\n```\r\n@WebFluxTest\r\nclass ControllerTest {\r\n\r\n    @Autowired\r\n    private WebTestClient client;\r\n\r\n    @BeforeEach\r\n    void setUp(ApplicationContext context) {\r\n        client = WebTestClient.bindToApplicationContext(context).build();\r\n    }\r\n\r\n    @Test\r\n    void test() {\r\n        client.get()\r\n                .uri(&quot;/test&quot;)\r\n                .exchange()\r\n                .expectStatus().isOk()\r\n                .expectBody().isEmpty();\r\n    }\r\n}\r\n```\r\n\r\nIn addition, pay attention to endpoint implementation. In reactive you need to build the flow and Webflux will subscribe to it for every request. In case, `service.functionName` is blocking (non-reactive), consider running it on a separate `Scheduler` using `.subscribeOn(Schedulers.boundedElastic())`. For details, check [How Do I Wrap a Synchronous, Blocking Call?](https://projectreactor.io/docs/core/release/reference/#faq.wrap-blocking).\r\n\r\nIf the `Callable` resolves to `null`, the resulting `Mono` completes empty and we could return `404` applying `switchIfEmpty` operator. \r\n\r\n\r\n\r\n```\r\n@GetMapping(path = &quot;/test&quot;)\r\npublic Mono&lt;ResponseEntity&lt;Void&gt;&gt; functionName(Request request) {\r\n    return Mono.fromCallable(() -&gt; {\r\n                RequestDto Dto = RequestMapper.INSTANCE.toDto(request);\r\n                return service.functionName(Dto);\r\n            }).subscribeOn(Schedulers.boundedElastic())\r\n            .map(res -&gt; new ResponseEntity&lt;&gt;(HttpStatus.OK))\r\n            .switchIfEmpty(Mono.just(new ResponseEntity&lt;&gt;(HttpStatus.NOT_FOUND)));\r\n}\r\n```","title":"How to test Controller that returns Mono&lt;ResponseEntity&lt;Void&gt;&gt;?","body":"<p>You could use <a href=\"https://spring.getdocs.org/en-US/spring-framework-docs/docs/testing/integration-testing/webtestclient.html\" rel=\"nofollow noreferrer\"><code>WebTestClient</code></a> that provides fluent API for verifying responses. Here is a short example</p>\n<pre><code>@WebFluxTest\nclass ControllerTest {\n\n    @Autowired\n    private WebTestClient client;\n\n    @BeforeEach\n    void setUp(ApplicationContext context) {\n        client = WebTestClient.bindToApplicationContext(context).build();\n    }\n\n    @Test\n    void test() {\n        client.get()\n                .uri(&quot;/test&quot;)\n                .exchange()\n                .expectStatus().isOk()\n                .expectBody().isEmpty();\n    }\n}\n</code></pre>\n<p>In addition, pay attention to endpoint implementation. In reactive you need to build the flow and Webflux will subscribe to it for every request. In case, <code>service.functionName</code> is blocking (non-reactive), consider running it on a separate <code>Scheduler</code> using <code>.subscribeOn(Schedulers.boundedElastic())</code>. For details, check <a href=\"https://projectreactor.io/docs/core/release/reference/#faq.wrap-blocking\" rel=\"nofollow noreferrer\">How Do I Wrap a Synchronous, Blocking Call?</a>.</p>\n<p>If the <code>Callable</code> resolves to <code>null</code>, the resulting <code>Mono</code> completes empty and we could return <code>404</code> applying <code>switchIfEmpty</code> operator.</p>\n<pre><code>@GetMapping(path = &quot;/test&quot;)\npublic Mono&lt;ResponseEntity&lt;Void&gt;&gt; functionName(Request request) {\n    return Mono.fromCallable(() -&gt; {\n                RequestDto Dto = RequestMapper.INSTANCE.toDto(request);\n                return service.functionName(Dto);\n            }).subscribeOn(Schedulers.boundedElastic())\n            .map(res -&gt; new ResponseEntity&lt;&gt;(HttpStatus.OK))\n            .switchIfEmpty(Mono.just(new ResponseEntity&lt;&gt;(HttpStatus.NOT_FOUND)));\n}\n</code></pre>\n"}],"owner":{"account_id":14208164,"reputation":3,"user_id":10264145,"display_name":"Swadib Patro"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":1398,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1656342522,"creation_date":1655116096,"question_id":72601314,"body_markdown":"I&#39;m pretty new to webflux and I am struggling to understand how to test this Controller function.\r\n\r\n        public Mono&lt;ResponseEntity&lt;Void&gt;&gt; functionName(final Request request) {\r\n        RequestDto Dto = RequestMapper.\r\n                INSTANCE.toDto(request);\r\n        service.functionName(Dto);\r\n        return Mono.just(new ResponseEntity&lt;Void&gt;(HttpStatus.OK));\r\n    }\r\n","title":"How to test Controller that returns Mono&lt;ResponseEntity&lt;Void&gt;&gt;?","body":"<p>I'm pretty new to webflux and I am struggling to understand how to test this Controller function.</p>\n<pre><code>    public Mono&lt;ResponseEntity&lt;Void&gt;&gt; functionName(final Request request) {\n    RequestDto Dto = RequestMapper.\n            INSTANCE.toDto(request);\n    service.functionName(Dto);\n    return Mono.just(new ResponseEntity&lt;Void&gt;(HttpStatus.OK));\n}\n</code></pre>\n"},{"tags":["java","android"],"comments":[{"owner":{"account_id":19823229,"reputation":1402,"user_id":14519278,"display_name":"Mahi"},"score":0,"creation_date":1656343694,"post_id":72774326,"comment_id":128543036,"body_markdown":"So &quot;welcome to notes&quot; created twice?","body":"So &quot;welcome to notes&quot; created twice?"},{"owner":{"account_id":3212023,"reputation":1016,"user_id":17856705,"display_name":"Computable"},"score":0,"creation_date":1656344705,"post_id":72774326,"comment_id":128543392,"body_markdown":"Where do you actually save the shared preferences when you add the &quot;Welcome&quot; note?","body":"Where do you actually save the shared preferences when you add the &quot;Welcome&quot; note?"},{"owner":{"account_id":23942675,"reputation":9,"user_id":17935487,"display_name":"Culann Brown"},"score":0,"creation_date":1656345624,"post_id":72774326,"comment_id":128543722,"body_markdown":"@Mahi It is actually making it after every time I create a new note","body":"@Mahi It is actually making it after every time I create a new note"},{"owner":{"account_id":23942675,"reputation":9,"user_id":17935487,"display_name":"Culann Brown"},"score":0,"creation_date":1656345685,"post_id":72774326,"comment_id":128543742,"body_markdown":"@Gardener full code https://pastebin.com/MiTGLu7j","body":"@Gardener full code <a href=\"https://pastebin.com/MiTGLu7j\" rel=\"nofollow noreferrer\">pastebin.com/MiTGLu7j</a>"},{"owner":{"account_id":9172301,"reputation":4168,"user_id":6819340,"accept_rate":39,"display_name":"darshan"},"score":0,"creation_date":1656355458,"post_id":72774326,"comment_id":128547206,"body_markdown":"Can you post the relevant code where you insert the newly created note to the sharedpreferences?","body":"Can you post the relevant code where you insert the newly created note to the sharedpreferences?"}],"owner":{"account_id":23942675,"reputation":9,"user_id":17935487,"display_name":"Culann Brown"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":37,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1656342294,"creation_date":1656342294,"question_id":72774326,"body_markdown":"I am having a problem when creating a new note that it creates a secondary note. Every time that says welcome to notes, it&#39;s only supposed to create that note only once wants the app is installed. Can anyone help me out?\r\n```java\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_main);\r\n        FloatingActionButton fab = findViewById(R.id.fab);\r\n        fab.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                setContentView(R.layout.activity_note_editor);\r\n                // Going from MainActivity to NotesEditorActivity\r\n                Intent intent = new Intent(getApplicationContext(), NoteEditorActivity.class);\r\n                startActivity(intent);\r\n            }\r\n        });\r\n        ListView listView = findViewById(R.id.listView);\r\n        SharedPreferences sharedPreferences = getApplicationContext().getSharedPreferences(&quot;com.echodev.Notes&quot;, Context.MODE_PRIVATE);\r\n        HashSet&lt;String&gt; set = (HashSet&lt;String&gt;) sharedPreferences.getStringSet(&quot;notes&quot;, null);\r\n\r\n        if (set == null) {\r\n\r\n            notes.add(&quot;Welcome To Notes!!!!!&quot;);\r\n        } else {\r\n            notes = new ArrayList(set);\r\n        }","title":"Secondary note being added Android studio","body":"<p>I am having a problem when creating a new note that it creates a secondary note. Every time that says welcome to notes, it's only supposed to create that note only once wants the app is installed. Can anyone help me out?</p>\n<pre class=\"lang-java prettyprint-override\"><code>    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n        FloatingActionButton fab = findViewById(R.id.fab);\n        fab.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View view) {\n                setContentView(R.layout.activity_note_editor);\n                // Going from MainActivity to NotesEditorActivity\n                Intent intent = new Intent(getApplicationContext(), NoteEditorActivity.class);\n                startActivity(intent);\n            }\n        });\n        ListView listView = findViewById(R.id.listView);\n        SharedPreferences sharedPreferences = getApplicationContext().getSharedPreferences(&quot;com.echodev.Notes&quot;, Context.MODE_PRIVATE);\n        HashSet&lt;String&gt; set = (HashSet&lt;String&gt;) sharedPreferences.getStringSet(&quot;notes&quot;, null);\n\n        if (set == null) {\n\n            notes.add(&quot;Welcome To Notes!!!!!&quot;);\n        } else {\n            notes = new ArrayList(set);\n        }\n</code></pre>\n"},{"tags":["java","json"],"comments":[{"owner":{"account_id":9921486,"reputation":5699,"user_id":7344445,"display_name":"Atif AbbAsi"},"score":0,"creation_date":1656342174,"post_id":72774226,"comment_id":128542381,"body_markdown":"compare hash...","body":"compare hash..."},{"owner":{"account_id":10944927,"reputation":491,"user_id":8043392,"display_name":"Shivaji Pote"},"score":0,"creation_date":1656344312,"post_id":72774226,"comment_id":128543250,"body_markdown":"You can use gson/jackson library. [This](https://www.baeldung.com/jackson-compare-two-json-objects) article might help you","body":"You can use gson/jackson library. <a href=\"https://www.baeldung.com/jackson-compare-two-json-objects\" rel=\"nofollow noreferrer\">This</a> article might help you"}],"owner":{"account_id":19047336,"reputation":195,"user_id":13906258,"display_name":"user13906258"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":145,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1656341895,"creation_date":1656341895,"question_id":72774226,"body_markdown":"I have sample transaction json like below\r\n\r\n    {\r\n    \t&quot;payload&quot;: {\r\n    \t\t&quot;header&quot;: [\r\n    \t\t\t{\r\n    \t\t\t\t&quot;messageId&quot;: &quot;10a0df00-c55c-4147-a3bf-e10dc9882768&quot;,\r\n    \t\t\t\t&quot;transactionId&quot;: &quot;10000001&quot;,\r\n    \t\t\t\t&quot;customerId&quot;: &quot;customer4148&quot;,\r\n    \t\t\t\t&quot;customerGroupId&quot;: &quot;USA&quot;,\r\n    \t\t\t\t&quot;transactionStatus&quot;: &quot;completed&quot;,\r\n    \t\t\t\t&quot;creationTimestamp&quot;: &quot;2022-06-15 06:36:23.798&quot;,\r\n    \t\t\t\t&quot;currency&quot;: &quot;USD&quot;,\r\n    \t\t\t\t&quot;offset&quot;: 30\r\n    \t\t\t},\r\n    \t\t\t{\r\n    \t\t\t\t&quot;messageId&quot;: &quot;9cg8f839-ab1e-467f-b679-a3aa4f390f2a&quot;,\r\n    \t\t\t\t&quot;transactionId&quot;: &quot;10000001&quot;,\r\n    \t\t\t\t&quot;customerId&quot;: &quot;customer4148&quot;,\r\n    \t\t\t\t&quot;customerGroupId&quot;: &quot;USA&quot;,\r\n    \t\t\t\t&quot;transactionStatus&quot;: &quot;completed&quot;,\r\n    \t\t\t\t&quot;creationTimestamp&quot;: &quot;2022-06-15 06:36:23.798&quot;,\r\n    \t\t\t\t&quot;currency&quot;: &quot;USD&quot;,\r\n    \t\t\t\t&quot;offset&quot;: 30\r\n    \t\t\t}\r\n    \t\t]\r\n    \t}\r\n    }\r\n\r\nI tried using JsonAssert like below but due to vulnerabilities in the jar my CI pipeline is not allowing to use the jar\r\n\r\n    JSONAssert.assertEquals(expectedResponseBody, responseBody,\r\n                new CustomComparator(JSONCompareMode.LENIENT,\r\n                    new Customization(&quot;messageId&quot;, (o1, o2) -&gt; true)));\r\n\r\nPlease help me how can i compare multiple jsonobject under a json array ignoring the messagrId field efficiently ","title":"How to compare json object in a json array by ignoring few attributes in java","body":"<p>I have sample transaction json like below</p>\n<pre><code>{\n    &quot;payload&quot;: {\n        &quot;header&quot;: [\n            {\n                &quot;messageId&quot;: &quot;10a0df00-c55c-4147-a3bf-e10dc9882768&quot;,\n                &quot;transactionId&quot;: &quot;10000001&quot;,\n                &quot;customerId&quot;: &quot;customer4148&quot;,\n                &quot;customerGroupId&quot;: &quot;USA&quot;,\n                &quot;transactionStatus&quot;: &quot;completed&quot;,\n                &quot;creationTimestamp&quot;: &quot;2022-06-15 06:36:23.798&quot;,\n                &quot;currency&quot;: &quot;USD&quot;,\n                &quot;offset&quot;: 30\n            },\n            {\n                &quot;messageId&quot;: &quot;9cg8f839-ab1e-467f-b679-a3aa4f390f2a&quot;,\n                &quot;transactionId&quot;: &quot;10000001&quot;,\n                &quot;customerId&quot;: &quot;customer4148&quot;,\n                &quot;customerGroupId&quot;: &quot;USA&quot;,\n                &quot;transactionStatus&quot;: &quot;completed&quot;,\n                &quot;creationTimestamp&quot;: &quot;2022-06-15 06:36:23.798&quot;,\n                &quot;currency&quot;: &quot;USD&quot;,\n                &quot;offset&quot;: 30\n            }\n        ]\n    }\n}\n</code></pre>\n<p>I tried using JsonAssert like below but due to vulnerabilities in the jar my CI pipeline is not allowing to use the jar</p>\n<pre><code>JSONAssert.assertEquals(expectedResponseBody, responseBody,\n            new CustomComparator(JSONCompareMode.LENIENT,\n                new Customization(&quot;messageId&quot;, (o1, o2) -&gt; true)));\n</code></pre>\n<p>Please help me how can i compare multiple jsonobject under a json array ignoring the messagrId field efficiently</p>\n"},{"tags":["java","c++","java-native-interface"],"comments":[{"owner":{"account_id":960307,"reputation":107861,"user_id":984823,"display_name":"Joop Eggen"},"score":0,"creation_date":1656340659,"post_id":72773647,"comment_id":128541674,"body_markdown":"UTF-8 should be passed. As one java char or int code point can be more than 1 byte. Is the unsigned char* indeed 20 bytes long, and is the java `char[]` 20 long, that is 40 bytes, or what is exactly happening? There should probably be no problem with 7 bits ASCII.","body":"UTF-8 should be passed. As one java char or int code point can be more than 1 byte. Is the unsigned char* indeed 20 bytes long, and is the java <code>char[]</code> 20 long, that is 40 bytes, or what is exactly happening? There should probably be no problem with 7 bits ASCII."},{"owner":{"account_id":5898520,"reputation":382,"user_id":4642911,"accept_rate":44,"display_name":"Hyukchan Kwon"},"score":0,"creation_date":1656341248,"post_id":72773647,"comment_id":128541976,"body_markdown":"Hello @JoopEggen. thanks for your quick reply. I edited the intial question to add more details :)","body":"Hello @JoopEggen. thanks for your quick reply. I edited the intial question to add more details :)"},{"owner":{"account_id":372682,"reputation":22426,"user_id":721855,"display_name":"aled"},"score":0,"creation_date":1656341667,"post_id":72773647,"comment_id":128542143,"body_markdown":"Please use text instead of images. See https://meta.stackoverflow.com/questions/285551/why-not-upload-images-of-code-errors-when-asking-a-question for more details on the reason. Kindly share the input and the result as an array in text.","body":"Please use text instead of images. See <a href=\"https://meta.stackoverflow.com/questions/285551/why-not-upload-images-of-code-errors-when-asking-a-question\" title=\"why not upload images of code errors when asking a question\">meta.stackoverflow.com/questions/285551/&hellip;</a> for more details on the reason. Kindly share the input and the result as an array in text."}],"answers":[{"tags":[],"owner":{"account_id":4555218,"reputation":32585,"user_id":3699139,"display_name":"Jorn Vernee"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1656341823,"creation_date":1656341823,"answer_id":72774212,"question_id":72773647,"body_markdown":"The string passed to `NewStringUTF` must be null-terminated. The string you&#39;re passing, however, is not null-terminated, and it looks like there&#39;s some garbage at the end of the string before the first null.\r\n\r\nI suggest creating a larger array, and adding a null terminator at the end:\r\n\r\n    JNIEXPORT jstring JNICALL Java_com_example_demo_DemoClass_functionToCall\r\n      (JNIEnv *env, jobject recv) {\r\n      unsigned char unsigned_char_array[20 + 1]; // + 1 for null terminator\r\n      function_to_call(unsigned_char_array);    \r\n      unsigned_char_array[20] = &#39;\\0&#39;; // add null terminator\r\n    \r\n      printf(&quot;result : %s (%ld chars)\\n&quot;, unsigned_char_array, (int) sizeof unsigned_char_array);\r\n\r\n      return (env)-&gt;NewStringUTF((char*) unsigned_char_array); // should work now\r\n    }\r\n\r\n","title":"Converting an unsigned char array to jstring","body":"<p>The string passed to <code>NewStringUTF</code> must be null-terminated. The string you're passing, however, is not null-terminated, and it looks like there's some garbage at the end of the string before the first null.</p>\n<p>I suggest creating a larger array, and adding a null terminator at the end:</p>\n<pre><code>JNIEXPORT jstring JNICALL Java_com_example_demo_DemoClass_functionToCall\n  (JNIEnv *env, jobject recv) {\n  unsigned char unsigned_char_array[20 + 1]; // + 1 for null terminator\n  function_to_call(unsigned_char_array);    \n  unsigned_char_array[20] = '\\0'; // add null terminator\n\n  printf(&quot;result : %s (%ld chars)\\n&quot;, unsigned_char_array, (int) sizeof unsigned_char_array);\n\n  return (env)-&gt;NewStringUTF((char*) unsigned_char_array); // should work now\n}\n</code></pre>\n"}],"owner":{"account_id":5898520,"reputation":382,"user_id":4642911,"accept_rate":44,"display_name":"Hyukchan Kwon"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":386,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":72774212,"answer_count":1,"score":0,"last_activity_date":1656341823,"creation_date":1656339580,"question_id":72773647,"body_markdown":"I&#39;m having issues trying to convert an unsigned char array to jstring.\r\n\r\nThe context is I&#39;m using a shared c library from Java.\r\nSo I&#39;m implementing a JNI c++ file.\r\nThe function I use from the library returs a `unsigned char* num_carte_transcode`\r\n\r\nAnd the function I implemented in the JNI C++ file returns a jstring.\r\n\r\nSo I need to convert the unsigned char array to jstring.\r\n\r\nI tried this simple cast `return (env)-&gt;NewStringUTF((char*) unsigned_char_array);`\r\n\r\nBut though the array should only contain 20 bytes, I get randomly 22 or 23 bytes in Java...\r\n(Though the 20 bytes are correct)\r\n\r\nEDIT1: Here some more details with example\r\n\r\n```\r\nJNIEXPORT jstring JNICALL Java_com_example_demo_DemoClass_functionToCall\r\n  (JNIEnv *env, jobject, ) {\r\n  // Here I define an unsigned char array as requested by the library function\r\n  unsigned char unsigned_char_array[20];\r\n  // The function feeds the array at execution\r\n  function_to_call(unsigned_char_array);\r\n\r\n  // I print out the result for debug purpose\r\n  printf(&quot;result : %.*s (%ld chars)\\n&quot;, (int) sizeof unsigned_char_array, unsigned_char_array, (int) sizeof unsigned_char_array);\r\n\r\n  // I get the result I want, which is like: 92311221679609987114 (20 numbers)\r\n\r\n  // Now, I need to convert the unsigned char array to jstring to return to Java\r\n  return (env)-&gt;NewStringUTF((char*) unsigned_char_array);\r\n  // Though... On debugging on Java, I get 21 bytes 92311221679609987114 (check the image below)\r\n}\r\n```\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/4LDVh.png\r\n\r\n\r\nAnd sometimes I get 22 bytes, sometimes 23 ... though the expected result is always 20 bytes.","title":"Converting an unsigned char array to jstring","body":"<p>I'm having issues trying to convert an unsigned char array to jstring.</p>\n<p>The context is I'm using a shared c library from Java.\nSo I'm implementing a JNI c++ file.\nThe function I use from the library returs a <code>unsigned char* num_carte_transcode</code></p>\n<p>And the function I implemented in the JNI C++ file returns a jstring.</p>\n<p>So I need to convert the unsigned char array to jstring.</p>\n<p>I tried this simple cast <code>return (env)-&gt;NewStringUTF((char*) unsigned_char_array);</code></p>\n<p>But though the array should only contain 20 bytes, I get randomly 22 or 23 bytes in Java...\n(Though the 20 bytes are correct)</p>\n<p>EDIT1: Here some more details with example</p>\n<pre><code>JNIEXPORT jstring JNICALL Java_com_example_demo_DemoClass_functionToCall\n  (JNIEnv *env, jobject, ) {\n  // Here I define an unsigned char array as requested by the library function\n  unsigned char unsigned_char_array[20];\n  // The function feeds the array at execution\n  function_to_call(unsigned_char_array);\n\n  // I print out the result for debug purpose\n  printf(&quot;result : %.*s (%ld chars)\\n&quot;, (int) sizeof unsigned_char_array, unsigned_char_array, (int) sizeof unsigned_char_array);\n\n  // I get the result I want, which is like: 92311221679609987114 (20 numbers)\n\n  // Now, I need to convert the unsigned char array to jstring to return to Java\n  return (env)-&gt;NewStringUTF((char*) unsigned_char_array);\n  // Though... On debugging on Java, I get 21 bytes 92311221679609987114 (check the image below)\n}\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/4LDVh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4LDVh.png\" alt=\"enter image description here\" /></a></p>\n<p>And sometimes I get 22 bytes, sometimes 23 ... though the expected result is always 20 bytes.</p>\n"},{"tags":["java","java-8","java-time"],"answers":[{"tags":[],"owner":{"account_id":6528825,"reputation":21455,"user_id":5050667,"accept_rate":91,"display_name":"Yassin Hajaj"},"down_vote_count":2,"up_vote_count":43,"is_accepted":true,"score":41,"last_activity_date":1622007667,"creation_date":1459885134,"answer_id":36435570,"question_id":36435492,"body_markdown":"According to the [JavaDoc][1]\r\n\r\nSince `sql.Date` does not have a time component, there is no possibility to convert it to `time.Instant`\r\n\r\n&gt; This method always throws an UnsupportedOperationException and should\r\n&gt; not be used because SQL Date values do not have a time component.\r\n\r\n\r\n  [1]: https://docs.oracle.com/javase/8/docs/api/java/sql/Date.html#toInstant--","title":"UnsupportedOperationException - Why can&#39;t you call toInstant() on a java.sql.Date?","body":"<p>According to the <a href=\"https://docs.oracle.com/javase/8/docs/api/java/sql/Date.html#toInstant--\" rel=\"noreferrer\">JavaDoc</a></p>\n<p>Since <code>sql.Date</code> does not have a time component, there is no possibility to convert it to <code>time.Instant</code></p>\n<blockquote>\n<p>This method always throws an UnsupportedOperationException and should\nnot be used because SQL Date values do not have a time component.</p>\n</blockquote>\n"},{"tags":[],"owner":{"account_id":3619169,"reputation":9458,"user_id":3018377,"accept_rate":64,"display_name":"LHA"},"down_vote_count":1,"up_vote_count":39,"is_accepted":false,"score":38,"last_activity_date":1656341801,"creation_date":1459885141,"answer_id":36435573,"question_id":36435492,"body_markdown":"[java.sql.Date][1] supports only Date components (date, month, year). It does NOT support time components (hour, minute, second, millisecond). [toInstant][2] requires both Date and Time components, so toInstant on java.sql.Date instance throws UnsupportedOperationException exception.\r\n\r\n**toInstant Java doc**\r\n\r\n&gt; This method always throws an\r\n&gt; UnsupportedOperationException and should not be used because SQL Date\r\n&gt; values do not have a time component.\r\n\r\njava.util.Date OR java.sql.Timestamp has both Date/Time components, so toInstant() works!\r\n\r\nYou can do like this:\r\n    \r\n    // Time is 00:00:00.000\r\n\r\n    new java.util.Date(sqlDate.getTime()).toInstant() \r\n\r\n**Updated:**\r\n\r\n    Instant.ofEpochMilli(sqlDate.getTime());\r\n\r\n    // and\r\n    new java.util.Date(sqlDate.getTime()).toInstant();\r\n\r\nwill return the same result because the toInstant() method calls Instant.ofEpochMilli(getTime()) internally.\r\n\r\n    public Instant toInstant() {\r\n        return Instant.ofEpochMilli(getTime());\r\n    }\r\n\r\n\r\n  [1]: https://docs.oracle.com/javase/8/docs/api/java/sql/Date.html\r\n  [2]: https://docs.oracle.com/javase/8/docs/api/java/sql/Date.html#toInstant","title":"UnsupportedOperationException - Why can&#39;t you call toInstant() on a java.sql.Date?","body":"<p><a href=\"https://docs.oracle.com/javase/8/docs/api/java/sql/Date.html\" rel=\"nofollow noreferrer\">java.sql.Date</a> supports only Date components (date, month, year). It does NOT support time components (hour, minute, second, millisecond). <a href=\"https://docs.oracle.com/javase/8/docs/api/java/sql/Date.html#toInstant\" rel=\"nofollow noreferrer\">toInstant</a> requires both Date and Time components, so toInstant on java.sql.Date instance throws UnsupportedOperationException exception.</p>\n<p><strong>toInstant Java doc</strong></p>\n<blockquote>\n<p>This method always throws an\nUnsupportedOperationException and should not be used because SQL Date\nvalues do not have a time component.</p>\n</blockquote>\n<p>java.util.Date OR java.sql.Timestamp has both Date/Time components, so toInstant() works!</p>\n<p>You can do like this:</p>\n<pre><code>// Time is 00:00:00.000\n\nnew java.util.Date(sqlDate.getTime()).toInstant() \n</code></pre>\n<p><strong>Updated:</strong></p>\n<pre><code>Instant.ofEpochMilli(sqlDate.getTime());\n\n// and\nnew java.util.Date(sqlDate.getTime()).toInstant();\n</code></pre>\n<p>will return the same result because the toInstant() method calls Instant.ofEpochMilli(getTime()) internally.</p>\n<pre><code>public Instant toInstant() {\n    return Instant.ofEpochMilli(getTime());\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2906108,"reputation":42988,"user_id":2491410,"accept_rate":100,"display_name":"Meno Hochschild"},"down_vote_count":0,"up_vote_count":20,"is_accepted":false,"score":20,"last_activity_date":1459927070,"creation_date":1459927070,"answer_id":36444070,"question_id":36435492,"body_markdown":"The answers given so far until now concentrate on the detail that `java.sql.Date` has no time information. That is correct but not the real or sufficient reason why this type cannot offer a direct conversion to `Instant`. Unfortunatly the [documentation of Java-8][1] does make the same mistake to let users think the problem is just because of missing time information.\r\n\r\nConceptually, the type `java.sql.Date` represents a local type. It models a calendar date which can be different in any region of our globe. But an `Instant` is the same on our globe around. **So users need a timezone or a timezone offset to do the conversion.**\r\n\r\nTragically, the type `java.sql.Date` inherits from `java.util.Date` which is a global type (instant-like). However, this inheritance really denotes implementation inheritance, and not type inheritance. One more reason to consider the design of these old JDBC-classes to be broken. Therefore it is indeed possible to use the hack to wrap the `java.sql.Date` via its method `getTime()` inside an instance of `java.util.Date` which finally allows direct conversion to an instant. But: This conversion implicitly uses the default timezone of the system.\r\n\r\nSo how to correctly convert in a pedantic way? Let&#39;s consider the [documentation of Java-8][2] again which here points into the right direction:\r\n\r\n    java.sql.Date sqlDate = ...;\r\n    LocalDate calendarDate = sqlDate.toLocalDate();\r\n    ZonedDateTime zdt = calendarDate.atStartOfDay(ZoneId.of(&quot;Europe/Paris&quot;));\r\n    Instant instant = zdt.toInstant();\r\n\r\n  [1]: http://docs.oracle.com/javase/8/docs/api/java/sql/Date.html#toInstant--\r\n  [2]: http://docs.oracle.com/javase/8/docs/api/java/sql/Date.html#toLocalDate--\r\n","title":"UnsupportedOperationException - Why can&#39;t you call toInstant() on a java.sql.Date?","body":"<p>The answers given so far until now concentrate on the detail that <code>java.sql.Date</code> has no time information. That is correct but not the real or sufficient reason why this type cannot offer a direct conversion to <code>Instant</code>. Unfortunatly the <a href=\"http://docs.oracle.com/javase/8/docs/api/java/sql/Date.html#toInstant--\" rel=\"noreferrer\">documentation of Java-8</a> does make the same mistake to let users think the problem is just because of missing time information.</p>\n\n<p>Conceptually, the type <code>java.sql.Date</code> represents a local type. It models a calendar date which can be different in any region of our globe. But an <code>Instant</code> is the same on our globe around. <strong>So users need a timezone or a timezone offset to do the conversion.</strong></p>\n\n<p>Tragically, the type <code>java.sql.Date</code> inherits from <code>java.util.Date</code> which is a global type (instant-like). However, this inheritance really denotes implementation inheritance, and not type inheritance. One more reason to consider the design of these old JDBC-classes to be broken. Therefore it is indeed possible to use the hack to wrap the <code>java.sql.Date</code> via its method <code>getTime()</code> inside an instance of <code>java.util.Date</code> which finally allows direct conversion to an instant. But: This conversion implicitly uses the default timezone of the system.</p>\n\n<p>So how to correctly convert in a pedantic way? Let's consider the <a href=\"http://docs.oracle.com/javase/8/docs/api/java/sql/Date.html#toLocalDate--\" rel=\"noreferrer\">documentation of Java-8</a> again which here points into the right direction:</p>\n\n<pre><code>java.sql.Date sqlDate = ...;\nLocalDate calendarDate = sqlDate.toLocalDate();\nZonedDateTime zdt = calendarDate.atStartOfDay(ZoneId.of(\"Europe/Paris\"));\nInstant instant = zdt.toInstant();\n</code></pre>\n"},{"tags":[],"owner":{"account_id":440158,"reputation":323231,"user_id":829571,"accept_rate":94,"display_name":"assylias"},"down_vote_count":0,"up_vote_count":61,"is_accepted":false,"score":61,"last_activity_date":1459927330,"creation_date":1459927330,"answer_id":36444154,"question_id":36435492,"body_markdown":"The correct mapping between `java.sql.Date` and `java.time` is `LocalDate`:\r\n\r\n    LocalDate date = sqlDate.toLocalDate();\r\n\r\n*If you really must*, you can then derive an `Instant`, although the extra information (time) will be arbitrary. For example:\r\n\r\n    Instant i = date.atStartOfDay(ZoneOffset.UTC).toInstant();","title":"UnsupportedOperationException - Why can&#39;t you call toInstant() on a java.sql.Date?","body":"<p>The correct mapping between <code>java.sql.Date</code> and <code>java.time</code> is <code>LocalDate</code>:</p>\n\n<pre><code>LocalDate date = sqlDate.toLocalDate();\n</code></pre>\n\n<p><em>If you really must</em>, you can then derive an <code>Instant</code>, although the extra information (time) will be arbitrary. For example:</p>\n\n<pre><code>Instant i = date.atStartOfDay(ZoneOffset.UTC).toInstant();\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1125613,"reputation":18964,"user_id":1112963,"accept_rate":59,"display_name":"Zon"},"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1617218331,"creation_date":1617218331,"answer_id":66894010,"question_id":36435492,"body_markdown":"If you don&#39;t have time in your Date - convert it to millis:\r\n\r\n   \r\n   \r\n    Instant.ofEpochMilli(date.getTime())\r\n       .atZone(ZoneId.systemDefault())\r\n       .toLocalDate();","title":"UnsupportedOperationException - Why can&#39;t you call toInstant() on a java.sql.Date?","body":"<p>If you don't have time in your Date - convert it to millis:</p>\n<pre><code>Instant.ofEpochMilli(date.getTime())\n   .atZone(ZoneId.systemDefault())\n   .toLocalDate();\n</code></pre>\n"},{"tags":[],"owner":{"account_id":8069687,"reputation":71,"user_id":6082831,"display_name":"Chris Lewold"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1649757516,"creation_date":1649757516,"answer_id":71840659,"question_id":36435492,"body_markdown":"The implementation of java.sql.Date (imho) is really not perfect. \r\n\r\nIn order to convert java.util.Date to LocalDate the web is full of code blocks like this: \r\n\r\n    dateToConvert.toInstant()\r\n      .atZone(ZoneId.systemDefault())\r\n      .toLocalDate();\r\n\r\n - above code works perfect for java.util.Date because of the way it implements toInstant(). (As expected &quot; return Instant.ofEpochMilli(getTime())&quot;) \r\n - As java.sql.Date is a subclass of java.util.Date code operating on the Date object might now know it operates on a java.sql.Date. (Hey - that&#39;s one aspect of object orientation, right??). So if it gets java.util.Date code works well, if it gets java.sql.Date it fails. \r\n - Code could now explicitly check for the Date type, and then (if it operates on java.sql.Date) it could do a downcast to java.sql.Date and use the toLocalDate() method. Needless to say, that this is ugly. \r\n\r\nAs developer I&#39;d like to have one method working properly - toLocalDate (internally using deprectated methods) only exists for java.sql.Date so cannot be used on java.util.Date, and toInstant fails on java.sql.Date. \r\n\r\nI changed my &quot;Date to LocalDate&quot; conversion code to this:\r\n\r\n    public static LocalDate asLocalDate(java.util.Date date) {\r\n        return date == null ? null : LocalDate.ofInstant(Instant.ofEpochMilli(date.getTime()), ZoneId.systemDefault());\r\n    }\r\n\r\n\r\n This works independent of the date type passed in. Basically it means &quot;dont call java.util.Date.toInstant() as you might get a java.sql.Date, which then breaks your code. \r\n\r\nI really don&#39;t understand why they implement such traps on purpose within the JDK. \r\n\r\n\r\n","title":"UnsupportedOperationException - Why can&#39;t you call toInstant() on a java.sql.Date?","body":"<p>The implementation of java.sql.Date (imho) is really not perfect.</p>\n<p>In order to convert java.util.Date to LocalDate the web is full of code blocks like this:</p>\n<pre><code>dateToConvert.toInstant()\n  .atZone(ZoneId.systemDefault())\n  .toLocalDate();\n</code></pre>\n<ul>\n<li>above code works perfect for java.util.Date because of the way it implements toInstant(). (As expected &quot; return Instant.ofEpochMilli(getTime())&quot;)</li>\n<li>As java.sql.Date is a subclass of java.util.Date code operating on the Date object might now know it operates on a java.sql.Date. (Hey - that's one aspect of object orientation, right??). So if it gets java.util.Date code works well, if it gets java.sql.Date it fails.</li>\n<li>Code could now explicitly check for the Date type, and then (if it operates on java.sql.Date) it could do a downcast to java.sql.Date and use the toLocalDate() method. Needless to say, that this is ugly.</li>\n</ul>\n<p>As developer I'd like to have one method working properly - toLocalDate (internally using deprectated methods) only exists for java.sql.Date so cannot be used on java.util.Date, and toInstant fails on java.sql.Date.</p>\n<p>I changed my &quot;Date to LocalDate&quot; conversion code to this:</p>\n<pre><code>public static LocalDate asLocalDate(java.util.Date date) {\n    return date == null ? null : LocalDate.ofInstant(Instant.ofEpochMilli(date.getTime()), ZoneId.systemDefault());\n}\n</code></pre>\n<p>This works independent of the date type passed in. Basically it means &quot;dont call java.util.Date.toInstant() as you might get a java.sql.Date, which then breaks your code.</p>\n<p>I really don't understand why they implement such traps on purpose within the JDK.</p>\n"}],"owner":{"account_id":3020114,"reputation":10675,"user_id":2561365,"accept_rate":63,"display_name":"Andrew Mairose"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":54366,"favorite_count":0,"down_vote_count":3,"up_vote_count":82,"accepted_answer_id":36435570,"answer_count":6,"score":79,"last_activity_date":1656341801,"creation_date":1459884904,"question_id":36435492,"body_markdown":"The `java.util.Date` class has a method called `toInstant()` that converts the `Date` instance to a `java.time.Instant`.\r\n\r\nThe `java.sql.Date` class extends the `java.util.Date` class, but when I attempt to call `toInstant()` on a `java.sql.Date`, I receive an `UnsupportedOperationException`.\r\n\r\nWhy is `toInstant()` an unsupported operation on `java.sql.Date`?\r\n\r\nAnd what is the &quot;correct&quot; way to convert a `java.sql.Date` to a `java.time.Instant`?","title":"UnsupportedOperationException - Why can&#39;t you call toInstant() on a java.sql.Date?","body":"<p>The <code>java.util.Date</code> class has a method called <code>toInstant()</code> that converts the <code>Date</code> instance to a <code>java.time.Instant</code>.</p>\n\n<p>The <code>java.sql.Date</code> class extends the <code>java.util.Date</code> class, but when I attempt to call <code>toInstant()</code> on a <code>java.sql.Date</code>, I receive an <code>UnsupportedOperationException</code>.</p>\n\n<p>Why is <code>toInstant()</code> an unsupported operation on <code>java.sql.Date</code>?</p>\n\n<p>And what is the \"correct\" way to convert a <code>java.sql.Date</code> to a <code>java.time.Instant</code>?</p>\n"},{"tags":["java","spring","spring-boot","dependency-injection","junit5"],"comments":[{"owner":{"account_id":10944927,"reputation":491,"user_id":8043392,"display_name":"Shivaji Pote"},"score":0,"creation_date":1656192031,"post_id":72747557,"comment_id":128512876,"body_markdown":"Where is bean definition of `org.companyname.enterpriseteam.demo.anonymizer.DAnonymizer`? Is this class annotated with `@Component` (or other bean creation annotations)? Or is it defined in some other configuration file? If none of the above, try to defining it&#39;s bean.","body":"Where is bean definition of <code>org.companyname.enterpriseteam.demo.anonymizer.DAnonymizer</code>? Is this class annotated with <code>@Component</code> (or other bean creation annotations)? Or is it defined in some other configuration file? If none of the above, try to defining it&#39;s bean."},{"owner":{"account_id":20229294,"reputation":139,"user_id":14836285,"display_name":"ClarenceHD"},"score":0,"creation_date":1656281089,"post_id":72747557,"comment_id":128527186,"body_markdown":"Thank you for the reply. The bean definition is in a different package in a different repo. It basically resides in a shared library that our team uses, but it is not a bean. Should I create a config file for it in my current repo? Because I am not sure if DAnonymizer needs to be annotated as a bean since its worked fine with other implementations. We try not to modify that shared library too often, unless absolutely necessary. I feel like I am missing something simple because im new to Spring Boot.","body":"Thank you for the reply. The bean definition is in a different package in a different repo. It basically resides in a shared library that our team uses, but it is not a bean. Should I create a config file for it in my current repo? Because I am not sure if DAnonymizer needs to be annotated as a bean since its worked fine with other implementations. We try not to modify that shared library too often, unless absolutely necessary. I feel like I am missing something simple because im new to Spring Boot."},{"owner":{"account_id":20229294,"reputation":139,"user_id":14836285,"display_name":"ClarenceHD"},"score":0,"creation_date":1656281907,"post_id":72747557,"comment_id":128527320,"body_markdown":"Its important to add, we use artifactory to manage packages.","body":"Its important to add, we use artifactory to manage packages."},{"owner":{"account_id":10944927,"reputation":491,"user_id":8043392,"display_name":"Shivaji Pote"},"score":0,"creation_date":1656341624,"post_id":72747557,"comment_id":128542123,"body_markdown":"Yes, you need to define bean of `DAnonymizer` in your `@Configuration` class if it&#39;s not already a bean. You don&#39;t need to annotate DAnonymizer as bean. Only defining bean in config file should work. I will post sample code as answer","body":"Yes, you need to define bean of <code>DAnonymizer</code> in your <code>@Configuration</code> class if it&#39;s not already a bean. You don&#39;t need to annotate DAnonymizer as bean. Only defining bean in config file should work. I will post sample code as answer"}],"answers":[{"tags":[],"owner":{"account_id":10944927,"reputation":491,"user_id":8043392,"display_name":"Shivaji Pote"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656341785,"creation_date":1656341785,"answer_id":72774199,"question_id":72747557,"body_markdown":"Define bean of `DAnonymizer` in config class like below\r\n\r\n    @Configuration\r\n    public class DAnonymizerConfig {\r\n      \r\n      @Bean\r\n      public DAnonymizer dAnonymizer() {\r\n         return new DAnonymizer();//considering DAnonymizer has default constructor\r\n      }\r\n\r\n    }","title":"&#39;NoSuchBeanDefinitionException: No qualifying bean of type&#39; Error after adding new dependency injection to already implemented &amp; unit tested class","body":"<p>Define bean of <code>DAnonymizer</code> in config class like below</p>\n<pre><code>@Configuration\npublic class DAnonymizerConfig {\n  \n  @Bean\n  public DAnonymizer dAnonymizer() {\n     return new DAnonymizer();//considering DAnonymizer has default constructor\n  }\n\n}\n</code></pre>\n"}],"owner":{"account_id":20229294,"reputation":139,"user_id":14836285,"display_name":"ClarenceHD"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":797,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1656341785,"creation_date":1656091855,"question_id":72747557,"body_markdown":"```\r\nCaused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type &#39;org.companyname.enterpriseteam.demo.anonymizer.DAnonymizer&#39; available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {}\r\n```\r\n\r\nHere is a mock but logically accurate representation of the code\r\n\r\nConfig Package\r\n```\r\n…\r\nimport org.companyname.enterpriseteam.demo.anonymizer.DAnonymizer;\r\nimport org.companyname.entuserfilter.externals.adminusersearch.AdminSearchUserRecordsAnonymizer;\r\n…\r\n\r\n\r\n@Configuration\r\npublic class AdminUserSearchAnonymizationConfiguration {\r\n  @Bean\r\n  public AdminSearchUserRecordsAnonymizer\r\n      adminSearchUserRecordsAnonymizer(final DAnonymizer dAnonymizer) {\r\n    return new adminSearchUserRecordsAnonymizerImpl(dAnonymizer);\r\n  }\r\n}\r\n```\r\n\r\nNew interface I created in a different package\r\n```\r\n…\r\nSome imports\r\n…\r\n\r\npublic interface AdminSearchUserRecordsAnonymizer {\r\n  List&lt;StoredUserRecord&gt; anonymizeAdminSearchUserRecordsIfNeeded(\r\n      final List&lt;StoredUserRecord&gt; storedUserRecords,\r\n      final String orgId,\r\n      @Nullable final Long requestUserId);\r\n}\r\n```\r\n\r\nThe interface’s implementation\r\n```\r\n…\r\nSome imports\r\n…\r\n\r\n\r\npublic class AdminSearchUserRecordsAnonymizerImpl\r\n    implements AdminSearchUserRecordsAnonymizer {\r\n  private final DAnonymizer dAnonymizer;\r\n\r\n  public AdminSearchUserRecordsAnonymizerImpl(final DAnonymizer dAnonymizer) {\r\n    this.dAnonymizer = dAnonymizer;\r\n  }\r\n\r\n\r\n  @Override\r\n  public List&lt;StoredUserRecord&gt; anonymizeAdminSearchUserRecordsIfNeeded(\r\n      final List&lt;StoredUserRecord&gt; storedUserRecords,\r\n      final String orgId,\r\n      @Nullable final Long requestUserId) {\r\n    if (!DConstants.COMPANY_ORG_ID.equals(orgId) || requestUserId == null) {\r\n      // System.out.println(&quot;NO ANONYMIZATION&quot; + storedUserRecords);\r\n      return storedUserRecords;\r\n    }\r\n\r\n    // System.out.println(&quot;ANONYMIZATION TO BE DONE ON USER RECORDS LIST&quot; + storedUserRecords);\r\n    return storedUserRecords.stream()\r\n        .map(entry -&gt; anonymizeUserRecordIfNeeded(entry, orgId, requestUserId))\r\n        .collect(Collectors.toList());\r\n  }\r\n\r\n\r\n  private StoredUserRecord anonymizeUserRecordIfNeeded(\r\n      final StoredUserRecord storedUserRecord, final String orgId, final Long requestUserId) {\r\n        final var anonymizedStoredUserRecord =\r\n        dAnonymizer.getAnonymizedUserInfoForOrg(\r\n            orgId, storedUserRecord.userId().get(), requestUserId);\r\n\r\n        return anonymizedStoredUserRecord\r\n        .map(\r\n            anon -&gt;\r\n                new StoredUserRecord(\r\n                    storedUserRecord.userId(),\r\n                    anon.email(),\r\n                    storedUserRecord.externalId(),\r\n                    anon.name(),\r\n        .orElse(storedUserRecord);\r\n  }\r\n}\r\n```\r\n\r\nConstructor of class where dependency injection is performed\r\n```\r\n…\r\nSome imports\r\n…\r\n\r\npublic class AdminViewElasticSearchManager implements AdminViewManager {\r\n  private final someObject1;\r\n  private final someObject2;\r\n  private final someObject3;\r\n  private final someObject4;\r\n  private final AdminSearchUserRecordsAnonymizer\r\n        adminSearchUserRecordsAnonymizer;\r\n\r\npublic AdminViewElasticSearchManager(\r\n    someClass1 someObject1,\r\n    someClass2 someObject2,\r\n    someClass3 someObject3,\r\n    someClass4 someObject4,\r\n    AdminSearchUserRecordsAnonymizer\r\n        adminSearchUserRecordsAnonymizer\r\n    ) {\r\n  this.elasticSearchReader = elasticSearchReader;\r\n  this.someObject1 = someObject1;\r\n  this.someObject2 = someObject2;\r\n  this.someObject3 = someObject3;\r\n  this.someObject4 = someObject4;\r\n  this.adminSearchUserRecordsAnonymizer =\r\n          adminSearchUserRecordsAnonymizer;\r\n\r\n}\r\n```\r\n\r\nMe using my new implementation’s method somewhere in that same class above\r\n```\r\n@Override\r\npublic UserRecordsWithPagination searchWithFilterParams(filterParams, pageRequest, requestUser) {\r\n…\r\nSome code\r\n…\r\n\r\nstoredUserRecords =\r\nthis.adminSearchUserRecordsAnonymizer.anonymizeAdminSearchUserRecordsIfNeeded(\r\n           storedUserRecords, filterParams.orgId, requestUser);\r\n…\r\nMore code\r\n…\r\n\r\n}\r\n```\r\n\r\nMany tests are failing due to dependency injection issues and because of it, I can’t test properly.\r\nThis particular test is also not asserting like it should meaning my new class isn’t returning the proper list to its caller.\r\nI wonder if its related to dependencies not being injected properly?\r\n```\r\n…\r\nvar filterParams =\r\n    FilterParams.newBuilder()\r\n        .setOrganizationId(UserRecordFixtures.MEMBER_USER_RECORD.organizationId())\r\n        .setSearchNameOrEmails(List.of(&quot;johndoe&quot;))\r\n        .build();\r\n\r\nvar pageRequest =\r\n    PageRequest.newBuilder()\r\n        .setStart(Int64Value.of(0))\r\n        .setLimit(Int64Value.of(1))\r\n        .build();\r\n\r\nvar result = this.manager.queryByFilterParams(filterParams, pageRequest, null);\r\nSystem.out.println(&quot;THIS IS MY RESULT: &quot; + result);\r\nAssertions.assertEquals(1, result.userRecords().size());\r\n…\r\n```","title":"&#39;NoSuchBeanDefinitionException: No qualifying bean of type&#39; Error after adding new dependency injection to already implemented &amp; unit tested class","body":"<pre><code>Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type 'org.companyname.enterpriseteam.demo.anonymizer.DAnonymizer' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {}\n</code></pre>\n<p>Here is a mock but logically accurate representation of the code</p>\n<p>Config Package</p>\n<pre><code>…\nimport org.companyname.enterpriseteam.demo.anonymizer.DAnonymizer;\nimport org.companyname.entuserfilter.externals.adminusersearch.AdminSearchUserRecordsAnonymizer;\n…\n\n\n@Configuration\npublic class AdminUserSearchAnonymizationConfiguration {\n  @Bean\n  public AdminSearchUserRecordsAnonymizer\n      adminSearchUserRecordsAnonymizer(final DAnonymizer dAnonymizer) {\n    return new adminSearchUserRecordsAnonymizerImpl(dAnonymizer);\n  }\n}\n</code></pre>\n<p>New interface I created in a different package</p>\n<pre><code>…\nSome imports\n…\n\npublic interface AdminSearchUserRecordsAnonymizer {\n  List&lt;StoredUserRecord&gt; anonymizeAdminSearchUserRecordsIfNeeded(\n      final List&lt;StoredUserRecord&gt; storedUserRecords,\n      final String orgId,\n      @Nullable final Long requestUserId);\n}\n</code></pre>\n<p>The interface’s implementation</p>\n<pre><code>…\nSome imports\n…\n\n\npublic class AdminSearchUserRecordsAnonymizerImpl\n    implements AdminSearchUserRecordsAnonymizer {\n  private final DAnonymizer dAnonymizer;\n\n  public AdminSearchUserRecordsAnonymizerImpl(final DAnonymizer dAnonymizer) {\n    this.dAnonymizer = dAnonymizer;\n  }\n\n\n  @Override\n  public List&lt;StoredUserRecord&gt; anonymizeAdminSearchUserRecordsIfNeeded(\n      final List&lt;StoredUserRecord&gt; storedUserRecords,\n      final String orgId,\n      @Nullable final Long requestUserId) {\n    if (!DConstants.COMPANY_ORG_ID.equals(orgId) || requestUserId == null) {\n      // System.out.println(&quot;NO ANONYMIZATION&quot; + storedUserRecords);\n      return storedUserRecords;\n    }\n\n    // System.out.println(&quot;ANONYMIZATION TO BE DONE ON USER RECORDS LIST&quot; + storedUserRecords);\n    return storedUserRecords.stream()\n        .map(entry -&gt; anonymizeUserRecordIfNeeded(entry, orgId, requestUserId))\n        .collect(Collectors.toList());\n  }\n\n\n  private StoredUserRecord anonymizeUserRecordIfNeeded(\n      final StoredUserRecord storedUserRecord, final String orgId, final Long requestUserId) {\n        final var anonymizedStoredUserRecord =\n        dAnonymizer.getAnonymizedUserInfoForOrg(\n            orgId, storedUserRecord.userId().get(), requestUserId);\n\n        return anonymizedStoredUserRecord\n        .map(\n            anon -&gt;\n                new StoredUserRecord(\n                    storedUserRecord.userId(),\n                    anon.email(),\n                    storedUserRecord.externalId(),\n                    anon.name(),\n        .orElse(storedUserRecord);\n  }\n}\n</code></pre>\n<p>Constructor of class where dependency injection is performed</p>\n<pre><code>…\nSome imports\n…\n\npublic class AdminViewElasticSearchManager implements AdminViewManager {\n  private final someObject1;\n  private final someObject2;\n  private final someObject3;\n  private final someObject4;\n  private final AdminSearchUserRecordsAnonymizer\n        adminSearchUserRecordsAnonymizer;\n\npublic AdminViewElasticSearchManager(\n    someClass1 someObject1,\n    someClass2 someObject2,\n    someClass3 someObject3,\n    someClass4 someObject4,\n    AdminSearchUserRecordsAnonymizer\n        adminSearchUserRecordsAnonymizer\n    ) {\n  this.elasticSearchReader = elasticSearchReader;\n  this.someObject1 = someObject1;\n  this.someObject2 = someObject2;\n  this.someObject3 = someObject3;\n  this.someObject4 = someObject4;\n  this.adminSearchUserRecordsAnonymizer =\n          adminSearchUserRecordsAnonymizer;\n\n}\n</code></pre>\n<p>Me using my new implementation’s method somewhere in that same class above</p>\n<pre><code>@Override\npublic UserRecordsWithPagination searchWithFilterParams(filterParams, pageRequest, requestUser) {\n…\nSome code\n…\n\nstoredUserRecords =\nthis.adminSearchUserRecordsAnonymizer.anonymizeAdminSearchUserRecordsIfNeeded(\n           storedUserRecords, filterParams.orgId, requestUser);\n…\nMore code\n…\n\n}\n</code></pre>\n<p>Many tests are failing due to dependency injection issues and because of it, I can’t test properly.\nThis particular test is also not asserting like it should meaning my new class isn’t returning the proper list to its caller.\nI wonder if its related to dependencies not being injected properly?</p>\n<pre><code>…\nvar filterParams =\n    FilterParams.newBuilder()\n        .setOrganizationId(UserRecordFixtures.MEMBER_USER_RECORD.organizationId())\n        .setSearchNameOrEmails(List.of(&quot;johndoe&quot;))\n        .build();\n\nvar pageRequest =\n    PageRequest.newBuilder()\n        .setStart(Int64Value.of(0))\n        .setLimit(Int64Value.of(1))\n        .build();\n\nvar result = this.manager.queryByFilterParams(filterParams, pageRequest, null);\nSystem.out.println(&quot;THIS IS MY RESULT: &quot; + result);\nAssertions.assertEquals(1, result.userRecords().size());\n…\n</code></pre>\n"},{"tags":["java","maven","jenkins","testing","bdd"],"answers":[{"tags":[],"owner":{"account_id":20039548,"reputation":334,"user_id":14694981,"display_name":"Jerome Josephraj"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656013397,"creation_date":1656013397,"answer_id":72735792,"question_id":72735496,"body_markdown":"You need to configure this in a CI server such as Jenkins. \r\n\r\nYou can consider these steps, when setting up Jenkins, to achieve your use case:\r\n\r\n- Use Git-hooks; This will trigger a Jenkins pipeline as soon you merge a branch into the master. Check this article for more info https://kohsuke.org/2011/12/01/polling-must-die-triggering-jenkins-builds-from-a-git-hook/\r\n\r\n- Then in Jenkins, run your BDD project. Here is a nice article, which explains how cucumber projects are setup and run in Jenkins:\r\nhttps://faun.pub/running-cucumber-tests-with-jenkins-a5a3a8df07eb\r\n\r\n- When your cucumber project passes, then write a script in Jenkins to deploy into production (This would be a separate stage in Jenkins). Although I would recommend you to deploy this into a staging server or something like [Artifactory][1], which would hold your release package and have a manual step to deploy into production.\r\n\r\n\r\n\r\nFinally here is a detailed article that gives step by step explanation of how you could integrate NoCodeBDD with Jenkins. Though this article is for NoCodeBDD, you could copy these steps and apply them for any BDD project by changing some parts of the script.\r\n\r\nhttps://blog.nocodebdd.com/integrate-nocodebdd-and-jenkins-to-run-bdd/\r\n\r\n\r\n  [1]: https://jfrog.com/artifactory/","title":"Build the testing repo before deploying to production in Jenkins","body":"<p>You need to configure this in a CI server such as Jenkins.</p>\n<p>You can consider these steps, when setting up Jenkins, to achieve your use case:</p>\n<ul>\n<li><p>Use Git-hooks; This will trigger a Jenkins pipeline as soon you merge a branch into the master. Check this article for more info <a href=\"https://kohsuke.org/2011/12/01/polling-must-die-triggering-jenkins-builds-from-a-git-hook/\" rel=\"nofollow noreferrer\">https://kohsuke.org/2011/12/01/polling-must-die-triggering-jenkins-builds-from-a-git-hook/</a></p>\n</li>\n<li><p>Then in Jenkins, run your BDD project. Here is a nice article, which explains how cucumber projects are setup and run in Jenkins:\n<a href=\"https://faun.pub/running-cucumber-tests-with-jenkins-a5a3a8df07eb\" rel=\"nofollow noreferrer\">https://faun.pub/running-cucumber-tests-with-jenkins-a5a3a8df07eb</a></p>\n</li>\n<li><p>When your cucumber project passes, then write a script in Jenkins to deploy into production (This would be a separate stage in Jenkins). Although I would recommend you to deploy this into a staging server or something like <a href=\"https://jfrog.com/artifactory/\" rel=\"nofollow noreferrer\">Artifactory</a>, which would hold your release package and have a manual step to deploy into production.</p>\n</li>\n</ul>\n<p>Finally here is a detailed article that gives step by step explanation of how you could integrate NoCodeBDD with Jenkins. Though this article is for NoCodeBDD, you could copy these steps and apply them for any BDD project by changing some parts of the script.</p>\n<p><a href=\"https://blog.nocodebdd.com/integrate-nocodebdd-and-jenkins-to-run-bdd/\" rel=\"nofollow noreferrer\">https://blog.nocodebdd.com/integrate-nocodebdd-and-jenkins-to-run-bdd/</a></p>\n"}],"owner":{"account_id":21820910,"reputation":58,"user_id":16117120,"display_name":"SmriG6"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":254,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1656341773,"creation_date":1656011841,"question_id":72735496,"body_markdown":"So I have a BDD testing project for a service and what I want is that as soon as I merge a branch into the master branch of that service then that BDD testing should be triggered first and if every test case passes then only it should allow to deploy the service to production.\r\nThe BDD is written in Cucumber-Java.","title":"Build the testing repo before deploying to production in Jenkins","body":"<p>So I have a BDD testing project for a service and what I want is that as soon as I merge a branch into the master branch of that service then that BDD testing should be triggered first and if every test case passes then only it should allow to deploy the service to production.\nThe BDD is written in Cucumber-Java.</p>\n"},{"tags":["java","collections","java-stream"],"comments":[{"owner":{"account_id":1937019,"reputation":4428,"user_id":1744230,"accept_rate":100,"display_name":"QBrute"},"score":0,"creation_date":1635937998,"post_id":69823827,"comment_id":123423546,"body_markdown":"Why do you want to turn this into a stream? What&#39;s wrong with your current approach?","body":"Why do you want to turn this into a stream? What&#39;s wrong with your current approach?"},{"owner":{"account_id":1485367,"reputation":122993,"user_id":1393766,"display_name":"Pshemo"},"score":3,"creation_date":1635938027,"post_id":69823827,"comment_id":123423557,"body_markdown":"How about `spQuery = spQuery +&quot;?,&quot;.repeat(list.size())`?","body":"How about <code>spQuery = spQuery +&quot;?,&quot;.repeat(list.size())</code>?"},{"owner":{"account_id":20382503,"reputation":244,"user_id":14952296,"display_name":"stephane brun"},"score":0,"creation_date":1635938519,"post_id":69823827,"comment_id":123423732,"body_markdown":"Btw, using += inside a loop to build a string is FORBIDDEN","body":"Btw, using += inside a loop to build a string is FORBIDDEN"},{"owner":{"account_id":1485367,"reputation":122993,"user_id":1393766,"display_name":"Pshemo"},"score":0,"creation_date":1635938673,"post_id":69823827,"comment_id":123423779,"body_markdown":"@stephanebrun Note there are two kinds of `+` (1) addition and (2) concatenation.","body":"@stephanebrun Note there are two kinds of <code>+</code> (1) addition and (2) concatenation."},{"owner":{"account_id":1485367,"reputation":122993,"user_id":1393766,"display_name":"Pshemo"},"score":0,"creation_date":1635940843,"post_id":69823827,"comment_id":123424582,"body_markdown":"@Hulk &quot;*…I want to convert above code to Java 8 Streams*&quot; requirement prevents me from posting it as an answer.","body":"@Hulk &quot;<i>…I want to convert above code to Java 8 Streams</i>&quot; requirement prevents me from posting it as an answer."},{"owner":{"account_id":2933712,"reputation":6419,"user_id":2513200,"accept_rate":83,"display_name":"Hulk"},"score":0,"creation_date":1635940987,"post_id":69823827,"comment_id":123424638,"body_markdown":"@Pshemo agreed. My proposed duplicate provides a stream solution and a `String.repeat` solution, so I guess there is no need to add another answer.","body":"@Pshemo agreed. My proposed duplicate provides a stream solution and a <code>String.repeat</code> solution, so I guess there is no need to add another answer."},{"owner":{"account_id":2933712,"reputation":6419,"user_id":2513200,"accept_rate":83,"display_name":"Hulk"},"score":0,"creation_date":1635941576,"post_id":69823827,"comment_id":123424906,"body_markdown":"Also related: https://stackoverflow.com/questions/3107044/preparedstatement-with-list-of-parameters-in-a-in-clause","body":"Also related: <a href=\"https://stackoverflow.com/questions/3107044/preparedstatement-with-list-of-parameters-in-a-in-clause\" title=\"preparedstatement with list of parameters in a in clause\">stackoverflow.com/questions/3107044/&hellip;</a>"}],"answers":[{"tags":[],"owner":{"account_id":1937019,"reputation":4428,"user_id":1744230,"accept_rate":100,"display_name":"QBrute"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1635938642,"creation_date":1635938642,"answer_id":69823999,"question_id":69823827,"body_markdown":"Streams shouldn&#39;t be used just for the stream&#39;s sake. They&#39;re a powerful tool when it comes to transforming data in a fluent way, but for simple tasks like this they are overkill and the code will be harder to understand.\r\n\r\nYou *could* potentially do this with\r\n\r\n    String s = Stream.generate(() -&gt; &quot;?&quot;).limit(list.size()).collect(Collectors.joining(&quot;,&quot;));\r\n\r\nBut compare it to the much easier version that you already have: \r\n\r\n    for(int i = 0; i&lt;list.size(); i++) {\r\n        spQuery = spQuery + &quot;?,&quot;;\r\n    }\r\n\r\nHere you can see at a glance what you want to do without the need to dissect the stream expression.","title":"Iterate over list in java using Java 8 Streams without values","body":"<p>Streams shouldn't be used just for the stream's sake. They're a powerful tool when it comes to transforming data in a fluent way, but for simple tasks like this they are overkill and the code will be harder to understand.</p>\n<p>You <em>could</em> potentially do this with</p>\n<pre><code>String s = Stream.generate(() -&gt; &quot;?&quot;).limit(list.size()).collect(Collectors.joining(&quot;,&quot;));\n</code></pre>\n<p>But compare it to the much easier version that you already have:</p>\n<pre><code>for(int i = 0; i&lt;list.size(); i++) {\n    spQuery = spQuery + &quot;?,&quot;;\n}\n</code></pre>\n<p>Here you can see at a glance what you want to do without the need to dissect the stream expression.</p>\n"},{"tags":[],"owner":{"account_id":9607023,"reputation":281,"user_id":7132739,"display_name":"The Frozen One"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1635939207,"creation_date":1635939207,"answer_id":69824112,"question_id":69823827,"body_markdown":"If your List elements are of type String, it should be\r\n\r\n    String s = list.stream().collect(Collectors.joining(&quot;?,&quot;));\r\n    \r\nbut then, the last element is missing &quot;?,&quot; so if you also need the question mark after the last element, you end up with\r\n\r\n    String s = list.stream().collect(Collectors.joining(&quot;?,&quot;)).concat(&quot;?,&quot;);\r\n\r\nIn general, if you have multiple appends/concatenations to a String, it&#39;s way more performant to use a StringBuffer or StringBuilder (String is an immutable Object).\r\n\r\nIf the list elements are of a different type than String, you have to map your object to a String representation, like\r\n\r\n    String s = list.stream().map(listElement -&gt; &lt;&lt;some code that returns a String representation of the element&gt;&gt;)).collect(Collectors.joining(&quot;?,&quot;)).concat(&quot;?,&quot;);","title":"Iterate over list in java using Java 8 Streams without values","body":"<p>If your List elements are of type String, it should be</p>\n<pre><code>String s = list.stream().collect(Collectors.joining(&quot;?,&quot;));\n</code></pre>\n<p>but then, the last element is missing &quot;?,&quot; so if you also need the question mark after the last element, you end up with</p>\n<pre><code>String s = list.stream().collect(Collectors.joining(&quot;?,&quot;)).concat(&quot;?,&quot;);\n</code></pre>\n<p>In general, if you have multiple appends/concatenations to a String, it's way more performant to use a StringBuffer or StringBuilder (String is an immutable Object).</p>\n<p>If the list elements are of a different type than String, you have to map your object to a String representation, like</p>\n<pre><code>String s = list.stream().map(listElement -&gt; &lt;&lt;some code that returns a String representation of the element&gt;&gt;)).collect(Collectors.joining(&quot;?,&quot;)).concat(&quot;?,&quot;);\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1891014,"reputation":3150,"user_id":1709089,"display_name":"dajavax"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1636001145,"creation_date":1636001145,"answer_id":69834625,"question_id":69823827,"body_markdown":"You might be trying to do the following:\r\n```java\r\nString spQuery = list.stream().map(e -&gt; &quot;?&quot;).collect(Collectors.joining(&quot;,&quot;));\r\n```\r\nAs you don&#39;t need the list&#39;s elements, I would prefer:\r\n```java\r\nString spQuery = IntStream.range(0, list.size()).mapToObj(i -&gt; &quot;?&quot;).collect(Collectors.joining(&quot;,&quot;));\r\n```\r\nYou can probably store the `&quot;?&quot;` in a variable before to avoid instantiating it each time.\r\n\r\nHowever, as everyone else has said, you shouldn&#39;t use streams just because you can. If it gives no benefit, then, why?\r\n\r\nYou could just use a `StringJoiner` with a for loop to add it a number of times.","title":"Iterate over list in java using Java 8 Streams without values","body":"<p>You might be trying to do the following:</p>\n<pre class=\"lang-java prettyprint-override\"><code>String spQuery = list.stream().map(e -&gt; &quot;?&quot;).collect(Collectors.joining(&quot;,&quot;));\n</code></pre>\n<p>As you don't need the list's elements, I would prefer:</p>\n<pre class=\"lang-java prettyprint-override\"><code>String spQuery = IntStream.range(0, list.size()).mapToObj(i -&gt; &quot;?&quot;).collect(Collectors.joining(&quot;,&quot;));\n</code></pre>\n<p>You can probably store the <code>&quot;?&quot;</code> in a variable before to avoid instantiating it each time.</p>\n<p>However, as everyone else has said, you shouldn't use streams just because you can. If it gives no benefit, then, why?</p>\n<p>You could just use a <code>StringJoiner</code> with a for loop to add it a number of times.</p>\n"}],"owner":{"account_id":6911888,"reputation":161,"user_id":5307407,"accept_rate":70,"display_name":"Nitin Rathod"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":500,"favorite_count":0,"down_vote_count":2,"up_vote_count":0,"closed_date":1636450389,"answer_count":3,"score":-2,"last_activity_date":1656341771,"creation_date":1635937845,"question_id":69823827,"body_markdown":"I want a way to iterate over a list without actual using values of it and creating a parameterized String with &quot;?&quot; for Query.\r\n\r\n     for(int i = 0; i&lt;list.size(); i++)\r\n\t {\r\n\t\tspQuery = spQuery + &quot;?,&quot;;\r\n\t }\r\n\r\nI want to convert above code to Java 8 Streams code.\r\nFinal Answer should be something like this - ?,?,?,?...n where n is size of the list","title":"Iterate over list in java using Java 8 Streams without values","body":"<p>I want a way to iterate over a list without actual using values of it and creating a parameterized String with &quot;?&quot; for Query.</p>\n<pre><code> for(int i = 0; i&lt;list.size(); i++)\n {\n    spQuery = spQuery + &quot;?,&quot;;\n }\n</code></pre>\n<p>I want to convert above code to Java 8 Streams code.\nFinal Answer should be something like this - ?,?,?,?...n where n is size of the list</p>\n"},{"tags":["java","static","program-entry-point","void","public"],"comments":[{"owner":{"display_name":"user330315"},"score":1,"creation_date":1447743370,"post_id":29276917,"comment_id":55269435,"body_markdown":"http://docs.oracle.com/javase/tutorial/getStarted/application/index.html","body":"<a href=\"http://docs.oracle.com/javase/tutorial/getStarted/application/index.html\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/tutorial/getStarted/application/&hellip;</a>"}],"answers":[{"tags":[],"owner":{"account_id":3174063,"reputation":1145,"user_id":2682363,"accept_rate":100,"display_name":"Vivek Aditya"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1448094244,"creation_date":1427368438,"answer_id":29277008,"question_id":29276917,"body_markdown":"\r\n`public` --&gt; Access specifier. Any other class can access this method.\r\n\r\n`static` --&gt; The method is bound to the class, not to an instance of the class.\r\n\r\n`void` --&gt; Return type. The method doesn&#39;t return anything.\r\n\r\n`main(String[] args)` --&gt; method name is `main()`. It takes an array of String&#39;s as argument. The `String[]` args are command line arguments.\r\n\r\n*Note*: The `main()` method defined above is the entry point of a program, if you change the signature, then your program might not run.\r\n","title":"What does `public static void main args` mean?","body":"<p><code>public</code> --> Access specifier. Any other class can access this method.</p>\n\n<p><code>static</code> --> The method is bound to the class, not to an instance of the class.</p>\n\n<p><code>void</code> --> Return type. The method doesn't return anything.</p>\n\n<p><code>main(String[] args)</code> --> method name is <code>main()</code>. It takes an array of String's as argument. The <code>String[]</code> args are command line arguments.</p>\n\n<p><em>Note</em>: The <code>main()</code> method defined above is the entry point of a program, if you change the signature, then your program might not run.</p>\n"},{"tags":[],"owner":{"account_id":2335531,"reputation":180,"user_id":2047975,"accept_rate":100,"display_name":"Frunk"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1448094053,"creation_date":1427368548,"answer_id":29277040,"question_id":29276917,"body_markdown":" - `Public`  =  This method is visible to all other classes.\r\n   \r\n   \r\n - `static` = This method doesn&#39;t need an instance to be ran.\r\n\r\n   \r\n  \r\n\r\n - `void` = This method doesn&#39;t return anything.\r\n\r\n   \r\n   \r\n\r\n - `main()` = Main method (First method to run).\r\n\r\n   \r\n   \r\n\r\n - `String[]` = Array of strings.\r\n\r\n   \r\n  \r\n\r\n - `args` = Array name.","title":"What does `public static void main args` mean?","body":"<ul>\n<li><p><code>Public</code>  =  This method is visible to all other classes.</p></li>\n<li><p><code>static</code> = This method doesn't need an instance to be ran.</p></li>\n<li><p><code>void</code> = This method doesn't return anything.</p></li>\n<li><p><code>main()</code> = Main method (First method to run).</p></li>\n<li><p><code>String[]</code> = Array of strings.</p></li>\n<li><p><code>args</code> = Array name.</p></li>\n</ul>\n"},{"tags":[],"owner":{"account_id":2176629,"reputation":2724,"user_id":1927175,"accept_rate":100,"display_name":"Giri"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1448093496,"creation_date":1428607118,"answer_id":29547096,"question_id":29276917,"body_markdown":"According to the [Java language specification][1], a Java program&#39;s execution starts from main() method. A main() method should follow the specific syntax, it can be explained as:\r\n\r\n    public static void main(String[] args)\r\n`public` - Access specifier, shows that `main()` is accessible to all other classes. \r\n\r\n`void` - return type, `main()` returns nothing. \r\n\r\n`String args[]` - arguments to the `main()` method, which should an array of type string. \r\n\r\n`static` - Access modifier. A main method should always be static, because the `main()&#39; method can be called without creating an instance of the class. \r\n\r\nLet us assume, we are executing a Helloworld java program. \r\n\r\nWhile executing the program, we use the command \r\n\r\n    java Helloworld.\r\n\r\nInternally, this command is converted into \r\n\r\n    Helloworld.main()\r\n\r\nBy making `main()` method static, JVM calls the `main()` method without creating an object first.  \r\n\r\n  \r\n\r\n\r\n  [1]: http://docs.oracle.com/javase/specs/","title":"What does `public static void main args` mean?","body":"<p>According to the <a href=\"http://docs.oracle.com/javase/specs/\" rel=\"nofollow\">Java language specification</a>, a Java program's execution starts from main() method. A main() method should follow the specific syntax, it can be explained as:</p>\n\n<pre><code>public static void main(String[] args)\n</code></pre>\n\n<p><code>public</code> - Access specifier, shows that <code>main()</code> is accessible to all other classes. </p>\n\n<p><code>void</code> - return type, <code>main()</code> returns nothing. </p>\n\n<p><code>String args[]</code> - arguments to the <code>main()</code> method, which should an array of type string. </p>\n\n<p><code>static</code> - Access modifier. A main method should always be static, because the `main()' method can be called without creating an instance of the class. </p>\n\n<p>Let us assume, we are executing a Helloworld java program. </p>\n\n<p>While executing the program, we use the command </p>\n\n<pre><code>java Helloworld.\n</code></pre>\n\n<p>Internally, this command is converted into </p>\n\n<pre><code>Helloworld.main()\n</code></pre>\n\n<p>By making <code>main()</code> method static, JVM calls the <code>main()</code> method without creating an object first.  </p>\n"},{"tags":[],"owner":{"account_id":356260,"reputation":2426,"user_id":695657,"accept_rate":78,"display_name":"Sai Upadhyayula"},"down_vote_count":0,"up_vote_count":21,"is_accepted":false,"score":21,"last_activity_date":1448092883,"creation_date":1428607467,"answer_id":29547192,"question_id":29276917,"body_markdown":"Here is a little bit detailed explanation on why main method is declared as \r\n\r\n    public static void main(String[] args)\r\n\r\nMain method is the entry point of a Java program for the Java Virtual Machine(JVM). Let&#39;s say we have a class called `Sample`\r\n\r\n    class Sample {\r\n         static void fun()\r\n         {\r\n               System.out.println(&quot;Hello&quot;);       \r\n         }  \r\n     }\r\n    \r\n    class Test {\r\n          public static void main(String[] args)\r\n          {\r\n                    Sample.fun();\r\n          }  \r\n    }\r\n\r\nThis program will be executed after compilation as `java Test`. The `java` command will start the JVM and it will load our `Test.java` class into the memory. As main is the entry point for our program, JVM will search for main method which is declared as `public`, `static` and `void`.\r\n\r\n&gt;**Why main must be declared public?**\r\n\r\n`main()` must be declared `public` because as we know it is invoked by JVM whenever the program execution starts and JVM does not belong to our program package.\r\n\r\nIn order to access main outside the package we have to declare it as `public`. If we declare it as anything other than `public` it shows a `Run time Error` but not `Compilation time error`.\r\n\r\n&gt;**Why main must be declared static?**\r\n\r\n`main()` must be declared as static because JVM does not know how to create an object of a class, so it needs a standard way to access the main method which is possible by declaring `main()` as `static`.\r\n\r\nIf a method is declared as `static` then we can call that method outside the class without creating an object using the syntax `ClassName.methodName();`.\r\n\r\nSo in this way JVM can call our main method as `&lt;ClassName&gt;.&lt;Main-Method&gt;`\r\n\r\n&gt;**Why main must be declared void?**\r\n\r\n`main()` must be declared void because JVM is not expecting any value from `main()`. So,it must be declared as `void`.\r\n\r\nIf other return type is provided,the it is a `RunTimeError` i.e., `NoSuchMethodFoundError`.\r\n\r\n&gt;**Why main must have String Array Arguments?**\r\n\r\n`main(`) must have String arguments as arrays because JVM calls main method by passing command line argument. As they are stored in string array object it is passed as an argument to `main()`.","title":"What does `public static void main args` mean?","body":"<p>Here is a little bit detailed explanation on why main method is declared as </p>\n\n<pre><code>public static void main(String[] args)\n</code></pre>\n\n<p>Main method is the entry point of a Java program for the Java Virtual Machine(JVM). Let's say we have a class called <code>Sample</code></p>\n\n<pre><code>class Sample {\n     static void fun()\n     {\n           System.out.println(\"Hello\");       \n     }  \n }\n\nclass Test {\n      public static void main(String[] args)\n      {\n                Sample.fun();\n      }  \n}\n</code></pre>\n\n<p>This program will be executed after compilation as <code>java Test</code>. The <code>java</code> command will start the JVM and it will load our <code>Test.java</code> class into the memory. As main is the entry point for our program, JVM will search for main method which is declared as <code>public</code>, <code>static</code> and <code>void</code>.</p>\n\n<blockquote>\n  <p><strong>Why main must be declared public?</strong></p>\n</blockquote>\n\n<p><code>main()</code> must be declared <code>public</code> because as we know it is invoked by JVM whenever the program execution starts and JVM does not belong to our program package.</p>\n\n<p>In order to access main outside the package we have to declare it as <code>public</code>. If we declare it as anything other than <code>public</code> it shows a <code>Run time Error</code> but not <code>Compilation time error</code>.</p>\n\n<blockquote>\n  <p><strong>Why main must be declared static?</strong></p>\n</blockquote>\n\n<p><code>main()</code> must be declared as static because JVM does not know how to create an object of a class, so it needs a standard way to access the main method which is possible by declaring <code>main()</code> as <code>static</code>.</p>\n\n<p>If a method is declared as <code>static</code> then we can call that method outside the class without creating an object using the syntax <code>ClassName.methodName();</code>.</p>\n\n<p>So in this way JVM can call our main method as <code>&lt;ClassName&gt;.&lt;Main-Method&gt;</code></p>\n\n<blockquote>\n  <p><strong>Why main must be declared void?</strong></p>\n</blockquote>\n\n<p><code>main()</code> must be declared void because JVM is not expecting any value from <code>main()</code>. So,it must be declared as <code>void</code>.</p>\n\n<p>If other return type is provided,the it is a <code>RunTimeError</code> i.e., <code>NoSuchMethodFoundError</code>.</p>\n\n<blockquote>\n  <p><strong>Why main must have String Array Arguments?</strong></p>\n</blockquote>\n\n<p><code>main(</code>) must have String arguments as arrays because JVM calls main method by passing command line argument. As they are stored in string array object it is passed as an argument to <code>main()</code>.</p>\n"},{"tags":[],"owner":{"account_id":3953687,"reputation":11,"user_id":3263024,"display_name":"vineeth"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1448094063,"creation_date":1447742652,"answer_id":33750707,"question_id":29276917,"body_markdown":"In Java your main method must always be:\r\n\r\n    public static void main(String args[])\r\n\r\n\r\n1. The program execution starts with `main()` function, hence the `main()` function. \r\n\r\n2. It must be `public` so that it is accessible to the outside environment.\r\n\r\n3. The `main()` method is always static because, as you know that the program execution starts at `main()` method and there is no instance of the class containing `main()` method is initiated. Hence as the static method can run without need of any instance it is declared of static.\r\n\r\n4. Java is platform independent, hence you may try to compile the java file on one system and try to execute the class file on another. Each machines&#39; bit architecture may be different hence the return type of the main function must always be `main()`.\r\n\r\nHope this helps.","title":"What does `public static void main args` mean?","body":"<p>In Java your main method must always be:</p>\n\n<pre><code>public static void main(String args[])\n</code></pre>\n\n<ol>\n<li><p>The program execution starts with <code>main()</code> function, hence the <code>main()</code> function. </p></li>\n<li><p>It must be <code>public</code> so that it is accessible to the outside environment.</p></li>\n<li><p>The <code>main()</code> method is always static because, as you know that the program execution starts at <code>main()</code> method and there is no instance of the class containing <code>main()</code> method is initiated. Hence as the static method can run without need of any instance it is declared of static.</p></li>\n<li><p>Java is platform independent, hence you may try to compile the java file on one system and try to execute the class file on another. Each machines' bit architecture may be different hence the return type of the main function must always be <code>main()</code>.</p></li>\n</ol>\n\n<p>Hope this helps.</p>\n"},{"tags":[],"owner":{"account_id":13584103,"reputation":1,"user_id":9799286,"display_name":"Payel Roy"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1656341463,"creation_date":1656341463,"answer_id":72774117,"question_id":29276917,"body_markdown":"Please go through this video link -&gt;\r\nhttps://youtu.be/ggsRGcA8hnQVery for a clear and to the point explanation of public static void main(String args[]) method.\r\n","title":"What does `public static void main args` mean?","body":"<p>Please go through this video link -&gt;\n<a href=\"https://youtu.be/ggsRGcA8hnQVery\" rel=\"nofollow noreferrer\">https://youtu.be/ggsRGcA8hnQVery</a> for a clear and to the point explanation of public static void main(String args[]) method.</p>\n"}],"owner":{"account_id":5997762,"reputation":101,"user_id":4711962,"accept_rate":0,"display_name":"Nick Nicholas"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":26739,"favorite_count":0,"down_vote_count":0,"up_vote_count":7,"answer_count":6,"score":7,"last_activity_date":1656341463,"creation_date":1427368184,"question_id":29276917,"body_markdown":"I am not sure what this means, whenever before you write a code, people say this \r\n\r\n    public static void main(String[] args) {\r\n\r\nWhat does that mean?","title":"What does `public static void main args` mean?","body":"<p>I am not sure what this means, whenever before you write a code, people say this </p>\n\n<pre><code>public static void main(String[] args) {\n</code></pre>\n\n<p>What does that mean?</p>\n"},{"tags":["java","android"],"comments":[{"owner":{"account_id":2563335,"reputation":133,"user_id":2224008,"display_name":"Jszn"},"score":0,"creation_date":1643297002,"post_id":68368188,"comment_id":125306776,"body_markdown":"You are calling purchase too early, your IAP isnt yet ready I think..","body":"You are calling purchase too early, your IAP isnt yet ready I think.."}],"answers":[{"tags":[],"owner":{"account_id":1171261,"reputation":702,"user_id":1148405,"display_name":"Cesar"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656341253,"creation_date":1656341253,"answer_id":72774056,"question_id":68368188,"body_markdown":"You need to call `registerListener` in your Application&#39;s `onCreate`, otherwise Amazon fails to detect there&#39;s an Activity being displayed and it will not show the purchase dialog.","title":"Amazon IAP not launching purchase dialog","body":"<p>You need to call <code>registerListener</code> in your Application's <code>onCreate</code>, otherwise Amazon fails to detect there's an Activity being displayed and it will not show the purchase dialog.</p>\n"}],"owner":{"account_id":6526701,"reputation":319,"user_id":5049238,"accept_rate":25,"display_name":"androidexpert35"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":384,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":1,"score":2,"last_activity_date":1656341253,"creation_date":1626203604,"question_id":68368188,"body_markdown":"I&#39;m migrating an app from the play store to the Amazon App store, considering that in this way it will be avilable for Windows 11 too.\r\n\r\nFor this to make something very fast and easy i made an activity called PurchaseActivity which contains the codes brought by the amazon IAP guide PDF.\r\n\r\nThe activity is called from a &quot;buy now&quot; button of a dialog window with the following code:\r\n\r\n    public class PurchaseActivity extends Activity {\r\n    String parentSKU = &quot;com.amazon.sample.iap.subscription.mymagazine&quot;;\r\n    //Define UserId and MarketPlace\r\n    private String currentUserId;\r\n    private String currentMarketplace;\r\n    private ProgressDialog progress;\r\n\r\n    @Override\r\n    protected void onStart(){\r\n        super.onStart();\r\n        progress = new ProgressDialog(this);\r\n        progress.setTitle(&quot;Purchasing&quot;);\r\n        progress.setMessage(&quot;Wait while making the purchase...&quot;);\r\n        progress.setButton(DialogInterface.BUTTON_NEGATIVE, &quot;Cancel&quot;, new DialogInterface.OnClickListener() {\r\n            @Override\r\n            public void onClick(DialogInterface dialog, int which) {\r\n                progress.dismiss();//dismiss dialog\r\n                finish();\r\n            }\r\n        });\r\n        progress.setCancelable(false); // disable dismiss by tapping outside of the dialog\r\n        progress.show();\r\n\r\n        PurchasingService.registerListener(this, purchasingListener);\r\n\r\n        PurchasingService.purchase(parentSKU);\r\n    }\r\n\r\n    @Override\r\n    protected void onResume() {\r\n        super.onResume();\r\n\r\n        //getUserData() will query the Appstore for the Users information\r\n        PurchasingService.getUserData();\r\n        //getPurchaseUpdates() will query the Appstore for any previous purchase\r\n        PurchasingService.getPurchaseUpdates(true);\r\n        //getProductData will validate the SKUs with Amazon Appstore\r\n        final Set&lt;String&gt; productSkus = new HashSet&lt;String&gt;();\r\n        productSkus.add(parentSKU);\r\n        PurchasingService.getProductData(productSkus);\r\n        Log.v(&quot;Validating SKUs&quot;, &quot;Validating SKUs with Amazon&quot;);\r\n    }\r\n\r\n\r\n    PurchasingListener purchasingListener = new PurchasingListener() {\r\n        @Override\r\n        public void onUserDataResponse(UserDataResponse response) {\r\n            final UserDataResponse.RequestStatus status = response.getRequestStatus();\r\n            switch (status) {\r\n                case SUCCESSFUL:\r\n                    currentUserId = response.getUserData().getUserId();\r\n                    currentMarketplace = response.getUserData().getMarketplace();\r\n                    Log.v(&quot;IAP SDK&quot;, &quot;loaded userdataResponse&quot;);\r\n                    break;\r\n                case FAILED:\r\n                case NOT_SUPPORTED:\r\n                    // Fail gracefully.\r\n                    Log.v(&quot;IAP SDK&quot;, &quot;loading failed&quot;);\r\n                    break;\r\n            }\r\n        }\r\n\r\n        @Override\r\n        public void onProductDataResponse(ProductDataResponse productDataResponse) {\r\n            switch (productDataResponse.getRequestStatus()) {\r\n                case SUCCESSFUL:\r\n\r\n                    //get informations for all IAP Items (parent SKUs)\r\n                    final Map&lt;String, Product&gt; products = productDataResponse.getProductData();\r\n                    for (String key : products.keySet()) {\r\n                        Product product = products.get(key);\r\n                        Log.v(&quot;Product:&quot;, String.format(&quot;Product: %s\\n Type: %s\\n SKU: %s\\n Price: %s\\n Description: %s\\n&quot;, product.getTitle(), product.getProductType(),\r\n                                product.getSku(), product.getPrice(), product.getDescription()));\r\n                    }\r\n                    //get all unavailable SKUs\r\n                    for (String s : productDataResponse.getUnavailableSkus()) {\r\n                        Log.v(&quot;Unavailable SKU:&quot; + s, &quot;Unavailable SKU:&quot; + s);\r\n                    }\r\n                    break;\r\n                case FAILED:\r\n                    Log.v(&quot;FAILED&quot;, &quot;FAILED&quot;);\r\n                    progress.dismiss();\r\n                    finish();\r\n                    break;\r\n            }\r\n        }\r\n\r\n        @Override\r\n        public void onPurchaseResponse(PurchaseResponse purchaseResponse) {\r\n            switch (purchaseResponse.getRequestStatus()) {\r\n                case SUCCESSFUL:\r\n                    PurchasingService.notifyFulfillment(purchaseResponse.getReceipt().getReceiptId(),\r\n                            FulfillmentResult.FULFILLED);\r\n                    break;\r\n                case FAILED:\r\n                    progress.dismiss();\r\n                    finish();\r\n                    break;\r\n            }\r\n        }\r\n\r\n        @Override\r\n        public void onPurchaseUpdatesResponse(PurchaseUpdatesResponse response) {\r\n\r\n            // Process receipts\r\n            switch (response.getRequestStatus()) {\r\n                case SUCCESSFUL:\r\n                    for (final Receipt receipt : response.getReceipts()) {\r\n                        // Process receipts\r\n                        if (!receipt.isCanceled()) {\r\n                            // sharedprefs\r\n                             SharedPreferences sharedPreference = PreferenceManager.getDefaultSharedPreferences(getApplicationContext());\r\n                            SharedPreferences.Editor sharedPrefEditor = sharedPreference.edit();\r\n                            sharedPrefEditor.putBoolean(&quot;isPro&quot;,true);\r\n                            sharedPrefEditor.apply();\r\n                            progress.dismiss();\r\n                            finish();\r\n                        }\r\n                    }\r\n                    if (response.hasMore()) {\r\n                        PurchasingService.getPurchaseUpdates(true);\r\n                    }\r\n                    break;\r\n                case FAILED:\r\n                    Log.d(&quot;FAILED&quot;, &quot;FAILED&quot;);\r\n                    progress.dismiss();\r\n                    finish();\r\n                    break;\r\n            }\r\n        }\r\n    };\r\n\r\n}\r\n\r\nYeah i know i should not call all that stuff in the onStart() method but i&#39;ll make an onCreate() with a UI later.\r\n\r\nAs you can see from this code, i&#39;m testing in sandbox mode.\r\n\r\nTHE PROBLEM: Actually when the activity starts, i see progressDialog, and i read in the debug logs that &quot;V/Validating&#160;SKUs: Validating SKUs with Amazon&quot; but i don&#39;t see then the amazon buy window. It also seems like the listener code is never called, even if i put some breakpoints in there, they&#39;re never reached which is very weird considering that apprently it gets initialized and called successfully by the method &quot;PurchasingService.registerListener(this, purchasingListener)&quot;\r\n\r\nAny help would be very apreciated!\r\n\r\nThanks and have a good evening","title":"Amazon IAP not launching purchase dialog","body":"<p>I'm migrating an app from the play store to the Amazon App store, considering that in this way it will be avilable for Windows 11 too.</p>\n<p>For this to make something very fast and easy i made an activity called PurchaseActivity which contains the codes brought by the amazon IAP guide PDF.</p>\n<p>The activity is called from a &quot;buy now&quot; button of a dialog window with the following code:</p>\n<pre><code>public class PurchaseActivity extends Activity {\nString parentSKU = &quot;com.amazon.sample.iap.subscription.mymagazine&quot;;\n//Define UserId and MarketPlace\nprivate String currentUserId;\nprivate String currentMarketplace;\nprivate ProgressDialog progress;\n\n@Override\nprotected void onStart(){\n    super.onStart();\n    progress = new ProgressDialog(this);\n    progress.setTitle(&quot;Purchasing&quot;);\n    progress.setMessage(&quot;Wait while making the purchase...&quot;);\n    progress.setButton(DialogInterface.BUTTON_NEGATIVE, &quot;Cancel&quot;, new DialogInterface.OnClickListener() {\n        @Override\n        public void onClick(DialogInterface dialog, int which) {\n            progress.dismiss();//dismiss dialog\n            finish();\n        }\n    });\n    progress.setCancelable(false); // disable dismiss by tapping outside of the dialog\n    progress.show();\n\n    PurchasingService.registerListener(this, purchasingListener);\n\n    PurchasingService.purchase(parentSKU);\n}\n\n@Override\nprotected void onResume() {\n    super.onResume();\n\n    //getUserData() will query the Appstore for the Users information\n    PurchasingService.getUserData();\n    //getPurchaseUpdates() will query the Appstore for any previous purchase\n    PurchasingService.getPurchaseUpdates(true);\n    //getProductData will validate the SKUs with Amazon Appstore\n    final Set&lt;String&gt; productSkus = new HashSet&lt;String&gt;();\n    productSkus.add(parentSKU);\n    PurchasingService.getProductData(productSkus);\n    Log.v(&quot;Validating SKUs&quot;, &quot;Validating SKUs with Amazon&quot;);\n}\n\n\nPurchasingListener purchasingListener = new PurchasingListener() {\n    @Override\n    public void onUserDataResponse(UserDataResponse response) {\n        final UserDataResponse.RequestStatus status = response.getRequestStatus();\n        switch (status) {\n            case SUCCESSFUL:\n                currentUserId = response.getUserData().getUserId();\n                currentMarketplace = response.getUserData().getMarketplace();\n                Log.v(&quot;IAP SDK&quot;, &quot;loaded userdataResponse&quot;);\n                break;\n            case FAILED:\n            case NOT_SUPPORTED:\n                // Fail gracefully.\n                Log.v(&quot;IAP SDK&quot;, &quot;loading failed&quot;);\n                break;\n        }\n    }\n\n    @Override\n    public void onProductDataResponse(ProductDataResponse productDataResponse) {\n        switch (productDataResponse.getRequestStatus()) {\n            case SUCCESSFUL:\n\n                //get informations for all IAP Items (parent SKUs)\n                final Map&lt;String, Product&gt; products = productDataResponse.getProductData();\n                for (String key : products.keySet()) {\n                    Product product = products.get(key);\n                    Log.v(&quot;Product:&quot;, String.format(&quot;Product: %s\\n Type: %s\\n SKU: %s\\n Price: %s\\n Description: %s\\n&quot;, product.getTitle(), product.getProductType(),\n                            product.getSku(), product.getPrice(), product.getDescription()));\n                }\n                //get all unavailable SKUs\n                for (String s : productDataResponse.getUnavailableSkus()) {\n                    Log.v(&quot;Unavailable SKU:&quot; + s, &quot;Unavailable SKU:&quot; + s);\n                }\n                break;\n            case FAILED:\n                Log.v(&quot;FAILED&quot;, &quot;FAILED&quot;);\n                progress.dismiss();\n                finish();\n                break;\n        }\n    }\n\n    @Override\n    public void onPurchaseResponse(PurchaseResponse purchaseResponse) {\n        switch (purchaseResponse.getRequestStatus()) {\n            case SUCCESSFUL:\n                PurchasingService.notifyFulfillment(purchaseResponse.getReceipt().getReceiptId(),\n                        FulfillmentResult.FULFILLED);\n                break;\n            case FAILED:\n                progress.dismiss();\n                finish();\n                break;\n        }\n    }\n\n    @Override\n    public void onPurchaseUpdatesResponse(PurchaseUpdatesResponse response) {\n\n        // Process receipts\n        switch (response.getRequestStatus()) {\n            case SUCCESSFUL:\n                for (final Receipt receipt : response.getReceipts()) {\n                    // Process receipts\n                    if (!receipt.isCanceled()) {\n                        // sharedprefs\n                         SharedPreferences sharedPreference = PreferenceManager.getDefaultSharedPreferences(getApplicationContext());\n                        SharedPreferences.Editor sharedPrefEditor = sharedPreference.edit();\n                        sharedPrefEditor.putBoolean(&quot;isPro&quot;,true);\n                        sharedPrefEditor.apply();\n                        progress.dismiss();\n                        finish();\n                    }\n                }\n                if (response.hasMore()) {\n                    PurchasingService.getPurchaseUpdates(true);\n                }\n                break;\n            case FAILED:\n                Log.d(&quot;FAILED&quot;, &quot;FAILED&quot;);\n                progress.dismiss();\n                finish();\n                break;\n        }\n    }\n};\n</code></pre>\n<p>}</p>\n<p>Yeah i know i should not call all that stuff in the onStart() method but i'll make an onCreate() with a UI later.</p>\n<p>As you can see from this code, i'm testing in sandbox mode.</p>\n<p>THE PROBLEM: Actually when the activity starts, i see progressDialog, and i read in the debug logs that &quot;V/Validating SKUs: Validating SKUs with Amazon&quot; but i don't see then the amazon buy window. It also seems like the listener code is never called, even if i put some breakpoints in there, they're never reached which is very weird considering that apprently it gets initialized and called successfully by the method &quot;PurchasingService.registerListener(this, purchasingListener)&quot;</p>\n<p>Any help would be very apreciated!</p>\n<p>Thanks and have a good evening</p>\n"},{"tags":["java","spring","spring-el","spring-properties","property-placeholder"],"comments":[{"owner":{"account_id":7460722,"reputation":2445,"user_id":6203078,"accept_rate":94,"display_name":"Ami Hollander"},"score":0,"creation_date":1489222347,"post_id":42733067,"comment_id":72585006,"body_markdown":"is `double` works?","body":"is <code>double</code> works?"},{"owner":{"account_id":893749,"reputation":8510,"user_id":931511,"accept_rate":76,"display_name":"guilhebl"},"score":0,"creation_date":1489222640,"post_id":42733067,"comment_id":72585059,"body_markdown":"@AmiHollander it fails even for primitive type double","body":"@AmiHollander it fails even for primitive type double"}],"answers":[{"tags":[],"owner":{"account_id":1002712,"reputation":602,"user_id":1017216,"accept_rate":81,"display_name":"Vitali Pom"},"down_vote_count":2,"up_vote_count":0,"is_accepted":false,"score":-2,"last_activity_date":1489230636,"creation_date":1489230094,"answer_id":42734376,"question_id":42733067,"body_markdown":"How about storing a String and converting to numbers like integers and doubles through getters and setters? For safe code with Java injection you should always use getters and setters and only for other methods in any case. I advice you warmly to read about java security (Which is NOT for hackers), but more for code usage and writing likewise the one you uploaded, wich uses injection. ","title":"Spring @Value TypeMismatchException:Failed to convert value of type &#39;java.lang.String&#39; to required type &#39;java.lang.Double&#39;","body":"<p>How about storing a String and converting to numbers like integers and doubles through getters and setters? For safe code with Java injection you should always use getters and setters and only for other methods in any case. I advice you warmly to read about java security (Which is NOT for hackers), but more for code usage and writing likewise the one you uploaded, wich uses injection. </p>\n"},{"tags":[],"owner":{"account_id":4421189,"reputation":656,"user_id":3601099,"display_name":"pkoli"},"down_vote_count":1,"up_vote_count":8,"is_accepted":false,"score":7,"last_activity_date":1575381270,"creation_date":1489231592,"answer_id":42734588,"question_id":42733067,"body_markdown":"This should solve the problem-\r\n\r\n    @Value(&quot;#{T(Double).parseDouble(&#39;${item.priceFactor}&#39;)}&quot;)\r\n    private Double priceFactor;","title":"Spring @Value TypeMismatchException:Failed to convert value of type &#39;java.lang.String&#39; to required type &#39;java.lang.Double&#39;","body":"<p>This should solve the problem-</p>\n\n<pre><code>@Value(\"#{T(Double).parseDouble('${item.priceFactor}')}\")\nprivate Double priceFactor;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":10434393,"reputation":2167,"user_id":7693190,"accept_rate":89,"display_name":"bcr666"},"down_vote_count":1,"up_vote_count":85,"is_accepted":true,"score":84,"last_activity_date":1489237730,"creation_date":1489237730,"answer_id":42735568,"question_id":42733067,"body_markdown":"Try changing the following line\r\n\r\n    @Value(&quot;${item.priceFactor}&quot;)\r\n\r\nto\r\n\r\n    @Value(&quot;#{new Double(&#39;${item.priceFactor}&#39;)}&quot;)","title":"Spring @Value TypeMismatchException:Failed to convert value of type &#39;java.lang.String&#39; to required type &#39;java.lang.Double&#39;","body":"<p>Try changing the following line</p>\n\n<pre><code>@Value(\"${item.priceFactor}\")\n</code></pre>\n\n<p>to</p>\n\n<pre><code>@Value(\"#{new Double('${item.priceFactor}')}\")\n</code></pre>\n"},{"tags":[],"owner":{"account_id":6834766,"reputation":674,"user_id":5257218,"display_name":"Omar YAYA"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1621470257,"creation_date":1621470257,"answer_id":67612468,"question_id":42733067,"body_markdown":"I had a similar problem but instead of `required type &#39;java.lang.Double&#39;` it was `required type &#39;java.lang.Long&#39;`. I was using env. variables from a YAML file. Turns out YAML doesn&#39;t support the `Long` data type.","title":"Spring @Value TypeMismatchException:Failed to convert value of type &#39;java.lang.String&#39; to required type &#39;java.lang.Double&#39;","body":"<p>I had a similar problem but instead of <code>required type 'java.lang.Double'</code> it was <code>required type 'java.lang.Long'</code>. I was using env. variables from a YAML file. Turns out YAML doesn't support the <code>Long</code> data type.</p>\n"},{"tags":[],"owner":{"account_id":11658165,"reputation":11,"user_id":8537276,"display_name":"Bojan Antonović"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1640003700,"creation_date":1640003220,"answer_id":70421780,"question_id":42733067,"body_markdown":"You forgot the @PropertySource annotation with the name of the properties file as parameter.\r\n\r\nIt should come before or after your @Service annotation.\r\n\r\nPlease have a look for a working solution with @Configuration (the super type of @Service) at https://github.com/bojanantonovic/spring-properties-demo.","title":"Spring @Value TypeMismatchException:Failed to convert value of type &#39;java.lang.String&#39; to required type &#39;java.lang.Double&#39;","body":"<p>You forgot the @PropertySource annotation with the name of the properties file as parameter.</p>\n<p>It should come before or after your @Service annotation.</p>\n<p>Please have a look for a working solution with @Configuration (the super type of @Service) at <a href=\"https://github.com/bojanantonovic/spring-properties-demo\" rel=\"nofollow noreferrer\">https://github.com/bojanantonovic/spring-properties-demo</a>.</p>\n"},{"tags":[],"owner":{"account_id":1069576,"reputation":775,"user_id":1069186,"accept_rate":63,"display_name":"Coder17"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656341198,"creation_date":1656341198,"answer_id":72774045,"question_id":42733067,"body_markdown":"Below logic works for me without using new Double:\r\n\r\n    @Value(&quot;${item.priceFactor}&quot;)\r\n    private Double priceFactor;\r\n\r\n    item.priceFactor=0.1\r\n\r\nSpring will automatically convert for you.","title":"Spring @Value TypeMismatchException:Failed to convert value of type &#39;java.lang.String&#39; to required type &#39;java.lang.Double&#39;","body":"<p>Below logic works for me without using new Double:</p>\n<pre><code>@Value(&quot;${item.priceFactor}&quot;)\nprivate Double priceFactor;\n\nitem.priceFactor=0.1\n</code></pre>\n<p>Spring will automatically convert for you.</p>\n"}],"owner":{"account_id":893749,"reputation":8510,"user_id":931511,"accept_rate":76,"display_name":"guilhebl"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":59191,"favorite_count":0,"down_vote_count":0,"up_vote_count":43,"accepted_answer_id":42735568,"answer_count":6,"score":43,"last_activity_date":1656341198,"creation_date":1489220960,"question_id":42733067,"body_markdown":"I want to use the @Value annotation to inject a Double property such as:\r\n\r\n    @Service\r\n    public class MyService {\r\n    \t\r\n    \t@Value(&quot;${item.priceFactor}&quot;)\r\n    \tprivate Double priceFactor = 0.1;\r\n    \r\n    // ...\r\n\r\nand using Spring property placeholder (Properties files):\r\n\r\n    item.priceFactor=0.1\r\n\r\nI get Exception: \r\n\r\n    \r\n\r\n&gt; org.springframework.beans.TypeMismatchException: Failed to convert\r\n&gt; value of type &#39;java.lang.String&#39; to required type &#39;java.lang.Double&#39;;\r\n&gt; nested exception is java.lang.NumberFormatException: For input string:\r\n&gt; &quot;${item.priceFactor}&quot;\r\n\r\nIs there a way to use a Double value coming from a properties file?","title":"Spring @Value TypeMismatchException:Failed to convert value of type &#39;java.lang.String&#39; to required type &#39;java.lang.Double&#39;","body":"<p>I want to use the @Value annotation to inject a Double property such as:</p>\n\n<pre><code>@Service\npublic class MyService {\n\n    @Value(\"${item.priceFactor}\")\n    private Double priceFactor = 0.1;\n\n// ...\n</code></pre>\n\n<p>and using Spring property placeholder (Properties files):</p>\n\n<pre><code>item.priceFactor=0.1\n</code></pre>\n\n<p>I get Exception: </p>\n\n<blockquote>\n  <p>org.springframework.beans.TypeMismatchException: Failed to convert\n  value of type 'java.lang.String' to required type 'java.lang.Double';\n  nested exception is java.lang.NumberFormatException: For input string:\n  \"${item.priceFactor}\"</p>\n</blockquote>\n\n<p>Is there a way to use a Double value coming from a properties file?</p>\n"},{"tags":["java","lombok"],"comments":[{"owner":{"account_id":6151821,"reputation":4968,"user_id":4796021,"display_name":"David P&#233;rez Cabrera"},"score":0,"creation_date":1501005558,"post_id":45310461,"comment_id":77583194,"body_markdown":"are you using maven?","body":"are you using maven?"},{"owner":{"account_id":10480919,"reputation":1432,"user_id":7725942,"accept_rate":33,"display_name":"Naanavanalla"},"score":0,"creation_date":1501005629,"post_id":45310461,"comment_id":77583237,"body_markdown":"No. It is a simple java project. But I added the jar to the class path. Thank you.","body":"No. It is a simple java project. But I added the jar to the class path. Thank you."},{"owner":{"account_id":6151821,"reputation":4968,"user_id":4796021,"display_name":"David P&#233;rez Cabrera"},"score":0,"creation_date":1501005724,"post_id":45310461,"comment_id":77583296,"body_markdown":"What is your IDE Eclipse, Netbeans, Intellij Idea?","body":"What is your IDE Eclipse, Netbeans, Intellij Idea?"},{"owner":{"account_id":10480919,"reputation":1432,"user_id":7725942,"accept_rate":33,"display_name":"Naanavanalla"},"score":0,"creation_date":1501005854,"post_id":45310461,"comment_id":77583355,"body_markdown":"@GhostCat I put that vote request just because I need the answer very urgently. Sorry, If you took it in a wrong way.","body":"@GhostCat I put that vote request just because I need the answer very urgently. Sorry, If you took it in a wrong way."},{"owner":{"account_id":10480919,"reputation":1432,"user_id":7725942,"accept_rate":33,"display_name":"Naanavanalla"},"score":0,"creation_date":1501005895,"post_id":45310461,"comment_id":77583391,"body_markdown":"@DavidP&#233;rezCabrera I am using eclipse IDE. Thank you.","body":"@DavidP&#233;rezCabrera I am using eclipse IDE. Thank you."},{"owner":{"account_id":6151821,"reputation":4968,"user_id":4796021,"display_name":"David P&#233;rez Cabrera"},"score":0,"creation_date":1501005911,"post_id":45310461,"comment_id":77583399,"body_markdown":"If you add to main the line `s.setName(&quot;foo&quot;);` do It compile?","body":"If you add to main the line <code>s.setName(&quot;foo&quot;);</code> do It compile?"},{"owner":{"account_id":10480919,"reputation":1432,"user_id":7725942,"accept_rate":33,"display_name":"Naanavanalla"},"score":0,"creation_date":1501005985,"post_id":45310461,"comment_id":77583446,"body_markdown":"@DavidP&#233;rezCabrera No, it did not compile. Thank you.","body":"@DavidP&#233;rezCabrera No, it did not compile. Thank you."},{"owner":{"account_id":2016330,"reputation":13111,"user_id":1803551,"accept_rate":67,"display_name":"user1803551"},"score":3,"creation_date":1501012305,"post_id":45310461,"comment_id":77587102,"body_markdown":"Did you install it in Eclipse? You need to double click the jar and it will open an installation menu.","body":"Did you install it in Eclipse? You need to double click the jar and it will open an installation menu."}],"answers":[{"tags":[],"owner":{"account_id":3763024,"reputation":349,"user_id":3127379,"display_name":"Jurrian Fahner"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1501006009,"creation_date":1501006009,"answer_id":45310696,"question_id":45310461,"body_markdown":"@Data on class level would be sufficient. Maybe it is a problem that you have put the @Data annotation between `public` and `class`.\r\n\r\nOther question is whether your lombok.jar is on the classpath. \r\n\r\nIf I would rewrite your class, I would come up with the following:\r\n\r\n    @Data\r\n    public class Student {\r\n    \r\n    private Integer id;\r\n\r\n    private String name;\r\n    \r\n    private String uid;\r\n    \r\n    public static void main(String[] args) {\r\n        // TODO Auto-generated method stub\r\n        Student s = new Student();\r\n        System.out.println(s);\r\n    \r\n    \r\n    }\r\n    }","title":"Generating getters and setters using project Lombok","body":"<p>@Data on class level would be sufficient. Maybe it is a problem that you have put the @Data annotation between <code>public</code> and <code>class</code>.</p>\n\n<p>Other question is whether your lombok.jar is on the classpath. </p>\n\n<p>If I would rewrite your class, I would come up with the following:</p>\n\n<pre><code>@Data\npublic class Student {\n\nprivate Integer id;\n\nprivate String name;\n\nprivate String uid;\n\npublic static void main(String[] args) {\n    // TODO Auto-generated method stub\n    Student s = new Student();\n    System.out.println(s);\n\n\n}\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":6151821,"reputation":4968,"user_id":4796021,"display_name":"David P&#233;rez Cabrera"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1501006103,"creation_date":1501006103,"answer_id":45310724,"question_id":45310461,"body_markdown":"Your configuration is incomplete. Review https://projectlombok.org/setup/eclipse and check if It compiles. \r\nWhen it does, try again!","title":"Generating getters and setters using project Lombok","body":"<p>Your configuration is incomplete. Review <a href=\"https://projectlombok.org/setup/eclipse\" rel=\"nofollow noreferrer\">https://projectlombok.org/setup/eclipse</a> and check if It compiles. \nWhen it does, try again!</p>\n"},{"tags":[],"owner":{"account_id":7665619,"reputation":518,"user_id":5809422,"accept_rate":50,"display_name":"Mesbah Gueffaf"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1501069678,"creation_date":1501069678,"answer_id":45326067,"question_id":45310461,"body_markdown":"If you use netbeans go to properties-&gt;Build-&gt;compiling for checked the option Enable Annotation processing \r\n\r\nor search this option in your editor\r\n","title":"Generating getters and setters using project Lombok","body":"<p>If you use netbeans go to properties->Build->compiling for checked the option Enable Annotation processing </p>\n\n<p>or search this option in your editor</p>\n"},{"tags":[],"owner":{"account_id":10480919,"reputation":1432,"user_id":7725942,"accept_rate":33,"display_name":"Naanavanalla"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1501093272,"creation_date":1501091434,"answer_id":45334160,"question_id":45310461,"body_markdown":"thanks for your help. In eclipse IDE, I was not exporting the `lombok` jar. Even though, I added jar to the build path, it seems I should export it to the project in `order and export` section of eclipse.\r\n\r\nSo, In eclipse editor, \r\n\r\n&gt; right click on your project --&gt; `Build Path`--&gt; `Configure Build Path...`--&gt;select `order and export` tab and check the jar you want to export to your project.\r\n\r\nOr\r\n\r\nyou can also simply run the downloaded jar. This will detect the possible IDE&#39;s in the system and configure it to support all `lombok` features.\r\n\r\nThis solved my issue. Again thank you for your support.","title":"Generating getters and setters using project Lombok","body":"<p>thanks for your help. In eclipse IDE, I was not exporting the <code>lombok</code> jar. Even though, I added jar to the build path, it seems I should export it to the project in <code>order and export</code> section of eclipse.</p>\n\n<p>So, In eclipse editor, </p>\n\n<blockquote>\n  <p>right click on your project --> <code>Build Path</code>--> <code>Configure Build Path...</code>-->select <code>order and export</code> tab and check the jar you want to export to your project.</p>\n</blockquote>\n\n<p>Or</p>\n\n<p>you can also simply run the downloaded jar. This will detect the possible IDE's in the system and configure it to support all <code>lombok</code> features.</p>\n\n<p>This solved my issue. Again thank you for your support.</p>\n"},{"tags":[],"owner":{"account_id":9025175,"reputation":27,"user_id":6724705,"display_name":"Sudarshan Nagre"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656340810,"creation_date":1656340810,"answer_id":72773949,"question_id":45310461,"body_markdown":"Simply download the lombok-1.18.24.jar(any version) and once download, double click on that file, so it checks your system and detects the IDE&#39;s that are available on your system. Then verify the IDE&#39;s and click on install/update button. Once the above process is completed, restart your IDE maybe, sts or eclipse.","title":"Generating getters and setters using project Lombok","body":"<p>Simply download the lombok-1.18.24.jar(any version) and once download, double click on that file, so it checks your system and detects the IDE's that are available on your system. Then verify the IDE's and click on install/update button. Once the above process is completed, restart your IDE maybe, sts or eclipse.</p>\n"}],"owner":{"account_id":10480919,"reputation":1432,"user_id":7725942,"accept_rate":33,"display_name":"Naanavanalla"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":3473,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":45334160,"answer_count":5,"score":2,"last_activity_date":1656340810,"creation_date":1501005265,"question_id":45310461,"body_markdown":"I wanted to use Lombok dependency in my project. So, I downloaded `lombok-1.16.18.jar` and added to the build path of on of my classes. The configuration is shown below.\r\n\r\n\r\n    import lombok.Data;\r\n    import lombok.Getter;\r\n    import lombok.Setter;\r\n    import lombok.ToString;\r\n\r\n    @ToString(includeFieldNames=true)\r\n    public @Data class Student {\r\n\r\n\t@Getter\r\n\t@Setter\r\n\tprivate Integer id;\r\n\t\r\n\t@Getter\r\n\t@Setter\r\n\tprivate String name;\r\n\t\r\n\t//private Date dob;\r\n\t@Getter\r\n\t@Setter\r\n\tprivate String uid;\r\n\t\r\n\tpublic static void main(String[] args) {\r\n\t\t// TODO Auto-generated method stub\r\n        Student s = new Student();\r\n\t\tSystem.out.println(s);\r\n\t\t\r\n\t\t\r\n\t}\r\n    }\r\n\r\nBut, I am not getting proper output in console. I am getting `Object` classes `toString()` output like `com.selflearn.sandesha.Student@7852e922\r\n`. I am also not able to use getters and setters. How to make Lombok work or what wrong I am doing?","title":"Generating getters and setters using project Lombok","body":"<p>I wanted to use Lombok dependency in my project. So, I downloaded <code>lombok-1.16.18.jar</code> and added to the build path of on of my classes. The configuration is shown below.</p>\n\n<pre><code>import lombok.Data;\nimport lombok.Getter;\nimport lombok.Setter;\nimport lombok.ToString;\n\n@ToString(includeFieldNames=true)\npublic @Data class Student {\n\n@Getter\n@Setter\nprivate Integer id;\n\n@Getter\n@Setter\nprivate String name;\n\n//private Date dob;\n@Getter\n@Setter\nprivate String uid;\n\npublic static void main(String[] args) {\n    // TODO Auto-generated method stub\n    Student s = new Student();\n    System.out.println(s);\n\n\n}\n}\n</code></pre>\n\n<p>But, I am not getting proper output in console. I am getting <code>Object</code> classes <code>toString()</code> output like <code>com.selflearn.sandesha.Student@7852e922\n</code>. I am also not able to use getters and setters. How to make Lombok work or what wrong I am doing?</p>\n"},{"tags":["java","spring","spring-boot","hibernate","spring-data-jpa"],"comments":[{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":0,"creation_date":1656324824,"post_id":72770021,"comment_id":128535519,"body_markdown":"Do you really need `LocalContainerEntityManagerFactoryBean` when using `@EnableJpaRepositories` ? You could attempt using `@EntityScan` to scane for the entities, remove `LocalContainerEntityManagerFactoryBean` definition and use the `@Repository` directly","body":"Do you really need <code>LocalContainerEntityManagerFactoryBean</code> when using <code>@EnableJpaRepositories</code> ? You could attempt using <code>@EntityScan</code> to scane for the entities, remove <code>LocalContainerEntityManagerFactoryBean</code> definition and use the <code>@Repository</code> directly"},{"owner":{"account_id":2610679,"reputation":423,"user_id":2260835,"accept_rate":75,"display_name":"Discipulos"},"score":0,"creation_date":1656324980,"post_id":72770021,"comment_id":128535585,"body_markdown":"Do you suggest to remove only this bean? Anyway, I have two datasource, so I guess that I need two distinct configurations","body":"Do you suggest to remove only this bean? Anyway, I have two datasource, so I guess that I need two distinct configurations"},{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":0,"creation_date":1656325313,"post_id":72770021,"comment_id":128535706,"body_markdown":"You only need 2 configurations if its 2 different databases. Else you can use a single one and adjust the mapping.","body":"You only need 2 configurations if its 2 different databases. Else you can use a single one and adjust the mapping."},{"owner":{"account_id":2610679,"reputation":423,"user_id":2260835,"accept_rate":75,"display_name":"Discipulos"},"score":0,"creation_date":1656325399,"post_id":72770021,"comment_id":128535739,"body_markdown":"I have two catalogs","body":"I have two catalogs"},{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":0,"creation_date":1656325929,"post_id":72770021,"comment_id":128535897,"body_markdown":"I just realized that you have use `@Primary` on the &quot;data&quot; parts. Then you just use `@Autowired public LocalContainerEntityManagerFactoryBean dataEntityManagerFactory;` which would by default use the `@Primary` annotated dependency (as they are also by default autowired by type). You should specify which bean exactly you want. For this you need to add an `@Qualifier(&quot;dataEntityManagerFactory&quot;)` and `@Qualifier(&quot;userEntityManagerFactory&quot;)`. Then spring should properly set each instance","body":"I just realized that you have use <code>@Primary</code> on the &quot;data&quot; parts. Then you just use <code>@Autowired public LocalContainerEntityManagerFactoryBean dataEntityManagerFactory;</code> which would by default use the <code>@Primary</code> annotated dependency (as they are also by default autowired by type). You should specify which bean exactly you want. For this you need to add an <code>@Qualifier(&quot;dataEntityManagerFactory&quot;)</code> and <code>@Qualifier(&quot;userEntityManagerFactory&quot;)</code>. Then spring should properly set each instance"},{"owner":{"account_id":2610679,"reputation":423,"user_id":2260835,"accept_rate":75,"display_name":"Discipulos"},"score":0,"creation_date":1656326290,"post_id":72770021,"comment_id":128536006,"body_markdown":"prefect observation. I also removed the basePackages from EnableJpaRepositories but now I have a new exception &quot;Caused by: java.lang.NullPointerException: Cannot invoke &quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.getObject()&quot; because &quot;this.userEntityManagerFactory&quot; is null&quot;. My correction is:   @Qualifier(&quot;dataEntityManagerFactory&quot;)\n  public LocalContainerEntityManagerFactoryBean dataEntityManagerFactory;\n  @Qualifier(&quot;userEntityManagerFactory&quot;)\n  public LocalContainerEntityManagerFactoryBean userEntityManagerFactory;","body":"prefect observation. I also removed the basePackages from EnableJpaRepositories but now I have a new exception &quot;Caused by: java.lang.NullPointerException: Cannot invoke &quot;org.springframework.orm.jpa.LocalContainerEntityManagerFact&zwnj;&#8203;oryBean.getObject()&quot; because &quot;this.userEntityManagerFactory&quot; is null&quot;. My correction is:   @Qualifier(&quot;dataEntityManagerFactory&quot;)   public LocalContainerEntityManagerFactoryBean dataEntityManagerFactory;   @Qualifier(&quot;userEntityManagerFactory&quot;)   public LocalContainerEntityManagerFactoryBean userEntityManagerFactory;"},{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":0,"creation_date":1656326595,"post_id":72770021,"comment_id":128536103,"body_markdown":"`@EnableJpaRepositories` should still define the `basePackages`. Also check out [this question](https://stackoverflow.com/questions/45663025/spring-data-jpa-multiple-enablejparepositories) and accepted answer. It looks like a duplicate to yours","body":"<code>@EnableJpaRepositories</code> should still define the <code>basePackages</code>. Also check out <a href=\"https://stackoverflow.com/questions/45663025/spring-data-jpa-multiple-enablejparepositories\">this question</a> and accepted answer. It looks like a duplicate to yours"},{"owner":{"account_id":2610679,"reputation":423,"user_id":2260835,"accept_rate":75,"display_name":"Discipulos"},"score":0,"creation_date":1656327466,"post_id":72770021,"comment_id":128536403,"body_markdown":"with &quot;basepackages&quot; I have a duplicate bean error concerning the repositories, commenting them a &quot;Caused by: java.lang.NullPointerException: Cannot invoke &quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.getObject()&quot; because &quot;this.userEntityManagerFactory&quot; is null&quot;. I also checked the question  you posted.","body":"with &quot;basepackages&quot; I have a duplicate bean error concerning the repositories, commenting them a &quot;Caused by: java.lang.NullPointerException: Cannot invoke &quot;org.springframework.orm.jpa.LocalContainerEntityManagerFact&zwnj;&#8203;oryBean.getObject()&quot; because &quot;this.userEntityManagerFactory&quot; is null&quot;. I also checked the question  you posted."},{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":0,"creation_date":1656328055,"post_id":72770021,"comment_id":128536613,"body_markdown":"`@EnableJpaRepositories` and `lem.setPackagesToScan` both define the same packages. Properly split them. `lem.setPackagesToScan` likely only needs to know about the models, while `@EnableJpaRepositories` only needs to know about the repositories.","body":"<code>@EnableJpaRepositories</code> and <code>lem.setPackagesToScan</code> both define the same packages. Properly split them. <code>lem.setPackagesToScan</code> likely only needs to know about the models, while <code>@EnableJpaRepositories</code> only needs to know about the repositories."},{"owner":{"account_id":2610679,"reputation":423,"user_id":2260835,"accept_rate":75,"display_name":"Discipulos"},"score":0,"creation_date":1656335457,"post_id":72770021,"comment_id":128539473,"body_markdown":"Following the link and the comments you provided, I updated the two configurations in first post (see the bottom part). However now I have a java.lang.NullPointerException: Cannot invoke &quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.getObject()&quot; because &quot;this.userEntityManagerFactory&quot; is null, same for this.dataEntityManagerFactory","body":"Following the link and the comments you provided, I updated the two configurations in first post (see the bottom part). However now I have a java.lang.NullPointerException: Cannot invoke &quot;org.springframework.orm.jpa.LocalContainerEntityManagerFact&zwnj;&#8203;oryBean.getObject()&quot; because &quot;this.userEntityManagerFactory&quot; is null, same for this.dataEntityManagerFactory"},{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":0,"creation_date":1656336071,"post_id":72770021,"comment_id":128539730,"body_markdown":"Can you update the code? As it stands, the changes are not added","body":"Can you update the code? As it stands, the changes are not added"},{"owner":{"account_id":2610679,"reputation":423,"user_id":2260835,"accept_rate":75,"display_name":"Discipulos"},"score":0,"creation_date":1656336271,"post_id":72770021,"comment_id":128539834,"body_markdown":"Sorry, I did it","body":"Sorry, I did it"},{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":0,"creation_date":1656337698,"post_id":72770021,"comment_id":128540451,"body_markdown":"Now you are missing the `@Autowired`. I said to **add** `@Qualifier` annotation, not replace. `@autowired @Qualifier(&quot;dataEntityManager&quot;)\npublic LocalContainerEntityManagerFactoryBean dataEntityManagerFactory;` should do the trick","body":"Now you are missing the <code>@Autowired</code>. I said to <b>add</b> <code>@Qualifier</code> annotation, not replace. <code>@autowired @Qualifier(&quot;dataEntityManager&quot;) public LocalContainerEntityManagerFactoryBean dataEntityManagerFactory;</code> should do the trick"},{"owner":{"account_id":2610679,"reputation":423,"user_id":2260835,"accept_rate":75,"display_name":"Discipulos"},"score":0,"creation_date":1656340803,"post_id":72770021,"comment_id":128541736,"body_markdown":"Now it seems wired correctly. I posted the final configuration, do you know why &quot;persist&quot; does not add entries to the database?","body":"Now it seems wired correctly. I posted the final configuration, do you know why &quot;persist&quot; does not add entries to the database?"},{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":0,"creation_date":1656341221,"post_id":72770021,"comment_id":128541965,"body_markdown":"Without an exception impossible to tell. If it does create a database entry but everything is null, then you are not properly setting the field values. If nothing is created, then you should receive an exception","body":"Without an exception impossible to tell. If it does create a database entry but everything is null, then you are not properly setting the field values. If nothing is created, then you should receive an exception"},{"owner":{"account_id":2610679,"reputation":423,"user_id":2260835,"accept_rate":75,"display_name":"Discipulos"},"score":0,"creation_date":1656341594,"post_id":72770021,"comment_id":128542109,"body_markdown":"Empty database, no exception thrown...","body":"Empty database, no exception thrown..."},{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":0,"creation_date":1656342498,"post_id":72770021,"comment_id":128542515,"body_markdown":"According to [this question](https://stackoverflow.com/questions/37053071/entitymanager-persist-not-saving-anything-to-database), you want to inject the `EntityManager` directly and not the `EntityManagerFactory`. Do `transactionManager.setEntityManagerFactory(serversEntityManager.getObject());` instead","body":"According to <a href=\"https://stackoverflow.com/questions/37053071/entitymanager-persist-not-saving-anything-to-database\">this question</a>, you want to inject the <code>EntityManager</code> directly and not the <code>EntityManagerFactory</code>. Do <code>transactionManager.setEntityManagerFactory(serversEntityMana&zwnj;&#8203;ger.getObject());</code> instead"},{"owner":{"account_id":2610679,"reputation":423,"user_id":2260835,"accept_rate":75,"display_name":"Discipulos"},"score":0,"creation_date":1656342566,"post_id":72770021,"comment_id":128542543,"body_markdown":"It should be the same righ?","body":"It should be the same righ?"},{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":0,"creation_date":1656342795,"post_id":72770021,"comment_id":128542649,"body_markdown":"Doesn&#39;t seem to be, according to the linked question","body":"Doesn&#39;t seem to be, according to the linked question"},{"owner":{"account_id":2610679,"reputation":423,"user_id":2260835,"accept_rate":75,"display_name":"Discipulos"},"score":0,"creation_date":1656343986,"post_id":72770021,"comment_id":128543133,"body_markdown":"Ok, I&#39;m trying to inject EntityManager. In the method &quot;transactionManager&quot; the EntityManagerFactory has no getObject() method. In the question, one suggests to remove the parameters, but how I can inject the EntityManagerFactory within this function?","body":"Ok, I&#39;m trying to inject EntityManager. In the method &quot;transactionManager&quot; the EntityManagerFactory has no getObject() method. In the question, one suggests to remove the parameters, but how I can inject the EntityManagerFactory within this function?"},{"owner":{"account_id":2610679,"reputation":423,"user_id":2260835,"accept_rate":75,"display_name":"Discipulos"},"score":0,"creation_date":1656347757,"post_id":72770021,"comment_id":128544537,"body_markdown":"Notice that I am able to read and write the database using the repositories but not using the EntityManager provided by the EntityManagerFactory","body":"Notice that I am able to read and write the database using the repositories but not using the EntityManager provided by the EntityManagerFactory"},{"owner":{"account_id":2610679,"reputation":423,"user_id":2260835,"accept_rate":75,"display_name":"Discipulos"},"score":0,"creation_date":1656356581,"post_id":72770021,"comment_id":128547541,"body_markdown":"Solved, I need to call begin() before and commit() after the call to persist","body":"Solved, I need to call begin() before and commit() after the call to persist"},{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":0,"creation_date":1656398126,"post_id":72770021,"comment_id":128555266,"body_markdown":"That means your `@Transactional` is not working, as usually `@Transactional` would take over that work","body":"That means your <code>@Transactional</code> is not working, as usually <code>@Transactional</code> would take over that work"},{"owner":{"account_id":2610679,"reputation":423,"user_id":2260835,"accept_rate":75,"display_name":"Discipulos"},"score":0,"creation_date":1656440072,"post_id":72770021,"comment_id":128571336,"body_markdown":"Do uou have idea why? Neither adding @Transactional to the class seems working","body":"Do uou have idea why? Neither adding @Transactional to the class seems working"},{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":1,"creation_date":1656484641,"post_id":72770021,"comment_id":128580682,"body_markdown":"Seems to be because it is in a non `@Component`, `@Service` annotated class. Therefore the class is not being proxied and no transaction management added to it. You probably want to create a different class which you annotate with `@Component` and where you implement the `postConstruct` logic and autowire it back to `Application` to call it in the post construct","body":"Seems to be because it is in a non <code>@Component</code>, <code>@Service</code> annotated class. Therefore the class is not being proxied and no transaction management added to it. You probably want to create a different class which you annotate with <code>@Component</code> and where you implement the <code>postConstruct</code> logic and autowire it back to <code>Application</code> to call it in the post construct"}],"answers":[{"tags":[],"owner":{"account_id":2610679,"reputation":423,"user_id":2260835,"accept_rate":75,"display_name":"Discipulos"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656340752,"creation_date":1656340752,"answer_id":72773933,"question_id":72770021,"body_markdown":"Thanks to the comment, the fina configuration is:\r\n\r\n    package it.unict.spring.application.configurations.data;\r\n\r\n\r\n\r\n     import java.util.HashMap;\r\n     import java.util.Map;\r\n     import java.util.Properties;\r\n     import javax.persistence.EntityManagerFactory;\r\n     import javax.sql.DataSource;\r\n     import org.springframework.beans.factory.annotation.Qualifier;\r\n     import org.springframework.boot.orm.jpa.EntityManagerFactoryBuilder;\r\n     import org.springframework.context.annotation.Bean;\r\n     import org.springframework.context.annotation.Configuration;\r\n     import org.springframework.context.annotation.Primary;\r\n     import org.springframework.data.jpa.repository.config.EnableJpaRepositories;\r\n     import org.springframework.orm.jpa.JpaTransactionManager;\r\n     import org.springframework.orm.jpa.JpaVendorAdapter;\r\n     import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;\r\n     import org.springframework.orm.jpa.vendor.Database;\r\n     import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;\r\n\r\n     @Configuration\r\n     @EnableJpaRepositories(\r\n                 entityManagerFactoryRef = &quot;dataEntityManager&quot;,\r\n                 transactionManagerRef = &quot;dataTransactionManager&quot;,\r\n                 basePackages = {&quot;it.unict.spring.application.repository.data&quot;}\r\n                      )\r\n\r\n    public class JpaTransactData\r\n       {\r\n           @Bean(name = &quot;dataEntityManager&quot;)\r\n            @Primary\r\n         public LocalContainerEntityManagerFactoryBean getServersEntityManager\r\n        (\r\n            EntityManagerFactoryBuilder builder,\r\n            @Qualifier(&quot;dataSource&quot;) DataSource dataSource,\r\n                                   @Qualifier(&quot;dataJpaVendor&quot;) JpaVendorAdapter adapter)\r\n    {        \r\n         Properties properties = new Properties();        \r\n         properties.put(&quot;spring.jpa.properties.javax.persistence.schema-generation.scripts.action&quot;,&quot;create&quot;);\r\n         properties.put(&quot;spring.jpa.properties.javax.persistence.schema-generation.scripts.create-target&quot;, &quot;create.sql&quot;);\r\n         properties.put(&quot;spring.jpa.properties.javax.persistence.schema-generation.create-source&quot;,&quot;metadata&quot;);\r\n         \r\n         LocalContainerEntityManagerFactoryBean lem=new LocalContainerEntityManagerFactoryBean();\r\n         lem.setPackagesToScan(&quot;it.unict.spring.application.persistence.model.data&quot;);\r\n         lem.setJpaProperties(properties);\r\n         lem.setJpaVendorAdapter(adapter);\r\n         lem.setDataSource(dataSource);\r\n         return lem;\r\n    }\r\n    @Bean(&quot;dataJpaVendor&quot;)\r\n    @Primary\r\n    public JpaVendorAdapter jpaVendorAdapter()\r\n    {\r\n     HibernateJpaVendorAdapter hibernateJpaVendorAdapter = new \r\n     HibernateJpaVendorAdapter();\r\n     hibernateJpaVendorAdapter.setShowSql(true);\r\n     hibernateJpaVendorAdapter.setGenerateDdl(true); //Auto creating scheme \r\n     when true\r\n     //hibernateJpaVendorAdapter.setDatabase(Database.MYSQL);//Database type    \r\n     return hibernateJpaVendorAdapter;\r\n    }\r\n\r\n\r\n    @Bean(name = &quot;dataTransactionManager&quot;)\r\n    @Primary\r\n    public JpaTransactionManager \r\n     transactionManager(@Qualifier(&quot;dataEntityManager&quot;) EntityManagerFactory \r\n       serversEntityManager){\r\n        JpaTransactionManager transactionManager = new JpaTransactionManager();\r\n        transactionManager.setEntityManagerFactory(serversEntityManager);\r\n        return transactionManager;\r\n    }\r\n      }\r\n\r\nThen in  the main file:\r\n\r\n      @Autowired\r\n     @Qualifier(&quot;dataEntityManager&quot;)\r\n     public LocalContainerEntityManagerFactoryBean dataEntityManagerFactory;\r\n  \r\n     @Autowired\r\n     @Qualifier(&quot;userEntityManager&quot;)\r\n     public LocalContainerEntityManagerFactoryBean userEntityManagerFactory;\r\n\r\n","title":"Springboot and MariaDB multisource throws unknown entity","body":"<p>Thanks to the comment, the fina configuration is:</p>\n<pre><code>package it.unict.spring.application.configurations.data;\n\n\n\n import java.util.HashMap;\n import java.util.Map;\n import java.util.Properties;\n import javax.persistence.EntityManagerFactory;\n import javax.sql.DataSource;\n import org.springframework.beans.factory.annotation.Qualifier;\n import org.springframework.boot.orm.jpa.EntityManagerFactoryBuilder;\n import org.springframework.context.annotation.Bean;\n import org.springframework.context.annotation.Configuration;\n import org.springframework.context.annotation.Primary;\n import org.springframework.data.jpa.repository.config.EnableJpaRepositories;\n import org.springframework.orm.jpa.JpaTransactionManager;\n import org.springframework.orm.jpa.JpaVendorAdapter;\n import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;\n import org.springframework.orm.jpa.vendor.Database;\n import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;\n\n @Configuration\n @EnableJpaRepositories(\n             entityManagerFactoryRef = &quot;dataEntityManager&quot;,\n             transactionManagerRef = &quot;dataTransactionManager&quot;,\n             basePackages = {&quot;it.unict.spring.application.repository.data&quot;}\n                  )\n\npublic class JpaTransactData\n   {\n       @Bean(name = &quot;dataEntityManager&quot;)\n        @Primary\n     public LocalContainerEntityManagerFactoryBean getServersEntityManager\n    (\n        EntityManagerFactoryBuilder builder,\n        @Qualifier(&quot;dataSource&quot;) DataSource dataSource,\n                               @Qualifier(&quot;dataJpaVendor&quot;) JpaVendorAdapter adapter)\n{        \n     Properties properties = new Properties();        \n     properties.put(&quot;spring.jpa.properties.javax.persistence.schema-generation.scripts.action&quot;,&quot;create&quot;);\n     properties.put(&quot;spring.jpa.properties.javax.persistence.schema-generation.scripts.create-target&quot;, &quot;create.sql&quot;);\n     properties.put(&quot;spring.jpa.properties.javax.persistence.schema-generation.create-source&quot;,&quot;metadata&quot;);\n     \n     LocalContainerEntityManagerFactoryBean lem=new LocalContainerEntityManagerFactoryBean();\n     lem.setPackagesToScan(&quot;it.unict.spring.application.persistence.model.data&quot;);\n     lem.setJpaProperties(properties);\n     lem.setJpaVendorAdapter(adapter);\n     lem.setDataSource(dataSource);\n     return lem;\n}\n@Bean(&quot;dataJpaVendor&quot;)\n@Primary\npublic JpaVendorAdapter jpaVendorAdapter()\n{\n HibernateJpaVendorAdapter hibernateJpaVendorAdapter = new \n HibernateJpaVendorAdapter();\n hibernateJpaVendorAdapter.setShowSql(true);\n hibernateJpaVendorAdapter.setGenerateDdl(true); //Auto creating scheme \n when true\n //hibernateJpaVendorAdapter.setDatabase(Database.MYSQL);//Database type    \n return hibernateJpaVendorAdapter;\n}\n\n\n@Bean(name = &quot;dataTransactionManager&quot;)\n@Primary\npublic JpaTransactionManager \n transactionManager(@Qualifier(&quot;dataEntityManager&quot;) EntityManagerFactory \n   serversEntityManager){\n    JpaTransactionManager transactionManager = new JpaTransactionManager();\n    transactionManager.setEntityManagerFactory(serversEntityManager);\n    return transactionManager;\n}\n  }\n</code></pre>\n<p>Then in  the main file:</p>\n<pre><code>  @Autowired\n @Qualifier(&quot;dataEntityManager&quot;)\n public LocalContainerEntityManagerFactoryBean dataEntityManagerFactory;\n\n @Autowired\n @Qualifier(&quot;userEntityManager&quot;)\n public LocalContainerEntityManagerFactoryBean userEntityManagerFactory;\n</code></pre>\n"}],"owner":{"account_id":2610679,"reputation":423,"user_id":2260835,"accept_rate":75,"display_name":"Discipulos"},"comment_count":25,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":215,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1656340752,"creation_date":1656323055,"question_id":72770021,"body_markdown":"I have a simple springboot application managing two MariaDB sources,  &quot;users&quot; and &quot;data&quot;. I have two distinct configurations:\r\n\r\n\r\nFor users:\r\n\r\n    package it.unict.spring.application.configurations.user;\r\n\r\n    import javax.sql.DataSource;\r\n    import org.springframework.beans.factory.annotation.Value;\r\n    import org.springframework.boot.jdbc.DataSourceBuilder;\r\n    import org.springframework.context.annotation.Bean;\r\n    import org.springframework.context.annotation.Configuration;\r\n    import org.springframework.transaction.annotation.EnableTransactionManagement;\r\n\r\n    @Configuration\r\n    @EnableTransactionManagement\r\n    public class JpaConfigUser {\r\n    \t@Value(&quot;${spring.datasource2.driver-class-name}&quot;)\r\n    \tprivate String driver;\r\n    \t@Value(&quot;${spring.datasource2.url}&quot;)\r\n    \tprivate String urlUser;\r\n    \t@Value(&quot;${spring.datasource2.username}&quot;)\r\n    \tprivate String username;\r\n    \t@Value(&quot;${spring.datasource2.password}&quot;)\r\n    \tprivate String password;\r\n    \r\n    \t@Bean(&quot;userSource&quot;)\r\n    \tpublic DataSource getUserSource() {\r\n    \t\treturn DataSourceBuilder.create().driverClassName(driver).url(urlUser)\r\n    \t\t\t\t.username(username).password(password).build();\r\n    \t}\r\n    }\r\n\r\nand\r\n\r\n    package it.unict.spring.application.configurations.user;\r\n\r\n    import java.util.Objects;\r\n    import java.util.Properties;\r\n    import javax.sql.DataSource;\r\n    import org.springframework.beans.factory.annotation.Qualifier;\r\n    import org.springframework.context.annotation.Bean;\r\n    import org.springframework.context.annotation.Configuration;\r\n    import org.springframework.data.jpa.repository.config.EnableJpaRepositories;\r\n    import org.springframework.orm.jpa.JpaTransactionManager;\r\n    import org.springframework.orm.jpa.JpaVendorAdapter;\r\n    import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;\r\n    import org.springframework.orm.jpa.vendor.Database;\r\n    import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;\r\n    import org.springframework.transaction.PlatformTransactionManager;\r\n\r\n    @Configuration\r\n    @EnableJpaRepositories(basePackages = { &quot;it.unict.spring.application.repository.user&quot;,\r\n    \t\t&quot;it.unict.spring.application.persistence.model.user&quot; }, entityManagerFactoryRef = &quot;userEntityManagerFactory&quot;, transactionManagerRef = &quot;userTransactionManager&quot;)\r\n    public class JpaTransactUser {\r\n    \r\n    \t@Bean(&quot;userEntityManagerFactory&quot;)\r\n    \tpublic LocalContainerEntityManagerFactoryBean userEntityManagerFactory(\r\n    \t\t\t@Qualifier(&quot;userSource&quot;) DataSource dataSource,\r\n    \t\t\t@Qualifier(&quot;userJpaVendor&quot;) JpaVendorAdapter adapter) {\r\n    \t\tProperties properties = new Properties();\r\n    \t\tproperties.put(&quot;hibernate.dialect&quot;, &quot;org.hibernate.dialect.MariaDB103Dialect&quot;);\r\n    \t\tproperties.put(\r\n    \t\t\t\t&quot;spring.jpa.properties.javax.persistence.schema-generation.scripts.action&quot;,\r\n    \t\t\t\t&quot;create&quot;);\r\n    \t\tproperties.put(\r\n    \t\t\t\t&quot;spring.jpa.properties.javax.persistence.schema-generation.scripts.create-target&quot;,\r\n    \t\t\t\t&quot;create.sql&quot;);\r\n    \r\n    \t\tLocalContainerEntityManagerFactoryBean lem = new LocalContainerEntityManagerFactoryBean();\r\n    \t\tlem.setPackagesToScan(&quot;it.unict.spring.application.repository.user&quot;,\r\n    \t\t\t\t&quot;it.unict.spring.application.persistence.model.user&quot;);\r\n    \t\tlem.setJpaProperties(properties);\r\n    \t\tlem.setJpaVendorAdapter(adapter);\r\n    \r\n    \t\tlem.setDataSource(dataSource);\r\n    \t\treturn lem;\r\n    \t}\r\n    \r\n    \t@Bean(&quot;userTransactionManager&quot;)\r\n    \tpublic PlatformTransactionManager userTransactionManager(\r\n    \t\t\t@Qualifier(&quot;userEntityManagerFactory&quot;) LocalContainerEntityManagerFactoryBean topicsEntityManagerFactory) {\r\n    \t\treturn new JpaTransactionManager(\r\n    \t\t\t\tObjects.requireNonNull(topicsEntityManagerFactory.getObject()));\r\n    \t}\r\n    \r\n    \t@Bean(&quot;userJpaVendor&quot;)\r\n    \tpublic JpaVendorAdapter jpaVendorAdapter() {\r\n    \t\tHibernateJpaVendorAdapter hibernateJpaVendorAdapter = new HibernateJpaVendorAdapter();\r\n    \t\thibernateJpaVendorAdapter.setShowSql(true);\r\n    \t\thibernateJpaVendorAdapter.setGenerateDdl(true); // Auto creating scheme when true\r\n    \t\thibernateJpaVendorAdapter.setDatabase(Database.MYSQL);// Database type\r\n    \t\treturn hibernateJpaVendorAdapter;\r\n    \t}\r\n    }\r\n\r\n \r\n while for data:\r\n\r\n \r\n\r\n    package it.unict.spring.application.configurations.data;\r\n\r\n\r\n    import javax.sql.DataSource;\r\n    import org.springframework.beans.factory.annotation.Value;\r\n    import org.springframework.boot.jdbc.DataSourceBuilder;\r\n    import org.springframework.context.annotation.Bean;\r\n    import org.springframework.context.annotation.Configuration;\r\n    import org.springframework.context.annotation.Primary;\r\n    import org.springframework.transaction.annotation.EnableTransactionManagement;\r\n\r\n\r\n    @Configuration\r\n    @EnableTransactionManagement\r\n    public class JpaConfigData {\r\n    \t@Value(&quot;${spring.datasource.driver-class-name}&quot;)\r\n    \tprivate String driver;\r\n    \t@Value(&quot;${spring.datasource.url}&quot;)\r\n    \tprivate String urlData;\r\n    \t@Value(&quot;${spring.datasource.username}&quot;)\r\n    \tprivate String username;\r\n    \t@Value(&quot;${spring.datasource.password}&quot;)\r\n    \tprivate String password;\r\n    \r\n    \t@Bean(&quot;dataSource&quot;)\r\n    \t@Primary\r\n    \tpublic DataSource getDataSource() {\r\n    \t\treturn DataSourceBuilder.create().driverClassName(driver).url(urlData)\r\n    \t\t\t\t.username(username).password(password).build();\r\n    \t}\r\n    \r\n    }\r\n\r\nand\r\n\r\n    package it.unict.spring.application.configurations.data;\r\n\r\n    import java.util.HashMap;\r\n    import java.util.Objects;\r\n    import java.util.Properties;\r\n    import javax.sql.DataSource;\r\n    import org.springframework.beans.factory.annotation.Qualifier;\r\n    import org.springframework.boot.orm.jpa.EntityManagerFactoryBuilder;\r\n    import org.springframework.context.annotation.Bean;\r\n    import org.springframework.context.annotation.Configuration;\r\n    import org.springframework.context.annotation.Primary;\r\n    import org.springframework.data.jpa.repository.config.EnableJpaRepositories;\r\n    import org.springframework.orm.jpa.JpaTransactionManager;\r\n    import org.springframework.orm.jpa.JpaVendorAdapter;\r\n    import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;\r\n    import org.springframework.orm.jpa.vendor.Database;\r\n    import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;\r\n    import org.springframework.transaction.PlatformTransactionManager;\r\n    \r\n    @Configuration\r\n    @EnableJpaRepositories(basePackages = { &quot;it.unict.spring.application.repository.data&quot;,\r\n    \t\t&quot;it.unict.spring.application.persistence.model.data&quot; }, entityManagerFactoryRef = &quot;dataEntityManagerFactory&quot;, transactionManagerRef = &quot;dataTransactionManager&quot;)\r\n    public class JpaTransactData {\r\n    \r\n    \t@Bean(&quot;dataEntityManagerFactory&quot;) \r\n      @Primary\r\n      public LocalContainerEntityManagerFactoryBean dataEntityManagerFactory(\r\n                               @Qualifier(&quot;dataSource&quot;) DataSource dataSource,                                \r\n                               @Qualifier(&quot;dataJpaVendor&quot;) JpaVendorAdapter adapter)\r\n      {        \r\n          Properties properties = new Properties();\r\n          properties.put(&quot;hibernate.dialect&quot;, &quot;org.hibernate.dialect.MariaDB103Dialect&quot;);\r\n          properties.put(&quot;spring.jpa.properties.javax.persistence.schema- \r\n      generation.scripts.action&quot;,&quot;create&quot;);\r\n          properties.put(&quot;spring.jpa.properties.javax.persistence.schema- \r\n      generation.scripts.create-target&quot;, &quot;create.sql&quot;);\r\n          \r\n        \r\n        \r\n        LocalContainerEntityManagerFactoryBean lem=new \r\n       LocalContainerEntityManagerFactoryBean();\r\n        lem.setPackagesToScan(&quot;it.unict.spring.application.repository.data&quot;, \r\n       &quot;it.unict.spring.application.persistence.model.data&quot;);\r\n        lem.setJpaProperties(properties);\r\n        lem.setJpaVendorAdapter(adapter);\r\n    \r\n          lem.setDataSource(dataSource);\r\n          return lem;\r\n      }\r\n    \r\n    \t@Bean(&quot;dataTransactionManager&quot;)\r\n    \t@Primary\r\n    \tpublic PlatformTransactionManager dataTransactionManager(\r\n    \t\t\t@Qualifier(&quot;dataEntityManagerFactory&quot;) LocalContainerEntityManagerFactoryBean topicsEntityManagerFactory) {\r\n    \t\treturn new JpaTransactionManager(\r\n    \t\t\t\tObjects.requireNonNull(topicsEntityManagerFactory.getObject()));\r\n    \t}\r\n    \r\n    \t@Bean(&quot;dataJpaVendor&quot;)\r\n    \t@Primary\r\n    \tpublic JpaVendorAdapter jpaVendorAdapter() {\r\n    \t\tHibernateJpaVendorAdapter hibernateJpaVendorAdapter = new HibernateJpaVendorAdapter();\r\n    \t\thibernateJpaVendorAdapter.setShowSql(true);\r\n    \t\thibernateJpaVendorAdapter.setGenerateDdl(true); // Auto creating scheme when true\r\n    \t\thibernateJpaVendorAdapter.setDatabase(Database.MYSQL);// Database type\r\n    \t\treturn hibernateJpaVendorAdapter;\r\n    \t}\r\n    }\r\n\r\nI know that some properties are unuseful, but the problem is that the main application:\r\n\r\n    package it.unict.spring.application;\r\n\r\n    import it.unict.spring.application.persistence.model.data.Todo;\r\n    import it.unict.spring.application.persistence.model.user.Privilege;\r\n    import java.sql.SQLException;\r\n    import javax.annotation.PostConstruct;\r\n    import javax.sql.DataSource;\r\n    import javax.transaction.Transactional;\r\n    import org.slf4j.Logger;\r\n    import org.slf4j.LoggerFactory;\r\n    import org.springframework.beans.factory.annotation.Autowired;\r\n    import org.springframework.boot.SpringApplication;\r\n    import org.springframework.boot.autoconfigure.SpringBootApplication;\r\n    import org.springframework.context.ApplicationContext;\r\n    import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;\r\n    \r\n    @SpringBootApplication\r\n    public class Application {\r\n    \tprivate static final Logger applogger = LoggerFactory.getLogger(&quot;Application&quot;);\r\n    \t@Autowired\r\n    \tprivate ApplicationContext appContext;\r\n    \t@Autowired\r\n    \tpublic LocalContainerEntityManagerFactoryBean dataEntityManagerFactory;\r\n    \t@Autowired\r\n    \tpublic LocalContainerEntityManagerFactoryBean userEntityManagerFactory;\r\n    \r\n    \tpublic static void main(String[] args) {\r\n    \t\tSpringApplication.run(Application.class, args);\r\n    \r\n    \t}\r\n    \r\n    \t@PostConstruct\r\n    \t@Transactional\r\n    \tpublic void postConstruct() {\r\n    \t\tapplogger.info(&quot;Post-construct message: Application started&quot;);\r\n    \t\tSystem.out.println(&quot;Console -- Application started&quot;);\r\n    \t\ttry {\r\n    \t\t\tapplogger.info(&quot;Connected to DB schema: &quot;\r\n    \t\t\t\t\t+ ((DataSource) appContext.getBean(&quot;userSource&quot;)).getConnection()\r\n    \t\t\t\t\t\t\t.getCatalog());\r\n    \t\t\tapplogger.info(&quot;Connected to DB schema: &quot;\r\n    \t\t\t\t\t+ ((DataSource) appContext.getBean(&quot;dataSource&quot;)).getConnection()\r\n    \t\t\t\t\t\t\t.getCatalog());\r\n    \t\t\tTodo p = new Todo(&quot;admin&quot;);\r\n    \t\t\tPrivilege s = new Privilege(&quot;admin&quot;);\r\n    \t\t\tuserEntityManagerFactory.getObject().createEntityManager().persist(s);\r\n    \t\t\tdataEntityManagerFactory.getObject().createEntityManager().persist(p);\r\n    \t\t} catch (SQLException ex) {\r\n    \t\t\tapplogger.info(&quot;Error on DBConnection: &quot; + ex.toString());\r\n    \t\t}\r\n    \r\n    \t}\r\n    }\r\n\r\n\r\nthrows a \r\n\r\n     java.lang.IllegalArgumentException: Unknown entity: it.unict.spring.application.persistence.model.user.Privilege\r\n\r\n\r\nthat prevents the deployment of the application due to \r\n\r\n    \r\n    userEntityManagerFactory.getObject().createEntityManager().persist(s);\r\n\r\nIf the above statement is omitted, the application starts but only null values are inserted in the DB.\r\n\r\nThe Privilege entity is:\r\n\r\n     package it.unict.spring.application.persistence.model.user;\r\n\r\n    import java.io.Serializable;\r\n    import javax.persistence.Column;\r\n    import javax.persistence.Entity;\r\n    import javax.persistence.GeneratedValue;\r\n    import javax.persistence.GenerationType;\r\n    import javax.persistence.Id;\r\n    import javax.persistence.Table;\r\n    \r\n    @Entity\r\n    @Table(name = &quot;privilege&quot;, catalog = &quot;users&quot;)\r\n    public class Privilege implements Serializable {\r\n    \r\n    \t@Id\r\n    \t@GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    \tprivate Long id;\r\n    \r\n    \t@Column(nullable = false, unique = true)\r\n    \tprivate String name;\r\n    \r\n    \t//\r\n    \r\n    \tpublic Privilege() {\r\n    \t\tsuper();\r\n    \t}\r\n    \r\n    \tpublic Privilege(String name) {\r\n    \t\tsuper();\r\n    \t\tthis.name = name;\r\n    \t}\r\n    \r\n    \t//\r\n    \r\n    \tpublic Long getId() {\r\n    \t\treturn id;\r\n    \t}\r\n    \r\n    \tpublic void setId(Long id) {\r\n    \t\tthis.id = id;\r\n    \t}\r\n    \r\n    \tpublic String getName() {\r\n    \t\treturn name;\r\n    \t}\r\n    \r\n    \tpublic void setName(String name) {\r\n    \t\tthis.name = name;\r\n    \t}\r\n    \r\n    \t//\r\n    \r\n    \t@Override\r\n    \tpublic String toString() {\r\n    \t\tfinal StringBuilder builder = new StringBuilder();\r\n    \t\tbuilder.append(&quot;Privilege [id=&quot;).append(id).append(&quot;, name=&quot;).append(name).append(&quot;]&quot;);\r\n    \t\treturn builder.toString();\r\n    \t}\r\n    \r\n    \t@Override\r\n    \tpublic int hashCode() {\r\n    \t\tfinal int prime = 31;\r\n    \t\tint result = 1;\r\n    \t\tresult = (prime * result) + ((id == null) ? 0 : id.hashCode());\r\n    \t\tresult = (prime * result) + ((name == null) ? 0 : name.hashCode());\r\n    \t\treturn result;\r\n    \t}\r\n    \r\n    \t@Override\r\n    \tpublic boolean equals(Object obj) {\r\n    \t\tif (this == obj) {\r\n    \t\t\treturn true;\r\n    \t\t}\r\n    \t\tif (obj == null) {\r\n    \t\t\treturn false;\r\n    \t\t}\r\n    \t\tif (getClass() != obj.getClass()) {\r\n    \t\t\treturn false;\r\n    \t\t}\r\n    \t\tfinal Privilege other = (Privilege) obj;\r\n    \t\tif (id == null) {\r\n    \t\t\tif (other.id != null) {\r\n    \t\t\t\treturn false;\r\n    \t\t\t}\r\n    \t\t} else if (!id.equals(other.id)) {\r\n    \t\t\treturn false;\r\n    \t\t}\r\n    \t\tif (name == null) {\r\n    \t\t\tif (other.name != null) {\r\n    \t\t\t\treturn false;\r\n    \t\t\t}\r\n    \t\t} else if (!name.equals(other.name)) {\r\n    \t\t\treturn false;\r\n    \t\t}\r\n    \t\treturn true;\r\n    \t}\r\n    }\r\n\r\nFollowing the comments I modified the configurations as follows. For user database:\r\n\r\n    package it.unict.spring.application.configurations.user;\r\n\r\n    import javax.persistence.EntityManagerFactory;\r\n    import javax.sql.DataSource;\r\n    import org.springframework.beans.factory.annotation.Qualifier;\r\n    import org.springframework.boot.orm.jpa.EntityManagerFactoryBuilder;\r\n    import org.springframework.context.annotation.Bean;\r\n    import org.springframework.context.annotation.Configuration;\r\n    import org.springframework.data.jpa.repository.config.EnableJpaRepositories;\r\n    import org.springframework.orm.jpa.JpaTransactionManager;\r\n    import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;\r\n    \r\n    @Configuration\r\n    @EnableJpaRepositories(entityManagerFactoryRef = &quot;userEntityManager&quot;, transactionManagerRef = &quot;userTransactionManager&quot;, basePackages = {\r\n    \t\t&quot;it.unict.spring.application.repository.user&quot; })\r\n    public class JpaTransactUser {\r\n    \t@Bean(name = &quot;userEntityManager&quot;)\r\n    \tpublic LocalContainerEntityManagerFactoryBean getServersEntityManager(\r\n    \t\t\tEntityManagerFactoryBuilder builder,\r\n    \t\t\t@Qualifier(&quot;userSource&quot;) DataSource dataDataSource) {\r\n    \r\n    \t\treturn builder.dataSource(dataDataSource)\r\n    \r\n    \t\t\t\t.packages(&quot;it.unict.spring.application.persistence.model.user&quot;)\r\n    \t\t\t\t.persistenceUnit(&quot;userUnit&quot;).build();\r\n    \r\n    \t}\r\n    \r\n    \t@Bean(name = &quot;userTransactionManager&quot;)\r\n    \tpublic JpaTransactionManager transactionManager(\r\n    \t\t\t@Qualifier(&quot;userEntityManager&quot;) EntityManagerFactory serversEntityManager) {\r\n    \t\tJpaTransactionManager transactionManager = new JpaTransactionManager();\r\n    \r\n    \t\ttransactionManager.setEntityManagerFactory(serversEntityManager);\r\n    \t\treturn transactionManager;\r\n    \t}\r\n    }\r\n\r\n\r\nFor data:\r\n\r\n       \r\n\r\n     package it.unict.spring.application.configurations.data;\r\n\r\n    import java.util.HashMap;\r\n    import java.util.Map;\r\n    import javax.persistence.EntityManagerFactory;\r\n    import javax.sql.DataSource;\r\n    import org.springframework.beans.factory.annotation.Qualifier;\r\n    import org.springframework.boot.autoconfigure.jdbc.DataSourceProperties;\r\n    import org.springframework.boot.context.properties.ConfigurationProperties;\r\n    import org.springframework.boot.orm.jpa.EntityManagerFactoryBuilder;\r\n    import org.springframework.context.annotation.Bean;\r\n    import org.springframework.context.annotation.Configuration;\r\n    import org.springframework.context.annotation.Primary;\r\n    import org.springframework.data.jpa.repository.config.EnableJpaRepositories;\r\n    import org.springframework.orm.jpa.JpaTransactionManager;\r\n    import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;\r\n    \r\n    @Configuration\r\n    @EnableJpaRepositories(entityManagerFactoryRef = &quot;dataEntityManager&quot;, transactionManagerRef = &quot;dataTransactionManager&quot;, basePackages = {\r\n    \t\t&quot;it.unict.spring.application.repository.data&quot; })\r\n    public class JpaTransactData {\r\n    \t@Bean(name = &quot;dataEntityManager&quot;)\r\n    \t@Primary\r\n    \tpublic LocalContainerEntityManagerFactoryBean getServersEntityManager(\r\n    \t\t\tEntityManagerFactoryBuilder builder,\r\n    \t\t\t@Qualifier(&quot;dataSource&quot;) DataSource dataDataSource) {\r\n    \r\n    \t\treturn builder.dataSource(dataDataSource)\r\n    \r\n    \t\t\t\t.packages(&quot;it.unict.spring.application.persistence.model.data&quot;)\r\n    \t\t\t\t.persistenceUnit(&quot;dataUnit&quot;).properties(additionalJpaProperties()).build();\r\n    \r\n    \t}\r\n    \r\n    \tMap&lt;String, ?&gt; additionalJpaProperties() {\r\n    \t\tMap&lt;String, String&gt; map = new HashMap&lt;&gt;();\r\n    \r\n    \t\tmap.put(&quot;hibernate.hbm2ddl.auto&quot;, &quot;create&quot;);\r\n    \t\tmap.put(&quot;hibernate.dialect&quot;, &quot;org.hibernate.dialect.MySQLDialect&quot;);\r\n    \t\tmap.put(&quot;hibernate.show_sql&quot;, &quot;true&quot;);\r\n    \r\n    \t\treturn map;\r\n    \t}\r\n    \r\n    \t@Bean(name = &quot;dataTransactionManager&quot;)\r\n    \t@Primary\r\n    \tpublic JpaTransactionManager transactionManager(\r\n    \t\t\t@Qualifier(&quot;dataEntityManager&quot;) EntityManagerFactory serversEntityManager) {\r\n    \t\tJpaTransactionManager transactionManager = new JpaTransactionManager();\r\n    \r\n    \t\ttransactionManager.setEntityManagerFactory(serversEntityManager);\r\n    \t\treturn transactionManager;\r\n    \t}\r\n    }\r\n\r\nWith \r\n\r\n\t@Qualifier(&quot;dataEntityManager&quot;)\r\n\tpublic LocalContainerEntityManagerFactoryBean dataEntityManagerFactory;\r\n\t@Qualifier(&quot;userEntityManager&quot;)\r\n\tpublic LocalContainerEntityManagerFactoryBean userEntityManagerFactory;\r\n\r\n\r\nIn the main file. Now I have\r\n\r\n    Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;application&#39;: Invocation of init method failed; nested exception is java.lang.NullPointerException: Cannot invoke &quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.getObject()&quot; because &quot;this.userEntityManagerFactory&quot; is null","title":"Springboot and MariaDB multisource throws unknown entity","body":"<p>I have a simple springboot application managing two MariaDB sources,  &quot;users&quot; and &quot;data&quot;. I have two distinct configurations:</p>\n<p>For users:</p>\n<pre><code>package it.unict.spring.application.configurations.user;\n\nimport javax.sql.DataSource;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.boot.jdbc.DataSourceBuilder;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.transaction.annotation.EnableTransactionManagement;\n\n@Configuration\n@EnableTransactionManagement\npublic class JpaConfigUser {\n    @Value(&quot;${spring.datasource2.driver-class-name}&quot;)\n    private String driver;\n    @Value(&quot;${spring.datasource2.url}&quot;)\n    private String urlUser;\n    @Value(&quot;${spring.datasource2.username}&quot;)\n    private String username;\n    @Value(&quot;${spring.datasource2.password}&quot;)\n    private String password;\n\n    @Bean(&quot;userSource&quot;)\n    public DataSource getUserSource() {\n        return DataSourceBuilder.create().driverClassName(driver).url(urlUser)\n                .username(username).password(password).build();\n    }\n}\n</code></pre>\n<p>and</p>\n<pre><code>package it.unict.spring.application.configurations.user;\n\nimport java.util.Objects;\nimport java.util.Properties;\nimport javax.sql.DataSource;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.data.jpa.repository.config.EnableJpaRepositories;\nimport org.springframework.orm.jpa.JpaTransactionManager;\nimport org.springframework.orm.jpa.JpaVendorAdapter;\nimport org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;\nimport org.springframework.orm.jpa.vendor.Database;\nimport org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;\nimport org.springframework.transaction.PlatformTransactionManager;\n\n@Configuration\n@EnableJpaRepositories(basePackages = { &quot;it.unict.spring.application.repository.user&quot;,\n        &quot;it.unict.spring.application.persistence.model.user&quot; }, entityManagerFactoryRef = &quot;userEntityManagerFactory&quot;, transactionManagerRef = &quot;userTransactionManager&quot;)\npublic class JpaTransactUser {\n\n    @Bean(&quot;userEntityManagerFactory&quot;)\n    public LocalContainerEntityManagerFactoryBean userEntityManagerFactory(\n            @Qualifier(&quot;userSource&quot;) DataSource dataSource,\n            @Qualifier(&quot;userJpaVendor&quot;) JpaVendorAdapter adapter) {\n        Properties properties = new Properties();\n        properties.put(&quot;hibernate.dialect&quot;, &quot;org.hibernate.dialect.MariaDB103Dialect&quot;);\n        properties.put(\n                &quot;spring.jpa.properties.javax.persistence.schema-generation.scripts.action&quot;,\n                &quot;create&quot;);\n        properties.put(\n                &quot;spring.jpa.properties.javax.persistence.schema-generation.scripts.create-target&quot;,\n                &quot;create.sql&quot;);\n\n        LocalContainerEntityManagerFactoryBean lem = new LocalContainerEntityManagerFactoryBean();\n        lem.setPackagesToScan(&quot;it.unict.spring.application.repository.user&quot;,\n                &quot;it.unict.spring.application.persistence.model.user&quot;);\n        lem.setJpaProperties(properties);\n        lem.setJpaVendorAdapter(adapter);\n\n        lem.setDataSource(dataSource);\n        return lem;\n    }\n\n    @Bean(&quot;userTransactionManager&quot;)\n    public PlatformTransactionManager userTransactionManager(\n            @Qualifier(&quot;userEntityManagerFactory&quot;) LocalContainerEntityManagerFactoryBean topicsEntityManagerFactory) {\n        return new JpaTransactionManager(\n                Objects.requireNonNull(topicsEntityManagerFactory.getObject()));\n    }\n\n    @Bean(&quot;userJpaVendor&quot;)\n    public JpaVendorAdapter jpaVendorAdapter() {\n        HibernateJpaVendorAdapter hibernateJpaVendorAdapter = new HibernateJpaVendorAdapter();\n        hibernateJpaVendorAdapter.setShowSql(true);\n        hibernateJpaVendorAdapter.setGenerateDdl(true); // Auto creating scheme when true\n        hibernateJpaVendorAdapter.setDatabase(Database.MYSQL);// Database type\n        return hibernateJpaVendorAdapter;\n    }\n}\n</code></pre>\n<p>while for data:</p>\n<pre><code>package it.unict.spring.application.configurations.data;\n\n\nimport javax.sql.DataSource;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.boot.jdbc.DataSourceBuilder;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.context.annotation.Primary;\nimport org.springframework.transaction.annotation.EnableTransactionManagement;\n\n\n@Configuration\n@EnableTransactionManagement\npublic class JpaConfigData {\n    @Value(&quot;${spring.datasource.driver-class-name}&quot;)\n    private String driver;\n    @Value(&quot;${spring.datasource.url}&quot;)\n    private String urlData;\n    @Value(&quot;${spring.datasource.username}&quot;)\n    private String username;\n    @Value(&quot;${spring.datasource.password}&quot;)\n    private String password;\n\n    @Bean(&quot;dataSource&quot;)\n    @Primary\n    public DataSource getDataSource() {\n        return DataSourceBuilder.create().driverClassName(driver).url(urlData)\n                .username(username).password(password).build();\n    }\n\n}\n</code></pre>\n<p>and</p>\n<pre><code>package it.unict.spring.application.configurations.data;\n\nimport java.util.HashMap;\nimport java.util.Objects;\nimport java.util.Properties;\nimport javax.sql.DataSource;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.springframework.boot.orm.jpa.EntityManagerFactoryBuilder;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.context.annotation.Primary;\nimport org.springframework.data.jpa.repository.config.EnableJpaRepositories;\nimport org.springframework.orm.jpa.JpaTransactionManager;\nimport org.springframework.orm.jpa.JpaVendorAdapter;\nimport org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;\nimport org.springframework.orm.jpa.vendor.Database;\nimport org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;\nimport org.springframework.transaction.PlatformTransactionManager;\n\n@Configuration\n@EnableJpaRepositories(basePackages = { &quot;it.unict.spring.application.repository.data&quot;,\n        &quot;it.unict.spring.application.persistence.model.data&quot; }, entityManagerFactoryRef = &quot;dataEntityManagerFactory&quot;, transactionManagerRef = &quot;dataTransactionManager&quot;)\npublic class JpaTransactData {\n\n    @Bean(&quot;dataEntityManagerFactory&quot;) \n  @Primary\n  public LocalContainerEntityManagerFactoryBean dataEntityManagerFactory(\n                           @Qualifier(&quot;dataSource&quot;) DataSource dataSource,                                \n                           @Qualifier(&quot;dataJpaVendor&quot;) JpaVendorAdapter adapter)\n  {        \n      Properties properties = new Properties();\n      properties.put(&quot;hibernate.dialect&quot;, &quot;org.hibernate.dialect.MariaDB103Dialect&quot;);\n      properties.put(&quot;spring.jpa.properties.javax.persistence.schema- \n  generation.scripts.action&quot;,&quot;create&quot;);\n      properties.put(&quot;spring.jpa.properties.javax.persistence.schema- \n  generation.scripts.create-target&quot;, &quot;create.sql&quot;);\n      \n    \n    \n    LocalContainerEntityManagerFactoryBean lem=new \n   LocalContainerEntityManagerFactoryBean();\n    lem.setPackagesToScan(&quot;it.unict.spring.application.repository.data&quot;, \n   &quot;it.unict.spring.application.persistence.model.data&quot;);\n    lem.setJpaProperties(properties);\n    lem.setJpaVendorAdapter(adapter);\n\n      lem.setDataSource(dataSource);\n      return lem;\n  }\n\n    @Bean(&quot;dataTransactionManager&quot;)\n    @Primary\n    public PlatformTransactionManager dataTransactionManager(\n            @Qualifier(&quot;dataEntityManagerFactory&quot;) LocalContainerEntityManagerFactoryBean topicsEntityManagerFactory) {\n        return new JpaTransactionManager(\n                Objects.requireNonNull(topicsEntityManagerFactory.getObject()));\n    }\n\n    @Bean(&quot;dataJpaVendor&quot;)\n    @Primary\n    public JpaVendorAdapter jpaVendorAdapter() {\n        HibernateJpaVendorAdapter hibernateJpaVendorAdapter = new HibernateJpaVendorAdapter();\n        hibernateJpaVendorAdapter.setShowSql(true);\n        hibernateJpaVendorAdapter.setGenerateDdl(true); // Auto creating scheme when true\n        hibernateJpaVendorAdapter.setDatabase(Database.MYSQL);// Database type\n        return hibernateJpaVendorAdapter;\n    }\n}\n</code></pre>\n<p>I know that some properties are unuseful, but the problem is that the main application:</p>\n<pre><code>package it.unict.spring.application;\n\nimport it.unict.spring.application.persistence.model.data.Todo;\nimport it.unict.spring.application.persistence.model.user.Privilege;\nimport java.sql.SQLException;\nimport javax.annotation.PostConstruct;\nimport javax.sql.DataSource;\nimport javax.transaction.Transactional;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.context.ApplicationContext;\nimport org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;\n\n@SpringBootApplication\npublic class Application {\n    private static final Logger applogger = LoggerFactory.getLogger(&quot;Application&quot;);\n    @Autowired\n    private ApplicationContext appContext;\n    @Autowired\n    public LocalContainerEntityManagerFactoryBean dataEntityManagerFactory;\n    @Autowired\n    public LocalContainerEntityManagerFactoryBean userEntityManagerFactory;\n\n    public static void main(String[] args) {\n        SpringApplication.run(Application.class, args);\n\n    }\n\n    @PostConstruct\n    @Transactional\n    public void postConstruct() {\n        applogger.info(&quot;Post-construct message: Application started&quot;);\n        System.out.println(&quot;Console -- Application started&quot;);\n        try {\n            applogger.info(&quot;Connected to DB schema: &quot;\n                    + ((DataSource) appContext.getBean(&quot;userSource&quot;)).getConnection()\n                            .getCatalog());\n            applogger.info(&quot;Connected to DB schema: &quot;\n                    + ((DataSource) appContext.getBean(&quot;dataSource&quot;)).getConnection()\n                            .getCatalog());\n            Todo p = new Todo(&quot;admin&quot;);\n            Privilege s = new Privilege(&quot;admin&quot;);\n            userEntityManagerFactory.getObject().createEntityManager().persist(s);\n            dataEntityManagerFactory.getObject().createEntityManager().persist(p);\n        } catch (SQLException ex) {\n            applogger.info(&quot;Error on DBConnection: &quot; + ex.toString());\n        }\n\n    }\n}\n</code></pre>\n<p>throws a</p>\n<pre><code> java.lang.IllegalArgumentException: Unknown entity: it.unict.spring.application.persistence.model.user.Privilege\n</code></pre>\n<p>that prevents the deployment of the application due to</p>\n<pre><code>userEntityManagerFactory.getObject().createEntityManager().persist(s);\n</code></pre>\n<p>If the above statement is omitted, the application starts but only null values are inserted in the DB.</p>\n<p>The Privilege entity is:</p>\n<pre><code> package it.unict.spring.application.persistence.model.user;\n\nimport java.io.Serializable;\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.GeneratedValue;\nimport javax.persistence.GenerationType;\nimport javax.persistence.Id;\nimport javax.persistence.Table;\n\n@Entity\n@Table(name = &quot;privilege&quot;, catalog = &quot;users&quot;)\npublic class Privilege implements Serializable {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @Column(nullable = false, unique = true)\n    private String name;\n\n    //\n\n    public Privilege() {\n        super();\n    }\n\n    public Privilege(String name) {\n        super();\n        this.name = name;\n    }\n\n    //\n\n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    //\n\n    @Override\n    public String toString() {\n        final StringBuilder builder = new StringBuilder();\n        builder.append(&quot;Privilege [id=&quot;).append(id).append(&quot;, name=&quot;).append(name).append(&quot;]&quot;);\n        return builder.toString();\n    }\n\n    @Override\n    public int hashCode() {\n        final int prime = 31;\n        int result = 1;\n        result = (prime * result) + ((id == null) ? 0 : id.hashCode());\n        result = (prime * result) + ((name == null) ? 0 : name.hashCode());\n        return result;\n    }\n\n    @Override\n    public boolean equals(Object obj) {\n        if (this == obj) {\n            return true;\n        }\n        if (obj == null) {\n            return false;\n        }\n        if (getClass() != obj.getClass()) {\n            return false;\n        }\n        final Privilege other = (Privilege) obj;\n        if (id == null) {\n            if (other.id != null) {\n                return false;\n            }\n        } else if (!id.equals(other.id)) {\n            return false;\n        }\n        if (name == null) {\n            if (other.name != null) {\n                return false;\n            }\n        } else if (!name.equals(other.name)) {\n            return false;\n        }\n        return true;\n    }\n}\n</code></pre>\n<p>Following the comments I modified the configurations as follows. For user database:</p>\n<pre><code>package it.unict.spring.application.configurations.user;\n\nimport javax.persistence.EntityManagerFactory;\nimport javax.sql.DataSource;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.springframework.boot.orm.jpa.EntityManagerFactoryBuilder;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.data.jpa.repository.config.EnableJpaRepositories;\nimport org.springframework.orm.jpa.JpaTransactionManager;\nimport org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;\n\n@Configuration\n@EnableJpaRepositories(entityManagerFactoryRef = &quot;userEntityManager&quot;, transactionManagerRef = &quot;userTransactionManager&quot;, basePackages = {\n        &quot;it.unict.spring.application.repository.user&quot; })\npublic class JpaTransactUser {\n    @Bean(name = &quot;userEntityManager&quot;)\n    public LocalContainerEntityManagerFactoryBean getServersEntityManager(\n            EntityManagerFactoryBuilder builder,\n            @Qualifier(&quot;userSource&quot;) DataSource dataDataSource) {\n\n        return builder.dataSource(dataDataSource)\n\n                .packages(&quot;it.unict.spring.application.persistence.model.user&quot;)\n                .persistenceUnit(&quot;userUnit&quot;).build();\n\n    }\n\n    @Bean(name = &quot;userTransactionManager&quot;)\n    public JpaTransactionManager transactionManager(\n            @Qualifier(&quot;userEntityManager&quot;) EntityManagerFactory serversEntityManager) {\n        JpaTransactionManager transactionManager = new JpaTransactionManager();\n\n        transactionManager.setEntityManagerFactory(serversEntityManager);\n        return transactionManager;\n    }\n}\n</code></pre>\n<p>For data:</p>\n<pre><code> package it.unict.spring.application.configurations.data;\n\nimport java.util.HashMap;\nimport java.util.Map;\nimport javax.persistence.EntityManagerFactory;\nimport javax.sql.DataSource;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.springframework.boot.autoconfigure.jdbc.DataSourceProperties;\nimport org.springframework.boot.context.properties.ConfigurationProperties;\nimport org.springframework.boot.orm.jpa.EntityManagerFactoryBuilder;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.context.annotation.Primary;\nimport org.springframework.data.jpa.repository.config.EnableJpaRepositories;\nimport org.springframework.orm.jpa.JpaTransactionManager;\nimport org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;\n\n@Configuration\n@EnableJpaRepositories(entityManagerFactoryRef = &quot;dataEntityManager&quot;, transactionManagerRef = &quot;dataTransactionManager&quot;, basePackages = {\n        &quot;it.unict.spring.application.repository.data&quot; })\npublic class JpaTransactData {\n    @Bean(name = &quot;dataEntityManager&quot;)\n    @Primary\n    public LocalContainerEntityManagerFactoryBean getServersEntityManager(\n            EntityManagerFactoryBuilder builder,\n            @Qualifier(&quot;dataSource&quot;) DataSource dataDataSource) {\n\n        return builder.dataSource(dataDataSource)\n\n                .packages(&quot;it.unict.spring.application.persistence.model.data&quot;)\n                .persistenceUnit(&quot;dataUnit&quot;).properties(additionalJpaProperties()).build();\n\n    }\n\n    Map&lt;String, ?&gt; additionalJpaProperties() {\n        Map&lt;String, String&gt; map = new HashMap&lt;&gt;();\n\n        map.put(&quot;hibernate.hbm2ddl.auto&quot;, &quot;create&quot;);\n        map.put(&quot;hibernate.dialect&quot;, &quot;org.hibernate.dialect.MySQLDialect&quot;);\n        map.put(&quot;hibernate.show_sql&quot;, &quot;true&quot;);\n\n        return map;\n    }\n\n    @Bean(name = &quot;dataTransactionManager&quot;)\n    @Primary\n    public JpaTransactionManager transactionManager(\n            @Qualifier(&quot;dataEntityManager&quot;) EntityManagerFactory serversEntityManager) {\n        JpaTransactionManager transactionManager = new JpaTransactionManager();\n\n        transactionManager.setEntityManagerFactory(serversEntityManager);\n        return transactionManager;\n    }\n}\n</code></pre>\n<p>With</p>\n<pre><code>@Qualifier(&quot;dataEntityManager&quot;)\npublic LocalContainerEntityManagerFactoryBean dataEntityManagerFactory;\n@Qualifier(&quot;userEntityManager&quot;)\npublic LocalContainerEntityManagerFactoryBean userEntityManagerFactory;\n</code></pre>\n<p>In the main file. Now I have</p>\n<pre><code>Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'application': Invocation of init method failed; nested exception is java.lang.NullPointerException: Cannot invoke &quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.getObject()&quot; because &quot;this.userEntityManagerFactory&quot; is null\n</code></pre>\n"},{"tags":["java","kotlin","jpa","spring-data-jpa"],"comments":[{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":0,"creation_date":1656336544,"post_id":72772827,"comment_id":128539951,"body_markdown":"Can you provide the full code for `saveChildren()` and `validateSavedChildren()`? There might be a reason in there","body":"Can you provide the full code for <code>saveChildren()</code> and <code>validateSavedChildren()</code>? There might be a reason in there"},{"owner":{"account_id":1903700,"reputation":1185,"user_id":1718984,"accept_rate":93,"display_name":"ParkCheolu"},"score":0,"creation_date":1656338520,"post_id":72772827,"comment_id":128540775,"body_markdown":"@XtremeBaumer I think you have the key point that I&#39;m missing. I updated the question.","body":"@XtremeBaumer I think you have the key point that I&#39;m missing. I updated the question."},{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":0,"creation_date":1656339232,"post_id":72772827,"comment_id":128541032,"body_markdown":"`validateSavedChildren(parent)` is in your code, but the method you posted has no parent parameter? Also `val parents: List&lt;**Parant**&gt;`?","body":"<code>validateSavedChildren(parent)</code> is in your code, but the method you posted has no parent parameter? Also <code>val parents: List&lt;**Parant**&gt;</code>?"},{"owner":{"account_id":1903700,"reputation":1185,"user_id":1718984,"accept_rate":93,"display_name":"ParkCheolu"},"score":0,"creation_date":1656340029,"post_id":72772827,"comment_id":128541401,"body_markdown":"@XtremeBaumer I&#39;m sorry. that parameter, &#39;parent&#39; is a mistake. I cannot provide the code for my company&#39;s security reason so I just tried to write logically same code. the method, &#39;validateSavedChildren&#39; is to query all the parent entities in DB and iterate it for counting the size of children. That&#39;s all.","body":"@XtremeBaumer I&#39;m sorry. that parameter, &#39;parent&#39; is a mistake. I cannot provide the code for my company&#39;s security reason so I just tried to write logically same code. the method, &#39;validateSavedChildren&#39; is to query all the parent entities in DB and iterate it for counting the size of children. That&#39;s all."},{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":0,"creation_date":1656340738,"post_id":72772827,"comment_id":128541712,"body_markdown":"Why not query all children and count them? If you have to the route with the parents, I would do it before even calling `saveChildren()` in a different transactional method. That way you can be sure not to interfere. If I am not mistaken, `val parent: Parent = parentRepo.findById(parentId)` does &quot;lock&quot; your parent entity. Then you query that entity again with `parentRepo.findAll()` in the same transaction, causing your exception","body":"Why not query all children and count them? If you have to the route with the parents, I would do it before even calling <code>saveChildren()</code> in a different transactional method. That way you can be sure not to interfere. If I am not mistaken, <code>val parent: Parent = parentRepo.findById(parentId)</code> does &quot;lock&quot; your parent entity. Then you query that entity again with <code>parentRepo.findAll()</code> in the same transaction, causing your exception"},{"owner":{"account_id":231721,"reputation":20460,"user_id":496099,"display_name":"Chris"},"score":0,"creation_date":1656345487,"post_id":72772827,"comment_id":128543672,"body_markdown":"The query in validateSavedChildren is forcing your provider to flush the persistence context, and this picks up the changes made to parent that added two children. This should be expected. What isn&#39;t is the second set of update, which seem to be related to the parentRepo.save(parent) call. This save call is unnecessary, and should be a no-op, but apparently is resulting in extra updates to the child entries. Can you show what is actually changed in those statements? It would seem a bug in Spring&#39;s save impl or the provider (hibernate?) if nothing has changed.","body":"The query in validateSavedChildren is forcing your provider to flush the persistence context, and this picks up the changes made to parent that added two children. This should be expected. What isn&#39;t is the second set of update, which seem to be related to the parentRepo.save(parent) call. This save call is unnecessary, and should be a no-op, but apparently is resulting in extra updates to the child entries. Can you show what is actually changed in those statements? It would seem a bug in Spring&#39;s save impl or the provider (hibernate?) if nothing has changed."},{"owner":{"account_id":231721,"reputation":20460,"user_id":496099,"display_name":"Chris"},"score":0,"creation_date":1656346253,"post_id":72772827,"comment_id":128543954,"body_markdown":"@XtremeBaumer parentRepo.findById(parentId) does not lock an entity, and if it did (some custom implementation detail), the locks in the database are reentrant; you should be able to query for the same entity in the same transaction even with a pessimistic read lock. FindAll isn&#39;t causing the exception, it&#39;ll be the second flush (or commit) of the transaction after the save call. This seems to be executing on a connection that isn&#39;t apart of the initial transaction that inserted the children, and the provider thinks the children exist but are blank. This could be a transaction manager issue","body":"@XtremeBaumer parentRepo.findById(parentId) does not lock an entity, and if it did (some custom implementation detail), the locks in the database are reentrant; you should be able to query for the same entity in the same transaction even with a pessimistic read lock. FindAll isn&#39;t causing the exception, it&#39;ll be the second flush (or commit) of the transaction after the save call. This seems to be executing on a connection that isn&#39;t apart of the initial transaction that inserted the children, and the provider thinks the children exist but are blank. This could be a transaction manager issue"}],"owner":{"account_id":1903700,"reputation":1185,"user_id":1718984,"accept_rate":93,"display_name":"ParkCheolu"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":105,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1656340063,"creation_date":1656336047,"question_id":72772827,"body_markdown":"I&#39;m using Spring-data-jpa with Kotlin and I faced this error:\r\n\r\n    org.springframework.orm.ObjectOptimisticLockingFailureException: Batch update returned unexpected row count from update [0]; actual row count: 0; expected: 1; statement executed\r\n\r\nHere is my parent entity (unnecessary parts are omitted):\r\n\r\n\r\n    @Entity\r\n    class Parent(\r\n      @Id\r\n      @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n      val id: Long = 0L,\r\n    \r\n      @OneToMany(mappedBy = &quot;parent&quot;, cascade = [CascadeType.ALL], orphanRemoval = true)\r\n      val children: MutableList&lt;Child&gt; = mutableListOf()\r\n    ) {\r\n\r\n      fun addChild(child: Child) {\r\n        this.children.add(child)\r\n        child.parent = this\r\n      }\r\n    }\r\n\r\nHere is my child entity (omitted too):\r\n\r\n    @Entity\r\n    @Table(uniqueConstraints = [UniqueConstraint(columnNames = [&quot;parent_id&quot;])]\r\n    class Child(\r\n      @Id\r\n      @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n      val id: Long = 0L,\r\n    ) {\r\n\r\n      @ManyToOne(fetch = FetchType.LAZY)\r\n      @JoinColumn(name = &quot;parent_id&quot;)\r\n      lateinit var parent: Parent\r\n    }\r\n\r\nTransactional code is simple as follows:\r\n\r\n    @Transactional\r\n    fun saveChildren() {\r\n      ...\r\n      val parent: Parent = parentRepo.findById(parentId)\r\n      parent.addChild(Child())\r\n      parent.addChild(Child())\r\n      validateSavedChildren()   // select all children data to validate for some business reason\r\n      parentRepo.save(parent)\r\n    }\r\n\r\nI turn on the sql log for debugging and the sqls are like (It assumes the parent&#39;s id = 4):\r\n\r\n    insert into\r\n      child\r\n      (... parent_id) \r\n      values\r\n      (... 4)\r\n    enter code here\r\n\r\n    ...\r\n    \r\n    select\r\n      .... parent_id\r\n    from Child\r\n    where parent_id = 4\r\n\r\n    ...\r\n\r\n    update Child\r\n    set\r\n     parent_id = 4\r\n     ...\r\n    where id = 1\r\n\r\nThe query parameters are just correct. As I guess, the error occurred by the last update sql and also know what the error means. I think the data in insert sql is not yet visible when the update sql is executed. Why I&#39;m thinking this way is because I tried to reproduce the error with debug mode with my IDE(IntelliJ) and I executed the codes line by line, and the error is disappeared. Is this common case in JPA??\r\n\r\nWhat I really wonder is the reason why the update sql is executed. It seems useless because the setting data in update sql is just the same as insert sql. After some Internet research, I found out some cases that update happens after insert, but none of them fits my case.\r\n\r\nI also tried to change one line of code:\r\n\r\n    parentRepo.saveAndFlush(parent)\r\n\r\nIt made the upate sql disappear and the error is gone forever.\r\nWhy does this happen?? What am I missing??\r\n\r\n**UPDATE**\r\nHere is the function validateSavedChildren code:\r\n\r\n    fun validateSavedChildren() {\r\n      val parents: List&lt;Parant&gt; parentRepo.findAll()  // it select all parents in DB\r\n      var childrenCount = 0\r\n      parents.forEach { parent -&gt; \r\n        childrenCount += parent.children.size\r\n      }\r\n      if (childrenCount &gt; CHILDREN_LIMIT) {\r\n        throw ChildrenCountExceededLimitException()\r\n      }\r\n    }\r\n\r\nFollowing a comment by @XtremeBaumer, It seems like the above function has the key point because the update sql execution is removed by erasing the above function call.\r\n","title":"JPA ObjectOptimisticLockingFailureException on an Insert sql execution followed by an Update sql execution","body":"<p>I'm using Spring-data-jpa with Kotlin and I faced this error:</p>\n<pre><code>org.springframework.orm.ObjectOptimisticLockingFailureException: Batch update returned unexpected row count from update [0]; actual row count: 0; expected: 1; statement executed\n</code></pre>\n<p>Here is my parent entity (unnecessary parts are omitted):</p>\n<pre><code>@Entity\nclass Parent(\n  @Id\n  @GeneratedValue(strategy = GenerationType.IDENTITY)\n  val id: Long = 0L,\n\n  @OneToMany(mappedBy = &quot;parent&quot;, cascade = [CascadeType.ALL], orphanRemoval = true)\n  val children: MutableList&lt;Child&gt; = mutableListOf()\n) {\n\n  fun addChild(child: Child) {\n    this.children.add(child)\n    child.parent = this\n  }\n}\n</code></pre>\n<p>Here is my child entity (omitted too):</p>\n<pre><code>@Entity\n@Table(uniqueConstraints = [UniqueConstraint(columnNames = [&quot;parent_id&quot;])]\nclass Child(\n  @Id\n  @GeneratedValue(strategy = GenerationType.IDENTITY)\n  val id: Long = 0L,\n) {\n\n  @ManyToOne(fetch = FetchType.LAZY)\n  @JoinColumn(name = &quot;parent_id&quot;)\n  lateinit var parent: Parent\n}\n</code></pre>\n<p>Transactional code is simple as follows:</p>\n<pre><code>@Transactional\nfun saveChildren() {\n  ...\n  val parent: Parent = parentRepo.findById(parentId)\n  parent.addChild(Child())\n  parent.addChild(Child())\n  validateSavedChildren()   // select all children data to validate for some business reason\n  parentRepo.save(parent)\n}\n</code></pre>\n<p>I turn on the sql log for debugging and the sqls are like (It assumes the parent's id = 4):</p>\n<pre><code>insert into\n  child\n  (... parent_id) \n  values\n  (... 4)\nenter code here\n\n...\n\nselect\n  .... parent_id\nfrom Child\nwhere parent_id = 4\n\n...\n\nupdate Child\nset\n parent_id = 4\n ...\nwhere id = 1\n</code></pre>\n<p>The query parameters are just correct. As I guess, the error occurred by the last update sql and also know what the error means. I think the data in insert sql is not yet visible when the update sql is executed. Why I'm thinking this way is because I tried to reproduce the error with debug mode with my IDE(IntelliJ) and I executed the codes line by line, and the error is disappeared. Is this common case in JPA??</p>\n<p>What I really wonder is the reason why the update sql is executed. It seems useless because the setting data in update sql is just the same as insert sql. After some Internet research, I found out some cases that update happens after insert, but none of them fits my case.</p>\n<p>I also tried to change one line of code:</p>\n<pre><code>parentRepo.saveAndFlush(parent)\n</code></pre>\n<p>It made the upate sql disappear and the error is gone forever.\nWhy does this happen?? What am I missing??</p>\n<p><strong>UPDATE</strong>\nHere is the function validateSavedChildren code:</p>\n<pre><code>fun validateSavedChildren() {\n  val parents: List&lt;Parant&gt; parentRepo.findAll()  // it select all parents in DB\n  var childrenCount = 0\n  parents.forEach { parent -&gt; \n    childrenCount += parent.children.size\n  }\n  if (childrenCount &gt; CHILDREN_LIMIT) {\n    throw ChildrenCountExceededLimitException()\n  }\n}\n</code></pre>\n<p>Following a comment by @XtremeBaumer, It seems like the above function has the key point because the update sql execution is removed by erasing the above function call.</p>\n"},{"tags":["java","design-patterns"],"comments":[{"owner":{"display_name":"user6073886"},"score":5,"creation_date":1656338837,"post_id":72773441,"comment_id":128540884,"body_markdown":"Object creation in java is always done with the `new` keyword. As you can see there isn&#39;t a single `new` in the code above, hence absolutely no object creation is taking place anywhere in that code.","body":"Object creation in java is always done with the <code>new</code> keyword. As you can see there isn&#39;t a single <code>new</code> in the code above, hence absolutely no object creation is taking place anywhere in that code."},{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":0,"creation_date":1656338920,"post_id":72773441,"comment_id":128540915,"body_markdown":"*&quot;how can a class be instantiated inside itself?&quot;* leaving aside the fact that no-one is instantiating anything here, [recursive data types](https://en.wikipedia.org/wiki/Recursive_data_type) exist in many languages, including java. That&#39;s how you define lists, for example.","body":"<i>&quot;how can a class be instantiated inside itself?&quot;</i> leaving aside the fact that no-one is instantiating anything here, <a href=\"https://en.wikipedia.org/wiki/Recursive_data_type\" rel=\"nofollow noreferrer\">recursive data types</a> exist in many languages, including java. That&#39;s how you define lists, for example."},{"owner":{"account_id":15910041,"reputation":592,"user_id":11480221,"display_name":"AddeusExMachina"},"score":0,"creation_date":1656338955,"post_id":72773441,"comment_id":128540925,"body_markdown":"Where do you think an object is created inside the abstract class?","body":"Where do you think an object is created inside the abstract class?"},{"owner":{"account_id":3741438,"reputation":12025,"user_id":3111149,"accept_rate":87,"display_name":"Matteo NNZ"},"score":2,"creation_date":1656339046,"post_id":72773441,"comment_id":128540959,"body_markdown":"I think he meant to ask &quot;can a class have a field of the same type than itself?&quot; (the class `AbstractHandler` has a field of type `AbstractHandler`, the first class is in the question but could not be there). And the answer is yes, it can.","body":"I think he meant to ask &quot;can a class have a field of the same type than itself?&quot; (the class <code>AbstractHandler</code> has a field of type <code>AbstractHandler</code>, the first class is in the question but could not be there). And the answer is yes, it can."},{"owner":{"account_id":1485367,"reputation":122993,"user_id":1393766,"display_name":"Pshemo"},"score":0,"creation_date":1656339080,"post_id":72773441,"comment_id":128540971,"body_markdown":"&quot;I can&#39;t understand how an abstract class can create an object.&quot; what makes you think they are? Note that variable of *supertype* can hold (reference to) object of *subtype*. For instance `Animal animal = new Cat();` (note that `Animal` may also be *abstract* class, while `Cat` is non-abstract subtype of `Animal`).","body":"&quot;I can&#39;t understand how an abstract class can create an object.&quot; what makes you think they are? Note that variable of <i>supertype</i> can hold (reference to) object of <i>subtype</i>. For instance <code>Animal animal = new Cat();</code> (note that <code>Animal</code> may also be <i>abstract</i> class, while <code>Cat</code> is non-abstract subtype of <code>Animal</code>)."}],"answers":[{"tags":[],"owner":{"account_id":960307,"reputation":107861,"user_id":984823,"display_name":"Joop Eggen"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656339309,"creation_date":1656339309,"answer_id":72773573,"question_id":72773441,"body_markdown":"In fact the following compiles (not written by me):\r\n\r\n_A.java_\r\n\r\n    interface A {\r\n        final A FOO = new B();\r\n    }\r\n\r\n_B.java_\r\n\r\n    class B implements A {\r\n    }\r\n\r\nThis is because the .class files are like object files (.o, .obj) files in other languages, and the linkage is done with textual signatures. So A imports a class B, and B imports an interface A, without requiring them to be compiled already.\r\n\r\nThe ClassLoader of the JVM will then &quot;link&quot; them, possibly giver &quot;link&quot; errors, like method not available or such.\r\n","title":"Can a public abstract class create an object of itself inside itself?","body":"<p>In fact the following compiles (not written by me):</p>\n<p><em>A.java</em></p>\n<pre><code>interface A {\n    final A FOO = new B();\n}\n</code></pre>\n<p><em>B.java</em></p>\n<pre><code>class B implements A {\n}\n</code></pre>\n<p>This is because the .class files are like object files (.o, .obj) files in other languages, and the linkage is done with textual signatures. So A imports a class B, and B imports an interface A, without requiring them to be compiled already.</p>\n<p>The ClassLoader of the JVM will then &quot;link&quot; them, possibly giver &quot;link&quot; errors, like method not available or such.</p>\n"}],"owner":{"account_id":22224504,"reputation":83,"user_id":17333696,"display_name":"Ken Adams"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":50,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1656339550,"creation_date":1656338692,"question_id":72773441,"body_markdown":"I&#39;m learning the chain of responsibility pattern and this is given as the example:\r\n```Java\r\nabstract public class AbstractRequest {\r\n\r\n    // Each request is identified by a an integer\r\n    // FireRequest: 1\r\n    // LowFuelRequest: 2\r\n    private int requestCode;\r\n\r\n    public AbstractRequest(int requestCode) {\r\n        this.requestCode = requestCode;\r\n    }\r\n\r\n    public int getRequestCode() {\r\n        return requestCode;\r\n    }\r\n}\r\n\r\nabstract public class AbstractHandler {\r\n\r\n    private AbstractHandler next;\r\n\r\n    public AbstractHandler(AbstractHandler next) {\r\n        this.next = next;\r\n    }\r\n\r\n    public void setNext(AbstractHandler next) {\r\n        this.next = next;\r\n    }\r\n\r\n    public void handleRequest(AbstractRequest request) {\r\n        if (next != null) {\r\n            next.handleRequest(request);\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nI can&#39;t understand how an abstract class can create an object. \r\n\r\nMoreover, how can a class be instantiated inside itself? \r\n\r\nWouldn&#39;t it cause indefinite recursion?\r\n\r\nEDIT:\r\nThe above questions are raised w.r.t this line:\r\n` private AbstractHandler next;`","title":"Can a public abstract class create an object of itself inside itself?","body":"<p>I'm learning the chain of responsibility pattern and this is given as the example:</p>\n<pre><code>abstract public class AbstractRequest {\n\n    // Each request is identified by a an integer\n    // FireRequest: 1\n    // LowFuelRequest: 2\n    private int requestCode;\n\n    public AbstractRequest(int requestCode) {\n        this.requestCode = requestCode;\n    }\n\n    public int getRequestCode() {\n        return requestCode;\n    }\n}\n\nabstract public class AbstractHandler {\n\n    private AbstractHandler next;\n\n    public AbstractHandler(AbstractHandler next) {\n        this.next = next;\n    }\n\n    public void setNext(AbstractHandler next) {\n        this.next = next;\n    }\n\n    public void handleRequest(AbstractRequest request) {\n        if (next != null) {\n            next.handleRequest(request);\n        }\n    }\n}\n</code></pre>\n<p>I can't understand how an abstract class can create an object.</p>\n<p>Moreover, how can a class be instantiated inside itself?</p>\n<p>Wouldn't it cause indefinite recursion?</p>\n<p>EDIT:\nThe above questions are raised w.r.t this line:\n<code> private AbstractHandler next;</code></p>\n"},{"tags":["java","classcastexception"],"comments":[{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":0,"creation_date":1656339215,"post_id":72773526,"comment_id":128541021,"body_markdown":"What&#39;s inside `nums`? Where&#39;s the code that puts stuff in it?","body":"What&#39;s inside <code>nums</code>? Where&#39;s the code that puts stuff in it?"},{"owner":{"account_id":5190284,"reputation":13363,"user_id":4153426,"display_name":"m.antkowicz"},"score":3,"creation_date":1656339228,"post_id":72773526,"comment_id":128541029,"body_markdown":"Why are you casting this?","body":"Why are you casting this?"},{"owner":{"account_id":10391527,"reputation":76,"user_id":10381291,"display_name":"web1connoisseur"},"score":0,"creation_date":1656339424,"post_id":72773526,"comment_id":128541108,"body_markdown":"@m.antkowicz sorry, that was after playing around trying to get it to work, I forgot to remove it. Keeping it now for the sake of anyone reading this, so they don&#39;t get confused.","body":"@m.antkowicz sorry, that was after playing around trying to get it to work, I forgot to remove it. Keeping it now for the sake of anyone reading this, so they don&#39;t get confused."},{"owner":{"account_id":15777655,"reputation":1762,"user_id":11385052,"display_name":"Ryan"},"score":0,"creation_date":1656339472,"post_id":72773526,"comment_id":128541129,"body_markdown":"This code doesn&#39;t do anything. The for loop is removing values from a copy of the original List, not the List.  You don&#39;t need the cast.  Depending on the size of the Lists, you&#39;re gobbling up a ton of memory.","body":"This code doesn&#39;t do anything. The for loop is removing values from a copy of the original List, not the List.  You don&#39;t need the cast.  Depending on the size of the Lists, you&#39;re gobbling up a ton of memory."},{"owner":{"account_id":10391527,"reputation":76,"user_id":10381291,"display_name":"web1connoisseur"},"score":0,"creation_date":1656339622,"post_id":72773526,"comment_id":128541207,"body_markdown":"@Ryan I&#39;m just playing around with this, I understand it might not be optimal. Please help me understand the issue on line 20.","body":"@Ryan I&#39;m just playing around with this, I understand it might not be optimal. Please help me understand the issue on line 20."},{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":1,"creation_date":1656339659,"post_id":72773526,"comment_id":128541221,"body_markdown":"@web1connoisseur `List&lt;Integer&gt; n = new ArrayList(Arrays.asList(nums));` didn&#39;t this throw a warning?","body":"@web1connoisseur <code>List&lt;Integer&gt; n = new ArrayList(Arrays.asList(nums));</code> didn&#39;t this throw a warning?"},{"owner":{"account_id":10391527,"reputation":76,"user_id":10381291,"display_name":"web1connoisseur"},"score":0,"creation_date":1656339700,"post_id":72773526,"comment_id":128541239,"body_markdown":"@FedericoklezCulloca it did not. However, I&#39;m doing this in LeetCode&#39;s web IDE.","body":"@FedericoklezCulloca it did not. However, I&#39;m doing this in LeetCode&#39;s web IDE."},{"owner":{"account_id":39574,"reputation":24267,"user_id":114226,"accept_rate":79,"display_name":"PeterMmm"},"score":0,"creation_date":1656339828,"post_id":72773526,"comment_id":128541311,"body_markdown":"`([I and java.lang.Integer are ...`,  this `I`, where it comes from ? Strange error message ...","body":"<code>([I and java.lang.Integer are ...</code>,  this <code>I</code>, where it comes from ? Strange error message ..."},{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":0,"creation_date":1656339830,"post_id":72773526,"comment_id":128541314,"body_markdown":"@web1connoisseur I see. By the way my point is, `n` is not what you think it is, since `new ArrayList(Arrays.asList(nums))` does *not* return a `List&lt;Integer&gt;`. So when you cast the result of `get`ting something from it you&#39;re not `get`ing an `Integer` and the cast fails.","body":"@web1connoisseur I see. By the way my point is, <code>n</code> is not what you think it is, since <code>new ArrayList(Arrays.asList(nums))</code> does <i>not</i> return a <code>List&lt;Integer&gt;</code>. So when you cast the result of <code>get</code>ting something from it you&#39;re not <code>get</code>ing an <code>Integer</code> and the cast fails."},{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":2,"creation_date":1656339928,"post_id":72773526,"comment_id":128541358,"body_markdown":"See [this other answer](https://stackoverflow.com/a/2607327/133203) as for what is happening here (and the other answers in that thread to see how to circumvent this).","body":"See <a href=\"https://stackoverflow.com/a/2607327/133203\">this other answer</a> as for what is happening here (and the other answers in that thread to see how to circumvent this)."},{"owner":{"account_id":698222,"reputation":50202,"user_id":573032,"accept_rate":77,"display_name":"Roman C"},"score":0,"creation_date":1656340077,"post_id":72773526,"comment_id":128541428,"body_markdown":"Typecast error can be removed if you know how to circumvent the integer type.","body":"Typecast error can be removed if you know how to circumvent the integer type."},{"owner":{"account_id":12743722,"reputation":19956,"user_id":12567365,"display_name":"andrewJames"},"score":0,"creation_date":1656340340,"post_id":72773526,"comment_id":128541538,"body_markdown":"Regarding your question: &quot;_this `I`, where it comes from?_&quot; - the identifier is actually `[I`. For an explanation see [\\[L array notation - where does it come from?](https://stackoverflow.com/q/5085889/12567365) In your case, it refers to an array of integers. @PeterMmm","body":"Regarding your question: &quot;<i>this <code>I</code>, where it comes from?</i>&quot; - the identifier is actually <code>[I</code>. For an explanation see <a href=\"https://stackoverflow.com/q/5085889/12567365\">&#91;L array notation - where does it come from?</a> In your case, it refers to an array of integers. @PeterMmm"},{"owner":{"account_id":263656,"reputation":1,"user_id":549372,"accept_rate":100,"display_name":"Martin Zeitler"},"score":0,"creation_date":1656340601,"post_id":72773526,"comment_id":128541651,"body_markdown":"`Integer c` is never being used ...so what&#39;s the point?","body":"<code>Integer c</code> is never being used ...so what&#39;s the point?"},{"owner":{"account_id":10391527,"reputation":76,"user_id":10381291,"display_name":"web1connoisseur"},"score":0,"creation_date":1656340846,"post_id":72773526,"comment_id":128541767,"body_markdown":"@MartinZeitler this solution isn&#39;t finished past where the error occurs. I would have added c to temp before calling permute.","body":"@MartinZeitler this solution isn&#39;t finished past where the error occurs. I would have added c to temp before calling permute."},{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":1,"creation_date":1656341196,"post_id":72773526,"comment_id":128541947,"body_markdown":"Does this answer your question? [Using Arrays.asList with int array](https://stackoverflow.com/questions/25483854/using-arrays-aslist-with-int-array) (not the best duplicate but it explains what the end result is and my ddg-fu is failing me)","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/25483854/using-arrays-aslist-with-int-array\">Using Arrays.asList with int array</a> (not the best duplicate but it explains what the end result is and my ddg-fu is failing me)"},{"owner":{"account_id":12743722,"reputation":19956,"user_id":12567365,"display_name":"andrewJames"},"score":1,"creation_date":1656360885,"post_id":72773526,"comment_id":128548792,"body_markdown":"As noted in [this comment](https://stackoverflow.com/questions/2607289/converting-array-to-list-in-java/30281879#comment123882111_30281879), these days you can use `List&lt;Integer&gt; n = Arrays.stream(nums).boxed().toList();` to avoid this problem. See also Josh Bloch&#39;s _Effective Java_ (3rd Edition) item 32: &quot;Combine generics and varargs judiciously&quot;.","body":"As noted in <a href=\"https://stackoverflow.com/questions/2607289/converting-array-to-list-in-java/30281879#comment123882111_30281879\">this comment</a>, these days you can use <code>List&lt;Integer&gt; n = Arrays.stream(nums).boxed().toList();</code> to avoid this problem. See also Josh Bloch&#39;s <i>Effective Java</i> (3rd Edition) item 32: &quot;Combine generics and varargs judiciously&quot;."},{"owner":{"account_id":10391527,"reputation":76,"user_id":10381291,"display_name":"web1connoisseur"},"score":1,"creation_date":1656422973,"post_id":72773526,"comment_id":128564734,"body_markdown":"That worked, thanks @andrewJames! If you want to post that as the answer, I&#39;ll accept it","body":"That worked, thanks @andrewJames! If you want to post that as the answer, I&#39;ll accept it"},{"owner":{"account_id":12743722,"reputation":19956,"user_id":12567365,"display_name":"andrewJames"},"score":0,"creation_date":1656438610,"post_id":72773526,"comment_id":128570870,"body_markdown":"I don&#39;t think I can write an answer for this, as it would be a duplicate of the question [Converting array to list in Java](https://stackoverflow.com/q/2607289/12567365).  The explanation of the problem is referenced in [this answer about generics and varargs](https://stackoverflow.com/a/2607327/12567365) in that question. And one solution is referenced in [this other answer which uses the stream and `boxed()` solution](https://stackoverflow.com/a/30281879/12567365) in the same question. I would go vote for those, instead of voting for any answer here.","body":"I don&#39;t think I can write an answer for this, as it would be a duplicate of the question <a href=\"https://stackoverflow.com/q/2607289/12567365\">Converting array to list in Java</a>.  The explanation of the problem is referenced in <a href=\"https://stackoverflow.com/a/2607327/12567365\">this answer about generics and varargs</a> in that question. And one solution is referenced in <a href=\"https://stackoverflow.com/a/30281879/12567365\">this other answer which uses the stream and <code>boxed()</code> solution</a> in the same question. I would go vote for those, instead of voting for any answer here."},{"owner":{"account_id":12743722,"reputation":19956,"user_id":12567365,"display_name":"andrewJames"},"score":0,"creation_date":1656438617,"post_id":72773526,"comment_id":128570872,"body_markdown":"You could also use `Integer[]` instead of `int[]`.","body":"You could also use <code>Integer[]</code> instead of <code>int[]</code>."}],"owner":{"account_id":10391527,"reputation":76,"user_id":10381291,"display_name":"web1connoisseur"},"comment_count":19,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":70,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1656339369,"creation_date":1656339083,"question_id":72773526,"body_markdown":"I have read other similar questions on StackOverflow but do not understand the root cause, and can&#39;t figure out a fix on my own. Could you help me understand what the issue is?\r\n\r\nHere is my code:\r\n    \r\n    List&lt;List&lt;Integer&gt;&gt; res;\r\n\r\n    public List&lt;List&lt;Integer&gt;&gt; permute(int[] nums) {\r\n        res = new ArrayList();\r\n        List&lt;Integer&gt; n = new ArrayList(Arrays.asList(nums));\r\n        permute(n, new ArrayList());\r\n        return res;\r\n    }\r\n\r\n    private void permute(List&lt;Integer&gt; nums, List&lt;Integer&gt; cur) {\r\n        if (nums.size() == 0) {\r\n            res.add(cur);\r\n            return;\r\n        }\r\n        \r\n        for (int i = 0; i &lt; nums.size(); ++i) {\r\n            List&lt;Integer&gt; temp = new ArrayList&lt;Integer&gt;(cur);\r\n            List&lt;Integer&gt; temp2 = new ArrayList&lt;Integer&gt;(nums);\r\n            Integer c = (Integer)nums.get(i); (line 20)\r\n            temp2.remove(i);\r\n            \r\n            permute(temp2, temp);\r\n        }\r\n    }\r\n\r\nbut I get this error: \r\n\r\n    java.lang.ClassCastException: class [I cannot be cast to class java.lang.Integer ([I and java.lang.Integer are in module java.base of loader &#39;bootstrap&#39;)\r\n      at line 20, Solution.permute\r\n      at line 7, Solution.permute\r\n      at line 54, __DriverSolution__.__helper__\r\n      at line 84, __Driver__.main","title":"How can I do what I think this code is doing without getting a ClassCastException?","body":"<p>I have read other similar questions on StackOverflow but do not understand the root cause, and can't figure out a fix on my own. Could you help me understand what the issue is?</p>\n<p>Here is my code:</p>\n<pre><code>List&lt;List&lt;Integer&gt;&gt; res;\n\npublic List&lt;List&lt;Integer&gt;&gt; permute(int[] nums) {\n    res = new ArrayList();\n    List&lt;Integer&gt; n = new ArrayList(Arrays.asList(nums));\n    permute(n, new ArrayList());\n    return res;\n}\n\nprivate void permute(List&lt;Integer&gt; nums, List&lt;Integer&gt; cur) {\n    if (nums.size() == 0) {\n        res.add(cur);\n        return;\n    }\n    \n    for (int i = 0; i &lt; nums.size(); ++i) {\n        List&lt;Integer&gt; temp = new ArrayList&lt;Integer&gt;(cur);\n        List&lt;Integer&gt; temp2 = new ArrayList&lt;Integer&gt;(nums);\n        Integer c = (Integer)nums.get(i); (line 20)\n        temp2.remove(i);\n        \n        permute(temp2, temp);\n    }\n}\n</code></pre>\n<p>but I get this error:</p>\n<pre><code>java.lang.ClassCastException: class [I cannot be cast to class java.lang.Integer ([I and java.lang.Integer are in module java.base of loader 'bootstrap')\n  at line 20, Solution.permute\n  at line 7, Solution.permute\n  at line 54, __DriverSolution__.__helper__\n  at line 84, __Driver__.main\n</code></pre>\n"},{"tags":["java","sql","db2","h2"],"answers":[{"tags":[],"owner":{"account_id":16247179,"reputation":7205,"user_id":11731987,"display_name":"Evgenij Ryazanov"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1656339044,"creation_date":1656338021,"answer_id":72773284,"question_id":72772742,"body_markdown":"It isn&#39;t possible to create a user-defined function with special arguments in H2 and most likely in all or almost all other database systems. User-defined functions accept only plain comma-separated arguments with literals or expressions in them.\r\n\r\n(You also cannot declare a parameter as `org.h2.expression.Expression`.)\r\n\r\nThe proper solution here is to use the `TRIM` function from the SQL Standard:\r\n\r\nhttps://h2database.com/html/functions.html#trim\r\n\r\nhttps://www.ibm.com/docs/en/db2-for-zos/11?topic=functions-trim\r\n\r\n```lang-sql\r\nTRIM(BOTH &#39; &#39; FROM T2.ITEM_TYPE_NAME_GER)\r\n```\r\n\r\nPlease note that `B`, `L`, and `T` acronyms is a DB2-specific extension, in H2 you can use only standard `BOTH`, `LEADING`, and `TRAILING`.\r\n\r\nIf you cannot change your query you can only modify sources of H2 and compile its own version with support of the `STRIP`. But actually you can run into some other issue immediately. When you want to use multiple database systems at once you need to realize that they all are very different from each other. H2 provides compatibility modes for others, but even in these modes there is a very limited compatibility. It means you need to avoid usage of vendor-specific functions and other grammar elements and in some cases different SQL for different systems may be required.\r\n\r\n---\r\n\r\nYou also can try to create constants `B`, `BOTH`, `L`, `LEADING`, `T`, and `TRAILING` with some values\r\n```lang-sql\r\nCREATE CONSTANT B VALUE 1;\r\nCREATE CONSTANT BOTH VALUE 1;\r\nCREATE CONSTANT L VALUE 2;\r\n…\r\n```\r\n\r\nand create a function with three arguments, second argument will be of type `int` (or other, if you&#39;ll decide to choose values of some other data type). But names of constants may conflict with column names, so this workaround is far from being perfect and may not work at all in some queries.","title":"H2 DB mapping to IBM DB2 database UDF for missing function: STRIP","body":"<p>It isn't possible to create a user-defined function with special arguments in H2 and most likely in all or almost all other database systems. User-defined functions accept only plain comma-separated arguments with literals or expressions in them.</p>\n<p>(You also cannot declare a parameter as <code>org.h2.expression.Expression</code>.)</p>\n<p>The proper solution here is to use the <code>TRIM</code> function from the SQL Standard:</p>\n<p><a href=\"https://h2database.com/html/functions.html#trim\" rel=\"nofollow noreferrer\">https://h2database.com/html/functions.html#trim</a></p>\n<p><a href=\"https://www.ibm.com/docs/en/db2-for-zos/11?topic=functions-trim\" rel=\"nofollow noreferrer\">https://www.ibm.com/docs/en/db2-for-zos/11?topic=functions-trim</a></p>\n<pre class=\"lang-sql prettyprint-override\"><code>TRIM(BOTH ' ' FROM T2.ITEM_TYPE_NAME_GER)\n</code></pre>\n<p>Please note that <code>B</code>, <code>L</code>, and <code>T</code> acronyms is a DB2-specific extension, in H2 you can use only standard <code>BOTH</code>, <code>LEADING</code>, and <code>TRAILING</code>.</p>\n<p>If you cannot change your query you can only modify sources of H2 and compile its own version with support of the <code>STRIP</code>. But actually you can run into some other issue immediately. When you want to use multiple database systems at once you need to realize that they all are very different from each other. H2 provides compatibility modes for others, but even in these modes there is a very limited compatibility. It means you need to avoid usage of vendor-specific functions and other grammar elements and in some cases different SQL for different systems may be required.</p>\n<hr />\n<p>You also can try to create constants <code>B</code>, <code>BOTH</code>, <code>L</code>, <code>LEADING</code>, <code>T</code>, and <code>TRAILING</code> with some values</p>\n<pre class=\"lang-sql prettyprint-override\"><code>CREATE CONSTANT B VALUE 1;\nCREATE CONSTANT BOTH VALUE 1;\nCREATE CONSTANT L VALUE 2;\n…\n</code></pre>\n<p>and create a function with three arguments, second argument will be of type <code>int</code> (or other, if you'll decide to choose values of some other data type). But names of constants may conflict with column names, so this workaround is far from being perfect and may not work at all in some queries.</p>\n"}],"owner":{"account_id":25660791,"reputation":3,"user_id":19426555,"display_name":"christian s"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":167,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":72773284,"answer_count":1,"score":0,"last_activity_date":1656339044,"creation_date":1656335653,"question_id":72772742,"body_markdown":"I am trying to setup a unit test environment for a large codebase. For these unit tests I use H2 database instead of the IBM DB2 database, which is used in production and I already implemented a few UDF&#39;s to map IBM DB2 related functions to the H2 database.\r\nSome more Details about the project:\r\n\r\n- Java 8 JDK 321 64 Bit\r\n- DB2 12, DSN 12015\r\n- H2 version 2.1.212 with &lt;MODE=DB2;DEFAULT_NULL_ORDERING=HIGH;\r\n\r\nI am trying to implement the IBM Db2 function: strip() [Reference Doc - IBM](https://www.ibm.com/docs/en/db2-for-zos/11?topic=functions-strip). This function is called as part of a larger select statement with the clause: STRIP(T2.ITEM_TYPE_NAME_GER, B, &#39; &#39;). While I can map the first and last input parameter to a Java function and call this function as an ALIAS in H2, I was not able to manage to get the 2nd parameter interpreted in the correct way as a String or Expression. The JDBC/H2 engine always tries to map it to a table column:\r\n\r\n&lt;pre&gt;&lt;code&gt; \r\n    org.h2.jdbc.JdbcSQLSyntaxErrorException: Feld &quot;B&quot; nicht gefunden\r\n    Column &quot;B&quot; not found; SQL statement:\r\n    SELECT T1.ITEM_TYPE_KEY,T1.SUPER_ITM_TYPE_KEY,T2.ITM_TYPE_KEY_TRANS,T2.ITEM_TYPE_NAME,T2.COMPLEX_FLAG,T2.ITEM_CATEGORY,T2.HEADER_FLAG,T2.HEADER_NO ,T2.LEVEL_NO,strip(T2.ITEM_TYPE_NAME_GER, B, &#39; &#39;) ,T2.LEVEL1_DISPLAY FROM      public.AA752T      T1,   public.AA743T            T2 WHERE          T1.ITEM_TYPE_KEY NOT IN (&#39;F4CO&#39;, &#39;F4CB&#39;, &#39;F4RB&#39;, &#39;F4SO&#39;, &#39;F4SB&#39;, &#39;F4RO&#39;) AND T1.ITEM_TYPE_KEY = T2.ITEM_TYPE_KEY ORDER BY T2.HEADER_NO,T2.HEADER_FLAG DESC,T2.LEVEL_NO,T1.SUPER_ITM_TYPE_KEY,T2.LEVEL_PRIORITY [42122-212]\r\n    \tat org.h2.message.DbException.getJdbcSQLException(DbException.java:502)\r\n    \tat org.h2.message.DbException.getJdbcSQLException(DbException.java:477)\r\n    \tat org.h2.message.DbException.get(DbException.java:223)\r\n    \tat org.h2.message.DbException.get(DbException.java:199)\r\n    \tat org.h2.expression.ExpressionColumn.getColumnException(ExpressionColumn.java:244)\r\n    \tat org.h2.expression.ExpressionColumn.optimizeOther(ExpressionColumn.java:226)\r\n    \tat org.h2.expression.ExpressionColumn.optimize(ExpressionColumn.java:213)\r\n    \tat org.h2.expression.function.JavaFunction.optimize(JavaFunction.java:59)\r\n    \tat org.h2.command.query.Select.prepareExpressions(Select.java:1170)\r\n    \tat org.h2.command.query.Query.prepare(Query.java:218)\r\n    \tat org.h2.command.Parser.prepareCommand(Parser.java:574)\r\n    \tat org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:631)\r\n    \tat org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:554)\r\n    \tat org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1116)\r\n    \tat org.h2.jdbc.JdbcPreparedStatement.&lt;init&gt;(JdbcPreparedStatement.java:92)\r\n    \tat org.h2.jdbc.JdbcConnection.prepareStatement(JdbcConnection.java:288)\r\n    \tat com.db.cib.gbd.gps.pbs.pricing.StaticItemDetails.retriveItemDisplayDetails(StaticItemDetails.java:920) \r\n\r\n&lt;/code&gt;&lt;/pre&gt;\r\n\r\nThis is my Java UDF: \r\n\r\n&lt;pre&gt;&lt;code&gt;\r\npublic static String strip(String s, Expression loc, String trimConstant) {\r\n\t\t\r\n\tif (loc.toLowerCase() == &quot;b&quot; || loc.toLowerCase() == &quot;both&quot;) {\r\n\t\ts = s.replaceAll(&quot;^[&quot; + trimConstant + &quot;]+|[ \\t]+$&quot;, &quot;&quot;);\r\n\t} else if (loc.toLowerCase() == &quot;l&quot; || loc.toLowerCase() == &quot;leading&quot;) {\r\n\t\ts = s.replaceAll(&quot;^[&quot; + trimConstant + &quot;]+&quot;, &quot;&quot;);\r\n\t} else if (loc.toLowerCase() == &quot;t&quot; || loc.toLowerCase() == &quot;trailing&quot;) {\r\n\t\ts = s.replaceAll(&quot;[&quot; + trimConstant + &quot;]+$&quot;, &quot;&quot;);\r\n\t}\r\n\treturn s;\r\n}\r\n&lt;/code&gt;&lt;/pre&gt;\r\n\r\nIs there a possibility to get the mapping of the column in the correct way, or can you suggest either a SQL function, which is usable as UDF alias (how is this usable?) or a way to solve this error?\r\nTo avoid this question: I cannot change the existing sql statement. I have to find an alias for this function.","title":"H2 DB mapping to IBM DB2 database UDF for missing function: STRIP","body":"<p>I am trying to setup a unit test environment for a large codebase. For these unit tests I use H2 database instead of the IBM DB2 database, which is used in production and I already implemented a few UDF's to map IBM DB2 related functions to the H2 database.\nSome more Details about the project:</p>\n<ul>\n<li>Java 8 JDK 321 64 Bit</li>\n<li>DB2 12, DSN 12015</li>\n<li>H2 version 2.1.212 with &lt;MODE=DB2;DEFAULT_NULL_ORDERING=HIGH;</li>\n</ul>\n<p>I am trying to implement the IBM Db2 function: strip() <a href=\"https://www.ibm.com/docs/en/db2-for-zos/11?topic=functions-strip\" rel=\"nofollow noreferrer\">Reference Doc - IBM</a>. This function is called as part of a larger select statement with the clause: STRIP(T2.ITEM_TYPE_NAME_GER, B, ' '). While I can map the first and last input parameter to a Java function and call this function as an ALIAS in H2, I was not able to manage to get the 2nd parameter interpreted in the correct way as a String or Expression. The JDBC/H2 engine always tries to map it to a table column:</p>\n<pre><code> \n    org.h2.jdbc.JdbcSQLSyntaxErrorException: Feld \"B\" nicht gefunden\n    Column \"B\" not found; SQL statement:\n    SELECT T1.ITEM_TYPE_KEY,T1.SUPER_ITM_TYPE_KEY,T2.ITM_TYPE_KEY_TRANS,T2.ITEM_TYPE_NAME,T2.COMPLEX_FLAG,T2.ITEM_CATEGORY,T2.HEADER_FLAG,T2.HEADER_NO ,T2.LEVEL_NO,strip(T2.ITEM_TYPE_NAME_GER, B, ' ') ,T2.LEVEL1_DISPLAY FROM      public.AA752T      T1,   public.AA743T            T2 WHERE          T1.ITEM_TYPE_KEY NOT IN ('F4CO', 'F4CB', 'F4RB', 'F4SO', 'F4SB', 'F4RO') AND T1.ITEM_TYPE_KEY = T2.ITEM_TYPE_KEY ORDER BY T2.HEADER_NO,T2.HEADER_FLAG DESC,T2.LEVEL_NO,T1.SUPER_ITM_TYPE_KEY,T2.LEVEL_PRIORITY [42122-212]\n        at org.h2.message.DbException.getJdbcSQLException(DbException.java:502)\n        at org.h2.message.DbException.getJdbcSQLException(DbException.java:477)\n        at org.h2.message.DbException.get(DbException.java:223)\n        at org.h2.message.DbException.get(DbException.java:199)\n        at org.h2.expression.ExpressionColumn.getColumnException(ExpressionColumn.java:244)\n        at org.h2.expression.ExpressionColumn.optimizeOther(ExpressionColumn.java:226)\n        at org.h2.expression.ExpressionColumn.optimize(ExpressionColumn.java:213)\n        at org.h2.expression.function.JavaFunction.optimize(JavaFunction.java:59)\n        at org.h2.command.query.Select.prepareExpressions(Select.java:1170)\n        at org.h2.command.query.Query.prepare(Query.java:218)\n        at org.h2.command.Parser.prepareCommand(Parser.java:574)\n        at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:631)\n        at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:554)\n        at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1116)\n        at org.h2.jdbc.JdbcPreparedStatement.(JdbcPreparedStatement.java:92)\n        at org.h2.jdbc.JdbcConnection.prepareStatement(JdbcConnection.java:288)\n        at com.db.cib.gbd.gps.pbs.pricing.StaticItemDetails.retriveItemDisplayDetails(StaticItemDetails.java:920) \n\n</code></pre>\n<p>This is my Java UDF:</p>\n<pre><code>\npublic static String strip(String s, Expression loc, String trimConstant) {\n        \n    if (loc.toLowerCase() == \"b\" || loc.toLowerCase() == \"both\") {\n        s = s.replaceAll(\"^[\" + trimConstant + \"]+|[ \\t]+$\", \"\");\n    } else if (loc.toLowerCase() == \"l\" || loc.toLowerCase() == \"leading\") {\n        s = s.replaceAll(\"^[\" + trimConstant + \"]+\", \"\");\n    } else if (loc.toLowerCase() == \"t\" || loc.toLowerCase() == \"trailing\") {\n        s = s.replaceAll(\"[\" + trimConstant + \"]+$\", \"\");\n    }\n    return s;\n}\n</code></pre>\n<p>Is there a possibility to get the mapping of the column in the correct way, or can you suggest either a SQL function, which is usable as UDF alias (how is this usable?) or a way to solve this error?\nTo avoid this question: I cannot change the existing sql statement. I have to find an alias for this function.</p>\n"},{"tags":["java","spring-boot"],"comments":[{"owner":{"account_id":10235034,"reputation":10879,"user_id":7554328,"display_name":"Darren Forsythe"},"score":0,"creation_date":1656339471,"post_id":72773397,"comment_id":128541127,"body_markdown":"You&#39;re creating an object outside of the Spring Context, it can&#39;t apply the async capabilities unless spring creates the object.","body":"You&#39;re creating an object outside of the Spring Context, it can&#39;t apply the async capabilities unless spring creates the object."},{"owner":{"account_id":3916360,"reputation":159,"user_id":3240085,"accept_rate":64,"display_name":"uti.devel"},"score":0,"creation_date":1658412341,"post_id":72773397,"comment_id":129049550,"body_markdown":"Let String create the AsyServiceImpl by using @ Autowired AsyServiceImpl and make it a @ Component or @ Service","body":"Let String create the AsyServiceImpl by using @ Autowired AsyServiceImpl and make it a @ Component or @ Service"}],"owner":{"account_id":18669144,"reputation":1,"user_id":13608394,"display_name":"Adityaraj Singh"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":67,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1656338533,"creation_date":1656338533,"question_id":72773397,"body_markdown":"I&#39;m calling my async function from another function like this. \r\n\r\n    AsyServiceImpl asyServiceImpl = new AsyServiceImpl();\r\n\tasyServiceImpl.saveUsers(List);\r\n\r\nThe function in which I&#39;m calling async function is in different service and different package in the springboot project.\r\nThe declaration of my async function looks like:\r\n\r\n    @Async\r\n\tpublic void saveUsers(List&lt;SomeModel&gt; List) {\r\nThe problem is that I think my async function isn&#39;t being called because I&#39;m not getting the result from it.","title":"Is calling an Async function from another function like this in sprinboot okay?","body":"<p>I'm calling my async function from another function like this.</p>\n<pre><code>AsyServiceImpl asyServiceImpl = new AsyServiceImpl();\nasyServiceImpl.saveUsers(List);\n</code></pre>\n<p>The function in which I'm calling async function is in different service and different package in the springboot project.\nThe declaration of my async function looks like:</p>\n<pre><code>@Async\npublic void saveUsers(List&lt;SomeModel&gt; List) {\n</code></pre>\n<p>The problem is that I think my async function isn't being called because I'm not getting the result from it.</p>\n"},{"tags":["java","intervals","jdbctemplate","named-parameters","jdbcnamedparametertemplate"],"answers":[{"tags":[],"owner":{"account_id":13700855,"reputation":146,"user_id":9886050,"display_name":"Hemant H Kumar"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1645016278,"creation_date":1645016278,"answer_id":71142304,"question_id":68662129,"body_markdown":"The root cause of your issue is the fact that in Oracle SQL we can&#39;t bind a value to the interval parameter.\r\n\r\nInstead, you can take a look at the [NUMTODSINTERVAL][1] [NUMTOYMINTERVAL][2] methods. They can be leveraged for this.\r\n\r\nInterval specification you have in your code\r\n\r\n    DELETE FROM mood.message WHERE dt_log &lt;NOW() - INTERVAL &#39;:period&#39;;\r\n\r\nReplace with NUMTODSINTERVAL or NUMTOYMINTERVAL.\r\n\r\n    DELETE FROM mood.message WHERE dt_log &lt;NOW() - NUMTOYMINTERVAL(:period, &#39;MONTH&#39;);\r\n\r\n\r\n  [1]: https://docs.oracle.com/cd/B19306_01/server.102/b14200/functions103.htm\r\n  [2]: https://docs.oracle.com/cd/B19306_01/server.102/b14200/functions104.htm","title":"How to pass interval parameter into sql request using namedparameterjdbctemplate java","body":"<p>The root cause of your issue is the fact that in Oracle SQL we can't bind a value to the interval parameter.</p>\n<p>Instead, you can take a look at the <a href=\"https://docs.oracle.com/cd/B19306_01/server.102/b14200/functions103.htm\" rel=\"nofollow noreferrer\">NUMTODSINTERVAL</a> <a href=\"https://docs.oracle.com/cd/B19306_01/server.102/b14200/functions104.htm\" rel=\"nofollow noreferrer\">NUMTOYMINTERVAL</a> methods. They can be leveraged for this.</p>\n<p>Interval specification you have in your code</p>\n<pre><code>DELETE FROM mood.message WHERE dt_log &lt;NOW() - INTERVAL ':period';\n</code></pre>\n<p>Replace with NUMTODSINTERVAL or NUMTOYMINTERVAL.</p>\n<pre><code>DELETE FROM mood.message WHERE dt_log &lt;NOW() - NUMTOYMINTERVAL(:period, 'MONTH');\n</code></pre>\n"},{"tags":[],"owner":{"account_id":6120413,"reputation":174,"user_id":4774125,"display_name":"Alejandro"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656338433,"creation_date":1656338433,"answer_id":72773377,"question_id":68662129,"body_markdown":"I had the same issue. And this is working to me, where :month is the number of month\r\n\r\n```\r\n&quot;DELETE FROM mood.message WHERE dt_log &lt;NOW() - :month * &#39;1 month&#39;::interval;&quot;\r\n```","title":"How to pass interval parameter into sql request using namedparameterjdbctemplate java","body":"<p>I had the same issue. And this is working to me, where :month is the number of month</p>\n<pre><code>&quot;DELETE FROM mood.message WHERE dt_log &lt;NOW() - :month * '1 month'::interval;&quot;\n</code></pre>\n"}],"owner":{"account_id":19671292,"reputation":57,"user_id":14400487,"display_name":"Антон Павлецов"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":740,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":2,"score":1,"last_activity_date":1656338433,"creation_date":1628147663,"question_id":68662129,"body_markdown":"I am dealing with NamedParameterJdbcTemplate in java.\r\nI&#39;m trying through NamedParameterJdbcTemplate to pass the interval parameter (3 month) to the sql query DELETE FROM message WHERE dt_log &lt;NOW () - INTERVAL &#39;: period&#39;;\r\nI pass in DAO a period with type String for the interval parameter and put it in mapSqlParameterSource.addValue (&quot;period&quot;, period);\r\nWhen executing the request, it throws the following error: org.postgresql.util.PSQLException: ERROR: invalid input syntax for type interval: &#39;: period&#39;, although I am passing the correct value &quot;3 month&quot; (checked the whole request in pgAdmin).\r\nI tried to pass the PGInterval object to the parameter in the same way, but it gives the same error. But the request itself will work if you do not insert the parameter, but simply write the request itself with an interval: &#39;3 month&#39; by hand and it works if you insert a link to a static value with the String type in which &quot;3 month&quot; is specified in the sql request.\r\nThe DAO class code is given below.\r\n\r\n    private final String DELETE_OLD_ROWS = &quot;DELETE FROM mood.message WHERE dt_log &lt;NOW() - INTERVAL &#39;:period&#39;;&quot;;\r\n\r\n    @Override\r\n    public void delete_old_records(String period) {\r\n        MapSqlParameterSource mapSqlParameterSource = new MapSqlParameterSource();\r\n        mapSqlParameterSource.addValue(&quot;period&quot;, period);\r\n        this.getNamedParameterJdbcTemplate().update(this.DELETE_OLD_ROWS, mapSqlParameterSource);\r\n    }\r\n\r\nMaybe someone can tell me what I&#39;m doing wrong?)","title":"How to pass interval parameter into sql request using namedparameterjdbctemplate java","body":"<p>I am dealing with NamedParameterJdbcTemplate in java.\nI'm trying through NamedParameterJdbcTemplate to pass the interval parameter (3 month) to the sql query DELETE FROM message WHERE dt_log &lt;NOW () - INTERVAL ': period';\nI pass in DAO a period with type String for the interval parameter and put it in mapSqlParameterSource.addValue (&quot;period&quot;, period);\nWhen executing the request, it throws the following error: org.postgresql.util.PSQLException: ERROR: invalid input syntax for type interval: ': period', although I am passing the correct value &quot;3 month&quot; (checked the whole request in pgAdmin).\nI tried to pass the PGInterval object to the parameter in the same way, but it gives the same error. But the request itself will work if you do not insert the parameter, but simply write the request itself with an interval: '3 month' by hand and it works if you insert a link to a static value with the String type in which &quot;3 month&quot; is specified in the sql request.\nThe DAO class code is given below.</p>\n<pre><code>private final String DELETE_OLD_ROWS = &quot;DELETE FROM mood.message WHERE dt_log &lt;NOW() - INTERVAL ':period';&quot;;\n\n@Override\npublic void delete_old_records(String period) {\n    MapSqlParameterSource mapSqlParameterSource = new MapSqlParameterSource();\n    mapSqlParameterSource.addValue(&quot;period&quot;, period);\n    this.getNamedParameterJdbcTemplate().update(this.DELETE_OLD_ROWS, mapSqlParameterSource);\n}\n</code></pre>\n<p>Maybe someone can tell me what I'm doing wrong?)</p>\n"},{"tags":["java","hibernate","validation","bean-validation"],"comments":[{"owner":{"account_id":2734210,"reputation":6420,"user_id":2357233,"accept_rate":100,"display_name":"JamesENL"},"score":0,"creation_date":1400724909,"post_id":23794900,"comment_id":36602252,"body_markdown":"I&#39;d say that this a complex enough use case to require you to use a custom validator. Write your logic inside a validator, give it an annotation and do what you need to do.","body":"I&#39;d say that this a complex enough use case to require you to use a custom validator. Write your logic inside a validator, give it an annotation and do what you need to do."},{"owner":{"account_id":404979,"reputation":18340,"user_id":773616,"accept_rate":83,"display_name":"Gunnar"},"score":1,"creation_date":1400740839,"post_id":23794900,"comment_id":36607242,"body_markdown":"`@Valid` references are only followed when they are not null. Can you show your classes and describe where exactly the NPE is raised (stacktrace)?","body":"<code>@Valid</code> references are only followed when they are not null. Can you show your classes and describe where exactly the NPE is raised (stacktrace)?"},{"owner":{"account_id":173893,"reputation":3455,"user_id":402887,"accept_rate":84,"display_name":"Noremac"},"score":0,"creation_date":1400770814,"post_id":23794900,"comment_id":36627750,"body_markdown":"@Gunnar you are indeed correct. I did a simple test case and it worked as you said. It is now working in the more complex use case as well. Go ahead and write an answer so I can mark this mystery as solved.","body":"@Gunnar you are indeed correct. I did a simple test case and it worked as you said. It is now working in the more complex use case as well. Go ahead and write an answer so I can mark this mystery as solved."}],"answers":[{"tags":[],"owner":{"account_id":404979,"reputation":18340,"user_id":773616,"accept_rate":83,"display_name":"Gunnar"},"down_vote_count":0,"up_vote_count":12,"is_accepted":true,"score":12,"last_activity_date":1400795008,"creation_date":1400795008,"answer_id":23817558,"question_id":23794900,"body_markdown":"`@Valid` references are only followed when they are not null, so something else must be causing your NPE.","title":"Is it possible to validate an object field only if it is not null?","body":"<p><code>@Valid</code> references are only followed when they are not null, so something else must be causing your NPE.</p>\n"},{"tags":[],"owner":{"account_id":9792301,"reputation":25,"user_id":7256522,"display_name":"Tr4d"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656338270,"creation_date":1656333271,"answer_id":72772198,"question_id":23794900,"body_markdown":"`@Valid` references does not seem to be followed only if they are not null.\r\nIf I provide a custom validation annotation without checking for null, It throws a NPE. You need to check for null value yourself inside the validator.\r\n\r\nFor example: \r\n\r\n        public class EmailListValidator implements ConstraintValidator&lt;EmailListConstraint, String&gt; {\r\n    \r\n        @Override\r\n        public void initialize(final EmailListConstraint emailListConstraint) {\r\n        }\r\n    \r\n        @Override\r\n        public boolean isValid(final String emailList, final ConstraintValidatorContext cxt) {\r\n            if (emailList != null) {\r\n               // Validation logic here      \r\n            }\r\n            return true;\r\n        }\r\n    }\r\n\r\nHere is a link from baeldung website on how to implement a custom validation annotation : \r\nhttps://www.baeldung.com/spring-mvc-custom-validator","title":"Is it possible to validate an object field only if it is not null?","body":"<p><code>@Valid</code> references does not seem to be followed only if they are not null.\nIf I provide a custom validation annotation without checking for null, It throws a NPE. You need to check for null value yourself inside the validator.</p>\n<p>For example:</p>\n<pre><code>    public class EmailListValidator implements ConstraintValidator&lt;EmailListConstraint, String&gt; {\n\n    @Override\n    public void initialize(final EmailListConstraint emailListConstraint) {\n    }\n\n    @Override\n    public boolean isValid(final String emailList, final ConstraintValidatorContext cxt) {\n        if (emailList != null) {\n           // Validation logic here      \n        }\n        return true;\n    }\n}\n</code></pre>\n<p>Here is a link from baeldung website on how to implement a custom validation annotation :\n<a href=\"https://www.baeldung.com/spring-mvc-custom-validator\" rel=\"nofollow noreferrer\">https://www.baeldung.com/spring-mvc-custom-validator</a></p>\n"}],"owner":{"account_id":173893,"reputation":3455,"user_id":402887,"accept_rate":84,"display_name":"Noremac"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":14876,"favorite_count":0,"down_vote_count":0,"up_vote_count":6,"accepted_answer_id":23817558,"answer_count":2,"score":6,"last_activity_date":1656338270,"creation_date":1400711230,"question_id":23794900,"body_markdown":"There are two existing variants of this question:\r\n\r\n 1. https://stackoverflow.com/questions/19262979/validate-only-if-the-field-is-not-null : A solution to a conditionally handling a `String` field \r\n 2. https://stackoverflow.com/questions/17570314/hibernate-validation-only-validate-if-object-is-not-null : The only answer demonstrates the behavior and hints at how you could handle it when triggering the validation manually.\r\n\r\nMy question adds the qualifier of how can I do this when using @Valid on an object which may be null. \r\n\r\nThe use case here is that we have two fields where one or the other need to be not null (Custom validator on the class that contains the fields). When one is not null, I need it to be valid. Do I then need to fully and manually validate that object within my custom validator, adding more responsibility to it than it was intended for?\r\n\r\nUsing only annotations in this case causes a NullPointerException to be thrown, which breaks it out of validation before it could be handled. Is there not currently a way to do this?\r\n\r\n","title":"Is it possible to validate an object field only if it is not null?","body":"<p>There are two existing variants of this question:</p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/19262979/validate-only-if-the-field-is-not-null\">Validate only if the field is not Null</a> : A solution to a conditionally handling a <code>String</code> field </li>\n<li><a href=\"https://stackoverflow.com/questions/17570314/hibernate-validation-only-validate-if-object-is-not-null\">Hibernate validation - only validate if object is not null</a> : The only answer demonstrates the behavior and hints at how you could handle it when triggering the validation manually.</li>\n</ol>\n\n<p>My question adds the qualifier of how can I do this when using @Valid on an object which may be null. </p>\n\n<p>The use case here is that we have two fields where one or the other need to be not null (Custom validator on the class that contains the fields). When one is not null, I need it to be valid. Do I then need to fully and manually validate that object within my custom validator, adding more responsibility to it than it was intended for?</p>\n\n<p>Using only annotations in this case causes a NullPointerException to be thrown, which breaks it out of validation before it could be handled. Is there not currently a way to do this?</p>\n"},{"tags":["java","spring","apache-kafka","spring-kafka"],"answers":[{"tags":[],"owner":{"account_id":14655333,"reputation":600,"user_id":10584061,"display_name":"ChristDist"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1656323003,"creation_date":1656323003,"answer_id":72770008,"question_id":72769901,"body_markdown":"Can you check, whether you are scanning the basePackages correctly. Sometimes, you may end-up with this issue, if you not scanning the packages correctly, and I have experienced this many times in the Spring Boot application.\r\n\r\n    @ComponentScan(\r\n            basePackages = {\r\n                    &quot;x.x.x.x&quot;\r\n            }\r\n    )","title":"KafkaController required a bean of type &#39;org.springframework.kafka.requestreply.ReplyingKafkaTemplate&#39; that could not be found?","body":"<p>Can you check, whether you are scanning the basePackages correctly. Sometimes, you may end-up with this issue, if you not scanning the packages correctly, and I have experienced this many times in the Spring Boot application.</p>\n<pre><code>@ComponentScan(\n        basePackages = {\n                &quot;x.x.x.x&quot;\n        }\n)\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1288095,"reputation":169326,"user_id":1240763,"display_name":"Gary Russell"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1656338009,"creation_date":1656338009,"answer_id":72773280,"question_id":72769901,"body_markdown":"&gt;Do I really have to define beans? Seems unnecessary.\r\n\r\nYes, you have to declare a beans for the replying template (including the reply container); Spring Boot only auto configures a simple `KafkaTemplate`.","title":"KafkaController required a bean of type &#39;org.springframework.kafka.requestreply.ReplyingKafkaTemplate&#39; that could not be found?","body":"<blockquote>\n<p>Do I really have to define beans? Seems unnecessary.</p>\n</blockquote>\n<p>Yes, you have to declare a beans for the replying template (including the reply container); Spring Boot only auto configures a simple <code>KafkaTemplate</code>.</p>\n"}],"owner":{"account_id":1613370,"reputation":2348,"user_id":1491720,"accept_rate":80,"display_name":"Tony Stark"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":357,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":72773280,"answer_count":2,"score":1,"last_activity_date":1656338009,"creation_date":1656322431,"question_id":72769901,"body_markdown":"I am trying to use the `RepliyngKafkaTemplate` like I managed to use the `KafkaTemplate` in a REST controller.\r\n\r\n\r\n    @RestController\r\n    public class TestController {\r\n    \r\n        @Autowired\r\n        private ReplyingKafkaTemplate&lt;Object, KafkaExampleRecord, KafkaExampleRecord&gt; replyingTemplate;\r\n    \r\n        @PostMapping(&quot;/test/request&quot;)\r\n        public void requestReply(@RequestBody KafkaExampleRecord record) throws ExecutionException, InterruptedException, TimeoutException {\r\n            ProducerRecord&lt;Object, KafkaExampleRecord&gt; producerRecord = new ProducerRecord&lt;&gt;(&quot;mytopic&quot;, record);\r\n            RequestReplyFuture&lt;Object, KafkaExampleRecord, KafkaExampleRecord&gt; replyFuture = replyingTemplate.sendAndReceive(producerRecord);\r\n    \r\n            SendResult&lt;Object, KafkaExampleRecord&gt; sendResult = replyFuture.getSendFuture().get(10, TimeUnit.SECONDS);\r\n    \r\n            ConsumerRecord&lt;Object, KafkaExampleRecord&gt; consumerRecord = replyFuture.get(10, TimeUnit.SECONDS);\r\n        }\r\n    }\r\n\r\nHowever I am getting the following exception.\r\n\r\n    Field replyingTemplate in com.blah.KafkaController required a bean of type &#39;org.springframework.kafka.requestreply.ReplyingKafkaTemplate&#39; that could not be found.\r\n\r\nI enabled auto configuration like this.\r\n\r\n    @Configuration\r\n    @EnableKafka\r\n    public class KafkaConfig {\r\n    \r\n    }\r\n\r\nAll Kafka settings are in my `application.yml`.\r\n\r\nWhat else do I need? Do I really have to define beans? Seems unnecessary.\r\n\r\n","title":"KafkaController required a bean of type &#39;org.springframework.kafka.requestreply.ReplyingKafkaTemplate&#39; that could not be found?","body":"<p>I am trying to use the <code>RepliyngKafkaTemplate</code> like I managed to use the <code>KafkaTemplate</code> in a REST controller.</p>\n<pre><code>@RestController\npublic class TestController {\n\n    @Autowired\n    private ReplyingKafkaTemplate&lt;Object, KafkaExampleRecord, KafkaExampleRecord&gt; replyingTemplate;\n\n    @PostMapping(&quot;/test/request&quot;)\n    public void requestReply(@RequestBody KafkaExampleRecord record) throws ExecutionException, InterruptedException, TimeoutException {\n        ProducerRecord&lt;Object, KafkaExampleRecord&gt; producerRecord = new ProducerRecord&lt;&gt;(&quot;mytopic&quot;, record);\n        RequestReplyFuture&lt;Object, KafkaExampleRecord, KafkaExampleRecord&gt; replyFuture = replyingTemplate.sendAndReceive(producerRecord);\n\n        SendResult&lt;Object, KafkaExampleRecord&gt; sendResult = replyFuture.getSendFuture().get(10, TimeUnit.SECONDS);\n\n        ConsumerRecord&lt;Object, KafkaExampleRecord&gt; consumerRecord = replyFuture.get(10, TimeUnit.SECONDS);\n    }\n}\n</code></pre>\n<p>However I am getting the following exception.</p>\n<pre><code>Field replyingTemplate in com.blah.KafkaController required a bean of type 'org.springframework.kafka.requestreply.ReplyingKafkaTemplate' that could not be found.\n</code></pre>\n<p>I enabled auto configuration like this.</p>\n<pre><code>@Configuration\n@EnableKafka\npublic class KafkaConfig {\n\n}\n</code></pre>\n<p>All Kafka settings are in my <code>application.yml</code>.</p>\n<p>What else do I need? Do I really have to define beans? Seems unnecessary.</p>\n"},{"tags":["java","ssl","amazon-s3","truststore","cacerts"],"comments":[{"owner":{"account_id":2843847,"reputation":55833,"user_id":2442804,"accept_rate":80,"display_name":"luk2302"},"score":1,"creation_date":1656337979,"post_id":72773216,"comment_id":128540560,"body_markdown":"Yeah, the JVM does not know S3 and has no idea what to do with that url. Instead you should download the file first, store it somewhere locally and then set the property pointing to the local file. Alternatively not sure if that works let the application itself download the trust store and set its own system property after it downloaded and stored the file somewhere.","body":"Yeah, the JVM does not know S3 and has no idea what to do with that url. Instead you should download the file first, store it somewhere locally and then set the property pointing to the local file. Alternatively not sure if that works let the application itself download the trust store and set its own system property after it downloaded and stored the file somewhere."},{"owner":{"account_id":7729189,"reputation":11,"user_id":5852921,"display_name":"Gaurav Chhabra"},"score":0,"creation_date":1656338268,"post_id":72773216,"comment_id":128540684,"body_markdown":"Thanks for quick response. Even I was doubting that JVM can&#39;t refer external S3 bucket location. Problem of not using the trust store file within the application code is we have a lot of apps so we want to decouple the application code for TLS cert management","body":"Thanks for quick response. Even I was doubting that JVM can&#39;t refer external S3 bucket location. Problem of not using the trust store file within the application code is we have a lot of apps so we want to decouple the application code for TLS cert management"},{"owner":{"account_id":2095244,"reputation":566,"user_id":1864166,"accept_rate":75,"display_name":"Richard Duerr"},"score":0,"creation_date":1656363357,"post_id":72773216,"comment_id":128549437,"body_markdown":"Please provide enough code so others can better understand or reproduce the problem.","body":"Please provide enough code so others can better understand or reproduce the problem."},{"owner":{"account_id":7729189,"reputation":11,"user_id":5852921,"display_name":"Gaurav Chhabra"},"score":0,"creation_date":1656410913,"post_id":72773216,"comment_id":128559887,"body_markdown":"We are using AWS environment. There are 2 apps: app1 and app2. app1 invokes app2 over https protocol. We created a custom java trust store, imported the ,certificate of app2 in the trust store, placed the trust store in s3 bucket. In app1 docker file, we added JVM arguments to refer S3 trust store file which is not working. Adding the dockerfile content below:","body":"We are using AWS environment. There are 2 apps: app1 and app2. app1 invokes app2 over https protocol. We created a custom java trust store, imported the ,certificate of app2 in the trust store, placed the trust store in s3 bucket. In app1 docker file, we added JVM arguments to refer S3 trust store file which is not working. Adding the dockerfile content below:"},{"owner":{"account_id":7729189,"reputation":11,"user_id":5852921,"display_name":"Gaurav Chhabra"},"score":0,"creation_date":1656410989,"post_id":72773216,"comment_id":128559906,"body_markdown":"`FROM adoptopenjdk/openjdk11:alpine    \nRUN apk --no-cahce add aws-cli  \nARG AWS_KEY  \nARG AWS_SECRET_KEY  \nARG AWS_REGION=&#39;us-east-1&#39;  \n\nRUN aws configure set aws_access_key_id $AWS_KEY \\  \n&amp;&amp; aws configure set aws_secret_access_key $AWS_SECRET_KEY \\  \n&amp;&amp; aws configure set default.region $AWS_REGION  \n\nCOPY app.jar /usr/app/  \nWORKDIR /usr/app/  \nRUN sh -c &#39;touch app1.jar&#39;  \nENTRYPOINT [&quot;java&quot;,&quot;-Djavax.net.ssl.trustStore=&lt;s3_path_to_custom_trusstore&gt;&quot;,&quot;- \n Djavax.net.ssl.trsutStorePassword=changeit&quot;,&quot;-jar&quot;,&quot;app1.jar&quot;]`","body":"<code>FROM adoptopenjdk&#47;openjdk11:alpine     RUN apk --no-cahce add aws-cli   ARG AWS_KEY   ARG AWS_SECRET_KEY   ARG AWS_REGION=&#39;us-east-1&#39;    RUN aws configure set aws_access_key_id $AWS_KEY \\   &amp;&amp; aws configure set aws_secret_access_key $AWS_SECRET_KEY \\   &amp;&amp; aws configure set default.region $AWS_REGION    COPY app.jar &#47;usr&#47;app&#47;   WORKDIR &#47;usr&#47;app&#47;   RUN sh -c &#39;touch app1.jar&#39;   ENTRYPOINT [&quot;java&quot;,&quot;-Djavax.net.ssl.trustStore=&lt;s3_path_to_custom_truss&zwnj;&#8203;tore&gt;&quot;,&quot;-   Djavax.net.ssl.trsutStorePassword=changeit&quot;,&quot;-jar&quot;,&quot;app1.jar&zwnj;&#8203;&quot;]</code>"}],"owner":{"account_id":7729189,"reputation":11,"user_id":5852921,"display_name":"Gaurav Chhabra"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":573,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1656337820,"creation_date":1656337741,"question_id":72773216,"body_markdown":"We have a requirement to store custom Java trust store file in S3 bucket and have various applications refer that common trust store by using JVM argument-Djavax.net.ssl.trustStore\r\n\r\nGiving S3 bucket location is not working for us\r\n \r\n**Djavax.net.ssl.trustStore=\\&lt;s3 bucket location for Java trust store path\\&gt;**\r\n\r\nAll the apps are containerized and we have set above JVM parameters in docker file.","title":"Using java truststore from s3 bucket","body":"<p>We have a requirement to store custom Java trust store file in S3 bucket and have various applications refer that common trust store by using JVM argument-Djavax.net.ssl.trustStore</p>\n<p>Giving S3 bucket location is not working for us</p>\n<p><strong>Djavax.net.ssl.trustStore=&lt;s3 bucket location for Java trust store path&gt;</strong></p>\n<p>All the apps are containerized and we have set above JVM parameters in docker file.</p>\n"},{"tags":["java","json","spring","rest","web-services"],"answers":[{"tags":[],"owner":{"account_id":13022813,"reputation":722,"user_id":9411636,"display_name":"Kaneda"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656337792,"creation_date":1656337792,"answer_id":72773227,"question_id":72771565,"body_markdown":"Based on what I see from your log, your response object starts with an &quot;[{...&quot; so probably your server side is returning an list of RetornoServicoDto, not a single object that what you are asking the request for, since your problem is a bad request, would be great to see the service side that process the request to understand better.","title":"HttpClientErrorException$BadRequest: 400 BAD REQUEST when service return []","body":"<p>Based on what I see from your log, your response object starts with an &quot;[{...&quot; so probably your server side is returning an list of RetornoServicoDto, not a single object that what you are asking the request for, since your problem is a bad request, would be great to see the service side that process the request to understand better.</p>\n"}],"owner":{"account_id":20682998,"reputation":11,"user_id":15186117,"display_name":"Graziele Sabino Gon&#231;alves"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":604,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1656337792,"creation_date":1656330393,"question_id":72771565,"body_markdown":"I&#39;m running a service and it works perfectly when it returns some entidade. But when it doesn&#39;t find any, I get the following error:\r\n\r\norg.springframework.web.client.HttpClientErrorException$BadRequest: 400 BAD REQUEST: [{\r\n  ***&quot;entidades&quot;: []***, \r\n  &quot;saida&quot;: &quot;\\&quot; rua bandeirantes, 1578 - bairro: cent... (19970 bytes)]\r\n\tat org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:101)\r\n\tat org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:186)\r\n\tat org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:125)\r\n\tat org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63)\r\n\tat org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:818)\r\n\tat org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)\r\n\tat org.springframework.web.client.RestTemplate.execute(RestTemplate.java:710)\r\n\tat org.springframework.web.client.RestTemplate.postForEntity(RestTemplate.java:467)\r\n\tat br.mp.mpf.cened01.cargaIaRJ.RJServico.executarServico(RJServico.java:953)\r\n\tat br.mp.mpf.cened01.cargaIaRJ.RJServico.executarServicoByPagina(RJServico.java:857)\r\n\tat br.mp.mpf.cened01.cargaIaRJ.RJServico.executarComPaginacao(RJServico.java:752)\r\n\tat br.mp.mpf.cened01.cargaIaRJ.RJApplication.lambda$0(RJApplication.java:52)\r\n\tat org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:804)\r\n\tat org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:788)\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:333)\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1311)\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1300)\r\n\tat br.mp.mpf.cened01.cargaIaRJ.RJApplication.main(RJApplication.java:29)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49)\r\n\r\n\r\n```\r\n\tprivate RetornoServicoDto executarServico(String sentenca) \r\n\t\t\tthrows Exception {\r\n\t\tRetornoServicoDto retornoServico = new RetornoServicoDto();\r\n\r\n\t\tfinal String sentencaOri = sentenca;\r\n\t\tRestTemplate restTemplate = new RestTemplate();\r\n\t   final Iterator&lt;HttpMessageConverter&lt;?&gt;&gt; iterator = restTemplate.getMessageConverters().iterator();\r\n\t   while (iterator.hasNext()) {\r\n\t   \tfinal HttpMessageConverter&lt;?&gt; converter = iterator.next();\r\n\t      if (converter instanceof StringHttpMessageConverter) {\r\n\t      \titerator.remove();\r\n\t      }\t      \r\n\t   }\r\n\t   restTemplate.getMessageConverters().add(0, new StringHttpMessageConverter(Charset.forName(&quot;UTF-8&quot;)));\r\n\r\n\t\ttry {\t      \r\n\t\t\tResponseEntity&lt;RetornoServicoDto&gt; responseEntity = \r\n\t\t\t\t\trestTemplate.postForEntity(Constantes.SERVICO_URL,\r\n\t\t\t\t\t\t\tsentencaOri, RetornoServicoDto.class);\r\n\r\n\t\t\tretornoServico = responseEntity.getBody();\r\n\t\t\t\r\n\t\t} catch (Exception e) {\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\r\n\t\treturn retornoServico;\r\n\t}  \r\n\r\n@Data\r\npublic class RetornoServicoDto {    \r\n\tprivate List&lt;EntidadeDto&gt; entidades; \r\n\tprivate String saida;\r\n\tprivate String status;  \r\n} \r\n\r\n@Data\r\npublic class EntidadeDto {\r\n\tprivate String entidade;\r\n\tprivate int id;\r\n\tprivate PosicaoDto posicao;\r\n\tprivate String texto;\r\n} \r\n```\r\nWhat to do to work even when the entities list returns []?\r\n\r\n","title":"HttpClientErrorException$BadRequest: 400 BAD REQUEST when service return []","body":"<p>I'm running a service and it works perfectly when it returns some entidade. But when it doesn't find any, I get the following error:</p>\n<p>org.springframework.web.client.HttpClientErrorException$BadRequest: 400 BAD REQUEST: [{\n<em><strong>&quot;entidades&quot;: []</strong></em>,\n&quot;saida&quot;: &quot;&quot; rua bandeirantes, 1578 - bairro: cent... (19970 bytes)]\nat org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:101)\nat org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:186)\nat org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:125)\nat org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63)\nat org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:818)\nat org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)\nat org.springframework.web.client.RestTemplate.execute(RestTemplate.java:710)\nat org.springframework.web.client.RestTemplate.postForEntity(RestTemplate.java:467)\nat br.mp.mpf.cened01.cargaIaRJ.RJServico.executarServico(RJServico.java:953)\nat br.mp.mpf.cened01.cargaIaRJ.RJServico.executarServicoByPagina(RJServico.java:857)\nat br.mp.mpf.cened01.cargaIaRJ.RJServico.executarComPaginacao(RJServico.java:752)\nat br.mp.mpf.cened01.cargaIaRJ.RJApplication.lambda$0(RJApplication.java:52)\nat org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:804)\nat org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:788)\nat org.springframework.boot.SpringApplication.run(SpringApplication.java:333)\nat org.springframework.boot.SpringApplication.run(SpringApplication.java:1311)\nat org.springframework.boot.SpringApplication.run(SpringApplication.java:1300)\nat br.mp.mpf.cened01.cargaIaRJ.RJApplication.main(RJApplication.java:29)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:498)\nat org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49)</p>\n<pre><code>    private RetornoServicoDto executarServico(String sentenca) \n            throws Exception {\n        RetornoServicoDto retornoServico = new RetornoServicoDto();\n\n        final String sentencaOri = sentenca;\n        RestTemplate restTemplate = new RestTemplate();\n       final Iterator&lt;HttpMessageConverter&lt;?&gt;&gt; iterator = restTemplate.getMessageConverters().iterator();\n       while (iterator.hasNext()) {\n        final HttpMessageConverter&lt;?&gt; converter = iterator.next();\n          if (converter instanceof StringHttpMessageConverter) {\n            iterator.remove();\n          }       \n       }\n       restTemplate.getMessageConverters().add(0, new StringHttpMessageConverter(Charset.forName(&quot;UTF-8&quot;)));\n\n        try {         \n            ResponseEntity&lt;RetornoServicoDto&gt; responseEntity = \n                    restTemplate.postForEntity(Constantes.SERVICO_URL,\n                            sentencaOri, RetornoServicoDto.class);\n\n            retornoServico = responseEntity.getBody();\n            \n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n\n        return retornoServico;\n    }  \n\n@Data\npublic class RetornoServicoDto {    \n    private List&lt;EntidadeDto&gt; entidades; \n    private String saida;\n    private String status;  \n} \n\n@Data\npublic class EntidadeDto {\n    private String entidade;\n    private int id;\n    private PosicaoDto posicao;\n    private String texto;\n} \n</code></pre>\n<p>What to do to work even when the entities list returns []?</p>\n"},{"tags":["java","android","kotlin"],"comments":[{"owner":{"account_id":263656,"reputation":1,"user_id":549372,"accept_rate":100,"display_name":"Martin Zeitler"},"score":1,"creation_date":1656338559,"post_id":72772909,"comment_id":128540792,"body_markdown":"This demand ignores the layout hierarchy. One can&#39;t just replace the parent of a child node. You could only have one parent, which has two different appearances, depending which child node it shows.","body":"This demand ignores the layout hierarchy. One can&#39;t just replace the parent of a child node. You could only have one parent, which has two different appearances, depending which child node it shows."}],"answers":[{"tags":[],"owner":{"account_id":19615181,"reputation":732,"user_id":15394019,"display_name":"mindoverflow"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656337703,"creation_date":1656337703,"answer_id":72773204,"question_id":72772909,"body_markdown":"if i was in this situation, i would modify my design such that x falls outside of a and b. this is because it would be more efficient. because every time you switch the fragments, lets say from a to b, a enters ```paused``` state and b enters ```resumed``` state. change of state would need component to act on their widgets which would consume processing power. if x was outside, then no processing is required because it&#39;s not re-rendered. if you still want to implement things this way, then make the ```data``` persistent, not the entire ```fragment```. when a fragment is rendered on screen, it&#39;s children must also be rendered. there is no other option. you cannot just render a block on screen but expect some of its children to already be rendered on screen before parent has rendered. this is why you&#39;ll see ```onCreate``` passes a ```Bundle``` param. the param contains all data that required retention and that&#39;s why things are able to be rendered the same. it&#39;s a good idea to separate __data__ from __architecture__. hope this helps.","title":"Create one fragment and reuse it","body":"<p>if i was in this situation, i would modify my design such that x falls outside of a and b. this is because it would be more efficient. because every time you switch the fragments, lets say from a to b, a enters <code>paused</code> state and b enters <code>resumed</code> state. change of state would need component to act on their widgets which would consume processing power. if x was outside, then no processing is required because it's not re-rendered. if you still want to implement things this way, then make the <code>data</code> persistent, not the entire <code>fragment</code>. when a fragment is rendered on screen, it's children must also be rendered. there is no other option. you cannot just render a block on screen but expect some of its children to already be rendered on screen before parent has rendered. this is why you'll see <code>onCreate</code> passes a <code>Bundle</code> param. the param contains all data that required retention and that's why things are able to be rendered the same. it's a good idea to separate <strong>data</strong> from <strong>architecture</strong>. hope this helps.</p>\n"}],"owner":{"account_id":23958830,"reputation":59,"user_id":17949254,"display_name":"Viacheslav Kolisnichenko"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":50,"favorite_count":0,"down_vote_count":2,"up_vote_count":0,"answer_count":1,"score":-2,"last_activity_date":1656337703,"creation_date":1656336425,"question_id":72772909,"body_markdown":"I have 2 fragments a and b in which there is a container for fragments, I need to place a separate fragment x in these 2 containers so that the nested fragment x is not recreated when switching between fragments a and b, create a singleton from fragment x. Please tell me how can i implement this ","title":"Create one fragment and reuse it","body":"<p>I have 2 fragments a and b in which there is a container for fragments, I need to place a separate fragment x in these 2 containers so that the nested fragment x is not recreated when switching between fragments a and b, create a singleton from fragment x. Please tell me how can i implement this</p>\n"},{"tags":["java","android","android-studio","kotlin"],"answers":[{"tags":[],"owner":{"account_id":263656,"reputation":1,"user_id":549372,"accept_rate":100,"display_name":"Martin Zeitler"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656337619,"creation_date":1656337619,"answer_id":72773177,"question_id":72772967,"body_markdown":"&quot;it didn&#39;t work like I wanted&quot; is not a valid error description, but a mere complaint.&lt;br/&gt;\r\nJust move the `.git` directory into your Android project, then pull, commit and push.&lt;br/&gt;\r\nHowever, creating a new Android project in the repo directory should be the same.","title":"Get Android Dependencies to an Empty Project","body":"<p>&quot;it didn't work like I wanted&quot; is not a valid error description, but a mere complaint.<br/>\nJust move the <code>.git</code> directory into your Android project, then pull, commit and push.<br/>\nHowever, creating a new Android project in the repo directory should be the same.</p>\n"}],"owner":{"account_id":12538756,"reputation":968,"user_id":9124515,"display_name":"Ibramazin"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":49,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1656337619,"creation_date":1656336650,"question_id":72772967,"body_markdown":"I have cloned a github repo. (Which only has a README)\r\n\r\nI want to get android dependencies into that repository. (The whole android files and structures that comes with creating a new project from the Android Studio Wizard).\r\n\r\nIs this possible.?\r\n\r\nI need to build an app from that repo (make commits and push to the repo)\r\n\r\nI have tried to create a new seperate project from Android Studio Wizard and copy the files into the cloned repo directory, but it didn&#39;t work like I wanted.\r\n\r\nIs there an option to maybe &#39;Create an Android Project inside a project&quot; :)","title":"Get Android Dependencies to an Empty Project","body":"<p>I have cloned a github repo. (Which only has a README)</p>\n<p>I want to get android dependencies into that repository. (The whole android files and structures that comes with creating a new project from the Android Studio Wizard).</p>\n<p>Is this possible.?</p>\n<p>I need to build an app from that repo (make commits and push to the repo)</p>\n<p>I have tried to create a new seperate project from Android Studio Wizard and copy the files into the cloned repo directory, but it didn't work like I wanted.</p>\n<p>Is there an option to maybe 'Create an Android Project inside a project&quot; :)</p>\n"},{"tags":["java","multithreading","benchmarking","jmh"],"comments":[{"owner":{"account_id":213468,"reputation":103488,"user_id":466862,"display_name":"Mark Rotteveel"},"score":8,"creation_date":1655894840,"post_id":72714082,"comment_id":128438706,"body_markdown":"I would guess this has more to do with the granularity of the OS timer combined with thread scheduling by the OS than anything else.","body":"I would guess this has more to do with the granularity of the OS timer combined with thread scheduling by the OS than anything else."},{"owner":{"account_id":78868,"reputation":336965,"user_id":224132,"accept_rate":83,"display_name":"Peter Cordes"},"score":3,"creation_date":1655896144,"post_id":72714082,"comment_id":128439171,"body_markdown":"Is there any real-world problem you&#39;re trying to approximate with this?  Putting `Thread.sleep(1)` in a repeat loop with no other work is a terrible way to make a delay function.  If you want to know what real-world implementation details led to these results, you should specify what OS and hardware you&#39;re running on.  (And your OS configuration.  e.g. for Linux, [How to check HZ in the terminal?](//stackoverflow.com/q/12480486) to check on scheduler timeslice, or if it&#39;s a &quot;tickless&quot; kernel, and also relevant if built with real-time kernel patches to make short sleeps like this more accurate)","body":"Is there any real-world problem you&#39;re trying to approximate with this?  Putting <code>Thread.sleep(1)</code> in a repeat loop with no other work is a terrible way to make a delay function.  If you want to know what real-world implementation details led to these results, you should specify what OS and hardware you&#39;re running on.  (And your OS configuration.  e.g. for Linux, <a href=\"//stackoverflow.com/q/12480486\">How to check HZ in the terminal?</a> to check on scheduler timeslice, or if it&#39;s a &quot;tickless&quot; kernel, and also relevant if built with real-time kernel patches to make short sleeps like this more accurate)"},{"owner":{"account_id":114128,"reputation":50422,"user_id":300257,"accept_rate":89,"display_name":"Gilbert Le Blanc"},"score":4,"creation_date":1655896148,"post_id":72714082,"comment_id":128439173,"body_markdown":"It&#39;s been my experience that a sleep duration of fewer than 5 milliseconds is unreliable.","body":"It&#39;s been my experience that a sleep duration of fewer than 5 milliseconds is unreliable."},{"owner":{"account_id":17228781,"reputation":3548,"user_id":12473843,"display_name":"Sergey Tsypanov"},"score":0,"creation_date":1655896852,"post_id":72714082,"comment_id":128439443,"body_markdown":"@PeterCordes this is run on MacOS and Intel Core i7, though I think in this case we shouldn&#39;t dive into OS/hardware details. The code is quite simple and high-level, so I would expect it to behave +- in the same way on all platforms.","body":"@PeterCordes this is run on MacOS and Intel Core i7, though I think in this case we shouldn&#39;t dive into OS/hardware details. The code is quite simple and high-level, so I would expect it to behave +- in the same way on all platforms."},{"owner":{"account_id":78868,"reputation":336965,"user_id":224132,"accept_rate":83,"display_name":"Peter Cordes"},"score":4,"creation_date":1655896981,"post_id":72714082,"comment_id":128439507,"body_markdown":"That is a highly unreasonable expectation.  A Java `sleep` should give control of that CPU core back to the OS, not use a delay loop to waste CPU time for a millisecond, so OS task scheduling details are extremely relevant, and probably most of the answer to your question.  Timing details of OS sleep services for sleeps shorter than scheduling granularity, and CPU power management to govern wake-up latency, are going to be platform-specific, not something any given JVM can really control for.","body":"That is a highly unreasonable expectation.  A Java <code>sleep</code> should give control of that CPU core back to the OS, not use a delay loop to waste CPU time for a millisecond, so OS task scheduling details are extremely relevant, and probably most of the answer to your question.  Timing details of OS sleep services for sleeps shorter than scheduling granularity, and CPU power management to govern wake-up latency, are going to be platform-specific, not something any given JVM can really control for."},{"owner":{"account_id":17228781,"reputation":3548,"user_id":12473843,"display_name":"Sergey Tsypanov"},"score":0,"creation_date":1655898383,"post_id":72714082,"comment_id":128440005,"body_markdown":"@PeterCordes thanks for explanation, at home I&#39;ll run this on Linux and update the question.","body":"@PeterCordes thanks for explanation, at home I&#39;ll run this on Linux and update the question."},{"owner":{"account_id":17228781,"reputation":3548,"user_id":12473843,"display_name":"Sergey Tsypanov"},"score":0,"creation_date":1655967506,"post_id":72714082,"comment_id":128458375,"body_markdown":"@PeterCordes I&#39;ve updated the question, for Linux the difference is less significant yet still present.","body":"@PeterCordes I&#39;ve updated the question, for Linux the difference is less significant yet still present."}],"answers":[{"tags":[],"owner":{"account_id":292208,"reputation":10665,"user_id":2245707,"accept_rate":17,"display_name":"pveentjer"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1656337451,"creation_date":1656336604,"answer_id":72772956,"question_id":72714082,"body_markdown":"If you want more control on pausing a Java thread, have a look at LockSupport.parkNanos. Under Linux by default, you can get 50 us resolution. For more info and how to tune it, see https://hazelcast.com/blog/locksupport-parknanos-under-the-hood-and-the-curious-case-of-parking/\r\n\r\n","title":"Costs of Thread.sleep(1) are different depending on busy-loop implementation","body":"<p>If you want more control on pausing a Java thread, have a look at LockSupport.parkNanos. Under Linux by default, you can get 50 us resolution. For more info and how to tune it, see <a href=\"https://hazelcast.com/blog/locksupport-parknanos-under-the-hood-and-the-curious-case-of-parking/\" rel=\"nofollow noreferrer\">https://hazelcast.com/blog/locksupport-parknanos-under-the-hood-and-the-curious-case-of-parking/</a></p>\n"}],"owner":{"account_id":17228781,"reputation":3548,"user_id":12473843,"display_name":"Sergey Tsypanov"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":228,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1656337451,"creation_date":1655894697,"question_id":72714082,"body_markdown":"Suppose we execute `Thread.sleep(1)` within a loop iterating `n` times (here and below it&#39;s Java 11):\r\n```java\r\n@State(Scope.Thread)\r\n@BenchmarkMode(Mode.AverageTime)\r\n@OutputTimeUnit(TimeUnit.MILLISECONDS)\r\n@Fork(jvmArgsAppend = {&quot;-Xms1g&quot;, &quot;-Xmx1g&quot;})\r\npublic class ThreadSleep1Benchmark {\r\n  @Param({&quot;5&quot;, &quot;10&quot;, &quot;50&quot;})\r\n  long delay;\r\n\r\n  @Benchmark\r\n  public int sleep() throws Exception {\r\n    for (int i = 0; i &lt; delay; i++) {\r\n      Thread.sleep(1);\r\n    }\r\n    return hashCode();\r\n  }\r\n}\r\n```\r\nThis benchmark demonstrates the following results:\r\n```\r\nBenchmark                    (delay)  Mode  Cnt   Score   Error  Units\r\nThreadSleep1Benchmark.sleep        5  avgt   50   6,552 &#177; 0,071  ms/op\r\nThreadSleep1Benchmark.sleep       10  avgt   50  13,343 &#177; 0,227  ms/op\r\nThreadSleep1Benchmark.sleep       50  avgt   50  68,059 &#177; 1,441  ms/op\r\n```\r\nHere we see that method `sleep()` takes more than `n` milliseconds while intuitively we would expect it to be `~n` as at each iteration current thread sleeps for 1 ms. This example demonstrates the costs of putting thread asleep and awakening it.\r\n\r\nLet&#39;s now modify the benchmark:\r\n```java\r\n@State(Scope.Thread)\r\n@BenchmarkMode(Mode.AverageTime)\r\n@OutputTimeUnit(TimeUnit.MILLISECONDS)\r\n@Fork(jvmArgsAppend = {&quot;-Xms1g&quot;, &quot;-Xmx1g&quot;})\r\npublic class ThreadSleep2Benchmark {\r\n  private final ExecutorService executor = Executors.newFixedThreadPool(1);\r\n  volatile boolean flag;\r\n\r\n  @Param({&quot;5&quot;, &quot;10&quot;, &quot;50&quot;})\r\n  long delay;\r\n\r\n  @Setup(Level.Invocation)\r\n  public void setUp() {\r\n    flag = true;\r\n    startThread();\r\n  }\r\n\r\n  @TearDown(Level.Trial)\r\n  public void tearDown() {\r\n    executor.shutdown();\r\n  }\r\n\r\n  @Benchmark\r\n  public int sleep() throws Exception {\r\n    while (flag) {\r\n      Thread.sleep(1);\r\n    }\r\n    return hashCode();\r\n  }\r\n\r\n  private void startThread() {\r\n    executor.submit(() -&gt; {\r\n      try {\r\n        Thread.sleep(delay);\r\n        flag = false;\r\n      } catch (InterruptedException e) {\r\n        Thread.currentThread().interrupt();\r\n        throw new RuntimeException(e);\r\n      }\r\n    });\r\n  }\r\n}\r\n```\r\nHere we run a background thread that waits for `n` milliseconds and puts the flag down while the `sleep()` method iterates over `while(flag)` loop. As soon as the flag is put down after delay of `n` milliseconds we expect `while` loop iterate approximately `n` times.\r\n\r\nAnd again we see costs of `Thread.sleep(1)` but they appear to be almost same for `delay` of 5 and 10 significantly lower for the case when `delay` is 50. Pay attention, that the difference here is not linear: it is ~0,1 ms for 5, ~1,2 ms for 10 and ~13 ms for 50.\r\n\r\n```\r\nBenchmark                    (delay)  Mode  Cnt   Score   Error  Units\r\nThreadSleep2Benchmark.sleep        5  avgt   50   6,760 &#177; 0,070  ms/op\r\nThreadSleep2Benchmark.sleep       10  avgt   50  12,496 &#177; 0,050  ms/op\r\nThreadSleep2Benchmark.sleep       50  avgt   50  54,727 &#177; 0,599  ms/op\r\n```\r\n\r\nOn Java 18 results are similar:\r\n```\r\nBenchmark                    (delay)  Mode  Cnt   Score   Error  Units\r\nThreadSleep1Benchmark.sleep        5  avgt   50   6,609 &#177; 0,105  ms/op\r\nThreadSleep1Benchmark.sleep       10  avgt   50  13,233 &#177; 0,148  ms/op\r\nThreadSleep1Benchmark.sleep       50  avgt   50  66,017 &#177; 0,714  ms/op\r\n\r\nThreadSleep2Benchmark.sleep        5  avgt   50   6,740 &#177; 0,067  ms/op\r\nThreadSleep2Benchmark.sleep       10  avgt   50  12,400 &#177; 0,112  ms/op\r\nThreadSleep2Benchmark.sleep       50  avgt   50  53,836 &#177; 0,250  ms/op\r\n```\r\n\r\nSo my question is: whether the effect of costs reduction in `ThreadSleep2Benchmark` is compiler&#39;s achievement (loop unrolling etc.) or is it about how I iterate over the loops?\r\n\r\n**UPD**\r\n\r\nFor Linux I&#39;ve got the following results:\r\n```\r\nJava 11\r\n\r\nLinux\r\n\r\nBenchmark                    (delay)  Mode  Cnt   Score   Error  Units\r\nThreadSleep1Benchmark.sleep        5  avgt   50   5.597 &#177; 0.038  ms/op\r\nThreadSleep1Benchmark.sleep       10  avgt   50  11.263 &#177; 0.069  ms/op\r\nThreadSleep1Benchmark.sleep       50  avgt   50  56.079 &#177; 0.267  ms/op\r\n\r\nBenchmark                    (delay)  Mode  Cnt   Score   Error  Units\r\nThreadSleep2Benchmark.sleep        5  avgt   50   5.600 &#177; 0.032  ms/op\r\nThreadSleep2Benchmark.sleep       10  avgt   50  10.558 &#177; 0.052  ms/op\r\nThreadSleep2Benchmark.sleep       50  avgt   50  50.625 &#177; 0.049  ms/op\r\n\r\nJava 18\r\n\r\nBenchmark                    (delay)  Mode  Cnt   Score   Error  Units\r\nThreadSleep1Benchmark.sleep        5  avgt   50   5.581 &#177; 0.041  ms/op\r\nThreadSleep1Benchmark.sleep       10  avgt   50  11.069 &#177; 0.067  ms/op\r\nThreadSleep1Benchmark.sleep       50  avgt   50  55.719 &#177; 0.602  ms/op\r\n\r\nBenchmark                    (delay)  Mode  Cnt   Score   Error  Units\r\nThreadSleep2Benchmark.sleep        5  avgt   50   5.574 &#177; 0.035  ms/op\r\nThreadSleep2Benchmark.sleep       10  avgt   50  10.918 &#177; 0.035  ms/op\r\nThreadSleep2Benchmark.sleep       50  avgt   50  50.823 &#177; 0.055  ms/op","title":"Costs of Thread.sleep(1) are different depending on busy-loop implementation","body":"<p>Suppose we execute <code>Thread.sleep(1)</code> within a loop iterating <code>n</code> times (here and below it's Java 11):</p>\n<pre class=\"lang-java prettyprint-override\"><code>@State(Scope.Thread)\n@BenchmarkMode(Mode.AverageTime)\n@OutputTimeUnit(TimeUnit.MILLISECONDS)\n@Fork(jvmArgsAppend = {&quot;-Xms1g&quot;, &quot;-Xmx1g&quot;})\npublic class ThreadSleep1Benchmark {\n  @Param({&quot;5&quot;, &quot;10&quot;, &quot;50&quot;})\n  long delay;\n\n  @Benchmark\n  public int sleep() throws Exception {\n    for (int i = 0; i &lt; delay; i++) {\n      Thread.sleep(1);\n    }\n    return hashCode();\n  }\n}\n</code></pre>\n<p>This benchmark demonstrates the following results:</p>\n<pre><code>Benchmark                    (delay)  Mode  Cnt   Score   Error  Units\nThreadSleep1Benchmark.sleep        5  avgt   50   6,552 ± 0,071  ms/op\nThreadSleep1Benchmark.sleep       10  avgt   50  13,343 ± 0,227  ms/op\nThreadSleep1Benchmark.sleep       50  avgt   50  68,059 ± 1,441  ms/op\n</code></pre>\n<p>Here we see that method <code>sleep()</code> takes more than <code>n</code> milliseconds while intuitively we would expect it to be <code>~n</code> as at each iteration current thread sleeps for 1 ms. This example demonstrates the costs of putting thread asleep and awakening it.</p>\n<p>Let's now modify the benchmark:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@State(Scope.Thread)\n@BenchmarkMode(Mode.AverageTime)\n@OutputTimeUnit(TimeUnit.MILLISECONDS)\n@Fork(jvmArgsAppend = {&quot;-Xms1g&quot;, &quot;-Xmx1g&quot;})\npublic class ThreadSleep2Benchmark {\n  private final ExecutorService executor = Executors.newFixedThreadPool(1);\n  volatile boolean flag;\n\n  @Param({&quot;5&quot;, &quot;10&quot;, &quot;50&quot;})\n  long delay;\n\n  @Setup(Level.Invocation)\n  public void setUp() {\n    flag = true;\n    startThread();\n  }\n\n  @TearDown(Level.Trial)\n  public void tearDown() {\n    executor.shutdown();\n  }\n\n  @Benchmark\n  public int sleep() throws Exception {\n    while (flag) {\n      Thread.sleep(1);\n    }\n    return hashCode();\n  }\n\n  private void startThread() {\n    executor.submit(() -&gt; {\n      try {\n        Thread.sleep(delay);\n        flag = false;\n      } catch (InterruptedException e) {\n        Thread.currentThread().interrupt();\n        throw new RuntimeException(e);\n      }\n    });\n  }\n}\n</code></pre>\n<p>Here we run a background thread that waits for <code>n</code> milliseconds and puts the flag down while the <code>sleep()</code> method iterates over <code>while(flag)</code> loop. As soon as the flag is put down after delay of <code>n</code> milliseconds we expect <code>while</code> loop iterate approximately <code>n</code> times.</p>\n<p>And again we see costs of <code>Thread.sleep(1)</code> but they appear to be almost same for <code>delay</code> of 5 and 10 significantly lower for the case when <code>delay</code> is 50. Pay attention, that the difference here is not linear: it is ~0,1 ms for 5, ~1,2 ms for 10 and ~13 ms for 50.</p>\n<pre><code>Benchmark                    (delay)  Mode  Cnt   Score   Error  Units\nThreadSleep2Benchmark.sleep        5  avgt   50   6,760 ± 0,070  ms/op\nThreadSleep2Benchmark.sleep       10  avgt   50  12,496 ± 0,050  ms/op\nThreadSleep2Benchmark.sleep       50  avgt   50  54,727 ± 0,599  ms/op\n</code></pre>\n<p>On Java 18 results are similar:</p>\n<pre><code>Benchmark                    (delay)  Mode  Cnt   Score   Error  Units\nThreadSleep1Benchmark.sleep        5  avgt   50   6,609 ± 0,105  ms/op\nThreadSleep1Benchmark.sleep       10  avgt   50  13,233 ± 0,148  ms/op\nThreadSleep1Benchmark.sleep       50  avgt   50  66,017 ± 0,714  ms/op\n\nThreadSleep2Benchmark.sleep        5  avgt   50   6,740 ± 0,067  ms/op\nThreadSleep2Benchmark.sleep       10  avgt   50  12,400 ± 0,112  ms/op\nThreadSleep2Benchmark.sleep       50  avgt   50  53,836 ± 0,250  ms/op\n</code></pre>\n<p>So my question is: whether the effect of costs reduction in <code>ThreadSleep2Benchmark</code> is compiler's achievement (loop unrolling etc.) or is it about how I iterate over the loops?</p>\n<p><strong>UPD</strong></p>\n<p>For Linux I've got the following results:</p>\n<pre><code>Java 11\n\nLinux\n\nBenchmark                    (delay)  Mode  Cnt   Score   Error  Units\nThreadSleep1Benchmark.sleep        5  avgt   50   5.597 ± 0.038  ms/op\nThreadSleep1Benchmark.sleep       10  avgt   50  11.263 ± 0.069  ms/op\nThreadSleep1Benchmark.sleep       50  avgt   50  56.079 ± 0.267  ms/op\n\nBenchmark                    (delay)  Mode  Cnt   Score   Error  Units\nThreadSleep2Benchmark.sleep        5  avgt   50   5.600 ± 0.032  ms/op\nThreadSleep2Benchmark.sleep       10  avgt   50  10.558 ± 0.052  ms/op\nThreadSleep2Benchmark.sleep       50  avgt   50  50.625 ± 0.049  ms/op\n\nJava 18\n\nBenchmark                    (delay)  Mode  Cnt   Score   Error  Units\nThreadSleep1Benchmark.sleep        5  avgt   50   5.581 ± 0.041  ms/op\nThreadSleep1Benchmark.sleep       10  avgt   50  11.069 ± 0.067  ms/op\nThreadSleep1Benchmark.sleep       50  avgt   50  55.719 ± 0.602  ms/op\n\nBenchmark                    (delay)  Mode  Cnt   Score   Error  Units\nThreadSleep2Benchmark.sleep        5  avgt   50   5.574 ± 0.035  ms/op\nThreadSleep2Benchmark.sleep       10  avgt   50  10.918 ± 0.035  ms/op\nThreadSleep2Benchmark.sleep       50  avgt   50  50.823 ± 0.055  ms/op\n</code></pre>\n"},{"tags":["java","spring","spring-rabbit","rmq"],"answers":[{"tags":[],"owner":{"account_id":1288095,"reputation":169326,"user_id":1240763,"display_name":"Gary Russell"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1656337433,"creation_date":1656337433,"answer_id":72773128,"question_id":72738366,"body_markdown":"The pools are independent; you won&#39;t get any transactional channels as long as you don&#39;t use a `RabbitTemplate` with `channelTransacted` set to true, so there is no need to worry about configuring the pool like that.\r\n\r\nTransactions can be used, for example, to atomically send a series of messages (all sent or none sent if the transaction is rolled back). Useful if you are synchronizing with some other transaction, such as JDBC.","title":"Spring RabbitMQ PooledChannelConnectionFactory, transactional vs non-transaction pool settings","body":"<p>The pools are independent; you won't get any transactional channels as long as you don't use a <code>RabbitTemplate</code> with <code>channelTransacted</code> set to true, so there is no need to worry about configuring the pool like that.</p>\n<p>Transactions can be used, for example, to atomically send a series of messages (all sent or none sent if the transaction is rolled back). Useful if you are synchronizing with some other transaction, such as JDBC.</p>\n"}],"owner":{"account_id":378848,"reputation":202,"user_id":731842,"accept_rate":25,"display_name":"user731842"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":484,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":72773128,"answer_count":1,"score":2,"last_activity_date":1656337433,"creation_date":1656037234,"question_id":72738366,"body_markdown":"I have a Spring Boot service that needs to listen to messages across multiple RMQ vhosts. So far I only need to consume messages, though in the short future I might need to publish messages to a third vhost. For this reason I&#39;ve moved towards explicit configuration of the RMQ connection factory - one connection factory per vhost.\r\n\r\nLooking at the [documentation](https://docs.spring.io/spring-amqp/reference/html/#choosing-factory) the PooledChannelConnectionFactory fits my needs. I do not need strict ordering of the messages, correlated publisher confirms, or caching connections to a single vhost. Everything I do with rabbit is take a message and update an entry in the database.\r\n\r\n    @Bean\r\n    PooledChannelConnectionFactory pcf() throws Exception {\r\n        ConnectionFactory rabbitConnectionFactory = new ConnectionFactory();\r\n        //Set the credentials\r\n        PooledChannelConnectionFactory pcf = new PooledChannelConnectionFactory(rabbitConnectionFactory);\r\n        pcf.setPoolConfigurer((pool, tx) -&gt; {\r\n            if (tx) {\r\n                // configure the transactional pool\r\n            }\r\n            else {\r\n                // configure the non-transactional pool\r\n            }\r\n        });\r\n        return pcf;\r\n    }\r\n\r\nWhat I require assistance with is understanding what the difference between the transactional and non-transactional pool is. My understanding of RMQ and AMQP is that everything is async unless you build RPC semantics ontop of it (reply queues and exchanges). Because of that how can this channel pool have transactional properties?\r\n\r\nMy current approach is to disable one of the configurations by setting min/max to 0, and set the other to a min/max of 1. I do not expect to have extreme volume through the service, and I expect to be horizontally scaling the application which will scale the capacity to consume messages. Is there anything else I should be considering?","title":"Spring RabbitMQ PooledChannelConnectionFactory, transactional vs non-transaction pool settings","body":"<p>I have a Spring Boot service that needs to listen to messages across multiple RMQ vhosts. So far I only need to consume messages, though in the short future I might need to publish messages to a third vhost. For this reason I've moved towards explicit configuration of the RMQ connection factory - one connection factory per vhost.</p>\n<p>Looking at the <a href=\"https://docs.spring.io/spring-amqp/reference/html/#choosing-factory\" rel=\"nofollow noreferrer\">documentation</a> the PooledChannelConnectionFactory fits my needs. I do not need strict ordering of the messages, correlated publisher confirms, or caching connections to a single vhost. Everything I do with rabbit is take a message and update an entry in the database.</p>\n<pre><code>@Bean\nPooledChannelConnectionFactory pcf() throws Exception {\n    ConnectionFactory rabbitConnectionFactory = new ConnectionFactory();\n    //Set the credentials\n    PooledChannelConnectionFactory pcf = new PooledChannelConnectionFactory(rabbitConnectionFactory);\n    pcf.setPoolConfigurer((pool, tx) -&gt; {\n        if (tx) {\n            // configure the transactional pool\n        }\n        else {\n            // configure the non-transactional pool\n        }\n    });\n    return pcf;\n}\n</code></pre>\n<p>What I require assistance with is understanding what the difference between the transactional and non-transactional pool is. My understanding of RMQ and AMQP is that everything is async unless you build RPC semantics ontop of it (reply queues and exchanges). Because of that how can this channel pool have transactional properties?</p>\n<p>My current approach is to disable one of the configurations by setting min/max to 0, and set the other to a min/max of 1. I do not expect to have extreme volume through the service, and I expect to be horizontally scaling the application which will scale the capacity to consume messages. Is there anything else I should be considering?</p>\n"},{"tags":["java","lambda","java-stream"],"comments":[{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":1,"creation_date":1656330698,"post_id":72771595,"comment_id":128537597,"body_markdown":"I suppose you have a list of POJOs after mapping? Then you can stream it. The actual operation depends on what you want to do. Do you just want to print it or do something different with it?","body":"I suppose you have a list of POJOs after mapping? Then you can stream it. The actual operation depends on what you want to do. Do you just want to print it or do something different with it?"},{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":1,"creation_date":1656330737,"post_id":72771595,"comment_id":128537610,"body_markdown":"`map.entrySet()` returns a `Set&lt;String, Integer&gt;` which does have a `stream()` method. Is that what you want?","body":"<code>map.entrySet()</code> returns a <code>Set&lt;String, Integer&gt;</code> which does have a <code>stream()</code> method. Is that what you want?"},{"owner":{"account_id":6718742,"reputation":321,"user_id":5179636,"display_name":"colouredmirrorball"},"score":0,"creation_date":1656330811,"post_id":72771595,"comment_id":128537645,"body_markdown":"Is there a reason to use a Map here? It seems like a list could work with the object you give as an example.","body":"Is there a reason to use a Map here? It seems like a list could work with the object you give as an example."},{"owner":{"account_id":5931948,"reputation":559,"user_id":4666134,"accept_rate":42,"display_name":"user4324324"},"score":0,"creation_date":1656330815,"post_id":72771595,"comment_id":128537648,"body_markdown":"I have fetch the value of k1 and k2 so that I can process further using these values.","body":"I have fetch the value of k1 and k2 so that I can process further using these values."},{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":0,"creation_date":1656330904,"post_id":72771595,"comment_id":128537688,"body_markdown":"That is a bit ambiguous. So you want to save `.map()` them. What you want to map them to? A list of integers? You are not specifying the desired result","body":"That is a bit ambiguous. So you want to save <code>.map()</code> them. What you want to map them to? A list of integers? You are not specifying the desired result"},{"owner":{"account_id":3211603,"reputation":289297,"user_id":2711488,"display_name":"Holger"},"score":4,"creation_date":1656331027,"post_id":72771595,"comment_id":128537739,"body_markdown":"In the beginning of your question, you have a `private Integer k1; private List&lt;Integer&gt; k2;`, but at the end, you suddenly have a `Map&lt;String, Integer&gt;`. And according to your question’s title, there is an array involved…","body":"In the beginning of your question, you have a <code>private Integer k1; private List&lt;Integer&gt; k2;</code>, but at the end, you suddenly have a <code>Map&lt;String, Integer&gt;</code>. And according to your question’s title, there is an array involved…"},{"owner":{"account_id":1485367,"reputation":122993,"user_id":1393766,"display_name":"Pshemo"},"score":1,"creation_date":1656331083,"post_id":72771595,"comment_id":128537754,"body_markdown":"&quot;*Incoming JSON object which will be mapped to the POJO request*&quot; (1) what you shown is JSON Array `[...]` which *holds* two JSON Objects `[{..}, {..}]`. (2) How will it happen? What is the relationship of your POJO and `map` you are trying to iterate?","body":"&quot;<i>Incoming JSON object which will be mapped to the POJO request</i>&quot; (1) what you shown is JSON Array <code>[...]</code> which <i>holds</i> two JSON Objects <code>[{..}, {..}]</code>. (2) How will it happen? What is the relationship of your POJO and <code>map</code> you are trying to iterate?"},{"owner":{"account_id":5931948,"reputation":559,"user_id":4666134,"accept_rate":42,"display_name":"user4324324"},"score":0,"creation_date":1656331202,"post_id":72771595,"comment_id":128537797,"body_markdown":"Updated my question with more data","body":"Updated my question with more data"},{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":1,"creation_date":1656331591,"post_id":72771595,"comment_id":128537942,"body_markdown":"`list.forEach(e -&gt; e.getK2().forEach(e2 -&gt; System.out.println(e.getK1() + &quot;=&quot; + e2)));` but instead of printing, you make the DB call","body":"<code>list.forEach(e -&gt; e.getK2().forEach(e2 -&gt; System.out.println(e.getK1() + &quot;=&quot; + e2)));</code> but instead of printing, you make the DB call"},{"owner":{"account_id":23959668,"reputation":26587,"user_id":17949945,"display_name":"Alexander Ivanchenko"},"score":1,"creation_date":1656331625,"post_id":72771595,"comment_id":128537950,"body_markdown":"This SQL-query doesn&#39;t explain what you&#39;re trying to achieve in Java.","body":"This SQL-query doesn&#39;t explain what you&#39;re trying to achieve in Java."},{"owner":{"account_id":5931948,"reputation":559,"user_id":4666134,"accept_rate":42,"display_name":"user4324324"},"score":0,"creation_date":1656331871,"post_id":72771595,"comment_id":128538042,"body_markdown":"@AlexanderIvanchenko  Hope now the SQL query is clear","body":"@AlexanderIvanchenko  Hope now the SQL query is clear"}],"answers":[{"tags":[],"owner":{"account_id":15769302,"reputation":740,"user_id":11378797,"display_name":"Nitika Bansal"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656331409,"creation_date":1656331409,"answer_id":72771777,"question_id":72771595,"body_markdown":"convert your json to pojo using objectMapper. It will be a list. then iterate over the list and call respective getters to fetch values\r\n\r\n```java\r\nclass Custom{\r\n    private Integer k1;\r\n    private List&lt;Integer&gt; k2 = new ArrayList&lt;Integer&gt;();\r\n}\r\n\r\n\r\n\r\nString json = &quot;[{\\&quot;k1\\&quot;:1,\\&quot;k2\\&quot;:[2,3,4]},{\\&quot;k1\\&quot;:2,\\&quot;k2\\&quot;:[5,6,7]}]&quot;;\r\nObjectMapper mapper = new ObjectMapper();\r\nList&lt;Custom&gt; customsList = Arrays.asList(mapper.readValue(json, Custom[].class));\r\ncustomsList.stream().forEach(cl -&gt; System.out.println(cl.getK1()+&quot;:&quot;+cl.getK2()));\r\n```","title":"Loop through each element in array","body":"<p>convert your json to pojo using objectMapper. It will be a list. then iterate over the list and call respective getters to fetch values</p>\n<pre class=\"lang-java prettyprint-override\"><code>class Custom{\n    private Integer k1;\n    private List&lt;Integer&gt; k2 = new ArrayList&lt;Integer&gt;();\n}\n\n\n\nString json = &quot;[{\\&quot;k1\\&quot;:1,\\&quot;k2\\&quot;:[2,3,4]},{\\&quot;k1\\&quot;:2,\\&quot;k2\\&quot;:[5,6,7]}]&quot;;\nObjectMapper mapper = new ObjectMapper();\nList&lt;Custom&gt; customsList = Arrays.asList(mapper.readValue(json, Custom[].class));\ncustomsList.stream().forEach(cl -&gt; System.out.println(cl.getK1()+&quot;:&quot;+cl.getK2()));\n</code></pre>\n"},{"tags":[],"owner":{"account_id":25376058,"reputation":1338,"user_id":19189183,"display_name":"Sayan Bhattacharya"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656337391,"creation_date":1656336482,"answer_id":72772923,"question_id":72771595,"body_markdown":"Another way of doing this is using [`Gson`][1].\r\n```\r\nGson gson = new GsonBuilder().create();\r\nList&lt;Custom&gt; list = gson.fromJson(json, new TypeToken&lt;List&lt;Custom&gt;&gt;(){}.getType());\r\n```\r\nNow as mentioned by [@NikitaBansal][2] all you have to do is iterate through the list and construct your SQL syntax .\r\n```\r\nfor(Custom obj : list){\r\n    for(Integer i : obj.k2 ){\r\n        System.out.println(&quot;K1 &quot; + c.k1+ &quot; :: K2 &quot;+i);  \r\n        //your code\r\n    }\r\n}\r\n```\r\nIt&#39;s completely up to you , how you are going to traverse it.\r\n\r\n  [1]: https://github.com/google/gson\r\n  [2]: https://stackoverflow.com/users/11378797/nitika-bansal","title":"Loop through each element in array","body":"<p>Another way of doing this is using <a href=\"https://github.com/google/gson\" rel=\"nofollow noreferrer\"><code>Gson</code></a>.</p>\n<pre><code>Gson gson = new GsonBuilder().create();\nList&lt;Custom&gt; list = gson.fromJson(json, new TypeToken&lt;List&lt;Custom&gt;&gt;(){}.getType());\n</code></pre>\n<p>Now as mentioned by <a href=\"https://stackoverflow.com/users/11378797/nitika-bansal\">@NikitaBansal</a> all you have to do is iterate through the list and construct your SQL syntax .</p>\n<pre><code>for(Custom obj : list){\n    for(Integer i : obj.k2 ){\n        System.out.println(&quot;K1 &quot; + c.k1+ &quot; :: K2 &quot;+i);  \n        //your code\n    }\n}\n</code></pre>\n<p>It's completely up to you , how you are going to traverse it.</p>\n"}],"owner":{"account_id":5931948,"reputation":559,"user_id":4666134,"accept_rate":42,"display_name":"user4324324"},"comment_count":11,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":139,"favorite_count":0,"down_vote_count":2,"up_vote_count":0,"answer_count":2,"score":-2,"last_activity_date":1656337391,"creation_date":1656330566,"question_id":72771595,"body_markdown":"I am trying to loop through the below JSON format object for which I have the code below\r\n\r\n```\r\nprivate Integer k1;\r\nprivate List&lt;Integer&gt; k2 = new ArrayList&lt;Integer&gt;();\r\n// getter setters\r\n```\r\n\r\nIncoming JSON object which will be mapped to the POJO request\r\n```\r\n[{&quot;k1&quot;:1,&quot;k2&quot;:[2,3,4]},{&quot;k1&quot;:2,&quot;k2&quot;:[5,6,7]}]\r\n```\r\n\r\nI am trying to iterate over the request data and get the value of k1 and k2. How can I achieve this. It will be really grateful for any help provided.\r\n\r\nI have tried below code, but is there any better wat to achieve this using streams\r\n```\r\nfor (Map.Entry&lt;String, Integer&gt; entry : map.entrySet()) {\r\n}\r\n```\r\n\r\nI want to iterate each element to get the value of k1 and then k2 to get all values. I am confused how to loop through the outer array and then getting the value from inner array of k2.\r\n\r\n&gt; Expected Output\r\n```\r\nselect * from table where col1=1 and col2=2;\r\nselect * from table where col1=1 and col2=3;\r\nselect * from table where col1=1 and col2=4;\r\nselect * from table where col1=2 and col2=5;\r\nselect * from table where col1=2 and col2=6;\r\n//Similarly all values iterated and made db call each time\r\n```\r\nMaking a call to DB using the values of k1 for col1 and k2 for col2","title":"Loop through each element in array","body":"<p>I am trying to loop through the below JSON format object for which I have the code below</p>\n<pre><code>private Integer k1;\nprivate List&lt;Integer&gt; k2 = new ArrayList&lt;Integer&gt;();\n// getter setters\n</code></pre>\n<p>Incoming JSON object which will be mapped to the POJO request</p>\n<pre><code>[{&quot;k1&quot;:1,&quot;k2&quot;:[2,3,4]},{&quot;k1&quot;:2,&quot;k2&quot;:[5,6,7]}]\n</code></pre>\n<p>I am trying to iterate over the request data and get the value of k1 and k2. How can I achieve this. It will be really grateful for any help provided.</p>\n<p>I have tried below code, but is there any better wat to achieve this using streams</p>\n<pre><code>for (Map.Entry&lt;String, Integer&gt; entry : map.entrySet()) {\n}\n</code></pre>\n<p>I want to iterate each element to get the value of k1 and then k2 to get all values. I am confused how to loop through the outer array and then getting the value from inner array of k2.</p>\n<blockquote>\n<p>Expected Output</p>\n</blockquote>\n<pre><code>select * from table where col1=1 and col2=2;\nselect * from table where col1=1 and col2=3;\nselect * from table where col1=1 and col2=4;\nselect * from table where col1=2 and col2=5;\nselect * from table where col1=2 and col2=6;\n//Similarly all values iterated and made db call each time\n</code></pre>\n<p>Making a call to DB using the values of k1 for col1 and k2 for col2</p>\n"},{"tags":["java","multithreading","concurrency","thread-safety","memory-barriers"],"comments":[{"owner":{"account_id":78868,"reputation":336965,"user_id":224132,"accept_rate":83,"display_name":"Peter Cordes"},"score":1,"creation_date":1634220189,"post_id":69570970,"comment_id":122971133,"body_markdown":"You&#39;d previously tagged this with [instruction-reordering].  That&#39;s not a very helpful way to think about memory reordering.  CPUs (and compilers) preserve the illusion (for this thread) of things happening in program order, it&#39;s only the order of memory operations (not instructions) seen by other threads that can vary.  See [Java instruction reordering and CPU memory reordering](https://stackoverflow.com/q/69568946)","body":"You&#39;d previously tagged this with [instruction-reordering].  That&#39;s not a very helpful way to think about memory reordering.  CPUs (and compilers) preserve the illusion (for this thread) of things happening in program order, it&#39;s only the order of memory operations (not instructions) seen by other threads that can vary.  See <a href=\"https://stackoverflow.com/q/69568946\">Java instruction reordering and CPU memory reordering</a>"},{"owner":{"account_id":21117225,"reputation":311,"user_id":15775890,"display_name":"bimjhi"},"score":0,"creation_date":1634220799,"post_id":69570970,"comment_id":122971412,"body_markdown":"@PeterCordes Let me reformulate my question: Can&#39;t `cache.put(arg, ft);` be put at the very beginning of the method just because it uses local var `ft`? In other words, is `ft` is the only reason preventing It?","body":"@PeterCordes Let me reformulate my question: Can&#39;t <code>cache.put(arg, ft);</code> be put at the very beginning of the method just because it uses local var <code>ft</code>? In other words, is <code>ft</code> is the only reason preventing It?"},{"owner":{"account_id":292208,"reputation":10665,"user_id":2245707,"accept_rate":17,"display_name":"pveentjer"},"score":0,"creation_date":1634221063,"post_id":69570970,"comment_id":122971536,"body_markdown":"No, because it would break the illusion.","body":"No, because it would break the illusion."},{"owner":{"account_id":21117225,"reputation":311,"user_id":15775890,"display_name":"bimjhi"},"score":0,"creation_date":1634221304,"post_id":69570970,"comment_id":122971636,"body_markdown":"@pveentjer Please be more specific if the use of a local in cache.put prevents reordering or not.","body":"@pveentjer Please be more specific if the use of a local in cache.put prevents reordering or not."},{"owner":{"account_id":78868,"reputation":336965,"user_id":224132,"accept_rate":83,"display_name":"Peter Cordes"},"score":2,"creation_date":1634221322,"post_id":69570970,"comment_id":122971648,"body_markdown":"Are you literally asking if you could edit the source code to make that change, and have the code still work correctly?  Or asking if anything stops the JVM from making asm *as if* you&#39;d done that, *other* than a data dependency?","body":"Are you literally asking if you could edit the source code to make that change, and have the code still work correctly?  Or asking if anything stops the JVM from making asm <i>as if</i> you&#39;d done that, <i>other</i> than a data dependency?"},{"owner":{"account_id":21117225,"reputation":311,"user_id":15775890,"display_name":"bimjhi"},"score":0,"creation_date":1634221378,"post_id":69570970,"comment_id":122971673,"body_markdown":"I mean compiler-driven reordering, not a human.","body":"I mean compiler-driven reordering, not a human."},{"owner":{"account_id":292208,"reputation":10665,"user_id":2245707,"accept_rate":17,"display_name":"pveentjer"},"score":0,"creation_date":1634221652,"post_id":69570970,"comment_id":122971786,"body_markdown":"The get and the put produce a series of instructions. And the compiler/CPU could reorder some of them so that you end up with an interleaving of instructions from get and some instructions from put. But it can only be done under the guarantee that the behavior of this reordering is no different then if the get is executed first and then the put. So the sequential semantics of the program need to be preserved.","body":"The get and the put produce a series of instructions. And the compiler/CPU could reorder some of them so that you end up with an interleaving of instructions from get and some instructions from put. But it can only be done under the guarantee that the behavior of this reordering is no different then if the get is executed first and then the put. So the sequential semantics of the program need to be preserved."},{"owner":{"account_id":292208,"reputation":10665,"user_id":2245707,"accept_rate":17,"display_name":"pveentjer"},"score":0,"creation_date":1634222155,"post_id":69570970,"comment_id":122971993,"body_markdown":"I added an addition to my answer that hopefully improves your understanding.","body":"I added an addition to my answer that hopefully improves your understanding."},{"owner":{"account_id":3211603,"reputation":289297,"user_id":2711488,"display_name":"Holger"},"score":3,"creation_date":1634295959,"post_id":69570970,"comment_id":122992144,"body_markdown":"There is no benefit in discussing this in terms of source code fragments being shuffled around. For example, if you assume that `cache.put(arg, ft);` could be placed at the beginning of the method, what happens to the `FutureTask&lt;V&gt; ft = new FutureTask&lt;V&gt;(eval);` whose result is used by `cache.put(arg, ft);`? Describe the *actual outcome* of this method you’re speculating about.","body":"There is no benefit in discussing this in terms of source code fragments being shuffled around. For example, if you assume that <code>cache.put(arg, ft);</code> could be placed at the beginning of the method, what happens to the <code>FutureTask&lt;V&gt; ft = new FutureTask&lt;V&gt;(eval);</code> whose result is used by <code>cache.put(arg, ft);</code>? Describe the <i>actual outcome</i> of this method you’re speculating about."}],"answers":[{"tags":[],"owner":{"account_id":292208,"reputation":10665,"user_id":2245707,"accept_rate":17,"display_name":"pveentjer"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1634223748,"creation_date":1634219390,"answer_id":69571912,"question_id":69570970,"body_markdown":"Instructions can&#39;t be reordered if they violate the sequential semantics of a program. \r\n\r\nSimple example (assuming a=b=0):\r\n\r\n    a=1\r\n    b=a\r\n\r\nSo according to the sequential semantics of the above program, the only allowed outcome is `a=1`, `b=1`. If the 2 instructions would be reordered, then we get outcome `a=1`,`b=0`. But this outcome is violating the sequential semantics and hence prohibited\r\n\r\nThis is also informally called `within thread as if serial semantics`. So the compiler (or CPU) is allowed to reordered instructions. But the most basic constraint is that no reorderings are allowed that would violate the sequential semantics.\r\n\r\nIf the JVM would be allowed to violate the sequential semantics of a program, I&#39;m going to quit my job as developer today :)\r\n\r\nIn terms of the JMM: the `a=1` is ordered before the `b=a` in the happens before order due to the program order between these 2 instructions. \r\n\r\nKeep in mind that the JMM is not specified in terms of method calls. It is expressed in actions like plain loads/stores volatile loads/stores, monitor lock release/acquire etc.\r\n\r\n\r\n[Addition]\r\n\r\nImagine you have the following code:\r\n\r\n    int a,b,c,d=0;\r\n\r\n    void foo(){\r\n       a=1\r\n       b=1\r\n    }\r\n    \r\n    void bar(){\r\n      c=1\r\n      d=a\r\n    }\r\n\r\n    void foobar(){\r\n       foo();  \r\n       bar();\r\n    }\r\n\r\nThen the only allowed result is &#39;a=1,b=1,c=1,d=1&#39;\r\n\r\nDue to inlining we can get rid of the function calls:\r\n\r\n    void foobar(){\r\n      a=1 //foo\r\n      b=1 //foo\r\n      c=1 //bar\r\n      d=a //bar\r\n    }\r\n\r\nThe following execution preserves the sequential semantics:\r\n\r\n      c=1 //bar\r\n      a=1 //foo\r\n      b=1 //foo\r\n      d=a //bar\r\n\r\nSince the outcome is &#39;a=1,b=1,c=1,d=1&#39;\r\n\r\nBut the following execution violates the sequential semantics.\r\n\r\n       d=a //bar\r\n       a=1 //foo\r\n       b=1 //foo\r\n       c=1 //bar\r\n\r\nBecause we end up with &#39;a=1,b=1,c=1,d=0&#39;, where d is 0 instead of 1.\r\n\r\nInstructions from function calls can be reordered under the condition that the sequential semantics of the program is not violated.","title":"Can instructions in Java Concurrency in Practice 5.18 be reordered during compiler optimizations","body":"<p>Instructions can't be reordered if they violate the sequential semantics of a program.</p>\n<p>Simple example (assuming a=b=0):</p>\n<pre><code>a=1\nb=a\n</code></pre>\n<p>So according to the sequential semantics of the above program, the only allowed outcome is <code>a=1</code>, <code>b=1</code>. If the 2 instructions would be reordered, then we get outcome <code>a=1</code>,<code>b=0</code>. But this outcome is violating the sequential semantics and hence prohibited</p>\n<p>This is also informally called <code>within thread as if serial semantics</code>. So the compiler (or CPU) is allowed to reordered instructions. But the most basic constraint is that no reorderings are allowed that would violate the sequential semantics.</p>\n<p>If the JVM would be allowed to violate the sequential semantics of a program, I'm going to quit my job as developer today :)</p>\n<p>In terms of the JMM: the <code>a=1</code> is ordered before the <code>b=a</code> in the happens before order due to the program order between these 2 instructions.</p>\n<p>Keep in mind that the JMM is not specified in terms of method calls. It is expressed in actions like plain loads/stores volatile loads/stores, monitor lock release/acquire etc.</p>\n<p>[Addition]</p>\n<p>Imagine you have the following code:</p>\n<pre><code>int a,b,c,d=0;\n\nvoid foo(){\n   a=1\n   b=1\n}\n\nvoid bar(){\n  c=1\n  d=a\n}\n\nvoid foobar(){\n   foo();  \n   bar();\n}\n</code></pre>\n<p>Then the only allowed result is 'a=1,b=1,c=1,d=1'</p>\n<p>Due to inlining we can get rid of the function calls:</p>\n<pre><code>void foobar(){\n  a=1 //foo\n  b=1 //foo\n  c=1 //bar\n  d=a //bar\n}\n</code></pre>\n<p>The following execution preserves the sequential semantics:</p>\n<pre><code>  c=1 //bar\n  a=1 //foo\n  b=1 //foo\n  d=a //bar\n</code></pre>\n<p>Since the outcome is 'a=1,b=1,c=1,d=1'</p>\n<p>But the following execution violates the sequential semantics.</p>\n<pre><code>   d=a //bar\n   a=1 //foo\n   b=1 //foo\n   c=1 //bar\n</code></pre>\n<p>Because we end up with 'a=1,b=1,c=1,d=0', where d is 0 instead of 1.</p>\n<p>Instructions from function calls can be reordered under the condition that the sequential semantics of the program is not violated.</p>\n"},{"tags":[],"owner":{"account_id":21117225,"reputation":311,"user_id":15775890,"display_name":"bimjhi"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1656336508,"creation_date":1634310187,"answer_id":69586794,"question_id":69570970,"body_markdown":"After some investigation on `ConcurrentHashMap.get`, `ConcurrentHashMap.put`, I can say the understanding of why B.\r\nGoetz&#39; code has such a structure requires knowing the internals of ConcurrentHashmap.\r\n\r\nUnder &quot;reordering&quot; below, I mean a chance of that lines of a complete code may be reordered by a compiler due to enabled optimizations. \r\n\r\nThe answer does not touch the topic of CPU memory reordering, which is highlighted, e.g., in https://stackoverflow.com/a/66973124\r\n\r\nIn his previous example using ordinal Map version, B. Goetz used a synchronized version of `compute`:\r\n\r\n```\r\npublic class Memoizer1&lt;A, V&gt; implements Computable&lt;A, V&gt; {\r\n    @GuardedBy(&quot;this&quot;)\r\n    private final Map&lt;A, V&gt; cache = new HashMap&lt;A, V&gt;();\r\n    private final Computable&lt;A, V&gt; c;\r\n\r\n    public Memoizer1(Computable&lt;A, V&gt; c) { this.c = c; }\r\n\r\n    public synchronized V compute(final A arg) throws InterruptedException {\r\n        V result = cache.get(arg);\r\n        if (result == null) {\r\n            result = c.compute(arg);\r\n            cache.put(arg, result);\r\n        }\r\n        return result;\r\n    }\r\n}\r\n```\r\n\r\n`Synchronized` here was needed to prevent simultaneous access of multiple threads to the hashmap. Since access methods of an ordinal hashmap are not atomic, there might potentially be a situation where one thread rewrites incomplete portions of data made by another thread, thus blocking the latter from completing its work. For the same reason, a reading method could potentially see partially constructed data.\r\n\r\nAs long as synchronized forces it to actually run a store instruction, the value will become visible to other threads just by committing it to the local L1d cache, because it&#39;s coherent. (And a memory barrier will block later loads/stores until that happens).\r\n\r\nLater, B. Goetz replaced ordinal HashMap with ConcurrentHashMap, which allowed him to remove synchronized keyword.\r\n\r\nhttps://www.burnison.ca/articles/the-concurrency-of-concurrenthashmap clearly explains why ConcurrentHashMap.get is the first here:\r\n\r\n&gt; In comparisons to the previous methods, the get() and containsKey()\r\n&gt; methods are fairly mundane. Also unlike the previous methods, both are\r\n&gt; entirely lock-free. First, a Segment is retrieved from the segments\r\n&gt; array using the applicable high-order bits of the key&#39;s hash. The\r\n&gt; retrieval is performed using Unsafe.getObjectVolatile(). Next, a\r\n&gt; HashEntry of the segment&#39;s table array is retrieved using the key&#39;s\r\n&gt; hash. This retrieval is also performed using Unsafe.getObjectVolatile.\r\n&gt; From this head node, the linked list of HashEntry objects is traversed\r\n&gt; until the specified key is found (or not found) and the applicable\r\n&gt; value is returned.\r\n\r\nDue to its volatile-read semantics, ConcurrentHashMap.get cannot be moved down in code by a compiler. At the same time, it allows moving that up.\r\n\r\nHowever, Volatile reads may be reordered with previous lines so those lines have to be plain and their influence on the code below should be understandable without deep mental analysis.\r\n\r\nConcurrentHashMap.put has volatile-write semantics so it cannot be reordered with upper operations but can be reordered with operations below. But FutureTask.run (ft.run(); here) internally uses full-fence CompareAndSetState (see https://stackoverflow.com/questions/19768540 and https://stackoverflow.com/questions/72435749) so it generates full memory barrier and thus `cache.put(arg, ft);` cannot be reordered with `ft.run();`.\r\n\r\nThe quotation of another author of &quot;Java Concurrency in Practice&quot; below is related to that `within thread as if serial semantics` is not enough to understand the multithreaded code fragment using shared variables.\r\n\r\n&gt; The within-thread as-if-serial property is helpful only when only one\r\n&gt; thread at a time is manipulating variables, due to synchronization,\r\n&gt; structural exclusion, or pure chance. When multiple threads are all\r\n&gt; running unsynchronized code that reads and writes common fields, then\r\n&gt; arbitrary interleavings, atomicity failures, race conditions, and\r\n&gt; visibility failures may result in execution patterns that make the\r\n&gt; notion of as-if-serial just about meaningless with respect to any\r\n&gt; given thread.\r\n&gt; \r\n&gt; Even though JLS addresses some particular legal and illegal\r\n&gt; reorderings that can occur, interactions with these other issues\r\n&gt; reduce practical guarantees to saying that the results may reflect\r\n&gt; just about any possible interleaving of just about any possible\r\n&gt; reordering. So there is no point in trying to reason about the\r\n&gt; ordering properties of such code.\r\n\r\n(C) Doug Lea\r\n\r\nPer http://gee.cs.oswego.edu/dl/cpj/jmm.html","title":"Can instructions in Java Concurrency in Practice 5.18 be reordered during compiler optimizations","body":"<p>After some investigation on <code>ConcurrentHashMap.get</code>, <code>ConcurrentHashMap.put</code>, I can say the understanding of why B.\nGoetz' code has such a structure requires knowing the internals of ConcurrentHashmap.</p>\n<p>Under &quot;reordering&quot; below, I mean a chance of that lines of a complete code may be reordered by a compiler due to enabled optimizations.</p>\n<p>The answer does not touch the topic of CPU memory reordering, which is highlighted, e.g., in <a href=\"https://stackoverflow.com/a/66973124\">https://stackoverflow.com/a/66973124</a></p>\n<p>In his previous example using ordinal Map version, B. Goetz used a synchronized version of <code>compute</code>:</p>\n<pre><code>public class Memoizer1&lt;A, V&gt; implements Computable&lt;A, V&gt; {\n    @GuardedBy(&quot;this&quot;)\n    private final Map&lt;A, V&gt; cache = new HashMap&lt;A, V&gt;();\n    private final Computable&lt;A, V&gt; c;\n\n    public Memoizer1(Computable&lt;A, V&gt; c) { this.c = c; }\n\n    public synchronized V compute(final A arg) throws InterruptedException {\n        V result = cache.get(arg);\n        if (result == null) {\n            result = c.compute(arg);\n            cache.put(arg, result);\n        }\n        return result;\n    }\n}\n</code></pre>\n<p><code>Synchronized</code> here was needed to prevent simultaneous access of multiple threads to the hashmap. Since access methods of an ordinal hashmap are not atomic, there might potentially be a situation where one thread rewrites incomplete portions of data made by another thread, thus blocking the latter from completing its work. For the same reason, a reading method could potentially see partially constructed data.</p>\n<p>As long as synchronized forces it to actually run a store instruction, the value will become visible to other threads just by committing it to the local L1d cache, because it's coherent. (And a memory barrier will block later loads/stores until that happens).</p>\n<p>Later, B. Goetz replaced ordinal HashMap with ConcurrentHashMap, which allowed him to remove synchronized keyword.</p>\n<p><a href=\"https://www.burnison.ca/articles/the-concurrency-of-concurrenthashmap\" rel=\"nofollow noreferrer\">https://www.burnison.ca/articles/the-concurrency-of-concurrenthashmap</a> clearly explains why ConcurrentHashMap.get is the first here:</p>\n<blockquote>\n<p>In comparisons to the previous methods, the get() and containsKey()\nmethods are fairly mundane. Also unlike the previous methods, both are\nentirely lock-free. First, a Segment is retrieved from the segments\narray using the applicable high-order bits of the key's hash. The\nretrieval is performed using Unsafe.getObjectVolatile(). Next, a\nHashEntry of the segment's table array is retrieved using the key's\nhash. This retrieval is also performed using Unsafe.getObjectVolatile.\nFrom this head node, the linked list of HashEntry objects is traversed\nuntil the specified key is found (or not found) and the applicable\nvalue is returned.</p>\n</blockquote>\n<p>Due to its volatile-read semantics, ConcurrentHashMap.get cannot be moved down in code by a compiler. At the same time, it allows moving that up.</p>\n<p>However, Volatile reads may be reordered with previous lines so those lines have to be plain and their influence on the code below should be understandable without deep mental analysis.</p>\n<p>ConcurrentHashMap.put has volatile-write semantics so it cannot be reordered with upper operations but can be reordered with operations below. But FutureTask.run (ft.run(); here) internally uses full-fence CompareAndSetState (see <a href=\"https://stackoverflow.com/questions/19768540\">How FutureTask is asynchronous computation</a> and <a href=\"https://stackoverflow.com/questions/72435749\">compareAndSwap a common member ( non-volatile member ) still has memory semantics of volatile read and write</a>) so it generates full memory barrier and thus <code>cache.put(arg, ft);</code> cannot be reordered with <code>ft.run();</code>.</p>\n<p>The quotation of another author of &quot;Java Concurrency in Practice&quot; below is related to that <code>within thread as if serial semantics</code> is not enough to understand the multithreaded code fragment using shared variables.</p>\n<blockquote>\n<p>The within-thread as-if-serial property is helpful only when only one\nthread at a time is manipulating variables, due to synchronization,\nstructural exclusion, or pure chance. When multiple threads are all\nrunning unsynchronized code that reads and writes common fields, then\narbitrary interleavings, atomicity failures, race conditions, and\nvisibility failures may result in execution patterns that make the\nnotion of as-if-serial just about meaningless with respect to any\ngiven thread.</p>\n<p>Even though JLS addresses some particular legal and illegal\nreorderings that can occur, interactions with these other issues\nreduce practical guarantees to saying that the results may reflect\njust about any possible interleaving of just about any possible\nreordering. So there is no point in trying to reason about the\nordering properties of such code.</p>\n</blockquote>\n<p>(C) Doug Lea</p>\n<p>Per <a href=\"http://gee.cs.oswego.edu/dl/cpj/jmm.html\" rel=\"nofollow noreferrer\">http://gee.cs.oswego.edu/dl/cpj/jmm.html</a></p>\n"}],"owner":{"account_id":21117225,"reputation":311,"user_id":15775890,"display_name":"bimjhi"},"comment_count":9,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":177,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"accepted_answer_id":69586794,"answer_count":2,"score":0,"last_activity_date":1656337168,"creation_date":1634215577,"question_id":69570970,"body_markdown":"I&#39;m reading the book on subject.\r\n\r\nIn 5.18, Brian Goetz gave an example of semi-efficient memoizer with a non-volatile shared variable `cache` having the type of ConcurrentHashMap as follows:\r\n\r\n```\r\npublic class Memoizer3&lt;A, V&gt; implements Computable&lt;A, V&gt; {\r\n    private final Map&lt;A, Future&lt;V&gt;&gt; cache\r\n        = new ConcurrentHashMap&lt;A, Future&lt;V&gt;&gt;();\r\n    private final Computable&lt;A, V&gt; c;\r\n\r\n    public Memoizer3(Computable&lt;A, V&gt; c) { this.c = c; }\r\n\r\n    public V compute(final A arg) throws InterruptedException {\r\n        Future&lt;V&gt; f = cache.get(arg);\r\n        if (f == null) {\r\n            Callable&lt;V&gt; eval = new Callable&lt;V&gt;() {\r\n                public V call() throws InterruptedException {\r\n                    return c.compute(arg);\r\n                }\r\n            };\r\n            FutureTask&lt;V&gt; ft = new FutureTask&lt;V&gt;(eval);\r\n            f = ft;\r\n            cache.put(arg, ft); // Can it be put at the very beginning of compute?\r\n            ft.run();\r\n        }\r\n        try {\r\n            return f.get();\r\n        } catch (ExecutionException e) {\r\n            throw launderThrowable(e.getCause());\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nThe problem is that I don&#39;t understand rules under which `cache.put(arg, ft);` can be reordered by a compiler to be put ahead of `Future&lt;V&gt; f = cache.get(arg);` in terms of JLS (Is reordering of cache variable is possible at all?).\r\n\r\nUnder &quot;reordering&quot;, I mean a chance of that lines of complete code may be reordered by a compiler due to enabled optimizations.\r\n\r\nThe question does not touch the topic of CPU memory reordering, which is highlighted, e.g., in https://stackoverflow.com/a/66973124\r\n\r\n**EDIT:**\r\n\r\nA reason for this question is the ability of a compiler to damage unsynchronized multithreaded code fragments using shared variables in some cases, another reason is a quotation from an author of this book, Doug Lea:\r\n\r\n&gt; The within-thread as-if-serial property is helpful only when only one\r\n&gt; thread at a time is manipulating variables, due to synchronization,\r\n&gt; structural exclusion, or pure chance. When multiple threads are all\r\n&gt; running unsynchronized code that reads and writes common fields, then\r\n&gt; arbitrary interleavings, atomicity failures, race conditions, and\r\n&gt; visibility failures may result in execution patterns that make the\r\n&gt; notion of as-if-serial just about meaningless with respect to any\r\n&gt; given thread.\r\n&gt; \r\n&gt; Even though JLS addresses some particular legal and illegal\r\n&gt; reorderings that can occur, interactions with these other issues\r\n&gt; reduce practical guarantees to saying that the results may reflect\r\n&gt; just about any possible interleaving of just about any possible\r\n&gt; reordering. So there is no point in trying to reason about the\r\n&gt; ordering properties of such code.\r\n\r\nPer http://gee.cs.oswego.edu/dl/cpj/jmm.html\r\n\r\nIn other words, not following the JLS constraints regarding &quot;happens-before&quot;, locks or volatile semantics may lead to broken results in unsynchronized code which uses shared variables.\r\n\r\nP.S. Thanks to [Peter Cordes][1] for his comments on this theme.\r\n\r\n\r\n  [1]: https://stackoverflow.com/users/224132/","title":"Can instructions in Java Concurrency in Practice 5.18 be reordered during compiler optimizations","body":"<p>I'm reading the book on subject.</p>\n<p>In 5.18, Brian Goetz gave an example of semi-efficient memoizer with a non-volatile shared variable <code>cache</code> having the type of ConcurrentHashMap as follows:</p>\n<pre><code>public class Memoizer3&lt;A, V&gt; implements Computable&lt;A, V&gt; {\n    private final Map&lt;A, Future&lt;V&gt;&gt; cache\n        = new ConcurrentHashMap&lt;A, Future&lt;V&gt;&gt;();\n    private final Computable&lt;A, V&gt; c;\n\n    public Memoizer3(Computable&lt;A, V&gt; c) { this.c = c; }\n\n    public V compute(final A arg) throws InterruptedException {\n        Future&lt;V&gt; f = cache.get(arg);\n        if (f == null) {\n            Callable&lt;V&gt; eval = new Callable&lt;V&gt;() {\n                public V call() throws InterruptedException {\n                    return c.compute(arg);\n                }\n            };\n            FutureTask&lt;V&gt; ft = new FutureTask&lt;V&gt;(eval);\n            f = ft;\n            cache.put(arg, ft); // Can it be put at the very beginning of compute?\n            ft.run();\n        }\n        try {\n            return f.get();\n        } catch (ExecutionException e) {\n            throw launderThrowable(e.getCause());\n        }\n    }\n}\n</code></pre>\n<p>The problem is that I don't understand rules under which <code>cache.put(arg, ft);</code> can be reordered by a compiler to be put ahead of <code>Future&lt;V&gt; f = cache.get(arg);</code> in terms of JLS (Is reordering of cache variable is possible at all?).</p>\n<p>Under &quot;reordering&quot;, I mean a chance of that lines of complete code may be reordered by a compiler due to enabled optimizations.</p>\n<p>The question does not touch the topic of CPU memory reordering, which is highlighted, e.g., in <a href=\"https://stackoverflow.com/a/66973124\">https://stackoverflow.com/a/66973124</a></p>\n<p><strong>EDIT:</strong></p>\n<p>A reason for this question is the ability of a compiler to damage unsynchronized multithreaded code fragments using shared variables in some cases, another reason is a quotation from an author of this book, Doug Lea:</p>\n<blockquote>\n<p>The within-thread as-if-serial property is helpful only when only one\nthread at a time is manipulating variables, due to synchronization,\nstructural exclusion, or pure chance. When multiple threads are all\nrunning unsynchronized code that reads and writes common fields, then\narbitrary interleavings, atomicity failures, race conditions, and\nvisibility failures may result in execution patterns that make the\nnotion of as-if-serial just about meaningless with respect to any\ngiven thread.</p>\n<p>Even though JLS addresses some particular legal and illegal\nreorderings that can occur, interactions with these other issues\nreduce practical guarantees to saying that the results may reflect\njust about any possible interleaving of just about any possible\nreordering. So there is no point in trying to reason about the\nordering properties of such code.</p>\n</blockquote>\n<p>Per <a href=\"http://gee.cs.oswego.edu/dl/cpj/jmm.html\" rel=\"nofollow noreferrer\">http://gee.cs.oswego.edu/dl/cpj/jmm.html</a></p>\n<p>In other words, not following the JLS constraints regarding &quot;happens-before&quot;, locks or volatile semantics may lead to broken results in unsynchronized code which uses shared variables.</p>\n<p>P.S. Thanks to <a href=\"https://stackoverflow.com/users/224132/\">Peter Cordes</a> for his comments on this theme.</p>\n"},{"tags":["java","algorithm"],"comments":[{"owner":{"account_id":247613,"reputation":284089,"user_id":522444,"accept_rate":100,"display_name":"Hovercraft Full Of Eels"},"score":2,"creation_date":1656328695,"post_id":72771156,"comment_id":128536844,"body_markdown":"I have to wonder that if you&#39;re asking how to improve or optimize working code, then perhaps this is perhaps better posted on the [Stack Exchange Code Review site](https://codereview.stackexchange.com/).","body":"I have to wonder that if you&#39;re asking how to improve or optimize working code, then perhaps this is perhaps better posted on the <a href=\"https://codereview.stackexchange.com/\">Stack Exchange Code Review site</a>."},{"owner":{"account_id":6136413,"reputation":8488,"user_id":4785110,"display_name":"maraca"},"score":0,"creation_date":1656329172,"post_id":72771156,"comment_id":128537010,"body_markdown":"Use your own list implementation, then you can just cut it and modify some pointers. Or if there is only one test case just read in an array and then do a loop to output the correct order. You could even read in everything as a String cut and swap.","body":"Use your own list implementation, then you can just cut it and modify some pointers. Or if there is only one test case just read in an array and then do a loop to output the correct order. You could even read in everything as a String cut and swap."},{"owner":{"account_id":18361187,"reputation":686,"user_id":13373270,"display_name":"codebod"},"score":0,"creation_date":1656329194,"post_id":72771156,"comment_id":128537017,"body_markdown":"Is this actually a matter of running the operation on a background thread, so that the UI isn&#39;t frozen?","body":"Is this actually a matter of running the operation on a background thread, so that the UI isn&#39;t frozen?"},{"owner":{"account_id":7720636,"reputation":1532,"user_id":5846981,"accept_rate":100,"display_name":"Som"},"score":0,"creation_date":1656329298,"post_id":72771156,"comment_id":128537055,"body_markdown":"I am practicing ds and algo problems from hackerrank. This is one of the question from there.","body":"I am practicing ds and algo problems from hackerrank. This is one of the question from there."},{"owner":{"account_id":1663234,"reputation":138406,"user_id":1531124,"accept_rate":96,"display_name":"GhostCat"},"score":1,"creation_date":1656329493,"post_id":72771156,"comment_id":128537128,"body_markdown":"I’m voting to close this question because this community isn&#39;t mean to review working code.","body":"I’m voting to close this question because this community isn&#39;t mean to review working code."},{"owner":{"account_id":17835,"reputation":303895,"user_id":40342,"accept_rate":62,"display_name":"Joachim Sauer"},"score":1,"creation_date":1656329495,"post_id":72771156,"comment_id":128537130,"body_markdown":"The fastest way *by far* would be to write a wrapper `List` implementation that simply delegates all access to the original one after calculating the new offset of the desired element. No need to move any part of the content anywhere.","body":"The fastest way <i>by far</i> would be to write a wrapper <code>List</code> implementation that simply delegates all access to the original one after calculating the new offset of the desired element. No need to move any part of the content anywhere."},{"owner":{"account_id":3211603,"reputation":289297,"user_id":2711488,"display_name":"Holger"},"score":2,"creation_date":1656331963,"post_id":72771156,"comment_id":128538080,"body_markdown":"@JoachimSauer that would be the most efficient solution if a list was actually required. But since the task is defined by text input and output and afaik, hackerrank doesn’t judge over what the program actually does but only about producing the expected output, there are even more efficient solutions possible.","body":"@JoachimSauer that would be the most efficient solution if a list was actually required. But since the task is defined by text input and output and afaik, hackerrank doesn’t judge over what the program actually does but only about producing the expected output, there are even more efficient solutions possible."},{"owner":{"account_id":17835,"reputation":303895,"user_id":40342,"accept_rate":62,"display_name":"Joachim Sauer"},"score":0,"creation_date":1656334321,"post_id":72771156,"comment_id":128538995,"body_markdown":"@Holger: I took the request to mean &quot;how to implement *this method* in the most efficient way&quot;. But yes, if text output is required, then it can be done even faster and with less code.","body":"@Holger: I took the request to mean &quot;how to implement <i>this method</i> in the most efficient way&quot;. But yes, if text output is required, then it can be done even faster and with less code."},{"owner":{"display_name":"user1196549"},"score":0,"creation_date":1656336421,"post_id":72771156,"comment_id":128539907,"body_markdown":"@JoachimSauer: it is unsure that this trick is efficient, that depends on the processing that follows. Because on every access the index will need to be recomputed (with a test or a modulo), and this computation could be repeated many times.","body":"@JoachimSauer: it is unsure that this trick is efficient, that depends on the processing that follows. Because on every access the index will need to be recomputed (with a test or a modulo), and this computation could be repeated many times."},{"owner":{"account_id":17835,"reputation":303895,"user_id":40342,"accept_rate":62,"display_name":"Joachim Sauer"},"score":1,"creation_date":1656337191,"post_id":72771156,"comment_id":128540235,"body_markdown":"@YvesDaoust: first, this is clearly from some hackerank-style question where the further processing is almost guaranteed to be just dumping the content to stdout or some other verification. Second, even if that wasn&#39;t the case I&#39;m still fairly confident that in most cases my approach works faster, since calculations are *significantly* faster than memory access and we&#39;re replacing duplicate (unnecessary) memory access with a very simple calculation (repeated frequently). But yes, if this was for some unspecified general case, then the actual advantages/disadvantages would have to be inspected.","body":"@YvesDaoust: first, this is clearly from some hackerank-style question where the further processing is almost guaranteed to be just dumping the content to stdout or some other verification. Second, even if that wasn&#39;t the case I&#39;m still fairly confident that in most cases my approach works faster, since calculations are <i>significantly</i> faster than memory access and we&#39;re replacing duplicate (unnecessary) memory access with a very simple calculation (repeated frequently). But yes, if this was for some unspecified general case, then the actual advantages/disadvantages would have to be inspected."},{"owner":{"display_name":"user1196549"},"score":0,"creation_date":1656340238,"post_id":72771156,"comment_id":128541499,"body_markdown":"@JoachimSauer: my comment relates to real life: if you rotate the vector, you will most probably... access it some day (that will cost you both index recomputation and memory access). I also disagree to say that the &quot;simple calculation&quot; will be faster than a memory access.","body":"@JoachimSauer: my comment relates to real life: if you rotate the vector, you will most probably... access it some day (that will cost you both index recomputation and memory access). I also disagree to say that the &quot;simple calculation&quot; will be faster than a memory access."}],"answers":[{"tags":[],"owner":{"account_id":17092302,"reputation":9084,"user_id":12368154,"display_name":"Charchit Kapoor"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1656329253,"creation_date":1656329253,"answer_id":72771337,"question_id":72771156,"body_markdown":"Instead of using nested loops, this can be done in one loop. The final index of an element at index `i` after `n` shifts, can be calculated as `(i + n) % listLength`, this index can be used to populate a shifted list. Like this:\r\n\r\n    import java.util.*;\r\n    class HelloWorld {\r\n        public static void main(String[] args) {\r\n            List&lt;Integer&gt; arr = Arrays.asList(1,2,3,4,5);\r\n            System.out.println(rotateLeft(4, arr));\r\n        }\r\n        \r\n        public static List&lt;Integer&gt; rotateLeft(int d, List&lt;Integer&gt; arr) {\r\n        List&lt;Integer&gt; rotatedList = new ArrayList&lt;&gt;(arr.size());\r\n        int i=0;\r\n        for(i=0; i&lt; arr.size(); i++) {\r\n            int rotatedElementIndex = ((i+d) % arr.size());\r\n            rotatedList.add(arr.get(rotatedElementIndex));\r\n        }\r\n        return rotatedList;\r\n      }\r\n    }","title":"Code Optimize : Shifting a List of Integers in Java","body":"<p>Instead of using nested loops, this can be done in one loop. The final index of an element at index <code>i</code> after <code>n</code> shifts, can be calculated as <code>(i + n) % listLength</code>, this index can be used to populate a shifted list. Like this:</p>\n<pre><code>import java.util.*;\nclass HelloWorld {\n    public static void main(String[] args) {\n        List&lt;Integer&gt; arr = Arrays.asList(1,2,3,4,5);\n        System.out.println(rotateLeft(4, arr));\n    }\n    \n    public static List&lt;Integer&gt; rotateLeft(int d, List&lt;Integer&gt; arr) {\n    List&lt;Integer&gt; rotatedList = new ArrayList&lt;&gt;(arr.size());\n    int i=0;\n    for(i=0; i&lt; arr.size(); i++) {\n        int rotatedElementIndex = ((i+d) % arr.size());\n        rotatedList.add(arr.get(rotatedElementIndex));\n    }\n    return rotatedList;\n  }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4181375,"reputation":5091,"user_id":3426309,"display_name":"Andrey B. Panfilov"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656330904,"creation_date":1656330904,"answer_id":72771664,"question_id":72771156,"body_markdown":"Never liked hackerrank puzzles. What does &quot;and a huge Integer array&quot; mean? May we create a new list or we need to modify existing one? If we ought to modify existing one why our method is not void?\r\n\r\nIf we may create new list the optimal solution would be creating new Integer[] array and call System.arraycopy() twice. \r\n\r\nIn case of inline modifications the solution is:\r\n\r\n```java\r\n    public static List&lt;Integer&gt; rotateLeft(int d, List&lt;Integer&gt; arr) {\r\n        int i = 0, first = arr.get(0);\r\n        int n = arr.size();\r\n        while (true) {\r\n            int source = (i + d) % n;\r\n            if (source == 0) {\r\n                arr.set(i, first);\r\n                break;\r\n            }\r\n            arr.set(i, arr.get(source));\r\n            i = source;\r\n        }\r\n        return arr;\r\n    }\r\n```","title":"Code Optimize : Shifting a List of Integers in Java","body":"<p>Never liked hackerrank puzzles. What does &quot;and a huge Integer array&quot; mean? May we create a new list or we need to modify existing one? If we ought to modify existing one why our method is not void?</p>\n<p>If we may create new list the optimal solution would be creating new Integer[] array and call System.arraycopy() twice.</p>\n<p>In case of inline modifications the solution is:</p>\n<pre class=\"lang-java prettyprint-override\"><code>    public static List&lt;Integer&gt; rotateLeft(int d, List&lt;Integer&gt; arr) {\n        int i = 0, first = arr.get(0);\n        int n = arr.size();\n        while (true) {\n            int source = (i + d) % n;\n            if (source == 0) {\n                arr.set(i, first);\n                break;\n            }\n            arr.set(i, arr.get(source));\n            i = source;\n        }\n        return arr;\n    }\n</code></pre>\n"},{"tags":[],"owner":{"display_name":"user1196549"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656336558,"creation_date":1656335754,"answer_id":72772762,"question_id":72771156,"body_markdown":"For an in-place solution:\r\n\r\n- reverse the subarrays `arr[0, d)` and `arr[d, n)` in-place. This is done by swapping the elements in symmetric pairs.\r\n\r\n- reverse the whole array.\r\n\r\nE.g., `abcdefghijk`, `d=4`\r\n\r\n    abcd|efghijk -&gt; dcba|kjihgfe -&gt; efghijk|abcd\r\n\r\n","title":"Code Optimize : Shifting a List of Integers in Java","body":"<p>For an in-place solution:</p>\n<ul>\n<li><p>reverse the subarrays <code>arr[0, d)</code> and <code>arr[d, n)</code> in-place. This is done by swapping the elements in symmetric pairs.</p>\n</li>\n<li><p>reverse the whole array.</p>\n</li>\n</ul>\n<p>E.g., <code>abcdefghijk</code>, <code>d=4</code></p>\n<pre><code>abcd|efghijk -&gt; dcba|kjihgfe -&gt; efghijk|abcd\n</code></pre>\n"}],"owner":{"account_id":7720636,"reputation":1532,"user_id":5846981,"accept_rate":100,"display_name":"Som"},"comment_count":11,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":146,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":72771337,"answer_count":3,"score":0,"last_activity_date":1656336558,"creation_date":1656328465,"question_id":72771156,"body_markdown":"**Requirement** : There&#39;s an input List&lt;Integer&gt; and an input shift no.\r\nThe first line contains two space-separated integers that denote :\r\n\r\n - *n*, the number of integers, and \r\n - *d*, the number of left rotations to perform.\r\n\r\nThe second line contains space-separated integers that describe *arr[]*.\r\n\r\n**Constraints**\r\n\r\n - 1 &lt;= n &lt;= 10^5\r\n - 1 &lt;= d &lt;= n\r\n - 1 &lt;= arr[i] &lt;= 10^6\r\n\r\n**Sample Input**\r\n\r\n - 5 , 4\r\n - 1 2 3 4 5\r\n\r\n**Sample Output**\r\n\r\n5 1 2 3 4\r\n\r\n\r\nI have written this code which is working correctly but getting timeout while large operation. So I need to optimize my code to successfully run all the test cases. How to achieve that.\r\n\r\n    public static List&lt;Integer&gt; rotateLeft(int d, List&lt;Integer&gt; arr) {\r\n    \r\n        int size = arr.size();\r\n        while(d&gt;0) {\r\n            int temp = arr.get(0);\r\n            for(int i = 0; i&lt;size; i++){\r\n                if(i != size-1){\r\n                    arr.set(i,arr.get(i+1));\r\n                } else {\r\n                    arr.set(i,temp);\r\n                }\r\n            }\r\n            d--;\r\n        }\r\n        \r\n        return arr;\r\n\r\n    }\r\n\r\nFailing for this input :\r\n\r\n - n = 73642 \r\n - d = 60581\r\n - And a huge Integer List of size 73642.","title":"Code Optimize : Shifting a List of Integers in Java","body":"<p><strong>Requirement</strong> : There's an input List and an input shift no.\nThe first line contains two space-separated integers that denote :</p>\n<ul>\n<li><em>n</em>, the number of integers, and</li>\n<li><em>d</em>, the number of left rotations to perform.</li>\n</ul>\n<p>The second line contains space-separated integers that describe <em>arr[]</em>.</p>\n<p><strong>Constraints</strong></p>\n<ul>\n<li>1 &lt;= n &lt;= 10^5</li>\n<li>1 &lt;= d &lt;= n</li>\n<li>1 &lt;= arr[i] &lt;= 10^6</li>\n</ul>\n<p><strong>Sample Input</strong></p>\n<ul>\n<li>5 , 4</li>\n<li>1 2 3 4 5</li>\n</ul>\n<p><strong>Sample Output</strong></p>\n<p>5 1 2 3 4</p>\n<p>I have written this code which is working correctly but getting timeout while large operation. So I need to optimize my code to successfully run all the test cases. How to achieve that.</p>\n<pre><code>public static List&lt;Integer&gt; rotateLeft(int d, List&lt;Integer&gt; arr) {\n\n    int size = arr.size();\n    while(d&gt;0) {\n        int temp = arr.get(0);\n        for(int i = 0; i&lt;size; i++){\n            if(i != size-1){\n                arr.set(i,arr.get(i+1));\n            } else {\n                arr.set(i,temp);\n            }\n        }\n        d--;\n    }\n    \n    return arr;\n\n}\n</code></pre>\n<p>Failing for this input :</p>\n<ul>\n<li>n = 73642</li>\n<li>d = 60581</li>\n<li>And a huge Integer List of size 73642.</li>\n</ul>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":93689,"reputation":415931,"user_id":256196,"accept_rate":77,"display_name":"Bohemian"},"score":0,"creation_date":1656317249,"post_id":72768608,"comment_id":128532922,"body_markdown":"How many bytes maximum in the inputstream?","body":"How many bytes maximum in the inputstream?"},{"owner":{"account_id":20222092,"reputation":109,"user_id":14831240,"display_name":"kiki keke"},"score":0,"creation_date":1656317673,"post_id":72768608,"comment_id":128533063,"body_markdown":"this days 100 Ko","body":"this days 100 Ko"},{"owner":{"account_id":71739,"reputation":307142,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":0,"creation_date":1656317695,"post_id":72768608,"comment_id":128533070,"body_markdown":"Use a `Reader`, not an `InputStream`. Your replacing class should extend ` FilteredReader`.","body":"Use a <code>Reader</code>, not an <code>InputStream</code>. Your replacing class should extend ` FilteredReader`."},{"owner":{"account_id":20222092,"reputation":109,"user_id":14831240,"display_name":"kiki keke"},"score":0,"creation_date":1656320368,"post_id":72768608,"comment_id":128533996,"body_markdown":"I can have more details","body":"I can have more details"},{"owner":{"account_id":19118721,"reputation":6319,"user_id":13963086,"display_name":"k314159"},"score":0,"creation_date":1656323716,"post_id":72768608,"comment_id":128535157,"body_markdown":"I think the problem is caused by not calling `isMatchFound()` in the right place. You only call it when `outQueue` is empty, so you&#39;re missing occasions when there in fact is a match. I could be wrong - it just seems likely from a casual look at the code. I would recomment going through it in a debugger.","body":"I think the problem is caused by not calling <code>isMatchFound()</code> in the right place. You only call it when <code>outQueue</code> is empty, so you&#39;re missing occasions when there in fact is a match. I could be wrong - it just seems likely from a casual look at the code. I would recomment going through it in a debugger."},{"owner":{"account_id":19118721,"reputation":6319,"user_id":13963086,"display_name":"k314159"},"score":0,"creation_date":1656323782,"post_id":72768608,"comment_id":128535182,"body_markdown":"By the way, it seems strange that your constructor is protected. Don&#39;t you want to be able to create an instance of it?","body":"By the way, it seems strange that your constructor is protected. Don&#39;t you want to be able to create an instance of it?"},{"owner":{"account_id":93689,"reputation":415931,"user_id":256196,"accept_rate":77,"display_name":"Bohemian"},"score":1,"creation_date":1656324559,"post_id":72768608,"comment_id":128535421,"body_markdown":"If the input is only 100kb, and considering you&#39;re scraping it from a website so you won&#39;t notice a few extra microseconds, why don&#39;t you just read the input to a String, make the replacement and use the resulting String.","body":"If the input is only 100kb, and considering you&#39;re scraping it from a website so you won&#39;t notice a few extra microseconds, why don&#39;t you just read the input to a String, make the replacement and use the resulting String."},{"owner":{"account_id":20222092,"reputation":109,"user_id":14831240,"display_name":"kiki keke"},"score":0,"creation_date":1656329808,"post_id":72768608,"comment_id":128537237,"body_markdown":"I need to modify the content because the file in URL is an XML with a bad certificate, which I must modify to be able to convert it with jaxb","body":"I need to modify the content because the file in URL is an XML with a bad certificate, which I must modify to be able to convert it with jaxb"}],"answers":[{"tags":[],"owner":{"account_id":20222092,"reputation":109,"user_id":14831240,"display_name":"kiki keke"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656336497,"creation_date":1656336497,"answer_id":72772926,"question_id":72768608,"body_markdown":"Finally i use scanner \r\n\r\n``````java\r\nInputStream is = connection.getInputStream();\r\n\r\n\t\t\tString search = &quot;\\&quot;https\\&quot;&quot;;\r\n            String replace = &quot;&quot;;\r\n\r\n\t\t\ttry(Scanner scanner = new Scanner(is);\r\n\t\t\t\tBufferedWriter writer = new BufferedWriter(new FileWriter(file))) {\r\n\t\t\t\twhile(scanner.hasNextLine()){\r\n\t\t\t\t\twriter.append(scanner.nextLine().replace(search,replace));\r\n\t\t\t\t\twriter.newLine();\r\n\t\t\t\t}\r\n\t\t\t}\r\n``````","title":"How find and replace String with Java InputStream?","body":"<p>Finally i use scanner</p>\n<pre class=\"lang-java prettyprint-override\"><code>InputStream is = connection.getInputStream();\n\n            String search = &quot;\\&quot;https\\&quot;&quot;;\n            String replace = &quot;&quot;;\n\n            try(Scanner scanner = new Scanner(is);\n                BufferedWriter writer = new BufferedWriter(new FileWriter(file))) {\n                while(scanner.hasNextLine()){\n                    writer.append(scanner.nextLine().replace(search,replace));\n                    writer.newLine();\n                }\n            }\n</code></pre>\n"}],"owner":{"account_id":20222092,"reputation":109,"user_id":14831240,"display_name":"kiki keke"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":213,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":1,"score":0,"last_activity_date":1656336497,"creation_date":1656316075,"question_id":72768608,"body_markdown":"I got `InputStream` from URL but I need to replace or remove a string and write to file. I try to use extension of `FilterInputStream` to replace, but my file is still the same.\r\n\r\nI not necessarily need to have `InputStream` -&gt; `InputStream.replace()`\r\nbut `InputStream` -&gt; `File` with string replace\r\n\r\n```java\r\nclass ReplacingInputStream extends FilterInputStream {\r\n\r\n    LinkedList&lt;Integer&gt; inQueue = new LinkedList&lt;Integer&gt;();\r\n    LinkedList&lt;Integer&gt; outQueue = new LinkedList&lt;Integer&gt;();\r\n    final byte[] search, replacement;\r\n\r\n    protected ReplacingInputStream(InputStream in,\r\n                                   byte[] search,\r\n                                   byte[] replacement) {\r\n        super(in);\r\n        this.search = search;\r\n        this.replacement = replacement;\r\n    }\r\n\r\n    private boolean isMatchFound() {\r\n        Iterator&lt;Integer&gt; inIter = inQueue.iterator();\r\n        for (int i = 0; i &lt; search.length; i++)\r\n            if (!inIter.hasNext() || search[i] != inIter.next())\r\n                return false;\r\n        return true;\r\n    }\r\n\r\n    private void readAhead() throws IOException {\r\n        // Work up some look-ahead.\r\n        while (inQueue.size() &lt; search.length) {\r\n            int next = super.read();\r\n            inQueue.offer(next);\r\n            if (next == -1)\r\n                break;\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public int read() throws IOException {\r\n        // Next byte already determined.\r\n        if (outQueue.isEmpty()) {\r\n            readAhead();\r\n\r\n            if (isMatchFound()) {\r\n                for (int i = 0; i &lt; search.length; i++)\r\n                    inQueue.remove();\r\n\r\n                for (byte b : replacement)\r\n                    outQueue.offer((int) b);\r\n            } else\r\n                outQueue.add(inQueue.remove());\r\n        }\r\n        return outQueue.remove();\r\n    }\r\n}\r\n```\r\n```java\r\nInputStream is = connection.getInputStream();\r\n\r\nbyte[] search = &quot;\\&quot;https\\&quot;&quot;.getBytes(&quot;UTF-8&quot;);\r\nbyte[] replacement = &quot;&quot;.getBytes(&quot;UTF-8&quot;);\r\n\r\nInputStream ris = new ReplacingInputStream(is, search, replacement);\r\n\r\nFiles.copy(ris, file.toPath(), StandardCopyOption.REPLACE_EXISTING);\r\n```","title":"How find and replace String with Java InputStream?","body":"<p>I got <code>InputStream</code> from URL but I need to replace or remove a string and write to file. I try to use extension of <code>FilterInputStream</code> to replace, but my file is still the same.</p>\n<p>I not necessarily need to have <code>InputStream</code> -&gt; <code>InputStream.replace()</code>\nbut <code>InputStream</code> -&gt; <code>File</code> with string replace</p>\n<pre class=\"lang-java prettyprint-override\"><code>class ReplacingInputStream extends FilterInputStream {\n\n    LinkedList&lt;Integer&gt; inQueue = new LinkedList&lt;Integer&gt;();\n    LinkedList&lt;Integer&gt; outQueue = new LinkedList&lt;Integer&gt;();\n    final byte[] search, replacement;\n\n    protected ReplacingInputStream(InputStream in,\n                                   byte[] search,\n                                   byte[] replacement) {\n        super(in);\n        this.search = search;\n        this.replacement = replacement;\n    }\n\n    private boolean isMatchFound() {\n        Iterator&lt;Integer&gt; inIter = inQueue.iterator();\n        for (int i = 0; i &lt; search.length; i++)\n            if (!inIter.hasNext() || search[i] != inIter.next())\n                return false;\n        return true;\n    }\n\n    private void readAhead() throws IOException {\n        // Work up some look-ahead.\n        while (inQueue.size() &lt; search.length) {\n            int next = super.read();\n            inQueue.offer(next);\n            if (next == -1)\n                break;\n        }\n    }\n\n    @Override\n    public int read() throws IOException {\n        // Next byte already determined.\n        if (outQueue.isEmpty()) {\n            readAhead();\n\n            if (isMatchFound()) {\n                for (int i = 0; i &lt; search.length; i++)\n                    inQueue.remove();\n\n                for (byte b : replacement)\n                    outQueue.offer((int) b);\n            } else\n                outQueue.add(inQueue.remove());\n        }\n        return outQueue.remove();\n    }\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>InputStream is = connection.getInputStream();\n\nbyte[] search = &quot;\\&quot;https\\&quot;&quot;.getBytes(&quot;UTF-8&quot;);\nbyte[] replacement = &quot;&quot;.getBytes(&quot;UTF-8&quot;);\n\nInputStream ris = new ReplacingInputStream(is, search, replacement);\n\nFiles.copy(ris, file.toPath(), StandardCopyOption.REPLACE_EXISTING);\n</code></pre>\n"},{"tags":["java","minecraft-forge"],"comments":[{"owner":{"account_id":1535561,"reputation":7664,"user_id":1431720,"accept_rate":89,"display_name":"Robert"},"score":0,"creation_date":1656194947,"post_id":72757229,"comment_id":128513342,"body_markdown":"We need a [mcve] to help you. The link to the tutorial is not helpful, we need to know what you actually did, not what you were trying to follow.","body":"We need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to help you. The link to the tutorial is not helpful, we need to know what you actually did, not what you were trying to follow."},{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1656263521,"post_id":72757229,"comment_id":128523896,"body_markdown":"Please provide enough code so others can better understand or reproduce the problem.","body":"Please provide enough code so others can better understand or reproduce the problem."}],"answers":[{"tags":[],"owner":{"account_id":3185265,"reputation":7712,"user_id":2691058,"accept_rate":85,"display_name":"toastrackengima"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1656336474,"creation_date":1656336474,"answer_id":72772919,"question_id":72757229,"body_markdown":"OK, so I believe things have changed slightly since that tutorial, as its for 1.12. You can find the up-to-date steps in the `README.txt` file in the MDK folder that you&#39;ve downloaded.\r\n\r\nFollow the steps from your tutorial up until running `setupDecompWorkspace` in IntelliJ, and simply just run `genIntellijRuns` instead.","title":"Gradle error when creating minecraft modding environment","body":"<p>OK, so I believe things have changed slightly since that tutorial, as its for 1.12. You can find the up-to-date steps in the <code>README.txt</code> file in the MDK folder that you've downloaded.</p>\n<p>Follow the steps from your tutorial up until running <code>setupDecompWorkspace</code> in IntelliJ, and simply just run <code>genIntellijRuns</code> instead.</p>\n"}],"owner":{"account_id":24300019,"reputation":25,"user_id":18243651,"display_name":"Mattes"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":428,"favorite_count":0,"down_vote_count":1,"up_vote_count":2,"accepted_answer_id":72772919,"answer_count":1,"score":1,"last_activity_date":1656336474,"creation_date":1656189712,"question_id":72757229,"body_markdown":"I am constantly getting this error when I try to set up my minecraft modding environment:\r\n\r\n```A problem occurred evaluating initialization script.\r\n&gt; No signature of method: org.gradle.execution.taskgraph.DefaultTaskGraphExecuter.whenReady() is applicable for argument types: (SetupUtpTestResultListenerAction) values: [SetupUtpTestResultListenerAction@(some kind of id)]\r\nPossible solutions: whenReady(groovy.lang.Closure)\r\n```\r\n\r\nWhat I&#39;m currently using:\r\n\r\n- Windows 10\r\n- IntelliJ Idea community, 2022.1.3\r\n- Forge MDK 1.8.9 Recommended\r\n\r\nI am using this [modding tutorial][1].\r\n\r\nI would greatly appreciate if someone could help me.\r\n \r\n\r\n\r\n  [1]: https://www.youtube.com/watch?v=_Hyd8ZtJl1o\r\n\r\n\r\n**How to reproduce my problem:**\r\n\r\nYou basically want to follow every step in the tutorial like downloading forge MDK etc... until 8:02\r\n\r\nThere You want to select the build.gradle file in the project folder in IntelliJ. After opening it as a project a little gradle icon should be visible on the right side beside the 3 vertical dots. When you click the icon, gradle files should be visible. You want to open forgegradle and double click the SetupDecomp workspace file. After doing all of this, I get this error","title":"Gradle error when creating minecraft modding environment","body":"<p>I am constantly getting this error when I try to set up my minecraft modding environment:</p>\n<pre><code>&gt; No signature of method: org.gradle.execution.taskgraph.DefaultTaskGraphExecuter.whenReady() is applicable for argument types: (SetupUtpTestResultListenerAction) values: [SetupUtpTestResultListenerAction@(some kind of id)]\nPossible solutions: whenReady(groovy.lang.Closure)\n</code></pre>\n<p>What I'm currently using:</p>\n<ul>\n<li>Windows 10</li>\n<li>IntelliJ Idea community, 2022.1.3</li>\n<li>Forge MDK 1.8.9 Recommended</li>\n</ul>\n<p>I am using this <a href=\"https://www.youtube.com/watch?v=_Hyd8ZtJl1o\" rel=\"nofollow noreferrer\">modding tutorial</a>.</p>\n<p>I would greatly appreciate if someone could help me.</p>\n<p><strong>How to reproduce my problem:</strong></p>\n<p>You basically want to follow every step in the tutorial like downloading forge MDK etc... until 8:02</p>\n<p>There You want to select the build.gradle file in the project folder in IntelliJ. After opening it as a project a little gradle icon should be visible on the right side beside the 3 vertical dots. When you click the icon, gradle files should be visible. You want to open forgegradle and double click the SetupDecomp workspace file. After doing all of this, I get this error</p>\n"},{"tags":["java","spring","intellij-idea"],"answers":[{"tags":[],"owner":{"account_id":2273465,"reputation":15439,"user_id":2000323,"display_name":"Andrey"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656336303,"creation_date":1656336303,"answer_id":72772879,"question_id":72771550,"body_markdown":"For the IDE to dicover generated source classes, the `target/java-gen` directory must be marked as **generated source** type. Usually IDE can discover the generated sources directory automatically, based on the corresponding Maven plugin configuration. When plugin do you use for generation? \r\n\r\nYou can try:\r\n\r\n- using different options for the Settings (Preferences on macOS) | Build, Execution, Deployment | Build Tools | Maven | Importing | **Generated sources folders:** in [settings](https://www.jetbrains.com/help/idea/maven-importing.html);\r\n- mark the directory as **generated sources** manually and make sure the Settings (Preferences on macOS) | Build, Execution, Deployment | Build Tools | Maven | Importing | **Keep source and test folders on project reload** option is enabled. Though you will probably need to mark this directory every time after the `target` directory is deleted (e.g. after the full rebuild).","title":"Unable to access Java classes generated through JSON Files for development","body":"<p>For the IDE to dicover generated source classes, the <code>target/java-gen</code> directory must be marked as <strong>generated source</strong> type. Usually IDE can discover the generated sources directory automatically, based on the corresponding Maven plugin configuration. When plugin do you use for generation?</p>\n<p>You can try:</p>\n<ul>\n<li>using different options for the Settings (Preferences on macOS) | Build, Execution, Deployment | Build Tools | Maven | Importing | <strong>Generated sources folders:</strong> in <a href=\"https://www.jetbrains.com/help/idea/maven-importing.html\" rel=\"nofollow noreferrer\">settings</a>;</li>\n<li>mark the directory as <strong>generated sources</strong> manually and make sure the Settings (Preferences on macOS) | Build, Execution, Deployment | Build Tools | Maven | Importing | <strong>Keep source and test folders on project reload</strong> option is enabled. Though you will probably need to mark this directory every time after the <code>target</code> directory is deleted (e.g. after the full rebuild).</li>\n</ul>\n"}],"owner":{"account_id":16921011,"reputation":2463,"user_id":12237837,"display_name":"Aditya Rewari"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":55,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1656336303,"creation_date":1656330333,"question_id":72771550,"body_markdown":"While doing development at an old project, I am stuck at a weird situation.\r\n\r\nIn existing code, some of the Java Classes Schema are built through JSON files in the project.\r\n\r\nUpon doing a `mvn clean install` I am able to see these generated classes(as POJOs) at the `target` folder.\r\n \r\nBut I am unable to use these classes for regular development (unable to access these classes at code) \r\n\r\n**How do I access such Java generated classes at code ?**\r\n\r\nI am using IntelliJ IDE.\r\n\r\n\r\nClass Generation\r\n[![enter image description here][1]][1]\r\n\r\n\r\nClass unavailable for development\r\n\r\n[![enter image description here][2]][2]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/DzEjW.jpg\r\n  [2]: https://i.stack.imgur.com/Ob4oi.jpg","title":"Unable to access Java classes generated through JSON Files for development","body":"<p>While doing development at an old project, I am stuck at a weird situation.</p>\n<p>In existing code, some of the Java Classes Schema are built through JSON files in the project.</p>\n<p>Upon doing a <code>mvn clean install</code> I am able to see these generated classes(as POJOs) at the <code>target</code> folder.</p>\n<p>But I am unable to use these classes for regular development (unable to access these classes at code)</p>\n<p><strong>How do I access such Java generated classes at code ?</strong></p>\n<p>I am using IntelliJ IDE.</p>\n<p>Class Generation\n<a href=\"https://i.stack.imgur.com/DzEjW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DzEjW.jpg\" alt=\"enter image description here\" /></a></p>\n<p>Class unavailable for development</p>\n<p><a href=\"https://i.stack.imgur.com/Ob4oi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ob4oi.jpg\" alt=\"enter image description here\" /></a></p>\n"},{"tags":["java","maven"],"comments":[{"owner":{"account_id":112317,"reputation":93939,"user_id":296328,"accept_rate":60,"display_name":"khmarbaise"},"score":0,"creation_date":1656336390,"post_id":72772779,"comment_id":128539891,"body_markdown":"That sounds like a contradiction in itself... If they are needed they should be dependencies of the project ??? Please give some real example","body":"That sounds like a contradiction in itself... If they are needed they should be dependencies of the project ??? Please give some real example"},{"owner":{"account_id":1978391,"reputation":156,"user_id":1775623,"accept_rate":57,"display_name":"JimBob"},"score":0,"creation_date":1656336937,"post_id":72772779,"comment_id":128540132,"body_markdown":"The idea is to load/enrich the spring-boot tomcat with some kind of plugins that are not really needed by the project itself for compilation but can optimally be used during runtime. Actually the assembly plugin would work for me, but than I would need to define the artifacts twice. Once in the assembly and once in the pom itself. Ideally I only have one place for that. And on top I looking for some kind of generic structure to apply it on further plugins.","body":"The idea is to load/enrich the spring-boot tomcat with some kind of plugins that are not really needed by the project itself for compilation but can optimally be used during runtime. Actually the assembly plugin would work for me, but than I would need to define the artifacts twice. Once in the assembly and once in the pom itself. Ideally I only have one place for that. And on top I looking for some kind of generic structure to apply it on further plugins."},{"owner":{"account_id":112317,"reputation":93939,"user_id":296328,"accept_rate":60,"display_name":"khmarbaise"},"score":1,"creation_date":1656339199,"post_id":72772779,"comment_id":128541013,"body_markdown":"Can you please elaborate more in detail about what kind of tomcat plugins you are talking about? Apart from that if those are only needed during runtime define them as dependencies with scope runtime ... and change the configuration of the spring-boot-maven-plugin to include runtime as well.... Furthermore it sounds as if you are using the maven-assembly-plugin wrong ... ???","body":"Can you please elaborate more in detail about what kind of tomcat plugins you are talking about? Apart from that if those are only needed during runtime define them as dependencies with scope runtime ... and change the configuration of the spring-boot-maven-plugin to include runtime as well.... Furthermore it sounds as if you are using the maven-assembly-plugin wrong ... ???"},{"owner":{"account_id":888714,"reputation":34077,"user_id":927493,"accept_rate":61,"display_name":"J Fabian Meier"},"score":0,"creation_date":1656340859,"post_id":72772779,"comment_id":128541779,"body_markdown":"@JimBob If they are used at runtime, they are dependencies.","body":"@JimBob If they are used at runtime, they are dependencies."},{"owner":{"account_id":1978391,"reputation":156,"user_id":1775623,"accept_rate":57,"display_name":"JimBob"},"score":0,"creation_date":1656341949,"post_id":72772779,"comment_id":128542280,"body_markdown":"@JFabianMeier I think you&#39;re right. I just wanted to find a way not to define them twice.\nkhmarbaise I need jars in a particular folder which the application will manually load in separate classloaders. But as JFabianMeier already wrote, they are technically runtime artifacts and should therefore be listed within the depedencies.","body":"@JFabianMeier I think you&#39;re right. I just wanted to find a way not to define them twice. khmarbaise I need jars in a particular folder which the application will manually load in separate classloaders. But as JFabianMeier already wrote, they are technically runtime artifacts and should therefore be listed within the depedencies."}],"owner":{"account_id":1978391,"reputation":156,"user_id":1775623,"accept_rate":57,"display_name":"JimBob"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":30,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1656335799,"creation_date":1656335799,"question_id":72772779,"body_markdown":"I&#39;m looking for a way to copy jar files from the repo to a particular folder during build, to access this folder later on from the spring-boot webserver (e.g. /target/workspace/jars-go-here)\r\n\r\nAt first I had the maven-dependency-plugin in mind, but this does not seem to be capable of coping artifacts bundled within a pom as it does not work transitively for the goal &#39;copy&#39;. &#39;copy-dependencies&#39; does support copying the artifacts transitively, however only for dependencies of the project itself.\r\nNext I&#39;ve took a look on the maven-assembly-plugin. This supports copying jar of poms in a transitive way, but again only for dependencies of the project.\r\n\r\nIs there a way to copy artifacts transitively that are NOT dependencies of the project itself?","title":"Maven copy external artifacts that are not dependencies of the project during build","body":"<p>I'm looking for a way to copy jar files from the repo to a particular folder during build, to access this folder later on from the spring-boot webserver (e.g. /target/workspace/jars-go-here)</p>\n<p>At first I had the maven-dependency-plugin in mind, but this does not seem to be capable of coping artifacts bundled within a pom as it does not work transitively for the goal 'copy'. 'copy-dependencies' does support copying the artifacts transitively, however only for dependencies of the project itself.\nNext I've took a look on the maven-assembly-plugin. This supports copying jar of poms in a transitive way, but again only for dependencies of the project.</p>\n<p>Is there a way to copy artifacts transitively that are NOT dependencies of the project itself?</p>\n"},{"tags":["java","lambda","java-8"],"comments":[{"owner":{"account_id":162699,"reputation":138060,"user_id":3788176,"accept_rate":54,"display_name":"Andy Turner"},"score":7,"creation_date":1493159534,"post_id":43622061,"comment_id":74293128,"body_markdown":"Remove the `new Runnable`.","body":"Remove the <code>new Runnable</code>."},{"owner":{"account_id":7567,"reputation":10188,"user_id":13189,"accept_rate":75,"display_name":"eckes"},"score":0,"creation_date":1493160319,"post_id":43622061,"comment_id":74293377,"body_markdown":"BTW: just because you can use lambdas does not mean you have to use them. I find it much more readable to use method handles. Thats generally a good idea if the lambda is longer than 2 lines.","body":"BTW: just because you can use lambdas does not mean you have to use them. I find it much more readable to use method handles. Thats generally a good idea if the lambda is longer than 2 lines."}],"answers":[{"tags":[],"owner":{"account_id":162699,"reputation":138060,"user_id":3788176,"accept_rate":54,"display_name":"Andy Turner"},"down_vote_count":0,"up_vote_count":8,"is_accepted":false,"score":8,"last_activity_date":1493159721,"creation_date":1493159721,"answer_id":43622091,"question_id":43622061,"body_markdown":"Simply remove the `new Runnable`:\r\n\r\n    Thread t1 = new Thread(() -&gt; { /* body */ });\r\n\r\nYou might want to consider pulling that body out into a &quot;real&quot; method, and using a method reference instead:\r\n\r\n    static void doSomething() { /* body */ }\r\n\r\n    public static void main(String[] args) {\r\n      Thread t1 = new Thread(SampleApp::doSomething);\r\n    }\r\n\r\nBig lambda bodies are not especially readable.","title":"Convert Anonymous Inner Method to Lambda in Java 8","body":"<p>Simply remove the <code>new Runnable</code>:</p>\n\n<pre><code>Thread t1 = new Thread(() -&gt; { /* body */ });\n</code></pre>\n\n<p>You might want to consider pulling that body out into a \"real\" method, and using a method reference instead:</p>\n\n<pre><code>static void doSomething() { /* body */ }\n\npublic static void main(String[] args) {\n  Thread t1 = new Thread(SampleApp::doSomething);\n}\n</code></pre>\n\n<p>Big lambda bodies are not especially readable.</p>\n"},{"tags":[],"owner":{"account_id":2182639,"reputation":812,"user_id":1931774,"display_name":"SkateScout"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1493160259,"creation_date":1493160259,"answer_id":43622180,"question_id":43622061,"body_markdown":"Hi if you want it inline you can do this\r\n\r\n\t\tfinal Thread t1 = new Thread(()-&gt;{\r\n\t\t\tfor (int i = 0; i &lt; 10; i++) {\r\n\t\t\t\tSystem.out.println(&quot;Hello &quot; + i);\r\n\t\t\t\ttry { Thread.sleep(100); }\r\n\t\t\t\tcatch (final InterruptedException e) {\r\n\t\t\t\t\te.printStackTrace();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n","title":"Convert Anonymous Inner Method to Lambda in Java 8","body":"<p>Hi if you want it inline you can do this</p>\n\n<pre><code>    final Thread t1 = new Thread(()-&gt;{\n        for (int i = 0; i &lt; 10; i++) {\n            System.out.println(\"Hello \" + i);\n            try { Thread.sleep(100); }\n            catch (final InterruptedException e) {\n                e.printStackTrace();\n            }\n        }\n    });\n</code></pre>\n"},{"tags":[],"owner":{"account_id":15775647,"reputation":45,"user_id":11383492,"display_name":"Chamod Dilshan"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656335785,"creation_date":1656335785,"answer_id":72772773,"question_id":43622061,"body_markdown":"\r\n\r\n     import java.util.stream.IntStream;\r\n    public class SampleApp  {\r\n    public static void main(String[] args) {\r\n    \r\n    \t\tnew Thread( ()-&gt; {\r\n    \t\t\tIntStream.iterate(0, i -&gt; i +1).limit(10).forEach(i-&gt;{\r\n    \t\t\t\tSystem.out.println(&quot;Hello &quot; + i);\r\n    \t\t\t\ttry {\r\n    \t\t\t\t\tThread.sleep(100);\r\n    \t\t\t\t}\r\n    \t\t\t\tcatch (InterruptedException e) {\r\n    \t\t\t\t\te.printStackTrace();\r\n    \t\t\t\t}\r\n    \t\t\t});\r\n    \t\t\t\r\n    \t\t}).start();\r\n    \t\t}}","title":"Convert Anonymous Inner Method to Lambda in Java 8","body":"<pre><code> import java.util.stream.IntStream;\npublic class SampleApp  {\npublic static void main(String[] args) {\n\n        new Thread( ()-&gt; {\n            IntStream.iterate(0, i -&gt; i +1).limit(10).forEach(i-&gt;{\n                System.out.println(&quot;Hello &quot; + i);\n                try {\n                    Thread.sleep(100);\n                }\n                catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            });\n            \n        }).start();\n        }}\n</code></pre>\n"}],"owner":{"account_id":49142,"reputation":4904,"user_id":146234,"accept_rate":40,"display_name":"PacificNW_Lover"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":644,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":3,"score":1,"last_activity_date":1656335785,"creation_date":1493159488,"question_id":43622061,"body_markdown":"How can I convert the following code (specifically the public void run() method) into a lambda using Java 8?\r\n\r\n    public class SampleApp {\r\n\r\n\t\tpublic static void main(String[] args) {\r\n\t\t\tThread t1 = new Thread(new Runnable() {\r\n\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic void run() {\r\n\t\t\t\t\tfor (int i = 0; i &lt; 10; i++) {\r\n\t\t\t\t\t\tSystem.out.println(&quot;Hello &quot; + i);\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tThread.sleep(100);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcatch (InterruptedException e) {\r\n\t\t\t\t\t\t\te.printStackTrace();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tt1.start();\r\n\t\t}\r\n\t}\r\n\r\nTried:\r\n\r\n\tThread t1 = new Thread(new Runnable() -&gt; {\r\n\r\n\t\tfor (int i = 0; i &lt; 10; i++) {\r\n\t\t\tSystem.out.println(&quot;Hello &quot; + i);\r\n\t\t\ttry {\r\n\t\t\t\tThread.sleep(100);\r\n\t\t\t}\r\n\t\t\tcatch (InterruptedException e) {\r\n\t\t\t\te.printStackTrace();\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t);\r\n\r\nBut Eclipse keeps throwing errors...","title":"Convert Anonymous Inner Method to Lambda in Java 8","body":"<p>How can I convert the following code (specifically the public void run() method) into a lambda using Java 8?</p>\n\n<pre><code>public class SampleApp {\n\n    public static void main(String[] args) {\n        Thread t1 = new Thread(new Runnable() {\n\n            @Override\n            public void run() {\n                for (int i = 0; i &lt; 10; i++) {\n                    System.out.println(\"Hello \" + i);\n                    try {\n                        Thread.sleep(100);\n                    }\n                    catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                }\n            }\n        });\n\n        t1.start();\n    }\n}\n</code></pre>\n\n<p>Tried:</p>\n\n<pre><code>Thread t1 = new Thread(new Runnable() -&gt; {\n\n    for (int i = 0; i &lt; 10; i++) {\n        System.out.println(\"Hello \" + i);\n        try {\n            Thread.sleep(100);\n        }\n        catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    };\n\n);\n</code></pre>\n\n<p>But Eclipse keeps throwing errors...</p>\n"},{"tags":["java","api","exception","oauth-2.0","properties"],"comments":[{"owner":{"account_id":5979633,"reputation":2842,"user_id":4699160,"accept_rate":48,"display_name":"Saurabh Jhunjhunwala"},"score":0,"creation_date":1656327390,"post_id":72770654,"comment_id":128536367,"body_markdown":"looks like the setters are not getting injected. Why do you need a setter to initialise the values from yml file. A simple @Value(&quot;${security.oauth2.client.accessTokenUri}&quot;)\nString accessTokenUri ; should work, or else you would need to create a @Bean","body":"looks like the setters are not getting injected. Why do you need a setter to initialise the values from yml file. A simple @Value(&quot;${security.oauth2.client.accessTokenUri}&quot;) String accessTokenUri ; should work, or else you would need to create a @Bean"},{"owner":{"account_id":23538417,"reputation":1,"user_id":17583013,"display_name":"Angelo Tessaro"},"score":0,"creation_date":1656331741,"post_id":72770654,"comment_id":128537991,"body_markdown":"@SaurabhJhunjhunwala I put a breakpoint and checked, the values were injected correctly, they are there. I used the setters because the properties are &quot;static&quot; and SpringBoot doesn&#39;t let the values to be injected directly. Before I did that there was another problem where it was trying to access the values and they were null.","body":"@SaurabhJhunjhunwala I put a breakpoint and checked, the values were injected correctly, they are there. I used the setters because the properties are &quot;static&quot; and SpringBoot doesn&#39;t let the values to be injected directly. Before I did that there was another problem where it was trying to access the values and they were null."},{"owner":{"account_id":5979633,"reputation":2842,"user_id":4699160,"accept_rate":48,"display_name":"Saurabh Jhunjhunwala"},"score":0,"creation_date":1656331884,"post_id":72770654,"comment_id":128538050,"body_markdown":"Why do you want to have the values as static, when you are reading them from yml, what is the advantage you are getting","body":"Why do you want to have the values as static, when you are reading them from yml, what is the advantage you are getting"},{"owner":{"account_id":23538417,"reputation":1,"user_id":17583013,"display_name":"Angelo Tessaro"},"score":0,"creation_date":1656334022,"post_id":72770654,"comment_id":128538870,"body_markdown":"@SaurabhJhunjhunwala I tried changing everything to non-static and the &#39;@Value&#39; annotation didn&#39;t work. I get a null exception when trying to use the values:\njava.lang.NullPointerException: Cannot invoke &quot;String.length()&quot; because &quot;this.input&quot; is null","body":"@SaurabhJhunjhunwala I tried changing everything to non-static and the &#39;@Value&#39; annotation didn&#39;t work. I get a null exception when trying to use the values: java.lang.NullPointerException: Cannot invoke &quot;String.length()&quot; because &quot;this.input&quot; is null"},{"owner":{"account_id":5979633,"reputation":2842,"user_id":4699160,"accept_rate":48,"display_name":"Saurabh Jhunjhunwala"},"score":0,"creation_date":1656334310,"post_id":72770654,"comment_id":128538988,"body_markdown":"please share you yml, and also the updated java changes","body":"please share you yml, and also the updated java changes"},{"owner":{"account_id":5979633,"reputation":2842,"user_id":4699160,"accept_rate":48,"display_name":"Saurabh Jhunjhunwala"},"score":0,"creation_date":1656340142,"post_id":72770654,"comment_id":128541457,"body_markdown":"since we don&#39;t have static now, we can do away with setters, and use only @Value(&quot;${security.oauth2.client.accessTokenUri}&quot;) String accessTokenUri ;","body":"since we don&#39;t have static now, we can do away with setters, and use only @Value(&quot;${security.oauth2.client.accessTokenUri}&quot;) String accessTokenUri ;"},{"owner":{"account_id":23538417,"reputation":1,"user_id":17583013,"display_name":"Angelo Tessaro"},"score":0,"creation_date":1656340823,"post_id":72770654,"comment_id":128541750,"body_markdown":"@SaurabhJhunjhunwala I tried to, but it didn&#39;t work, the values are not injected this way. It returns java.lang.NullPointerException: Cannot invoke &quot;String.length()&quot; because &quot;this.input&quot; is null","body":"@SaurabhJhunjhunwala I tried to, but it didn&#39;t work, the values are not injected this way. It returns java.lang.NullPointerException: Cannot invoke &quot;String.length()&quot; because &quot;this.input&quot; is null"}],"owner":{"account_id":23538417,"reputation":1,"user_id":17583013,"display_name":"Angelo Tessaro"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":1252,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1656335512,"creation_date":1656326058,"question_id":72770654,"body_markdown":"I am connecting to an oAuth server to get the security Token in order to access a API I&#39;m using. At first I had the following class, with the parameters hard-coded:\r\n\r\n    public class TermineApiClient {\r\n    public static final String TOKEN_URI = &quot;https://testapi.de/oauth/v2/token&quot;;\r\n    public static final String API_URL = &quot;https://testapi.de/clients/2/events?startDate=2021-04-30&quot;;\r\n    public static final String CLIENT_ID = &quot;5544zj80ghcs0o8g&quot;;\r\n    public static final String CLIENT_SECRET = &quot;5pp5dn48k9s&quot;;\r\n    public static final String GRANT_TYPE = &quot;client_credentials&quot;;\r\n\r\n\r\n\r\nThen I called the server with the following function and it was all working just fine:\r\n\r\n        public static String getToken() throws IOException, InterruptedException {\r\n        HttpClient client = HttpClient.newHttpClient();\r\n        HttpRequest request = HttpRequest.newBuilder()\r\n                .uri(URI.create(TOKEN_URI))\r\n                .header(&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;)\r\n                .header(&quot;Accept&quot;, &quot;application/json&quot;)\r\n                .POST(HttpRequest.BodyPublishers.ofString(&quot;client_id=&quot; + CLIENT_ID + &quot;&amp;client_secret=&quot; + CLIENT_SECRET + &quot;&amp;grant_type=&quot; + GRANT_TYPE))\r\n                .build();\r\n        HttpResponse&lt;String&gt; response = client.send(request, HttpResponse.BodyHandlers.ofString());\r\n        //bind response to Authentication object\r\n        ObjectMapper mapper = new ObjectMapper();\r\n        return mapper.readValue(response.body(), Authentication.class).getAccess_token();\r\n    }\r\n\r\nBut since I don&#39;t want my parameters hard-coded I made some changes to the class to get them from the **application.yml** file, leaving the class like that:\r\n\r\n    @Component\r\n    public class TermineApiClient {\r\n    public static String TOKEN_URI;\r\n    public static String API_URL;\r\n    public static String CLIENT_ID;\r\n    public static String CLIENT_SECRET;\r\n    public static String GRANT_TYPE;\r\n\r\n    @Value(&quot;${security.oauth2.client.accessTokenUri}&quot;)\r\n    public void setTokenUri(String accessTokenUri){\r\n        TermineApiClient.TOKEN_URI = accessTokenUri;\r\n    }\r\n    @Value(&quot;${application.termineRegional.baseUrl}&quot;)\r\n    public void setApiUrl(String apiUrl){\r\n        TermineApiClient.API_URL = apiUrl;\r\n    }\r\n    @Value(&quot;${security.oauth2.client.clientId}&quot;)\r\n    public void setClientId(String clientId){\r\n        TermineApiClient.CLIENT_ID = clientId;\r\n    }\r\n    @Value(&quot;${security.oauth2.client.clientSecret}&quot;)\r\n    public void setClientSecret(String clientSecret){\r\n        TermineApiClient.CLIENT_SECRET = clientSecret;\r\n    }\r\n    @Value(&quot;${security.oauth2.client.grantType}&quot;)\r\n    public void setGrantType(String grantType){\r\n        TermineApiClient.GRANT_TYPE = grantType;\r\n    }\r\n\r\nAnd it&#39;s weird that now it simply doesn&#39;t work anymore, even though there is no problem in getting the parameters. Whenever it gets to this line `HttpResponse&lt;String&gt; response = client.send(request, HttpResponse.BodyHandlers.ofString());` it throws a **ConnectException: null**\r\n\r\nStacktrace:\r\n\r\n    java.net.ConnectException: null\r\n\tat java.net.http/jdk.internal.net.http.HttpClientImpl.send(HttpClientImpl.java:571) ~[java.net.http:na]\r\n\tat java.net.http/jdk.internal.net.http.HttpClientFacade.send(HttpClientFacade.java:123) ~[java.net.http:na]\r\n\tat com.events.termineapi.Client.TermineApiClient.getToken(TermineApiClient.java:69) ~[classes/:na]\r\n\tat com.events.termineapi.Client.TermineApiClient.getEvents(TermineApiClient.java:49) ~[classes/:na]\r\n\tat com.events.termineapi.Controller.EventsController.getEvents(EventsController.java:17) ~[classes/:na]\r\n\tat java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:577) ~[na:na]\r\n\tat org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.19.jar:5.3.19]\r\n\tat org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.19.jar:5.3.19]\r\n\tat org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.19.jar:5.3.19]\r\n\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.19.jar:5.3.19]\r\n\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.19.jar:5.3.19]\r\n\tat org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.19.jar:5.3.19]\r\n\tat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1067) ~[spring-webmvc-5.3.19.jar:5.3.19]\r\n\tat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) ~[spring-webmvc-5.3.19.jar:5.3.19]\r\n\tat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.19.jar:5.3.19]\r\n\tat org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898) ~[spring-webmvc-5.3.19.jar:5.3.19]\r\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:655) ~[tomcat-embed-core-9.0.62.jar:4.0.FR]\r\n\tat org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.19.jar:5.3.19]\r\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:764) ~[tomcat-embed-core-9.0.62.jar:4.0.FR]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.62.jar:9.0.62]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.19.jar:5.3.19]\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.19.jar:5.3.19]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.19.jar:5.3.19]\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.19.jar:5.3.19]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.19.jar:5.3.19]\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.19.jar:5.3.19]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:360) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:890) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1743) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\r\n\tat java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]\r\n\r\n    Caused by: java.net.ConnectException: null\r\n\tat java.net.http/jdk.internal.net.http.common.Utils.toConnectException(Utils.java:1045) ~[java.net.http:na]\r\n\tat java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:198) ~[java.net.http:na]\r\n\tat java.net.http/jdk.internal.net.http.AsyncSSLConnection.connectAsync(AsyncSSLConnection.java:56) ~[java.net.http:na]\r\n\tat java.net.http/jdk.internal.net.http.Http2Connection.createAsync(Http2Connection.java:378) ~[java.net.http:na]\r\n\tat java.net.http/jdk.internal.net.http.Http2ClientImpl.getConnectionFor(Http2ClientImpl.java:128) ~[java.net.http:na]\r\n\tat java.net.http/jdk.internal.net.http.ExchangeImpl.get(ExchangeImpl.java:93) ~[java.net.http:na]\r\n\tat java.net.http/jdk.internal.net.http.Exchange.establishExchange(Exchange.java:343) ~[java.net.http:na]\r\n\tat java.net.http/jdk.internal.net.http.Exchange.responseAsyncImpl0(Exchange.java:475) ~[java.net.http:na]\r\n\tat java.net.http/jdk.internal.net.http.Exchange.responseAsyncImpl(Exchange.java:380) ~[java.net.http:na]\r\n\tat java.net.http/jdk.internal.net.http.Exchange.responseAsync(Exchange.java:372) ~[java.net.http:na]\r\n\tat java.net.http/jdk.internal.net.http.MultiExchange.responseAsyncImpl(MultiExchange.java:408) ~[java.net.http:na]\r\n\tat java.net.http/jdk.internal.net.http.MultiExchange.lambda$responseAsyncImpl$7(MultiExchange.java:449) ~[java.net.http:na]\r\n\tat java.base/java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:934) ~[na:na]\r\n\tat java.base/java.util.concurrent.CompletableFuture.uniHandleStage(CompletableFuture.java:950) ~[na:na]\r\n\tat java.base/java.util.concurrent.CompletableFuture.handle(CompletableFuture.java:2340) ~[na:na]\r\n\tat java.net.http/jdk.internal.net.http.MultiExchange.responseAsyncImpl(MultiExchange.java:439) ~[java.net.http:na]\r\n\tat java.net.http/jdk.internal.net.http.MultiExchange.lambda$responseAsync0$2(MultiExchange.java:341) ~[java.net.http:na]\r\n\tat java.base/java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[na:na]\r\n\tat java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[na:na]\r\n\tat java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1773) ~[na:na]\r\n\tat java.net.http/jdk.internal.net.http.HttpClientImpl$DelegatingExecutor.execute(HttpClientImpl.java:155) ~[java.net.http:na]\r\n\tat java.base/java.util.concurrent.CompletableFuture.completeAsync(CompletableFuture.java:2673) ~[na:na]\r\n\tat java.net.http/jdk.internal.net.http.MultiExchange.responseAsync(MultiExchange.java:294) ~[java.net.http:na]\r\n\tat java.net.http/jdk.internal.net.http.HttpClientImpl.sendAsync(HttpClientImpl.java:652) ~[java.net.http:na]\r\n\tat java.net.http/jdk.internal.net.http.HttpClientImpl.send(HttpClientImpl.java:550) ~[java.net.http:na]\r\n\t... 52 common frames omitted\r\n\r\n    Caused by: java.nio.channels.UnresolvedAddressException: null\r\n\tat java.base/sun.nio.ch.Net.checkAddress(Net.java:149) ~[na:na]\r\n\tat java.base/sun.nio.ch.Net.checkAddress(Net.java:157) ~[na:na]\r\n\tat java.base/sun.nio.ch.SocketChannelImpl.checkRemote(SocketChannelImpl.java:816) ~[na:na]\r\n\tat java.base/sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:839) ~[na:na]\r\n\tat java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$0(PlainHttpConnection.java:183) ~[java.net.http:na]\r\n\tat java.base/java.security.AccessController.doPrivileged(AccessController.java:569) ~[na:na]\r\n\tat java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:185) ~[java.net.http:na]\r\n\t... 75 common frames omitted\r\n\r\n\r\n**Please, could anyone help me? It looks like such a silly problem, and I&#39;m stuck. Thanks!!!**\r\n\r\n\r\n**EDIT:**\r\n\r\nHere&#39;s the .yml file and changed the static properties to non-static\r\n\r\n    application:\r\n      termineRegional:\r\n        baseUrl: https://testapi.de/clients/2/events?startDate=2021-04-30\r\n    \r\n    security:\r\n      oauth2:\r\n        client:\r\n          grantType: client_credentials\r\n          clientId: 5544zj80ghcs0\r\n          clientSecret: 5pp5dn48\r\n          accessTokenUri: https://testapi.de/oauth/v2/token\r\n    \r\n    spring:\r\n      autoconfigure:\r\n        exclude[0]: org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration\r\n        exclude[1]: org.springframework.boot.actuate.autoconfigure.security.servlet.ManagementWebSecurityAutoConfiguration\r\n    \r\n   \r\n\r\n\r\n@Component\r\npublic class TermineApiClient {\r\n\r\n    @Value(&quot;${security.oauth2.client.accessTokenUri}&quot;)\r\n    private String TOKEN_URI;\r\n    @Value(&quot;${application.termineRegional.baseUrl}&quot;)\r\n    private String API_URL;\r\n    @Value(&quot;${security.oauth2.client.clientId}&quot;)\r\n    private String CLIENT_ID;\r\n    @Value(&quot;${security.oauth2.client.clientSecret}&quot;)\r\n    private String CLIENT_SECRET;\r\n    @Value(&quot;${security.oauth2.client.grantType}&quot;)\r\n    private String GRANT_TYPE;\r\n    \r\n    public List&lt;Event&gt; getEvents() throws IOException, InterruptedException {\r\n        String token = getToken();\r\n        HttpClient client = HttpClient.newHttpClient();\r\n        HttpRequest request = HttpRequest.newBuilder()\r\n                .uri(URI.create(API_URL))\r\n                .header(&quot;Authorization&quot;, &quot;Bearer &quot; + token)\r\n                .build();\r\n        HttpResponse&lt;String&gt; response = client.send(request, HttpResponse.BodyHandlers.ofString());\r\n        ObjectMapper mapper = new ObjectMapper()\r\n                .configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\r\n        return mapper.readValue(response.body(), mapper.getTypeFactory().constructCollectionType(List.class, Event.class));\r\n    }\r\n\r\n    public String getToken() throws IOException, InterruptedException {\r\n        HttpClient client = HttpClient.newHttpClient();\r\n        HttpRequest request = HttpRequest.newBuilder()\r\n                .uri(URI.create(TOKEN_URI))\r\n                .header(&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;)\r\n                .header(&quot;Accept&quot;, &quot;application/json&quot;)\r\n                .POST(HttpRequest.BodyPublishers.ofString(&quot;client_id=&quot; + CLIENT_ID + &quot;&amp;client_secret=&quot; + CLIENT_SECRET + &quot;&amp;grant_type=&quot; + GRANT_TYPE))\r\n                .build();\r\n        HttpResponse&lt;String&gt; response = client.send(request, HttpResponse.BodyHandlers.ofString());\r\n        //bind response to Authentication object\r\n        ObjectMapper mapper = new ObjectMapper();\r\n        return mapper.readValue(response.body(), Authentication.class).getAccess_token();\r\n    }","title":"&quot;java.net.ConnectException: null&quot; for no apparent reason after some changes","body":"<p>I am connecting to an oAuth server to get the security Token in order to access a API I'm using. At first I had the following class, with the parameters hard-coded:</p>\n<pre><code>public class TermineApiClient {\npublic static final String TOKEN_URI = &quot;https://testapi.de/oauth/v2/token&quot;;\npublic static final String API_URL = &quot;https://testapi.de/clients/2/events?startDate=2021-04-30&quot;;\npublic static final String CLIENT_ID = &quot;5544zj80ghcs0o8g&quot;;\npublic static final String CLIENT_SECRET = &quot;5pp5dn48k9s&quot;;\npublic static final String GRANT_TYPE = &quot;client_credentials&quot;;\n</code></pre>\n<p>Then I called the server with the following function and it was all working just fine:</p>\n<pre><code>    public static String getToken() throws IOException, InterruptedException {\n    HttpClient client = HttpClient.newHttpClient();\n    HttpRequest request = HttpRequest.newBuilder()\n            .uri(URI.create(TOKEN_URI))\n            .header(&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;)\n            .header(&quot;Accept&quot;, &quot;application/json&quot;)\n            .POST(HttpRequest.BodyPublishers.ofString(&quot;client_id=&quot; + CLIENT_ID + &quot;&amp;client_secret=&quot; + CLIENT_SECRET + &quot;&amp;grant_type=&quot; + GRANT_TYPE))\n            .build();\n    HttpResponse&lt;String&gt; response = client.send(request, HttpResponse.BodyHandlers.ofString());\n    //bind response to Authentication object\n    ObjectMapper mapper = new ObjectMapper();\n    return mapper.readValue(response.body(), Authentication.class).getAccess_token();\n}\n</code></pre>\n<p>But since I don't want my parameters hard-coded I made some changes to the class to get them from the <strong>application.yml</strong> file, leaving the class like that:</p>\n<pre><code>@Component\npublic class TermineApiClient {\npublic static String TOKEN_URI;\npublic static String API_URL;\npublic static String CLIENT_ID;\npublic static String CLIENT_SECRET;\npublic static String GRANT_TYPE;\n\n@Value(&quot;${security.oauth2.client.accessTokenUri}&quot;)\npublic void setTokenUri(String accessTokenUri){\n    TermineApiClient.TOKEN_URI = accessTokenUri;\n}\n@Value(&quot;${application.termineRegional.baseUrl}&quot;)\npublic void setApiUrl(String apiUrl){\n    TermineApiClient.API_URL = apiUrl;\n}\n@Value(&quot;${security.oauth2.client.clientId}&quot;)\npublic void setClientId(String clientId){\n    TermineApiClient.CLIENT_ID = clientId;\n}\n@Value(&quot;${security.oauth2.client.clientSecret}&quot;)\npublic void setClientSecret(String clientSecret){\n    TermineApiClient.CLIENT_SECRET = clientSecret;\n}\n@Value(&quot;${security.oauth2.client.grantType}&quot;)\npublic void setGrantType(String grantType){\n    TermineApiClient.GRANT_TYPE = grantType;\n}\n</code></pre>\n<p>And it's weird that now it simply doesn't work anymore, even though there is no problem in getting the parameters. Whenever it gets to this line <code>HttpResponse&lt;String&gt; response = client.send(request, HttpResponse.BodyHandlers.ofString());</code> it throws a <strong>ConnectException: null</strong></p>\n<p>Stacktrace:</p>\n<pre><code>java.net.ConnectException: null\nat java.net.http/jdk.internal.net.http.HttpClientImpl.send(HttpClientImpl.java:571) ~[java.net.http:na]\nat java.net.http/jdk.internal.net.http.HttpClientFacade.send(HttpClientFacade.java:123) ~[java.net.http:na]\nat com.events.termineapi.Client.TermineApiClient.getToken(TermineApiClient.java:69) ~[classes/:na]\nat com.events.termineapi.Client.TermineApiClient.getEvents(TermineApiClient.java:49) ~[classes/:na]\nat com.events.termineapi.Controller.EventsController.getEvents(EventsController.java:17) ~[classes/:na]\nat java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]\nat java.base/java.lang.reflect.Method.invoke(Method.java:577) ~[na:na]\nat org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.19.jar:5.3.19]\nat org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.19.jar:5.3.19]\nat org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.19.jar:5.3.19]\nat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.19.jar:5.3.19]\nat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.19.jar:5.3.19]\nat org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.19.jar:5.3.19]\nat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1067) ~[spring-webmvc-5.3.19.jar:5.3.19]\nat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) ~[spring-webmvc-5.3.19.jar:5.3.19]\nat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.19.jar:5.3.19]\nat org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898) ~[spring-webmvc-5.3.19.jar:5.3.19]\nat javax.servlet.http.HttpServlet.service(HttpServlet.java:655) ~[tomcat-embed-core-9.0.62.jar:4.0.FR]\nat org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.19.jar:5.3.19]\nat javax.servlet.http.HttpServlet.service(HttpServlet.java:764) ~[tomcat-embed-core-9.0.62.jar:4.0.FR]\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.62.jar:9.0.62]\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.19.jar:5.3.19]\nat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.19.jar:5.3.19]\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.19.jar:5.3.19]\nat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.19.jar:5.3.19]\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.19.jar:5.3.19]\nat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.19.jar:5.3.19]\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:360) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:890) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1743) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.62.jar:9.0.62]\nat java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]\n\nCaused by: java.net.ConnectException: null\nat java.net.http/jdk.internal.net.http.common.Utils.toConnectException(Utils.java:1045) ~[java.net.http:na]\nat java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:198) ~[java.net.http:na]\nat java.net.http/jdk.internal.net.http.AsyncSSLConnection.connectAsync(AsyncSSLConnection.java:56) ~[java.net.http:na]\nat java.net.http/jdk.internal.net.http.Http2Connection.createAsync(Http2Connection.java:378) ~[java.net.http:na]\nat java.net.http/jdk.internal.net.http.Http2ClientImpl.getConnectionFor(Http2ClientImpl.java:128) ~[java.net.http:na]\nat java.net.http/jdk.internal.net.http.ExchangeImpl.get(ExchangeImpl.java:93) ~[java.net.http:na]\nat java.net.http/jdk.internal.net.http.Exchange.establishExchange(Exchange.java:343) ~[java.net.http:na]\nat java.net.http/jdk.internal.net.http.Exchange.responseAsyncImpl0(Exchange.java:475) ~[java.net.http:na]\nat java.net.http/jdk.internal.net.http.Exchange.responseAsyncImpl(Exchange.java:380) ~[java.net.http:na]\nat java.net.http/jdk.internal.net.http.Exchange.responseAsync(Exchange.java:372) ~[java.net.http:na]\nat java.net.http/jdk.internal.net.http.MultiExchange.responseAsyncImpl(MultiExchange.java:408) ~[java.net.http:na]\nat java.net.http/jdk.internal.net.http.MultiExchange.lambda$responseAsyncImpl$7(MultiExchange.java:449) ~[java.net.http:na]\nat java.base/java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:934) ~[na:na]\nat java.base/java.util.concurrent.CompletableFuture.uniHandleStage(CompletableFuture.java:950) ~[na:na]\nat java.base/java.util.concurrent.CompletableFuture.handle(CompletableFuture.java:2340) ~[na:na]\nat java.net.http/jdk.internal.net.http.MultiExchange.responseAsyncImpl(MultiExchange.java:439) ~[java.net.http:na]\nat java.net.http/jdk.internal.net.http.MultiExchange.lambda$responseAsync0$2(MultiExchange.java:341) ~[java.net.http:na]\nat java.base/java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1150) ~[na:na]\nat java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[na:na]\nat java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1773) ~[na:na]\nat java.net.http/jdk.internal.net.http.HttpClientImpl$DelegatingExecutor.execute(HttpClientImpl.java:155) ~[java.net.http:na]\nat java.base/java.util.concurrent.CompletableFuture.completeAsync(CompletableFuture.java:2673) ~[na:na]\nat java.net.http/jdk.internal.net.http.MultiExchange.responseAsync(MultiExchange.java:294) ~[java.net.http:na]\nat java.net.http/jdk.internal.net.http.HttpClientImpl.sendAsync(HttpClientImpl.java:652) ~[java.net.http:na]\nat java.net.http/jdk.internal.net.http.HttpClientImpl.send(HttpClientImpl.java:550) ~[java.net.http:na]\n... 52 common frames omitted\n\nCaused by: java.nio.channels.UnresolvedAddressException: null\nat java.base/sun.nio.ch.Net.checkAddress(Net.java:149) ~[na:na]\nat java.base/sun.nio.ch.Net.checkAddress(Net.java:157) ~[na:na]\nat java.base/sun.nio.ch.SocketChannelImpl.checkRemote(SocketChannelImpl.java:816) ~[na:na]\nat java.base/sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:839) ~[na:na]\nat java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$0(PlainHttpConnection.java:183) ~[java.net.http:na]\nat java.base/java.security.AccessController.doPrivileged(AccessController.java:569) ~[na:na]\nat java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:185) ~[java.net.http:na]\n... 75 common frames omitted\n</code></pre>\n<p><strong>Please, could anyone help me? It looks like such a silly problem, and I'm stuck. Thanks!!!</strong></p>\n<p><strong>EDIT:</strong></p>\n<p>Here's the .yml file and changed the static properties to non-static</p>\n<pre><code>application:\n  termineRegional:\n    baseUrl: https://testapi.de/clients/2/events?startDate=2021-04-30\n\nsecurity:\n  oauth2:\n    client:\n      grantType: client_credentials\n      clientId: 5544zj80ghcs0\n      clientSecret: 5pp5dn48\n      accessTokenUri: https://testapi.de/oauth/v2/token\n\nspring:\n  autoconfigure:\n    exclude[0]: org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration\n    exclude[1]: org.springframework.boot.actuate.autoconfigure.security.servlet.ManagementWebSecurityAutoConfiguration\n</code></pre>\n<p>@Component\npublic class TermineApiClient {</p>\n<pre><code>@Value(&quot;${security.oauth2.client.accessTokenUri}&quot;)\nprivate String TOKEN_URI;\n@Value(&quot;${application.termineRegional.baseUrl}&quot;)\nprivate String API_URL;\n@Value(&quot;${security.oauth2.client.clientId}&quot;)\nprivate String CLIENT_ID;\n@Value(&quot;${security.oauth2.client.clientSecret}&quot;)\nprivate String CLIENT_SECRET;\n@Value(&quot;${security.oauth2.client.grantType}&quot;)\nprivate String GRANT_TYPE;\n\npublic List&lt;Event&gt; getEvents() throws IOException, InterruptedException {\n    String token = getToken();\n    HttpClient client = HttpClient.newHttpClient();\n    HttpRequest request = HttpRequest.newBuilder()\n            .uri(URI.create(API_URL))\n            .header(&quot;Authorization&quot;, &quot;Bearer &quot; + token)\n            .build();\n    HttpResponse&lt;String&gt; response = client.send(request, HttpResponse.BodyHandlers.ofString());\n    ObjectMapper mapper = new ObjectMapper()\n            .configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n    return mapper.readValue(response.body(), mapper.getTypeFactory().constructCollectionType(List.class, Event.class));\n}\n\npublic String getToken() throws IOException, InterruptedException {\n    HttpClient client = HttpClient.newHttpClient();\n    HttpRequest request = HttpRequest.newBuilder()\n            .uri(URI.create(TOKEN_URI))\n            .header(&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;)\n            .header(&quot;Accept&quot;, &quot;application/json&quot;)\n            .POST(HttpRequest.BodyPublishers.ofString(&quot;client_id=&quot; + CLIENT_ID + &quot;&amp;client_secret=&quot; + CLIENT_SECRET + &quot;&amp;grant_type=&quot; + GRANT_TYPE))\n            .build();\n    HttpResponse&lt;String&gt; response = client.send(request, HttpResponse.BodyHandlers.ofString());\n    //bind response to Authentication object\n    ObjectMapper mapper = new ObjectMapper();\n    return mapper.readValue(response.body(), Authentication.class).getAccess_token();\n}\n</code></pre>\n"},{"tags":["java","unit-testing","junit","junit5"],"comments":[{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":0,"creation_date":1656335087,"post_id":72772575,"comment_id":128539311,"body_markdown":"What would you be testing? That those getters indeed return something?","body":"What would you be testing? That those getters indeed return something?"},{"owner":{"account_id":682692,"reputation":49061,"user_id":535275,"accept_rate":91,"display_name":"Scott Hunter"},"score":0,"creation_date":1656335092,"post_id":72772575,"comment_id":128539315,"body_markdown":"You forgot to post your attempt, and explain what problem(s) you are having with it.","body":"You forgot to post your attempt, and explain what problem(s) you are having with it."},{"owner":{"account_id":3116234,"reputation":9296,"user_id":2636929,"display_name":"Stultuske"},"score":0,"creation_date":1656335127,"post_id":72772575,"comment_id":128539330,"body_markdown":"it&#39;s pretty pointless to test setters or getters, since they don&#39;t really impact the data, they just &#39;pass&#39; it.","body":"it&#39;s pretty pointless to test setters or getters, since they don&#39;t really impact the data, they just &#39;pass&#39; it."},{"owner":{"account_id":19485028,"reputation":3,"user_id":19198466,"display_name":"venus"},"score":0,"creation_date":1656335293,"post_id":72772575,"comment_id":128539401,"body_markdown":"Sorry guys. But I was told just make sure the getters work. The unit test should do this. =(","body":"Sorry guys. But I was told just make sure the getters work. The unit test should do this. =("},{"owner":{"account_id":19485028,"reputation":3,"user_id":19198466,"display_name":"venus"},"score":0,"creation_date":1656335380,"post_id":72772575,"comment_id":128539445,"body_markdown":"@Stultuske i totally agree! but I received such a task - I need to do it for practice.","body":"@Stultuske i totally agree! but I received such a task - I need to do it for practice."},{"owner":{"account_id":3116234,"reputation":9296,"user_id":2636929,"display_name":"Stultuske"},"score":0,"creation_date":1656335387,"post_id":72772575,"comment_id":128539447,"body_markdown":"ok. run a get and check that it returns a new, empty map/..","body":"ok. run a get and check that it returns a new, empty map/.."},{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":0,"creation_date":1656335392,"post_id":72772575,"comment_id":128539452,"body_markdown":"@venus is this homework or a real world setting? Because in the first case you could assert that `getStack` returns a `Dequeue`, for example. If it is for work, ask whoever told you to test this class what they want tested here.","body":"@venus is this homework or a real world setting? Because in the first case you could assert that <code>getStack</code> returns a <code>Dequeue</code>, for example. If it is for work, ask whoever told you to test this class what they want tested here."},{"owner":{"account_id":19485028,"reputation":3,"user_id":19198466,"display_name":"venus"},"score":0,"creation_date":1656335839,"post_id":72772575,"comment_id":128539635,"body_markdown":"@FedericoklezCulloca I am now being taught to write tests more deeply for new project. i am so so so junior dev. they said that even such code can be tested. I don&#39;t know how to write correctly, because I haven&#39;t tested such empty classes. I apologize if this seems like a trifle.","body":"@FedericoklezCulloca I am now being taught to write tests more deeply for new project. i am so so so junior dev. they said that even such code can be tested. I don&#39;t know how to write correctly, because I haven&#39;t tested such empty classes. I apologize if this seems like a trifle."},{"owner":{"account_id":318670,"reputation":15681,"user_id":636009,"display_name":"David Conrad"},"score":0,"creation_date":1656336413,"post_id":72772575,"comment_id":128539900,"body_markdown":"I would not be writing or testing getters and setters. Use Lombok to generate them. It can also annotate them so they won&#39;t be counted in code coverage.","body":"I would not be writing or testing getters and setters. Use Lombok to generate them. It can also annotate them so they won&#39;t be counted in code coverage."}],"answers":[{"tags":[],"owner":{"account_id":1435086,"reputation":4492,"user_id":2323964,"accept_rate":87,"display_name":"Novaterata"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1656335479,"creation_date":1656335479,"answer_id":72772698,"question_id":72772575,"body_markdown":"You get each property and add something to their collection\r\n\r\nThen get each property again and verify that what you added is still there","title":"Junit Test of Getters. How can I write it","body":"<p>You get each property and add something to their collection</p>\n<p>Then get each property again and verify that what you added is still there</p>\n"}],"owner":{"account_id":19485028,"reputation":3,"user_id":19198466,"display_name":"venus"},"comment_count":9,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":101,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"accepted_answer_id":72772698,"answer_count":1,"score":-1,"last_activity_date":1656335479,"creation_date":1656335010,"question_id":72772575,"body_markdown":"I have a class:\r\n\r\n    public final class Core {\r\n        private final Deque&lt;Double&gt; stack = new ArrayDeque&lt;&gt;();\r\n        private final HashMap&lt;String, Double&gt; values = new HashMap&lt;&gt;();\r\n    \r\n        public Deque&lt;Double&gt; getStack() {\r\n            return stack;\r\n        }\r\n    \r\n        public HashMap&lt;String, Double&gt; getValues() {\r\n            return values;\r\n        }\r\n    }\r\n\r\nI need a Junit test for this getters, but I don&#39;t know how to write it correctly","title":"Junit Test of Getters. How can I write it","body":"<p>I have a class:</p>\n<pre><code>public final class Core {\n    private final Deque&lt;Double&gt; stack = new ArrayDeque&lt;&gt;();\n    private final HashMap&lt;String, Double&gt; values = new HashMap&lt;&gt;();\n\n    public Deque&lt;Double&gt; getStack() {\n        return stack;\n    }\n\n    public HashMap&lt;String, Double&gt; getValues() {\n        return values;\n    }\n}\n</code></pre>\n<p>I need a Junit test for this getters, but I don't know how to write it correctly</p>\n"},{"tags":["java","reference"],"comments":[{"owner":{"account_id":119097,"reputation":85328,"user_id":310574,"accept_rate":80,"display_name":"Gabe"},"score":3,"creation_date":1300328752,"post_id":5334137,"comment_id":6021805,"body_markdown":"Reference counts aren&#39;t tracked in a JVM. The only way to know is to count them.","body":"Reference counts aren&#39;t tracked in a JVM. The only way to know is to count them."},{"owner":{"account_id":1096275,"reputation":2681,"user_id":1089811,"display_name":"R.daneel.olivaw"},"score":1,"creation_date":1386912487,"post_id":5334137,"comment_id":30749186,"body_markdown":"There is a library that can be used to get notification when an object is garbage collected. Please refer to this link for more details http://sourceforge.net/projects/gcradar/","body":"There is a library that can be used to get notification when an object is garbage collected. Please refer to this link for more details <a href=\"http://sourceforge.net/projects/gcradar/\" rel=\"nofollow noreferrer\">sourceforge.net/projects/gcradar</a>"},{"owner":{"account_id":8226935,"reputation":313,"user_id":6188955,"accept_rate":25,"display_name":"Siddappa Walake"},"score":0,"creation_date":1535540839,"post_id":5334137,"comment_id":91101482,"body_markdown":"Java has no such provision for counting/getting list of references to an Object. Allowing this could be a serious issue as anyone can finalize the object even if someones code overlying on it is still in need of it.","body":"Java has no such provision for counting/getting list of references to an Object. Allowing this could be a serious issue as anyone can finalize the object even if someones code overlying on it is still in need of it."}],"answers":[{"tags":[],"owner":{"account_id":332610,"reputation":1751,"user_id":658011,"accept_rate":25,"display_name":"dLobatog"},"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1300328943,"creation_date":1300328943,"answer_id":5334219,"question_id":5334137,"body_markdown":"Java doesn&#39;t offer this option natively as far as I know. \r\n\r\nHere you have some guidance on how to do it manually:\r\n\r\n\r\n  http://www.velocityreviews.com/forums/t363649-how-do-i-get-a-reference-count-of-a-object-in-java.html","title":"Is it possible to get the object reference count?","body":"<p>Java doesn't offer this option natively as far as I know. </p>\n\n<p>Here you have some guidance on how to do it manually:</p>\n\n<p><a href=\"http://www.velocityreviews.com/forums/t363649-how-do-i-get-a-reference-count-of-a-object-in-java.html\" rel=\"noreferrer\">http://www.velocityreviews.com/forums/t363649-how-do-i-get-a-reference-count-of-a-object-in-java.html</a></p>\n"},{"tags":[],"owner":{"account_id":271547,"reputation":5692,"user_id":562139,"accept_rate":75,"display_name":"scorpiodawg"},"down_vote_count":0,"up_vote_count":17,"is_accepted":false,"score":17,"last_activity_date":1627645757,"creation_date":1312446032,"answer_id":6938232,"question_id":5334137,"body_markdown":"From your description, it seems you care less about the actual count of references than to simply know when an object has been collected. If this is the case, you can use `WeakReference` or `PhantomReference` to determine when a referenced object is ready for finalization.\r\n\r\nSee:\r\n\r\n- Javadoc for `WeakReference`: http://download.oracle.com/javase/6/docs/api/java/lang/ref/WeakReference.html\r\n- Javadoc for `PhantomReference`: http://download.oracle.com/javase/6/docs/api/java/lang/ref/PhantomReference.html\r\n- A great explanation of weak references: https://community.oracle.com/blogs/enicholas/2006/05/04/understanding-weak-references\r\n- Garbage collector callbacks: http://java.dzone.com/articles/letting-garbage-collector-do-c\r\n- https://stackoverflow.com/questions/2057792/garbage-collection-notification\r\n","title":"Is it possible to get the object reference count?","body":"<p>From your description, it seems you care less about the actual count of references than to simply know when an object has been collected. If this is the case, you can use <code>WeakReference</code> or <code>PhantomReference</code> to determine when a referenced object is ready for finalization.</p>\n<p>See:</p>\n<ul>\n<li>Javadoc for <code>WeakReference</code>: <a href=\"http://download.oracle.com/javase/6/docs/api/java/lang/ref/WeakReference.html\" rel=\"nofollow noreferrer\">http://download.oracle.com/javase/6/docs/api/java/lang/ref/WeakReference.html</a></li>\n<li>Javadoc for <code>PhantomReference</code>: <a href=\"http://download.oracle.com/javase/6/docs/api/java/lang/ref/PhantomReference.html\" rel=\"nofollow noreferrer\">http://download.oracle.com/javase/6/docs/api/java/lang/ref/PhantomReference.html</a></li>\n<li>A great explanation of weak references: <a href=\"https://community.oracle.com/blogs/enicholas/2006/05/04/understanding-weak-references\" rel=\"nofollow noreferrer\">https://community.oracle.com/blogs/enicholas/2006/05/04/understanding-weak-references</a></li>\n<li>Garbage collector callbacks: <a href=\"http://java.dzone.com/articles/letting-garbage-collector-do-c\" rel=\"nofollow noreferrer\">http://java.dzone.com/articles/letting-garbage-collector-do-c</a></li>\n<li><a href=\"https://stackoverflow.com/questions/2057792/garbage-collection-notification\">Garbage collection notification?</a></li>\n</ul>\n"},{"tags":[],"owner":{"account_id":11944756,"reputation":7873,"user_id":8740349,"display_name":"Top-Master"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656335273,"creation_date":1652084405,"answer_id":72168923,"question_id":5334137,"body_markdown":"# Java is NOT reference-counting\r\nAnd we simply can **not** get something which does not exist.\r\n\r\nSee similar Q/A,  \r\nwhich explains why reference recursion does **not** cause memory-leak:  \r\nhttps://stackoverflow.com/a/72167978/8740349\r\n\r\nSee Javadoc for `PhantomReference` class:  \r\ndownload.oracle.com/[javase/6/docs/api/java/lang/ref/PhantomReference.](http://download.oracle.com/javase/6/docs/api/java/lang/ref/PhantomReference.html)\r\n\r\nAlso, there is a library which can notify you when an object is garbage collected:  \r\nhttps://sourceforge.net/projects/gcradar","title":"Is it possible to get the object reference count?","body":"<h1>Java is NOT reference-counting</h1>\n<p>And we simply can <strong>not</strong> get something which does not exist.</p>\n<p>See similar Q/A,<br />\nwhich explains why reference recursion does <strong>not</strong> cause memory-leak:<br />\n<a href=\"https://stackoverflow.com/a/72167978/8740349\">https://stackoverflow.com/a/72167978/8740349</a></p>\n<p>See Javadoc for <code>PhantomReference</code> class:<br />\ndownload.oracle.com/<a href=\"http://download.oracle.com/javase/6/docs/api/java/lang/ref/PhantomReference.html\" rel=\"nofollow noreferrer\">javase/6/docs/api/java/lang/ref/PhantomReference.</a></p>\n<p>Also, there is a library which can notify you when an object is garbage collected:<br />\n<a href=\"https://sourceforge.net/projects/gcradar\" rel=\"nofollow noreferrer\">https://sourceforge.net/projects/gcradar</a></p>\n"}],"owner":{"account_id":269137,"reputation":593,"user_id":558299,"display_name":"Sergio"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":28290,"favorite_count":0,"down_vote_count":0,"up_vote_count":38,"answer_count":3,"score":38,"last_activity_date":1656335273,"creation_date":1300328230,"question_id":5334137,"body_markdown":"I&#39;d like to know if there is a way to check how many references a Java object has. As far as I could check the only way to do that is using JVMTI through a JNI interface. Is there a pure Java (without using native libraries) solution to get this information?\r\n\r\nWe are developing an educational tool for data structure animation(to be used with students implementation of certain algorithms), so it would be very nice if we could check for &quot;released&quot; objects on the most non-intrusive way (I&#39;m trying to avoid forcing the user of this tool to call a method such as `objectReleased(objRef)` in order to update the data structure animation for an element removal or something similar).","title":"Is it possible to get the object reference count?","body":"<p>I'd like to know if there is a way to check how many references a Java object has. As far as I could check the only way to do that is using JVMTI through a JNI interface. Is there a pure Java (without using native libraries) solution to get this information?</p>\n<p>We are developing an educational tool for data structure animation(to be used with students implementation of certain algorithms), so it would be very nice if we could check for &quot;released&quot; objects on the most non-intrusive way (I'm trying to avoid forcing the user of this tool to call a method such as <code>objectReleased(objRef)</code> in order to update the data structure animation for an element removal or something similar).</p>\n"},{"tags":["java","javafx"],"comments":[{"owner":{"account_id":70123,"reputation":51175,"user_id":203657,"accept_rate":53,"display_name":"kleopatra"},"score":0,"creation_date":1656333761,"post_id":72771871,"comment_id":128538769,"body_markdown":"can you add a screenshot of your application?","body":"can you add a screenshot of your application?"},{"owner":{"account_id":12870591,"reputation":73,"user_id":9309191,"display_name":"cybertschunk"},"score":0,"creation_date":1656334634,"post_id":72771871,"comment_id":128539136,"body_markdown":"Yeah for sure. I added two screenshots explaining my problem.","body":"Yeah for sure. I added two screenshots explaining my problem."},{"owner":{"account_id":2518243,"reputation":203472,"user_id":2189127,"display_name":"James_D"},"score":3,"creation_date":1656338163,"post_id":72771871,"comment_id":128540640,"body_markdown":"I&#39;m guessing that font is making excessive use of the descent, which it making the glyphs essentially occupy space primarily in the bottom of the space allocated to each of them. Try experimenting with the alignment of the button, e.g. set it to `BASELINE_CENTER` or `BOTTOM_CENTER`","body":"I&#39;m guessing that font is making excessive use of the descent, which it making the glyphs essentially occupy space primarily in the bottom of the space allocated to each of them. Try experimenting with the alignment of the button, e.g. set it to <code>BASELINE_CENTER</code> or <code>BOTTOM_CENTER</code>"},{"owner":{"account_id":70123,"reputation":51175,"user_id":203657,"accept_rate":53,"display_name":"kleopatra"},"score":3,"creation_date":1656345270,"post_id":72771871,"comment_id":128543606,"body_markdown":"thanks for the screenshots :) agree with @James_D - it&#39;s probably the excentric font not fx that&#39;s messing up","body":"thanks for the screenshots :) agree with @James_D - it&#39;s probably the excentric font not fx that&#39;s messing up"},{"owner":{"account_id":12870591,"reputation":73,"user_id":9309191,"display_name":"cybertschunk"},"score":0,"creation_date":1656406093,"post_id":72771871,"comment_id":128557977,"body_markdown":"Alright. We will go with a different font then. Thanks for your input!","body":"Alright. We will go with a different font then. Thanks for your input!"}],"owner":{"account_id":12870591,"reputation":73,"user_id":9309191,"display_name":"cybertschunk"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":72,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"answer_count":0,"score":3,"last_activity_date":1656334608,"creation_date":1656331797,"question_id":72771871,"body_markdown":"I want to use the &quot;[Another Danger][1]&quot; font in my project. However JavaFX isn&#39;t quite liking it. Labels and buttons seem to estimate the height of the letters wrong and take a completely wrong size.\r\n\r\nI wrote a simple example illustrating the problem:\r\n\r\n    public class HelloApplication extends Application {\r\n    public static void main(String[] args) {\r\n        launch();\r\n    }\r\n\r\n    @Override\r\n    public void start(Stage stage) {\r\n        Button button = new Button(&quot;Test&quot;);\r\n        Scene scene = new Scene(button, 320, 240);\r\n        button.setFont(Font.loadFont(HelloApplication.class.getResourceAsStream(&quot;/fonts/AnotherDanger-Demo.otf&quot;), 30));\r\n        stage.setTitle(&quot;Hello!&quot;);\r\n        stage.setScene(scene);\r\n        stage.show();\r\n    }\r\n    }\r\n\r\nThe text in the button is clearly not centered. However, when I remove the custom font everything works perfectly. Is  this a problem with the font? And if so is there any way to fix this?\r\n\r\nI&#39;d be very thankful for any help here.\r\n\r\nEDIT: Here are screeshots as requested:\r\n\r\nWith the font: \r\n\r\n[![enter image description here][2]][2]\r\n\r\nWithout the font: \r\n\r\n[![enter image description here][3]][3]\r\n\r\n\r\n  [1]: https://fontsme.com/another-danger.font\r\n  [2]: https://i.stack.imgur.com/ZKMAN.png\r\n  [3]: https://i.stack.imgur.com/YDsIG.png","title":"JavaFX: Text in button not centered when using custom font","body":"<p>I want to use the &quot;<a href=\"https://fontsme.com/another-danger.font\" rel=\"nofollow noreferrer\">Another Danger</a>&quot; font in my project. However JavaFX isn't quite liking it. Labels and buttons seem to estimate the height of the letters wrong and take a completely wrong size.</p>\n<p>I wrote a simple example illustrating the problem:</p>\n<pre><code>public class HelloApplication extends Application {\npublic static void main(String[] args) {\n    launch();\n}\n\n@Override\npublic void start(Stage stage) {\n    Button button = new Button(&quot;Test&quot;);\n    Scene scene = new Scene(button, 320, 240);\n    button.setFont(Font.loadFont(HelloApplication.class.getResourceAsStream(&quot;/fonts/AnotherDanger-Demo.otf&quot;), 30));\n    stage.setTitle(&quot;Hello!&quot;);\n    stage.setScene(scene);\n    stage.show();\n}\n}\n</code></pre>\n<p>The text in the button is clearly not centered. However, when I remove the custom font everything works perfectly. Is  this a problem with the font? And if so is there any way to fix this?</p>\n<p>I'd be very thankful for any help here.</p>\n<p>EDIT: Here are screeshots as requested:</p>\n<p>With the font:</p>\n<p><a href=\"https://i.stack.imgur.com/ZKMAN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZKMAN.png\" alt=\"enter image description here\" /></a></p>\n<p>Without the font:</p>\n<p><a href=\"https://i.stack.imgur.com/YDsIG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YDsIG.png\" alt=\"enter image description here\" /></a></p>\n"},{"tags":["java","android","opengl-es"],"owner":{"account_id":23636574,"reputation":31,"user_id":17667525,"display_name":"Shri Hari"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":161,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1656334581,"creation_date":1656325782,"question_id":72770591,"body_markdown":"I need to copy the texture to a framebuffer and then read it using GlReadPixels and save the output to a buffer. The main goal is to dump the input frames of exoplayer into a file. My current code gives me glx506 error. \r\n\r\n    int[] frame = new int[1];\r\n    int[] mainFrame = new int[1];\r\n    glGetIntegerv(GLES32.GL_FRAMEBUFFER_BINDING, mainFrame,0);\r\n\r\n    GLES32.glGenFramebuffers(1,frame,0);\r\n    GlUtil.checkGlError(&quot;glGenFramebufferOES&quot;);\r\n\r\n    GLES11Ext.glBindFramebufferOES(GLES11Ext.GL_FRAMEBUFFER_OES, frame[0]);\r\n    GlUtil.checkGlError(&quot;glBindFramebufferOES&quot;);\r\n\r\n    GLES11Ext.glFramebufferTexture2DOES(GLES11Ext.GL_FRAMEBUFFER_OES,GLES11Ext.GL_COLOR_ATTACHMENT0_OES, GLES32.GL_TEXTURE_2D, texture,0);\r\n    GlUtil.checkGlError(&quot;glFramebufferTexture2DOES&quot;);\r\n\r\n    GLES11Ext.glBindFramebufferOES(GLES11Ext.GL_FRAMEBUFFER_OES, frame[0]);\r\n    GlUtil.checkGlError(&quot;glBindFramebufferOES&quot;);\r\n\r\n    GLES32.glViewport(0, 0, width, height);\r\n    GlUtil.checkGlError(&quot;glViewport&quot;);\r\n\r\n\r\n    ByteBuffer buffer = ByteBuffer.allocateDirect(width * height * 4);\r\n\r\n    GLES32.glReadPixels(0, 0, width, height, GLES32.GL_RGBA,GLES32.GL_UNSIGNED_BYTE, buffer);\r\n    GlUtil.checkGlError(&quot;glReadPixels&quot;);\r\n\r\n    File file = new File(&quot;/sdcard/Movies/frames/input_&quot;+mediaTime+&quot;.rgba&quot;);\r\n    try {\r\n      FileOutputStream fos = new FileOutputStream(file.toString());\r\n      FileChannel fch = fos.getChannel();\r\n      fch.write(buffer);\r\n      fch.close();\r\n      fos.close();\r\n    } catch (FileNotFoundException e) {\r\n      e.printStackTrace();\r\n    } catch (IOException e) {\r\n      e.printStackTrace();\r\n    }\r\n    Log.d(TAG, &quot;Saved input frame : Dimensions : &quot; + width + &quot;x&quot; + height + &quot; Frame saved as &#39;&quot; + file + &quot;&#39;&quot;);\r\n\r\n    GLES11Ext.glBindFramebufferOES(GLES11Ext.GL_FRAMEBUFFER_OES, mainFrame[0]);\r\n    GLES32.glViewport(0, 0, mWindowSurface.getWidth(), mWindowSurface.getHeight());","title":"How to copy a OpenGL External Texture (GL_TEXTURE_EXTERNAL_OES) to a Framebuffer","body":"<p>I need to copy the texture to a framebuffer and then read it using GlReadPixels and save the output to a buffer. The main goal is to dump the input frames of exoplayer into a file. My current code gives me glx506 error.</p>\n<pre><code>int[] frame = new int[1];\nint[] mainFrame = new int[1];\nglGetIntegerv(GLES32.GL_FRAMEBUFFER_BINDING, mainFrame,0);\n\nGLES32.glGenFramebuffers(1,frame,0);\nGlUtil.checkGlError(&quot;glGenFramebufferOES&quot;);\n\nGLES11Ext.glBindFramebufferOES(GLES11Ext.GL_FRAMEBUFFER_OES, frame[0]);\nGlUtil.checkGlError(&quot;glBindFramebufferOES&quot;);\n\nGLES11Ext.glFramebufferTexture2DOES(GLES11Ext.GL_FRAMEBUFFER_OES,GLES11Ext.GL_COLOR_ATTACHMENT0_OES, GLES32.GL_TEXTURE_2D, texture,0);\nGlUtil.checkGlError(&quot;glFramebufferTexture2DOES&quot;);\n\nGLES11Ext.glBindFramebufferOES(GLES11Ext.GL_FRAMEBUFFER_OES, frame[0]);\nGlUtil.checkGlError(&quot;glBindFramebufferOES&quot;);\n\nGLES32.glViewport(0, 0, width, height);\nGlUtil.checkGlError(&quot;glViewport&quot;);\n\n\nByteBuffer buffer = ByteBuffer.allocateDirect(width * height * 4);\n\nGLES32.glReadPixels(0, 0, width, height, GLES32.GL_RGBA,GLES32.GL_UNSIGNED_BYTE, buffer);\nGlUtil.checkGlError(&quot;glReadPixels&quot;);\n\nFile file = new File(&quot;/sdcard/Movies/frames/input_&quot;+mediaTime+&quot;.rgba&quot;);\ntry {\n  FileOutputStream fos = new FileOutputStream(file.toString());\n  FileChannel fch = fos.getChannel();\n  fch.write(buffer);\n  fch.close();\n  fos.close();\n} catch (FileNotFoundException e) {\n  e.printStackTrace();\n} catch (IOException e) {\n  e.printStackTrace();\n}\nLog.d(TAG, &quot;Saved input frame : Dimensions : &quot; + width + &quot;x&quot; + height + &quot; Frame saved as '&quot; + file + &quot;'&quot;);\n\nGLES11Ext.glBindFramebufferOES(GLES11Ext.GL_FRAMEBUFFER_OES, mainFrame[0]);\nGLES32.glViewport(0, 0, mWindowSurface.getWidth(), mWindowSurface.getHeight());\n</code></pre>\n"},{"tags":["java","scala","jar","sbt"],"answers":[{"tags":[],"owner":{"account_id":24167232,"reputation":82,"user_id":18129856,"display_name":"Kasper"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656334567,"creation_date":1656334567,"answer_id":72772479,"question_id":72770215,"body_markdown":"Apparently, it works with\r\n\r\n\r\n*mvn clean compile assembly:single* with the Maven Assembly plugin.","title":"Scala JAR file; can&#39;t find or load main class in a JAR file","body":"<p>Apparently, it works with</p>\n<p><em>mvn clean compile assembly:single</em> with the Maven Assembly plugin.</p>\n"}],"owner":{"account_id":24167232,"reputation":82,"user_id":18129856,"display_name":"Kasper"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":384,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1656334567,"creation_date":1656324034,"question_id":72770215,"body_markdown":"I can&#39;t figure out why I can&#39;t run my JAR files. I have been looking for hours, but I still have no clue.\r\n\r\nOriginally I need it for my Scala Spark data science thesis project, since I need to run the JAR files on a Spark Cluster, but even a very basic example doesn&#39;t work.\r\n\r\nWhat I am trying to do, but that even fails is:\r\n\r\nMy test code:\r\n\r\n    object superSimpleTest {\r\n    def main(args: Array[String]): Unit = {\r\n      System.out.println(&quot;I&#39;m a JAR&quot;)\r\n     }\r\n    }\r\n\r\nI build the JAR file using Intellij as follows:\r\n\r\nFile -&gt; Project Structure -&gt; Artifacts -&gt; + -&gt; JAR with &quot;from modules with dependencies&quot;. From the pop-up window I change the manifest output path to resources. After that I go to Build -&gt; Build Artifact -&gt; Build\r\n\r\n[![Create JAR module][1]][1]\r\n[![JAR module overview][2]][2]\r\n\r\nMy manifest looks like this:\r\n***\r\n* Manifest-Version: 1.0 \r\n* Main-Class: superSimpleTest\r\n***\r\n\r\nWhen I then run in terminal: java -jar JARNAME.jar I get the error:\r\n\r\n*Error: Could not find or load main class superSimpleTest*\r\n\r\nHonestly, at this point, I have no clue what I am doing wrong since the code runs fine within Intellij.\r\n\r\nSomeone that can help me go forward?\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/u8CSP.png\r\n  [2]: https://i.stack.imgur.com/xuKww.png","title":"Scala JAR file; can&#39;t find or load main class in a JAR file","body":"<p>I can't figure out why I can't run my JAR files. I have been looking for hours, but I still have no clue.</p>\n<p>Originally I need it for my Scala Spark data science thesis project, since I need to run the JAR files on a Spark Cluster, but even a very basic example doesn't work.</p>\n<p>What I am trying to do, but that even fails is:</p>\n<p>My test code:</p>\n<pre><code>object superSimpleTest {\ndef main(args: Array[String]): Unit = {\n  System.out.println(&quot;I'm a JAR&quot;)\n }\n}\n</code></pre>\n<p>I build the JAR file using Intellij as follows:</p>\n<p>File -&gt; Project Structure -&gt; Artifacts -&gt; + -&gt; JAR with &quot;from modules with dependencies&quot;. From the pop-up window I change the manifest output path to resources. After that I go to Build -&gt; Build Artifact -&gt; Build</p>\n<p><a href=\"https://i.stack.imgur.com/u8CSP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u8CSP.png\" alt=\"Create JAR module\" /></a>\n<a href=\"https://i.stack.imgur.com/xuKww.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xuKww.png\" alt=\"JAR module overview\" /></a></p>\n<p>My manifest looks like this:</p>\n<hr />\n<ul>\n<li>Manifest-Version: 1.0</li>\n<li>Main-Class: superSimpleTest</li>\n</ul>\n<hr />\n<p>When I then run in terminal: java -jar JARNAME.jar I get the error:</p>\n<p><em>Error: Could not find or load main class superSimpleTest</em></p>\n<p>Honestly, at this point, I have no clue what I am doing wrong since the code runs fine within Intellij.</p>\n<p>Someone that can help me go forward?</p>\n"},{"tags":["java","spring","spring-boot","logging","log4j"],"answers":[{"tags":[],"owner":{"account_id":18396380,"reputation":4116,"user_id":13400729,"display_name":"Parsifal"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656334518,"creation_date":1656334518,"answer_id":72772465,"question_id":72770258,"body_markdown":"The message indicates that something is trying to use Log4J 1.x.\r\n\r\nIt&#39;s likely that you have some transitive dependency that requires it. You will need to use your build tool to figure out what that is (for example, with Maven use `mvn dependency:tree`) and then exclude that transitive dependency.\r\n\r\nYou also need to add the Log4J 1.x bridge JAR to your build, as described [here](https://logging.apache.org/log4j/2.x/manual/migration.html), or whatever is trying to use Log4J 1 will fail with an exception.","title":"&quot;log4j:WARN No appenders could be found for logger&quot; error after upgrading Spring Boot from 2.4.6 to 2.6.6","body":"<p>The message indicates that something is trying to use Log4J 1.x.</p>\n<p>It's likely that you have some transitive dependency that requires it. You will need to use your build tool to figure out what that is (for example, with Maven use <code>mvn dependency:tree</code>) and then exclude that transitive dependency.</p>\n<p>You also need to add the Log4J 1.x bridge JAR to your build, as described <a href=\"https://logging.apache.org/log4j/2.x/manual/migration.html\" rel=\"nofollow noreferrer\">here</a>, or whatever is trying to use Log4J 1 will fail with an exception.</p>\n"}],"owner":{"account_id":21821006,"reputation":41,"user_id":16117205,"display_name":"Arunkumar"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":257,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1656334518,"creation_date":1656324211,"question_id":72770258,"body_markdown":"I updated the spring-boot-starter-parent version from 2.4.6 to 2.6.6 to resolve some security vulnerabilities with spring-beans and spring-security-web\r\nBut when I try to start the application after updating the Spring Boot version, I could see the below log4j warning messages \r\n\r\n*log4j:WARN No appenders could be found for logger {class name}    \r\nlog4j:WARN Please initialize the log4j system properly.  \r\nlog4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.*\r\n\r\nAlso, no logger messages are getting printed in the console (I haven&#39;t changed anything in the log4j2.xml file)\r\nPlease let me know the cause and the solution.","title":"&quot;log4j:WARN No appenders could be found for logger&quot; error after upgrading Spring Boot from 2.4.6 to 2.6.6","body":"<p>I updated the spring-boot-starter-parent version from 2.4.6 to 2.6.6 to resolve some security vulnerabilities with spring-beans and spring-security-web\nBut when I try to start the application after updating the Spring Boot version, I could see the below log4j warning messages</p>\n<p><em>log4j:WARN No appenders could be found for logger {class name}<br />\nlog4j:WARN Please initialize the log4j system properly.<br />\nlog4j:WARN See <a href=\"http://logging.apache.org/log4j/1.2/faq.html#noconfig\" rel=\"nofollow noreferrer\">http://logging.apache.org/log4j/1.2/faq.html#noconfig</a> for more info.</em></p>\n<p>Also, no logger messages are getting printed in the console (I haven't changed anything in the log4j2.xml file)\nPlease let me know the cause and the solution.</p>\n"},{"tags":["java","spring","spring-boot","spring-tool-suite","sts"],"comments":[{"owner":{"account_id":13938551,"reputation":465,"user_id":10065011,"display_name":"venkat"},"score":0,"creation_date":1655827024,"post_id":72703659,"comment_id":128421572,"body_markdown":"I followed all instructions in this link\nhttps://stackoverflow.com/questions/50764343/spring-tool-suite-suncertpathbuilderexception-unable-to-find-valid-certificati\nbut no use","body":"I followed all instructions in this link <a href=\"https://stackoverflow.com/questions/50764343/spring-tool-suite-suncertpathbuilderexception-unable-to-find-valid-certificati\" title=\"spring tool suite suncertpathbuilderexception unable to find valid certificati\">stackoverflow.com/questions/50764343/&hellip;</a> but no use"},{"owner":{"account_id":2082386,"reputation":6063,"user_id":1854124,"display_name":"Martin Lippert"},"score":0,"creation_date":1655884591,"post_id":72703659,"comment_id":128434845,"body_markdown":"It looks to me like the trust store where you store the cert into is not the same as the trust store that you specified in the .ini file?","body":"It looks to me like the trust store where you store the cert into is not the same as the trust store that you specified in the .ini file?"},{"owner":{"account_id":13938551,"reputation":465,"user_id":10065011,"display_name":"venkat"},"score":0,"creation_date":1655889864,"post_id":72703659,"comment_id":128436857,"body_markdown":"It is same location C:\\Program Files\\Java\\jre1.8.0_271\\lib\\security\\cacerts\nI forgot to add the version(1.8.0_271) in the Question. I will update that","body":"It is same location C:\\Program Files\\Java\\jre1.8.0_271\\lib\\security\\cacerts I forgot to add the version(1.8.0_271) in the Question. I will update that"},{"owner":{"account_id":2082386,"reputation":6063,"user_id":1854124,"display_name":"Martin Lippert"},"score":0,"creation_date":1655982767,"post_id":72703659,"comment_id":128463857,"body_markdown":"You could try to install a separate JDK11 in your system and configure the IDE to use that to run on (and install the cert into that). Just another idea to see where the underlying problem might be.","body":"You could try to install a separate JDK11 in your system and configure the IDE to use that to run on (and install the cert into that). Just another idea to see where the underlying problem might be."},{"owner":{"account_id":13938551,"reputation":465,"user_id":10065011,"display_name":"venkat"},"score":0,"creation_date":1655991002,"post_id":72703659,"comment_id":128467060,"body_markdown":"I have access to use java-8 only.","body":"I have access to use java-8 only."},{"owner":{"account_id":2082386,"reputation":6063,"user_id":1854124,"display_name":"Martin Lippert"},"score":0,"creation_date":1656076634,"post_id":72703659,"comment_id":128490287,"body_markdown":"In case you downloaded and extracted Spring Tools 4 for Eclipse, you at least have a JDK 17 in your installation as well, the distribution comes with an embedded JDK 17 runtime. And you can&#39;t run the latest versions of Spring Tools 4 for Eclipse with a JDK8 anyway. So you need to make sure that the cert file ends up in the right JDK that is used to run the IDE. The JDK8 is definitely not the that is used by the IDE.","body":"In case you downloaded and extracted Spring Tools 4 for Eclipse, you at least have a JDK 17 in your installation as well, the distribution comes with an embedded JDK 17 runtime. And you can&#39;t run the latest versions of Spring Tools 4 for Eclipse with a JDK8 anyway. So you need to make sure that the cert file ends up in the right JDK that is used to run the IDE. The JDK8 is definitely not the that is used by the IDE."},{"owner":{"account_id":2082386,"reputation":6063,"user_id":1854124,"display_name":"Martin Lippert"},"score":0,"creation_date":1656076725,"post_id":72703659,"comment_id":128490317,"body_markdown":"I haven&#39;t tried the -Djavax.net.ssl.trustStore property myself yet, so I don&#39;t know if that will help. Step 1 would be to verify that the cert ended up in that trust store correctly. Step 2 would be to verify that the JDK that is used to run the IDE actually uses that trust store.","body":"I haven&#39;t tried the -Djavax.net.ssl.trustStore property myself yet, so I don&#39;t know if that will help. Step 1 would be to verify that the cert ended up in that trust store correctly. Step 2 would be to verify that the JDK that is used to run the IDE actually uses that trust store."},{"owner":{"account_id":13938551,"reputation":465,"user_id":10065011,"display_name":"venkat"},"score":0,"creation_date":1656077801,"post_id":72703659,"comment_id":128490768,"body_markdown":"I am using STS 3.8.4 version.  \nI am able to access the spring initializr website through browser","body":"I am using STS 3.8.4 version.   I am able to access the spring initializr website through browser"},{"owner":{"account_id":2082386,"reputation":6063,"user_id":1854124,"display_name":"Martin Lippert"},"score":0,"creation_date":1656508978,"post_id":72703659,"comment_id":128590134,"body_markdown":"I see, you are using an older version that still works on JDK 1.8... :-) I would recommend to follow the steps that I described above to get a better understanding of where the problem might be. And trying the same with a newer version might be a good additional check to see where the problem might come from.","body":"I see, you are using an older version that still works on JDK 1.8... :-) I would recommend to follow the steps that I described above to get a better understanding of where the problem might be. And trying the same with a newer version might be a good additional check to see where the problem might come from."}],"answers":[{"tags":[],"owner":{"account_id":9763630,"reputation":16595,"user_id":7237884,"display_name":"Panagiotis Bougioukos"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656334042,"creation_date":1656334042,"answer_id":72772359,"question_id":72703659,"body_markdown":"Please read this announcement from spring team [here][1].\r\n\r\nAs you mention in your question\r\n\r\n&gt; Current STS version:**3.8.4**\r\n\r\nBut according to the announcement they are dropping maintenance and support for older versions of spring tool suite (**3.x**) and currently only supporting version **4.x**\r\n\r\nIf you are using eclipse as platform for suite it might be that you use a new version of eclipse that is not compatible with spring tools suite **3.x**\r\n\r\nSo you need to upgrade to this version if you wish to work with tools suite from now on.\r\n\r\n\r\n  [1]: https://spring.io/blog/2022/06/14/goodbye-spring-ide-welcome-spring-tools-4","title":"Unable to create Spingboot project in Spring tool suite software","body":"<p>Please read this announcement from spring team <a href=\"https://spring.io/blog/2022/06/14/goodbye-spring-ide-welcome-spring-tools-4\" rel=\"nofollow noreferrer\">here</a>.</p>\n<p>As you mention in your question</p>\n<blockquote>\n<p>Current STS version:<strong>3.8.4</strong></p>\n</blockquote>\n<p>But according to the announcement they are dropping maintenance and support for older versions of spring tool suite (<strong>3.x</strong>) and currently only supporting version <strong>4.x</strong></p>\n<p>If you are using eclipse as platform for suite it might be that you use a new version of eclipse that is not compatible with spring tools suite <strong>3.x</strong></p>\n<p>So you need to upgrade to this version if you wish to work with tools suite from now on.</p>\n"}],"owner":{"account_id":13938551,"reputation":465,"user_id":10065011,"display_name":"venkat"},"comment_count":9,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":1120,"favorite_count":0,"down_vote_count":0,"up_vote_count":4,"answer_count":1,"score":4,"last_activity_date":1656334042,"creation_date":1655826204,"question_id":72703659,"body_markdown":"I am working on STS and while creating a new spring-boot project, it shows following errors:\r\nI tried two options but it didn&#39;t work.\r\n\r\n**Option-1:**\r\n   \r\n\r\n \r\n\r\n    Service URL:https://start.spring.io\r\n    Error Message: SunCertPathBuilderException: unable to find valid certification path to requested target\r\n     \r\n\r\nI followed below instructions but didn&#39;t work\r\n\r\n    Export the corporate certificate (There may be other easier ways of doing this)\r\n    \r\n    On Chrome, I went to https://start.spring.io\r\n    On the location bar clicked on the &#39;Lock&#39; symbol next to https.\r\n    Selected &#39;Certificate(Valid)&#39; on the ensuing pop-up.\r\n    On the resulting dialog box, clicked on the &#39;Certificate Path&#39; tab, from under certificate path tree selected the root node, and then clicked on &#39;View Certificate&#39;\r\n    On the resulting dialog box, clicked on the &#39;Details&#39; tab and then clicked on &#39;Copy to File&#39;\r\n    This brings up the &#39;Export wizard&#39;, clicked on &#39;Next&#39;.\r\n    Left the certificate format to default &#39;DER encoded..&#39;, clicked on &#39;Next&#39;.\r\n    Provided file name (.cer extension) for the certificate.\r\n    Clicked Finish.\r\n    The above steps exported a certificate to a file that I imported into truststore (cacerts).\r\n    \r\n    To import\r\n    \r\n    Opened a &#39;Command&#39; prompt as Administrator to import the certificate\r\n    Went to bin directory of Java installation (this step is not needed if jre/bin is in your path)\r\n    Ran the following:\r\n    \r\n    C:\\Program Files\\Java\\jre1.8.0_271\\bin&gt;keytool -importcert -alias your-alias -keystore &quot;C:\\Program Files\\Java\\jre1.8.0_271\\lib\\security\\cacerts&quot; -storepass changeit -file C:\\certificate-file-location\\saved-certificate-file.cer\r\n    \r\n    (Substitute your java location, certificate file location and certificate file name as appropriate. The &#39;storepass&#39; should be &#39;changeit&#39;.)\r\n    \r\n    Restarted STS\r\n\r\nI tried below options also but it didn&#39;t work\r\n\r\nUpdated below properties in STS.ini file and restarted the STS but no use\r\n\r\n    -Djavax.net.ssl.trustStore=C:\\Program Files\\Java\\jdk\\jre1.8.0_271\\lib\\security\\cacerts\r\n    -Djava.net.ssl.trustStorePassword=changeit\r\n    \r\n**Option-2:**\r\n\r\n    Service URL:http://start.spring.io\r\n    Error Message: JSONException: A JSONObject text must begin with &#39;{&#39; at character 1\r\nNote: I am also behind a corporate proxy.  \r\nI tried all network connections options also like: Manual, DIrect and Native no use  \r\nCurrent STS version:**3.8.4**","title":"Unable to create Spingboot project in Spring tool suite software","body":"<p>I am working on STS and while creating a new spring-boot project, it shows following errors:\nI tried two options but it didn't work.</p>\n<p><strong>Option-1:</strong></p>\n<pre><code>Service URL:https://start.spring.io\nError Message: SunCertPathBuilderException: unable to find valid certification path to requested target\n \n</code></pre>\n<p>I followed below instructions but didn't work</p>\n<pre><code>Export the corporate certificate (There may be other easier ways of doing this)\n\nOn Chrome, I went to https://start.spring.io\nOn the location bar clicked on the 'Lock' symbol next to https.\nSelected 'Certificate(Valid)' on the ensuing pop-up.\nOn the resulting dialog box, clicked on the 'Certificate Path' tab, from under certificate path tree selected the root node, and then clicked on 'View Certificate'\nOn the resulting dialog box, clicked on the 'Details' tab and then clicked on 'Copy to File'\nThis brings up the 'Export wizard', clicked on 'Next'.\nLeft the certificate format to default 'DER encoded..', clicked on 'Next'.\nProvided file name (.cer extension) for the certificate.\nClicked Finish.\nThe above steps exported a certificate to a file that I imported into truststore (cacerts).\n\nTo import\n\nOpened a 'Command' prompt as Administrator to import the certificate\nWent to bin directory of Java installation (this step is not needed if jre/bin is in your path)\nRan the following:\n\nC:\\Program Files\\Java\\jre1.8.0_271\\bin&gt;keytool -importcert -alias your-alias -keystore &quot;C:\\Program Files\\Java\\jre1.8.0_271\\lib\\security\\cacerts&quot; -storepass changeit -file C:\\certificate-file-location\\saved-certificate-file.cer\n\n(Substitute your java location, certificate file location and certificate file name as appropriate. The 'storepass' should be 'changeit'.)\n\nRestarted STS\n</code></pre>\n<p>I tried below options also but it didn't work</p>\n<p>Updated below properties in STS.ini file and restarted the STS but no use</p>\n<pre><code>-Djavax.net.ssl.trustStore=C:\\Program Files\\Java\\jdk\\jre1.8.0_271\\lib\\security\\cacerts\n-Djava.net.ssl.trustStorePassword=changeit\n</code></pre>\n<p><strong>Option-2:</strong></p>\n<pre><code>Service URL:http://start.spring.io\nError Message: JSONException: A JSONObject text must begin with '{' at character 1\n</code></pre>\n<p>Note: I am also behind a corporate proxy.<br />\nI tried all network connections options also like: Manual, DIrect and Native no use<br />\nCurrent STS version:<strong>3.8.4</strong></p>\n"},{"tags":["java","android","firebase","google-cloud-firestore"],"comments":[{"owner":{"account_id":14331920,"reputation":351,"user_id":10352461,"display_name":"Stefan de Kraker"},"score":0,"creation_date":1656275779,"post_id":72764925,"comment_id":128526332,"body_markdown":"And why do you find a &quot;class implementation&quot;, not simple? Because you can then map it to an object `toObject(&lt;class&gt;::class.java)`. Then you can use the object as you want.","body":"And why do you find a &quot;class implementation&quot;, not simple? Because you can then map it to an object <code>toObject(&lt;class&gt;::class.java)</code>. Then you can use the object as you want."},{"owner":{"account_id":25127425,"reputation":151,"user_id":18975067,"display_name":"Sana"},"score":0,"creation_date":1656275839,"post_id":72764925,"comment_id":128526342,"body_markdown":"can you provide related example please","body":"can you provide related example please"},{"owner":{"account_id":14331920,"reputation":351,"user_id":10352461,"display_name":"Stefan de Kraker"},"score":0,"creation_date":1656275920,"post_id":72764925,"comment_id":128526355,"body_markdown":"Well I&#39;m only familiar with Kotlin, but if you make a data class that is the same as the document you want to make, you can convert it.","body":"Well I&#39;m only familiar with Kotlin, but if you make a data class that is the same as the document you want to make, you can convert it."},{"owner":{"account_id":25127425,"reputation":151,"user_id":18975067,"display_name":"Sana"},"score":0,"creation_date":1656276177,"post_id":72764925,"comment_id":128526391,"body_markdown":"i will try this and let you know.\nThank you!","body":"i will try this and let you know. Thank you!"},{"owner":{"account_id":6819231,"reputation":132841,"user_id":5246885,"accept_rate":78,"display_name":"Alex Mamo"},"score":2,"creation_date":1656316897,"post_id":72764925,"comment_id":128532774,"body_markdown":"Since you&#39;re using Java, this [resource](https://medium.com/firebase-tips-tricks/how-to-map-an-array-of-objects-from-cloud-firestore-to-a-list-of-objects-122e579eae10) will help you for sure.","body":"Since you&#39;re using Java, this <a href=\"https://medium.com/firebase-tips-tricks/how-to-map-an-array-of-objects-from-cloud-firestore-to-a-list-of-objects-122e579eae10\" rel=\"nofollow noreferrer\">resource</a> will help you for sure."}],"answers":[{"tags":[],"owner":{"account_id":14331920,"reputation":351,"user_id":10352461,"display_name":"Stefan de Kraker"},"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1656333479,"creation_date":1656277207,"answer_id":72765107,"question_id":72764925,"body_markdown":"I should just go with the data class implementation, pretty easy.\r\n\r\nMake a few classes that match the result of the Firebase call:\r\n```java\r\nclass Purchases {\r\n    public List&lt;Purchase&gt; purchases;\r\n\r\n    public Purchases(List&lt;Purchase&gt; purchases) {\r\n        this.purchases = purchases;\r\n    }\r\n}\r\nclass Purchase {\r\n    public String id;\r\n    public Double price;\r\n    public List&lt;Product&gt; products;\r\n\r\n    public Purchase(String id, Double price, List&lt;Product&gt; products) {\r\n        this.id = id;\r\n        this.price = price;\r\n        this.products = products;\r\n    }\r\n}\r\n\r\nclass Product {\r\n    public String addedOn;\r\n    // More values\r\n\r\n    public Product(String addedOn) {\r\n        this.addedOn  = addedOn;\r\n        // Add those values to the constructor too\r\n    }\r\n}\r\n```\r\n\r\nAnd then you should be able to use `toObject()`\r\n\r\n```java\r\ndocRef.get().addOnCompleteListener(new OnCompleteListener&lt;DocumentSnapshot&gt;() {\r\n    @Override\r\n    public void onComplete(@NonNull Task&lt;DocumentSnapshot&gt; task) {\r\n        if (task.isSuccessful()) {\r\n            DocumentSnapshot document = task.getResult();\r\n            if (document.exists()) {\r\n                document.toObject(Purchases::class.java) // to Object here\r\n            }\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nSo you just need to make a few classes that will simply hold the data. You could read more [here][1].\r\n\r\n\r\n  [1]: https://medium.com/firebase-tips-tricks/how-to-map-an-array-of-objects-from-cloud-firestore-to-a-list-of-objects-122e579eae10","title":"Read Firestore Data in Android Java","body":"<p>I should just go with the data class implementation, pretty easy.</p>\n<p>Make a few classes that match the result of the Firebase call:</p>\n<pre class=\"lang-java prettyprint-override\"><code>class Purchases {\n    public List&lt;Purchase&gt; purchases;\n\n    public Purchases(List&lt;Purchase&gt; purchases) {\n        this.purchases = purchases;\n    }\n}\nclass Purchase {\n    public String id;\n    public Double price;\n    public List&lt;Product&gt; products;\n\n    public Purchase(String id, Double price, List&lt;Product&gt; products) {\n        this.id = id;\n        this.price = price;\n        this.products = products;\n    }\n}\n\nclass Product {\n    public String addedOn;\n    // More values\n\n    public Product(String addedOn) {\n        this.addedOn  = addedOn;\n        // Add those values to the constructor too\n    }\n}\n</code></pre>\n<p>And then you should be able to use <code>toObject()</code></p>\n<pre class=\"lang-java prettyprint-override\"><code>docRef.get().addOnCompleteListener(new OnCompleteListener&lt;DocumentSnapshot&gt;() {\n    @Override\n    public void onComplete(@NonNull Task&lt;DocumentSnapshot&gt; task) {\n        if (task.isSuccessful()) {\n            DocumentSnapshot document = task.getResult();\n            if (document.exists()) {\n                document.toObject(Purchases::class.java) // to Object here\n            }\n        }\n    }\n}\n</code></pre>\n<p>So you just need to make a few classes that will simply hold the data. You could read more <a href=\"https://medium.com/firebase-tips-tricks/how-to-map-an-array-of-objects-from-cloud-firestore-to-a-list-of-objects-122e579eae10\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}],"owner":{"account_id":25127425,"reputation":151,"user_id":18975067,"display_name":"Sana"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":217,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"accepted_answer_id":72765107,"answer_count":1,"score":0,"last_activity_date":1656333479,"creation_date":1656275320,"question_id":72764925,"body_markdown":"i am working on android application and i am trying to read data from the firestore. \r\nOne of the key contains further object data which i want to read. i was able to read the data for purchases but purchases has further array data with contains products keys. i am unable to read that. i want a simple solution, no class implementation please! \r\n            \r\n    docRef.get().addOnCompleteListener(new OnCompleteListener&lt;DocumentSnapshot&gt;() {\r\n        @Override\r\n        public void onComplete(@NonNull Task&lt;DocumentSnapshot&gt; task) {\r\n            if (task.isSuccessful()) {\r\n                DocumentSnapshot document = task.getResult();\r\n                if (document.exists()) {\r\n                    Map&lt;String, Object&gt; data = (Map&lt;String, Object&gt;) document.getData().get(&quot;path&quot;);\r\n                    Set&lt;String&gt; keys = data.keySet();\r\n                    for (String s : keys) {\r\n                        if (Objects.equals(s, &quot;purchases&quot;)) {\r\n\r\n                            Log.d(TAG, &quot;onComplete: &quot; + data.get(s));\r\n\r\n                        }\r\n                    }\r\n                } else {\r\n                    Log.d(TAG, &quot;No such document&quot;);\r\n                }\r\n            } else {\r\n                Log.d(TAG, &quot;get failed with &quot;, task.getException());\r\n            }\r\n        }\r\n    });\r\n\r\n\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/8nH7T.png\r\n\r\nHere purchase is an array and each array element has further data which contains products key . and product is further nested into object. i want to make a llop to read data of products. \r\n\r\nThanks ","title":"Read Firestore Data in Android Java","body":"<p>i am working on android application and i am trying to read data from the firestore.\nOne of the key contains further object data which i want to read. i was able to read the data for purchases but purchases has further array data with contains products keys. i am unable to read that. i want a simple solution, no class implementation please!</p>\n<pre><code>docRef.get().addOnCompleteListener(new OnCompleteListener&lt;DocumentSnapshot&gt;() {\n    @Override\n    public void onComplete(@NonNull Task&lt;DocumentSnapshot&gt; task) {\n        if (task.isSuccessful()) {\n            DocumentSnapshot document = task.getResult();\n            if (document.exists()) {\n                Map&lt;String, Object&gt; data = (Map&lt;String, Object&gt;) document.getData().get(&quot;path&quot;);\n                Set&lt;String&gt; keys = data.keySet();\n                for (String s : keys) {\n                    if (Objects.equals(s, &quot;purchases&quot;)) {\n\n                        Log.d(TAG, &quot;onComplete: &quot; + data.get(s));\n\n                    }\n                }\n            } else {\n                Log.d(TAG, &quot;No such document&quot;);\n            }\n        } else {\n            Log.d(TAG, &quot;get failed with &quot;, task.getException());\n        }\n    }\n});\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/8nH7T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8nH7T.png\" alt=\"enter image description here\" /></a></p>\n<p>Here purchase is an array and each array element has further data which contains products key . and product is further nested into object. i want to make a llop to read data of products.</p>\n<p>Thanks</p>\n"},{"tags":["java","android-studio"],"comments":[{"owner":{"account_id":24764408,"reputation":306,"user_id":18648400,"display_name":"Mirco0"},"score":0,"creation_date":1656334937,"post_id":72772212,"comment_id":128539251,"body_markdown":"Check this https://stackoverflow.com/a/28626912/18648400","body":"Check this <a href=\"https://stackoverflow.com/a/28626912/18648400\">stackoverflow.com/a/28626912/18648400</a>"},{"owner":{"account_id":2095244,"reputation":566,"user_id":1864166,"accept_rate":75,"display_name":"Richard Duerr"},"score":0,"creation_date":1656363515,"post_id":72772212,"comment_id":128549484,"body_markdown":"This is likely already answered: \n\nhttps://stackoverflow.com/questions/5350624/set-icon-for-android-application\n\nYou also didn&#39;t provide any android / android studio / device version info.","body":"This is likely already answered:   <a href=\"https://stackoverflow.com/questions/5350624/set-icon-for-android-application\" title=\"set icon for android application\">stackoverflow.com/questions/5350624/&hellip;</a>  You also didn&#39;t provide any android / android studio / device version info."}],"owner":{"account_id":25660772,"reputation":1,"user_id":19426540,"display_name":"Sofia Leit&#227;o"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":71,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1656333350,"creation_date":1656333350,"question_id":72772212,"body_markdown":"I have tried multiple times to change the app icon but to no use. If I click under the ic_launcher it shows my picture but when I run it it does not.\r\nI have done the new image set way and the add manually into the andoid manifest.\r\nHelp\r\n[enter image description here][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/qouTS.png","title":"How to change the app icon on android studio multiple times and nothing","body":"<p>I have tried multiple times to change the app icon but to no use. If I click under the ic_launcher it shows my picture but when I run it it does not.\nI have done the new image set way and the add manually into the andoid manifest.\nHelp\n<a href=\"https://i.stack.imgur.com/qouTS.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"},{"tags":["java","mongodb","spring-boot","spring-data-mongodb"],"answers":[{"tags":[],"owner":{"account_id":14358183,"reputation":339,"user_id":10371394,"display_name":"Sebastian Lore"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656333319,"creation_date":1612306617,"answer_id":66018806,"question_id":66018709,"body_markdown":"Try adding `spring-boot-starter-data-mongodb` instead of `spring-data-mongodb`.","title":"Getting a ClassNotFound exception when using mongotemplate","body":"<p>Try adding <code>spring-boot-starter-data-mongodb</code> instead of <code>spring-data-mongodb</code>.</p>\n"}],"owner":{"account_id":10734227,"reputation":393,"user_id":7899320,"display_name":"Fernando"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":1307,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1656333319,"creation_date":1612305949,"question_id":66018709,"body_markdown":"I am getting the following exception when running a spring boot application that uses the mongo template:\r\n\r\n    Caused by: java.lang.ClassNotFoundException: org.springframework.data.mongodb.MongoDatabaseFactory\r\n\r\nThis is the main code:\r\n\r\n```java\r\npackage com.example.redismongo.mongodb;\r\n\r\nimport com.mongodb.client.MongoClient;\r\nimport com.mongodb.client.MongoClients;\r\nimport org.springframework.context.annotation.Bean;\r\nimport org.springframework.context.annotation.Configuration;\r\nimport org.springframework.context.annotation.Primary;\r\nimport org.springframework.data.mongodb.config.EnableMongoAuditing;\r\nimport org.springframework.data.mongodb.core.MongoTemplate;\r\n\r\n@Configuration\r\n@EnableMongoAuditing\r\npublic class MongoConfiguration {\r\n\r\n\r\n    @Bean\r\n    public MongoClient mongo(){\r\n        return MongoClients.create(&quot;mongodb://localhost:27017&quot;);\r\n    }\r\n\r\n    @Primary\r\n    @Bean(name = &quot;mongoTemplate&quot;)\r\n    public MongoTemplate mongoTemplate(){\r\n        return new MongoTemplate(mongo(), &quot;test&quot;);\r\n    }\r\n}\r\n```\r\n```groovy\r\nplugins {\r\n\tid &#39;org.springframework.boot&#39; version &#39;2.4.2&#39;\r\n\tid &#39;io.spring.dependency-management&#39; version &#39;1.0.11.RELEASE&#39;\r\n\tid &#39;java&#39;\r\n}\r\n\r\ngroup = &#39;com.example&#39;\r\nversion = &#39;0.0.1-SNAPSHOT&#39;\r\nsourceCompatibility = &#39;11&#39;\r\n\r\nrepositories {\r\n\tmavenCentral()\r\n}\r\n\r\ndependencies {\r\n\timplementation &#39;org.springframework.boot:spring-boot-starter-web&#39;\r\n\timplementation group: &#39;org.springframework.data&#39;, name: &#39;spring-data-commons&#39;, version: &#39;2.2.8.RELEASE&#39;\r\n\timplementation group: &#39;org.springframework.data&#39;, name: &#39;spring-data-mongodb&#39;, version: &#39;2.2.8.RELEASE&#39;\r\n\ttestImplementation &#39;org.springframework.boot:spring-boot-starter-test&#39;\r\n}\r\n\r\ntest {\r\n\tuseJUnitPlatform()\r\n}\r\n```\r\n\r\n\r\n\r\nI need to test the 2.2.8 version as that is the version that is being used at work. I am trying to test some of its functionality in my pc to test certain fail scenarios. How can I make 2.2.8 work?","title":"Getting a ClassNotFound exception when using mongotemplate","body":"<p>I am getting the following exception when running a spring boot application that uses the mongo template:</p>\n<pre><code>Caused by: java.lang.ClassNotFoundException: org.springframework.data.mongodb.MongoDatabaseFactory\n</code></pre>\n<p>This is the main code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.redismongo.mongodb;\n\nimport com.mongodb.client.MongoClient;\nimport com.mongodb.client.MongoClients;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.context.annotation.Primary;\nimport org.springframework.data.mongodb.config.EnableMongoAuditing;\nimport org.springframework.data.mongodb.core.MongoTemplate;\n\n@Configuration\n@EnableMongoAuditing\npublic class MongoConfiguration {\n\n\n    @Bean\n    public MongoClient mongo(){\n        return MongoClients.create(&quot;mongodb://localhost:27017&quot;);\n    }\n\n    @Primary\n    @Bean(name = &quot;mongoTemplate&quot;)\n    public MongoTemplate mongoTemplate(){\n        return new MongoTemplate(mongo(), &quot;test&quot;);\n    }\n}\n</code></pre>\n<pre><code>plugins {\n    id 'org.springframework.boot' version '2.4.2'\n    id 'io.spring.dependency-management' version '1.0.11.RELEASE'\n    id 'java'\n}\n\ngroup = 'com.example'\nversion = '0.0.1-SNAPSHOT'\nsourceCompatibility = '11'\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    implementation 'org.springframework.boot:spring-boot-starter-web'\n    implementation group: 'org.springframework.data', name: 'spring-data-commons', version: '2.2.8.RELEASE'\n    implementation group: 'org.springframework.data', name: 'spring-data-mongodb', version: '2.2.8.RELEASE'\n    testImplementation 'org.springframework.boot:spring-boot-starter-test'\n}\n\ntest {\n    useJUnitPlatform()\n}\n</code></pre>\n<p>I need to test the 2.2.8 version as that is the version that is being used at work. I am trying to test some of its functionality in my pc to test certain fail scenarios. How can I make 2.2.8 work?</p>\n"},{"tags":["java","minecraft","bukkit","spigot"],"comments":[{"owner":{"account_id":16493669,"reputation":3050,"user_id":11916773,"display_name":"Lucan"},"score":0,"creation_date":1656171215,"post_id":72754131,"comment_id":128508757,"body_markdown":"What do you want to achieve?","body":"What do you want to achieve?"},{"owner":{"account_id":25182775,"reputation":21,"user_id":19024076,"display_name":"Kelvin Hollander"},"score":0,"creation_date":1656173053,"post_id":72754131,"comment_id":128509152,"body_markdown":"I want to be able to detect the name of a chest so i can open a gui","body":"I want to be able to detect the name of a chest so i can open a gui"}],"answers":[{"tags":[],"owner":{"account_id":25182775,"reputation":21,"user_id":19024076,"display_name":"Kelvin Hollander"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1656333299,"creation_date":1656333299,"answer_id":72772202,"question_id":72754131,"body_markdown":"I have figured it out after searching on around 100 sites I found a solution that works, I don&#39;t know if it&#39;s the best solution but good for me.\r\n\r\nI changed the whole event to use `InventoryOpenEvent` insted of `PlayerInteractEvent`.\r\n\r\nHere is the full code :\r\n```\r\n@EventHandler\r\n    public void onInventoryOpen(InventoryOpenEvent e) {\r\n        Player player = (Player) e.getPlayer();\r\n        if (e.getView().getTitle().equals(&quot;Test&quot;)) {\r\n            e.setCancelled(true);\r\n            player.sendMessage(&quot;Succesfull&quot;);\r\n        }\r\n    }\r\n```\r\n\r\nHere is the code stripped down :\r\n```\r\n@EventHandler\r\n    public void onInventoryOpen(InventoryOpenEvent e) {\r\n        if (e.getView().getTitle().equals(&quot;Test&quot;)) {\r\n            e.setCancelled(true);\r\n        }\r\n    }","title":"Trying to get getView().getTitle() to work","body":"<p>I have figured it out after searching on around 100 sites I found a solution that works, I don't know if it's the best solution but good for me.</p>\n<p>I changed the whole event to use <code>InventoryOpenEvent</code> insted of <code>PlayerInteractEvent</code>.</p>\n<p>Here is the full code :</p>\n<pre><code>@EventHandler\n    public void onInventoryOpen(InventoryOpenEvent e) {\n        Player player = (Player) e.getPlayer();\n        if (e.getView().getTitle().equals(&quot;Test&quot;)) {\n            e.setCancelled(true);\n            player.sendMessage(&quot;Succesfull&quot;);\n        }\n    }\n</code></pre>\n<p>Here is the code stripped down :</p>\n<pre><code>@EventHandler\n    public void onInventoryOpen(InventoryOpenEvent e) {\n        if (e.getView().getTitle().equals(&quot;Test&quot;)) {\n            e.setCancelled(true);\n        }\n    }\n</code></pre>\n"}],"owner":{"account_id":25182775,"reputation":21,"user_id":19024076,"display_name":"Kelvin Hollander"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":511,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"accepted_answer_id":72772202,"answer_count":1,"score":-1,"last_activity_date":1656333299,"creation_date":1656162760,"question_id":72754131,"body_markdown":"I was first using only `getTitle()` for this but then found you need to use `getView()` as well. So i did but I stil can&#39;t get it to work.\r\n\r\nFYI This is the error :\r\n`Cannot resolve method &#39;getView&#39; in &#39;Inventory&#39;`\r\n\r\nI tried changing `getInventory()` for `InventoryView()` but still the same error but also the `Cannot resolve method &#39;InventoryView&#39; in &#39;Chest&#39;` error so this means I cant get the inventory view from a block?\r\n\r\n```\r\n@EventHandler\r\n    public void onInteract(PlayerInteractEvent e) {\r\n        Action a = e.getAction();\r\n        Player p = e.getPlayer();\r\n        ItemStack hand = e.getItem();\r\n        Block clicked = e.getClickedBlock();\r\n\r\n        if (a != Action.PHYSICAL) {\r\n            assert clicked != null;\r\n            if(clicked.getType() == Material.CHEST){\r\n                hand.getType();\r\n                Chest chest = (Chest) clicked.getState();\r\n                Inventory inv = chest.getInventory();\r\n                if(inv.getView().getTitle().equalsIgnoreCase(&quot;Test&quot;)) {\r\n                    p.sendMessage(&quot;Event triggered&quot;);\r\n                    e.setCancelled(true);\r\n\r\n                }\r\n\r\n\r\n            }\r\n\r\n        }\r\n    }\r\n```","title":"Trying to get getView().getTitle() to work","body":"<p>I was first using only <code>getTitle()</code> for this but then found you need to use <code>getView()</code> as well. So i did but I stil can't get it to work.</p>\n<p>FYI This is the error :\n<code>Cannot resolve method 'getView' in 'Inventory'</code></p>\n<p>I tried changing <code>getInventory()</code> for <code>InventoryView()</code> but still the same error but also the <code>Cannot resolve method 'InventoryView' in 'Chest'</code> error so this means I cant get the inventory view from a block?</p>\n<pre><code>@EventHandler\n    public void onInteract(PlayerInteractEvent e) {\n        Action a = e.getAction();\n        Player p = e.getPlayer();\n        ItemStack hand = e.getItem();\n        Block clicked = e.getClickedBlock();\n\n        if (a != Action.PHYSICAL) {\n            assert clicked != null;\n            if(clicked.getType() == Material.CHEST){\n                hand.getType();\n                Chest chest = (Chest) clicked.getState();\n                Inventory inv = chest.getInventory();\n                if(inv.getView().getTitle().equalsIgnoreCase(&quot;Test&quot;)) {\n                    p.sendMessage(&quot;Event triggered&quot;);\n                    e.setCancelled(true);\n\n                }\n\n\n            }\n\n        }\n    }\n</code></pre>\n"},{"tags":["java","rocketmq"],"answers":[{"tags":[],"owner":{"account_id":2386817,"reputation":15505,"user_id":2087628,"accept_rate":42,"display_name":"JaskeyLam"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1656333168,"creation_date":1656332098,"answer_id":72771940,"question_id":72768395,"body_markdown":"For your case, the most possible cause is that you started two instances with the same consumer group name. Let&#39;s say it c1 and c2 with the same consumer group &quot;CG1&quot;.\r\n\r\nWhile c1 subscribes different topics from c2 does. This can be the most possible cause. So please check your code if this case exists. \r\n\r\nAnother cause is that c1 and c2 indeed subscribe the same topics , but c1 is a push consumer while c2 is a pull consumer. This likely happens when you are using springboot-rocketmq since it will create a pull consumer by default.\r\n\r\nNo matter which cause you are facing with, you can find it out in the console that if there are more than 1 instance in the instance list of the CG1.","title":"Why the rocketmq only consumes part of the queue","body":"<p>For your case, the most possible cause is that you started two instances with the same consumer group name. Let's say it c1 and c2 with the same consumer group &quot;CG1&quot;.</p>\n<p>While c1 subscribes different topics from c2 does. This can be the most possible cause. So please check your code if this case exists.</p>\n<p>Another cause is that c1 and c2 indeed subscribe the same topics , but c1 is a push consumer while c2 is a pull consumer. This likely happens when you are using springboot-rocketmq since it will create a pull consumer by default.</p>\n<p>No matter which cause you are facing with, you can find it out in the console that if there are more than 1 instance in the instance list of the CG1.</p>\n"}],"owner":{"account_id":3106126,"reputation":31241,"user_id":2628868,"accept_rate":84,"display_name":"Dolphin"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":162,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"accepted_answer_id":72771940,"answer_count":1,"score":-1,"last_activity_date":1656333168,"creation_date":1656314884,"question_id":72768395,"body_markdown":"After send message to the RocketMQ 4.8, I found the consumer only consumed part of the queue. This is the RocketMQ consumer code looks like:\r\n\r\n    public void appConsumer(Long appId, List&lt;String&gt; topics) throws MQClientException {\r\n        DefaultMQPushConsumer consumer = new DefaultMQPushConsumer(appId.toString());\r\n        RocketMQConfigDTO rocketMQConfigDTO = MqConfigHandler.MQConfig();\r\n        consumer.setNamesrvAddr(rocketMQConfigDTO.getHost());\r\n        consumer.setMessageModel(MessageModel.CLUSTERING);\r\n        consumer.setMaxReconsumeTimes(rocketMQConfigDTO.getMaxReconsumeTimes());\r\n        consumer.setConsumeThreadMin(rocketMQConfigDTO.getConsumeThreadMin());\r\n        consumer.setConsumeThreadMax(rocketMQConfigDTO.getConsumeThreadMax());\r\n        consumer.setConsumeMessageBatchMaxSize(rocketMQConfigDTO.getConsumeMessageBatchMaxSize());\r\n        consumer.setConsumeFromWhere(ConsumeFromWhere.CONSUME_FROM_LAST_OFFSET);\r\n        for (String topic : topics) {\r\n            consumer.subscribe(topic, &quot;*&quot;);\r\n        }\r\n        consumer.registerMessageListener(new MessageListenerConcurrently() {\r\n            @Override\r\n            public ConsumeConcurrentlyStatus consumeMessage(List&lt;MessageExt&gt; msgs, ConsumeConcurrentlyContext context) {\r\n                Callable&lt;ConsumeConcurrentlyStatus&gt; task = new Callable&lt;ConsumeConcurrentlyStatus&gt;() {\r\n                    @Override\r\n                    public ConsumeConcurrentlyStatus call() throws Exception {\r\n                        return handleMessage(msgs, context,appId);\r\n                    }\r\n                };\r\n                asyncService.submit(task);\r\n                return ConsumeConcurrentlyStatus.CONSUME_SUCCESS;\r\n            }\r\n        });\r\n        consumer.start();\r\n        eventConsumers.put(appId, consumer);\r\n    }\r\n\r\nWhen I access to the RocketMQ dashboard, I found the consumer only consumed part of the queue in the same broker:\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\nThe queue 0 and 1&#39;s message were not consumed by the consumer. Why did this happen? What should I do to fixed this problem? Why did the consumer only consume messages 3 and 4?\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/2noSF.png","title":"Why the rocketmq only consumes part of the queue","body":"<p>After send message to the RocketMQ 4.8, I found the consumer only consumed part of the queue. This is the RocketMQ consumer code looks like:</p>\n<pre><code>public void appConsumer(Long appId, List&lt;String&gt; topics) throws MQClientException {\n    DefaultMQPushConsumer consumer = new DefaultMQPushConsumer(appId.toString());\n    RocketMQConfigDTO rocketMQConfigDTO = MqConfigHandler.MQConfig();\n    consumer.setNamesrvAddr(rocketMQConfigDTO.getHost());\n    consumer.setMessageModel(MessageModel.CLUSTERING);\n    consumer.setMaxReconsumeTimes(rocketMQConfigDTO.getMaxReconsumeTimes());\n    consumer.setConsumeThreadMin(rocketMQConfigDTO.getConsumeThreadMin());\n    consumer.setConsumeThreadMax(rocketMQConfigDTO.getConsumeThreadMax());\n    consumer.setConsumeMessageBatchMaxSize(rocketMQConfigDTO.getConsumeMessageBatchMaxSize());\n    consumer.setConsumeFromWhere(ConsumeFromWhere.CONSUME_FROM_LAST_OFFSET);\n    for (String topic : topics) {\n        consumer.subscribe(topic, &quot;*&quot;);\n    }\n    consumer.registerMessageListener(new MessageListenerConcurrently() {\n        @Override\n        public ConsumeConcurrentlyStatus consumeMessage(List&lt;MessageExt&gt; msgs, ConsumeConcurrentlyContext context) {\n            Callable&lt;ConsumeConcurrentlyStatus&gt; task = new Callable&lt;ConsumeConcurrentlyStatus&gt;() {\n                @Override\n                public ConsumeConcurrentlyStatus call() throws Exception {\n                    return handleMessage(msgs, context,appId);\n                }\n            };\n            asyncService.submit(task);\n            return ConsumeConcurrentlyStatus.CONSUME_SUCCESS;\n        }\n    });\n    consumer.start();\n    eventConsumers.put(appId, consumer);\n}\n</code></pre>\n<p>When I access to the RocketMQ dashboard, I found the consumer only consumed part of the queue in the same broker:</p>\n<p><a href=\"https://i.stack.imgur.com/2noSF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2noSF.png\" alt=\"enter image description here\" /></a></p>\n<p>The queue 0 and 1's message were not consumed by the consumer. Why did this happen? What should I do to fixed this problem? Why did the consumer only consume messages 3 and 4?</p>\n"},{"tags":["java","sorting","collections","hashmap"],"comments":[{"owner":{"account_id":17253470,"reputation":61,"user_id":14291381,"display_name":"Andrew"},"score":1,"creation_date":1656312764,"post_id":72767758,"comment_id":128531523,"body_markdown":"Without changing the nature of the problem, just about the only thing you can do is a nested loop where you find the largest inner-map, print it out, remove it from the outer-map, and continue. Then you can add back every map at the end.","body":"Without changing the nature of the problem, just about the only thing you can do is a nested loop where you find the largest inner-map, print it out, remove it from the outer-map, and continue. Then you can add back every map at the end."},{"owner":{"account_id":71739,"reputation":307142,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":0,"creation_date":1656314107,"post_id":72767758,"comment_id":128531936,"body_markdown":"You can&#39;t sort a hash map. This is a job for streams.","body":"You can&#39;t sort a hash map. This is a job for streams."}],"answers":[{"tags":[],"owner":{"account_id":8721365,"reputation":11,"user_id":6524420,"display_name":"BlackSoudier"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656313575,"creation_date":1656313575,"answer_id":72768137,"question_id":72767758,"body_markdown":"Since *ConcurrentHashMap* makes no guarantees about ordering, you have to sort your map be getting entrySet and sort them then re-put into a *LinkedHashMap*\r\n\r\n    Map&lt;String, Map&lt;String, Integer&gt;&gt; sortedStates = new LinkedHashMap&lt;String, Map&lt;String, Integer&gt;&gt;();\r\n    states.entrySet().stream()\r\n            .sorted(new Comparator&lt;Map.Entry&lt;String, Map&lt;String, Integer&gt;&gt;&gt;() {\r\n                public int compare(Map.Entry&lt;String, Map&lt;String, Integer&gt;&gt; mapA, Map.Entry&lt;String, Map&lt;String, Integer&gt;&gt; mapB){\r\n                    return mapB.getValue().size() - mapA.getValue().size();\r\n                  }\r\n                })\r\n            .forEachOrdered(mapInner -&gt; sortedStates.put(mapInner.getKey(), mapInner.getValue()));","title":"Print the contents of a HashMap in sorted order according to the Size of each HashMap nested inside the given HashMap","body":"<p>Since <em>ConcurrentHashMap</em> makes no guarantees about ordering, you have to sort your map be getting entrySet and sort them then re-put into a <em>LinkedHashMap</em></p>\n<pre><code>Map&lt;String, Map&lt;String, Integer&gt;&gt; sortedStates = new LinkedHashMap&lt;String, Map&lt;String, Integer&gt;&gt;();\nstates.entrySet().stream()\n        .sorted(new Comparator&lt;Map.Entry&lt;String, Map&lt;String, Integer&gt;&gt;&gt;() {\n            public int compare(Map.Entry&lt;String, Map&lt;String, Integer&gt;&gt; mapA, Map.Entry&lt;String, Map&lt;String, Integer&gt;&gt; mapB){\n                return mapB.getValue().size() - mapA.getValue().size();\n              }\n            })\n        .forEachOrdered(mapInner -&gt; sortedStates.put(mapInner.getKey(), mapInner.getValue()));\n</code></pre>\n"},{"tags":[],"owner":{"account_id":9497602,"reputation":93,"user_id":7060014,"display_name":"Rohit Dhiman"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656314534,"creation_date":1656314146,"answer_id":72768236,"question_id":72767758,"body_markdown":"1. create a size_map -&gt; Map&lt;Integer, List&lt;String&gt;&gt; size_map = new HashMap&lt;Integer, List&lt;String&gt;&gt;();\r\n - This is to store store number of cities as key and states as the value. Note here states are stored in a list because multiple states can have same number of cities.\r\n\r\n2. Make a list (size_list) out of keys of map in point 1. (Keys are number of cities for different states). Order this list in descending order\r\n\r\n3. While iterating your &quot;states&quot; Hashmap, use size_list as a lookup and fetch the list of states with the current size from size_map HashMap. Basically use size_list as a lookup.\r\n\r\nNote - this will increase your overhead and performance might not be great.\r\n        \r\n\r\n        Map&lt;String, Map&lt;String, Integer&gt;&gt; states = new ConcurrentHashMap&lt;String, Map&lt;String, Integer&gt;&gt;();\r\n\r\n        //create size HashMap -- store number of cities as key and value would be list of states \r\n        Map&lt;Integer, List&lt;String&gt;&gt; size_map = new HashMap&lt;Integer, List&lt;String&gt;&gt;();\r\n\r\n        for(Map.Entry&lt;String, Map&lt;String, Integer&gt;&gt; entry : states.entrySet())\r\n        {\r\n            int size = entry.getValue().size();\r\n            String state = entry.getKey();\r\n            if(size_map.containsKey(size))\r\n            {\r\n                List&lt;String&gt; retreived_list = size_map.get(size);\r\n                retreived_list.add(state);\r\n                size_map.put(size, retreived_list);\r\n            }\r\n            else\r\n            {\r\n                List&lt;String&gt; retreived_list = new ArrayList&lt;String&gt;();\r\n                retreived_list.add(state);\r\n                size_map.put(size, retreived_list);\r\n            }\r\n        }\r\n\r\n        //create a list out of size_map keys and sort it in descending order\r\n        List&lt;Integer&gt; size_list = new ArrayList&lt;Integer&gt;(size_map.keySet());\r\n        Collections.sort(size_list, Collections.reverseOrder());\r\n\r\n        //index will be current index in size_list, fetch states list from size_map and look for the same state in the original &quot;state&quot; hashmap\r\n        int index =0;\r\n        for(Map.Entry&lt;String, Map&lt;String, Integer&gt;&gt; entry : states.entrySet())\r\n        {\r\n            int current_size = size_list.get(index);\r\n            List&lt;String&gt; states_list = size_map.get(current_size);\r\n\r\n            for(String s : states_list)\r\n            {\r\n                System.out.println(&quot;State:&quot; + s);\r\n                Map&lt;String, Integer&gt; tempMap = states.get(s);\r\n                for(Map.Entry&lt;String, Integer&gt; innerEntry : tempMap.entrySet()) {\r\n                    System.out.println(&quot;City:&quot; + innerEntry.getKey() + &quot; Count:&quot; + innerEntry.getValue());\r\n                }\r\n            }\r\n            index++;\r\n            System.out.println();\r\n        }","title":"Print the contents of a HashMap in sorted order according to the Size of each HashMap nested inside the given HashMap","body":"<ol>\n<li>create a size_map -&gt; Map&lt;Integer, List&gt; size_map = new HashMap&lt;Integer, List&gt;();</li>\n</ol>\n<ul>\n<li>This is to store store number of cities as key and states as the value. Note here states are stored in a list because multiple states can have same number of cities.</li>\n</ul>\n<ol start=\"2\">\n<li><p>Make a list (size_list) out of keys of map in point 1. (Keys are number of cities for different states). Order this list in descending order</p>\n</li>\n<li><p>While iterating your &quot;states&quot; Hashmap, use size_list as a lookup and fetch the list of states with the current size from size_map HashMap. Basically use size_list as a lookup.</p>\n</li>\n</ol>\n<p>Note - this will increase your overhead and performance might not be great.</p>\n<pre><code>    Map&lt;String, Map&lt;String, Integer&gt;&gt; states = new ConcurrentHashMap&lt;String, Map&lt;String, Integer&gt;&gt;();\n\n    //create size HashMap -- store number of cities as key and value would be list of states \n    Map&lt;Integer, List&lt;String&gt;&gt; size_map = new HashMap&lt;Integer, List&lt;String&gt;&gt;();\n\n    for(Map.Entry&lt;String, Map&lt;String, Integer&gt;&gt; entry : states.entrySet())\n    {\n        int size = entry.getValue().size();\n        String state = entry.getKey();\n        if(size_map.containsKey(size))\n        {\n            List&lt;String&gt; retreived_list = size_map.get(size);\n            retreived_list.add(state);\n            size_map.put(size, retreived_list);\n        }\n        else\n        {\n            List&lt;String&gt; retreived_list = new ArrayList&lt;String&gt;();\n            retreived_list.add(state);\n            size_map.put(size, retreived_list);\n        }\n    }\n\n    //create a list out of size_map keys and sort it in descending order\n    List&lt;Integer&gt; size_list = new ArrayList&lt;Integer&gt;(size_map.keySet());\n    Collections.sort(size_list, Collections.reverseOrder());\n\n    //index will be current index in size_list, fetch states list from size_map and look for the same state in the original &quot;state&quot; hashmap\n    int index =0;\n    for(Map.Entry&lt;String, Map&lt;String, Integer&gt;&gt; entry : states.entrySet())\n    {\n        int current_size = size_list.get(index);\n        List&lt;String&gt; states_list = size_map.get(current_size);\n\n        for(String s : states_list)\n        {\n            System.out.println(&quot;State:&quot; + s);\n            Map&lt;String, Integer&gt; tempMap = states.get(s);\n            for(Map.Entry&lt;String, Integer&gt; innerEntry : tempMap.entrySet()) {\n                System.out.println(&quot;City:&quot; + innerEntry.getKey() + &quot; Count:&quot; + innerEntry.getValue());\n            }\n        }\n        index++;\n        System.out.println();\n    }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":9190353,"reputation":457,"user_id":6831116,"display_name":"Gopinath Radhakrishnan"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656314743,"creation_date":1656314743,"answer_id":72768360,"question_id":72767758,"body_markdown":"You can use Streams API for sorting before print it out:\r\n\r\n```\r\nComparator&lt;Entry&lt;String, Map&lt;String, Integer&gt;&gt;&gt; entryComparator =\r\n        Comparator.comparingInt((Entry&lt;String, Map&lt;String, Integer&gt;&gt; entryOne) -&gt; entryOne.getValue().size());\r\n\r\n    for(Entry&lt;String, Map&lt;String, Integer&gt;&gt; entry : states.entrySet().stream().sorted(entryComparator.reversed()).collect(\r\n        Collectors.toList())) {\r\n      System.out.println(&quot;State:&quot; + entry.getKey());\r\n      Map&lt;String, Integer&gt; tempMap = entry.getValue();\r\n      for(Entry&lt;String, Integer&gt; innerEntry : tempMap.entrySet()) {\r\n        System.out.println(&quot;City:&quot; + innerEntry.getKey() + &quot; Count:&quot; + innerEntry.getValue());\r\n      }\r\n\r\n      System.out.println();\r\n    }\r\n```","title":"Print the contents of a HashMap in sorted order according to the Size of each HashMap nested inside the given HashMap","body":"<p>You can use Streams API for sorting before print it out:</p>\n<pre><code>Comparator&lt;Entry&lt;String, Map&lt;String, Integer&gt;&gt;&gt; entryComparator =\n        Comparator.comparingInt((Entry&lt;String, Map&lt;String, Integer&gt;&gt; entryOne) -&gt; entryOne.getValue().size());\n\n    for(Entry&lt;String, Map&lt;String, Integer&gt;&gt; entry : states.entrySet().stream().sorted(entryComparator.reversed()).collect(\n        Collectors.toList())) {\n      System.out.println(&quot;State:&quot; + entry.getKey());\n      Map&lt;String, Integer&gt; tempMap = entry.getValue();\n      for(Entry&lt;String, Integer&gt; innerEntry : tempMap.entrySet()) {\n        System.out.println(&quot;City:&quot; + innerEntry.getKey() + &quot; Count:&quot; + innerEntry.getValue());\n      }\n\n      System.out.println();\n    }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":8688409,"reputation":21,"user_id":6502031,"display_name":"nguyenhoavuong"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656317105,"creation_date":1656317105,"answer_id":72768811,"question_id":72767758,"body_markdown":"HashMap makes no guarantees as to the order of the map; in particular, it does not guarantee that the order will remain constant over time.\r\nUsing LinkedHashMap instead and that will look like:\r\n\r\n    Map sortedMap = new LinkedHashMap();\r\n    originalHashMap.entrySet().stream()\r\n         .sorted(Comparator.comparingInt(e -&gt; e.getValue().size()))\r\n         .forEachOrdered(e -&gt; sortedMap.put(e.getKey(), e.getValue()));\r\nNow, expected sorted map is sortedMap","title":"Print the contents of a HashMap in sorted order according to the Size of each HashMap nested inside the given HashMap","body":"<p>HashMap makes no guarantees as to the order of the map; in particular, it does not guarantee that the order will remain constant over time.\nUsing LinkedHashMap instead and that will look like:</p>\n<pre><code>Map sortedMap = new LinkedHashMap();\noriginalHashMap.entrySet().stream()\n     .sorted(Comparator.comparingInt(e -&gt; e.getValue().size()))\n     .forEachOrdered(e -&gt; sortedMap.put(e.getKey(), e.getValue()));\n</code></pre>\n<p>Now, expected sorted map is sortedMap</p>\n"},{"tags":[],"owner":{"display_name":"user17233545"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656317670,"creation_date":1656317670,"answer_id":72768939,"question_id":72767758,"body_markdown":"Try this.\r\n\r\n    Map&lt;String, Map&lt;String, Integer&gt;&gt; states = new ConcurrentHashMap&lt;String, Map&lt;String, Integer&gt;&gt;();\r\n    states.put(&quot;Texas&quot;, Map.of(&quot;Austin&quot;, 1));\r\n    states.put(&quot;Hawaii&quot;, Map.of(&quot;Honolulu&quot;, 1, &quot;Kihei&quot;, 1, &quot;Maui&quot;, 1));\r\n    states.put(&quot;California&quot;, Map.of(&quot;Newport Beach&quot;, 1)); \r\n\r\n    states.entrySet().stream()\r\n        .sorted(Comparator.comparing(e -&gt; -e.getValue().size()))\r\n        .forEach(e -&gt; {\r\n            System.out.println(&quot;State:&quot; + e.getKey());\r\n            e.getValue().entrySet().stream()\r\n                .forEach(f -&gt; System.out.println(&quot;City:&quot; + f.getKey() + &quot; Count:&quot; + f.getValue()));\r\n            System.out.println();\r\n        });\r\n\r\noutput:\r\n\r\n    State:Hawaii\r\n    City:Maui Count:1\r\n    City:Honolulu Count:1\r\n    City:Kihei Count:1\r\n    \r\n    State:Texas\r\n    City:Austin Count:1\r\n    \r\n    State:California\r\n    City:Newport Beach Count:1\r\n\r\n","title":"Print the contents of a HashMap in sorted order according to the Size of each HashMap nested inside the given HashMap","body":"<p>Try this.</p>\n<pre><code>Map&lt;String, Map&lt;String, Integer&gt;&gt; states = new ConcurrentHashMap&lt;String, Map&lt;String, Integer&gt;&gt;();\nstates.put(&quot;Texas&quot;, Map.of(&quot;Austin&quot;, 1));\nstates.put(&quot;Hawaii&quot;, Map.of(&quot;Honolulu&quot;, 1, &quot;Kihei&quot;, 1, &quot;Maui&quot;, 1));\nstates.put(&quot;California&quot;, Map.of(&quot;Newport Beach&quot;, 1)); \n\nstates.entrySet().stream()\n    .sorted(Comparator.comparing(e -&gt; -e.getValue().size()))\n    .forEach(e -&gt; {\n        System.out.println(&quot;State:&quot; + e.getKey());\n        e.getValue().entrySet().stream()\n            .forEach(f -&gt; System.out.println(&quot;City:&quot; + f.getKey() + &quot; Count:&quot; + f.getValue()));\n        System.out.println();\n    });\n</code></pre>\n<p>output:</p>\n<pre><code>State:Hawaii\nCity:Maui Count:1\nCity:Honolulu Count:1\nCity:Kihei Count:1\n\nState:Texas\nCity:Austin Count:1\n\nState:California\nCity:Newport Beach Count:1\n</code></pre>\n"},{"tags":[],"owner":{"account_id":23959668,"reputation":26587,"user_id":17949945,"display_name":"Alexander Ivanchenko"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1656319241,"creation_date":1656318044,"answer_id":72769014,"question_id":72767758,"body_markdown":"`HashMap` is not capable of maintaining the order, therefore you can&#39;t sort it.\r\n\r\nYou can dump the map contents into a list and sort it using a custom comparator. But there&#39;s something that you&#39;re missing - the way you&#39;re structuring the data is wrong, *state* and *cities* that belong to that *state* are two pieces of information are closely related to each other. Using a map to combine them together is an abuse of collections, it makes your code rigid and unmaintainable.\r\n\r\n&lt;h3&gt;Use the power of Objects&lt;/h3&gt;\r\n\r\nYour code doesn&#39;t become object-oriented automatically because of the fact that you&#39;re using an object-oriented language.\r\n\r\nThe correct approach would be to define `State` and `City` as classes and maintain a list of `State` objects instead of dealing with a nested *map*. \r\n\r\n```\r\nclass State {\r\n    private String name;\r\n    private List&lt;City&gt; cities = new ArrayList&lt;&gt;();\r\n    \r\n    public State(String name) {\r\n        this.name = name;\r\n    }\r\n    \r\n    public void addCity(City city) {\r\n        cities.add(city);\r\n    }\r\n    \r\n    public boolean removeCity(City city) {\r\n        return cities.remove(city);\r\n    }\r\n    \r\n    public List&lt;City&gt; getCities() {\r\n        return cities;\r\n    }\r\n    \r\n    @Override\r\n    public String toString() {\r\n        return &quot;State:&quot; + name + &quot;\\n&quot; +\r\n            cities.stream()\r\n                .map(City::toString)\r\n                .collect(Collectors.joining(&quot;\\n&quot;))\r\n            + &quot;\\n&quot;;\r\n    }\r\n}\r\n\r\nclass City {\r\n    private String name;\r\n    private int count;\r\n    \r\n    public City(String name, int count) {\r\n        this.name = name;\r\n        this.count = count;\r\n    }\r\n    \r\n    @Override\r\n    public String toString() {\r\n        return &quot;City:&quot; + name + &quot; Count:&quot; + count;\r\n    }\r\n}\r\n```\r\n\r\nThat&#39;s how you can use this classes in the client code:\r\n\r\n    public static void main(String[] args) {\r\n        List&lt;State&gt; states = new ArrayList&lt;&gt;();\r\n        State texas = new State(&quot;Texas&quot;);\r\n        texas.addCity(new City(&quot;Austin&quot;, 1));\r\n        \r\n        State hawaii = new State(&quot;Hawaii&quot;);\r\n        hawaii.addCity(new City(&quot;Honolulu&quot;, 1));\r\n        hawaii.addCity(new City(&quot;Kihei&quot;, 1));\r\n        hawaii.addCity(new City(&quot;Maui&quot;, 1));\r\n        \r\n        State california = new State(&quot;California&quot;);\r\n        california.addCity(new City(&quot;Newport Beach&quot;, 1));\r\n        \r\n        Collections.addAll(states, texas, hawaii, california);\r\n        \r\n        states.sort(Comparator.&lt;State&gt;comparingInt(state -&gt; state.getCities().size()).reversed());\r\n        \r\n        for (State state: states) {\r\n            System.out.println(state);\r\n        }\r\n    }\r\n\r\n*Output:*\r\n```\r\nState:Hawaii\r\nCity:Honolulu Count:1\r\nCity:Kihei Count:1\r\nCity:Maui Count:1\r\n\r\nState:Texas\r\nCity:Austin Count:1\r\n\r\nState:California\r\nCity:Newport Beach Count:1\r\n```","title":"Print the contents of a HashMap in sorted order according to the Size of each HashMap nested inside the given HashMap","body":"<p><code>HashMap</code> is not capable of maintaining the order, therefore you can't sort it.</p>\n<p>You can dump the map contents into a list and sort it using a custom comparator. But there's something that you're missing - the way you're structuring the data is wrong, <em>state</em> and <em>cities</em> that belong to that <em>state</em> are two pieces of information are closely related to each other. Using a map to combine them together is an abuse of collections, it makes your code rigid and unmaintainable.</p>\n<h3>Use the power of Objects</h3>\n<p>Your code doesn't become object-oriented automatically because of the fact that you're using an object-oriented language.</p>\n<p>The correct approach would be to define <code>State</code> and <code>City</code> as classes and maintain a list of <code>State</code> objects instead of dealing with a nested <em>map</em>.</p>\n<pre><code>class State {\n    private String name;\n    private List&lt;City&gt; cities = new ArrayList&lt;&gt;();\n    \n    public State(String name) {\n        this.name = name;\n    }\n    \n    public void addCity(City city) {\n        cities.add(city);\n    }\n    \n    public boolean removeCity(City city) {\n        return cities.remove(city);\n    }\n    \n    public List&lt;City&gt; getCities() {\n        return cities;\n    }\n    \n    @Override\n    public String toString() {\n        return &quot;State:&quot; + name + &quot;\\n&quot; +\n            cities.stream()\n                .map(City::toString)\n                .collect(Collectors.joining(&quot;\\n&quot;))\n            + &quot;\\n&quot;;\n    }\n}\n\nclass City {\n    private String name;\n    private int count;\n    \n    public City(String name, int count) {\n        this.name = name;\n        this.count = count;\n    }\n    \n    @Override\n    public String toString() {\n        return &quot;City:&quot; + name + &quot; Count:&quot; + count;\n    }\n}\n</code></pre>\n<p>That's how you can use this classes in the client code:</p>\n<pre><code>public static void main(String[] args) {\n    List&lt;State&gt; states = new ArrayList&lt;&gt;();\n    State texas = new State(&quot;Texas&quot;);\n    texas.addCity(new City(&quot;Austin&quot;, 1));\n    \n    State hawaii = new State(&quot;Hawaii&quot;);\n    hawaii.addCity(new City(&quot;Honolulu&quot;, 1));\n    hawaii.addCity(new City(&quot;Kihei&quot;, 1));\n    hawaii.addCity(new City(&quot;Maui&quot;, 1));\n    \n    State california = new State(&quot;California&quot;);\n    california.addCity(new City(&quot;Newport Beach&quot;, 1));\n    \n    Collections.addAll(states, texas, hawaii, california);\n    \n    states.sort(Comparator.&lt;State&gt;comparingInt(state -&gt; state.getCities().size()).reversed());\n    \n    for (State state: states) {\n        System.out.println(state);\n    }\n}\n</code></pre>\n<p><em>Output:</em></p>\n<pre><code>State:Hawaii\nCity:Honolulu Count:1\nCity:Kihei Count:1\nCity:Maui Count:1\n\nState:Texas\nCity:Austin Count:1\n\nState:California\nCity:Newport Beach Count:1\n</code></pre>\n"}],"owner":{"account_id":8826140,"reputation":39,"user_id":16999008,"display_name":"Vinula Senarathne"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":159,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":72769014,"answer_count":6,"score":0,"last_activity_date":1656332986,"creation_date":1656311292,"question_id":72767758,"body_markdown":"I have a `HashMap` inside a `HashMap`. I want to print the elements in the `HashMap` according to the size of elements in the inner `HashMap`. So the element with the highest number of elements should print first. I&#39;m new to HashMaps and got stuck.\r\n\r\nThis is the `HashMap` and how I&#39;m printing it:\r\n```\r\nMap&lt;String, Map&lt;String, Integer&gt;&gt; states = new ConcurrentHashMap&lt;String, Map&lt;String, Integer&gt;&gt;();\r\n\r\nfor(Entry&lt;String, Map&lt;String, Integer&gt;&gt; entry : states.entrySet()) {\r\n\r\n\tSystem.out.println(&quot;State:&quot; + entry.getKey());\r\n\r\n\tMap&lt;String, Integer&gt; tempMap = entry.getValue();\r\n\r\n\tfor(Entry&lt;String, Integer&gt; innerEntry : tempMap.entrySet()) {\r\n\t\tSystem.out.println(&quot;City:&quot; + innerEntry.getKey() + &quot; Count:&quot; + innerEntry.getValue());\r\n\t}\r\n\t\r\n\tSystem.out.println();\r\n}\r\n```\r\nThe output that I&#39;m currently getting:\r\n\r\n    State:Texas\r\n    City:Austin Count:1\r\n\r\n    State:Hawaii\r\n    City:Honolulu Count:1\r\n    City:Kihei Count:1\r\n    City:Maui Count:1\r\n\r\n    State:California\r\n    City:Newport Beach Count:1\r\n\r\nThe output I need:\r\n\r\n    State:Hawaii\r\n    City:Honolulu Count:1\r\n    City:Kihei Count:1\r\n    City:Maui Count:1\r\n\r\n    State:Texas\r\n    City:Austin Count:1\r\n\r\n    State:california\r\n    City:Newport Beach Count:1","title":"Print the contents of a HashMap in sorted order according to the Size of each HashMap nested inside the given HashMap","body":"<p>I have a <code>HashMap</code> inside a <code>HashMap</code>. I want to print the elements in the <code>HashMap</code> according to the size of elements in the inner <code>HashMap</code>. So the element with the highest number of elements should print first. I'm new to HashMaps and got stuck.</p>\n<p>This is the <code>HashMap</code> and how I'm printing it:</p>\n<pre><code>Map&lt;String, Map&lt;String, Integer&gt;&gt; states = new ConcurrentHashMap&lt;String, Map&lt;String, Integer&gt;&gt;();\n\nfor(Entry&lt;String, Map&lt;String, Integer&gt;&gt; entry : states.entrySet()) {\n\n    System.out.println(&quot;State:&quot; + entry.getKey());\n\n    Map&lt;String, Integer&gt; tempMap = entry.getValue();\n\n    for(Entry&lt;String, Integer&gt; innerEntry : tempMap.entrySet()) {\n        System.out.println(&quot;City:&quot; + innerEntry.getKey() + &quot; Count:&quot; + innerEntry.getValue());\n    }\n    \n    System.out.println();\n}\n</code></pre>\n<p>The output that I'm currently getting:</p>\n<pre><code>State:Texas\nCity:Austin Count:1\n\nState:Hawaii\nCity:Honolulu Count:1\nCity:Kihei Count:1\nCity:Maui Count:1\n\nState:California\nCity:Newport Beach Count:1\n</code></pre>\n<p>The output I need:</p>\n<pre><code>State:Hawaii\nCity:Honolulu Count:1\nCity:Kihei Count:1\nCity:Maui Count:1\n\nState:Texas\nCity:Austin Count:1\n\nState:california\nCity:Newport Beach Count:1\n</code></pre>\n"},{"tags":["java","spring-boot","apache-camel"],"answers":[{"tags":[],"owner":{"account_id":1901420,"reputation":3763,"user_id":1717210,"display_name":"TacheDeChoco"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1656332803,"creation_date":1656321007,"answer_id":72769582,"question_id":72766634,"body_markdown":"I think you should decouple the scanning of the files from the processing of the files. \r\nIn particular, there is maybe no real need to **read** a same file multiple times on the SFTP server, but only to **process** its content multiple times.\r\n\r\nThis could end up to something like:\r\n\r\n    from(&quot;sftp://server/folder1&quot;)\r\n    .to(&quot;direct:processing1&quot;);\r\n    \r\n    from(&quot;sftp://server/folder2&quot;)\r\n    .to(&quot;direct:processing2&quot;);\r\n    \r\n    from(&quot;sftp://server/folder3&quot;)\r\n    .to(&quot;direct:processing3&quot;);\r\n    \r\n    from(&quot;sftp://server/toplevel&quot;)\r\n    .multicast().parallelProcessing()\r\n    \t.to(&quot;direct:processing1&quot;)\r\n    \t.to(&quot;direct:processing2&quot;)\r\n    \t.to(&quot;direct:processing3&quot;)\r\n    .end();\t\r\n\r\n","title":"copy file to multiple folders with Camel SFTP","body":"<p>I think you should decouple the scanning of the files from the processing of the files.\nIn particular, there is maybe no real need to <strong>read</strong> a same file multiple times on the SFTP server, but only to <strong>process</strong> its content multiple times.</p>\n<p>This could end up to something like:</p>\n<pre><code>from(&quot;sftp://server/folder1&quot;)\n.to(&quot;direct:processing1&quot;);\n\nfrom(&quot;sftp://server/folder2&quot;)\n.to(&quot;direct:processing2&quot;);\n\nfrom(&quot;sftp://server/folder3&quot;)\n.to(&quot;direct:processing3&quot;);\n\nfrom(&quot;sftp://server/toplevel&quot;)\n.multicast().parallelProcessing()\n    .to(&quot;direct:processing1&quot;)\n    .to(&quot;direct:processing2&quot;)\n    .to(&quot;direct:processing3&quot;)\n.end(); \n</code></pre>\n"}],"owner":{"account_id":1540581,"reputation":133,"user_id":1435362,"display_name":"R M"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":280,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"accepted_answer_id":72769582,"answer_count":1,"score":0,"last_activity_date":1656332803,"creation_date":1656299346,"question_id":72766634,"body_markdown":"I have a situation where I pull a file from a folder via a Camel SFTP route. There are 3 other Camel routes which need to process the **same file** which I am pulling... the other routes monitor the ***same SFTP server***.\r\n\r\nCurrently, we are thinking that we should make that file which I pull, available to the 3 other routes by placing a copy of the file in 3 separate folders where each folder is monitored by one of those other 3 routes... one unique folder for each of the 3 routes.\r\n\r\nWhen the other routes detect the presence of the file I would copy, they would fire up and proceed as required.\r\n\r\nThe first question is whether this is a reasonable means of handling the scenario I just described or whether there is a better way. \r\n\r\nSecondly, assuming the scenario is reasonable, the question is what is the best way to handle propagating the file I pull to 3 different folders on the same SFTP server.\r\n\r\nFor what it&#39;s worth, we are using Spring XML DSL.","title":"copy file to multiple folders with Camel SFTP","body":"<p>I have a situation where I pull a file from a folder via a Camel SFTP route. There are 3 other Camel routes which need to process the <strong>same file</strong> which I am pulling... the other routes monitor the <em><strong>same SFTP server</strong></em>.</p>\n<p>Currently, we are thinking that we should make that file which I pull, available to the 3 other routes by placing a copy of the file in 3 separate folders where each folder is monitored by one of those other 3 routes... one unique folder for each of the 3 routes.</p>\n<p>When the other routes detect the presence of the file I would copy, they would fire up and proceed as required.</p>\n<p>The first question is whether this is a reasonable means of handling the scenario I just described or whether there is a better way.</p>\n<p>Secondly, assuming the scenario is reasonable, the question is what is the best way to handle propagating the file I pull to 3 different folders on the same SFTP server.</p>\n<p>For what it's worth, we are using Spring XML DSL.</p>\n"},{"tags":["java","methods","constructor"],"comments":[{"owner":{"account_id":1190755,"reputation":48912,"user_id":1163607,"accept_rate":97,"display_name":"AllTooSir"},"score":0,"creation_date":1374144556,"post_id":17721316,"comment_id":25829754,"body_markdown":"There are many uses of constructor other than housing executable functionality !","body":"There are many uses of constructor other than housing executable functionality !"},{"owner":{"account_id":390163,"reputation":17713,"user_id":750040,"accept_rate":68,"display_name":"Santosh"},"score":0,"creation_date":1374146880,"post_id":17721316,"comment_id":25830971,"body_markdown":"http://www.javaworld.com/jw-10-2000/jw-1013-constructors.html","body":"<a href=\"http://www.javaworld.com/jw-10-2000/jw-1013-constructors.html\" rel=\"nofollow noreferrer\">javaworld.com/jw-10-2000/jw-1013-constructors.html</a>"}],"answers":[{"tags":[],"owner":{"account_id":368269,"reputation":93629,"user_id":714969,"accept_rate":86,"display_name":"Kevin Bowersox"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1374144786,"creation_date":1374144473,"answer_id":17721366,"question_id":17721316,"body_markdown":"One of the benefits of using a constructor over a method is that you can be assured the constructor was called and the work within the constructor was performed.\r\n\r\nThe language specifies that to construct an object a constructor must be called.  So if you use a custom method to establish the initial state of your object, you will need to call the default constructor first.  Why make two method calls when you can perform the work in one call the constructor and be assured the object has been properly initialized?\r\n\r\n    public class Test(){\r\n        \r\n        private Integer x;\r\n    \r\n        public Test(){\r\n    \r\n        }\r\n    \r\n        public Test(Integer x){\r\n           this.x = x;\r\n        }\r\n    \r\n        public void setX(Integer x){\r\n           this.x = x;\r\n        }\r\n    \r\n        public void doSomethingWithX(){\r\n           this.x.toString();\r\n        }\r\n    }\r\n    \r\n    Test test = new Test(8);\r\n    test.doSomethingWithX(); //I know x has been declared and assigned\r\n    \r\n    Test test = new Test();\r\n    test.doSomethingWithX(); //X has not been assigned results in NPE\r\n\r\n","title":"what is the extra benefit of creating constructor in java?","body":"<p>One of the benefits of using a constructor over a method is that you can be assured the constructor was called and the work within the constructor was performed.</p>\n\n<p>The language specifies that to construct an object a constructor must be called.  So if you use a custom method to establish the initial state of your object, you will need to call the default constructor first.  Why make two method calls when you can perform the work in one call the constructor and be assured the object has been properly initialized?</p>\n\n<pre><code>public class Test(){\n\n    private Integer x;\n\n    public Test(){\n\n    }\n\n    public Test(Integer x){\n       this.x = x;\n    }\n\n    public void setX(Integer x){\n       this.x = x;\n    }\n\n    public void doSomethingWithX(){\n       this.x.toString();\n    }\n}\n\nTest test = new Test(8);\ntest.doSomethingWithX(); //I know x has been declared and assigned\n\nTest test = new Test();\ntest.doSomethingWithX(); //X has not been assigned results in NPE\n</code></pre>\n"},{"tags":[],"owner":{"account_id":3008925,"reputation":1124,"user_id":2552825,"accept_rate":75,"display_name":"Benjamin Schwalb"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1374145075,"creation_date":1374144696,"answer_id":17721446,"question_id":17721316,"body_markdown":"If you create a new Object of `MyClass` it will automatically call the constructor - you can initialize all members within it, and be sure that this object&#180;s members are all initialized.\r\n\r\n**Generally:**  \r\nA constructor is **always** called *once* when you create a new Object of this class, and you **can&#180;t** call it manually.   \r\nAnd **don&#180;t** do &quot;real&quot; work in a constructor, as it will slow down the creation of objects of this class - only initialize your class/members there.\r\n\r\nYou can also use different constructors, depending on your needs - but if you create a constructor, there is no more default constructor!\r\n\r\n**Example:**\r\n\r\n    public MyClass {\r\n    \r\n       int score;\r\n    \r\n       public MyClass(int sc) { // already know the score\r\n        score = sc;\r\n       }\r\n       \r\n       public MyClass() { // don&#180;t know the score yet\r\n        score = 1;\r\n       }\r\n    \r\n       public void addScore() {\r\n       score += 5;   // i know for sure that score is not zero \r\n       }\r\n    \r\n    }","title":"what is the extra benefit of creating constructor in java?","body":"<p>If you create a new Object of <code>MyClass</code> it will automatically call the constructor - you can initialize all members within it, and be sure that this object´s members are all initialized.</p>\n\n<p><strong>Generally:</strong><br>\nA constructor is <strong>always</strong> called <em>once</em> when you create a new Object of this class, and you <strong>can´t</strong> call it manually.<br>\nAnd <strong>don´t</strong> do \"real\" work in a constructor, as it will slow down the creation of objects of this class - only initialize your class/members there.</p>\n\n<p>You can also use different constructors, depending on your needs - but if you create a constructor, there is no more default constructor!</p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>public MyClass {\n\n   int score;\n\n   public MyClass(int sc) { // already know the score\n    score = sc;\n   }\n\n   public MyClass() { // don´t know the score yet\n    score = 1;\n   }\n\n   public void addScore() {\n   score += 5;   // i know for sure that score is not zero \n   }\n\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1190755,"reputation":48912,"user_id":1163607,"accept_rate":97,"display_name":"AllTooSir"},"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1374150865,"creation_date":1374144713,"answer_id":17721453,"question_id":17721316,"body_markdown":"Some points :\r\n\r\n1) Constructors are the only way to set `final` instance variables .\r\n\r\n    public class SomeType {\r\n\t   final int x ;\r\n\t   SomeType(int y){\r\n\t     x=y;\r\n\t   }\r\n    }\r\n\r\n\r\n2) A class with `private` constructor cannot be sub classed.\r\n\r\n3) If your class is a subclass and the base class doesn&#39;t have a default constructor , then you need a constructor in your class to call the super class constructor.","title":"what is the extra benefit of creating constructor in java?","body":"<p>Some points :</p>\n\n<p>1) Constructors are the only way to set <code>final</code> instance variables .</p>\n\n<pre><code>public class SomeType {\n   final int x ;\n   SomeType(int y){\n     x=y;\n   }\n}\n</code></pre>\n\n<p>2) A class with <code>private</code> constructor cannot be sub classed.</p>\n\n<p>3) If your class is a subclass and the base class doesn't have a default constructor , then you need a constructor in your class to call the super class constructor.</p>\n"},{"tags":[],"owner":{"account_id":2776621,"reputation":12858,"user_id":2390083,"accept_rate":75,"display_name":"Beryllium"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1374144781,"creation_date":1374144781,"answer_id":17721476,"question_id":17721316,"body_markdown":"You can set `final` fields without initializer in a constructor. This helps to build `immutable` instances:\r\n\r\n    class Number extends Expr {\r\n        private final int n;\r\n    \r\n        public Number(int n) {\r\n            this.n = n;\r\n        }\r\n    \r\n        public int getValue() {\r\n            return this.n;\r\n        }\r\n    }\r\n\r\nSo after a constructor like this, you can rely on the fact that the instance is *initialized completely* (and in this case, it&#39;s values are *immutable/constant*).","title":"what is the extra benefit of creating constructor in java?","body":"<p>You can set <code>final</code> fields without initializer in a constructor. This helps to build <code>immutable</code> instances:</p>\n\n<pre><code>class Number extends Expr {\n    private final int n;\n\n    public Number(int n) {\n        this.n = n;\n    }\n\n    public int getValue() {\n        return this.n;\n    }\n}\n</code></pre>\n\n<p>So after a constructor like this, you can rely on the fact that the instance is <em>initialized completely</em> (and in this case, it's values are <em>immutable/constant</em>).</p>\n"},{"tags":[],"owner":{"account_id":2246868,"reputation":3649,"user_id":1980029,"accept_rate":77,"display_name":"robjohncox"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1374145320,"creation_date":1374144802,"answer_id":17721483,"question_id":17721316,"body_markdown":"Essentially a constructor is just a special method that implicitly returns an object of its containing type. You should generally use constructors for creating objects - this is what people expect to see.\r\n\r\nHowever, there is a useful idiom called the `factory method` (more info at [this link][1]) which is essentially using a static method to construct an object, the key advantages being \r\n\r\n - You can give a factory method a more descriptive name (whereas of course a standard constructor has to be named after the containing class).\r\n - They don&#39;t *have* to return an object, giving more flexibility.\r\n - They can return a sub-types of the class.\r\n\r\n\r\n  [1]: http://my.safaribooksonline.com/book/programming/java/9780137150021/creating-and-destroying-objects/ch02lev1sec1","title":"what is the extra benefit of creating constructor in java?","body":"<p>Essentially a constructor is just a special method that implicitly returns an object of its containing type. You should generally use constructors for creating objects - this is what people expect to see.</p>\n\n<p>However, there is a useful idiom called the <code>factory method</code> (more info at <a href=\"http://my.safaribooksonline.com/book/programming/java/9780137150021/creating-and-destroying-objects/ch02lev1sec1\" rel=\"nofollow\">this link</a>) which is essentially using a static method to construct an object, the key advantages being </p>\n\n<ul>\n<li>You can give a factory method a more descriptive name (whereas of course a standard constructor has to be named after the containing class).</li>\n<li>They don't <em>have</em> to return an object, giving more flexibility.</li>\n<li>They can return a sub-types of the class.</li>\n</ul>\n"},{"tags":[],"owner":{"account_id":2535949,"reputation":1607,"user_id":2203061,"accept_rate":80,"display_name":"Zain Zafar"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1374145089,"creation_date":1374145089,"answer_id":17721566,"question_id":17721316,"body_markdown":"Constructor is not like simple methods. It is called every time when the object of that particular class is created. You don&#39;t need to call it explicitly.\r\n\r\n\r\n----------\r\n\r\n\r\nThere are somethings that we need to do immediately when the object is created, for instance when you create a  GUI kind of thing you want to set many properties on the time of creation like size of window etc.\r\nAnother benefit of constructor is security of class. You cannot create a object unless you know the right perimeters of constructor.\r\n\r\n\r\n----------\r\n\r\n\r\nMore details:http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html","title":"what is the extra benefit of creating constructor in java?","body":"<p>Constructor is not like simple methods. It is called every time when the object of that particular class is created. You don't need to call it explicitly.</p>\n\n<hr>\n\n<p>There are somethings that we need to do immediately when the object is created, for instance when you create a  GUI kind of thing you want to set many properties on the time of creation like size of window etc.\nAnother benefit of constructor is security of class. You cannot create a object unless you know the right perimeters of constructor.</p>\n\n<hr>\n\n<p>More details:<a href=\"http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html\" rel=\"nofollow\">http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html</a></p>\n"},{"tags":[],"owner":{"account_id":3045659,"reputation":4786,"user_id":2581401,"display_name":"c.s."},"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1374149576,"creation_date":1374146982,"answer_id":17722237,"question_id":17721316,"body_markdown":"A constructor and a method are two different things. The fact that you can write the same or similar code inside them is irrelevant.\r\n\r\nWhen a new object is created a constructor is called. If you don&#39;t specify one the compiler will create a default one for you. This is the place where initializaton of the object&#39;s  fields takes place and memory is allocated for the object. This is a concept that all object-oriented languages have. A new object must be initialized somehow. Memory needs to be allocated. In Java you don&#39;t manage the memory yourself (at least not directly anyway) so this is the purpose of the constructor. Note that since a constructor is always executed, this behaviour is **enforced** as soon as you call e.g. `Person p = new Person();`.\r\n\r\nNow since a constructor is always being called, you have an option here: do you let the default constructor execute or do you create one yourself? Perhaps there are fields that need to be initialized in a way other than their default values. Or perhaps you need to not allow creating an object without providing some values. If you define a constructor yourself, the compiler *does not create a default one for you*. So if I have `public Person(String firstName, String lastName) {}` then I have created a specific rule that is again enforced by the system: a new object of class Person cannot be created unless you give a first name and last name: \r\n\r\n    Person p = new Person(); // this would give a compile error\r\n    Person p = new Person(&quot;John&quot;, &quot;Smith&quot;); // this is the only way to create an object now\r\n\r\nUsing a method you cannot enforce this. The programmer using your class might call your method or not. The constructor is a part of the *lifecycle* of the object. Methods define the *behaviour* of the object\r\n","title":"what is the extra benefit of creating constructor in java?","body":"<p>A constructor and a method are two different things. The fact that you can write the same or similar code inside them is irrelevant.</p>\n\n<p>When a new object is created a constructor is called. If you don't specify one the compiler will create a default one for you. This is the place where initializaton of the object's  fields takes place and memory is allocated for the object. This is a concept that all object-oriented languages have. A new object must be initialized somehow. Memory needs to be allocated. In Java you don't manage the memory yourself (at least not directly anyway) so this is the purpose of the constructor. Note that since a constructor is always executed, this behaviour is <strong>enforced</strong> as soon as you call e.g. <code>Person p = new Person();</code>.</p>\n\n<p>Now since a constructor is always being called, you have an option here: do you let the default constructor execute or do you create one yourself? Perhaps there are fields that need to be initialized in a way other than their default values. Or perhaps you need to not allow creating an object without providing some values. If you define a constructor yourself, the compiler <em>does not create a default one for you</em>. So if I have <code>public Person(String firstName, String lastName) {}</code> then I have created a specific rule that is again enforced by the system: a new object of class Person cannot be created unless you give a first name and last name: </p>\n\n<pre><code>Person p = new Person(); // this would give a compile error\nPerson p = new Person(\"John\", \"Smith\"); // this is the only way to create an object now\n</code></pre>\n\n<p>Using a method you cannot enforce this. The programmer using your class might call your method or not. The constructor is a part of the <em>lifecycle</em> of the object. Methods define the <em>behaviour</em> of the object</p>\n"},{"tags":[],"owner":{"account_id":9008999,"reputation":3602,"user_id":6714430,"display_name":"rashedcs"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1492951908,"creation_date":1492951006,"answer_id":43571252,"question_id":17721316,"body_markdown":"&gt;A constructor is a special method of a class or structure in object-oriented programming that initializes an object of that type.\r\n\r\n**Some points :** \r\n \r\n    1. A constructor eliminates placing the default values.\r\n    2. A constructor eliminates calling the normal method implicitly.\r\n","title":"what is the extra benefit of creating constructor in java?","body":"<blockquote>\n  <p>A constructor is a special method of a class or structure in object-oriented programming that initializes an object of that type.</p>\n</blockquote>\n\n<p><strong>Some points :</strong> </p>\n\n<pre><code>1. A constructor eliminates placing the default values.\n2. A constructor eliminates calling the normal method implicitly.\n</code></pre>\n"},{"tags":[],"owner":{"account_id":9799895,"reputation":31,"user_id":7261574,"display_name":"Isuru"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656332765,"creation_date":1656332765,"answer_id":72772085,"question_id":17721316,"body_markdown":"These are the benefits of constructors.\r\n\r\n - Automatic initialization of objects at the time of their declaration.\r\n - Multiple ways to initialize objects according to the number of\r\n   arguments passes while declaration. \r\n - The objects of child class can be initialised by the constructors of base class.","title":"what is the extra benefit of creating constructor in java?","body":"<p>These are the benefits of constructors.</p>\n<ul>\n<li>Automatic initialization of objects at the time of their declaration.</li>\n<li>Multiple ways to initialize objects according to the number of\narguments passes while declaration.</li>\n<li>The objects of child class can be initialised by the constructors of base class.</li>\n</ul>\n"}],"owner":{"account_id":2075020,"reputation":4964,"user_id":1848639,"accept_rate":73,"display_name":"Tushar Monirul"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":17968,"favorite_count":0,"down_vote_count":0,"up_vote_count":7,"answer_count":9,"score":7,"last_activity_date":1656332765,"creation_date":1374144353,"question_id":17721316,"body_markdown":"I have noticed a thing that a constructor and a simple method of a class do the same work. what is the exact reason to create a construct of a class? If i create `MyClass(){}` constructor and `MyClassMethod(){}` method it will do the same work as I write the body part of those method and constructor. So what is the need of construct? Does it have any special use ? ","title":"what is the extra benefit of creating constructor in java?","body":"<p>I have noticed a thing that a constructor and a simple method of a class do the same work. what is the exact reason to create a construct of a class? If i create <code>MyClass(){}</code> constructor and <code>MyClassMethod(){}</code> method it will do the same work as I write the body part of those method and constructor. So what is the need of construct? Does it have any special use ? </p>\n"},{"tags":["java","rocketmq"],"answers":[{"tags":[],"owner":{"account_id":2386817,"reputation":15505,"user_id":2087628,"accept_rate":42,"display_name":"JaskeyLam"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1656332497,"creation_date":1656332497,"answer_id":72772031,"question_id":72684579,"body_markdown":"Actually you needn&#39;t. Since you can already got the consumer group name in the callback method from your consumer instance by \r\n\r\n```\r\nconsumer.getConsumerGroup().\r\n```\r\n\r\n\r\nMaybe you will need to define a non-anonymous instance for the listener.\r\n\r\nYou can try \r\n\r\n```\r\npublic class MyMessageListenerConcurrently implements MessageListenerConcurrently{\r\n    private String consumerGroupName;\r\n    public MyMessageListenerConcurrently(String consumerGroupName) {\r\n        this.consumerGroupName = consumerGroupName\r\n    }\r\n    ....\r\n}\r\n```\r\n\r\nAnd when you register:\r\n\r\n```\r\n    consumer.registerMessageListener(new MyMessageListenerConcurrently(consumer.getConsumerGroup()));\r\n\r\n```","title":"is it possible to get the group name from registerMessageListener in RocketMQ","body":"<p>Actually you needn't. Since you can already got the consumer group name in the callback method from your consumer instance by</p>\n<pre><code>consumer.getConsumerGroup().\n</code></pre>\n<p>Maybe you will need to define a non-anonymous instance for the listener.</p>\n<p>You can try</p>\n<pre><code>public class MyMessageListenerConcurrently implements MessageListenerConcurrently{\n    private String consumerGroupName;\n    public MyMessageListenerConcurrently(String consumerGroupName) {\n        this.consumerGroupName = consumerGroupName\n    }\n    ....\n}\n</code></pre>\n<p>And when you register:</p>\n<pre><code>    consumer.registerMessageListener(new MyMessageListenerConcurrently(consumer.getConsumerGroup()));\n\n</code></pre>\n"}],"owner":{"account_id":3106126,"reputation":31241,"user_id":2628868,"accept_rate":84,"display_name":"Dolphin"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":61,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":72772031,"answer_count":1,"score":0,"last_activity_date":1656332497,"creation_date":1655715664,"question_id":72684579,"body_markdown":"I am using RocketMQ as the message center, this is the consumer dependencies jar:\r\n\r\n    &lt;dependency&gt;\r\n                &lt;groupId&gt;org.apache.rocketmq&lt;/groupId&gt;\r\n                &lt;artifactId&gt;rocketmq-client&lt;/artifactId&gt;\r\n                &lt;version&gt;4.9.1&lt;/version&gt;\r\n            &lt;/dependency&gt;\r\n\r\n\r\n this is part of the conumser code:\r\n\r\n\r\n    consumer.registerMessageListener(new MessageListenerConcurrently() {\r\n                @Override\r\n                public ConsumeConcurrentlyStatus consumeMessage(List&lt;MessageExt&gt; msgs, ConsumeConcurrentlyContext context) {\r\n                    for (MessageExt message : msgs) {\r\n                        String params = new String(message.getBody(), StandardCharsets.UTF_8);\r\n                        ObjectMapper mapper = new ObjectMapper();\r\n                        try {\r\n                            Map&lt;String, Object&gt; parameters = mapper.readValue(params, Map.class);\r\n                            String messageTopic = context.getMessageQueue().getTopic();\r\n                            // what should I do to get the group name ?\r\n                        } catch (JsonProcessingException e) {\r\n                            throw new RuntimeException(e);\r\n                        }\r\n                    }\r\n                    return ConsumeConcurrentlyStatus.CONSUME_SUCCESS;\r\n                }\r\n            });\r\n            consumer.start();\r\n\r\n\r\n\r\n\r\nin this code block, I want to get the consumerGroup name, I tracing into the `ConsumeConcurrentlyContext` class and only found the topic, did not found the consumerGroup name. is it possible to get the consumerGroup name from the registerMessageListener block?\r\n\r\n\r\n\r\n\r\n\r\n\r\n","title":"is it possible to get the group name from registerMessageListener in RocketMQ","body":"<p>I am using RocketMQ as the message center, this is the consumer dependencies jar:</p>\n<pre><code>&lt;dependency&gt;\n            &lt;groupId&gt;org.apache.rocketmq&lt;/groupId&gt;\n            &lt;artifactId&gt;rocketmq-client&lt;/artifactId&gt;\n            &lt;version&gt;4.9.1&lt;/version&gt;\n        &lt;/dependency&gt;\n</code></pre>\n<p>this is part of the conumser code:</p>\n<pre><code>consumer.registerMessageListener(new MessageListenerConcurrently() {\n            @Override\n            public ConsumeConcurrentlyStatus consumeMessage(List&lt;MessageExt&gt; msgs, ConsumeConcurrentlyContext context) {\n                for (MessageExt message : msgs) {\n                    String params = new String(message.getBody(), StandardCharsets.UTF_8);\n                    ObjectMapper mapper = new ObjectMapper();\n                    try {\n                        Map&lt;String, Object&gt; parameters = mapper.readValue(params, Map.class);\n                        String messageTopic = context.getMessageQueue().getTopic();\n                        // what should I do to get the group name ?\n                    } catch (JsonProcessingException e) {\n                        throw new RuntimeException(e);\n                    }\n                }\n                return ConsumeConcurrentlyStatus.CONSUME_SUCCESS;\n            }\n        });\n        consumer.start();\n</code></pre>\n<p>in this code block, I want to get the consumerGroup name, I tracing into the <code>ConsumeConcurrentlyContext</code> class and only found the topic, did not found the consumerGroup name. is it possible to get the consumerGroup name from the registerMessageListener block?</p>\n"},{"tags":["java","scala","maven","google-cloud-dataflow","apache-beam"],"comments":[{"owner":{"account_id":1330861,"reputation":1329,"user_id":1274818,"accept_rate":80,"display_name":"tysonjh"},"score":1,"creation_date":1616443719,"post_id":66740569,"comment_id":117999912,"body_markdown":"Where are you getting this error? In IntelliJ? The `AutoValue_DynamicJdbcIO_DynamicRead` class is part of the AutoValue nested builder in the DynamicJdbcIO.java code you linked [1]. I wouldn&#39;t expect that it is a dependency issue because of that, but if it is IntelliJ it may just that you need to add that source code into your project by adding it in the project explorer and marking it as a source. [1]: https://github.com/GoogleCloudPlatform/DataflowTemplates/blob/92d3f3062856c3fb1aede24e4c12411ef7a29dc1/src/main/java/com/google/cloud/teleport/io/DynamicJdbcIO.java#L124","body":"Where are you getting this error? In IntelliJ? The <code>AutoValue_DynamicJdbcIO_DynamicRead</code> class is part of the AutoValue nested builder in the DynamicJdbcIO.java code you linked [1]. I wouldn&#39;t expect that it is a dependency issue because of that, but if it is IntelliJ it may just that you need to add that source code into your project by adding it in the project explorer and marking it as a source. [1]: <a href=\"https://github.com/GoogleCloudPlatform/DataflowTemplates/blob/92d3f3062856c3fb1aede24e4c12411ef7a29dc1/src/main/java/com/google/cloud/teleport/io/DynamicJdbcIO.java#L124\" rel=\"nofollow noreferrer\">github.com/GoogleCloudPlatform/DataflowTemplates/blob/&hellip;</a>"},{"owner":{"account_id":9587184,"reputation":2009,"user_id":7119501,"accept_rate":68,"display_name":"Metadata"},"score":0,"creation_date":1616476383,"post_id":66740569,"comment_id":118007274,"body_markdown":"I understand that and the error is on IntelliJ. The problem here is I am not able to find tha class anywhere. I tried to give the package name, jar name and the class name itself in Google but no search result contains the source code of the class. \nWhat should I do ?","body":"I understand that and the error is on IntelliJ. The problem here is I am not able to find tha class anywhere. I tried to give the package name, jar name and the class name itself in Google but no search result contains the source code of the class.  What should I do ?"},{"owner":{"account_id":1330861,"reputation":1329,"user_id":1274818,"accept_rate":80,"display_name":"tysonjh"},"score":0,"creation_date":1616531113,"post_id":66740569,"comment_id":118031041,"body_markdown":"Since AutoValue generates code, you need to compile the project, then find where that generated code is and add it to your project by right clicking on the directory in the project explorer and marking it as a source. Another option that could work, though I haven&#39;t tried it myself, is to use the AutoValue plugin: https://plugins.jetbrains.com/plugin/8091-autovalue-plugin","body":"Since AutoValue generates code, you need to compile the project, then find where that generated code is and add it to your project by right clicking on the directory in the project explorer and marking it as a source. Another option that could work, though I haven&#39;t tried it myself, is to use the AutoValue plugin: <a href=\"https://plugins.jetbrains.com/plugin/8091-autovalue-plugin\" rel=\"nofollow noreferrer\">plugins.jetbrains.com/plugin/8091-autovalue-plugin</a>"}],"answers":[{"tags":[],"owner":{"account_id":79171,"reputation":339,"user_id":224713,"accept_rate":80,"display_name":"itdeveloper"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656332380,"creation_date":1656332380,"answer_id":72772003,"question_id":66740569,"body_markdown":"Where are you getting this error? Does this error occur when compiling maven project in IDE (VS Code, IntelliJ ..) ? \r\n\r\nIn my opinion you should add dependencies to pom.xml file\r\n\r\n      &lt;dependency&gt;\r\n      &lt;groupId&gt;com.google.auto.service&lt;/groupId&gt;\r\n      &lt;artifactId&gt;auto-service&lt;/artifactId&gt;\r\n      &lt;version&gt;${autovalue.service.version}&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n      &lt;groupId&gt;com.google.auto.value&lt;/groupId&gt;\r\n      &lt;artifactId&gt;auto-value&lt;/artifactId&gt;\r\n      &lt;version&gt;${autovalue.version}&lt;/version&gt;\r\n      &lt;scope&gt;provided&lt;/scope&gt;\r\n    &lt;/dependency&gt;\r\n    &lt;dependency&gt;\r\n      &lt;groupId&gt;com.google.auto.value&lt;/groupId&gt;\r\n      &lt;artifactId&gt;auto-value-annotations&lt;/artifactId&gt;\r\n      &lt;version&gt;${autovalue.annotations.version}&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n\r\nVersion from data flow template: \r\n\r\n    &lt;autovalue.service.version&gt;1.0-rc6&lt;/autovalue.service.version&gt;   \r\n    &lt;autovalue.annotations.version&gt;1.7.4&lt;/autovalue.annotations.version&gt;\r\n    &lt;autovalue.version&gt;1.7.4&lt;/autovalue.version&gt;","title":"Where can I find the class: AutoValue_DynamicJdbcIO_DynamicRead for Apache Beam implementation?","body":"<p>Where are you getting this error? Does this error occur when compiling maven project in IDE (VS Code, IntelliJ ..) ?</p>\n<p>In my opinion you should add dependencies to pom.xml file</p>\n<pre><code>  &lt;dependency&gt;\n  &lt;groupId&gt;com.google.auto.service&lt;/groupId&gt;\n  &lt;artifactId&gt;auto-service&lt;/artifactId&gt;\n  &lt;version&gt;${autovalue.service.version}&lt;/version&gt;\n&lt;/dependency&gt;\n    &lt;dependency&gt;\n  &lt;groupId&gt;com.google.auto.value&lt;/groupId&gt;\n  &lt;artifactId&gt;auto-value&lt;/artifactId&gt;\n  &lt;version&gt;${autovalue.version}&lt;/version&gt;\n  &lt;scope&gt;provided&lt;/scope&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;com.google.auto.value&lt;/groupId&gt;\n  &lt;artifactId&gt;auto-value-annotations&lt;/artifactId&gt;\n  &lt;version&gt;${autovalue.annotations.version}&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>Version from data flow template:</p>\n<pre><code>&lt;autovalue.service.version&gt;1.0-rc6&lt;/autovalue.service.version&gt;   \n&lt;autovalue.annotations.version&gt;1.7.4&lt;/autovalue.annotations.version&gt;\n&lt;autovalue.version&gt;1.7.4&lt;/autovalue.version&gt;\n</code></pre>\n"}],"owner":{"account_id":9587184,"reputation":2009,"user_id":7119501,"accept_rate":68,"display_name":"Metadata"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":195,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1656332380,"creation_date":1616389305,"question_id":66740569,"body_markdown":"I am trying to implement Apache Beam with GCP Dataflow using this [template][1] given by Google.\r\n\r\nIn the available templates, I am using JdbcToBigquery which is my usecase. \r\nThese are the dependencies I have in pom.xml\r\n\r\n    &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;\r\n      &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n      &lt;groupId&gt;com.base&lt;/groupId&gt;\r\n      &lt;artifactId&gt;Deltaflow&lt;/artifactId&gt;\r\n      &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\r\n    \r\n      &lt;properties&gt;\r\n        &lt;scala.version&gt;2.13.1&lt;/scala.version&gt;\r\n        &lt;beam.version&gt;2.28.0&lt;/beam.version&gt;\r\n        &lt;threetenbp.version&gt;1.4.4&lt;/threetenbp.version&gt;\r\n        &lt;beam-vendor-guava.version&gt;0.1&lt;/beam-vendor-guava.version&gt;\r\n      &lt;/properties&gt;\r\n    \r\n      &lt;dependencies&gt;\r\n        &lt;dependency&gt;\r\n          &lt;groupId&gt;org.scala-lang&lt;/groupId&gt;\r\n          &lt;artifactId&gt;scala-library&lt;/artifactId&gt;\r\n          &lt;version&gt;${scala.version}&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n          &lt;groupId&gt;org.apache.beam&lt;/groupId&gt;\r\n          &lt;artifactId&gt;beam-sdks-java-core&lt;/artifactId&gt;\r\n          &lt;version&gt;${beam.version}&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n          &lt;groupId&gt;org.apache.beam&lt;/groupId&gt;\r\n          &lt;artifactId&gt;beam-sdks-java-io-google-cloud-platform&lt;/artifactId&gt;\r\n          &lt;version&gt;${beam.version}&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n          &lt;groupId&gt;org.apache.beam&lt;/groupId&gt;\r\n          &lt;artifactId&gt;beam-sdks-java-extensions-google-cloud-platform-core&lt;/artifactId&gt;\r\n          &lt;version&gt;${beam.version}&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n          &lt;groupId&gt;org.apache.beam&lt;/groupId&gt;\r\n          &lt;artifactId&gt;beam-sdks-java-extensions-protobuf&lt;/artifactId&gt;\r\n          &lt;version&gt;${beam.version}&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n          &lt;groupId&gt;org.apache.beam&lt;/groupId&gt;\r\n          &lt;artifactId&gt;beam-runners-google-cloud-dataflow-java&lt;/artifactId&gt;\r\n          &lt;version&gt;${beam.version}&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n          &lt;groupId&gt;org.apache.beam&lt;/groupId&gt;\r\n          &lt;artifactId&gt;beam-runners-direct-java&lt;/artifactId&gt;\r\n          &lt;version&gt;${beam.version}&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n          &lt;groupId&gt;org.apache.beam&lt;/groupId&gt;\r\n          &lt;artifactId&gt;beam-sdks-java-io-jdbc&lt;/artifactId&gt;\r\n          &lt;version&gt;${beam.version}&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n          &lt;groupId&gt;org.apache.beam&lt;/groupId&gt;\r\n          &lt;artifactId&gt;beam-vendor-guava-20_0&lt;/artifactId&gt;\r\n          &lt;version&gt;${beam-vendor-guava.version}&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n          &lt;groupId&gt;org.threeten&lt;/groupId&gt;\r\n          &lt;artifactId&gt;threetenbp&lt;/artifactId&gt;\r\n          &lt;version&gt;${threetenbp.version}&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n          &lt;groupId&gt;com.base&lt;/groupId&gt;\r\n          &lt;artifactId&gt;Deltaflow&lt;/artifactId&gt;\r\n          &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n      &lt;/dependencies&gt;\r\n    \r\n      &lt;build&gt;\r\n        &lt;plugins&gt;\r\n          &lt;plugin&gt;\r\n            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n            &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;\r\n            &lt;configuration&gt;\r\n              &lt;descriptorRefs&gt;\r\n                &lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;\r\n              &lt;/descriptorRefs&gt;\r\n            &lt;/configuration&gt;\r\n            &lt;executions&gt;\r\n              &lt;execution&gt;\r\n                &lt;id&gt;assemble-all&lt;/id&gt;\r\n                &lt;phase&gt;package&lt;/phase&gt;\r\n                &lt;goals&gt;\r\n                  &lt;goal&gt;single&lt;/goal&gt;\r\n                &lt;/goals&gt;\r\n              &lt;/execution&gt;\r\n            &lt;/executions&gt;\r\n          &lt;/plugin&gt;\r\n    \r\n          &lt;plugin&gt;\r\n            &lt;groupId&gt;net.alchim31.maven&lt;/groupId&gt;\r\n            &lt;artifactId&gt;scala-maven-plugin&lt;/artifactId&gt;\r\n            &lt;version&gt;3.4.0&lt;/version&gt;\r\n            &lt;executions&gt;\r\n              &lt;execution&gt;\r\n                &lt;id&gt;scala-compile-first&lt;/id&gt;\r\n                &lt;phase&gt;process-resources&lt;/phase&gt;\r\n                &lt;goals&gt;\r\n                  &lt;goal&gt;add-source&lt;/goal&gt;\r\n                  &lt;goal&gt;compile&lt;/goal&gt;\r\n                &lt;/goals&gt;\r\n              &lt;/execution&gt;\r\n              &lt;execution&gt;\r\n                &lt;id&gt;scala-test-compile&lt;/id&gt;\r\n                &lt;phase&gt;process-test-resources&lt;/phase&gt;\r\n                &lt;goals&gt;\r\n                  &lt;goal&gt;testCompile&lt;/goal&gt;\r\n                &lt;/goals&gt;\r\n              &lt;/execution&gt;\r\n            &lt;/executions&gt;\r\n          &lt;/plugin&gt;\r\n            &lt;plugin&gt;\r\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\r\n                &lt;configuration&gt;\r\n                    &lt;source&gt;8&lt;/source&gt;\r\n                    &lt;target&gt;8&lt;/target&gt;\r\n                &lt;/configuration&gt;\r\n            &lt;/plugin&gt;\r\n        &lt;/plugins&gt;\r\n      &lt;/build&gt;\r\n    &lt;/project&gt;\r\n\r\nInside the template, there is class: DynamicJdbcIO.java which helps creating creating jdbc connection. It could be found [here][2]\r\n\r\n\r\n  [1]: https://github.com/GoogleCloudPlatform/DataflowTemplates/blob/master/src/main/java/com/google/cloud/teleport/templates/JdbcToBigQuery.java\r\n  [2]: https://github.com/GoogleCloudPlatform/DataflowTemplates/blob/master/src/main/java/com/google/cloud/teleport/io/DynamicJdbcIO.java\r\n\r\nI have added all the beam related jars in my pom.xml file. But some how I am facing an error at this part of the code in DynamicJdbcIO.java class:\r\n\r\n      public static &lt;T&gt; DynamicRead&lt;T&gt; read() {\r\n        return new AutoValue_DynamicJdbcIO_DynamicRead.Builder&lt;T&gt;().build();\r\n      }\r\nError:\r\n\r\n    Cannot resolve symbol &#39;AutoValue_DynamicJdbcIO_DynamicRead&#39;\r\n\r\nI also added these external jars just to make sure I have all the libraries.\r\n\r\n 1. auto-service-1.0-rc7.jar \r\n 2. auto-value-1.7.4.jar\r\n 3. google-cloud-dataflow-java-sdk-all-2.5.0.jar\r\n 4. google-cloud-kms-1.41.1.jar\r\n 5. mssql-jdbc-9.2.0.jre8.jar\r\n 6. proto-google-cloud-kms-v1-0.88.1.jar\r\n 7. sqljdbc42-6.0.8112.jar\r\n\r\nCould anyone please let me know what am I missing here ? Is this a dependency version mismatch or is there a jar file or a dependency available for `AutoValue_DynamicJdbcIO_DynamicRead`\r\n\r\nAny help is much appreciated.","title":"Where can I find the class: AutoValue_DynamicJdbcIO_DynamicRead for Apache Beam implementation?","body":"<p>I am trying to implement Apache Beam with GCP Dataflow using this <a href=\"https://github.com/GoogleCloudPlatform/DataflowTemplates/blob/master/src/main/java/com/google/cloud/teleport/templates/JdbcToBigQuery.java\" rel=\"nofollow noreferrer\">template</a> given by Google.</p>\n<p>In the available templates, I am using JdbcToBigquery which is my usecase.\nThese are the dependencies I have in pom.xml</p>\n<pre><code>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;\n  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n  &lt;groupId&gt;com.base&lt;/groupId&gt;\n  &lt;artifactId&gt;Deltaflow&lt;/artifactId&gt;\n  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n\n  &lt;properties&gt;\n    &lt;scala.version&gt;2.13.1&lt;/scala.version&gt;\n    &lt;beam.version&gt;2.28.0&lt;/beam.version&gt;\n    &lt;threetenbp.version&gt;1.4.4&lt;/threetenbp.version&gt;\n    &lt;beam-vendor-guava.version&gt;0.1&lt;/beam-vendor-guava.version&gt;\n  &lt;/properties&gt;\n\n  &lt;dependencies&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.scala-lang&lt;/groupId&gt;\n      &lt;artifactId&gt;scala-library&lt;/artifactId&gt;\n      &lt;version&gt;${scala.version}&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.beam&lt;/groupId&gt;\n      &lt;artifactId&gt;beam-sdks-java-core&lt;/artifactId&gt;\n      &lt;version&gt;${beam.version}&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.beam&lt;/groupId&gt;\n      &lt;artifactId&gt;beam-sdks-java-io-google-cloud-platform&lt;/artifactId&gt;\n      &lt;version&gt;${beam.version}&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.beam&lt;/groupId&gt;\n      &lt;artifactId&gt;beam-sdks-java-extensions-google-cloud-platform-core&lt;/artifactId&gt;\n      &lt;version&gt;${beam.version}&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.beam&lt;/groupId&gt;\n      &lt;artifactId&gt;beam-sdks-java-extensions-protobuf&lt;/artifactId&gt;\n      &lt;version&gt;${beam.version}&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.beam&lt;/groupId&gt;\n      &lt;artifactId&gt;beam-runners-google-cloud-dataflow-java&lt;/artifactId&gt;\n      &lt;version&gt;${beam.version}&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.beam&lt;/groupId&gt;\n      &lt;artifactId&gt;beam-runners-direct-java&lt;/artifactId&gt;\n      &lt;version&gt;${beam.version}&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.beam&lt;/groupId&gt;\n      &lt;artifactId&gt;beam-sdks-java-io-jdbc&lt;/artifactId&gt;\n      &lt;version&gt;${beam.version}&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.beam&lt;/groupId&gt;\n      &lt;artifactId&gt;beam-vendor-guava-20_0&lt;/artifactId&gt;\n      &lt;version&gt;${beam-vendor-guava.version}&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.threeten&lt;/groupId&gt;\n      &lt;artifactId&gt;threetenbp&lt;/artifactId&gt;\n      &lt;version&gt;${threetenbp.version}&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;com.base&lt;/groupId&gt;\n      &lt;artifactId&gt;Deltaflow&lt;/artifactId&gt;\n      &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n    &lt;/dependency&gt;\n  &lt;/dependencies&gt;\n\n  &lt;build&gt;\n    &lt;plugins&gt;\n      &lt;plugin&gt;\n        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n        &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;\n        &lt;configuration&gt;\n          &lt;descriptorRefs&gt;\n            &lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;\n          &lt;/descriptorRefs&gt;\n        &lt;/configuration&gt;\n        &lt;executions&gt;\n          &lt;execution&gt;\n            &lt;id&gt;assemble-all&lt;/id&gt;\n            &lt;phase&gt;package&lt;/phase&gt;\n            &lt;goals&gt;\n              &lt;goal&gt;single&lt;/goal&gt;\n            &lt;/goals&gt;\n          &lt;/execution&gt;\n        &lt;/executions&gt;\n      &lt;/plugin&gt;\n\n      &lt;plugin&gt;\n        &lt;groupId&gt;net.alchim31.maven&lt;/groupId&gt;\n        &lt;artifactId&gt;scala-maven-plugin&lt;/artifactId&gt;\n        &lt;version&gt;3.4.0&lt;/version&gt;\n        &lt;executions&gt;\n          &lt;execution&gt;\n            &lt;id&gt;scala-compile-first&lt;/id&gt;\n            &lt;phase&gt;process-resources&lt;/phase&gt;\n            &lt;goals&gt;\n              &lt;goal&gt;add-source&lt;/goal&gt;\n              &lt;goal&gt;compile&lt;/goal&gt;\n            &lt;/goals&gt;\n          &lt;/execution&gt;\n          &lt;execution&gt;\n            &lt;id&gt;scala-test-compile&lt;/id&gt;\n            &lt;phase&gt;process-test-resources&lt;/phase&gt;\n            &lt;goals&gt;\n              &lt;goal&gt;testCompile&lt;/goal&gt;\n            &lt;/goals&gt;\n          &lt;/execution&gt;\n        &lt;/executions&gt;\n      &lt;/plugin&gt;\n        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n            &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n            &lt;configuration&gt;\n                &lt;source&gt;8&lt;/source&gt;\n                &lt;target&gt;8&lt;/target&gt;\n            &lt;/configuration&gt;\n        &lt;/plugin&gt;\n    &lt;/plugins&gt;\n  &lt;/build&gt;\n&lt;/project&gt;\n</code></pre>\n<p>Inside the template, there is class: DynamicJdbcIO.java which helps creating creating jdbc connection. It could be found <a href=\"https://github.com/GoogleCloudPlatform/DataflowTemplates/blob/master/src/main/java/com/google/cloud/teleport/io/DynamicJdbcIO.java\" rel=\"nofollow noreferrer\">here</a></p>\n<p>I have added all the beam related jars in my pom.xml file. But some how I am facing an error at this part of the code in DynamicJdbcIO.java class:</p>\n<pre><code>  public static &lt;T&gt; DynamicRead&lt;T&gt; read() {\n    return new AutoValue_DynamicJdbcIO_DynamicRead.Builder&lt;T&gt;().build();\n  }\n</code></pre>\n<p>Error:</p>\n<pre><code>Cannot resolve symbol 'AutoValue_DynamicJdbcIO_DynamicRead'\n</code></pre>\n<p>I also added these external jars just to make sure I have all the libraries.</p>\n<ol>\n<li>auto-service-1.0-rc7.jar</li>\n<li>auto-value-1.7.4.jar</li>\n<li>google-cloud-dataflow-java-sdk-all-2.5.0.jar</li>\n<li>google-cloud-kms-1.41.1.jar</li>\n<li>mssql-jdbc-9.2.0.jre8.jar</li>\n<li>proto-google-cloud-kms-v1-0.88.1.jar</li>\n<li>sqljdbc42-6.0.8112.jar</li>\n</ol>\n<p>Could anyone please let me know what am I missing here ? Is this a dependency version mismatch or is there a jar file or a dependency available for <code>AutoValue_DynamicJdbcIO_DynamicRead</code></p>\n<p>Any help is much appreciated.</p>\n"},{"tags":["java","javac","java-11"],"comments":[{"owner":{"account_id":5384013,"reputation":6035,"user_id":4288506,"accept_rate":77,"display_name":"Marcono1234"},"score":1,"creation_date":1589143480,"post_id":54843571,"comment_id":109170153,"body_markdown":"Does this answer your question? [What is the --release flag in the Java 9 compiler?](https://stackoverflow.com/questions/43102787/what-is-the-release-flag-in-the-java-9-compiler)","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/43102787/what-is-the-release-flag-in-the-java-9-compiler\">What is the --release flag in the Java 9 compiler?</a>"}],"answers":[{"tags":[],"owner":{"account_id":11365554,"reputation":119,"user_id":8332571,"display_name":"Nicolas Therrien"},"down_vote_count":0,"up_vote_count":5,"is_accepted":true,"score":5,"last_activity_date":1656332133,"creation_date":1550941052,"answer_id":54843883,"question_id":54843571,"body_markdown":"I have found the answer in the [Java 19 SDK source code][1] for the java compiler:\r\n\r\n```java\r\n/**\r\n * Handles the {@code --release} option.\r\n *\r\n * @param additionalOptions a predicate to handle additional options implied by the\r\n * {@code --release} option. The predicate should return true if all the additional\r\n * options were processed successfully.\r\n * @return true if successful, false otherwise\r\n */\r\npublic boolean handleReleaseOptions(Predicate&lt;Iterable&lt;String&gt;&gt; additionalOptions) {\r\n    String platformString = options.get(Option.RELEASE);\r\n\r\n    checkOptionAllowed(platformString == null,\r\n            option -&gt; reportDiag(Errors.ReleaseBootclasspathConflict(option)),\r\n            Option.BOOT_CLASS_PATH, Option.XBOOTCLASSPATH, Option.XBOOTCLASSPATH_APPEND,\r\n            Option.XBOOTCLASSPATH_PREPEND,\r\n            Option.ENDORSEDDIRS, Option.DJAVA_ENDORSED_DIRS,\r\n            Option.EXTDIRS, Option.DJAVA_EXT_DIRS,\r\n            Option.SOURCE, Option.TARGET,\r\n            Option.SYSTEM, Option.UPGRADE_MODULE_PATH);\r\n\r\n    if (platformString != null) {\r\n        PlatformDescription platformDescription =\r\n                PlatformUtils.lookupPlatformDescription(platformString);\r\n\r\n        if (platformDescription == null) {\r\n            reportDiag(Errors.UnsupportedReleaseVersion(platformString));\r\n            return false;\r\n        }\r\n\r\n        options.put(Option.SOURCE, platformDescription.getSourceVersion());\r\n        options.put(Option.TARGET, platformDescription.getTargetVersion());\r\n\r\n        context.put(PlatformDescription.class, platformDescription);\r\n\r\n        if (!additionalOptions.test(platformDescription.getAdditionalOptions()))\r\n            return false;\r\n\r\n        JavaFileManager platformFM = platformDescription.getFileManager();\r\n        DelegatingJavaFileManager.installReleaseFileManager(context,\r\n                platformFM,\r\n                getFileManager());\r\n    }\r\n\r\n    return true;\r\n}\r\n```\r\n\r\nAs the code shows, the `--release` option will set both source and target to the same value.\r\n\r\nIn fact, there is a check that forbids using the `--release` parameter if source or target have already been set.\r\n\r\n```java\r\nvoid checkOptionAllowed(boolean allowed, ErrorReporter r, Option... opts) {\r\n    if (!allowed) {\r\n        Stream.of(opts)\r\n              .filter(options :: isSet)\r\n              .forEach(r :: report);\r\n    }\r\n}\r\n```\r\n\r\n\r\n  [1]: https://github.com/openjdk/jdk/blob/50f99c3208fc9f479cc109fb6e73d262e27026a2/src/jdk.compiler/share/classes/com/sun/tools/javac/main/Arguments.java#L315-L316","title":"Java 11: What is the difference between javac --release and -source and -target command line parameters?","body":"<p>I have found the answer in the <a href=\"https://github.com/openjdk/jdk/blob/50f99c3208fc9f479cc109fb6e73d262e27026a2/src/jdk.compiler/share/classes/com/sun/tools/javac/main/Arguments.java#L315-L316\" rel=\"nofollow noreferrer\">Java 19 SDK source code</a> for the java compiler:</p>\n<pre class=\"lang-java prettyprint-override\"><code>/**\n * Handles the {@code --release} option.\n *\n * @param additionalOptions a predicate to handle additional options implied by the\n * {@code --release} option. The predicate should return true if all the additional\n * options were processed successfully.\n * @return true if successful, false otherwise\n */\npublic boolean handleReleaseOptions(Predicate&lt;Iterable&lt;String&gt;&gt; additionalOptions) {\n    String platformString = options.get(Option.RELEASE);\n\n    checkOptionAllowed(platformString == null,\n            option -&gt; reportDiag(Errors.ReleaseBootclasspathConflict(option)),\n            Option.BOOT_CLASS_PATH, Option.XBOOTCLASSPATH, Option.XBOOTCLASSPATH_APPEND,\n            Option.XBOOTCLASSPATH_PREPEND,\n            Option.ENDORSEDDIRS, Option.DJAVA_ENDORSED_DIRS,\n            Option.EXTDIRS, Option.DJAVA_EXT_DIRS,\n            Option.SOURCE, Option.TARGET,\n            Option.SYSTEM, Option.UPGRADE_MODULE_PATH);\n\n    if (platformString != null) {\n        PlatformDescription platformDescription =\n                PlatformUtils.lookupPlatformDescription(platformString);\n\n        if (platformDescription == null) {\n            reportDiag(Errors.UnsupportedReleaseVersion(platformString));\n            return false;\n        }\n\n        options.put(Option.SOURCE, platformDescription.getSourceVersion());\n        options.put(Option.TARGET, platformDescription.getTargetVersion());\n\n        context.put(PlatformDescription.class, platformDescription);\n\n        if (!additionalOptions.test(platformDescription.getAdditionalOptions()))\n            return false;\n\n        JavaFileManager platformFM = platformDescription.getFileManager();\n        DelegatingJavaFileManager.installReleaseFileManager(context,\n                platformFM,\n                getFileManager());\n    }\n\n    return true;\n}\n</code></pre>\n<p>As the code shows, the <code>--release</code> option will set both source and target to the same value.</p>\n<p>In fact, there is a check that forbids using the <code>--release</code> parameter if source or target have already been set.</p>\n<pre class=\"lang-java prettyprint-override\"><code>void checkOptionAllowed(boolean allowed, ErrorReporter r, Option... opts) {\n    if (!allowed) {\n        Stream.of(opts)\n              .filter(options :: isSet)\n              .forEach(r :: report);\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":5384013,"reputation":6035,"user_id":4288506,"accept_rate":77,"display_name":"Marcono1234"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1589126505,"creation_date":1589126505,"answer_id":61714873,"question_id":54843571,"body_markdown":"The `--release` option was added by [&quot;JEP 247: Compile for Older Platform Versions&quot;](https://openjdk.java.net/jeps/247):\r\n\r\n&gt; `javac` provides two command line options, `-source` and `-target`, which can be used to select the version of the Java language accepted by the compiler and the version of the class files it produces, respectively. By default, however, `javac` compiles against the most-recent version of the platform APIs. The compiled program can therefore accidentally use APIs only available in the current version of the platform. Such programs cannot run on older versions of the platform, regardless of the values passed to the `-source` and `-target` options.\r\n\r\nAdditionally the [documentation](https://docs.oracle.com/en/java/javase/14/docs/specs/man/javac.html#option-release) for the `--release` option says:\r\n\r\n&gt; **Note:** When using `--release`, you cannot also use the `--source`/`-source` or `--target`/`-target` options.","title":"Java 11: What is the difference between javac --release and -source and -target command line parameters?","body":"<p>The <code>--release</code> option was added by <a href=\"https://openjdk.java.net/jeps/247\" rel=\"nofollow noreferrer\">\"JEP 247: Compile for Older Platform Versions\"</a>:</p>\n\n<blockquote>\n  <p><code>javac</code> provides two command line options, <code>-source</code> and <code>-target</code>, which can be used to select the version of the Java language accepted by the compiler and the version of the class files it produces, respectively. By default, however, <code>javac</code> compiles against the most-recent version of the platform APIs. The compiled program can therefore accidentally use APIs only available in the current version of the platform. Such programs cannot run on older versions of the platform, regardless of the values passed to the <code>-source</code> and <code>-target</code> options.</p>\n</blockquote>\n\n<p>Additionally the <a href=\"https://docs.oracle.com/en/java/javase/14/docs/specs/man/javac.html#option-release\" rel=\"nofollow noreferrer\">documentation</a> for the <code>--release</code> option says:</p>\n\n<blockquote>\n  <p><strong>Note:</strong> When using <code>--release</code>, you cannot also use the <code>--source</code>/<code>-source</code> or <code>--target</code>/<code>-target</code> options.</p>\n</blockquote>\n"},{"tags":[],"owner":{"account_id":1416522,"reputation":91354,"user_id":3553087,"display_name":"Brian Goetz"},"down_vote_count":0,"up_vote_count":19,"is_accepted":false,"score":19,"last_activity_date":1589130028,"creation_date":1589130028,"answer_id":61715683,"question_id":54843571,"body_markdown":"The `--release` flag not only sets source and target versions, but it also causes the compiler to use the symbol table for the JDK libraries corresponding to the specified release, preventing you from accidentally using APIs that are present in the compilation JDK but not present in the specified version. The `--release` flag was added later, and in most cases, should replace uses of `--source` and `--target`.","title":"Java 11: What is the difference between javac --release and -source and -target command line parameters?","body":"<p>The <code>--release</code> flag not only sets source and target versions, but it also causes the compiler to use the symbol table for the JDK libraries corresponding to the specified release, preventing you from accidentally using APIs that are present in the compilation JDK but not present in the specified version. The <code>--release</code> flag was added later, and in most cases, should replace uses of <code>--source</code> and <code>--target</code>.</p>\n"}],"owner":{"account_id":11365554,"reputation":119,"user_id":8332571,"display_name":"Nicolas Therrien"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":5680,"favorite_count":0,"down_vote_count":1,"up_vote_count":6,"closed_date":1589214044,"accepted_answer_id":54843883,"answer_count":3,"score":5,"last_activity_date":1656332133,"creation_date":1550939058,"question_id":54843571,"body_markdown":"Does anyone know the difference between using --release and the older -source and -target command line parameters?\r\n\r\nIn the javac man page:\r\n-source &lt;release&gt;\r\n        Provide source compatibility with specified release\r\n-target &lt;release&gt;            Generate class files for specific VM version\r\n\r\n --release &lt;release&gt;\r\n        Compile for a specific VM version. Supported targets: 6, 7, 8, 9, 10, 11\r\n\r\n\r\nCould --release bind both -source and -target to the same version?\r\n\r\n","title":"Java 11: What is the difference between javac --release and -source and -target command line parameters?","body":"<p>Does anyone know the difference between using --release and the older -source and -target command line parameters?</p>\n\n<p>In the javac man page:\n-source \n        Provide source compatibility with specified release\n-target             Generate class files for specific VM version</p>\n\n<p>--release \n        Compile for a specific VM version. Supported targets: 6, 7, 8, 9, 10, 11</p>\n\n<p>Could --release bind both -source and -target to the same version?</p>\n"},{"tags":["java","spring","spring-boot","soap","spring-ws"],"answers":[{"tags":[],"owner":{"account_id":201994,"reputation":5671,"user_id":448776,"accept_rate":75,"display_name":"SoManyGoblins"},"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1543853671,"creation_date":1543853671,"answer_id":53597635,"question_id":53567967,"body_markdown":"Doesn&#39;t seem to be a built in way of doing this.\r\n\r\nI ended up subclassing `SaajSoapMessageFactory` and declaring that as a Bean, like this:\r\n\r\n    @Bean(&quot;messageFactory&quot;)\r\n    public SoapMessageFactory messageFactory() {\r\n       var messageFactory = new DualProtocolSaajSoapMessageFactory();\r\n    \r\n       return messageFactory;\r\n    }\r\n\r\nThis new class is a copy of SaajSoapMessageFactory with a few changes:\r\n- It internally has two message factories, one for 1.1 and one for 1.2\r\n    \r\n    public DualProtocolSaajSoapMessageFactory() {\r\n        super();\r\n\r\n        try {\r\n            messageFactory11 = MessageFactory.newInstance(SOAPConstants.SOAP_1_1_PROTOCOL);\r\n            messageFactory12 = MessageFactory.newInstance(SOAPConstants.SOAP_1_2_PROTOCOL);\r\n        } catch (Exception ex) {\r\n            throw new SoapMessageCreationException(&quot;Could not create SAAJ MessageFactory: &quot; + ex.getMessage(), ex);\r\n        }\r\n    }\r\n\r\nAnd then, basically, just override createWebServiceMessage:\r\n\r\n    @Override\r\n    public SaajSoapMessage createWebServiceMessage(InputStream inputStream) throws IOException {\r\n        MimeHeaders mimeHeaders = parseMimeHeaders(inputStream);\r\n        try {\r\n            inputStream = checkForUtf8ByteOrderMark(inputStream);\r\n            SOAPMessage saajMessage = null;\r\n\r\n            if (mimeHeaders.getHeader(HttpHeaders.CONTENT_TYPE)[0].contains(MimeTypeUtils.TEXT_XML_VALUE)) {\r\n                saajMessage = messageFactory11.createMessage(mimeHeaders, inputStream);\r\n            } else {\r\n                saajMessage = messageFactory12.createMessage(mimeHeaders, inputStream);\r\n            }\r\n    ...snip\r\n\r\n\r\nA little hacky, but does what it needs to do.\r\n\r\n","title":"Support both SOAP 1.1 and SOAP 1.2 messages in Spring-WS","body":"<p>Doesn't seem to be a built in way of doing this.</p>\n\n<p>I ended up subclassing <code>SaajSoapMessageFactory</code> and declaring that as a Bean, like this:</p>\n\n<pre><code>@Bean(\"messageFactory\")\npublic SoapMessageFactory messageFactory() {\n   var messageFactory = new DualProtocolSaajSoapMessageFactory();\n\n   return messageFactory;\n}\n</code></pre>\n\n<p>This new class is a copy of SaajSoapMessageFactory with a few changes:\n- It internally has two message factories, one for 1.1 and one for 1.2</p>\n\n<pre><code>public DualProtocolSaajSoapMessageFactory() {\n    super();\n\n    try {\n        messageFactory11 = MessageFactory.newInstance(SOAPConstants.SOAP_1_1_PROTOCOL);\n        messageFactory12 = MessageFactory.newInstance(SOAPConstants.SOAP_1_2_PROTOCOL);\n    } catch (Exception ex) {\n        throw new SoapMessageCreationException(\"Could not create SAAJ MessageFactory: \" + ex.getMessage(), ex);\n    }\n}\n</code></pre>\n\n<p>And then, basically, just override createWebServiceMessage:</p>\n\n<pre><code>@Override\npublic SaajSoapMessage createWebServiceMessage(InputStream inputStream) throws IOException {\n    MimeHeaders mimeHeaders = parseMimeHeaders(inputStream);\n    try {\n        inputStream = checkForUtf8ByteOrderMark(inputStream);\n        SOAPMessage saajMessage = null;\n\n        if (mimeHeaders.getHeader(HttpHeaders.CONTENT_TYPE)[0].contains(MimeTypeUtils.TEXT_XML_VALUE)) {\n            saajMessage = messageFactory11.createMessage(mimeHeaders, inputStream);\n        } else {\n            saajMessage = messageFactory12.createMessage(mimeHeaders, inputStream);\n        }\n...snip\n</code></pre>\n\n<p>A little hacky, but does what it needs to do.</p>\n"},{"tags":[],"owner":{"account_id":7465460,"reputation":11,"user_id":5675215,"display_name":"Sanjib sadhukhan"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1563343881,"creation_date":1563343881,"answer_id":57069532,"question_id":53567967,"body_markdown":"    import java.io.BufferedInputStream;\r\n    import java.io.IOException;\r\n    import java.io.InputStream;\r\n    import java.io.PushbackInputStream;\r\n    import java.util.Iterator;\r\n    import java.util.Map;\r\n    import java.util.StringTokenizer;\r\n    import java.util.Map.Entry;\r\n    import javax.xml.soap.*;\r\n    import org.apache.commons.logging.Log;\r\n    import org.apache.commons.logging.LogFactory;\r\n    import org.apache.http.HttpHeaders;\r\n    import org.springframework.beans.factory.InitializingBean;\r\n    import org.springframework.util.CollectionUtils;\r\n    import org.springframework.util.MimeTypeUtils;\r\n    import org.springframework.util.ObjectUtils;\r\n    import org.springframework.util.StringUtils;\r\n    import org.springframework.ws.InvalidXmlException;\r\n    import org.springframework.ws.soap.SoapMessageCreationException;\r\n    import org.springframework.ws.soap.SoapMessageFactory;\r\n    import org.springframework.ws.soap.SoapVersion;\r\n    import org.springframework.ws.soap.saaj.SaajSoapMessage;\r\n    import org.springframework.ws.soap.saaj.support.SaajUtils;\r\n    import org.springframework.ws.transport.TransportInputStream;\r\n    import org.xml.sax.SAXParseException;\r\n    /*Copy of class SaajSoapMessageFactory to override method createWebServiceMessage(InputStream inputStream)*/\r\n    public class DualProtocolSaajSoapMessageFactory implements SoapMessageFactory, InitializingBean {\r\n        private static final Log logger = LogFactory.getLog(DualProtocolSaajSoapMessageFactory.class);\r\n        private MessageFactory messageFactory;\r\n        private String messageFactoryProtocol;\r\n        private boolean langAttributeOnSoap11FaultString = true;\r\n        private Map&lt;String, ?&gt; messageProperties;\r\n        MessageFactory messageFactory11;\r\n        MessageFactory messageFactory12;\r\n        public DualProtocolSaajSoapMessageFactory() {\r\n            super();\r\n    \r\n            try {\r\n                messageFactory11 = MessageFactory.newInstance(SOAPConstants.SOAP_1_1_PROTOCOL);\r\n                messageFactory12 = MessageFactory.newInstance(SOAPConstants.SOAP_1_2_PROTOCOL);\r\n            } catch (Exception ex) {\r\n                throw new SoapMessageCreationException(&quot;Could not create SAAJ MessageFactory: &quot; + ex.getMessage(), ex);\r\n            }\r\n        }\r\n    \r\n        public DualProtocolSaajSoapMessageFactory(MessageFactory messageFactory) {\r\n            this.messageFactory = messageFactory;\r\n        }\r\n    \r\n        public MessageFactory getMessageFactory() {\r\n            return this.messageFactory;\r\n        }\r\n    \r\n        public void setMessageFactory(MessageFactory messageFactory) {\r\n            this.messageFactory = messageFactory;\r\n        }\r\n    \r\n        public void setMessageProperties(Map&lt;String, ?&gt; messageProperties) {\r\n            this.messageProperties = messageProperties;\r\n        }\r\n    \r\n        public void setLangAttributeOnSoap11FaultString(boolean langAttributeOnSoap11FaultString) {\r\n            this.langAttributeOnSoap11FaultString = langAttributeOnSoap11FaultString;\r\n        }\r\n    \r\n        public void setSoapVersion(SoapVersion version) {\r\n            if (SaajUtils.getSaajVersion() &gt;= 2) {\r\n                if (SoapVersion.SOAP_11 == version) {\r\n                    this.messageFactoryProtocol = &quot;SOAP 1.1 Protocol&quot;;\r\n                } else {\r\n                    if (SoapVersion.SOAP_12 != version) {\r\n                        throw new IllegalArgumentException(&quot;Invalid version [&quot; + version + &quot;]. Expected the SOAP_11 or SOAP_12 constant&quot;);\r\n                    }\r\n    \r\n                    this.messageFactoryProtocol = &quot;SOAP 1.2 Protocol&quot;;\r\n                }\r\n            } else if (SoapVersion.SOAP_11 != version) {\r\n                throw new IllegalArgumentException(&quot;SAAJ 1.1 and 1.2 only support SOAP 1.1&quot;);\r\n            }\r\n    \r\n        }\r\n    \r\n        public void afterPropertiesSet() {\r\n            if (this.messageFactory == null) {\r\n                try {\r\n                    if (SaajUtils.getSaajVersion() &gt;= 2) {\r\n                        if (!StringUtils.hasLength(this.messageFactoryProtocol)) {\r\n                            this.messageFactoryProtocol = &quot;SOAP 1.1 Protocol&quot;;\r\n                        }\r\n    \r\n                        if (logger.isInfoEnabled()) {\r\n                            logger.info(&quot;Creating SAAJ 1.3 MessageFactory with &quot; + this.messageFactoryProtocol);\r\n                        }\r\n    \r\n                        this.messageFactory = MessageFactory.newInstance(this.messageFactoryProtocol);\r\n                    } else if (SaajUtils.getSaajVersion() == 1) {\r\n                        logger.info(&quot;Creating SAAJ 1.2 MessageFactory&quot;);\r\n                        this.messageFactory = MessageFactory.newInstance();\r\n                    } else {\r\n                        if (SaajUtils.getSaajVersion() != 0) {\r\n                            throw new IllegalStateException(&quot;SaajSoapMessageFactory requires SAAJ 1.1, which was not found on the classpath&quot;);\r\n                        }\r\n    \r\n                        logger.info(&quot;Creating SAAJ 1.1 MessageFactory&quot;);\r\n                        this.messageFactory = MessageFactory.newInstance();\r\n                    }\r\n                } catch (NoSuchMethodError var2) {\r\n                    throw new SoapMessageCreationException(&quot;Could not create SAAJ MessageFactory. Is the version of the SAAJ specification interfaces [&quot; + SaajUtils.getSaajVersionString() + &quot;] the same as the version supported by the application server?&quot;, var2);\r\n                } catch (SOAPException var3) {\r\n                    throw new SoapMessageCreationException(&quot;Could not create SAAJ MessageFactory: &quot; + var3.getMessage(), var3);\r\n                }\r\n            }\r\n    \r\n            if (logger.isDebugEnabled()) {\r\n                logger.debug(&quot;Using MessageFactory class [&quot; + this.messageFactory.getClass().getName() + &quot;]&quot;);\r\n            }\r\n    \r\n        }\r\n    \r\n        public SaajSoapMessage createWebServiceMessage() {\r\n            try {\r\n                SOAPMessage saajMessage = this.messageFactory.createMessage();\r\n                this.postProcess(saajMessage);\r\n                return new SaajSoapMessage(saajMessage, this.langAttributeOnSoap11FaultString, this.messageFactory);\r\n            } catch (SOAPException var2) {\r\n                throw new SoapMessageCreationException(&quot;Could not create empty message: &quot; + var2.getMessage(), var2);\r\n            }\r\n        }\r\n        /*Override default property oenter code heref createWebServiceMessage*/\r\n        public SaajSoapMessage createWebServiceMessage(InputStream inputStream) throws IOException {\r\n            MimeHeaders mimeHeaders = this.parseMimeHeaders(inputStream);\r\n            try {\r\n                inputStream = checkForUtf8ByteOrderMark(inputStream);\r\n                SOAPMessage saajMessage = null;\r\n                if (mimeHeaders.getHeader(HttpHeaders.CONTENT_TYPE)[0].contains(MimeTypeUtils.TEXT_XML_VALUE)) {\r\n                    saajMessage = messageFactory11.createMessage(mimeHeaders, inputStream);\r\n                } else {\r\n                    saajMessage = messageFactory12.createMessage(mimeHeaders, inputStream);\r\n                }\r\n                saajMessage.getSOAPPart().getEnvelope();\r\n                this.postProcess(saajMessage);\r\n                return new SaajSoapMessage(saajMessage, this.langAttributeOnSoap11FaultString, this.messageFactory);\r\n            } catch (SOAPException var7) {\r\n                String contentType = StringUtils.arrayToCommaDelimitedString(mimeHeaders.getHeader(&quot;Content-Type&quot;));\r\n                if (contentType.contains(&quot;startinfo&quot;)) {\r\n                    contentType = contentType.replace(&quot;startinfo&quot;, &quot;start-info&quot;);\r\n                    mimeHeaders.setHeader(&quot;Content-Type&quot;, contentType);\r\n    \r\n                    try {\r\n                        SOAPMessage saajMessage = this.messageFactory.createMessage(mimeHeaders, inputStream);\r\n                        this.postProcess(saajMessage);\r\n                        return new SaajSoapMessage(saajMessage, this.langAttributeOnSoap11FaultString);\r\n                    } catch (SOAPException var6) {\r\n                    }\r\n                }\r\n    \r\n                SAXParseException parseException = this.getSAXParseException(var7);\r\n                if (parseException != null) {\r\n                    throw new InvalidXmlException(&quot;Could not parse XML&quot;, parseException);\r\n                } else {\r\n                    throw new SoapMessageCreationException(&quot;Could not create message from InputStream: &quot; + var7.getMessage(), var7);\r\n                }\r\n            }\r\n        }\r\n    \r\n        private SAXParseException getSAXParseException(Throwable ex) {\r\n            if (ex instanceof SAXParseException) {\r\n                return (SAXParseException)ex;\r\n            } else {\r\n                return ex.getCause() != null ? this.getSAXParseException(ex.getCause()) : null;\r\n            }\r\n        }\r\n    \r\n        private MimeHeaders parseMimeHeaders(InputStream inputStream) throws IOException {\r\n            MimeHeaders mimeHeaders = new MimeHeaders();\r\n            if (inputStream instanceof TransportInputStream) {\r\n                TransportInputStream transportInputStream = (TransportInputStream)inputStream;\r\n                Iterator headerNames = transportInputStream.getHeaderNames();\r\n    \r\n                while(headerNames.hasNext()) {\r\n                    String headerName = (String)headerNames.next();\r\n                    Iterator headerValues = transportInputStream.getHeaders(headerName);\r\n    \r\n                    while(headerValues.hasNext()) {\r\n                        String headerValue = (String)headerValues.next();\r\n                        StringTokenizer tokenizer = new StringTokenizer(headerValue, &quot;,&quot;);\r\n    \r\n                        while(tokenizer.hasMoreTokens()) {\r\n                            mimeHeaders.addHeader(headerName, tokenizer.nextToken().trim());\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n    \r\n            return mimeHeaders;\r\n        }\r\n    \r\n        private InputStream checkForUtf8ByteOrderMark(InputStream inputStream) throws IOException {\r\n            PushbackInputStream pushbackInputStream = new PushbackInputStream(new BufferedInputStream(inputStream), 3);\r\n            byte[] bytes = new byte[3];\r\n    \r\n            int bytesRead;\r\n            int n;\r\n            for(bytesRead = 0; bytesRead &lt; bytes.length; bytesRead += n) {\r\n                n = pushbackInputStream.read(bytes, bytesRead, bytes.length - bytesRead);\r\n                if (n &lt;= 0) {\r\n                    break;\r\n                }\r\n            }\r\n    \r\n            if (bytesRead &gt; 0 &amp;&amp; !this.isByteOrderMark(bytes)) {\r\n                pushbackInputStream.unread(bytes, 0, bytesRead);\r\n            }\r\n    \r\n            return pushbackInputStream;\r\n        }\r\n    \r\n        private boolean isByteOrderMark(byte[] bytes) {\r\n            return bytes.length == 3 &amp;&amp; bytes[0] == -17 &amp;&amp; bytes[1] == -69 &amp;&amp; bytes[2] == -65;\r\n        }\r\n    \r\n        protected void postProcess(SOAPMessage soapMessage) throws SOAPException {\r\n            if (!CollectionUtils.isEmpty(this.messageProperties)) {\r\n                Iterator var2 = this.messageProperties.entrySet().iterator();\r\n    \r\n                while(var2.hasNext()) {\r\n                    Entry&lt;String, ?&gt; entry = (Entry)var2.next();\r\n                    soapMessage.setProperty((String)entry.getKey(), entry.getValue());\r\n                }\r\n            }\r\n    \r\n            if (&quot;SOAP 1.1 Protocol&quot;.equals(this.messageFactoryProtocol)) {\r\n                MimeHeaders headers = soapMessage.getMimeHeaders();\r\n                if (ObjectUtils.isEmpty(headers.getHeader(&quot;SOAPAction&quot;))) {\r\n                    headers.addHeader(&quot;SOAPAction&quot;, &quot;\\&quot;\\&quot;&quot;);\r\n                }\r\n            }\r\n    \r\n        }\r\n    \r\n        public String toString() {\r\n            StringBuilder builder = new StringBuilder(&quot;SaajSoapMessageFactory[&quot;);\r\n            builder.append(SaajUtils.getSaajVersionString());\r\n            if (SaajUtils.getSaajVersion() &gt;= 2) {\r\n                builder.append(&#39;,&#39;);\r\n                builder.append(this.messageFactoryProtocol);\r\n            }\r\n    \r\n            builder.append(&#39;]&#39;);\r\n            return builder.toString();\r\n        }\r\n    }\r\n\r\n","title":"Support both SOAP 1.1 and SOAP 1.2 messages in Spring-WS","body":"<pre><code>import java.io.BufferedInputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PushbackInputStream;\nimport java.util.Iterator;\nimport java.util.Map;\nimport java.util.StringTokenizer;\nimport java.util.Map.Entry;\nimport javax.xml.soap.*;\nimport org.apache.commons.logging.Log;\nimport org.apache.commons.logging.LogFactory;\nimport org.apache.http.HttpHeaders;\nimport org.springframework.beans.factory.InitializingBean;\nimport org.springframework.util.CollectionUtils;\nimport org.springframework.util.MimeTypeUtils;\nimport org.springframework.util.ObjectUtils;\nimport org.springframework.util.StringUtils;\nimport org.springframework.ws.InvalidXmlException;\nimport org.springframework.ws.soap.SoapMessageCreationException;\nimport org.springframework.ws.soap.SoapMessageFactory;\nimport org.springframework.ws.soap.SoapVersion;\nimport org.springframework.ws.soap.saaj.SaajSoapMessage;\nimport org.springframework.ws.soap.saaj.support.SaajUtils;\nimport org.springframework.ws.transport.TransportInputStream;\nimport org.xml.sax.SAXParseException;\n/*Copy of class SaajSoapMessageFactory to override method createWebServiceMessage(InputStream inputStream)*/\npublic class DualProtocolSaajSoapMessageFactory implements SoapMessageFactory, InitializingBean {\n    private static final Log logger = LogFactory.getLog(DualProtocolSaajSoapMessageFactory.class);\n    private MessageFactory messageFactory;\n    private String messageFactoryProtocol;\n    private boolean langAttributeOnSoap11FaultString = true;\n    private Map&lt;String, ?&gt; messageProperties;\n    MessageFactory messageFactory11;\n    MessageFactory messageFactory12;\n    public DualProtocolSaajSoapMessageFactory() {\n        super();\n\n        try {\n            messageFactory11 = MessageFactory.newInstance(SOAPConstants.SOAP_1_1_PROTOCOL);\n            messageFactory12 = MessageFactory.newInstance(SOAPConstants.SOAP_1_2_PROTOCOL);\n        } catch (Exception ex) {\n            throw new SoapMessageCreationException(\"Could not create SAAJ MessageFactory: \" + ex.getMessage(), ex);\n        }\n    }\n\n    public DualProtocolSaajSoapMessageFactory(MessageFactory messageFactory) {\n        this.messageFactory = messageFactory;\n    }\n\n    public MessageFactory getMessageFactory() {\n        return this.messageFactory;\n    }\n\n    public void setMessageFactory(MessageFactory messageFactory) {\n        this.messageFactory = messageFactory;\n    }\n\n    public void setMessageProperties(Map&lt;String, ?&gt; messageProperties) {\n        this.messageProperties = messageProperties;\n    }\n\n    public void setLangAttributeOnSoap11FaultString(boolean langAttributeOnSoap11FaultString) {\n        this.langAttributeOnSoap11FaultString = langAttributeOnSoap11FaultString;\n    }\n\n    public void setSoapVersion(SoapVersion version) {\n        if (SaajUtils.getSaajVersion() &gt;= 2) {\n            if (SoapVersion.SOAP_11 == version) {\n                this.messageFactoryProtocol = \"SOAP 1.1 Protocol\";\n            } else {\n                if (SoapVersion.SOAP_12 != version) {\n                    throw new IllegalArgumentException(\"Invalid version [\" + version + \"]. Expected the SOAP_11 or SOAP_12 constant\");\n                }\n\n                this.messageFactoryProtocol = \"SOAP 1.2 Protocol\";\n            }\n        } else if (SoapVersion.SOAP_11 != version) {\n            throw new IllegalArgumentException(\"SAAJ 1.1 and 1.2 only support SOAP 1.1\");\n        }\n\n    }\n\n    public void afterPropertiesSet() {\n        if (this.messageFactory == null) {\n            try {\n                if (SaajUtils.getSaajVersion() &gt;= 2) {\n                    if (!StringUtils.hasLength(this.messageFactoryProtocol)) {\n                        this.messageFactoryProtocol = \"SOAP 1.1 Protocol\";\n                    }\n\n                    if (logger.isInfoEnabled()) {\n                        logger.info(\"Creating SAAJ 1.3 MessageFactory with \" + this.messageFactoryProtocol);\n                    }\n\n                    this.messageFactory = MessageFactory.newInstance(this.messageFactoryProtocol);\n                } else if (SaajUtils.getSaajVersion() == 1) {\n                    logger.info(\"Creating SAAJ 1.2 MessageFactory\");\n                    this.messageFactory = MessageFactory.newInstance();\n                } else {\n                    if (SaajUtils.getSaajVersion() != 0) {\n                        throw new IllegalStateException(\"SaajSoapMessageFactory requires SAAJ 1.1, which was not found on the classpath\");\n                    }\n\n                    logger.info(\"Creating SAAJ 1.1 MessageFactory\");\n                    this.messageFactory = MessageFactory.newInstance();\n                }\n            } catch (NoSuchMethodError var2) {\n                throw new SoapMessageCreationException(\"Could not create SAAJ MessageFactory. Is the version of the SAAJ specification interfaces [\" + SaajUtils.getSaajVersionString() + \"] the same as the version supported by the application server?\", var2);\n            } catch (SOAPException var3) {\n                throw new SoapMessageCreationException(\"Could not create SAAJ MessageFactory: \" + var3.getMessage(), var3);\n            }\n        }\n\n        if (logger.isDebugEnabled()) {\n            logger.debug(\"Using MessageFactory class [\" + this.messageFactory.getClass().getName() + \"]\");\n        }\n\n    }\n\n    public SaajSoapMessage createWebServiceMessage() {\n        try {\n            SOAPMessage saajMessage = this.messageFactory.createMessage();\n            this.postProcess(saajMessage);\n            return new SaajSoapMessage(saajMessage, this.langAttributeOnSoap11FaultString, this.messageFactory);\n        } catch (SOAPException var2) {\n            throw new SoapMessageCreationException(\"Could not create empty message: \" + var2.getMessage(), var2);\n        }\n    }\n    /*Override default property oenter code heref createWebServiceMessage*/\n    public SaajSoapMessage createWebServiceMessage(InputStream inputStream) throws IOException {\n        MimeHeaders mimeHeaders = this.parseMimeHeaders(inputStream);\n        try {\n            inputStream = checkForUtf8ByteOrderMark(inputStream);\n            SOAPMessage saajMessage = null;\n            if (mimeHeaders.getHeader(HttpHeaders.CONTENT_TYPE)[0].contains(MimeTypeUtils.TEXT_XML_VALUE)) {\n                saajMessage = messageFactory11.createMessage(mimeHeaders, inputStream);\n            } else {\n                saajMessage = messageFactory12.createMessage(mimeHeaders, inputStream);\n            }\n            saajMessage.getSOAPPart().getEnvelope();\n            this.postProcess(saajMessage);\n            return new SaajSoapMessage(saajMessage, this.langAttributeOnSoap11FaultString, this.messageFactory);\n        } catch (SOAPException var7) {\n            String contentType = StringUtils.arrayToCommaDelimitedString(mimeHeaders.getHeader(\"Content-Type\"));\n            if (contentType.contains(\"startinfo\")) {\n                contentType = contentType.replace(\"startinfo\", \"start-info\");\n                mimeHeaders.setHeader(\"Content-Type\", contentType);\n\n                try {\n                    SOAPMessage saajMessage = this.messageFactory.createMessage(mimeHeaders, inputStream);\n                    this.postProcess(saajMessage);\n                    return new SaajSoapMessage(saajMessage, this.langAttributeOnSoap11FaultString);\n                } catch (SOAPException var6) {\n                }\n            }\n\n            SAXParseException parseException = this.getSAXParseException(var7);\n            if (parseException != null) {\n                throw new InvalidXmlException(\"Could not parse XML\", parseException);\n            } else {\n                throw new SoapMessageCreationException(\"Could not create message from InputStream: \" + var7.getMessage(), var7);\n            }\n        }\n    }\n\n    private SAXParseException getSAXParseException(Throwable ex) {\n        if (ex instanceof SAXParseException) {\n            return (SAXParseException)ex;\n        } else {\n            return ex.getCause() != null ? this.getSAXParseException(ex.getCause()) : null;\n        }\n    }\n\n    private MimeHeaders parseMimeHeaders(InputStream inputStream) throws IOException {\n        MimeHeaders mimeHeaders = new MimeHeaders();\n        if (inputStream instanceof TransportInputStream) {\n            TransportInputStream transportInputStream = (TransportInputStream)inputStream;\n            Iterator headerNames = transportInputStream.getHeaderNames();\n\n            while(headerNames.hasNext()) {\n                String headerName = (String)headerNames.next();\n                Iterator headerValues = transportInputStream.getHeaders(headerName);\n\n                while(headerValues.hasNext()) {\n                    String headerValue = (String)headerValues.next();\n                    StringTokenizer tokenizer = new StringTokenizer(headerValue, \",\");\n\n                    while(tokenizer.hasMoreTokens()) {\n                        mimeHeaders.addHeader(headerName, tokenizer.nextToken().trim());\n                    }\n                }\n            }\n        }\n\n        return mimeHeaders;\n    }\n\n    private InputStream checkForUtf8ByteOrderMark(InputStream inputStream) throws IOException {\n        PushbackInputStream pushbackInputStream = new PushbackInputStream(new BufferedInputStream(inputStream), 3);\n        byte[] bytes = new byte[3];\n\n        int bytesRead;\n        int n;\n        for(bytesRead = 0; bytesRead &lt; bytes.length; bytesRead += n) {\n            n = pushbackInputStream.read(bytes, bytesRead, bytes.length - bytesRead);\n            if (n &lt;= 0) {\n                break;\n            }\n        }\n\n        if (bytesRead &gt; 0 &amp;&amp; !this.isByteOrderMark(bytes)) {\n            pushbackInputStream.unread(bytes, 0, bytesRead);\n        }\n\n        return pushbackInputStream;\n    }\n\n    private boolean isByteOrderMark(byte[] bytes) {\n        return bytes.length == 3 &amp;&amp; bytes[0] == -17 &amp;&amp; bytes[1] == -69 &amp;&amp; bytes[2] == -65;\n    }\n\n    protected void postProcess(SOAPMessage soapMessage) throws SOAPException {\n        if (!CollectionUtils.isEmpty(this.messageProperties)) {\n            Iterator var2 = this.messageProperties.entrySet().iterator();\n\n            while(var2.hasNext()) {\n                Entry&lt;String, ?&gt; entry = (Entry)var2.next();\n                soapMessage.setProperty((String)entry.getKey(), entry.getValue());\n            }\n        }\n\n        if (\"SOAP 1.1 Protocol\".equals(this.messageFactoryProtocol)) {\n            MimeHeaders headers = soapMessage.getMimeHeaders();\n            if (ObjectUtils.isEmpty(headers.getHeader(\"SOAPAction\"))) {\n                headers.addHeader(\"SOAPAction\", \"\\\"\\\"\");\n            }\n        }\n\n    }\n\n    public String toString() {\n        StringBuilder builder = new StringBuilder(\"SaajSoapMessageFactory[\");\n        builder.append(SaajUtils.getSaajVersionString());\n        if (SaajUtils.getSaajVersion() &gt;= 2) {\n            builder.append(',');\n            builder.append(this.messageFactoryProtocol);\n        }\n\n        builder.append(']');\n        return builder.toString();\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":3782127,"reputation":99,"user_id":3141256,"display_name":"Sreejesh Ellath"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1596710921,"creation_date":1596710921,"answer_id":63281984,"question_id":53567967,"body_markdown":"    Above will fail if you have concurrent request of soap1.1 and soap1.2, to avoid that the messageFactory should be created with @RequestScope, for example.\r\n    \t\r\n    \r\n    \t@Bean\r\n    \t@RequestScope\r\n    \tpublic SoapMessageFactory  messageFactory() {\r\n    \t\t logger.info(&quot;Calling SoapMessageFactory Bean&quot;);\r\n    \t\tDualProtocolSaajSoapMessageFactory s = new DualProtocolSaajSoapMessageFactory();\r\n    \t    return s;\r\n    \t}\r\n    \r\n    \r\n    and the full Spring WS config java file will be like below\r\n    \r\n    package com.hps.powercard;\r\n    \r\n    import java.util.List;\r\n    \r\n    import javax.naming.NamingException;\r\n    import javax.sql.DataSource;\r\n    \r\n    import org.apache.commons.logging.Log;\r\n    import org.apache.commons.logging.LogFactory;\r\n    import org.springframework.boot.web.servlet.ServletRegistrationBean;\r\n    import org.springframework.context.ApplicationContext;\r\n    import org.springframework.context.annotation.Bean;\r\n    import org.springframework.context.annotation.Configuration;\r\n    import org.springframework.context.annotation.Scope;\r\n    import org.springframework.core.io.ClassPathResource;\r\n    import org.springframework.jdbc.core.JdbcTemplate;\r\n    import org.springframework.jndi.JndiTemplate;\r\n    import org.springframework.web.context.annotation.RequestScope;\r\n    import org.springframework.ws.config.annotation.EnableWs;\r\n    import org.springframework.ws.config.annotation.WsConfigurerAdapter;\r\n    import org.springframework.ws.server.EndpointInterceptor;\r\n    import org.springframework.ws.soap.SoapMessageFactory;\r\n    import org.springframework.ws.soap.server.endpoint.interceptor.PayloadValidatingInterceptor;\r\n    import org.springframework.ws.transport.http.MessageDispatcherServlet;\r\n    import org.springframework.ws.wsdl.wsdl11.DefaultWsdl11Definition;\r\n    import org.springframework.ws.wsdl.wsdl11.SimpleWsdl11Definition;\r\n    import org.springframework.ws.wsdl.wsdl11.Wsdl11Definition;\r\n    import org.springframework.xml.xsd.SimpleXsdSchema;\r\n    import org.springframework.xml.xsd.XsdSchema;\r\n    \r\n    \r\n    \r\n    \r\n    @EnableWs\r\n    @Configuration\r\n    public class WebServiceConfig extends WsConfigurerAdapter {\r\n    \tprivate static final Log logger = LogFactory.getLog(WebServiceConfig.class);\r\n    \t@Bean\r\n    \tpublic ServletRegistrationBean messageDispatcherServlet(ApplicationContext applicationContext) {\r\n    \t\tMessageDispatcherServlet servlet = new MessageDispatcherServlet();\r\n    \t\tservlet.setApplicationContext(applicationContext);\r\n    \t\tservlet.setTransformWsdlLocations(true);\r\n    \t\treturn new ServletRegistrationBean(servlet, &quot;/services/*&quot;);\r\n    \t}\r\n    \t@Bean(name = &quot;AlShayaPosWS&quot;)\r\n    \t  public Wsdl11Definition defaultWsdl11Definition(XsdSchema countriesSchema) {\r\n    \t\tSimpleWsdl11Definition wsdl11Definition = new SimpleWsdl11Definition(new ClassPathResource(&quot;AlShayaPosWS.wsdl&quot;));\r\n    \t\t\r\n    \t    return wsdl11Definition;\r\n    \t  }\r\n    \t@Bean\r\n    \t@RequestScope\r\n    \tpublic SoapMessageFactory  messageFactory() {\r\n    \t\t logger.info(&quot;Calling SoapMessageFactory Bean&quot;);\r\n    \t\tDualProtocolSaajSoapMessageFactory s = new DualProtocolSaajSoapMessageFactory();\r\n    \t    return s;\r\n    \t}\t\r\n    \t@Bean\r\n    \tpublic XsdSchema getBalanceDetailsSchema() {\r\n    \t\treturn new SimpleXsdSchema(new ClassPathResource(&quot;alshaya.xsd&quot;));\r\n    \t}\r\n    \t/*@Bean(name = &quot;AlShayaPosWS&quot;)\r\n    \tpublic DefaultWsdl11Definition defaultWsdl11Definition(XsdSchema getBalanceDetailsSchema) {\r\n    \t\tDefaultWsdl11Definition wsdl11Definition = new DefaultWsdl11Definition();\r\n    \t\twsdl11Definition.setPortTypeName(&quot;AlShayaPosWSPortType&quot;);\r\n    \t\twsdl11Definition.setLocationUri(&quot;/ws&quot;);\r\n    \t\twsdl11Definition.setTargetNamespace(&quot;http://alshaya.ws.iface.bw.rs2.com&quot;);\r\n    \t\twsdl11Definition.setSchema(getBalanceDetailsSchema);\r\n    \t\treturn wsdl11Definition;\r\n    \t}\r\n    \r\n    \r\n    \t@Bean\r\n    \tpublic XsdSchema getBalanceDetailsSchema() {\r\n    \t\treturn new SimpleXsdSchema(new ClassPathResource(&quot;alshayaws.xsd&quot;));\r\n    \t}*/\r\n    \t@Bean\r\n        public DataSource dataSource() throws NamingException { \r\n    //        return (DataSource) new JndiTemplate().lookup(&quot;java://jdbc/PWCCFGDS&quot;);\r\n        \treturn (DataSource) new JndiTemplate().lookup(&quot;jdbc/PWCCFGDS&quot;);\r\n        }\r\n    \r\n        @Bean\r\n        public JdbcTemplate jdbcTemplate(DataSource dataSource) {\r\n            JdbcTemplate jdbcTemplate = new JdbcTemplate(dataSource);\r\n            jdbcTemplate.setResultsMapCaseInsensitive(true);\r\n            return jdbcTemplate;\r\n        }\t\r\n        @Override\r\n        public void addInterceptors(List&lt;EndpointInterceptor&gt; interceptors) {\r\n          PayloadValidatingInterceptor validatingInterceptor = new PayloadValidatingInterceptor();\r\n          validatingInterceptor.setValidateRequest(true);\r\n          validatingInterceptor.setValidateResponse(true);\r\n          validatingInterceptor.setXsdSchema(getBalanceDetailsSchema());\r\n          interceptors.add(validatingInterceptor);\r\n          interceptors.add(new CustomEndpointInterceptor());\r\n    //      interceptors.add(new SOAP11CustomEndpointInterceptorAdapter());\r\n    //      interceptors.add(new SOAP12CustomEndpointInterceptorAdapter());\r\n        }    \r\n    }\r\n    \r\n    \r\n    and the DualProtocolSaajSoapMessageFactory will be like below , i have just copy paste the above\r\n    \r\n    package com.hps.powercard;\r\n    import java.util.Map;\r\n    import java.util.StringTokenizer;\r\n    import java.util.Map.Entry;\r\n    import javax.xml.soap.*;\r\n    import org.apache.commons.logging.Log;\r\n    import org.apache.commons.logging.LogFactory;\r\n    \r\n    import org.springframework.beans.factory.InitializingBean;\r\n    import org.springframework.http.HttpHeaders;\r\n    import org.springframework.util.CollectionUtils;\r\n    import org.springframework.util.MimeTypeUtils;\r\n    import org.springframework.util.ObjectUtils;\r\n    import org.springframework.util.StringUtils;\r\n    import org.springframework.ws.InvalidXmlException;\r\n    import org.springframework.ws.soap.SoapMessageCreationException;\r\n    import org.springframework.ws.soap.SoapMessageFactory;\r\n    import org.springframework.ws.soap.SoapVersion;\r\n    import org.springframework.ws.soap.saaj.SaajSoapMessage;\r\n    import org.springframework.ws.soap.saaj.support.SaajUtils;\r\n    import org.springframework.ws.transport.TransportInputStream;\r\n    import org.xml.sax.SAXParseException;\r\n    import java.io.BufferedInputStream;\r\n    import java.io.IOException;\r\n    import java.io.InputStream;\r\n    import java.io.PushbackInputStream;\r\n    import java.util.Iterator;\r\n    public class DualProtocolSaajSoapMessageFactory implements SoapMessageFactory, InitializingBean {\r\n        private static final Log logger = LogFactory.getLog(DualProtocolSaajSoapMessageFactory.class);\r\n        private MessageFactory messageFactory;\r\n        private String messageFactoryProtocol;\r\n        private boolean langAttributeOnSoap11FaultString = true;\r\n        private Map&lt;String, ?&gt; messageProperties;\r\n        MessageFactory messageFactory11;\r\n        MessageFactory messageFactory12;\r\n        public DualProtocolSaajSoapMessageFactory() {\r\n            super();\r\n    \r\n            try {\r\n                messageFactory11 = MessageFactory.newInstance(SOAPConstants.SOAP_1_1_PROTOCOL);\r\n                messageFactory12 = MessageFactory.newInstance(SOAPConstants.SOAP_1_2_PROTOCOL);\r\n            } catch (Exception ex) {\r\n                throw new SoapMessageCreationException(&quot;Could not create SAAJ MessageFactory: &quot; + ex.getMessage(), ex);\r\n            }\r\n        }\r\n    \r\n        public DualProtocolSaajSoapMessageFactory(MessageFactory messageFactory) {\r\n            this.messageFactory = messageFactory;\r\n        }\r\n    \r\n        public MessageFactory getMessageFactory() {\r\n            return this.messageFactory;\r\n        }\r\n    \r\n        public void setMessageFactory(MessageFactory messageFactory) {\r\n            this.messageFactory = messageFactory;\r\n        }\r\n    \r\n        public void setMessageProperties(Map&lt;String, ?&gt; messageProperties) {\r\n            this.messageProperties = messageProperties;\r\n        }\r\n    \r\n        public void setLangAttributeOnSoap11FaultString(boolean langAttributeOnSoap11FaultString) {\r\n            this.langAttributeOnSoap11FaultString = langAttributeOnSoap11FaultString;\r\n        }\r\n    \r\n        public void setSoapVersion(SoapVersion version) {\r\n            if (SaajUtils.getSaajVersion() &gt;= 2) {\r\n                if (SoapVersion.SOAP_11 == version) {\r\n                    this.messageFactoryProtocol = &quot;SOAP 1.1 Protocol&quot;;\r\n                } else {\r\n                    if (SoapVersion.SOAP_12 != version) {\r\n                        throw new IllegalArgumentException(&quot;Invalid version [&quot; + version + &quot;]. Expected the SOAP_11 or SOAP_12 constant&quot;);\r\n                    }\r\n    \r\n                    this.messageFactoryProtocol = &quot;SOAP 1.2 Protocol&quot;;\r\n                }\r\n            } else if (SoapVersion.SOAP_11 != version) {\r\n                throw new IllegalArgumentException(&quot;SAAJ 1.1 and 1.2 only support SOAP 1.1&quot;);\r\n            }\r\n    \r\n        }\r\n    \r\n        public void afterPropertiesSet() {\r\n        \tlogger.info(&quot;Calling afterPropertiesSet()&quot;);\r\n            if (this.messageFactory == null) {\r\n                try {\r\n                    if (SaajUtils.getSaajVersion() &gt;= 2) {\r\n                        if (!StringUtils.hasLength(this.messageFactoryProtocol)) {\r\n                            this.messageFactoryProtocol = &quot;SOAP 1.1 Protocol&quot;;\r\n                        }\r\n    \r\n                        if (logger.isInfoEnabled()) {\r\n                            logger.info(&quot;Creating SAAJ 1.3 MessageFactory with &quot; + this.messageFactoryProtocol);\r\n                        }\r\n    \r\n                        this.messageFactory = MessageFactory.newInstance(this.messageFactoryProtocol);\r\n                    } else if (SaajUtils.getSaajVersion() == 1) {\r\n                        logger.info(&quot;Creating SAAJ 1.2 MessageFactory&quot;);\r\n                        this.messageFactory = MessageFactory.newInstance();\r\n                    } else {\r\n                        if (SaajUtils.getSaajVersion() != 0) {\r\n                            throw new IllegalStateException(&quot;SaajSoapMessageFactory requires SAAJ 1.1, which was not found on the classpath&quot;);\r\n                        }\r\n    \r\n                        logger.info(&quot;Creating SAAJ 1.1 MessageFactory&quot;);\r\n                        this.messageFactory = MessageFactory.newInstance();\r\n                    }\r\n                } catch (NoSuchMethodError var2) {\r\n                    throw new SoapMessageCreationException(&quot;Could not create SAAJ MessageFactory. Is the version of the SAAJ specification interfaces [&quot; + SaajUtils.getSaajVersionString() + &quot;] the same as the version supported by the application server?&quot;, var2);\r\n                } catch (SOAPException var3) {\r\n                    throw new SoapMessageCreationException(&quot;Could not create SAAJ MessageFactory: &quot; + var3.getMessage(), var3);\r\n                }\r\n            }\r\n    \r\n            if (logger.isDebugEnabled()) {\r\n                logger.debug(&quot;Using MessageFactory class [&quot; + this.messageFactory.getClass().getName() + &quot;]&quot;);\r\n            }\r\n    \r\n        }\r\n    \r\n        public SaajSoapMessage createWebServiceMessage() {\r\n        \tlogger.info(&quot;Calling createWebServiceMessage()&quot;);\r\n            try {\r\n                SOAPMessage saajMessage = this.messageFactory.createMessage();\r\n                this.postProcess(saajMessage);\r\n                return new SaajSoapMessage(saajMessage, this.langAttributeOnSoap11FaultString, this.messageFactory);\r\n            } catch (SOAPException var2) {\r\n                throw new SoapMessageCreationException(&quot;Could not create empty message: &quot; + var2.getMessage(), var2);\r\n            }\r\n        }\r\n        /*Override default property oenter code heref createWebServiceMessage*/\r\n        public SaajSoapMessage createWebServiceMessage(InputStream inputStream) throws IOException {\r\n        \tlogger.info(&quot;Calling createWebServiceMessage(InputStream inputStream)&quot;);\r\n            MimeHeaders mimeHeaders = this.parseMimeHeaders(inputStream);\r\n            try {\r\n                inputStream = checkForUtf8ByteOrderMark(inputStream);\r\n                SOAPMessage saajMessage = null;\r\n                System.out.println(&quot;Obtained Content-Type is :&quot;+mimeHeaders.getHeader(HttpHeaders.CONTENT_TYPE)[0]);\r\n                if (mimeHeaders.getHeader(HttpHeaders.CONTENT_TYPE)[0].contains(MimeTypeUtils.TEXT_XML_VALUE)) {\r\n                \tlogger.info(&quot;Obtained Protocol : SOAP 1.1 Protocol&quot;);\r\n                \tthis.messageFactoryProtocol = &quot;SOAP 1.1 Protocol&quot;;\r\n                \tthis.messageFactory = MessageFactory.newInstance(this.messageFactoryProtocol);\r\n                    saajMessage = messageFactory11.createMessage(mimeHeaders, inputStream);\r\n                }\r\n                else if (mimeHeaders.getHeader(HttpHeaders.CONTENT_TYPE)[0].trim().toLowerCase().contains(MimeTypeUtils.TEXT_XML_VALUE)) {\r\n                \tlogger.info(&quot;Obtained Protocol : SOAP 1.1 Protocol&quot;);\r\n                \tthis.messageFactoryProtocol = &quot;SOAP 1.1 Protocol&quot;;\r\n                \tthis.messageFactory = MessageFactory.newInstance(this.messageFactoryProtocol);\r\n                    saajMessage = messageFactory11.createMessage(mimeHeaders, inputStream);\r\n                }            \r\n                else if (mimeHeaders.getHeader(HttpHeaders.CONTENT_TYPE)[0].trim().toLowerCase().contains(&quot;text/xml&quot;)) {\r\n                \tlogger.info(&quot;Obtained Protocol : SOAP 1.1 Protocol&quot;);\r\n                \tthis.messageFactoryProtocol = &quot;SOAP 1.1 Protocol&quot;;\r\n                \tthis.messageFactory = MessageFactory.newInstance(this.messageFactoryProtocol);\r\n                    saajMessage = messageFactory11.createMessage(mimeHeaders, inputStream);\r\n                }              \r\n                else {\r\n                \tlogger.info(&quot;Obtained Protocol : SOAP 1.2 Protocol&quot;);\r\n                \tthis.messageFactoryProtocol = &quot;SOAP 1.2 Protocol&quot;;\r\n                \tthis.messageFactory = MessageFactory.newInstance(this.messageFactoryProtocol);\r\n                    saajMessage = messageFactory12.createMessage(mimeHeaders, inputStream);  \r\n                }\r\n                saajMessage.getSOAPPart().getEnvelope();\r\n                this.postProcess(saajMessage);\r\n                return new SaajSoapMessage(saajMessage, this.langAttributeOnSoap11FaultString, this.messageFactory);\r\n            } catch (SOAPException var7) {\r\n                String contentType = StringUtils.arrayToCommaDelimitedString(mimeHeaders.getHeader(&quot;Content-Type&quot;));\r\n                if (contentType.contains(&quot;startinfo&quot;)) {\r\n                    contentType = contentType.replace(&quot;startinfo&quot;, &quot;start-info&quot;);\r\n                    mimeHeaders.setHeader(&quot;Content-Type&quot;, contentType);\r\n    \r\n                    try {\r\n                        SOAPMessage saajMessage = this.messageFactory.createMessage(mimeHeaders, inputStream);\r\n                        this.postProcess(saajMessage);\r\n                        return new SaajSoapMessage(saajMessage, this.langAttributeOnSoap11FaultString);\r\n                    } catch (SOAPException var6) {\r\n                    }\r\n                }\r\n    \r\n                SAXParseException parseException = this.getSAXParseException(var7);\r\n                if (parseException != null) {\r\n                    throw new InvalidXmlException(&quot;Could not parse XML&quot;, parseException);\r\n                } else {\r\n                    throw new SoapMessageCreationException(&quot;Could not create message from InputStream: &quot; + var7.getMessage(), var7);\r\n                }\r\n            }\r\n        }\r\n    \r\n        private SAXParseException getSAXParseException(Throwable ex) {\r\n            if (ex instanceof SAXParseException) {\r\n                return (SAXParseException)ex;\r\n            } else {\r\n                return ex.getCause() != null ? this.getSAXParseException(ex.getCause()) : null;\r\n            }\r\n        }\r\n    \r\n        private MimeHeaders parseMimeHeaders(InputStream inputStream) throws IOException {\r\n            MimeHeaders mimeHeaders = new MimeHeaders();\r\n            if (inputStream instanceof TransportInputStream) {\r\n                TransportInputStream transportInputStream = (TransportInputStream)inputStream;\r\n                Iterator headerNames = transportInputStream.getHeaderNames();\r\n    \r\n                while(headerNames.hasNext()) {\r\n                    String headerName = (String)headerNames.next();\r\n                    Iterator headerValues = transportInputStream.getHeaders(headerName);\r\n    \r\n                    while(headerValues.hasNext()) {\r\n                        String headerValue = (String)headerValues.next();\r\n                        StringTokenizer tokenizer = new StringTokenizer(headerValue, &quot;,&quot;);\r\n    \r\n                        while(tokenizer.hasMoreTokens()) {\r\n                            mimeHeaders.addHeader(headerName, tokenizer.nextToken().trim());\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n    \r\n            return mimeHeaders;\r\n        }\r\n    \r\n        private InputStream checkForUtf8ByteOrderMark(InputStream inputStream) throws IOException {\r\n            PushbackInputStream pushbackInputStream = new PushbackInputStream(new BufferedInputStream(inputStream), 3);\r\n            byte[] bytes = new byte[3];\r\n    \r\n            int bytesRead;\r\n            int n;\r\n            for(bytesRead = 0; bytesRead &lt; bytes.length; bytesRead += n) {\r\n                n = pushbackInputStream.read(bytes, bytesRead, bytes.length - bytesRead);\r\n                if (n &lt;= 0) {\r\n                    break;\r\n                }\r\n            }\r\n    \r\n            if (bytesRead &gt; 0 &amp;&amp; !this.isByteOrderMark(bytes)) {\r\n                pushbackInputStream.unread(bytes, 0, bytesRead);\r\n            }\r\n    \r\n            return pushbackInputStream;\r\n        }\r\n    \r\n        private boolean isByteOrderMark(byte[] bytes) {\r\n            return bytes.length == 3 &amp;&amp; bytes[0] == -17 &amp;&amp; bytes[1] == -69 &amp;&amp; bytes[2] == -65;\r\n        }\r\n    \r\n        protected void postProcess(SOAPMessage soapMessage) throws SOAPException {\r\n    //    \ttry {\r\n    //    \t   soapMessage.writeTo(System.out);\r\n    //    \t}catch(Exception ex) {}\r\n            if (!CollectionUtils.isEmpty(this.messageProperties)) {\r\n                Iterator var2 = this.messageProperties.entrySet().iterator();\r\n    \r\n                while(var2.hasNext()) {\r\n                    Entry&lt;String, ?&gt; entry = (Entry)var2.next();\r\n                    soapMessage.setProperty((String)entry.getKey(), entry.getValue());\r\n                }\r\n            }\r\n    \r\n            if (&quot;SOAP 1.1 Protocol&quot;.equals(this.messageFactoryProtocol)) {\r\n                MimeHeaders headers = soapMessage.getMimeHeaders();\r\n                if (ObjectUtils.isEmpty(headers.getHeader(&quot;SOAPAction&quot;))) {\r\n                    headers.addHeader(&quot;SOAPAction&quot;, &quot;\\&quot;\\&quot;&quot;);\r\n                }\r\n            }\r\n    \r\n        }\r\n    \r\n        public String toString() {\r\n            StringBuilder builder = new StringBuilder(&quot;SaajSoapMessageFactory[&quot;);\r\n            builder.append(SaajUtils.getSaajVersionString());\r\n            if (SaajUtils.getSaajVersion() &gt;= 2) {\r\n                builder.append(&#39;,&#39;);\r\n                builder.append(this.messageFactoryProtocol);\r\n            }\r\n    \r\n            builder.append(&#39;]&#39;);\r\n            return builder.toString();\r\n        }\r\n    }\r\n    \r\n    And i have created a Request and Response Logger which will be like below\r\n    \r\n        package com.hps.powercard;\r\n    import java.io.ByteArrayOutputStream;\r\n    \r\n    import org.springframework.stereotype.Component;\r\n    import org.springframework.ws.context.MessageContext;\r\n    import org.springframework.ws.server.EndpointInterceptor;\r\n    import org.springframework.ws.soap.SoapMessage;\r\n    \r\n    public class CustomEndpointInterceptor  implements EndpointInterceptor {\r\n        @Override\r\n        public boolean handleRequest(MessageContext messageContext, Object endpoint) throws Exception {\r\n            System.out.println(&quot;### SOAP REQUEST ###&quot;);\r\n            try {\r\n                ByteArrayOutputStream buffer = new ByteArrayOutputStream();\r\n                messageContext.getRequest().writeTo(buffer);\r\n                String payload = buffer.toString(java.nio.charset.StandardCharsets.UTF_8.name());\r\n                System.out.println(&quot;Request &quot;+payload);\r\n            } catch (Exception e) {\r\n               \r\n            }\r\n    \r\n            return true;\r\n        }\r\n    \r\n        @Override\r\n        public boolean handleResponse(MessageContext messageContext, Object endpoint) throws Exception {\r\n            System.out.println(&quot;### SOAP RESPONSE ###&quot;);\r\n            try {\r\n                ByteArrayOutputStream buffer = new ByteArrayOutputStream();\r\n                messageContext.getResponse().writeTo(buffer);\r\n                String payload = buffer.toString(java.nio.charset.StandardCharsets.UTF_8.name());\r\n                System.out.println(&quot;Response :&quot;+payload);\r\n            } catch (Exception e) {\r\n    \r\n            }    \t\r\n            \r\n            return true;\r\n        }\r\n    \r\n        @Override\r\n        public boolean handleFault(MessageContext messageContext, Object endpoint) throws Exception {\r\n            System.out.println(&quot;### SOAP FAULT ###&quot;);\r\n            try {\r\n                ByteArrayOutputStream buffer = new ByteArrayOutputStream();\r\n                messageContext.getResponse().writeTo(buffer);\r\n                String payload = buffer.toString(java.nio.charset.StandardCharsets.UTF_8.name());\r\n                System.out.println(&quot;SOAP FAULT &quot;+payload);\r\n            } catch (Exception e) {\r\n    \r\n            }\r\n            return true;\r\n        }\r\n    \r\n        @Override\r\n        public void afterCompletion(MessageContext messageContext, Object endpoint, Exception ex) throws Exception {\r\n        }\r\n    }\r\n    \r\n        \r\n\r\n\r\n","title":"Support both SOAP 1.1 and SOAP 1.2 messages in Spring-WS","body":"<pre><code>Above will fail if you have concurrent request of soap1.1 and soap1.2, to avoid that the messageFactory should be created with @RequestScope, for example.\n    \n\n    @Bean\n    @RequestScope\n    public SoapMessageFactory  messageFactory() {\n         logger.info(&quot;Calling SoapMessageFactory Bean&quot;);\n        DualProtocolSaajSoapMessageFactory s = new DualProtocolSaajSoapMessageFactory();\n        return s;\n    }\n\n\nand the full Spring WS config java file will be like below\n\npackage com.hps.powercard;\n\nimport java.util.List;\n\nimport javax.naming.NamingException;\nimport javax.sql.DataSource;\n\nimport org.apache.commons.logging.Log;\nimport org.apache.commons.logging.LogFactory;\nimport org.springframework.boot.web.servlet.ServletRegistrationBean;\nimport org.springframework.context.ApplicationContext;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.context.annotation.Scope;\nimport org.springframework.core.io.ClassPathResource;\nimport org.springframework.jdbc.core.JdbcTemplate;\nimport org.springframework.jndi.JndiTemplate;\nimport org.springframework.web.context.annotation.RequestScope;\nimport org.springframework.ws.config.annotation.EnableWs;\nimport org.springframework.ws.config.annotation.WsConfigurerAdapter;\nimport org.springframework.ws.server.EndpointInterceptor;\nimport org.springframework.ws.soap.SoapMessageFactory;\nimport org.springframework.ws.soap.server.endpoint.interceptor.PayloadValidatingInterceptor;\nimport org.springframework.ws.transport.http.MessageDispatcherServlet;\nimport org.springframework.ws.wsdl.wsdl11.DefaultWsdl11Definition;\nimport org.springframework.ws.wsdl.wsdl11.SimpleWsdl11Definition;\nimport org.springframework.ws.wsdl.wsdl11.Wsdl11Definition;\nimport org.springframework.xml.xsd.SimpleXsdSchema;\nimport org.springframework.xml.xsd.XsdSchema;\n\n\n\n\n@EnableWs\n@Configuration\npublic class WebServiceConfig extends WsConfigurerAdapter {\n    private static final Log logger = LogFactory.getLog(WebServiceConfig.class);\n    @Bean\n    public ServletRegistrationBean messageDispatcherServlet(ApplicationContext applicationContext) {\n        MessageDispatcherServlet servlet = new MessageDispatcherServlet();\n        servlet.setApplicationContext(applicationContext);\n        servlet.setTransformWsdlLocations(true);\n        return new ServletRegistrationBean(servlet, &quot;/services/*&quot;);\n    }\n    @Bean(name = &quot;AlShayaPosWS&quot;)\n      public Wsdl11Definition defaultWsdl11Definition(XsdSchema countriesSchema) {\n        SimpleWsdl11Definition wsdl11Definition = new SimpleWsdl11Definition(new ClassPathResource(&quot;AlShayaPosWS.wsdl&quot;));\n        \n        return wsdl11Definition;\n      }\n    @Bean\n    @RequestScope\n    public SoapMessageFactory  messageFactory() {\n         logger.info(&quot;Calling SoapMessageFactory Bean&quot;);\n        DualProtocolSaajSoapMessageFactory s = new DualProtocolSaajSoapMessageFactory();\n        return s;\n    }   \n    @Bean\n    public XsdSchema getBalanceDetailsSchema() {\n        return new SimpleXsdSchema(new ClassPathResource(&quot;alshaya.xsd&quot;));\n    }\n    /*@Bean(name = &quot;AlShayaPosWS&quot;)\n    public DefaultWsdl11Definition defaultWsdl11Definition(XsdSchema getBalanceDetailsSchema) {\n        DefaultWsdl11Definition wsdl11Definition = new DefaultWsdl11Definition();\n        wsdl11Definition.setPortTypeName(&quot;AlShayaPosWSPortType&quot;);\n        wsdl11Definition.setLocationUri(&quot;/ws&quot;);\n        wsdl11Definition.setTargetNamespace(&quot;http://alshaya.ws.iface.bw.rs2.com&quot;);\n        wsdl11Definition.setSchema(getBalanceDetailsSchema);\n        return wsdl11Definition;\n    }\n\n\n    @Bean\n    public XsdSchema getBalanceDetailsSchema() {\n        return new SimpleXsdSchema(new ClassPathResource(&quot;alshayaws.xsd&quot;));\n    }*/\n    @Bean\n    public DataSource dataSource() throws NamingException { \n//        return (DataSource) new JndiTemplate().lookup(&quot;java://jdbc/PWCCFGDS&quot;);\n        return (DataSource) new JndiTemplate().lookup(&quot;jdbc/PWCCFGDS&quot;);\n    }\n\n    @Bean\n    public JdbcTemplate jdbcTemplate(DataSource dataSource) {\n        JdbcTemplate jdbcTemplate = new JdbcTemplate(dataSource);\n        jdbcTemplate.setResultsMapCaseInsensitive(true);\n        return jdbcTemplate;\n    }   \n    @Override\n    public void addInterceptors(List&lt;EndpointInterceptor&gt; interceptors) {\n      PayloadValidatingInterceptor validatingInterceptor = new PayloadValidatingInterceptor();\n      validatingInterceptor.setValidateRequest(true);\n      validatingInterceptor.setValidateResponse(true);\n      validatingInterceptor.setXsdSchema(getBalanceDetailsSchema());\n      interceptors.add(validatingInterceptor);\n      interceptors.add(new CustomEndpointInterceptor());\n//      interceptors.add(new SOAP11CustomEndpointInterceptorAdapter());\n//      interceptors.add(new SOAP12CustomEndpointInterceptorAdapter());\n    }    \n}\n\n\nand the DualProtocolSaajSoapMessageFactory will be like below , i have just copy paste the above\n\npackage com.hps.powercard;\nimport java.util.Map;\nimport java.util.StringTokenizer;\nimport java.util.Map.Entry;\nimport javax.xml.soap.*;\nimport org.apache.commons.logging.Log;\nimport org.apache.commons.logging.LogFactory;\n\nimport org.springframework.beans.factory.InitializingBean;\nimport org.springframework.http.HttpHeaders;\nimport org.springframework.util.CollectionUtils;\nimport org.springframework.util.MimeTypeUtils;\nimport org.springframework.util.ObjectUtils;\nimport org.springframework.util.StringUtils;\nimport org.springframework.ws.InvalidXmlException;\nimport org.springframework.ws.soap.SoapMessageCreationException;\nimport org.springframework.ws.soap.SoapMessageFactory;\nimport org.springframework.ws.soap.SoapVersion;\nimport org.springframework.ws.soap.saaj.SaajSoapMessage;\nimport org.springframework.ws.soap.saaj.support.SaajUtils;\nimport org.springframework.ws.transport.TransportInputStream;\nimport org.xml.sax.SAXParseException;\nimport java.io.BufferedInputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PushbackInputStream;\nimport java.util.Iterator;\npublic class DualProtocolSaajSoapMessageFactory implements SoapMessageFactory, InitializingBean {\n    private static final Log logger = LogFactory.getLog(DualProtocolSaajSoapMessageFactory.class);\n    private MessageFactory messageFactory;\n    private String messageFactoryProtocol;\n    private boolean langAttributeOnSoap11FaultString = true;\n    private Map&lt;String, ?&gt; messageProperties;\n    MessageFactory messageFactory11;\n    MessageFactory messageFactory12;\n    public DualProtocolSaajSoapMessageFactory() {\n        super();\n\n        try {\n            messageFactory11 = MessageFactory.newInstance(SOAPConstants.SOAP_1_1_PROTOCOL);\n            messageFactory12 = MessageFactory.newInstance(SOAPConstants.SOAP_1_2_PROTOCOL);\n        } catch (Exception ex) {\n            throw new SoapMessageCreationException(&quot;Could not create SAAJ MessageFactory: &quot; + ex.getMessage(), ex);\n        }\n    }\n\n    public DualProtocolSaajSoapMessageFactory(MessageFactory messageFactory) {\n        this.messageFactory = messageFactory;\n    }\n\n    public MessageFactory getMessageFactory() {\n        return this.messageFactory;\n    }\n\n    public void setMessageFactory(MessageFactory messageFactory) {\n        this.messageFactory = messageFactory;\n    }\n\n    public void setMessageProperties(Map&lt;String, ?&gt; messageProperties) {\n        this.messageProperties = messageProperties;\n    }\n\n    public void setLangAttributeOnSoap11FaultString(boolean langAttributeOnSoap11FaultString) {\n        this.langAttributeOnSoap11FaultString = langAttributeOnSoap11FaultString;\n    }\n\n    public void setSoapVersion(SoapVersion version) {\n        if (SaajUtils.getSaajVersion() &gt;= 2) {\n            if (SoapVersion.SOAP_11 == version) {\n                this.messageFactoryProtocol = &quot;SOAP 1.1 Protocol&quot;;\n            } else {\n                if (SoapVersion.SOAP_12 != version) {\n                    throw new IllegalArgumentException(&quot;Invalid version [&quot; + version + &quot;]. Expected the SOAP_11 or SOAP_12 constant&quot;);\n                }\n\n                this.messageFactoryProtocol = &quot;SOAP 1.2 Protocol&quot;;\n            }\n        } else if (SoapVersion.SOAP_11 != version) {\n            throw new IllegalArgumentException(&quot;SAAJ 1.1 and 1.2 only support SOAP 1.1&quot;);\n        }\n\n    }\n\n    public void afterPropertiesSet() {\n        logger.info(&quot;Calling afterPropertiesSet()&quot;);\n        if (this.messageFactory == null) {\n            try {\n                if (SaajUtils.getSaajVersion() &gt;= 2) {\n                    if (!StringUtils.hasLength(this.messageFactoryProtocol)) {\n                        this.messageFactoryProtocol = &quot;SOAP 1.1 Protocol&quot;;\n                    }\n\n                    if (logger.isInfoEnabled()) {\n                        logger.info(&quot;Creating SAAJ 1.3 MessageFactory with &quot; + this.messageFactoryProtocol);\n                    }\n\n                    this.messageFactory = MessageFactory.newInstance(this.messageFactoryProtocol);\n                } else if (SaajUtils.getSaajVersion() == 1) {\n                    logger.info(&quot;Creating SAAJ 1.2 MessageFactory&quot;);\n                    this.messageFactory = MessageFactory.newInstance();\n                } else {\n                    if (SaajUtils.getSaajVersion() != 0) {\n                        throw new IllegalStateException(&quot;SaajSoapMessageFactory requires SAAJ 1.1, which was not found on the classpath&quot;);\n                    }\n\n                    logger.info(&quot;Creating SAAJ 1.1 MessageFactory&quot;);\n                    this.messageFactory = MessageFactory.newInstance();\n                }\n            } catch (NoSuchMethodError var2) {\n                throw new SoapMessageCreationException(&quot;Could not create SAAJ MessageFactory. Is the version of the SAAJ specification interfaces [&quot; + SaajUtils.getSaajVersionString() + &quot;] the same as the version supported by the application server?&quot;, var2);\n            } catch (SOAPException var3) {\n                throw new SoapMessageCreationException(&quot;Could not create SAAJ MessageFactory: &quot; + var3.getMessage(), var3);\n            }\n        }\n\n        if (logger.isDebugEnabled()) {\n            logger.debug(&quot;Using MessageFactory class [&quot; + this.messageFactory.getClass().getName() + &quot;]&quot;);\n        }\n\n    }\n\n    public SaajSoapMessage createWebServiceMessage() {\n        logger.info(&quot;Calling createWebServiceMessage()&quot;);\n        try {\n            SOAPMessage saajMessage = this.messageFactory.createMessage();\n            this.postProcess(saajMessage);\n            return new SaajSoapMessage(saajMessage, this.langAttributeOnSoap11FaultString, this.messageFactory);\n        } catch (SOAPException var2) {\n            throw new SoapMessageCreationException(&quot;Could not create empty message: &quot; + var2.getMessage(), var2);\n        }\n    }\n    /*Override default property oenter code heref createWebServiceMessage*/\n    public SaajSoapMessage createWebServiceMessage(InputStream inputStream) throws IOException {\n        logger.info(&quot;Calling createWebServiceMessage(InputStream inputStream)&quot;);\n        MimeHeaders mimeHeaders = this.parseMimeHeaders(inputStream);\n        try {\n            inputStream = checkForUtf8ByteOrderMark(inputStream);\n            SOAPMessage saajMessage = null;\n            System.out.println(&quot;Obtained Content-Type is :&quot;+mimeHeaders.getHeader(HttpHeaders.CONTENT_TYPE)[0]);\n            if (mimeHeaders.getHeader(HttpHeaders.CONTENT_TYPE)[0].contains(MimeTypeUtils.TEXT_XML_VALUE)) {\n                logger.info(&quot;Obtained Protocol : SOAP 1.1 Protocol&quot;);\n                this.messageFactoryProtocol = &quot;SOAP 1.1 Protocol&quot;;\n                this.messageFactory = MessageFactory.newInstance(this.messageFactoryProtocol);\n                saajMessage = messageFactory11.createMessage(mimeHeaders, inputStream);\n            }\n            else if (mimeHeaders.getHeader(HttpHeaders.CONTENT_TYPE)[0].trim().toLowerCase().contains(MimeTypeUtils.TEXT_XML_VALUE)) {\n                logger.info(&quot;Obtained Protocol : SOAP 1.1 Protocol&quot;);\n                this.messageFactoryProtocol = &quot;SOAP 1.1 Protocol&quot;;\n                this.messageFactory = MessageFactory.newInstance(this.messageFactoryProtocol);\n                saajMessage = messageFactory11.createMessage(mimeHeaders, inputStream);\n            }            \n            else if (mimeHeaders.getHeader(HttpHeaders.CONTENT_TYPE)[0].trim().toLowerCase().contains(&quot;text/xml&quot;)) {\n                logger.info(&quot;Obtained Protocol : SOAP 1.1 Protocol&quot;);\n                this.messageFactoryProtocol = &quot;SOAP 1.1 Protocol&quot;;\n                this.messageFactory = MessageFactory.newInstance(this.messageFactoryProtocol);\n                saajMessage = messageFactory11.createMessage(mimeHeaders, inputStream);\n            }              \n            else {\n                logger.info(&quot;Obtained Protocol : SOAP 1.2 Protocol&quot;);\n                this.messageFactoryProtocol = &quot;SOAP 1.2 Protocol&quot;;\n                this.messageFactory = MessageFactory.newInstance(this.messageFactoryProtocol);\n                saajMessage = messageFactory12.createMessage(mimeHeaders, inputStream);  \n            }\n            saajMessage.getSOAPPart().getEnvelope();\n            this.postProcess(saajMessage);\n            return new SaajSoapMessage(saajMessage, this.langAttributeOnSoap11FaultString, this.messageFactory);\n        } catch (SOAPException var7) {\n            String contentType = StringUtils.arrayToCommaDelimitedString(mimeHeaders.getHeader(&quot;Content-Type&quot;));\n            if (contentType.contains(&quot;startinfo&quot;)) {\n                contentType = contentType.replace(&quot;startinfo&quot;, &quot;start-info&quot;);\n                mimeHeaders.setHeader(&quot;Content-Type&quot;, contentType);\n\n                try {\n                    SOAPMessage saajMessage = this.messageFactory.createMessage(mimeHeaders, inputStream);\n                    this.postProcess(saajMessage);\n                    return new SaajSoapMessage(saajMessage, this.langAttributeOnSoap11FaultString);\n                } catch (SOAPException var6) {\n                }\n            }\n\n            SAXParseException parseException = this.getSAXParseException(var7);\n            if (parseException != null) {\n                throw new InvalidXmlException(&quot;Could not parse XML&quot;, parseException);\n            } else {\n                throw new SoapMessageCreationException(&quot;Could not create message from InputStream: &quot; + var7.getMessage(), var7);\n            }\n        }\n    }\n\n    private SAXParseException getSAXParseException(Throwable ex) {\n        if (ex instanceof SAXParseException) {\n            return (SAXParseException)ex;\n        } else {\n            return ex.getCause() != null ? this.getSAXParseException(ex.getCause()) : null;\n        }\n    }\n\n    private MimeHeaders parseMimeHeaders(InputStream inputStream) throws IOException {\n        MimeHeaders mimeHeaders = new MimeHeaders();\n        if (inputStream instanceof TransportInputStream) {\n            TransportInputStream transportInputStream = (TransportInputStream)inputStream;\n            Iterator headerNames = transportInputStream.getHeaderNames();\n\n            while(headerNames.hasNext()) {\n                String headerName = (String)headerNames.next();\n                Iterator headerValues = transportInputStream.getHeaders(headerName);\n\n                while(headerValues.hasNext()) {\n                    String headerValue = (String)headerValues.next();\n                    StringTokenizer tokenizer = new StringTokenizer(headerValue, &quot;,&quot;);\n\n                    while(tokenizer.hasMoreTokens()) {\n                        mimeHeaders.addHeader(headerName, tokenizer.nextToken().trim());\n                    }\n                }\n            }\n        }\n\n        return mimeHeaders;\n    }\n\n    private InputStream checkForUtf8ByteOrderMark(InputStream inputStream) throws IOException {\n        PushbackInputStream pushbackInputStream = new PushbackInputStream(new BufferedInputStream(inputStream), 3);\n        byte[] bytes = new byte[3];\n\n        int bytesRead;\n        int n;\n        for(bytesRead = 0; bytesRead &lt; bytes.length; bytesRead += n) {\n            n = pushbackInputStream.read(bytes, bytesRead, bytes.length - bytesRead);\n            if (n &lt;= 0) {\n                break;\n            }\n        }\n\n        if (bytesRead &gt; 0 &amp;&amp; !this.isByteOrderMark(bytes)) {\n            pushbackInputStream.unread(bytes, 0, bytesRead);\n        }\n\n        return pushbackInputStream;\n    }\n\n    private boolean isByteOrderMark(byte[] bytes) {\n        return bytes.length == 3 &amp;&amp; bytes[0] == -17 &amp;&amp; bytes[1] == -69 &amp;&amp; bytes[2] == -65;\n    }\n\n    protected void postProcess(SOAPMessage soapMessage) throws SOAPException {\n//      try {\n//         soapMessage.writeTo(System.out);\n//      }catch(Exception ex) {}\n        if (!CollectionUtils.isEmpty(this.messageProperties)) {\n            Iterator var2 = this.messageProperties.entrySet().iterator();\n\n            while(var2.hasNext()) {\n                Entry&lt;String, ?&gt; entry = (Entry)var2.next();\n                soapMessage.setProperty((String)entry.getKey(), entry.getValue());\n            }\n        }\n\n        if (&quot;SOAP 1.1 Protocol&quot;.equals(this.messageFactoryProtocol)) {\n            MimeHeaders headers = soapMessage.getMimeHeaders();\n            if (ObjectUtils.isEmpty(headers.getHeader(&quot;SOAPAction&quot;))) {\n                headers.addHeader(&quot;SOAPAction&quot;, &quot;\\&quot;\\&quot;&quot;);\n            }\n        }\n\n    }\n\n    public String toString() {\n        StringBuilder builder = new StringBuilder(&quot;SaajSoapMessageFactory[&quot;);\n        builder.append(SaajUtils.getSaajVersionString());\n        if (SaajUtils.getSaajVersion() &gt;= 2) {\n            builder.append(',');\n            builder.append(this.messageFactoryProtocol);\n        }\n\n        builder.append(']');\n        return builder.toString();\n    }\n}\n\nAnd i have created a Request and Response Logger which will be like below\n\n    package com.hps.powercard;\nimport java.io.ByteArrayOutputStream;\n\nimport org.springframework.stereotype.Component;\nimport org.springframework.ws.context.MessageContext;\nimport org.springframework.ws.server.EndpointInterceptor;\nimport org.springframework.ws.soap.SoapMessage;\n\npublic class CustomEndpointInterceptor  implements EndpointInterceptor {\n    @Override\n    public boolean handleRequest(MessageContext messageContext, Object endpoint) throws Exception {\n        System.out.println(&quot;### SOAP REQUEST ###&quot;);\n        try {\n            ByteArrayOutputStream buffer = new ByteArrayOutputStream();\n            messageContext.getRequest().writeTo(buffer);\n            String payload = buffer.toString(java.nio.charset.StandardCharsets.UTF_8.name());\n            System.out.println(&quot;Request &quot;+payload);\n        } catch (Exception e) {\n           \n        }\n\n        return true;\n    }\n\n    @Override\n    public boolean handleResponse(MessageContext messageContext, Object endpoint) throws Exception {\n        System.out.println(&quot;### SOAP RESPONSE ###&quot;);\n        try {\n            ByteArrayOutputStream buffer = new ByteArrayOutputStream();\n            messageContext.getResponse().writeTo(buffer);\n            String payload = buffer.toString(java.nio.charset.StandardCharsets.UTF_8.name());\n            System.out.println(&quot;Response :&quot;+payload);\n        } catch (Exception e) {\n\n        }       \n        \n        return true;\n    }\n\n    @Override\n    public boolean handleFault(MessageContext messageContext, Object endpoint) throws Exception {\n        System.out.println(&quot;### SOAP FAULT ###&quot;);\n        try {\n            ByteArrayOutputStream buffer = new ByteArrayOutputStream();\n            messageContext.getResponse().writeTo(buffer);\n            String payload = buffer.toString(java.nio.charset.StandardCharsets.UTF_8.name());\n            System.out.println(&quot;SOAP FAULT &quot;+payload);\n        } catch (Exception e) {\n\n        }\n        return true;\n    }\n\n    @Override\n    public void afterCompletion(MessageContext messageContext, Object endpoint, Exception ex) throws Exception {\n    }\n}\n\n    \n</code></pre>\n"},{"tags":[],"owner":{"account_id":21374031,"reputation":21,"user_id":15741104,"display_name":"Vitaly Fomin"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1619111977,"creation_date":1619111977,"answer_id":67218010,"question_id":53567967,"body_markdown":"I use ThreadLocal for multi-threaded use\r\n\r\n    public class DualProtocolSaajSoapMessageFactory\r\n        implements SoapMessageFactory, InitializingBean {\r\n\r\n    ThreadLocal&lt;MessageFactory&gt; threadLocalValue = new ThreadLocal&lt;&gt;();\r\n\r\n    private String messageFactoryProtocol;\r\n    private boolean langAttributeOnSoap11FaultString = true;\r\n    private Map&lt;String, ?&gt; messageProperties;\r\n    MessageFactory messageFactory11;\r\n    MessageFactory messageFactory12;\r\n\r\n    public DualProtocolSaajSoapMessageFactory() {\r\n        super();\r\n\r\n        try {\r\n            messageFactory11 = MessageFactory.newInstance(SOAPConstants.SOAP_1_1_PROTOCOL);\r\n            messageFactory12 = MessageFactory.newInstance(SOAPConstants.SOAP_1_2_PROTOCOL);\r\n        } catch (Exception ex) {\r\n            throw new SoapMessageCreationException(&quot;Could not create SAAJ MessageFactory: &quot; + ex.getMessage(), ex);\r\n        }\r\n    }\r\n\r\n    public void setMessageProperties(Map&lt;String, ?&gt; messageProperties) {\r\n        this.messageProperties = messageProperties;\r\n    }\r\n\r\n    public void setLangAttributeOnSoap11FaultString(boolean langAttributeOnSoap11FaultString) {\r\n        this.langAttributeOnSoap11FaultString = langAttributeOnSoap11FaultString;\r\n    }\r\n\r\n    private MessageFactory getMessageFactoryThreadLocal() {\r\n        return threadLocalValue.get();\r\n    }\r\n\r\n    public void setSoapVersion(SoapVersion version) {\r\n        if (SaajUtils.getSaajVersion() &gt;= 2) {\r\n            if (SoapVersion.SOAP_11 == version) {\r\n                this.messageFactoryProtocol = &quot;SOAP 1.1 Protocol&quot;;\r\n            } else {\r\n                if (SoapVersion.SOAP_12 != version) {\r\n                    throw new IllegalArgumentException(&quot;Invalid version [&quot; + version + &quot;]. Expected the SOAP_11 or SOAP_12 constant&quot;);\r\n                }\r\n\r\n                this.messageFactoryProtocol = &quot;SOAP 1.2 Protocol&quot;;\r\n            }\r\n        } else if (SoapVersion.SOAP_11 != version) {\r\n            throw new IllegalArgumentException(&quot;SAAJ 1.1 and 1.2 only support SOAP 1.1&quot;);\r\n        }\r\n\r\n    }\r\n\r\n    public void afterPropertiesSet() {\r\n    }\r\n\r\n    public SaajSoapMessage createWebServiceMessage() {\r\n        try {\r\n            MessageFactory messageFactory = getMessageFactoryThreadLocal();\r\n            SOAPMessage saajMessage = messageFactory.createMessage();\r\n            this.postProcess(saajMessage);\r\n            return new SaajSoapMessage(saajMessage, this.langAttributeOnSoap11FaultString, messageFactory);\r\n        } catch (SOAPException var2) {\r\n            throw new SoapMessageCreationException(&quot;Could not create empty message: &quot; + var2.getMessage(), var2);\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public SaajSoapMessage createWebServiceMessage(InputStream inputStream) throws IOException {\r\n        MimeHeaders mimeHeaders = this.parseMimeHeaders(inputStream);\r\n        try {\r\n            inputStream = checkForUtf8ByteOrderMark(inputStream);\r\n            SOAPMessage saajMessage = null;\r\n            if (mimeHeaders.getHeader(HttpHeaders.CONTENT_TYPE)[0].contains(MimeTypeUtils.TEXT_XML_VALUE)) {\r\n                saajMessage = messageFactory11.createMessage(mimeHeaders, inputStream);\r\n                threadLocalValue.set(messageFactory11);\r\n            } else {\r\n                saajMessage = messageFactory12.createMessage(mimeHeaders, inputStream);\r\n                threadLocalValue.set(messageFactory12);\r\n            }\r\n\r\n            saajMessage.getSOAPPart().getEnvelope();\r\n            this.postProcess(saajMessage);\r\n            return new SaajSoapMessage(saajMessage, this.langAttributeOnSoap11FaultString, getMessageFactoryThreadLocal());\r\n        } catch (SOAPException var7) {\r\n            String contentType = StringUtils.arrayToCommaDelimitedString(mimeHeaders.getHeader(&quot;Content-Type&quot;));\r\n            if (contentType.contains(&quot;startinfo&quot;)) {\r\n                contentType = contentType.replace(&quot;startinfo&quot;, &quot;start-info&quot;);\r\n                mimeHeaders.setHeader(&quot;Content-Type&quot;, contentType);\r\n\r\n                try {\r\n                    SOAPMessage saajMessage = getMessageFactoryThreadLocal().createMessage(mimeHeaders, inputStream);\r\n                    this.postProcess(saajMessage);\r\n                    return new SaajSoapMessage(saajMessage, this.langAttributeOnSoap11FaultString);\r\n                } catch (SOAPException var6) {\r\n                }\r\n            }\r\n\r\n            SAXParseException parseException = this.getSAXParseException(var7);\r\n            if (parseException != null) {\r\n                throw new InvalidXmlException(&quot;Could not parse XML&quot;, parseException);\r\n            } else {\r\n                throw new SoapMessageCreationException(&quot;Could not create message from InputStream: &quot; + var7.getMessage(), var7);\r\n            }\r\n        }\r\n    }\r\n\r\n    private SAXParseException getSAXParseException(Throwable ex) {\r\n        if (ex instanceof SAXParseException) {\r\n            return (SAXParseException) ex;\r\n        } else {\r\n            return ex.getCause() != null ? this.getSAXParseException(ex.getCause()) : null;\r\n        }\r\n    }\r\n\r\n    private MimeHeaders parseMimeHeaders(InputStream inputStream) throws IOException {\r\n        MimeHeaders mimeHeaders = new MimeHeaders();\r\n        if (inputStream instanceof TransportInputStream) {\r\n            TransportInputStream transportInputStream = (TransportInputStream) inputStream;\r\n            Iterator headerNames = transportInputStream.getHeaderNames();\r\n\r\n            while (headerNames.hasNext()) {\r\n                String headerName = (String) headerNames.next();\r\n                Iterator headerValues = transportInputStream.getHeaders(headerName);\r\n\r\n                while (headerValues.hasNext()) {\r\n                    String headerValue = (String) headerValues.next();\r\n                    StringTokenizer tokenizer = new StringTokenizer(headerValue, &quot;,&quot;);\r\n\r\n                    while (tokenizer.hasMoreTokens()) {\r\n                        mimeHeaders.addHeader(headerName, tokenizer.nextToken().trim());\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return mimeHeaders;\r\n    }\r\n\r\n    private InputStream checkForUtf8ByteOrderMark(InputStream inputStream) throws IOException {\r\n        PushbackInputStream pushbackInputStream = new PushbackInputStream(new BufferedInputStream(inputStream), 3);\r\n        byte[] bytes = new byte[3];\r\n\r\n        int bytesRead;\r\n        int n;\r\n        for (bytesRead = 0; bytesRead &lt; bytes.length; bytesRead += n) {\r\n            n = pushbackInputStream.read(bytes, bytesRead, bytes.length - bytesRead);\r\n            if (n &lt;= 0) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (bytesRead &gt; 0 &amp;&amp; !this.isByteOrderMark(bytes)) {\r\n            pushbackInputStream.unread(bytes, 0, bytesRead);\r\n        }\r\n\r\n        return pushbackInputStream;\r\n    }\r\n\r\n    private boolean isByteOrderMark(byte[] bytes) {\r\n        return bytes.length == 3 &amp;&amp; bytes[0] == -17 &amp;&amp; bytes[1] == -69 &amp;&amp; bytes[2] == -65;\r\n    }\r\n\r\n    protected void postProcess(SOAPMessage soapMessage) throws SOAPException {\r\n        if (!CollectionUtils.isEmpty(this.messageProperties)) {\r\n            Iterator var2 = this.messageProperties.entrySet().iterator();\r\n\r\n            while (var2.hasNext()) {\r\n                Map.Entry&lt;String, ?&gt; entry = (Map.Entry) var2.next();\r\n                soapMessage.setProperty((String) entry.getKey(), entry.getValue());\r\n            }\r\n        }\r\n\r\n        if (&quot;SOAP 1.1 Protocol&quot;.equals(this.messageFactoryProtocol)) {\r\n            MimeHeaders headers = soapMessage.getMimeHeaders();\r\n            if (ObjectUtils.isEmpty(headers.getHeader(&quot;SOAPAction&quot;))) {\r\n                headers.addHeader(&quot;SOAPAction&quot;, &quot;\\&quot;\\&quot;&quot;);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    public String toString() {\r\n        StringBuilder builder = new StringBuilder(&quot;SaajSoapMessageFactory[&quot;);\r\n        builder.append(SaajUtils.getSaajVersionString());\r\n        if (SaajUtils.getSaajVersion() &gt;= 2) {\r\n            builder.append(&#39;,&#39;);\r\n            builder.append(this.messageFactoryProtocol);\r\n        }\r\n\r\n        builder.append(&#39;]&#39;);\r\n        return builder.toString();\r\n    }}","title":"Support both SOAP 1.1 and SOAP 1.2 messages in Spring-WS","body":"<p>I use ThreadLocal for multi-threaded use</p>\n<pre><code>public class DualProtocolSaajSoapMessageFactory\n    implements SoapMessageFactory, InitializingBean {\n\nThreadLocal&lt;MessageFactory&gt; threadLocalValue = new ThreadLocal&lt;&gt;();\n\nprivate String messageFactoryProtocol;\nprivate boolean langAttributeOnSoap11FaultString = true;\nprivate Map&lt;String, ?&gt; messageProperties;\nMessageFactory messageFactory11;\nMessageFactory messageFactory12;\n\npublic DualProtocolSaajSoapMessageFactory() {\n    super();\n\n    try {\n        messageFactory11 = MessageFactory.newInstance(SOAPConstants.SOAP_1_1_PROTOCOL);\n        messageFactory12 = MessageFactory.newInstance(SOAPConstants.SOAP_1_2_PROTOCOL);\n    } catch (Exception ex) {\n        throw new SoapMessageCreationException(&quot;Could not create SAAJ MessageFactory: &quot; + ex.getMessage(), ex);\n    }\n}\n\npublic void setMessageProperties(Map&lt;String, ?&gt; messageProperties) {\n    this.messageProperties = messageProperties;\n}\n\npublic void setLangAttributeOnSoap11FaultString(boolean langAttributeOnSoap11FaultString) {\n    this.langAttributeOnSoap11FaultString = langAttributeOnSoap11FaultString;\n}\n\nprivate MessageFactory getMessageFactoryThreadLocal() {\n    return threadLocalValue.get();\n}\n\npublic void setSoapVersion(SoapVersion version) {\n    if (SaajUtils.getSaajVersion() &gt;= 2) {\n        if (SoapVersion.SOAP_11 == version) {\n            this.messageFactoryProtocol = &quot;SOAP 1.1 Protocol&quot;;\n        } else {\n            if (SoapVersion.SOAP_12 != version) {\n                throw new IllegalArgumentException(&quot;Invalid version [&quot; + version + &quot;]. Expected the SOAP_11 or SOAP_12 constant&quot;);\n            }\n\n            this.messageFactoryProtocol = &quot;SOAP 1.2 Protocol&quot;;\n        }\n    } else if (SoapVersion.SOAP_11 != version) {\n        throw new IllegalArgumentException(&quot;SAAJ 1.1 and 1.2 only support SOAP 1.1&quot;);\n    }\n\n}\n\npublic void afterPropertiesSet() {\n}\n\npublic SaajSoapMessage createWebServiceMessage() {\n    try {\n        MessageFactory messageFactory = getMessageFactoryThreadLocal();\n        SOAPMessage saajMessage = messageFactory.createMessage();\n        this.postProcess(saajMessage);\n        return new SaajSoapMessage(saajMessage, this.langAttributeOnSoap11FaultString, messageFactory);\n    } catch (SOAPException var2) {\n        throw new SoapMessageCreationException(&quot;Could not create empty message: &quot; + var2.getMessage(), var2);\n    }\n}\n\n@Override\npublic SaajSoapMessage createWebServiceMessage(InputStream inputStream) throws IOException {\n    MimeHeaders mimeHeaders = this.parseMimeHeaders(inputStream);\n    try {\n        inputStream = checkForUtf8ByteOrderMark(inputStream);\n        SOAPMessage saajMessage = null;\n        if (mimeHeaders.getHeader(HttpHeaders.CONTENT_TYPE)[0].contains(MimeTypeUtils.TEXT_XML_VALUE)) {\n            saajMessage = messageFactory11.createMessage(mimeHeaders, inputStream);\n            threadLocalValue.set(messageFactory11);\n        } else {\n            saajMessage = messageFactory12.createMessage(mimeHeaders, inputStream);\n            threadLocalValue.set(messageFactory12);\n        }\n\n        saajMessage.getSOAPPart().getEnvelope();\n        this.postProcess(saajMessage);\n        return new SaajSoapMessage(saajMessage, this.langAttributeOnSoap11FaultString, getMessageFactoryThreadLocal());\n    } catch (SOAPException var7) {\n        String contentType = StringUtils.arrayToCommaDelimitedString(mimeHeaders.getHeader(&quot;Content-Type&quot;));\n        if (contentType.contains(&quot;startinfo&quot;)) {\n            contentType = contentType.replace(&quot;startinfo&quot;, &quot;start-info&quot;);\n            mimeHeaders.setHeader(&quot;Content-Type&quot;, contentType);\n\n            try {\n                SOAPMessage saajMessage = getMessageFactoryThreadLocal().createMessage(mimeHeaders, inputStream);\n                this.postProcess(saajMessage);\n                return new SaajSoapMessage(saajMessage, this.langAttributeOnSoap11FaultString);\n            } catch (SOAPException var6) {\n            }\n        }\n\n        SAXParseException parseException = this.getSAXParseException(var7);\n        if (parseException != null) {\n            throw new InvalidXmlException(&quot;Could not parse XML&quot;, parseException);\n        } else {\n            throw new SoapMessageCreationException(&quot;Could not create message from InputStream: &quot; + var7.getMessage(), var7);\n        }\n    }\n}\n\nprivate SAXParseException getSAXParseException(Throwable ex) {\n    if (ex instanceof SAXParseException) {\n        return (SAXParseException) ex;\n    } else {\n        return ex.getCause() != null ? this.getSAXParseException(ex.getCause()) : null;\n    }\n}\n\nprivate MimeHeaders parseMimeHeaders(InputStream inputStream) throws IOException {\n    MimeHeaders mimeHeaders = new MimeHeaders();\n    if (inputStream instanceof TransportInputStream) {\n        TransportInputStream transportInputStream = (TransportInputStream) inputStream;\n        Iterator headerNames = transportInputStream.getHeaderNames();\n\n        while (headerNames.hasNext()) {\n            String headerName = (String) headerNames.next();\n            Iterator headerValues = transportInputStream.getHeaders(headerName);\n\n            while (headerValues.hasNext()) {\n                String headerValue = (String) headerValues.next();\n                StringTokenizer tokenizer = new StringTokenizer(headerValue, &quot;,&quot;);\n\n                while (tokenizer.hasMoreTokens()) {\n                    mimeHeaders.addHeader(headerName, tokenizer.nextToken().trim());\n                }\n            }\n        }\n    }\n\n    return mimeHeaders;\n}\n\nprivate InputStream checkForUtf8ByteOrderMark(InputStream inputStream) throws IOException {\n    PushbackInputStream pushbackInputStream = new PushbackInputStream(new BufferedInputStream(inputStream), 3);\n    byte[] bytes = new byte[3];\n\n    int bytesRead;\n    int n;\n    for (bytesRead = 0; bytesRead &lt; bytes.length; bytesRead += n) {\n        n = pushbackInputStream.read(bytes, bytesRead, bytes.length - bytesRead);\n        if (n &lt;= 0) {\n            break;\n        }\n    }\n\n    if (bytesRead &gt; 0 &amp;&amp; !this.isByteOrderMark(bytes)) {\n        pushbackInputStream.unread(bytes, 0, bytesRead);\n    }\n\n    return pushbackInputStream;\n}\n\nprivate boolean isByteOrderMark(byte[] bytes) {\n    return bytes.length == 3 &amp;&amp; bytes[0] == -17 &amp;&amp; bytes[1] == -69 &amp;&amp; bytes[2] == -65;\n}\n\nprotected void postProcess(SOAPMessage soapMessage) throws SOAPException {\n    if (!CollectionUtils.isEmpty(this.messageProperties)) {\n        Iterator var2 = this.messageProperties.entrySet().iterator();\n\n        while (var2.hasNext()) {\n            Map.Entry&lt;String, ?&gt; entry = (Map.Entry) var2.next();\n            soapMessage.setProperty((String) entry.getKey(), entry.getValue());\n        }\n    }\n\n    if (&quot;SOAP 1.1 Protocol&quot;.equals(this.messageFactoryProtocol)) {\n        MimeHeaders headers = soapMessage.getMimeHeaders();\n        if (ObjectUtils.isEmpty(headers.getHeader(&quot;SOAPAction&quot;))) {\n            headers.addHeader(&quot;SOAPAction&quot;, &quot;\\&quot;\\&quot;&quot;);\n        }\n    }\n\n}\n\npublic String toString() {\n    StringBuilder builder = new StringBuilder(&quot;SaajSoapMessageFactory[&quot;);\n    builder.append(SaajUtils.getSaajVersionString());\n    if (SaajUtils.getSaajVersion() &gt;= 2) {\n        builder.append(',');\n        builder.append(this.messageFactoryProtocol);\n    }\n\n    builder.append(']');\n    return builder.toString();\n}}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":11275344,"reputation":1,"user_id":8269551,"display_name":"Anders Berglund Dacke"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656331683,"creation_date":1656331683,"answer_id":72771842,"question_id":53567967,"body_markdown":"I came up with this solution, which also works in my app for the SOAP reply:\r\n\r\n```\r\n  @Bean\r\n  public SaajSoapMessageFactory messageFactory() throws SOAPException {\r\n    MessageFactory messageFactorySoap11 =\r\n        MessageFactory.newInstance(SOAPConstants.SOAP_1_1_PROTOCOL);\r\n    MessageFactory messageFactorySoap12 =\r\n        MessageFactory.newInstance(SOAPConstants.SOAP_1_2_PROTOCOL);\r\n    ThreadLocal&lt;MessageFactory&gt; appropriateMessageFactory = new ThreadLocal&lt;&gt;();\r\n    MessageFactory messageFactoryWrapper =\r\n        new MessageFactory() {\r\n          @Override\r\n          public SOAPMessage createMessage() throws SOAPException {\r\n            return appropriateMessageFactory.get().createMessage();\r\n          }\r\n\r\n          @Override\r\n          public SOAPMessage createMessage(MimeHeaders headers, InputStream in)\r\n              throws IOException, SOAPException {\r\n            String[] header = headers.getHeader(HttpHeaders.CONTENT_TYPE);\r\n            boolean isSoap12 =\r\n                (header != null\r\n                    &amp;&amp; header[0] != null\r\n                    &amp;&amp; StringUtils.lowerCase(header[0]).startsWith(&quot;application/soap+xml&quot;));\r\n            appropriateMessageFactory.set(isSoap12 ? messageFactorySoap12 : messageFactorySoap11);\r\n            return appropriateMessageFactory.get().createMessage(headers, in);\r\n          }\r\n        };\r\n    return new SaajSoapMessageFactory(messageFactoryWrapper);\r\n  }\r\n``` ","title":"Support both SOAP 1.1 and SOAP 1.2 messages in Spring-WS","body":"<p>I came up with this solution, which also works in my app for the SOAP reply:</p>\n<pre><code>  @Bean\n  public SaajSoapMessageFactory messageFactory() throws SOAPException {\n    MessageFactory messageFactorySoap11 =\n        MessageFactory.newInstance(SOAPConstants.SOAP_1_1_PROTOCOL);\n    MessageFactory messageFactorySoap12 =\n        MessageFactory.newInstance(SOAPConstants.SOAP_1_2_PROTOCOL);\n    ThreadLocal&lt;MessageFactory&gt; appropriateMessageFactory = new ThreadLocal&lt;&gt;();\n    MessageFactory messageFactoryWrapper =\n        new MessageFactory() {\n          @Override\n          public SOAPMessage createMessage() throws SOAPException {\n            return appropriateMessageFactory.get().createMessage();\n          }\n\n          @Override\n          public SOAPMessage createMessage(MimeHeaders headers, InputStream in)\n              throws IOException, SOAPException {\n            String[] header = headers.getHeader(HttpHeaders.CONTENT_TYPE);\n            boolean isSoap12 =\n                (header != null\n                    &amp;&amp; header[0] != null\n                    &amp;&amp; StringUtils.lowerCase(header[0]).startsWith(&quot;application/soap+xml&quot;));\n            appropriateMessageFactory.set(isSoap12 ? messageFactorySoap12 : messageFactorySoap11);\n            return appropriateMessageFactory.get().createMessage(headers, in);\n          }\n        };\n    return new SaajSoapMessageFactory(messageFactoryWrapper);\n  }\n</code></pre>\n"}],"owner":{"account_id":201994,"reputation":5671,"user_id":448776,"accept_rate":75,"display_name":"SoManyGoblins"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":9570,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":53597635,"answer_count":5,"score":0,"last_activity_date":1656331683,"creation_date":1543641327,"question_id":53567967,"body_markdown":"Looked all over for a response to my problem with little success.\r\n\r\nI have a Spring boot app which needs to expose both `SOAP 1.1` and `SOAP 1.2` endpoints. I understand the SOAP version can be configured on the `WebServiceMessageFactory` bean (currently using SAAJ), but this sets a fixed SOAP version for all endpoints.\r\n\r\nIs there a way to achieve this?\r\n\r\nThank you","title":"Support both SOAP 1.1 and SOAP 1.2 messages in Spring-WS","body":"<p>Looked all over for a response to my problem with little success.</p>\n\n<p>I have a Spring boot app which needs to expose both <code>SOAP 1.1</code> and <code>SOAP 1.2</code> endpoints. I understand the SOAP version can be configured on the <code>WebServiceMessageFactory</code> bean (currently using SAAJ), but this sets a fixed SOAP version for all endpoints.</p>\n\n<p>Is there a way to achieve this?</p>\n\n<p>Thank you</p>\n"},{"tags":["java","visual-studio-code","vscode-debugger"],"comments":[{"owner":{"account_id":13770793,"reputation":25892,"user_id":9938317,"display_name":"rioV8"},"score":0,"creation_date":1655888939,"post_id":72712600,"comment_id":128436495,"body_markdown":"some debuggers support [data-breakpoints](https://code.visualstudio.com/docs/editor/debugging#_data-breakpoints)","body":"some debuggers support <a href=\"https://code.visualstudio.com/docs/editor/debugging#_data-breakpoints\" rel=\"nofollow noreferrer\">data-breakpoints</a>"},{"owner":{"account_id":25311208,"reputation":7305,"user_id":19133920,"display_name":"JialeDu"},"score":0,"creation_date":1655965084,"post_id":72712600,"comment_id":128457606,"body_markdown":"Please add the details of the problem so that we can better help you solve the problem. Such as [the smallest reproducible case](https://stackoverflow.com/help/minimal-reproducible-example), the desired effect you want, etc.","body":"Please add the details of the problem so that we can better help you solve the problem. Such as <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">the smallest reproducible case</a>, the desired effect you want, etc."}],"answers":[{"tags":[],"owner":{"account_id":1557687,"reputation":1891,"user_id":1448282,"accept_rate":80,"display_name":"Nigel Thomas"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656331147,"creation_date":1656331147,"answer_id":72771713,"question_id":72712600,"body_markdown":"Field level breakpoints cannot be set for Java classes in Visual Studio code as of today. ","title":"Set a Breakpoint on a field in a Java class while debugging in VS Code","body":"<p>Field level breakpoints cannot be set for Java classes in Visual Studio code as of today.</p>\n"}],"owner":{"account_id":1557687,"reputation":1891,"user_id":1448282,"accept_rate":80,"display_name":"Nigel Thomas"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":144,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1656331147,"creation_date":1655888662,"question_id":72712600,"body_markdown":"I want to set a break point on a field in a Java class while debugging using VS Code.\r\n\r\nEither when the value of that field changes or when the field is accessed, I need the break point to be hit.","title":"Set a Breakpoint on a field in a Java class while debugging in VS Code","body":"<p>I want to set a break point on a field in a Java class while debugging using VS Code.</p>\n<p>Either when the value of that field changes or when the field is accessed, I need the break point to be hit.</p>\n"},{"tags":["java","sql","jdbc"],"comments":[{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":2,"creation_date":1656330148,"post_id":72771493,"comment_id":128537376,"body_markdown":"are you sure you have a table called `Quantity` inside a schema called `ItemTable`? Are you sure it&#39;s not the table that&#39;s called `ItemTable`?","body":"are you sure you have a table called <code>Quantity</code> inside a schema called <code>ItemTable</code>? Are you sure it&#39;s not the table that&#39;s called <code>ItemTable</code>?"},{"owner":{"account_id":22124137,"reputation":3297,"user_id":16376827,"display_name":"g00se"},"score":0,"creation_date":1656330161,"post_id":72771493,"comment_id":128537380,"body_markdown":"Did you *create* that schema?","body":"Did you <i>create</i> that schema?"}],"answers":[{"tags":[],"owner":{"account_id":10185301,"reputation":899,"user_id":7520496,"accept_rate":60,"display_name":"AliAzra"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656330203,"creation_date":1656330203,"answer_id":72771519,"question_id":72771493,"body_markdown":"It seems &quot;FROM ItemTable.Quantity&quot; is wrong. just change it to &quot;FROM ItemTable&quot;\r\n","title":"How do I fix this problem - DERBY SQL Error: SCHEMA DOES NOT EXIST","body":"<p>It seems &quot;FROM ItemTable.Quantity&quot; is wrong. just change it to &quot;FROM ItemTable&quot;</p>\n"},{"tags":[],"owner":{"account_id":14229398,"reputation":590,"user_id":10279066,"display_name":"Upender Reddy"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656330621,"creation_date":1656330621,"answer_id":72771614,"question_id":72771493,"body_markdown":"without using schema\r\n\r\n    query = &quot;SELECT Count(Quantity) as itemQuantity FROM ItemTable WHERE BarCode = cast(&quot;+itemCode+&quot; AS INTEGER)&quot;;\r\n\r\nwith schema\r\n\r\n    query = &quot;SELECT Count(Quantity) as itemQuantity FROM dbo.ItemTable WHERE BarCode = cast(&quot;+itemCode+&quot; AS INTEGER)&quot;;\r\n\r\nin above dbo is database schema you can define your own if you like so","title":"How do I fix this problem - DERBY SQL Error: SCHEMA DOES NOT EXIST","body":"<p>without using schema</p>\n<pre><code>query = &quot;SELECT Count(Quantity) as itemQuantity FROM ItemTable WHERE BarCode = cast(&quot;+itemCode+&quot; AS INTEGER)&quot;;\n</code></pre>\n<p>with schema</p>\n<pre><code>query = &quot;SELECT Count(Quantity) as itemQuantity FROM dbo.ItemTable WHERE BarCode = cast(&quot;+itemCode+&quot; AS INTEGER)&quot;;\n</code></pre>\n<p>in above dbo is database schema you can define your own if you like so</p>\n"}],"owner":{"account_id":24362880,"reputation":11,"user_id":18296995,"display_name":"eminem"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":209,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1656330621,"creation_date":1656330043,"question_id":72771493,"body_markdown":"I am trying to run this query, but I get the above SQL error.\r\n\r\n    query = &quot;SELECT Count(*) as itemQuantity FROM ItemTable.Quantity WHERE ItemTable.BarCode = cast(&quot;+itemCode+&quot; AS INTEGER)&quot;;\r\n\r\nSQL Error java.sql.SQLSyntaxErrorException: Schema &#39;ITEMTABLE&#39; does not exist\r\n\r\n","title":"How do I fix this problem - DERBY SQL Error: SCHEMA DOES NOT EXIST","body":"<p>I am trying to run this query, but I get the above SQL error.</p>\n<pre><code>query = &quot;SELECT Count(*) as itemQuantity FROM ItemTable.Quantity WHERE ItemTable.BarCode = cast(&quot;+itemCode+&quot; AS INTEGER)&quot;;\n</code></pre>\n<p>SQL Error java.sql.SQLSyntaxErrorException: Schema 'ITEMTABLE' does not exist</p>\n"},{"tags":["java","jackson","log4j2"],"answers":[{"tags":[],"owner":{"account_id":6718742,"reputation":321,"user_id":5179636,"display_name":"colouredmirrorball"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1656330591,"creation_date":1656330591,"answer_id":72771606,"question_id":72714218,"body_markdown":"The problem was me not reading the documentation thoroughly. \r\n\r\nIt works by using a custom JsonLayout and setting the &quot;properties&quot; value to true:\r\n\r\n\r\n    public static JsonLayout getJsonLayout() {\r\n        return JsonLayout.newBuilder()\r\n            .setConfiguration(new DefaultConfiguration())\r\n            .setProperties(true)\r\n            .build();\r\n    }","title":"Log4j 2: JacksonLayout does not include contextData","body":"<p>The problem was me not reading the documentation thoroughly.</p>\n<p>It works by using a custom JsonLayout and setting the &quot;properties&quot; value to true:</p>\n<pre><code>public static JsonLayout getJsonLayout() {\n    return JsonLayout.newBuilder()\n        .setConfiguration(new DefaultConfiguration())\n        .setProperties(true)\n        .build();\n}\n</code></pre>\n"}],"owner":{"account_id":6718742,"reputation":321,"user_id":5179636,"display_name":"colouredmirrorball"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":238,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":72771606,"answer_count":1,"score":0,"last_activity_date":1656330591,"creation_date":1655895207,"question_id":72714218,"body_markdown":"We have an application with a built in log viewer. Logging events are serialised as json and then sent to a socket, where it gets deserialised and displayed on screen.\r\n\r\nFor this we use a Log4j 2 SocketAppender with a JacksonLayout like this:\r\n\r\n            SocketAppender appender = SocketAppender.newBuilder()\r\n                .setName(appenderName)\r\n                .setHost(inetAddress.getHostName())\r\n                .setPort(port)\r\n                .setProtocol(Protocol.TCP)\r\n                .setLayout(JsonLayout.createDefaultLayout())\r\n                .build();\r\n            appender.start();\r\n            logger.addAppender(appender);\r\n\r\nThen in the log viewer code we have:\r\n\r\n                try (Socket socket = serverSocket.accept()) {\r\n                    InputStream inputStream = socket.getInputStream();\r\n                    MutableLogEvent event =\r\n                            objectMapper.readerFor(MutableLogEvent.class).readValue(inputStream);\r\n                    processLogEvent(event);\r\n                }\r\n\r\nThe logging itself works, but there is an issue with the contextData. In the application, the username of the logged in user is stored in the ThreadContext and should be logged when an event happens. The pattern for the viewer looks like this: `&quot;%d{ISO8601} %p (%X{user}) - %m%n&quot;`, but the value for `%X{user}` is always empty. This value should come from the thread context, which is set like this:\r\n\r\n    ThreadContext.put(&quot;user&quot;, user.getLoginName());\r\n\r\nWith a debugger, I found that the user is correctly created in the contextData field of the LogEvent, but it disappears after serialising to Json.\r\n\r\nCreated LogEvent, before serialising to Json and sending it to the log viewer:\r\n\r\n[![Screenshot of debugger showing the contextData in the created MutableLogEvent][1]][1]\r\n\r\nAfter serialising:\r\n\r\n\r\n    {\r\n      &quot;instant&quot; : {\r\n        &quot;epochSecond&quot; : 1655893941,\r\n        &quot;nanoOfSecond&quot; : 869382600\r\n      },\r\n      &quot;thread&quot; : &quot;AWT-EventQueue-0&quot;,\r\n      &quot;level&quot; : &quot;INFO&quot;,\r\n      &quot;loggerName&quot; : &quot;(sensitive)&quot;,\r\n      &quot;message&quot; : &quot;(sensitive)&quot;,\r\n      &quot;endOfBatch&quot; : false,\r\n      &quot;loggerFqcn&quot; : &quot;org.apache.log4j.Category&quot;,\r\n      &quot;threadId&quot; : 25,\r\n      &quot;threadPriority&quot; : 6\r\n    }\r\n\r\nNote the field contextData is missing here.\r\n\r\nThe serialisation happens in the class org.apache.logging.log4j.core.layout.AbstractJacksonLayout.\r\n\r\nIs there a way to include the contents of the contextMap in the Json?\r\n\r\n  [1]: https://i.stack.imgur.com/eGnSU.png\r\n\r\n\r\n","title":"Log4j 2: JacksonLayout does not include contextData","body":"<p>We have an application with a built in log viewer. Logging events are serialised as json and then sent to a socket, where it gets deserialised and displayed on screen.</p>\n<p>For this we use a Log4j 2 SocketAppender with a JacksonLayout like this:</p>\n<pre><code>        SocketAppender appender = SocketAppender.newBuilder()\n            .setName(appenderName)\n            .setHost(inetAddress.getHostName())\n            .setPort(port)\n            .setProtocol(Protocol.TCP)\n            .setLayout(JsonLayout.createDefaultLayout())\n            .build();\n        appender.start();\n        logger.addAppender(appender);\n</code></pre>\n<p>Then in the log viewer code we have:</p>\n<pre><code>            try (Socket socket = serverSocket.accept()) {\n                InputStream inputStream = socket.getInputStream();\n                MutableLogEvent event =\n                        objectMapper.readerFor(MutableLogEvent.class).readValue(inputStream);\n                processLogEvent(event);\n            }\n</code></pre>\n<p>The logging itself works, but there is an issue with the contextData. In the application, the username of the logged in user is stored in the ThreadContext and should be logged when an event happens. The pattern for the viewer looks like this: <code>&quot;%d{ISO8601} %p (%X{user}) - %m%n&quot;</code>, but the value for <code>%X{user}</code> is always empty. This value should come from the thread context, which is set like this:</p>\n<pre><code>ThreadContext.put(&quot;user&quot;, user.getLoginName());\n</code></pre>\n<p>With a debugger, I found that the user is correctly created in the contextData field of the LogEvent, but it disappears after serialising to Json.</p>\n<p>Created LogEvent, before serialising to Json and sending it to the log viewer:</p>\n<p><a href=\"https://i.stack.imgur.com/eGnSU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eGnSU.png\" alt=\"Screenshot of debugger showing the contextData in the created MutableLogEvent\" /></a></p>\n<p>After serialising:</p>\n<pre><code>{\n  &quot;instant&quot; : {\n    &quot;epochSecond&quot; : 1655893941,\n    &quot;nanoOfSecond&quot; : 869382600\n  },\n  &quot;thread&quot; : &quot;AWT-EventQueue-0&quot;,\n  &quot;level&quot; : &quot;INFO&quot;,\n  &quot;loggerName&quot; : &quot;(sensitive)&quot;,\n  &quot;message&quot; : &quot;(sensitive)&quot;,\n  &quot;endOfBatch&quot; : false,\n  &quot;loggerFqcn&quot; : &quot;org.apache.log4j.Category&quot;,\n  &quot;threadId&quot; : 25,\n  &quot;threadPriority&quot; : 6\n}\n</code></pre>\n<p>Note the field contextData is missing here.</p>\n<p>The serialisation happens in the class org.apache.logging.log4j.core.layout.AbstractJacksonLayout.</p>\n<p>Is there a way to include the contents of the contextMap in the Json?</p>\n"},{"tags":["java","freemarker"],"comments":[{"owner":{"account_id":74704,"reputation":11534,"user_id":214525,"accept_rate":100,"display_name":"f1sh"},"score":0,"creation_date":1656323347,"post_id":72770050,"comment_id":128535003,"body_markdown":"Does this answer your question? [Freemarker and hashmap. How do I get key-value](https://stackoverflow.com/questions/14821329/freemarker-and-hashmap-how-do-i-get-key-value)","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/14821329/freemarker-and-hashmap-how-do-i-get-key-value\">Freemarker and hashmap. How do I get key-value</a>"},{"owner":{"account_id":299854,"reputation":29886,"user_id":606679,"accept_rate":25,"display_name":"ddekany"},"score":0,"creation_date":1656330670,"post_id":72770050,"comment_id":128537586,"body_markdown":"Note that if `property.name` is a string that&#39;s either `&quot;true&quot;`, or `&quot;false&quot;`, then `&lt;#if property.name?boolean&gt;` is nicer.","body":"Note that if <code>property.name</code> is a string that&#39;s either <code>&quot;true&quot;</code>, or <code>&quot;false&quot;</code>, then <code>&lt;#if property.name?boolean&gt;</code> is nicer."}],"answers":[{"tags":[],"owner":{"account_id":299854,"reputation":29886,"user_id":606679,"accept_rate":25,"display_name":"ddekany"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656330481,"creation_date":1656330481,"answer_id":72771579,"question_id":72770050,"body_markdown":"It should just work the same with `java.util.Properties`, because that implements `java.util.Map`.","title":"Freemarker: Model based on properties","body":"<p>It should just work the same with <code>java.util.Properties</code>, because that implements <code>java.util.Map</code>.</p>\n"}],"owner":{"account_id":1976336,"reputation":883,"user_id":1774051,"accept_rate":40,"display_name":"user1774051"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":61,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1656330481,"creation_date":1656323224,"question_id":72770050,"body_markdown":"If I understand Freemarker&#39;s MapModel correctly, then an expression like\r\n\r\n```\r\n&lt;#if property.name == &quot;true&quot;&gt;\r\n```\r\n\r\nwould look into the map, finds an object &quot;property&quot;. And, if that&#39;s a map, looks up the value &quot;name&quot; in the inner map.\r\n\r\nNow, assume, that my Map is a Properties object, and I would want &quot;property.name to be evaluated a s the value of property &quot;property.name&quot;? Is that possibly? How?","title":"Freemarker: Model based on properties","body":"<p>If I understand Freemarker's MapModel correctly, then an expression like</p>\n<pre><code>&lt;#if property.name == &quot;true&quot;&gt;\n</code></pre>\n<p>would look into the map, finds an object &quot;property&quot;. And, if that's a map, looks up the value &quot;name&quot; in the inner map.</p>\n<p>Now, assume, that my Map is a Properties object, and I would want &quot;property.name to be evaluated a s the value of property &quot;property.name&quot;? Is that possibly? How?</p>\n"},{"tags":["java","spring-boot","cassandra","datastax-astra"],"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1656246314,"post_id":72759503,"comment_id":128520006,"body_markdown":"Please provide enough code so others can better understand or reproduce the problem.","body":"Please provide enough code so others can better understand or reproduce the problem."},{"owner":{"account_id":60456,"reputation":55961,"user_id":1054558,"accept_rate":100,"display_name":"Aaron"},"score":0,"creation_date":1656356142,"post_id":72759503,"comment_id":128547406,"body_markdown":"Here are some instructions on how to connect to Astra DB from cqlsh.  Try it with your secure bundle.  I&#39;m curious to see if you get the same message: https://awesome-astra.github.io/docs/pages/data/explore/cqlsh/#c-installation","body":"Here are some instructions on how to connect to Astra DB from cqlsh.  Try it with your secure bundle.  I&#39;m curious to see if you get the same message: <a href=\"https://awesome-astra.github.io/docs/pages/data/explore/cqlsh/#c-installation\" rel=\"nofollow noreferrer\">awesome-astra.github.io/docs/pages/data/explore/cqlsh/&hellip;</a>"}],"answers":[{"tags":[],"owner":{"account_id":5357170,"reputation":14233,"user_id":4269535,"display_name":"Erick Ramirez"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656314275,"creation_date":1656253064,"answer_id":72762370,"question_id":72759503,"body_markdown":"You haven&#39;t provided enough information for us to be able to assist you properly but the most common causes of the problem you&#39;re facing are:\r\n\r\n - app is not able to access the secure bundle\r\n - invalid credentials supplied, i.e. client ID + secret, or token\r\n\r\n**[UPDATE]** After reviewing your updated question, the issue isn&#39;t to do with the secure bundle as you original stated. The issue is that it appears your database is unreachable and the driver can&#39;t connect to it:\r\n\r\n```\r\n    ...\r\nCaused by: java.lang.IllegalStateException: Unable to connect to cloud metadata service. Please make sure your cluster is not parked or terminated\r\n    at com.datastax.oss.driver.internal.core.config.cloud.CloudConfigFactory.fetchProxyMetadata(CloudConfigFactory.java:234) ~[java-driver-core-4.14.1.jar:na]\r\n    at com.datastax.oss.driver.internal.core.config.cloud.CloudConfigFactory.createCloudConfig(CloudConfigFactory.java:133) ~[java-driver-core-4.14.1.jar:na]\r\n    at com.datastax.oss.driver.api.core.session.SessionBuilder.buildDefaultSessionAsync(SessionBuilder.java:876) ~[java-driver-core-4.14.1.jar:na]\r\n    at com.datastax.oss.driver.api.core.session.SessionBuilder.buildAsync(SessionBuilder.java:817) ~[java-driver-core-4.14.1.jar:na]\r\n    at com.datastax.oss.driver.api.core.session.SessionBuilder.build(SessionBuilder.java:835) ~[java-driver-core-4.14.1.jar:na]\r\n    ...\r\nCaused by: java.net.ConnectException: Connection timed out: connect\r\n    ...\r\n```\r\n\r\nIf you are running the app from a local machine such as a personal laptop, there&#39;s a good chance that your internet is slow and there&#39;s too much latency between your laptop and your Astra DB on the cloud.\r\n\r\nYou will need to do two things:\r\n\r\n  1. Verify that your database is active (not hibernating) by connecting to it from the Astra UI [CQL console][1]. If your DB is hibernating, click on the **Resume Database** button to activate your DB.\r\n  2. Increase the driver timeouts in your app with:\r\n\r\n```\r\nspring:\r\n  data:\r\n    cassandra:\r\n      request:\r\n        timeout: 30s\r\n        connection:\r\n          connect-timeout: 30s\r\n          init-query-timeout: 30s\r\n```\r\n\r\nDepending on how slow your internet connection is, you might need to bump up the timeout further to 60 seconds. Cheers!\r\n\r\n  [1]: https://docs.datastax.com/en/astra/docs/connect/cql/connect-cqlsh.html","title":"Not able to connect to Astra DB using Secure Connect Bundle","body":"<p>You haven't provided enough information for us to be able to assist you properly but the most common causes of the problem you're facing are:</p>\n<ul>\n<li>app is not able to access the secure bundle</li>\n<li>invalid credentials supplied, i.e. client ID + secret, or token</li>\n</ul>\n<p><strong>[UPDATE]</strong> After reviewing your updated question, the issue isn't to do with the secure bundle as you original stated. The issue is that it appears your database is unreachable and the driver can't connect to it:</p>\n<pre><code>    ...\nCaused by: java.lang.IllegalStateException: Unable to connect to cloud metadata service. Please make sure your cluster is not parked or terminated\n    at com.datastax.oss.driver.internal.core.config.cloud.CloudConfigFactory.fetchProxyMetadata(CloudConfigFactory.java:234) ~[java-driver-core-4.14.1.jar:na]\n    at com.datastax.oss.driver.internal.core.config.cloud.CloudConfigFactory.createCloudConfig(CloudConfigFactory.java:133) ~[java-driver-core-4.14.1.jar:na]\n    at com.datastax.oss.driver.api.core.session.SessionBuilder.buildDefaultSessionAsync(SessionBuilder.java:876) ~[java-driver-core-4.14.1.jar:na]\n    at com.datastax.oss.driver.api.core.session.SessionBuilder.buildAsync(SessionBuilder.java:817) ~[java-driver-core-4.14.1.jar:na]\n    at com.datastax.oss.driver.api.core.session.SessionBuilder.build(SessionBuilder.java:835) ~[java-driver-core-4.14.1.jar:na]\n    ...\nCaused by: java.net.ConnectException: Connection timed out: connect\n    ...\n</code></pre>\n<p>If you are running the app from a local machine such as a personal laptop, there's a good chance that your internet is slow and there's too much latency between your laptop and your Astra DB on the cloud.</p>\n<p>You will need to do two things:</p>\n<ol>\n<li>Verify that your database is active (not hibernating) by connecting to it from the Astra UI <a href=\"https://docs.datastax.com/en/astra/docs/connect/cql/connect-cqlsh.html\" rel=\"nofollow noreferrer\">CQL console</a>. If your DB is hibernating, click on the <strong>Resume Database</strong> button to activate your DB.</li>\n<li>Increase the driver timeouts in your app with:</li>\n</ol>\n<pre><code>spring:\n  data:\n    cassandra:\n      request:\n        timeout: 30s\n        connection:\n          connect-timeout: 30s\n          init-query-timeout: 30s\n</code></pre>\n<p>Depending on how slow your internet connection is, you might need to bump up the timeout further to 60 seconds. Cheers!</p>\n"}],"owner":{"account_id":24074541,"reputation":43,"user_id":18050062,"display_name":"Pragati Agarwal"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":807,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":1,"score":2,"last_activity_date":1656330354,"creation_date":1656226519,"question_id":72759503,"body_markdown":"Configuration of Secure bundle is as follow.\r\n```\r\n\r\n@ConfigurationProperties(prefix = &quot;datastax.astra&quot;)   \r\npublic class DataStaxAstraProperties {\r\n\r\n    private File secureConnectBundle;\r\n\r\n    public File getSecureConnectBundle() {\r\n        return secureConnectBundle;\r\n    }\r\n\r\n    public void setSecureConnectBundle(File secureConnectBundle) {\r\n        this.secureConnectBundle = secureConnectBundle;\r\n    } }\r\n\r\n```\r\nThe path to secure bundle is configured in application.yaml file as follow : \r\n\r\n    datastax.astra:\r\n        secure-connect-bundle: secure-connect-1.zip\r\n\r\nSecure bundle zip is present is application classpath and resides in resource folder\r\n\r\nAlso client id, secret and token are correct.\r\n\r\nWhen trying to connect to Datastax Astra DB facing the following error: \r\nThe main error is: \r\n&gt; Failed to instantiate [com.datastax.oss.driver.api.core.CqlSession]: Factory method &#39;cassandraSession&#39; threw exception; nested exception is java.lang.IllegalStateException: Unable to connect to cloud metadata service. Please make sure your cluster is not parked or terminated\r\n\r\nError Stack is as follow : \r\n```\r\nError starting ApplicationContext. To display the conditions report re-run your application with &#39;debug&#39; enabled.\r\n2022-06-26 12:04:31.348 ERROR 9564 — [  restartedMain] o.s.boot.SpringApplication               : Application run failed\r\n\r\norg.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;org.springframework.boot.autoconfigure.data.cassandra.CassandraDataAutoConfiguration&#39;: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;cassandraSession&#39; defined in class path resource [org/springframework/boot/autoconfigure/cassandra/CassandraAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.datastax.oss.driver.api.core.CqlSession]: Factory method &#39;cassandraSession&#39; threw exception; nested exception is java.lang.IllegalStateException: Unable to connect to cloud metadata service. Please make sure your cluster is not parked or terminated\r\nat org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:800) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:229) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1372) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1222) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:953) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918) ~[spring-context-5.3.20.jar:5.3.20]\r\nat org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:583) ~[spring-context-5.3.20.jar:5.3.20]\r\nat org.springframework.boot.SpringApplication.refresh(SpringApplication.java:734) [spring-boot-2.7.0.jar:2.7.0]\r\nat org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) [spring-boot-2.7.0.jar:2.7.0]\r\nat org.springframework.boot.SpringApplication.run(SpringApplication.java:308) [spring-boot-2.7.0.jar:2.7.0]\r\nat org.springframework.boot.SpringApplication.run(SpringApplication.java:1306) [spring-boot-2.7.0.jar:2.7.0]\r\nat org.springframework.boot.SpringApplication.run(SpringApplication.java:1295) [spring-boot-2.7.0.jar:2.7.0]\r\nat course.prags.betterreadsdataloader.BetterreadsApplication.main(BetterreadsApplication.java:44) [classes/:na]\r\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_331]\r\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_331]\r\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_331]\r\nat java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_331]\r\nat org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49) [spring-boot-devtools-2.7.0.jar:2.7.0]\r\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;cassandraSession&#39; defined in class path resource [org/springframework/boot/autoconfigure/cassandra/CassandraAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.datastax.oss.driver.api.core.CqlSession]: Factory method &#39;cassandraSession&#39; threw exception; nested exception is java.lang.IllegalStateException: Unable to connect to cloud metadata service. Please make sure your cluster is not parked or terminated\r\nat org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:658) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:638) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1352) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1195) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1389) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1309) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:887) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791) ~[spring-beans-5.3.20.jar:5.3.20]\r\n... 23 common frames omitted\r\nCaused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.datastax.oss.driver.api.core.CqlSession]: Factory method &#39;cassandraSession&#39; threw exception; nested exception is java.lang.IllegalStateException: Unable to connect to cloud metadata service. Please make sure your cluster is not parked or terminated\r\nat org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:185) ~[spring-beans-5.3.20.jar:5.3.20]\r\nat org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:653) ~[spring-beans-5.3.20.jar:5.3.20]\r\n... 37 common frames omitted\r\nCaused by: java.lang.IllegalStateException: Unable to connect to cloud metadata service. Please make sure your cluster is not parked or terminated\r\nat com.datastax.oss.driver.internal.core.config.cloud.CloudConfigFactory.fetchProxyMetadata(CloudConfigFactory.java:234) ~[java-driver-core-4.14.1.jar:na]\r\nat com.datastax.oss.driver.internal.core.config.cloud.CloudConfigFactory.createCloudConfig(CloudConfigFactory.java:133) ~[java-driver-core-4.14.1.jar:na]\r\nat com.datastax.oss.driver.api.core.session.SessionBuilder.buildDefaultSessionAsync(SessionBuilder.java:876) ~[java-driver-core-4.14.1.jar:na]\r\nat com.datastax.oss.driver.api.core.session.SessionBuilder.buildAsync(SessionBuilder.java:817) ~[java-driver-core-4.14.1.jar:na]\r\nat com.datastax.oss.driver.api.core.session.SessionBuilder.build(SessionBuilder.java:835) ~[java-driver-core-4.14.1.jar:na]\r\nat org.springframework.boot.autoconfigure.cassandra.CassandraAutoConfiguration.cassandraSession(CassandraAutoConfiguration.java:77) ~[spring-boot-autoconfigure-2.7.0.jar:2.7.0]\r\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_331]\r\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_331]\r\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_331]\r\nat java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_331]\r\nat org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:154) ~[spring-beans-5.3.20.jar:5.3.20]\r\n... 38 common frames omitted\r\nCaused by: java.net.ConnectException: Connection timed out: connect\r\nat java.net.DualStackPlainSocketImpl.connect0(Native Method) ~[na:1.8.0_331]\r\nat java.net.DualStackPlainSocketImpl.socketConnect(DualStackPlainSocketImpl.java:75) ~[na:1.8.0_331]\r\nat java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:476) ~[na:1.8.0_331]\r\nat java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:218) ~[na:1.8.0_331]\r\nat java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:200) ~[na:1.8.0_331]\r\nat java.net.PlainSocketImpl.connect(PlainSocketImpl.java:162) ~[na:1.8.0_331]\r\nat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:394) ~[na:1.8.0_331]\r\nat java.net.Socket.connect(Socket.java:606) ~[na:1.8.0_331]\r\nat sun.security.ssl.SSLSocketImpl.connect(SSLSocketImpl.java:298) ~[na:1.8.0_331]\r\nat sun.security.ssl.BaseSSLSocketImpl.connect(BaseSSLSocketImpl.java:173) ~[na:1.8.0_331]\r\nat sun.net.NetworkClient.doConnect(NetworkClient.java:180) ~[na:1.8.0_331]\r\nat sun.net.www.http.HttpClient.openServer(HttpClient.java:463) ~[na:1.8.0_331]\r\nat sun.net.www.http.HttpClient.openServer(HttpClient.java:558) ~[na:1.8.0_331]\r\nat sun.net.www.protocol.https.HttpsClient.&lt;init&gt;(HttpsClient.java:292) ~[na:1.8.0_331]\r\nat sun.net.www.protocol.https.HttpsClient.New(HttpsClient.java:395) ~[na:1.8.0_331]\r\nat sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.getNewHttpClient(AbstractDelegateHttpsURLConnection.java:203) ~[na:1.8.0_331]\r\nat sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1167) ~[na:1.8.0_331]\r\nat sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1061) ~[na:1.8.0_331]\r\nat sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:189) ~[na:1.8.0_331]\r\nat sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1584) ~[na:1.8.0_331]\r\nat sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1512) ~[na:1.8.0_331]\r\nat sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:268) ~[na:1.8.0_331]\r\nat com.datastax.oss.driver.internal.core.config.cloud.CloudConfigFactory.fetchProxyMetadata(CloudConfigFactory.java:232) ~[java-driver-core-4.14.1.jar:na]\r\n... 48 common frames omitted\r\n \r\n```","title":"Not able to connect to Astra DB using Secure Connect Bundle","body":"<p>Configuration of Secure bundle is as follow.</p>\n<pre><code>\n@ConfigurationProperties(prefix = &quot;datastax.astra&quot;)   \npublic class DataStaxAstraProperties {\n\n    private File secureConnectBundle;\n\n    public File getSecureConnectBundle() {\n        return secureConnectBundle;\n    }\n\n    public void setSecureConnectBundle(File secureConnectBundle) {\n        this.secureConnectBundle = secureConnectBundle;\n    } }\n\n</code></pre>\n<p>The path to secure bundle is configured in application.yaml file as follow :</p>\n<pre><code>datastax.astra:\n    secure-connect-bundle: secure-connect-1.zip\n</code></pre>\n<p>Secure bundle zip is present is application classpath and resides in resource folder</p>\n<p>Also client id, secret and token are correct.</p>\n<p>When trying to connect to Datastax Astra DB facing the following error:\nThe main error is:</p>\n<blockquote>\n<p>Failed to instantiate [com.datastax.oss.driver.api.core.CqlSession]: Factory method 'cassandraSession' threw exception; nested exception is java.lang.IllegalStateException: Unable to connect to cloud metadata service. Please make sure your cluster is not parked or terminated</p>\n</blockquote>\n<p>Error Stack is as follow :</p>\n<pre><code>Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.\n2022-06-26 12:04:31.348 ERROR 9564 — [  restartedMain] o.s.boot.SpringApplication               : Application run failed\n\norg.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'org.springframework.boot.autoconfigure.data.cassandra.CassandraDataAutoConfiguration': Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'cassandraSession' defined in class path resource [org/springframework/boot/autoconfigure/cassandra/CassandraAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.datastax.oss.driver.api.core.CqlSession]: Factory method 'cassandraSession' threw exception; nested exception is java.lang.IllegalStateException: Unable to connect to cloud metadata service. Please make sure your cluster is not parked or terminated\nat org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:800) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:229) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1372) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1222) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:953) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918) ~[spring-context-5.3.20.jar:5.3.20]\nat org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:583) ~[spring-context-5.3.20.jar:5.3.20]\nat org.springframework.boot.SpringApplication.refresh(SpringApplication.java:734) [spring-boot-2.7.0.jar:2.7.0]\nat org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) [spring-boot-2.7.0.jar:2.7.0]\nat org.springframework.boot.SpringApplication.run(SpringApplication.java:308) [spring-boot-2.7.0.jar:2.7.0]\nat org.springframework.boot.SpringApplication.run(SpringApplication.java:1306) [spring-boot-2.7.0.jar:2.7.0]\nat org.springframework.boot.SpringApplication.run(SpringApplication.java:1295) [spring-boot-2.7.0.jar:2.7.0]\nat course.prags.betterreadsdataloader.BetterreadsApplication.main(BetterreadsApplication.java:44) [classes/:na]\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_331]\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_331]\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_331]\nat java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_331]\nat org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49) [spring-boot-devtools-2.7.0.jar:2.7.0]\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'cassandraSession' defined in class path resource [org/springframework/boot/autoconfigure/cassandra/CassandraAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.datastax.oss.driver.api.core.CqlSession]: Factory method 'cassandraSession' threw exception; nested exception is java.lang.IllegalStateException: Unable to connect to cloud metadata service. Please make sure your cluster is not parked or terminated\nat org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:658) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:638) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1352) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1195) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1389) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1309) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:887) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791) ~[spring-beans-5.3.20.jar:5.3.20]\n... 23 common frames omitted\nCaused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.datastax.oss.driver.api.core.CqlSession]: Factory method 'cassandraSession' threw exception; nested exception is java.lang.IllegalStateException: Unable to connect to cloud metadata service. Please make sure your cluster is not parked or terminated\nat org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:185) ~[spring-beans-5.3.20.jar:5.3.20]\nat org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:653) ~[spring-beans-5.3.20.jar:5.3.20]\n... 37 common frames omitted\nCaused by: java.lang.IllegalStateException: Unable to connect to cloud metadata service. Please make sure your cluster is not parked or terminated\nat com.datastax.oss.driver.internal.core.config.cloud.CloudConfigFactory.fetchProxyMetadata(CloudConfigFactory.java:234) ~[java-driver-core-4.14.1.jar:na]\nat com.datastax.oss.driver.internal.core.config.cloud.CloudConfigFactory.createCloudConfig(CloudConfigFactory.java:133) ~[java-driver-core-4.14.1.jar:na]\nat com.datastax.oss.driver.api.core.session.SessionBuilder.buildDefaultSessionAsync(SessionBuilder.java:876) ~[java-driver-core-4.14.1.jar:na]\nat com.datastax.oss.driver.api.core.session.SessionBuilder.buildAsync(SessionBuilder.java:817) ~[java-driver-core-4.14.1.jar:na]\nat com.datastax.oss.driver.api.core.session.SessionBuilder.build(SessionBuilder.java:835) ~[java-driver-core-4.14.1.jar:na]\nat org.springframework.boot.autoconfigure.cassandra.CassandraAutoConfiguration.cassandraSession(CassandraAutoConfiguration.java:77) ~[spring-boot-autoconfigure-2.7.0.jar:2.7.0]\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_331]\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_331]\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_331]\nat java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_331]\nat org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:154) ~[spring-beans-5.3.20.jar:5.3.20]\n... 38 common frames omitted\nCaused by: java.net.ConnectException: Connection timed out: connect\nat java.net.DualStackPlainSocketImpl.connect0(Native Method) ~[na:1.8.0_331]\nat java.net.DualStackPlainSocketImpl.socketConnect(DualStackPlainSocketImpl.java:75) ~[na:1.8.0_331]\nat java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:476) ~[na:1.8.0_331]\nat java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:218) ~[na:1.8.0_331]\nat java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:200) ~[na:1.8.0_331]\nat java.net.PlainSocketImpl.connect(PlainSocketImpl.java:162) ~[na:1.8.0_331]\nat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:394) ~[na:1.8.0_331]\nat java.net.Socket.connect(Socket.java:606) ~[na:1.8.0_331]\nat sun.security.ssl.SSLSocketImpl.connect(SSLSocketImpl.java:298) ~[na:1.8.0_331]\nat sun.security.ssl.BaseSSLSocketImpl.connect(BaseSSLSocketImpl.java:173) ~[na:1.8.0_331]\nat sun.net.NetworkClient.doConnect(NetworkClient.java:180) ~[na:1.8.0_331]\nat sun.net.www.http.HttpClient.openServer(HttpClient.java:463) ~[na:1.8.0_331]\nat sun.net.www.http.HttpClient.openServer(HttpClient.java:558) ~[na:1.8.0_331]\nat sun.net.www.protocol.https.HttpsClient.&lt;init&gt;(HttpsClient.java:292) ~[na:1.8.0_331]\nat sun.net.www.protocol.https.HttpsClient.New(HttpsClient.java:395) ~[na:1.8.0_331]\nat sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.getNewHttpClient(AbstractDelegateHttpsURLConnection.java:203) ~[na:1.8.0_331]\nat sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1167) ~[na:1.8.0_331]\nat sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1061) ~[na:1.8.0_331]\nat sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:189) ~[na:1.8.0_331]\nat sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1584) ~[na:1.8.0_331]\nat sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1512) ~[na:1.8.0_331]\nat sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:268) ~[na:1.8.0_331]\nat com.datastax.oss.driver.internal.core.config.cloud.CloudConfigFactory.fetchProxyMetadata(CloudConfigFactory.java:232) ~[java-driver-core-4.14.1.jar:na]\n... 48 common frames omitted\n \n</code></pre>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":17835,"reputation":303895,"user_id":40342,"accept_rate":62,"display_name":"Joachim Sauer"},"score":2,"creation_date":1656320079,"post_id":72769355,"comment_id":128533874,"body_markdown":"1. Print the result of `new File(&quot;cars.txt&quot;).getAbsolutePath()` to verify that it tries to read what you think it tries. 2. Verify that a file with that name actually exists where you think it does. Specifically if you use Windows ensure that Explorer shows file extensions, because you might actually have a file called `cars.txt.txt` and not know it because Explorer hides the (last) file extension by default. 3. When asking for help *always* provide the *full* stack trace of the exception that you get, don&#39;t just describe it. 4. shows us how you tried to use the absolute path.","body":"1. Print the result of <code>new File(&quot;cars.txt&quot;).getAbsolutePath()</code> to verify that it tries to read what you think it tries. 2. Verify that a file with that name actually exists where you think it does. Specifically if you use Windows ensure that Explorer shows file extensions, because you might actually have a file called <code>cars.txt.txt</code> and not know it because Explorer hides the (last) file extension by default. 3. When asking for help <i>always</i> provide the <i>full</i> stack trace of the exception that you get, don&#39;t just describe it. 4. shows us how you tried to use the absolute path."},{"owner":{"account_id":2485939,"reputation":19426,"user_id":2164365,"accept_rate":40,"display_name":"Abra"},"score":1,"creation_date":1656320654,"post_id":72769355,"comment_id":128534097,"body_markdown":"`new File(&quot;cars.txt&quot;)` Java will assume that file _cars.txt_ is located in the [working directory](https://stackoverflow.com/questions/4871051/how-to-get-the-current-working-directory-in-java).","body":"<code>new File(&quot;cars.txt&quot;)</code> Java will assume that file <i>cars.txt</i> is located in the <a href=\"https://stackoverflow.com/questions/4871051/how-to-get-the-current-working-directory-in-java\">working directory</a>."},{"owner":{"account_id":25652863,"reputation":23,"user_id":19419851,"display_name":"Costantino Tessera"},"score":0,"creation_date":1656320713,"post_id":72769355,"comment_id":128534114,"body_markdown":"i&#39;m on linux therefore i don&#39;t have the problem that it might be hiding the extensions. Then, with getAbsolutePath() i verified that indeed the file is what i think it is, and it is where i think it is. Only when i call it with the scanner it tells me it couldn&#39;t find it. And the full exception is FileNotFoundException, i didn&#39;t get anything else, so i don&#39;t even know what details i can provide more.","body":"i&#39;m on linux therefore i don&#39;t have the problem that it might be hiding the extensions. Then, with getAbsolutePath() i verified that indeed the file is what i think it is, and it is where i think it is. Only when i call it with the scanner it tells me it couldn&#39;t find it. And the full exception is FileNotFoundException, i didn&#39;t get anything else, so i don&#39;t even know what details i can provide more."},{"owner":{"account_id":17835,"reputation":303895,"user_id":40342,"accept_rate":62,"display_name":"Joachim Sauer"},"score":0,"creation_date":1656324895,"post_id":72769355,"comment_id":128535545,"body_markdown":"I wrote &quot;full stack trace of the exception&quot;. If any of those words mean nothing to you, then please google what they could mean and don&#39;t just repeat information you&#39;ve already given us. As it stands your question doesn&#39;t contain enough information to help you. Is `FileNotFoundException` **literally** the only output that you get? I find that hard to believe. How **exactly** are you launching your code ([edit] your question to include the command and/or screenshot of dialog, if through UI).","body":"I wrote &quot;full stack trace of the exception&quot;. If any of those words mean nothing to you, then please google what they could mean and don&#39;t just repeat information you&#39;ve already given us. As it stands your question doesn&#39;t contain enough information to help you. Is <code>FileNotFoundException</code> <b>literally</b> the only output that you get? I find that hard to believe. How <b>exactly</b> are you launching your code (<a href=\"https://stackoverflow.com/posts/72769355/edit\">edit</a> your question to include the command and/or screenshot of dialog, if through UI)."},{"owner":{"account_id":9537825,"reputation":1490,"user_id":7275056,"display_name":"vsfDawg"},"score":0,"creation_date":1656329090,"post_id":72769355,"comment_id":128536973,"body_markdown":"Take a closer look at the message - specifically, &quot;Unresolved compilation problem&quot;.","body":"Take a closer look at the message - specifically, &quot;Unresolved compilation problem&quot;."},{"owner":{"account_id":17835,"reputation":303895,"user_id":40342,"accept_rate":62,"display_name":"Joachim Sauer"},"score":1,"creation_date":1656330050,"post_id":72769355,"comment_id":128537336,"body_markdown":"Just for the record: I hate the fact that Eclipse *still* silently runs code that doesn&#39;t actually compile which leads to questions like this *again and again*. If your code doesn&#39;t compile, don#t just click through the &quot;the code is broken, run it anyway?&quot; dialog, but **fix your code first** and if you don&#39;t know how, then **post a question here asking about the error you get in your IDE** (after googling it, of course). But that default setting of Eclipse has wasted so many lifetimes of developers, for basically no gain.","body":"Just for the record: I hate the fact that Eclipse <i>still</i> silently runs code that doesn&#39;t actually compile which leads to questions like this <i>again and again</i>. If your code doesn&#39;t compile, don#t just click through the &quot;the code is broken, run it anyway?&quot; dialog, but <b>fix your code first</b> and if you don&#39;t know how, then <b>post a question here asking about the error you get in your IDE</b> (after googling it, of course). But that default setting of Eclipse has wasted so many lifetimes of developers, for basically no gain."},{"owner":{"account_id":19875789,"reputation":2650,"user_id":14645101,"display_name":"Aniketh Malyala"},"score":1,"creation_date":1656332187,"post_id":72769355,"comment_id":128538166,"body_markdown":"@JoachimSauer IKR i first started coding with eclipse and i didnt realize until i switched to other ide&#39;s how terrible it actually was &#128557;","body":"@JoachimSauer IKR i first started coding with eclipse and i didnt realize until i switched to other ide&#39;s how terrible it actually was 😭"}],"answers":[{"tags":[],"owner":{"account_id":19875789,"reputation":2650,"user_id":14645101,"display_name":"Aniketh Malyala"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1656329805,"creation_date":1656328476,"answer_id":72771159,"question_id":72769355,"body_markdown":"The problem is not with where your file is, but it is just that you need to include something in your main method before reading files. As another user already mentioned, take a closer look at your error and it will reveal that the error is a compilation error.\r\n\r\nWhen defining your main method, instead of doing:\r\n\r\n    public static void main (String[] args) {\r\n\r\nMake sure you write:\r\n\r\n    public static void main (String[] args) throws IOExcpetion{\r\n\r\nThis will basically let your compiler know you are aware of the exception since it is mandatory to check for it.\r\n\r\nOverall your code should look something like this:\r\n\r\n    import java.io.*;\r\n    import java.util.*;\r\n    public class Main {\r\n        public static void main (String[] args) throws IOException{\r\n          Scanner input = new Scanner(System.in);\r\n          Scanner gimmiethetxtplz = new Scanner(new File(&quot;cars.txt&quot;));\r\n          int rows = input.nextInt();\r\n          int columns = input.nextInt();\r\n          String[][] cars = new String[rows][columns];\r\n        \r\n          for (int i = 0; i &lt; rows; i++) {\r\n             for (int j = 0; j &lt; columns; j++) {\r\n                 cars[i][j] = gimmiethetxtplz.next();\r\n                 System.out.print(cars[i][j] + &quot; &quot;);\r\n                         }\r\n                   System.out.println();\r\n                  }\r\n               input.close();\r\n            }\r\n         }\r\n\r\nNote: I edited part of your for loop to say `.next()` instead of `.nextLine()`, because otherwise each element of your `cars` array would be an entire line instead of a single letter, and you would then get an error when reading your file.\r\n\r\nSample Input from Console:\r\n\r\n    3\r\n    3\r\n\r\nSample File (cars.txt):\r\n\r\n    a b c\r\n    d e f\r\n    g h i\r\n\r\nOutput:\r\n\r\n    a b c \r\n    d e f \r\n    g h i \r\n\r\n\r\nLet me know if you have any further questions or clarifications! :) \r\n","title":"I&#39;m trying to have my program read a txt file and print in a two-dimensional array the .txt file, But i keep getting FileNotFoundException","body":"<p>The problem is not with where your file is, but it is just that you need to include something in your main method before reading files. As another user already mentioned, take a closer look at your error and it will reveal that the error is a compilation error.</p>\n<p>When defining your main method, instead of doing:</p>\n<pre><code>public static void main (String[] args) {\n</code></pre>\n<p>Make sure you write:</p>\n<pre><code>public static void main (String[] args) throws IOExcpetion{\n</code></pre>\n<p>This will basically let your compiler know you are aware of the exception since it is mandatory to check for it.</p>\n<p>Overall your code should look something like this:</p>\n<pre><code>import java.io.*;\nimport java.util.*;\npublic class Main {\n    public static void main (String[] args) throws IOException{\n      Scanner input = new Scanner(System.in);\n      Scanner gimmiethetxtplz = new Scanner(new File(&quot;cars.txt&quot;));\n      int rows = input.nextInt();\n      int columns = input.nextInt();\n      String[][] cars = new String[rows][columns];\n    \n      for (int i = 0; i &lt; rows; i++) {\n         for (int j = 0; j &lt; columns; j++) {\n             cars[i][j] = gimmiethetxtplz.next();\n             System.out.print(cars[i][j] + &quot; &quot;);\n                     }\n               System.out.println();\n              }\n           input.close();\n        }\n     }\n</code></pre>\n<p>Note: I edited part of your for loop to say <code>.next()</code> instead of <code>.nextLine()</code>, because otherwise each element of your <code>cars</code> array would be an entire line instead of a single letter, and you would then get an error when reading your file.</p>\n<p>Sample Input from Console:</p>\n<pre><code>3\n3\n</code></pre>\n<p>Sample File (cars.txt):</p>\n<pre><code>a b c\nd e f\ng h i\n</code></pre>\n<p>Output:</p>\n<pre><code>a b c \nd e f \ng h i \n</code></pre>\n<p>Let me know if you have any further questions or clarifications! :)</p>\n"}],"owner":{"account_id":25652863,"reputation":23,"user_id":19419851,"display_name":"Costantino Tessera"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":64,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"closed_date":1656329957,"accepted_answer_id":72771159,"answer_count":1,"score":1,"last_activity_date":1656329805,"creation_date":1656319843,"question_id":72769355,"body_markdown":"before anyone tells me, i checked the path, and i tried both with abosolute and relative paths, but the error remains the same.\r\nHere is the code.\r\n\r\n\r\n\r\n    public class Main {\r\n\t    public static void main (String[] args) {\r\n\t\t  Scanner input = new Scanner(System.in);\r\n\t\t  Scanner gimmiethetxtplz = new Scanner(new File(&quot;cars.txt&quot;));\r\n\t\t  int rows = input.nextInt();\r\n\t\t  int columns = input.nextInt();\r\n\t\t  String[][] cars = new String[rows][columns];\r\n\t\t\r\n\t\t  for (int i = 0; i &lt; rows; i++) {\r\n\t\t\t for (int j = 0; j &lt; columns; j++) {\r\n\t\t\t\t cars[i][j] = gimmiethetxtplz.nextLine();\r\n\t\t\t\t System.out.print(cars[i][j] + &quot; &quot;);\r\n\t\t\t             }\r\n\t\t\t       System.out.println();\r\n\t\t          }\r\n\t\t       input.close();\r\n\t        }\r\n         }\r\nThe file is in the src folder\r\n\r\n    Exception in thread &quot;main&quot; java.lang.Error: Unresolved compilation \r\n    problem: \r\n\tUnhandled exception type FileNotFoundException\r\n\r\n\tat training.Main.main(Main.java:9)\r\n\r\n","title":"I&#39;m trying to have my program read a txt file and print in a two-dimensional array the .txt file, But i keep getting FileNotFoundException","body":"<p>before anyone tells me, i checked the path, and i tried both with abosolute and relative paths, but the error remains the same.\nHere is the code.</p>\n<pre><code>public class Main {\n    public static void main (String[] args) {\n      Scanner input = new Scanner(System.in);\n      Scanner gimmiethetxtplz = new Scanner(new File(&quot;cars.txt&quot;));\n      int rows = input.nextInt();\n      int columns = input.nextInt();\n      String[][] cars = new String[rows][columns];\n    \n      for (int i = 0; i &lt; rows; i++) {\n         for (int j = 0; j &lt; columns; j++) {\n             cars[i][j] = gimmiethetxtplz.nextLine();\n             System.out.print(cars[i][j] + &quot; &quot;);\n                     }\n               System.out.println();\n              }\n           input.close();\n        }\n     }\n</code></pre>\n<p>The file is in the src folder</p>\n<pre><code>Exception in thread &quot;main&quot; java.lang.Error: Unresolved compilation \nproblem: \nUnhandled exception type FileNotFoundException\n\nat training.Main.main(Main.java:9)\n</code></pre>\n"},{"tags":["java","postgresql","spring-boot","spring-security"],"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1656318911,"post_id":72762630,"comment_id":128533477,"body_markdown":"Please edit the question to limit it to a specific problem with enough detail to identify an adequate answer.","body":"Please edit the question to limit it to a specific problem with enough detail to identify an adequate answer."},{"owner":{"account_id":7134819,"reputation":5058,"user_id":5454842,"display_name":"Marcus Hert da Coregio"},"score":0,"creation_date":1656338015,"post_id":72762630,"comment_id":128540576,"body_markdown":"Do you really need the `AuthenticationManager` Bean? Have you tried to remove it?","body":"Do you really need the <code>AuthenticationManager</code> Bean? Have you tried to remove it?"},{"owner":{"account_id":18642529,"reputation":1,"user_id":18974892,"display_name":"Nikita Kordyuk"},"score":0,"creation_date":1656348409,"post_id":72762630,"comment_id":128544794,"body_markdown":"@MarcusHertdaCoregio I have tried to remove this bean but it didn&#39;t help at all.","body":"@MarcusHertdaCoregio I have tried to remove this bean but it didn&#39;t help at all."},{"owner":{"account_id":7134819,"reputation":5058,"user_id":5454842,"display_name":"Marcus Hert da Coregio"},"score":0,"creation_date":1656348904,"post_id":72762630,"comment_id":128544959,"body_markdown":"What your `/process_login` looks like?","body":"What your <code>&#47;process_login</code> looks like?"},{"owner":{"account_id":18642529,"reputation":1,"user_id":18974892,"display_name":"Nikita Kordyuk"},"score":0,"creation_date":1656349447,"post_id":72762630,"comment_id":128545159,"body_markdown":"@MarcusHertdaCoregio /process_login is automatically created by Spring Security. It is just URL to which I should make POST request from my login.html page and which will automatically perform login.","body":"@MarcusHertdaCoregio /process_login is automatically created by Spring Security. It is just URL to which I should make POST request from my login.html page and which will automatically perform login."}],"owner":{"account_id":18642529,"reputation":1,"user_id":18974892,"display_name":"Nikita Kordyuk"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":148,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1656329093,"creation_date":1656255241,"question_id":72762630,"body_markdown":"I have added BCryptPasswordEncoder to my project and I store every user&#39;s password in my DB in encoded way. And now I can&#39;t log in using not encoded password but if I use encoded password I still can log in. As I know, AuthenticationManager have to encode entered password according to bean PasswordEncoder and compare with each password in my DB.\r\n\r\nSo the question is: why AuthenticationManager doesn&#39;t encode entered password?\r\n\r\nP.S: As I know, ``` authenticationConfiguration.getAuthenticationManager() ``` replaces ``` authenticationConfiguration.userDetailsService(personDetailsService).passwordEncoder(getPasswordEncoder()) ``` since Spring Security 5.7.0-M2.\r\n\r\nMy SecurityConfig class:\r\n```\r\n@EnableWebSecurity\r\npublic class SecurityConfig {\r\n    private final PersonDetailsService personDetailsService;\r\n\r\n    @Autowired\r\n    public SecurityConfig(PersonDetailsService personDetailsService) {\r\n        this.personDetailsService = personDetailsService;\r\n    }\r\n\r\n    @Bean\r\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\r\n        http\r\n                .csrf().disable()\r\n                .authorizeRequests().antMatchers(&quot;/auth/login&quot;, &quot;/error&quot;, &quot;/auth/registration&quot;).permitAll()\r\n                .anyRequest().authenticated()\r\n                .and()\r\n                .formLogin()\r\n                .loginPage(&quot;/auth/login&quot;)\r\n                .loginProcessingUrl(&quot;/process_login&quot;)\r\n                .defaultSuccessUrl(&quot;/hello&quot;, true)\r\n                .failureUrl(&quot;/auth/login?error&quot;)\r\n                .and()\r\n                .logout().logoutUrl(&quot;/logout&quot;).logoutSuccessUrl(&quot;/auth/login&quot;);\r\n\r\n        return http.build();\r\n    }\r\n\r\n    @Bean\r\n    public AuthenticationManager authenticationManager(AuthenticationConfiguration authenticationConfiguration) throws Exception {\r\n        return authenticationConfiguration.getAuthenticationManager();\r\n    }\r\n\r\n    @Bean\r\n    public PasswordEncoder passwordEncoder() {\r\n        return new BCryptPasswordEncoder();\r\n    }\r\n}\r\n```\r\n\r\nMy RegistrationService: \r\n```\r\n@Service\r\npublic class RegistrationService {\r\n    private final PeopleRepository peopleRepository;\r\n\r\n    private final PasswordEncoder passwordEncoder;\r\n\r\n    @Autowired\r\n    public RegistrationService(PeopleRepository peopleRepository, PasswordEncoder passwordEncoder) {\r\n        this.peopleRepository = peopleRepository;\r\n        this.passwordEncoder = passwordEncoder;\r\n    }\r\n\r\n    @Transactional\r\n    public void register(Person person) {\r\n        person.setPassword(passwordEncoder.encode(person.getPassword()));\r\n        peopleRepository.save(person);\r\n    }\r\n}\r\n```\r\n\r\n**EDIT:** \r\n\r\nIf I extend my SecurityConfig from deprecated WebSecurityConfigurerAdapter and change my code to this:\r\n``` \r\n@EnableWebSecurity\r\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\r\n    private final PersonDetailsService personDetailsService;\r\n\r\n    @Autowired\r\n    public SecurityConfig(PersonDetailsService personDetailsService) {\r\n        this.personDetailsService = personDetailsService;\r\n    }\r\n\r\n    @Override\r\n    protected void configure(HttpSecurity http) throws Exception {\r\n        http\r\n                .csrf().disable()\r\n                .authorizeRequests().antMatchers(&quot;/auth/login&quot;, &quot;/error&quot;, &quot;/auth/registration&quot;).permitAll()\r\n                .anyRequest().authenticated()\r\n                .and()\r\n                .formLogin()\r\n                .loginPage(&quot;/auth/login&quot;)\r\n                .loginProcessingUrl(&quot;/process_login&quot;)\r\n                .defaultSuccessUrl(&quot;/hello&quot;, true)\r\n                .failureUrl(&quot;/auth/login?error&quot;)\r\n                .and()\r\n                .logout().logoutUrl(&quot;/logout&quot;).logoutSuccessUrl(&quot;/auth/login&quot;);\r\n\r\n    }\r\n\r\n    @Bean\r\n    public PasswordEncoder getPasswordEncoder() {\r\n        return new BCryptPasswordEncoder();\r\n    }\r\n\r\n\r\n    @Override\r\n    protected void configure(AuthenticationManagerBuilder auth) throws Exception {\r\n        auth.userDetailsService(personDetailsService).passwordEncoder(getPasswordEncoder());\r\n    }\r\n}\r\n\r\n```\r\nthen it works like it have to (entered by user password is getting encrypted by ```configure(AuthenticationManagerBuilder auth)``` and then it compares to other passwords from DB and if there is the same password found user is authenticated).","title":"Cannot configure my SecurityConfig class without deprecated WebSecurityConfigurerAdapter","body":"<p>I have added BCryptPasswordEncoder to my project and I store every user's password in my DB in encoded way. And now I can't log in using not encoded password but if I use encoded password I still can log in. As I know, AuthenticationManager have to encode entered password according to bean PasswordEncoder and compare with each password in my DB.</p>\n<p>So the question is: why AuthenticationManager doesn't encode entered password?</p>\n<p>P.S: As I know, <code>authenticationConfiguration.getAuthenticationManager()</code> replaces <code>authenticationConfiguration.userDetailsService(personDetailsService).passwordEncoder(getPasswordEncoder())</code> since Spring Security 5.7.0-M2.</p>\n<p>My SecurityConfig class:</p>\n<pre><code>@EnableWebSecurity\npublic class SecurityConfig {\n    private final PersonDetailsService personDetailsService;\n\n    @Autowired\n    public SecurityConfig(PersonDetailsService personDetailsService) {\n        this.personDetailsService = personDetailsService;\n    }\n\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        http\n                .csrf().disable()\n                .authorizeRequests().antMatchers(&quot;/auth/login&quot;, &quot;/error&quot;, &quot;/auth/registration&quot;).permitAll()\n                .anyRequest().authenticated()\n                .and()\n                .formLogin()\n                .loginPage(&quot;/auth/login&quot;)\n                .loginProcessingUrl(&quot;/process_login&quot;)\n                .defaultSuccessUrl(&quot;/hello&quot;, true)\n                .failureUrl(&quot;/auth/login?error&quot;)\n                .and()\n                .logout().logoutUrl(&quot;/logout&quot;).logoutSuccessUrl(&quot;/auth/login&quot;);\n\n        return http.build();\n    }\n\n    @Bean\n    public AuthenticationManager authenticationManager(AuthenticationConfiguration authenticationConfiguration) throws Exception {\n        return authenticationConfiguration.getAuthenticationManager();\n    }\n\n    @Bean\n    public PasswordEncoder passwordEncoder() {\n        return new BCryptPasswordEncoder();\n    }\n}\n</code></pre>\n<p>My RegistrationService:</p>\n<pre><code>@Service\npublic class RegistrationService {\n    private final PeopleRepository peopleRepository;\n\n    private final PasswordEncoder passwordEncoder;\n\n    @Autowired\n    public RegistrationService(PeopleRepository peopleRepository, PasswordEncoder passwordEncoder) {\n        this.peopleRepository = peopleRepository;\n        this.passwordEncoder = passwordEncoder;\n    }\n\n    @Transactional\n    public void register(Person person) {\n        person.setPassword(passwordEncoder.encode(person.getPassword()));\n        peopleRepository.save(person);\n    }\n}\n</code></pre>\n<p><strong>EDIT:</strong></p>\n<p>If I extend my SecurityConfig from deprecated WebSecurityConfigurerAdapter and change my code to this:</p>\n<pre><code>@EnableWebSecurity\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\n    private final PersonDetailsService personDetailsService;\n\n    @Autowired\n    public SecurityConfig(PersonDetailsService personDetailsService) {\n        this.personDetailsService = personDetailsService;\n    }\n\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        http\n                .csrf().disable()\n                .authorizeRequests().antMatchers(&quot;/auth/login&quot;, &quot;/error&quot;, &quot;/auth/registration&quot;).permitAll()\n                .anyRequest().authenticated()\n                .and()\n                .formLogin()\n                .loginPage(&quot;/auth/login&quot;)\n                .loginProcessingUrl(&quot;/process_login&quot;)\n                .defaultSuccessUrl(&quot;/hello&quot;, true)\n                .failureUrl(&quot;/auth/login?error&quot;)\n                .and()\n                .logout().logoutUrl(&quot;/logout&quot;).logoutSuccessUrl(&quot;/auth/login&quot;);\n\n    }\n\n    @Bean\n    public PasswordEncoder getPasswordEncoder() {\n        return new BCryptPasswordEncoder();\n    }\n\n\n    @Override\n    protected void configure(AuthenticationManagerBuilder auth) throws Exception {\n        auth.userDetailsService(personDetailsService).passwordEncoder(getPasswordEncoder());\n    }\n}\n\n</code></pre>\n<p>then it works like it have to (entered by user password is getting encrypted by <code>configure(AuthenticationManagerBuilder auth)</code> and then it compares to other passwords from DB and if there is the same password found user is authenticated).</p>\n"},{"tags":["java","rx-java","reactive-programming","flatmap"],"answers":[{"tags":[],"owner":{"account_id":94182,"reputation":4442,"user_id":257272,"accept_rate":83,"display_name":"Julian Go"},"down_vote_count":1,"up_vote_count":7,"is_accepted":false,"score":6,"last_activity_date":1422442415,"creation_date":1422379575,"answer_id":28176346,"question_id":28176072,"body_markdown":"One possibility would be to use a function call:\r\n\r\n    private static Observable&lt;T&gt; myFunc(final Object data1) {\r\n        return op1(data1)\r\n            ...\r\n            .flatmap( (data2) -&gt; { \r\n                // I can access data1 here\r\n                return op2(data2);\r\n            });\r\n    }\r\n\r\n    Observable\r\n       .from(modifications)\r\n       .flatmap( (data1) -&gt; { return myFunc(data1); })\r\n\r\nBUT: correct me if I&#39;m wrong but it doesn&#39;t feel like the reactive-programming way of doing it","title":"In RxJava, how to pass a variable along when chaining observables?","body":"<p>One possibility would be to use a function call:</p>\n\n<pre><code>private static Observable&lt;T&gt; myFunc(final Object data1) {\n    return op1(data1)\n        ...\n        .flatmap( (data2) -&gt; { \n            // I can access data1 here\n            return op2(data2);\n        });\n}\n\nObservable\n   .from(modifications)\n   .flatmap( (data1) -&gt; { return myFunc(data1); })\n</code></pre>\n\n<p>BUT: correct me if I'm wrong but it doesn't feel like the reactive-programming way of doing it</p>\n"},{"tags":[],"owner":{"account_id":94182,"reputation":4442,"user_id":257272,"accept_rate":83,"display_name":"Julian Go"},"down_vote_count":0,"up_vote_count":20,"is_accepted":false,"score":20,"last_activity_date":1422381663,"creation_date":1422381663,"answer_id":28177003,"question_id":28176072,"body_markdown":"Another possibility is to map the result of `op1` to a `org.apache.commons.lang3.tuple.Pair` that contains the variable and pass that along:\r\n\r\n    Observable\r\n       .from(modifications)\r\n       .flatmap( (data1) -&gt; {\r\n           return op1(data1).map( obj -&gt; { return Pair.of(data1,obj); });\r\n       })\r\n       ...\r\n       .flatmap( (dataPair) -&gt; { \r\n           // data1 is dataPair.getLeft()\r\n           return op2(dataPair.getRight());\r\n       })\r\n\r\nIt works but it feels a bit uncomfortable to have variables hidden inside a Pair/Triple/... and it gets very verbose if you use the Java 6 notation.\r\n\r\nI wonder if there is a better solution, maybe some RxJava operator could help?","title":"In RxJava, how to pass a variable along when chaining observables?","body":"<p>Another possibility is to map the result of <code>op1</code> to a <code>org.apache.commons.lang3.tuple.Pair</code> that contains the variable and pass that along:</p>\n\n<pre><code>Observable\n   .from(modifications)\n   .flatmap( (data1) -&gt; {\n       return op1(data1).map( obj -&gt; { return Pair.of(data1,obj); });\n   })\n   ...\n   .flatmap( (dataPair) -&gt; { \n       // data1 is dataPair.getLeft()\n       return op2(dataPair.getRight());\n   })\n</code></pre>\n\n<p>It works but it feels a bit uncomfortable to have variables hidden inside a Pair/Triple/... and it gets very verbose if you use the Java 6 notation.</p>\n\n<p>I wonder if there is a better solution, maybe some RxJava operator could help?</p>\n"},{"tags":[],"owner":{"account_id":94182,"reputation":4442,"user_id":257272,"accept_rate":83,"display_name":"Julian Go"},"down_vote_count":0,"up_vote_count":70,"is_accepted":true,"score":70,"last_activity_date":1628158501,"creation_date":1422523922,"answer_id":28211179,"question_id":28176072,"body_markdown":"The advice I got from the Couchbase forum is to use nested observables:\r\n\r\n```lang-java\r\nObservable\r\n    .from(modifications)\r\n    .flatmap( (data1) -&gt; { \r\n        return op1(data1)\r\n            ...\r\n            .flatmap( (data2) -&gt; { \r\n                // I can access data1 here\r\n                return op2(data2);\r\n            })\r\n        });\r\n```\r\n\r\nEDIT: I&#39;ll mark this as the accepted answer as it seems to be the most recommended. If your processing is too complex to nest everything you can also check the solution with function calls.","title":"In RxJava, how to pass a variable along when chaining observables?","body":"<p>The advice I got from the Couchbase forum is to use nested observables:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Observable\n    .from(modifications)\n    .flatmap( (data1) -&gt; { \n        return op1(data1)\n            ...\n            .flatmap( (data2) -&gt; { \n                // I can access data1 here\n                return op2(data2);\n            })\n        });\n</code></pre>\n<p>EDIT: I'll mark this as the accepted answer as it seems to be the most recommended. If your processing is too complex to nest everything you can also check the solution with function calls.</p>\n"},{"tags":[],"owner":{"account_id":4037407,"reputation":3390,"user_id":3321301,"display_name":"josesuero"},"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1490503393,"creation_date":1490503393,"answer_id":43025088,"question_id":28176072,"body_markdown":"solution on this thread works, but for complex chains it makes code difficult to read, I had to pass multiple values and what i did was create a private class with all parameters, I find code to be more readable this way,\r\n\r\n    private class CommonData{\r\n       private string data1;\r\n       private string data2;\r\n    \r\n       *getters and setters*\r\n    }\r\n    ...\r\n    final CommonData data = new CommonData();\r\n    Observable\r\n       .from(modifications)\r\n       .flatmap( (data1) -&gt; { \r\n           data.setData1(data1);\r\n           return op1(data1); \r\n       })\r\n       ...\r\n       .flatmap( (data2) -&gt; { \r\n           data2 = data.getData1() + &quot;data 2... &quot;;\r\n           data.setData2(data2);\r\n           return op2(data2);\r\n       })\r\n\r\nhope it helps","title":"In RxJava, how to pass a variable along when chaining observables?","body":"<p>solution on this thread works, but for complex chains it makes code difficult to read, I had to pass multiple values and what i did was create a private class with all parameters, I find code to be more readable this way,</p>\n\n<pre><code>private class CommonData{\n   private string data1;\n   private string data2;\n\n   *getters and setters*\n}\n...\nfinal CommonData data = new CommonData();\nObservable\n   .from(modifications)\n   .flatmap( (data1) -&gt; { \n       data.setData1(data1);\n       return op1(data1); \n   })\n   ...\n   .flatmap( (data2) -&gt; { \n       data2 = data.getData1() + \"data 2... \";\n       data.setData2(data2);\n       return op2(data2);\n   })\n</code></pre>\n\n<p>hope it helps</p>\n"},{"tags":[],"owner":{"account_id":3526238,"reputation":906,"user_id":2947239,"accept_rate":25,"display_name":"Sisyphus"},"down_vote_count":0,"up_vote_count":8,"is_accepted":false,"score":8,"last_activity_date":1527756950,"creation_date":1527756950,"answer_id":50620348,"question_id":28176072,"body_markdown":"flatmap can take a second arg:\r\n\r\n    Observable.just(&quot;foo&quot;)\r\n                    .flatMap(foo -&gt; Observable.range(1, 5), Pair::of)\r\n                    .subscribe(pair -&gt; System.out.println(&quot;Result: &quot; + pair.getFirst() + &quot; Foo: &quot; + pair.getSecond()));\r\n\r\n\r\nsource: https://medium.com/rxjava-tidbits/rxjava-tidbits-1-use-flatmap-and-retain-original-source-value-4ec6a2de52d4","title":"In RxJava, how to pass a variable along when chaining observables?","body":"<p>flatmap can take a second arg:</p>\n\n<pre><code>Observable.just(\"foo\")\n                .flatMap(foo -&gt; Observable.range(1, 5), Pair::of)\n                .subscribe(pair -&gt; System.out.println(\"Result: \" + pair.getFirst() + \" Foo: \" + pair.getSecond()));\n</code></pre>\n\n<p>source: <a href=\"https://medium.com/rxjava-tidbits/rxjava-tidbits-1-use-flatmap-and-retain-original-source-value-4ec6a2de52d4\" rel=\"noreferrer\">https://medium.com/rxjava-tidbits/rxjava-tidbits-1-use-flatmap-and-retain-original-source-value-4ec6a2de52d4</a></p>\n"},{"tags":[],"owner":{"account_id":5019308,"reputation":179,"user_id":4033204,"accept_rate":50,"display_name":"happyyangyuan"},"down_vote_count":5,"up_vote_count":1,"is_accepted":false,"score":-4,"last_activity_date":1534589222,"creation_date":1534588826,"answer_id":51907702,"question_id":28176072,"body_markdown":"You can use &quot;global&quot; variable to achive this:  \r\n\r\n     Object[] data1Wrapper = new Object[]{null};\r\n     Object[] data2Wrapper = new Object[]{null};\r\n     Observable\r\n        .from(modifications)\r\n        .flatmap(data1 -&gt; {\r\n            data1Wrapper[0] = data1;\r\n            return op1(data1)\r\n         })\r\n          ...\r\n        .flatmap(data2 -&gt; { \r\n            // I can access data1 here use data1Wrapper[0]\r\n            Object data1 = data1Wrapper[0];\r\n            data2Wrapper[0] = data2;\r\n            return op2(data2);\r\n         })","title":"In RxJava, how to pass a variable along when chaining observables?","body":"<p>You can use \"global\" variable to achive this:  </p>\n\n<pre><code> Object[] data1Wrapper = new Object[]{null};\n Object[] data2Wrapper = new Object[]{null};\n Observable\n    .from(modifications)\n    .flatmap(data1 -&gt; {\n        data1Wrapper[0] = data1;\n        return op1(data1)\n     })\n      ...\n    .flatmap(data2 -&gt; { \n        // I can access data1 here use data1Wrapper[0]\n        Object data1 = data1Wrapper[0];\n        data2Wrapper[0] = data2;\n        return op2(data2);\n     })\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2297113,"reputation":280,"user_id":2018296,"display_name":"Ndivhuwo"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1555065406,"creation_date":1555065406,"answer_id":55649752,"question_id":28176072,"body_markdown":"I know this is an old question, but using RxJava2 &amp; lambda, \r\nYou can use something like:\r\n    \r\n    Observable\r\n    .from(modifications)\r\n    .flatMap((Function&lt;Data1, ObservableSource&lt;Data2&gt;&gt;) data1 -&gt; {\r\n                            //Get data 2 obeservable\r\n                            \r\n                                return Observable.just(new Data2())\r\n                            }\r\n                        }, Pair::of)\r\n\r\nOn the next flow (flatmap/map) your output pair will be (data1, data2)","title":"In RxJava, how to pass a variable along when chaining observables?","body":"<p>I know this is an old question, but using RxJava2 &amp; lambda, \nYou can use something like:</p>\n\n<pre><code>Observable\n.from(modifications)\n.flatMap((Function&lt;Data1, ObservableSource&lt;Data2&gt;&gt;) data1 -&gt; {\n                        //Get data 2 obeservable\n\n                            return Observable.just(new Data2())\n                        }\n                    }, Pair::of)\n</code></pre>\n\n<p>On the next flow (flatmap/map) your output pair will be (data1, data2)</p>\n"},{"tags":[],"owner":{"account_id":8338913,"reputation":2266,"user_id":6264830,"display_name":"0x384c0"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1574399784,"creation_date":1574399355,"answer_id":58987879,"question_id":28176072,"body_markdown":"Actually we have library, that simplify call chains.\r\n\r\nhttps://github.com/pakoito/Komprehensions\r\n\r\nAdding as Gradle dependency:\r\n\r\n    implementation &#39;io.reactivex.rxjava2:rxjava:2.2.1&#39;\r\n    implementation &#39;com.github.pakoito.Komprehensions:komprehensions-rx2:1.3.2&#39;\r\n\r\nUsage (Kotlin):\r\n\r\n    val observable = doFlatMap(\r\n        { Observable.from(modifications) },\r\n        { data1 -&gt; op1(data1) },\r\n        { data1, data2 -&gt; op2(data2) },\r\n        { data1, data2, data3 -&gt; op3(data1, data2, data3) }\r\n    )","title":"In RxJava, how to pass a variable along when chaining observables?","body":"<p>Actually we have library, that simplify call chains.</p>\n\n<p><a href=\"https://github.com/pakoito/Komprehensions\" rel=\"nofollow noreferrer\">https://github.com/pakoito/Komprehensions</a></p>\n\n<p>Adding as Gradle dependency:</p>\n\n<pre><code>implementation 'io.reactivex.rxjava2:rxjava:2.2.1'\nimplementation 'com.github.pakoito.Komprehensions:komprehensions-rx2:1.3.2'\n</code></pre>\n\n<p>Usage (Kotlin):</p>\n\n<pre><code>val observable = doFlatMap(\n    { Observable.from(modifications) },\n    { data1 -&gt; op1(data1) },\n    { data1, data2 -&gt; op2(data2) },\n    { data1, data2, data3 -&gt; op3(data1, data2, data3) }\n)\n</code></pre>\n"},{"tags":[],"owner":{"account_id":5283262,"reputation":447,"user_id":4217975,"display_name":"Ravindra-Ravi Verma"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656328417,"creation_date":1656328417,"answer_id":72771146,"question_id":28176072,"body_markdown":"you can use resultSelector `BiFunction&lt;? super T, ? super U, ? extends R&gt; resultSelector` the second parameter in flatmap, you can choose which result to return. \r\n","title":"In RxJava, how to pass a variable along when chaining observables?","body":"<p>you can use resultSelector <code>BiFunction&lt;? super T, ? super U, ? extends R&gt; resultSelector</code> the second parameter in flatmap, you can choose which result to return.</p>\n"}],"owner":{"account_id":94182,"reputation":4442,"user_id":257272,"accept_rate":83,"display_name":"Julian Go"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":27415,"favorite_count":0,"down_vote_count":0,"up_vote_count":91,"accepted_answer_id":28211179,"answer_count":9,"score":91,"last_activity_date":1656328417,"creation_date":1422378755,"question_id":28176072,"body_markdown":"I am chaining async operations using RxJava, and I&#39;d like to pass some variable downstream:\r\n\r\n    Observable\r\n       .from(modifications)\r\n       .flatmap( (data1) -&gt; { return op1(data1); })\r\n       ...\r\n       .flatmap( (data2) -&gt; { \r\n           // How to access data1 here ?\r\n           return op2(data2);\r\n       })\r\n\r\nIt seems like a common pattern but I couldn&#39;t find information about it.\r\n","title":"In RxJava, how to pass a variable along when chaining observables?","body":"<p>I am chaining async operations using RxJava, and I'd like to pass some variable downstream:</p>\n\n<pre><code>Observable\n   .from(modifications)\n   .flatmap( (data1) -&gt; { return op1(data1); })\n   ...\n   .flatmap( (data2) -&gt; { \n       // How to access data1 here ?\n       return op2(data2);\n   })\n</code></pre>\n\n<p>It seems like a common pattern but I couldn't find information about it.</p>\n"},{"tags":["java","spring","spring-mvc","spring-boot","spring-test"],"comments":[{"owner":{"account_id":3192259,"reputation":117599,"user_id":2696260,"display_name":"M. Deinum"},"score":44,"creation_date":1481277409,"post_id":41057602,"comment_id":69321866,"body_markdown":"`@SpringBootTest` and `@WebMvcTest` are mutually exclusive... Either you test the whole application or you test a slice but not both.","body":"<code>@SpringBootTest</code> and <code>@WebMvcTest</code> are mutually exclusive... Either you test the whole application or you test a slice but not both."},{"owner":{"account_id":6691354,"reputation":2410,"user_id":5160771,"accept_rate":80,"display_name":"lesnar"},"score":2,"creation_date":1481277810,"post_id":41057602,"comment_id":69322131,"body_markdown":"@M.Deinum : its big hint, thanks","body":"@M.Deinum : its big hint, thanks"},{"owner":{"account_id":56970,"reputation":1143,"user_id":170637,"display_name":"Olivier G&#233;rardin"},"score":2,"creation_date":1542620252,"post_id":41057602,"comment_id":93619443,"body_markdown":"I had a similar problem with both `@SpringBootTest` and `@DataMongoTest`. Removing `@SpringBootTest` solved the problem. \nThe error message could be clearer though...","body":"I had a similar problem with both <code>@SpringBootTest</code> and <code>@DataMongoTest</code>. Removing <code>@SpringBootTest</code> solved the problem.  The error message could be clearer though..."}],"answers":[{"tags":[],"owner":{"account_id":5242465,"reputation":541,"user_id":4189120,"display_name":"mahkras"},"down_vote_count":0,"up_vote_count":42,"is_accepted":false,"score":42,"last_activity_date":1493299738,"creation_date":1493299738,"answer_id":43659328,"question_id":41057602,"body_markdown":"This exception occurs when spring test can not find main configuration class.\r\nTry to add @ContextConfiguration anootation to your test class. Follow the spring test documention for more details (section [Detecting test configuration][1])\r\n\r\nMy example Test class is like this:\r\n\r\n    @RunWith(SpringRunner.class)\r\n    @ContextConfiguration(classes=Application.class)\r\n    @WebMvcTest(MyController.class)\r\n    public class MyConrollerTests {\r\n        ...\r\n    }\r\n\r\n  [1]: http://docs.spring.io/spring-boot/docs/1.4.0.M3/reference/htmlsingle/#boot-features-testing-spring-boot-applications-detecting-config","title":"Spring boot 1.4 Testing : Configuration error: found multiple declarations of @BootstrapWith","body":"<p>This exception occurs when spring test can not find main configuration class.\nTry to add @ContextConfiguration anootation to your test class. Follow the spring test documention for more details (section <a href=\"http://docs.spring.io/spring-boot/docs/1.4.0.M3/reference/htmlsingle/#boot-features-testing-spring-boot-applications-detecting-config\" rel=\"noreferrer\">Detecting test configuration</a>)</p>\n\n<p>My example Test class is like this:</p>\n\n<pre><code>@RunWith(SpringRunner.class)\n@ContextConfiguration(classes=Application.class)\n@WebMvcTest(MyController.class)\npublic class MyConrollerTests {\n    ...\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":6342823,"reputation":405,"user_id":4924242,"display_name":"Nesrin"},"down_vote_count":0,"up_vote_count":30,"is_accepted":false,"score":30,"last_activity_date":1542673013,"creation_date":1542673013,"answer_id":53384466,"question_id":41057602,"body_markdown":"Just Remove the @SpringBootTest and everything work fine. I had the same problem with using @SpringBootTest and @DataJpaTest, this error raised when I upgraded the pom.xml parent springboot version to 2.1.0 as below. When I was using version 2.0.5, this error was not raising.\r\n\r\n    @RunWith(SpringRunner.class)\r\n    //@SpringBootTest//(classes = KalahApplication.class)\r\n    // DataJpaTest supports rollback after running every test case\r\n    @DataJpaTest\r\n    public class GameRepositoryTest {\r\n\r\npom.xml\r\n\r\n       &lt;parent&gt;\r\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n            &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\r\n            &lt;version&gt;2.1.0.RELEASE&lt;/version&gt;\r\n            &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\r\n       &lt;/parent&gt;","title":"Spring boot 1.4 Testing : Configuration error: found multiple declarations of @BootstrapWith","body":"<p>Just Remove the @SpringBootTest and everything work fine. I had the same problem with using @SpringBootTest and @DataJpaTest, this error raised when I upgraded the pom.xml parent springboot version to 2.1.0 as below. When I was using version 2.0.5, this error was not raising.</p>\n\n<pre><code>@RunWith(SpringRunner.class)\n//@SpringBootTest//(classes = KalahApplication.class)\n// DataJpaTest supports rollback after running every test case\n@DataJpaTest\npublic class GameRepositoryTest {\n</code></pre>\n\n<p>pom.xml</p>\n\n<pre><code>   &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;2.1.0.RELEASE&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n   &lt;/parent&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":10408037,"reputation":476,"user_id":7701469,"display_name":"jalil"},"down_vote_count":0,"up_vote_count":16,"is_accepted":false,"score":16,"last_activity_date":1549172141,"creation_date":1549172141,"answer_id":54500271,"question_id":41057602,"body_markdown":"I know its too late to answer this question, but it may help someone in the future so... I had the same issue and after some research, i found that there shouldn&#39;t be `@WebMvcTest` if there is `@SpringBootTest`. so just remove `@WebMvcTest` and `@SpringBootTest` is taking care of the rest.","title":"Spring boot 1.4 Testing : Configuration error: found multiple declarations of @BootstrapWith","body":"<p>I know its too late to answer this question, but it may help someone in the future so... I had the same issue and after some research, i found that there shouldn't be <code>@WebMvcTest</code> if there is <code>@SpringBootTest</code>. so just remove <code>@WebMvcTest</code> and <code>@SpringBootTest</code> is taking care of the rest.</p>\n"},{"tags":[],"owner":{"account_id":12734632,"reputation":121,"user_id":9249944,"display_name":"iman bhlool"},"down_vote_count":0,"up_vote_count":7,"is_accepted":false,"score":7,"last_activity_date":1586187615,"creation_date":1586187615,"answer_id":61063528,"question_id":41057602,"body_markdown":"It happens because you declared both @WebMvcTest and @SpringBootTest, I resolve my same problem by removing @SpringBootTest","title":"Spring boot 1.4 Testing : Configuration error: found multiple declarations of @BootstrapWith","body":"<p>It happens because you declared both @WebMvcTest and @SpringBootTest, I resolve my same problem by removing @SpringBootTest</p>\n"},{"tags":[],"owner":{"account_id":7335122,"reputation":490,"user_id":5586793,"display_name":"Naveen"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1591249019,"creation_date":1591249019,"answer_id":62187529,"question_id":41057602,"body_markdown":"Hope this will help.  It worked for me after taking it off @SpringBootTest, and was testing the web later for the same @AutoWired would throw an error as i&#39;d used interface.  Rather mock the same it worked. \r\n\r\n\r\n\r\n   \r\n\r\n     package com.naveen.productreview;\r\n    \r\n    import static org.hamcrest.Matchers.containsString;\r\n    import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;\r\n    import static org.springframework.test.web.servlet.result.MockMvcResultHandlers.print;\r\n    import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;\r\n    import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;\r\n    \r\n    import org.junit.Test;\r\n    import org.junit.runner.RunWith;\r\n    import org.springframework.beans.factory.annotation.Autowired;\r\n    import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;\r\n    import org.springframework.boot.test.mock.mockito.MockBean;\r\n    import org.springframework.test.context.junit4.SpringRunner;\r\n    import org.springframework.test.web.servlet.MockMvc;\r\n    \r\n    import com.naveen.productreview.service.IProductReviewService;\r\n    \r\n    @RunWith(SpringRunner.class)\r\n    @WebMvcTest\r\n    //@SpringBootTest\r\n    public class WebLayerTest {\r\n    \r\n        @Autowired\r\n        private MockMvc mockMvc;\r\n    \r\n    \t@MockBean\r\n    \tprivate IProductReviewService productReviewService; \r\n    \r\n        @Test\r\n        public void shouldReturnDefaultMessage() throws Exception {\r\n            this.mockMvc.perform(get(&quot;/api/product-review&quot;)).andDo(print()).andExpect(status().isOk())\r\n            .andExpect(content().string(containsString(&quot;Naveen&quot;))); \r\n        }\r\n    }","title":"Spring boot 1.4 Testing : Configuration error: found multiple declarations of @BootstrapWith","body":"<p>Hope this will help.  It worked for me after taking it off @SpringBootTest, and was testing the web later for the same @AutoWired would throw an error as i'd used interface.  Rather mock the same it worked. </p>\n\n<pre><code> package com.naveen.productreview;\n\nimport static org.hamcrest.Matchers.containsString;\nimport static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;\nimport static org.springframework.test.web.servlet.result.MockMvcResultHandlers.print;\nimport static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;\nimport static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;\n\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;\nimport org.springframework.boot.test.mock.mockito.MockBean;\nimport org.springframework.test.context.junit4.SpringRunner;\nimport org.springframework.test.web.servlet.MockMvc;\n\nimport com.naveen.productreview.service.IProductReviewService;\n\n@RunWith(SpringRunner.class)\n@WebMvcTest\n//@SpringBootTest\npublic class WebLayerTest {\n\n    @Autowired\n    private MockMvc mockMvc;\n\n    @MockBean\n    private IProductReviewService productReviewService; \n\n    @Test\n    public void shouldReturnDefaultMessage() throws Exception {\n        this.mockMvc.perform(get(\"/api/product-review\")).andDo(print()).andExpect(status().isOk())\n        .andExpect(content().string(containsString(\"Naveen\"))); \n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":11645210,"reputation":31,"user_id":10954814,"display_name":"Viktor Sannikov"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1602453821,"creation_date":1602453821,"answer_id":64309441,"question_id":41057602,"body_markdown":"Looks like you want to write integration test. That&#39;s why i recommend use only \r\n\r\n    @SpringBootTest(classes = Application.class)\r\n\r\nIf you want to use junit4, then add \r\n\r\n    @RunWith(SpringRunner.class)\r\n\r\n","title":"Spring boot 1.4 Testing : Configuration error: found multiple declarations of @BootstrapWith","body":"<p>Looks like you want to write integration test. That's why i recommend use only</p>\n<pre><code>@SpringBootTest(classes = Application.class)\n</code></pre>\n<p>If you want to use junit4, then add</p>\n<pre><code>@RunWith(SpringRunner.class)\n</code></pre>\n"},{"tags":[],"owner":{"account_id":3497387,"reputation":43,"user_id":5984851,"display_name":"Илья Косолапов"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1608302037,"creation_date":1608302037,"answer_id":65358857,"question_id":41057602,"body_markdown":"in Junit 5 could be:\r\n\r\n    @ExtendWith(SpringExtension.class)\r\n    @DataJpaTest\r\n    class DeliveryRepositoryTest {\r\n    \r\n        @Autowired\r\n        private DeliveryRepository repository;\r\n        ...\r\n    }\r\n\r\n","title":"Spring boot 1.4 Testing : Configuration error: found multiple declarations of @BootstrapWith","body":"<p>in Junit 5 could be:</p>\n<pre><code>@ExtendWith(SpringExtension.class)\n@DataJpaTest\nclass DeliveryRepositoryTest {\n\n    @Autowired\n    private DeliveryRepository repository;\n    ...\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1422801,"reputation":621,"user_id":1347082,"display_name":"Emanuele"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1621068435,"creation_date":1621068435,"answer_id":67544870,"question_id":41057602,"body_markdown":"I had a similar issue with this set up: \r\n\r\n    @WebMvcTest\r\n    @SpringBootTest\r\n    @ContextConfiguration(classes = {Controller.class})\r\n    public class ControllerTest {\r\n    \r\n        @Autowired\r\n        private MockMvc mockMvc;\r\n\r\n    ...}\r\n\r\nand I have a Spring service bean autowired in the controller. \r\n\r\n\r\nThe final correct set up is to just leave `@WebMvcTest`, which provide the MockMvc, and add a `@MockBean` for the service. \r\nMy final, working, test is: \r\n\r\n\r\n    @WebMvcTest(Controller.class)\r\n    public class ControllerTest {\r\n    \r\n        @Autowired\r\n        private MockMvc mockMvc;\r\n    \r\n        @MockBean\r\n        private CustomerService customerService; \r\n\r\n    ...}\r\n\r\n","title":"Spring boot 1.4 Testing : Configuration error: found multiple declarations of @BootstrapWith","body":"<p>I had a similar issue with this set up:</p>\n<pre><code>@WebMvcTest\n@SpringBootTest\n@ContextConfiguration(classes = {Controller.class})\npublic class ControllerTest {\n\n    @Autowired\n    private MockMvc mockMvc;\n\n...}\n</code></pre>\n<p>and I have a Spring service bean autowired in the controller.</p>\n<p>The final correct set up is to just leave <code>@WebMvcTest</code>, which provide the MockMvc, and add a <code>@MockBean</code> for the service.\nMy final, working, test is:</p>\n<pre><code>@WebMvcTest(Controller.class)\npublic class ControllerTest {\n\n    @Autowired\n    private MockMvc mockMvc;\n\n    @MockBean\n    private CustomerService customerService; \n\n...}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":14543237,"reputation":49,"user_id":10504247,"display_name":"Apolinaire Nguemo"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1631446566,"creation_date":1631379369,"answer_id":69145030,"question_id":41057602,"body_markdown":"You must use only `@DataJpaTest`.\r\nRemove `@SpringBootTest` in your Testclass\r\n","title":"Spring boot 1.4 Testing : Configuration error: found multiple declarations of @BootstrapWith","body":"<p>You must use only <code>@DataJpaTest</code>.\nRemove <code>@SpringBootTest</code> in your Testclass</p>\n"},{"tags":[],"owner":{"account_id":4435199,"reputation":1,"user_id":3611222,"display_name":"yaityaich"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656328366,"creation_date":1656328366,"answer_id":72771139,"question_id":41057602,"body_markdown":"When you specify a server.port for your app you should define one also in your test main application \r\n\r\n    @SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)","title":"Spring boot 1.4 Testing : Configuration error: found multiple declarations of @BootstrapWith","body":"<p>When you specify a server.port for your app you should define one also in your test main application</p>\n<pre><code>@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)\n</code></pre>\n"}],"owner":{"account_id":6691354,"reputation":2410,"user_id":5160771,"accept_rate":80,"display_name":"lesnar"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":90526,"favorite_count":0,"down_vote_count":0,"up_vote_count":62,"answer_count":10,"score":62,"last_activity_date":1656328366,"creation_date":1481277265,"question_id":41057602,"body_markdown":"By following the official doc here:\r\nhttp://docs.spring.io/spring-boot/docs/1.4.0.M2/reference/htmlsingle/#Testing\r\n\r\ni wanted to test one of my REST API method like this:\r\n\r\n\r\n    @RunWith(SpringRunner.class)\r\n    @WebMvcTest(LoginController.class)\r\n    @SpringBootTest(classes = Application.class)\r\n    public class AuthorizationServiceTest {\r\n    \t@Autowired\r\n    \tprivate TestRestTemplate restTemplate;\r\n\r\n    \t@Test\r\n    \tpublic void test() {\r\n    \t\tObject returnedObject=his.restTemplate.getForObject(&quot;/login&quot;, Object.class);\r\n    \t}\r\n    }\r\n\r\nAs stated in the doc :\r\n\r\n\r\n&gt; The search algorithm works up from the package that contains the test\r\n&gt; until it finds a @SpringBootApplication or @SpringBootConfiguration\r\n&gt; annotated class. As long as you’ve structure your code in a sensible\r\n&gt; way your main configuration is usually found.\r\n\r\n\r\nI have structured my code properly(atleast i think ):\r\n\r\n**AuthorizationService** : is under  package          com.xxx.yyy.zzz.authorization;  \r\n\r\n**AuthorizationServiceTest** : is under  package          com.xxx.yyy.zzz.authorizationTest;\r\n\r\n\r\n\r\nI am getting this exception(Full Trace):\r\n\r\n\r\n    java.lang.IllegalStateException: Configuration error: found multiple declarations of @BootstrapWith for test class [com.orangeraid.rasberry.gateway.authorizationTest.AuthorizationServiceTest]: [@org.springframework.test.context.BootstrapWith(value=class org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTestContextBootstrapper), @org.springframework.test.context.BootstrapWith(value=class org.springframework.boot.test.context.SpringBootTestContextBootstrapper)]\r\n    \tat org.springframework.test.context.BootstrapUtils.resolveExplicitTestContextBootstrapper(BootstrapUtils.java:155)\r\n    \tat org.springframework.test.context.BootstrapUtils.resolveTestContextBootstrapper(BootstrapUtils.java:126)\r\n    \tat org.springframework.test.context.TestContextManager.&lt;init&gt;(TestContextManager.java:105)\r\n    \tat org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTestContextManager(SpringJUnit4ClassRunner.java:152)\r\n    \tat org.springframework.test.context.junit4.SpringJUnit4ClassRunner.&lt;init&gt;(SpringJUnit4ClassRunner.java:143)\r\n    \tat org.springframework.test.context.junit4.SpringRunner.&lt;init&gt;(SpringRunner.java:49)\r\n    \tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n    \tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n    \tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n    \tat java.lang.reflect.Constructor.newInstance(Constructor.java:422)\r\n    \tat org.junit.internal.builders.AnnotatedBuilder.buildRunner(AnnotatedBuilder.java:104)\r\n    \tat org.junit.internal.builders.AnnotatedBuilder.runnerForClass(AnnotatedBuilder.java:86)\r\n    \tat org.junit.runners.model.RunnerBuilder.safeRunnerForClass(RunnerBuilder.java:59)\r\n    \tat org.junit.internal.builders.AllDefaultPossibilitiesBuilder.runnerForClass(AllDefaultPossibilitiesBuilder.java:26)\r\n    \tat org.junit.runners.model.RunnerBuilder.safeRunnerForClass(RunnerBuilder.java:59)\r\n    \tat org.junit.internal.requests.ClassRequest.getRunner(ClassRequest.java:33)\r\n    \tat org.eclipse.jdt.internal.junit4.runner.JUnit4TestLoader.createUnfilteredTest(JUnit4TestLoader.java:84)\r\n    \tat org.eclipse.jdt.internal.junit4.runner.JUnit4TestLoader.createTest(JUnit4TestLoader.java:70)\r\n    \tat org.eclipse.jdt.internal.junit4.runner.JUnit4TestLoader.loadTests(JUnit4TestLoader.java:43)\r\n    \tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:444)\r\n    \tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:675)\r\n    \tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:382)\r\n    \tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:192)\r\n\r\nPlease help me with this, i have already spent more than 2-3 hours without any luck.\r\n\r\n\r\nThanks.\r\n\r\n","title":"Spring boot 1.4 Testing : Configuration error: found multiple declarations of @BootstrapWith","body":"<p>By following the official doc here:\n<a href=\"http://docs.spring.io/spring-boot/docs/1.4.0.M2/reference/htmlsingle/#Testing\" rel=\"noreferrer\">http://docs.spring.io/spring-boot/docs/1.4.0.M2/reference/htmlsingle/#Testing</a></p>\n\n<p>i wanted to test one of my REST API method like this:</p>\n\n<pre><code>@RunWith(SpringRunner.class)\n@WebMvcTest(LoginController.class)\n@SpringBootTest(classes = Application.class)\npublic class AuthorizationServiceTest {\n    @Autowired\n    private TestRestTemplate restTemplate;\n\n    @Test\n    public void test() {\n        Object returnedObject=his.restTemplate.getForObject(\"/login\", Object.class);\n    }\n}\n</code></pre>\n\n<p>As stated in the doc :</p>\n\n<blockquote>\n  <p>The search algorithm works up from the package that contains the test\n  until it finds a @SpringBootApplication or @SpringBootConfiguration\n  annotated class. As long as you’ve structure your code in a sensible\n  way your main configuration is usually found.</p>\n</blockquote>\n\n<p>I have structured my code properly(atleast i think ):</p>\n\n<p><strong>AuthorizationService</strong> : is under  package          com.xxx.yyy.zzz.authorization;  </p>\n\n<p><strong>AuthorizationServiceTest</strong> : is under  package          com.xxx.yyy.zzz.authorizationTest;</p>\n\n<p>I am getting this exception(Full Trace):</p>\n\n<pre><code>java.lang.IllegalStateException: Configuration error: found multiple declarations of @BootstrapWith for test class [com.orangeraid.rasberry.gateway.authorizationTest.AuthorizationServiceTest]: [@org.springframework.test.context.BootstrapWith(value=class org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTestContextBootstrapper), @org.springframework.test.context.BootstrapWith(value=class org.springframework.boot.test.context.SpringBootTestContextBootstrapper)]\n    at org.springframework.test.context.BootstrapUtils.resolveExplicitTestContextBootstrapper(BootstrapUtils.java:155)\n    at org.springframework.test.context.BootstrapUtils.resolveTestContextBootstrapper(BootstrapUtils.java:126)\n    at org.springframework.test.context.TestContextManager.&lt;init&gt;(TestContextManager.java:105)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTestContextManager(SpringJUnit4ClassRunner.java:152)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.&lt;init&gt;(SpringJUnit4ClassRunner.java:143)\n    at org.springframework.test.context.junit4.SpringRunner.&lt;init&gt;(SpringRunner.java:49)\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n    at java.lang.reflect.Constructor.newInstance(Constructor.java:422)\n    at org.junit.internal.builders.AnnotatedBuilder.buildRunner(AnnotatedBuilder.java:104)\n    at org.junit.internal.builders.AnnotatedBuilder.runnerForClass(AnnotatedBuilder.java:86)\n    at org.junit.runners.model.RunnerBuilder.safeRunnerForClass(RunnerBuilder.java:59)\n    at org.junit.internal.builders.AllDefaultPossibilitiesBuilder.runnerForClass(AllDefaultPossibilitiesBuilder.java:26)\n    at org.junit.runners.model.RunnerBuilder.safeRunnerForClass(RunnerBuilder.java:59)\n    at org.junit.internal.requests.ClassRequest.getRunner(ClassRequest.java:33)\n    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestLoader.createUnfilteredTest(JUnit4TestLoader.java:84)\n    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestLoader.createTest(JUnit4TestLoader.java:70)\n    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestLoader.loadTests(JUnit4TestLoader.java:43)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:444)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:675)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:382)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:192)\n</code></pre>\n\n<p>Please help me with this, i have already spent more than 2-3 hours without any luck.</p>\n\n<p>Thanks.</p>\n"},{"tags":["java","list","java-stream"],"comments":[{"owner":{"account_id":15910041,"reputation":592,"user_id":11480221,"display_name":"AddeusExMachina"},"score":0,"creation_date":1656282228,"post_id":72765503,"comment_id":128527350,"body_markdown":"Does this answer your question? [Java stream, get multiple properties from object](https://stackoverflow.com/questions/66457436/java-stream-get-multiple-properties-from-object)","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/66457436/java-stream-get-multiple-properties-from-object\">Java stream, get multiple properties from object</a>"},{"owner":{"account_id":24918196,"reputation":95,"user_id":18786837,"display_name":"it.drive.view"},"score":0,"creation_date":1656314359,"post_id":72765503,"comment_id":128532009,"body_markdown":"@AndreyKotov yes, it is the question.","body":"@AndreyKotov yes, it is the question."}],"answers":[{"tags":[],"owner":{"account_id":23959668,"reputation":26587,"user_id":17949945,"display_name":"Alexander Ivanchenko"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1656286362,"creation_date":1656282692,"answer_id":72765585,"question_id":72765503,"body_markdown":"You can achieve it by using [`flatMap()`](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/stream/Stream.html#flatMap(java.util.function.Function)):\r\n```\r\nAlpha alpha1 = new Alpha(&quot;patrol&quot;, &quot;amazon&quot;);\r\nAlpha alpha2 = new Alpha(&quot;converse&quot;, &quot;funky&quot;);\r\nList&lt;Alpha&gt; list = Arrays.asList(alpha1, alpha2);\r\n    \r\nList&lt;String&gt; collect = list.stream()                               // Stream&lt;Alpha&gt;\r\n    .flatMap(alpha -&gt; Stream.of(alpha.getExp1(), alpha.getExp2())) // Stream&lt;String&gt;\r\n    .collect(Collectors.toList());\r\n        \r\nSystem.out.println(collect);\r\n```\r\n*Output:*\r\n```\r\n[patrol, amazon, converse, funky]\r\n```","title":"Transforming a List of POJO into a List strings based on Two Properties of each object","body":"<p>You can achieve it by using <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/stream/Stream.html#flatMap(java.util.function.Function)\" rel=\"nofollow noreferrer\"><code>flatMap()</code></a>:</p>\n<pre><code>Alpha alpha1 = new Alpha(&quot;patrol&quot;, &quot;amazon&quot;);\nAlpha alpha2 = new Alpha(&quot;converse&quot;, &quot;funky&quot;);\nList&lt;Alpha&gt; list = Arrays.asList(alpha1, alpha2);\n    \nList&lt;String&gt; collect = list.stream()                               // Stream&lt;Alpha&gt;\n    .flatMap(alpha -&gt; Stream.of(alpha.getExp1(), alpha.getExp2())) // Stream&lt;String&gt;\n    .collect(Collectors.toList());\n        \nSystem.out.println(collect);\n</code></pre>\n<p><em>Output:</em></p>\n<pre><code>[patrol, amazon, converse, funky]\n</code></pre>\n"}],"owner":{"account_id":24918196,"reputation":95,"user_id":18786837,"display_name":"it.drive.view"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":44,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":72765585,"answer_count":1,"score":1,"last_activity_date":1656328076,"creation_date":1656281652,"question_id":72765503,"body_markdown":"I have the following POJO:\r\n\r\n    public class Alpha {\r\n    \r\n   \t    String exp1;\r\n    \tString exp2;\r\n    \r\n    \tpublic Alpha(String exp1, String exp2) {\r\n    \t\tsuper();\r\n    \t\tthis.exp1 = exp1;\r\n    \t\tthis.exp2 = exp2;\r\n    \t}\r\n    \r\n    \tpublic String getExp1() {\r\n    \t\treturn exp1;\r\n    \t}\r\n    \r\n    \tpublic String getExp2() {\r\n    \t\treturn exp2;\r\n    \t}\r\n    \r\n    }\r\n\r\nThe `main()` method:\r\n\r\n    public static void main(String[] args) {\r\n    \tSpringApplication.run(Main.class, args);\r\n    \r\n    \tAlpha alpha1 = new Alpha(&quot;patrol&quot;, &quot;amazon&quot;);\r\n    \tAlpha alpha2 = new Alpha(&quot;converse&quot;, &quot;funky&quot;);\r\n    \tList&lt;Alpha&gt; list = Arrays.asList(alpha1, alpha2);\r\n    \r\n    \tList&lt;String&gt; collect = list.stream()\r\n\t\t\t.map(Alpha::getExp1)\r\n\t\t\t.collect(Collectors.toList());\r\n\r\n    \tSystem.out.println(collect);\r\n    \r\n    }\r\n\r\n*It produces the output:*\r\n\r\n    [patrol, converse]\r\n\r\nThe desired output should look like:\r\n\r\n    [patrol, converse, patrol, amazon]\r\n\r\nQuestion is how to obtain with using only a single stream?","title":"Transforming a List of POJO into a List strings based on Two Properties of each object","body":"<p>I have the following POJO:</p>\n<pre><code>public class Alpha {\n\n    String exp1;\n    String exp2;\n\n    public Alpha(String exp1, String exp2) {\n        super();\n        this.exp1 = exp1;\n        this.exp2 = exp2;\n    }\n\n    public String getExp1() {\n        return exp1;\n    }\n\n    public String getExp2() {\n        return exp2;\n    }\n\n}\n</code></pre>\n<p>The <code>main()</code> method:</p>\n<pre><code>public static void main(String[] args) {\n    SpringApplication.run(Main.class, args);\n\n    Alpha alpha1 = new Alpha(&quot;patrol&quot;, &quot;amazon&quot;);\n    Alpha alpha2 = new Alpha(&quot;converse&quot;, &quot;funky&quot;);\n    List&lt;Alpha&gt; list = Arrays.asList(alpha1, alpha2);\n\n    List&lt;String&gt; collect = list.stream()\n        .map(Alpha::getExp1)\n        .collect(Collectors.toList());\n\n    System.out.println(collect);\n\n}\n</code></pre>\n<p><em>It produces the output:</em></p>\n<pre><code>[patrol, converse]\n</code></pre>\n<p>The desired output should look like:</p>\n<pre><code>[patrol, converse, patrol, amazon]\n</code></pre>\n<p>Question is how to obtain with using only a single stream?</p>\n"},{"tags":["java","spring","hibernate","jpa","spring-data-jpa"],"comments":[{"owner":{"account_id":1038596,"reputation":34548,"user_id":1045142,"accept_rate":67,"display_name":"Simon Martinelli"},"score":0,"creation_date":1596012400,"post_id":63149706,"comment_id":111669486,"body_markdown":"Do you see anything in the log? Do you see the executed SQL? How is InjectInventory mapped?","body":"Do you see anything in the log? Do you see the executed SQL? How is InjectInventory mapped?"},{"owner":{"account_id":9840607,"reputation":51,"user_id":7289703,"display_name":"임정묵"},"score":0,"creation_date":1596014310,"post_id":63149706,"comment_id":111670383,"body_markdown":"@Simon Martinelli Execution code and log were added and updated in the body.\n\nAnd if you change the above method to jpa NativeQuery, it does not occur and it is faster from the beginning.\nPlease refer.","body":"@Simon Martinelli Execution code and log were added and updated in the body.  And if you change the above method to jpa NativeQuery, it does not occur and it is faster from the beginning. Please refer."},{"owner":{"account_id":1038596,"reputation":34548,"user_id":1045142,"accept_rate":67,"display_name":"Simon Martinelli"},"score":0,"creation_date":1596018781,"post_id":63149706,"comment_id":111672670,"body_markdown":"What database are you using?","body":"What database are you using?"},{"owner":{"account_id":9840607,"reputation":51,"user_id":7289703,"display_name":"임정묵"},"score":0,"creation_date":1596019300,"post_id":63149706,"comment_id":111672914,"body_markdown":"I use Mysql. The version is 8.0.15.","body":"I use Mysql. The version is 8.0.15."},{"owner":{"account_id":1038596,"reputation":34548,"user_id":1045142,"accept_rate":67,"display_name":"Simon Martinelli"},"score":0,"creation_date":1596022156,"post_id":63149706,"comment_id":111674370,"body_markdown":"If I have a look at the logs I see that the lost time is between 18:01:41.256 and 2020-07-29 18:01:43.993 Can you turn on debug log for web and hibernate","body":"If I have a look at the logs I see that the lost time is between 18:01:41.256 and 2020-07-29 18:01:43.993 Can you turn on debug log for web and hibernate"},{"owner":{"account_id":9840607,"reputation":51,"user_id":7289703,"display_name":"임정묵"},"score":0,"creation_date":1596072355,"post_id":63149706,"comment_id":111696000,"body_markdown":"@Simon Martinelli \nThe log attached to the body is the entire log when the URL is executed.\n\nThere is an additional phenomenon. It only occurs when packaging with a &quot;war&quot; file.\n\n(ex: apply plugin:&#39;war&#39; setting in build.gradle)\n\nAfter changing the settings to build with &quot;jar&quot; and testing again, the above does not occur and it is faster from the beginning.\nIs it a bug? Or is there an option that needs to be modified or added?","body":"@Simon Martinelli  The log attached to the body is the entire log when the URL is executed.  There is an additional phenomenon. It only occurs when packaging with a &quot;war&quot; file.  (ex: apply plugin:&#39;war&#39; setting in build.gradle)  After changing the settings to build with &quot;jar&quot; and testing again, the above does not occur and it is faster from the beginning. Is it a bug? Or is there an option that needs to be modified or added?"},{"owner":{"account_id":1038596,"reputation":34548,"user_id":1045142,"accept_rate":67,"display_name":"Simon Martinelli"},"score":0,"creation_date":1596091516,"post_id":63149706,"comment_id":111700646,"body_markdown":"That&#39;s hard to say. 2.1.12 is a rather old version. Did you try with a more recent version?","body":"That&#39;s hard to say. 2.1.12 is a rather old version. Did you try with a more recent version?"},{"owner":{"account_id":9840607,"reputation":51,"user_id":7289703,"display_name":"임정묵"},"score":0,"creation_date":1596104597,"post_id":63149706,"comment_id":111706827,"body_markdown":"After upgrading to the latest version of Spring Boot (2.3.2-RELEASE), I tested it and the performance improved a little.\n(It has improved from 3 seconds to 2.5 seconds.)\n\nBut it doesn&#39;t seem to be a significant improvement. For reference, the Java version is 1.8.0_252.","body":"After upgrading to the latest version of Spring Boot (2.3.2-RELEASE), I tested it and the performance improved a little. (It has improved from 3 seconds to 2.5 seconds.)  But it doesn&#39;t seem to be a significant improvement. For reference, the Java version is 1.8.0_252."},{"owner":{"account_id":9840607,"reputation":51,"user_id":7289703,"display_name":"임정묵"},"score":1,"creation_date":1596104970,"post_id":63149706,"comment_id":111707004,"body_markdown":"packaging with a &quot;jar&quot; file, the first call speed is 0.3 seconds.","body":"packaging with a &quot;jar&quot; file, the first call speed is 0.3 seconds."}],"owner":{"account_id":9840607,"reputation":51,"user_id":7289703,"display_name":"임정묵"},"comment_count":9,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":814,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1656327796,"creation_date":1596012245,"question_id":63149706,"body_markdown":"When building and running spring boot 2.1.12 using spring data jpa, the first execution speed of jpa related repository code is very slow. (Especially **insert query**)\r\n\r\n```java\r\n@Transaction\r\npublic InjectInventory initInsertInjectInventory() {\r\n    InjectInventory injectInventory = InjectInventory\r\n            .builder()\r\n            .gsn(1)\r\n            .usn(453l)\r\n            .itemId(&quot;1111&quot;)\r\n            .gameItemId(&quot;5000&quot;)\r\n            .status(&quot;N&quot;)\r\n            .inType(2)\r\n            .cdlId(&quot;TESTJMLIMITEM&quot;).build();\r\n\r\n    return injectInventoryRepository.save(injectInventory);\r\n}\r\n```\r\n\r\nWhen I run the above `initInsertInjectInventory()` method for the first time, jpa insert occurs on that table and it is very slow.\r\nIt is not slow to rerun the same method afterwards.\r\n\r\nApplications must continue to scale out or relaunch. So that matters.\r\nI want to get rid of this phenomenon.\r\nWhich part should I check?\r\n\r\n\r\n======================\r\n\r\nexample) \r\n1. Controller code\r\n\r\n~~~java\r\n\r\n@Slf4j\r\n@Controller\r\n@RequestMapping(&quot;/panda&quot;)\r\npublic class TestController {\r\n    .....\r\n    @GetMapping(&quot;/xpi/insert-inject-inventory&quot;)\r\n    @ResponseBody\r\n    public String initInsertInjectInventory() {\r\n        StopWatch sw = new StopWatch();\r\n\r\n        sw.start();\r\n\r\n        testService.initInsertInjectInventory();\r\n        sw.stop();\r\n\r\n\r\n        long totalTimeMillis = sw.getTotalTimeMillis();\r\n        String returnText = &quot;targetTable : inject_inven_ut, totalTimeMillis: &quot; + totalTimeMillis + &quot;ms&quot;;\r\n        return returnText;\r\n    }\r\n}\r\n\r\n~~~\r\n\r\n\r\n\r\n2. Call URL : http://localhost:18060/panda/xpi/insert-inject-inventory\r\n\r\n\r\n3. Log remaining on call (first call, Response time 2734ms)\r\n~~~java\r\n2020-07-29 18:01:41.236  INFO 87633 --- [io-18060-exec-1] .c.core.ContainerBase.[Tomcat].[localhost].[/].log : Initializing Spring DispatcherServlet &#39;dispatcherServlet&#39;\r\n2020-07-29 18:01:41.236  INFO 87633 --- [io-18060-exec-1] work.web.servlet.DispatcherServlet.initServletBean : Initializing Servlet &#39;dispatcherServlet&#39;\r\n2020-07-29 18:01:41.256  INFO 87633 --- [io-18060-exec-1] work.web.servlet.DispatcherServlet.initServletBean : Completed initialization in 20 ms\r\n2020-07-29 18:01:43.993 DEBUG 87633 --- [io-18060-exec-1] org.hibernate.SQL.logStatement                     : \r\n    /* insert io.jmlim.app.panda.application.inventory.domain.InjectInventory\r\n        */ insert \r\n        into\r\n            inject_inven_ut\r\n            (cdl_id, game_item_id, gsn, in_type, item_id, status, usn) \r\n        values\r\n            (?, ?, ?, ?, ?, ?, ?)\r\nHibernate: \r\n    /* insert io.jmlim.app.panda.application.inventory.domain.InjectInventory\r\n        */ insert \r\n        into\r\n            inject_inven_ut\r\n            (cdl_id, game_item_id, gsn, in_type, item_id, status, usn) \r\n        values\r\n            (?, ?, ?, ?, ?, ?, ?)\r\n2020-07-29 18:01:44.023 TRACE 87633 --- [io-18060-exec-1] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [1] as [VARCHAR] - [TESTJMLIMITEM]\r\n2020-07-29 18:01:44.024 TRACE 87633 --- [io-18060-exec-1] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [2] as [VARCHAR] - [5000]\r\n2020-07-29 18:01:44.031 TRACE 87633 --- [io-18060-exec-1] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [3] as [INTEGER] - [1]\r\n2020-07-29 18:01:44.032 TRACE 87633 --- [io-18060-exec-1] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [4] as [INTEGER] - [2]\r\n2020-07-29 18:01:44.032 TRACE 87633 --- [io-18060-exec-1] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [5] as [VARCHAR] - [1111]\r\n2020-07-29 18:01:44.033 TRACE 87633 --- [io-18060-exec-1] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [6] as [VARCHAR] - [N]\r\n2020-07-29 18:01:44.034 TRACE 87633 --- [io-18060-exec-1] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [7] as [BIGINT] - [453]\r\n2020-07-29 18:01:44.079  INFO 87633 --- [io-18060-exec-1] o.h.e.i.StatisticalLoggingSessionEventListener.end : Session Metrics {\r\n    7239652 nanoseconds spent acquiring 1 JDBC connections;\r\n    0 nanoseconds spent releasing 0 JDBC connections;\r\n    26426029 nanoseconds spent preparing 1 JDBC statements;\r\n    6874533 nanoseconds spent executing 1 JDBC statements;\r\n    0 nanoseconds spent executing 0 JDBC batches;\r\n    0 nanoseconds spent performing 0 L2C puts;\r\n    0 nanoseconds spent performing 0 L2C hits;\r\n    0 nanoseconds spent performing 0 L2C misses;\r\n    3823210 nanoseconds spent executing 1 flushes (flushing a total of 1 entities and 0 collections);\r\n    0 nanoseconds spent executing 0 partial-flushes (flushing a total of 0 entities and 0 collections)\r\n}\r\n2020-07-29 18:01:44.102  INFO 87633 --- [io-18060-exec-1] ceptor.JmlimControllerInterceptor.afterCompletion : GET /panda/xpi/insert-inject-inventory (2734ms)\r\n~~~\r\n\r\n\r\n\r\n 4. On the second call (Response time: 60ms)\r\n~~~java\r\n2020-07-29 18:15:28.542 DEBUG 87633 --- [io-18060-exec-4] org.hibernate.SQL.logStatement                     : \r\n    /* insert io.jmlim.app.panda.application.inventory.domain.InjectInventory\r\n        */ insert \r\n        into\r\n            inject_inven_ut\r\n            (cdl_id, game_item_id, gsn, in_type, item_id, status, usn) \r\n        values\r\n            (?, ?, ?, ?, ?, ?, ?)\r\nHibernate: \r\n    /* insert io.jmlim.app.panda.application.inventory.domain.InjectInventory\r\n        */ insert \r\n        into\r\n            inject_inven_ut\r\n            (cdl_id, game_item_id, gsn, in_type, item_id, status, usn) \r\n        values\r\n            (?, ?, ?, ?, ?, ?, ?)\r\n2020-07-29 18:15:28.543 TRACE 87633 --- [io-18060-exec-4] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [1] as [VARCHAR] - [TESTJMLIMITEM]\r\n2020-07-29 18:15:28.544 TRACE 87633 --- [io-18060-exec-4] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [2] as [VARCHAR] - [5000]\r\n2020-07-29 18:15:28.544 TRACE 87633 --- [io-18060-exec-4] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [3] as [INTEGER] - [1]\r\n2020-07-29 18:15:28.544 TRACE 87633 --- [io-18060-exec-4] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [4] as [INTEGER] - [2]\r\n2020-07-29 18:15:28.545 TRACE 87633 --- [io-18060-exec-4] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [5] as [VARCHAR] - [1111]\r\n2020-07-29 18:15:28.545 TRACE 87633 --- [io-18060-exec-4] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [6] as [VARCHAR] - [N]\r\n2020-07-29 18:15:28.545 TRACE 87633 --- [io-18060-exec-4] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [7] as [BIGINT] - [453]\r\n2020-07-29 18:15:28.572  INFO 87633 --- [io-18060-exec-4] o.h.e.i.StatisticalLoggingSessionEventListener.end : Session Metrics {\r\n    7397456 nanoseconds spent acquiring 1 JDBC connections;\r\n    0 nanoseconds spent releasing 0 JDBC connections;\r\n    539633 nanoseconds spent preparing 1 JDBC statements;\r\n    12771277 nanoseconds spent executing 1 JDBC statements;\r\n    0 nanoseconds spent executing 0 JDBC batches;\r\n    0 nanoseconds spent performing 0 L2C puts;\r\n    0 nanoseconds spent performing 0 L2C hits;\r\n    0 nanoseconds spent performing 0 L2C misses;\r\n    223073 nanoseconds spent executing 1 flushes (flushing a total of 1 entities and 0 collections);\r\n    0 nanoseconds spent executing 0 partial-flushes (flushing a total of 0 entities and 0 collections)\r\n}\r\n2020-07-29 18:15:28.576  INFO 87633 --- [io-18060-exec-4] ceptor.SummerControllerInterceptor.afterCompletion : GET /panda/xpi/insert-inject-inventory (60ms)\r\n\r\n~~~\r\n\r\n\r\n### Additional discoveries\r\nThe log attached to the body is the entire log when the URL is executed.\r\n\r\nThere is an additional phenomenon. It only occurs when packaging with a &quot;war&quot; file.\r\n\r\n(ex: apply plugin:&#39;war&#39; setting in build.gradle)\r\n\r\nAfter changing the settings to build with &quot;jar&quot; and testing again, the above does not occur and it is faster from the beginning.\r\nIs it a bug? Or is there an option that needs to be modified or added?\r\n\r\n","title":"It is very slow only when the spring data jpa repository related code is executed for the first time after running the application","body":"<p>When building and running spring boot 2.1.12 using spring data jpa, the first execution speed of jpa related repository code is very slow. (Especially <strong>insert query</strong>)</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Transaction\npublic InjectInventory initInsertInjectInventory() {\n    InjectInventory injectInventory = InjectInventory\n            .builder()\n            .gsn(1)\n            .usn(453l)\n            .itemId(&quot;1111&quot;)\n            .gameItemId(&quot;5000&quot;)\n            .status(&quot;N&quot;)\n            .inType(2)\n            .cdlId(&quot;TESTJMLIMITEM&quot;).build();\n\n    return injectInventoryRepository.save(injectInventory);\n}\n</code></pre>\n<p>When I run the above <code>initInsertInjectInventory()</code> method for the first time, jpa insert occurs on that table and it is very slow.\nIt is not slow to rerun the same method afterwards.</p>\n<p>Applications must continue to scale out or relaunch. So that matters.\nI want to get rid of this phenomenon.\nWhich part should I check?</p>\n<p>======================</p>\n<p>example)</p>\n<ol>\n<li>Controller code</li>\n</ol>\n<pre class=\"lang-java prettyprint-override\"><code>\n@Slf4j\n@Controller\n@RequestMapping(&quot;/panda&quot;)\npublic class TestController {\n    .....\n    @GetMapping(&quot;/xpi/insert-inject-inventory&quot;)\n    @ResponseBody\n    public String initInsertInjectInventory() {\n        StopWatch sw = new StopWatch();\n\n        sw.start();\n\n        testService.initInsertInjectInventory();\n        sw.stop();\n\n\n        long totalTimeMillis = sw.getTotalTimeMillis();\n        String returnText = &quot;targetTable : inject_inven_ut, totalTimeMillis: &quot; + totalTimeMillis + &quot;ms&quot;;\n        return returnText;\n    }\n}\n\n</code></pre>\n<ol start=\"2\">\n<li><p>Call URL : http://localhost:18060/panda/xpi/insert-inject-inventory</p>\n</li>\n<li><p>Log remaining on call (first call, Response time 2734ms)</p>\n</li>\n</ol>\n<pre class=\"lang-java prettyprint-override\"><code>2020-07-29 18:01:41.236  INFO 87633 --- [io-18060-exec-1] .c.core.ContainerBase.[Tomcat].[localhost].[/].log : Initializing Spring DispatcherServlet 'dispatcherServlet'\n2020-07-29 18:01:41.236  INFO 87633 --- [io-18060-exec-1] work.web.servlet.DispatcherServlet.initServletBean : Initializing Servlet 'dispatcherServlet'\n2020-07-29 18:01:41.256  INFO 87633 --- [io-18060-exec-1] work.web.servlet.DispatcherServlet.initServletBean : Completed initialization in 20 ms\n2020-07-29 18:01:43.993 DEBUG 87633 --- [io-18060-exec-1] org.hibernate.SQL.logStatement                     : \n    /* insert io.jmlim.app.panda.application.inventory.domain.InjectInventory\n        */ insert \n        into\n            inject_inven_ut\n            (cdl_id, game_item_id, gsn, in_type, item_id, status, usn) \n        values\n            (?, ?, ?, ?, ?, ?, ?)\nHibernate: \n    /* insert io.jmlim.app.panda.application.inventory.domain.InjectInventory\n        */ insert \n        into\n            inject_inven_ut\n            (cdl_id, game_item_id, gsn, in_type, item_id, status, usn) \n        values\n            (?, ?, ?, ?, ?, ?, ?)\n2020-07-29 18:01:44.023 TRACE 87633 --- [io-18060-exec-1] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [1] as [VARCHAR] - [TESTJMLIMITEM]\n2020-07-29 18:01:44.024 TRACE 87633 --- [io-18060-exec-1] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [2] as [VARCHAR] - [5000]\n2020-07-29 18:01:44.031 TRACE 87633 --- [io-18060-exec-1] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [3] as [INTEGER] - [1]\n2020-07-29 18:01:44.032 TRACE 87633 --- [io-18060-exec-1] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [4] as [INTEGER] - [2]\n2020-07-29 18:01:44.032 TRACE 87633 --- [io-18060-exec-1] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [5] as [VARCHAR] - [1111]\n2020-07-29 18:01:44.033 TRACE 87633 --- [io-18060-exec-1] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [6] as [VARCHAR] - [N]\n2020-07-29 18:01:44.034 TRACE 87633 --- [io-18060-exec-1] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [7] as [BIGINT] - [453]\n2020-07-29 18:01:44.079  INFO 87633 --- [io-18060-exec-1] o.h.e.i.StatisticalLoggingSessionEventListener.end : Session Metrics {\n    7239652 nanoseconds spent acquiring 1 JDBC connections;\n    0 nanoseconds spent releasing 0 JDBC connections;\n    26426029 nanoseconds spent preparing 1 JDBC statements;\n    6874533 nanoseconds spent executing 1 JDBC statements;\n    0 nanoseconds spent executing 0 JDBC batches;\n    0 nanoseconds spent performing 0 L2C puts;\n    0 nanoseconds spent performing 0 L2C hits;\n    0 nanoseconds spent performing 0 L2C misses;\n    3823210 nanoseconds spent executing 1 flushes (flushing a total of 1 entities and 0 collections);\n    0 nanoseconds spent executing 0 partial-flushes (flushing a total of 0 entities and 0 collections)\n}\n2020-07-29 18:01:44.102  INFO 87633 --- [io-18060-exec-1] ceptor.JmlimControllerInterceptor.afterCompletion : GET /panda/xpi/insert-inject-inventory (2734ms)\n</code></pre>\n<ol start=\"4\">\n<li>On the second call (Response time: 60ms)</li>\n</ol>\n<pre class=\"lang-java prettyprint-override\"><code>2020-07-29 18:15:28.542 DEBUG 87633 --- [io-18060-exec-4] org.hibernate.SQL.logStatement                     : \n    /* insert io.jmlim.app.panda.application.inventory.domain.InjectInventory\n        */ insert \n        into\n            inject_inven_ut\n            (cdl_id, game_item_id, gsn, in_type, item_id, status, usn) \n        values\n            (?, ?, ?, ?, ?, ?, ?)\nHibernate: \n    /* insert io.jmlim.app.panda.application.inventory.domain.InjectInventory\n        */ insert \n        into\n            inject_inven_ut\n            (cdl_id, game_item_id, gsn, in_type, item_id, status, usn) \n        values\n            (?, ?, ?, ?, ?, ?, ?)\n2020-07-29 18:15:28.543 TRACE 87633 --- [io-18060-exec-4] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [1] as [VARCHAR] - [TESTJMLIMITEM]\n2020-07-29 18:15:28.544 TRACE 87633 --- [io-18060-exec-4] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [2] as [VARCHAR] - [5000]\n2020-07-29 18:15:28.544 TRACE 87633 --- [io-18060-exec-4] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [3] as [INTEGER] - [1]\n2020-07-29 18:15:28.544 TRACE 87633 --- [io-18060-exec-4] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [4] as [INTEGER] - [2]\n2020-07-29 18:15:28.545 TRACE 87633 --- [io-18060-exec-4] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [5] as [VARCHAR] - [1111]\n2020-07-29 18:15:28.545 TRACE 87633 --- [io-18060-exec-4] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [6] as [VARCHAR] - [N]\n2020-07-29 18:15:28.545 TRACE 87633 --- [io-18060-exec-4] org.hibernate.type.descriptor.sql.BasicBinder.bind : binding parameter [7] as [BIGINT] - [453]\n2020-07-29 18:15:28.572  INFO 87633 --- [io-18060-exec-4] o.h.e.i.StatisticalLoggingSessionEventListener.end : Session Metrics {\n    7397456 nanoseconds spent acquiring 1 JDBC connections;\n    0 nanoseconds spent releasing 0 JDBC connections;\n    539633 nanoseconds spent preparing 1 JDBC statements;\n    12771277 nanoseconds spent executing 1 JDBC statements;\n    0 nanoseconds spent executing 0 JDBC batches;\n    0 nanoseconds spent performing 0 L2C puts;\n    0 nanoseconds spent performing 0 L2C hits;\n    0 nanoseconds spent performing 0 L2C misses;\n    223073 nanoseconds spent executing 1 flushes (flushing a total of 1 entities and 0 collections);\n    0 nanoseconds spent executing 0 partial-flushes (flushing a total of 0 entities and 0 collections)\n}\n2020-07-29 18:15:28.576  INFO 87633 --- [io-18060-exec-4] ceptor.SummerControllerInterceptor.afterCompletion : GET /panda/xpi/insert-inject-inventory (60ms)\n\n</code></pre>\n<h3>Additional discoveries</h3>\n<p>The log attached to the body is the entire log when the URL is executed.</p>\n<p>There is an additional phenomenon. It only occurs when packaging with a &quot;war&quot; file.</p>\n<p>(ex: apply plugin:'war' setting in build.gradle)</p>\n<p>After changing the settings to build with &quot;jar&quot; and testing again, the above does not occur and it is faster from the beginning.\nIs it a bug? Or is there an option that needs to be modified or added?</p>\n"},{"tags":["java","serialization","gson"],"comments":[{"owner":{"account_id":6737779,"reputation":3295,"user_id":5191913,"accept_rate":67,"display_name":"Savior"},"score":0,"creation_date":1606314094,"post_id":65006496,"comment_id":114927117,"body_markdown":"In your 2nd snippet, you&#39;ve told Gson to interpret the JSON as `Object`. How do you think it should know that it should actually deserialize into a `LogisticService`?","body":"In your 2nd snippet, you&#39;ve told Gson to interpret the JSON as <code>Object</code>. How do you think it should know that it should actually deserialize into a <code>LogisticService</code>?"},{"owner":{"account_id":3140433,"reputation":1296,"user_id":2655988,"accept_rate":30,"display_name":"Nishit"},"score":0,"creation_date":1606314201,"post_id":65006496,"comment_id":114927165,"body_markdown":"@Savior The map we have is of type Map&lt;EventContext.Key, Object&gt;.","body":"@Savior The map we have is of type Map&lt;EventContext.Key, Object&gt;."},{"owner":{"account_id":6737779,"reputation":3295,"user_id":5191913,"accept_rate":67,"display_name":"Savior"},"score":2,"creation_date":1606314249,"post_id":65006496,"comment_id":114927192,"body_markdown":"Right, so it knows how to deserialize the JSON names as `Key` objects. But all it knows about the values is that they should be `Object`.","body":"Right, so it knows how to deserialize the JSON names as <code>Key</code> objects. But all it knows about the values is that they should be <code>Object</code>."},{"owner":{"account_id":3140433,"reputation":1296,"user_id":2655988,"accept_rate":30,"display_name":"Nishit"},"score":0,"creation_date":1606318311,"post_id":65006496,"comment_id":114929372,"body_markdown":"@Savior We have another piece of code where the same Map is being deserialized and I am able to fetch the object from it and cast it into `LogisticService`\nOnly difference is we are using Jackson serializer there compared to GSON in this case.","body":"@Savior We have another piece of code where the same Map is being deserialized and I am able to fetch the object from it and cast it into <code>LogisticService</code> Only difference is we are using Jackson serializer there compared to GSON in this case."},{"owner":{"account_id":6737779,"reputation":3295,"user_id":5191913,"accept_rate":67,"display_name":"Savior"},"score":1,"creation_date":1606318391,"post_id":65006496,"comment_id":114929425,"body_markdown":"I don&#39;t believe it. By the way, the first case output is `null`, because the name in the JSON is deserialized as a Java `String` (the key of the map).","body":"I don&#39;t believe it. By the way, the first case output is <code>null</code>, because the name in the JSON is deserialized as a Java <code>String</code> (the key of the map)."},{"owner":{"account_id":6737779,"reputation":3295,"user_id":5191913,"accept_rate":67,"display_name":"Savior"},"score":0,"creation_date":1606318422,"post_id":65006496,"comment_id":114929447,"body_markdown":"It&#39;s weird that you&#39;re using 2 different JSON parsers. If (you think) it works with Jackson, use Jackson.","body":"It&#39;s weird that you&#39;re using 2 different JSON parsers. If (you think) it works with Jackson, use Jackson."},{"owner":{"account_id":3140433,"reputation":1296,"user_id":2655988,"accept_rate":30,"display_name":"Nishit"},"score":0,"creation_date":1606318579,"post_id":65006496,"comment_id":114929542,"body_markdown":"We are trying to migrate everything to GSON.","body":"We are trying to migrate everything to GSON."},{"owner":{"account_id":6737779,"reputation":3295,"user_id":5191913,"accept_rate":67,"display_name":"Savior"},"score":0,"creation_date":1606318809,"post_id":65006496,"comment_id":114929678,"body_markdown":"I don&#39;t know what else to tell you then. The reasons are in my previous comments. With `HashMap.class`, Gson has to guess what types to store. For JSON strings, it uses Java Strings. For JSON objects, it uses `LinkedTreeMap`. With the `TypeToken` and `Object`, it again has to guess. For JSON objects, it again uses `LinkedTreeMap`. If you can&#39;t provide a custom class and have to use a `Map`, consider writing a custom deserializer.","body":"I don&#39;t know what else to tell you then. The reasons are in my previous comments. With <code>HashMap.class</code>, Gson has to guess what types to store. For JSON strings, it uses Java Strings. For JSON objects, it uses <code>LinkedTreeMap</code>. With the <code>TypeToken</code> and <code>Object</code>, it again has to guess. For JSON objects, it again uses <code>LinkedTreeMap</code>. If you can&#39;t provide a custom class and have to use a <code>Map</code>, consider writing a custom deserializer."}],"answers":[{"tags":[],"owner":{"account_id":5384013,"reputation":6035,"user_id":4288506,"accept_rate":77,"display_name":"Marcono1234"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656327569,"creation_date":1606340371,"answer_id":65013074,"question_id":65006496,"body_markdown":"As pointed out in the comments, when you deserialize `HashMap.class` or `TypeToken&lt;Map&lt;EventContext.Key, Object&gt;&gt;` Gson cannot know which value types you expect. Instead it sees that the data contains a JSON object and deserializes it as Java `Map` by default (Gson&#39;s internal `Map` implementation is `LinkedTreeMap`).\r\n\r\nSince it looks like you are dealing with a heterogenous map you need to take an alternative approach. The following solutions all have their advantages and disadvantages and it depends on your use case which one fits best.\r\n\r\n### Separate model class\r\n\r\nYou could create a separate class to model the `Map`, e.g.:\r\n```java\r\nclass EventData {\r\n    // Use Gson&#39;s @SerializedName annotation to not use the field name\r\n    @SerializedName(&quot;LOGISTIC_SERVICE&quot;)\r\n    public LogisticService logisticService;\r\n}\r\n\r\nGson gson = new Gson();\r\nEventData eventData = gson.fromJson(EventData.class);\r\nLogisticService logisticService = eventData.logisticService;\r\n```\r\n\r\nThis solution is probably the easiest one. The disadvantage is that you cannot preserve any JSON object members which are not part modelled as fields of your model class.\r\n\r\n### Parsing to DOM, then parsing desired member\r\n\r\nYou could first deserialize the JSON data as a [`JsonObject`](https://javadoc.io/doc/com.google.code.gson/gson/latest/com.google.gson/com/google/gson/JsonObject.html), which is Gson&#39;s class representing the JSON document tree. This can for example be done with [`JsonParser`](https://javadoc.io/doc/com.google.code.gson/gson/latest/com.google.gson/com/google/gson/JsonParser.html). Afterwards you use `JsonObject.getAsJsonObject(String)` to extract the relevant member and deserialize it with `Gson.fromJson(JsonElement, ...)`.\r\n\r\nThe advantage is that this allows you to access other members from that `JsonObject` as well, for example if they are needed at a later stage. However, the disadvantage is that this requires more memory because it has to hold the complete JSON document as `JsonObject` in memory, but depending on your use case or your data that might be negligible.\r\n\r\n### Using `JsonReader`\r\n\r\nOne solution could be to directly use a [`JsonReader`](https://javadoc.io/doc/com.google.code.gson/gson/latest/com.google.gson/com/google/gson/stream/JsonReader.html) and then depending on the JSON object member names parse them respectively:\r\n```java\r\nGson gson = new Gson();\r\nLogisticService logisticService = null;\r\n\r\nJsonReader jsonReader = new JsonReader(json);\r\njsonReader.beginObject();\r\nwhile (jsonReader.hasNext()) {\r\n    String name = jsonReader.nextName();\r\n    if (name.equals(EventContext.Key.LOGISTIC_SERVICE.name()) {\r\n        if (logisticService != null) {\r\n            // Duplicate member -&gt; malicious or malformed JSON, throw exception\r\n            ...\r\n        }\r\n        logisticService = gson.fromJson(jsonReader, LogisticService.class);\r\n    }\r\n    else {\r\n        // Skip value or parse it in a different way\r\n        jsonReader.skipValue();\r\n    }\r\n}\r\njsonReader.endObject();\r\n```\r\nOr when this data is part of a larger JSON document you can also put this code into a [`TypeAdapterFactory`](https://javadoc.io/doc/com.google.code.gson/gson/latest/com.google.gson/com/google/gson/TypeAdapterFactory.html) and create the `Gson` instance using a `GsonBuilder` on which you [registered](https://javadoc.io/doc/com.google.code.gson/gson/latest/com.google.gson/com/google/gson/GsonBuilder.html#registerTypeAdapterFactory(com.google.gson.TypeAdapterFactory)) the factory.\r\n","title":"GSON Deserialize Map of Custom Object","body":"<p>As pointed out in the comments, when you deserialize <code>HashMap.class</code> or <code>TypeToken&lt;Map&lt;EventContext.Key, Object&gt;&gt;</code> Gson cannot know which value types you expect. Instead it sees that the data contains a JSON object and deserializes it as Java <code>Map</code> by default (Gson's internal <code>Map</code> implementation is <code>LinkedTreeMap</code>).</p>\n<p>Since it looks like you are dealing with a heterogenous map you need to take an alternative approach. The following solutions all have their advantages and disadvantages and it depends on your use case which one fits best.</p>\n<h3>Separate model class</h3>\n<p>You could create a separate class to model the <code>Map</code>, e.g.:</p>\n<pre class=\"lang-java prettyprint-override\"><code>class EventData {\n    // Use Gson's @SerializedName annotation to not use the field name\n    @SerializedName(&quot;LOGISTIC_SERVICE&quot;)\n    public LogisticService logisticService;\n}\n\nGson gson = new Gson();\nEventData eventData = gson.fromJson(EventData.class);\nLogisticService logisticService = eventData.logisticService;\n</code></pre>\n<p>This solution is probably the easiest one. The disadvantage is that you cannot preserve any JSON object members which are not part modelled as fields of your model class.</p>\n<h3>Parsing to DOM, then parsing desired member</h3>\n<p>You could first deserialize the JSON data as a <a href=\"https://javadoc.io/doc/com.google.code.gson/gson/latest/com.google.gson/com/google/gson/JsonObject.html\" rel=\"nofollow noreferrer\"><code>JsonObject</code></a>, which is Gson's class representing the JSON document tree. This can for example be done with <a href=\"https://javadoc.io/doc/com.google.code.gson/gson/latest/com.google.gson/com/google/gson/JsonParser.html\" rel=\"nofollow noreferrer\"><code>JsonParser</code></a>. Afterwards you use <code>JsonObject.getAsJsonObject(String)</code> to extract the relevant member and deserialize it with <code>Gson.fromJson(JsonElement, ...)</code>.</p>\n<p>The advantage is that this allows you to access other members from that <code>JsonObject</code> as well, for example if they are needed at a later stage. However, the disadvantage is that this requires more memory because it has to hold the complete JSON document as <code>JsonObject</code> in memory, but depending on your use case or your data that might be negligible.</p>\n<h3>Using <code>JsonReader</code></h3>\n<p>One solution could be to directly use a <a href=\"https://javadoc.io/doc/com.google.code.gson/gson/latest/com.google.gson/com/google/gson/stream/JsonReader.html\" rel=\"nofollow noreferrer\"><code>JsonReader</code></a> and then depending on the JSON object member names parse them respectively:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Gson gson = new Gson();\nLogisticService logisticService = null;\n\nJsonReader jsonReader = new JsonReader(json);\njsonReader.beginObject();\nwhile (jsonReader.hasNext()) {\n    String name = jsonReader.nextName();\n    if (name.equals(EventContext.Key.LOGISTIC_SERVICE.name()) {\n        if (logisticService != null) {\n            // Duplicate member -&gt; malicious or malformed JSON, throw exception\n            ...\n        }\n        logisticService = gson.fromJson(jsonReader, LogisticService.class);\n    }\n    else {\n        // Skip value or parse it in a different way\n        jsonReader.skipValue();\n    }\n}\njsonReader.endObject();\n</code></pre>\n<p>Or when this data is part of a larger JSON document you can also put this code into a <a href=\"https://javadoc.io/doc/com.google.code.gson/gson/latest/com.google.gson/com/google/gson/TypeAdapterFactory.html\" rel=\"nofollow noreferrer\"><code>TypeAdapterFactory</code></a> and create the <code>Gson</code> instance using a <code>GsonBuilder</code> on which you <a href=\"https://javadoc.io/doc/com.google.code.gson/gson/latest/com.google.gson/com/google/gson/GsonBuilder.html#registerTypeAdapterFactory(com.google.gson.TypeAdapterFactory)\" rel=\"nofollow noreferrer\">registered</a> the factory.</p>\n"}],"owner":{"account_id":3140433,"reputation":1296,"user_id":2655988,"accept_rate":30,"display_name":"Nishit"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":811,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":1,"score":0,"last_activity_date":1656327569,"creation_date":1606313904,"question_id":65006496,"body_markdown":"I am trying to deserialize a Map&lt;EventContext.Key, Object&gt; using GSON. \r\n\r\nI initially tried to deserialize by\r\n\r\n        System.out.println(eventContextMapSerialized);\r\n        Map&lt;EventContext.Key, Object&gt; deserializedMap = gson.fromJson(eventContextMapSerialized, HashMap.class);\r\n        LogisticService logisticService = (LogisticService) deserializedMap.get(EventContext.Key.LOGISTIC_SERVICE);\r\n        System.out.println(deserializedMap.get(EventContext.Key.LOGISTIC_SERVICE));\r\n        System.out.println(logisticService);\r\n\r\nThis gave me the output\r\n\r\n    [junit] {&quot;LOGISTIC_SERVICE&quot;:{&quot;serviceId&quot;:&quot;dummy_id&quot;,&quot;serviceVersion&quot;:1,&quot;serviceProviderRefId&quot;:{&quot;id&quot;:&quot;dummy_id&quot;},&quot;contract&quot;:{&quot;invoiceCreator&quot;:&quot;USPS&quot;,&quot;maxDaysToReceiveInvoice&quot;:180},&quot;cancelled&quot;:false,&quot;serviceConsumer&quot;:{&quot;id&quot;:&quot;SERVICE_CONSUMER_ID_1&quot;},&quot;serviceProvider&quot;:{&quot;id&quot;:&quot;USPS&quot;},&quot;plannedServiceTimePeriod&quot;:{&quot;startTime&quot;:&quot;Jan 1, 1970 5:30:00 AM&quot;},&quot;planner&quot;:&quot;ATROPS&quot;},&quot;PLATFORM_SERVICE_ID&quot;:&quot;TestPlatformServiceId&quot;}\r\n    [junit] null\r\n    [junit] null\r\n\r\nSo, even though the serialized string contains object of type LogisticService, when I try to fetch it, I get null. \r\n\r\nHence, I tried to use the overloaded method of `fromJson` which takes a Type as an argument.\r\n\r\n        Type type = new TypeToken&lt;Map&lt;EventContext.Key, Object&gt;&gt;(){}.getType();\r\n        Map&lt;EventContext.Key, Object&gt; eventContextMapDeserialized = gson.fromJson(eventContextMapSerialized, type);\r\n        System.out.println(&quot;Event Context Map Deserialized is : &quot; + eventContextMapDeserialized);\r\n\r\n        System.out.println(eventContextMapDeserialized.get(EventContext.Key.LOGISTIC_SERVICE).getClass());\r\n        LogisticService logisticServiceFromMap = (LogisticService) eventContextMapDeserialized.get(EventContext.Key.LOGISTIC_SERVICE);\r\n        System.out.println(&quot;Logistic Service from Event Context Map : &quot; + logisticServiceFromMap);\r\n        System.out.println(&quot;Direct Logistic Service : &quot; + eventContextDeserialized.get(EventContext.Key.LOGISTIC_SERVICE));\r\n\r\nwhich gave the output, \r\n\r\n\r\n    [junit] Event Context Map Deserialized is : {LOGISTIC_SERVICE={serviceId=dummy_id, serviceVersion=1.0, serviceProviderRefId={id=dummy_id}, contract={invoiceCreator=USPS, maxDaysToReceiveInvoice=180.0}, cancelled=false, serviceConsumer={id=SERVICE_CONSUMER_ID_1}, serviceProvider={id=USPS}, plannedServiceTimePeriod={startTime=Jan 1, 1970 5:30:00 AM}, planner=ATROPS}, PLATFORM_SERVICE_ID=TestPlatformServiceId}\r\n    [junit] class com.google.gson.internal.LinkedTreeMap\r\n    [junit] Testcase: testPayloadDeserialize took 10.812 sec\r\n    [junit] \tCaused an ERROR\r\n    [junit] com.google.gson.internal.LinkedTreeMap cannot be cast to com.amazon.transportation.tfs.contapservice.sdk.model.LogisticService\r\n    [junit] java.lang.ClassCastException: com.google.gson.internal.LinkedTreeMap cannot be cast to com.amazon.transportation.tfs.contapservice.sdk.model.LogisticService\r\n\r\n\r\nBasically, blowing up where I try to cast \r\n\r\n`(LogisticService) eventContextMapDeserialized.get(EventContext.Key.LOGISTIC_SERVICE);`\r\n\r\nI am not able to figure out why in 1st case output is Null and in 2nd case even after giving the type, it is still crashing.","title":"GSON Deserialize Map of Custom Object","body":"<p>I am trying to deserialize a Map&lt;EventContext.Key, Object&gt; using GSON.</p>\n<p>I initially tried to deserialize by</p>\n<pre><code>    System.out.println(eventContextMapSerialized);\n    Map&lt;EventContext.Key, Object&gt; deserializedMap = gson.fromJson(eventContextMapSerialized, HashMap.class);\n    LogisticService logisticService = (LogisticService) deserializedMap.get(EventContext.Key.LOGISTIC_SERVICE);\n    System.out.println(deserializedMap.get(EventContext.Key.LOGISTIC_SERVICE));\n    System.out.println(logisticService);\n</code></pre>\n<p>This gave me the output</p>\n<pre><code>[junit] {&quot;LOGISTIC_SERVICE&quot;:{&quot;serviceId&quot;:&quot;dummy_id&quot;,&quot;serviceVersion&quot;:1,&quot;serviceProviderRefId&quot;:{&quot;id&quot;:&quot;dummy_id&quot;},&quot;contract&quot;:{&quot;invoiceCreator&quot;:&quot;USPS&quot;,&quot;maxDaysToReceiveInvoice&quot;:180},&quot;cancelled&quot;:false,&quot;serviceConsumer&quot;:{&quot;id&quot;:&quot;SERVICE_CONSUMER_ID_1&quot;},&quot;serviceProvider&quot;:{&quot;id&quot;:&quot;USPS&quot;},&quot;plannedServiceTimePeriod&quot;:{&quot;startTime&quot;:&quot;Jan 1, 1970 5:30:00 AM&quot;},&quot;planner&quot;:&quot;ATROPS&quot;},&quot;PLATFORM_SERVICE_ID&quot;:&quot;TestPlatformServiceId&quot;}\n[junit] null\n[junit] null\n</code></pre>\n<p>So, even though the serialized string contains object of type LogisticService, when I try to fetch it, I get null.</p>\n<p>Hence, I tried to use the overloaded method of <code>fromJson</code> which takes a Type as an argument.</p>\n<pre><code>    Type type = new TypeToken&lt;Map&lt;EventContext.Key, Object&gt;&gt;(){}.getType();\n    Map&lt;EventContext.Key, Object&gt; eventContextMapDeserialized = gson.fromJson(eventContextMapSerialized, type);\n    System.out.println(&quot;Event Context Map Deserialized is : &quot; + eventContextMapDeserialized);\n\n    System.out.println(eventContextMapDeserialized.get(EventContext.Key.LOGISTIC_SERVICE).getClass());\n    LogisticService logisticServiceFromMap = (LogisticService) eventContextMapDeserialized.get(EventContext.Key.LOGISTIC_SERVICE);\n    System.out.println(&quot;Logistic Service from Event Context Map : &quot; + logisticServiceFromMap);\n    System.out.println(&quot;Direct Logistic Service : &quot; + eventContextDeserialized.get(EventContext.Key.LOGISTIC_SERVICE));\n</code></pre>\n<p>which gave the output,</p>\n<pre><code>[junit] Event Context Map Deserialized is : {LOGISTIC_SERVICE={serviceId=dummy_id, serviceVersion=1.0, serviceProviderRefId={id=dummy_id}, contract={invoiceCreator=USPS, maxDaysToReceiveInvoice=180.0}, cancelled=false, serviceConsumer={id=SERVICE_CONSUMER_ID_1}, serviceProvider={id=USPS}, plannedServiceTimePeriod={startTime=Jan 1, 1970 5:30:00 AM}, planner=ATROPS}, PLATFORM_SERVICE_ID=TestPlatformServiceId}\n[junit] class com.google.gson.internal.LinkedTreeMap\n[junit] Testcase: testPayloadDeserialize took 10.812 sec\n[junit]     Caused an ERROR\n[junit] com.google.gson.internal.LinkedTreeMap cannot be cast to com.amazon.transportation.tfs.contapservice.sdk.model.LogisticService\n[junit] java.lang.ClassCastException: com.google.gson.internal.LinkedTreeMap cannot be cast to com.amazon.transportation.tfs.contapservice.sdk.model.LogisticService\n</code></pre>\n<p>Basically, blowing up where I try to cast</p>\n<p><code>(LogisticService) eventContextMapDeserialized.get(EventContext.Key.LOGISTIC_SERVICE);</code></p>\n<p>I am not able to figure out why in 1st case output is Null and in 2nd case even after giving the type, it is still crashing.</p>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":8532578,"reputation":39898,"user_id":6395627,"display_name":"Slaw"},"score":0,"creation_date":1656337177,"post_id":72770520,"comment_id":128540227,"body_markdown":"Using a `FileOutputStream` and a `FileWriter`? A specific format is not an inherent aspect of those classes. **You** need to call the appropriate methods, with the appropriate arguments, in the appropriate order. For every article, you&#39;d print the code, then a semicolon, then the name, then another semicolon, then the price, then another semicolon, and finally a newline character. You can modify that algorithm to add spaces after a semicolon and, based on your example output, an extra newline character between articles.","body":"Using a <code>FileOutputStream</code> and a <code>FileWriter</code>? A specific format is not an inherent aspect of those classes. <b>You</b> need to call the appropriate methods, with the appropriate arguments, in the appropriate order. For every article, you&#39;d print the code, then a semicolon, then the name, then another semicolon, then the price, then another semicolon, and finally a newline character. You can modify that algorithm to add spaces after a semicolon and, based on your example output, an extra newline character between articles."},{"owner":{"account_id":8532578,"reputation":39898,"user_id":6395627,"display_name":"Slaw"},"score":0,"creation_date":1656337241,"post_id":72770520,"comment_id":128540254,"body_markdown":"However, if you want to use a common format, such as JSON, XML, CSV, and so on, then there is likely a library out there that can handle converting POJOs into the appropriate output for you (and vice versa). Note your format is essentially a CSV file but using semicolons as the delimiter instead of commas.","body":"However, if you want to use a common format, such as JSON, XML, CSV, and so on, then there is likely a library out there that can handle converting POJOs into the appropriate output for you (and vice versa). Note your format is essentially a CSV file but using semicolons as the delimiter instead of commas."},{"owner":{"account_id":10759610,"reputation":12628,"user_id":7916438,"display_name":"tevemadar"},"score":0,"creation_date":1657111191,"post_id":72770520,"comment_id":128731160,"body_markdown":"Are you looking for `+`? If `something` is an `Artical`, `something.getCodeOfArtical()+&quot;; &quot;+something.getNameOfArtical()+&quot;; &quot;+something.getPriceOfArtical()` will create such line for you.","body":"Are you looking for <code>+</code>? If <code>something</code> is an <code>Artical</code>, <code>something.getCodeOfArtical()+&quot;; &quot;+something.getNameOfArtical()+&quot;; &quot;+something.getPriceOfArtical()</code> will create such line for you."}],"answers":[{"tags":[],"owner":{"account_id":3498606,"reputation":5166,"user_id":2925962,"accept_rate":0,"display_name":"akortex"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656327367,"creation_date":1656327367,"answer_id":72770947,"question_id":72770520,"body_markdown":"A very naive implementation can be the following:\r\n\r\n 1. Create a class that in turn creates a `CSVWriter` (assuming you want to write to a CSV). That class will expose a public method allowing you to pass in a path where the desired csv file lives as well as the `Artical` object you want to write to this file. Using that class you will format your data and write them to the file. An example of this could be:\r\n\r\n```java\r\n\r\npublic class CsvWriter {\r\n\r\n    private static final Object LOCK = new Object();\r\n\r\n    private static CsvWriter writer;\r\n\r\n    private CsvWriter() {}\r\n\r\n    public static CsvWriter getInstance() {\r\n        synchronized (LOCK) {\r\n            if (null == writer) {\r\n                writer = new CsvWriter();\r\n            }\r\n            return writer;\r\n        }\r\n    }\r\n\r\n    public void writeCsv(String filePath, Artical content) throws IOException {\r\n        try (var writer = createWriter(filePath)) {\r\n            writer.append(getDataline(content)).append(&quot;\\n&quot;);\r\n        }\r\n    }\r\n\r\n    private String getDataline(Artical content) {\r\n        return String.join(&quot;,&quot;, content.getCode(), content.getName(), Double.toString(content.getPrice()));\r\n    }\r\n\r\n    private PrintWriter createWriter(String stringPath) throws IOException {\r\n        var path = Paths.get(stringPath);\r\n        try {\r\n            if (Files.exists(path)) {\r\n                System.out.printf(&quot;File under path %s exists. Will append to it%n&quot;, stringPath);\r\n                return new PrintWriter(new FileWriter(path.toFile(), true));\r\n            }\r\n            return new PrintWriter(path.toFile());\r\n        } catch (Exception e) {\r\n            System.out.println(&quot;An error has occurred while writing to a file&quot;);\r\n            throw e;\r\n        }\r\n    }\r\n\r\n}\r\n\r\n```\r\n\r\nNote that this will take into account where the file provided is already in place (thus appending to it). In any other case the file will be created and written to directly.\r\n\r\n 1. Call this write method in a fashion similar to this:\r\n\r\n```java\r\npublic static void main(String... args) throws IOException {\r\n    var artical = new Artical(&quot;1&quot;, &quot;Test&quot;, 10.10);\r\n    CsvWriter.getInstance().writeCsv(&quot;/tmp/test1.csv&quot;, artical);\r\n    var artical2 = new Artical(&quot;2&quot;, &quot;Test&quot;, 11.14);\r\n    CsvWriter.getInstance().writeCsv(&quot;/tmp/test1.csv&quot;, artical2);\r\n}\r\n```\r\n\r\nWith that as a starting point you can go ahead and modify the code to be able to handle list of `Artical` objects. \r\n\r\nIf you really need to support CSV files though I would strongly recommend into looking at the various CSV related libraries that are out there instead of implementing your own code.","title":"How to write data in file in specific format with FileOutputStream and PrintWriter","body":"<p>A very naive implementation can be the following:</p>\n<ol>\n<li>Create a class that in turn creates a <code>CSVWriter</code> (assuming you want to write to a CSV). That class will expose a public method allowing you to pass in a path where the desired csv file lives as well as the <code>Artical</code> object you want to write to this file. Using that class you will format your data and write them to the file. An example of this could be:</li>\n</ol>\n<pre class=\"lang-java prettyprint-override\"><code>\npublic class CsvWriter {\n\n    private static final Object LOCK = new Object();\n\n    private static CsvWriter writer;\n\n    private CsvWriter() {}\n\n    public static CsvWriter getInstance() {\n        synchronized (LOCK) {\n            if (null == writer) {\n                writer = new CsvWriter();\n            }\n            return writer;\n        }\n    }\n\n    public void writeCsv(String filePath, Artical content) throws IOException {\n        try (var writer = createWriter(filePath)) {\n            writer.append(getDataline(content)).append(&quot;\\n&quot;);\n        }\n    }\n\n    private String getDataline(Artical content) {\n        return String.join(&quot;,&quot;, content.getCode(), content.getName(), Double.toString(content.getPrice()));\n    }\n\n    private PrintWriter createWriter(String stringPath) throws IOException {\n        var path = Paths.get(stringPath);\n        try {\n            if (Files.exists(path)) {\n                System.out.printf(&quot;File under path %s exists. Will append to it%n&quot;, stringPath);\n                return new PrintWriter(new FileWriter(path.toFile(), true));\n            }\n            return new PrintWriter(path.toFile());\n        } catch (Exception e) {\n            System.out.println(&quot;An error has occurred while writing to a file&quot;);\n            throw e;\n        }\n    }\n\n}\n\n</code></pre>\n<p>Note that this will take into account where the file provided is already in place (thus appending to it). In any other case the file will be created and written to directly.</p>\n<ol>\n<li>Call this write method in a fashion similar to this:</li>\n</ol>\n<pre class=\"lang-java prettyprint-override\"><code>public static void main(String... args) throws IOException {\n    var artical = new Artical(&quot;1&quot;, &quot;Test&quot;, 10.10);\n    CsvWriter.getInstance().writeCsv(&quot;/tmp/test1.csv&quot;, artical);\n    var artical2 = new Artical(&quot;2&quot;, &quot;Test&quot;, 11.14);\n    CsvWriter.getInstance().writeCsv(&quot;/tmp/test1.csv&quot;, artical2);\n}\n</code></pre>\n<p>With that as a starting point you can go ahead and modify the code to be able to handle list of <code>Artical</code> objects.</p>\n<p>If you really need to support CSV files though I would strongly recommend into looking at the various CSV related libraries that are out there instead of implementing your own code.</p>\n"}],"owner":{"account_id":25026694,"reputation":1,"user_id":18884832,"display_name":"pegasus"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":106,"favorite_count":0,"down_vote_count":4,"up_vote_count":0,"answer_count":1,"score":-4,"last_activity_date":1656327367,"creation_date":1656325443,"question_id":72770520,"body_markdown":"I have class Artical:\r\n\r\nfirst variable is code of artical, second variable is name of article and third is price of article.\r\n\r\n\r\n    public class Artical {\r\n        private final String codeOfArtical;\r\n        private final String nameOfArtical;\r\n        private double priceOfArtical;\r\n    \r\n        public Artical(String codeOfArtical, String nameOfArtical, double priceOfArtical) {\r\n            this.codeOfArtical= codeOfArtical;\r\n            this.nameOfArtical= nameOfArtical;\r\n            this.priceOfArtical= priceOfArtical;\r\n        }\r\n       public void setPriceOfArtical(double priceOfArtical) {\r\n            this.priceOfArtical= priceOfArtical;\r\n        }\r\n    \r\n        public String getCodeOfArtical() {\r\n            return codeOfArtical;\r\n        }\r\n    \r\n        public String getNameOfArtical() {\r\n            return nameOfArtical;\r\n        }\r\n    \r\n        public double getPriceOfArtical() {\r\n            return priceOfArtical;\r\n        }\r\n                \r\n    }\r\n\r\nI want in main class to write something like:\r\n\r\n    Artical a1 = new Artical(&quot;841740102156&quot;, &quot;LG Monitor&quot;, 600.00);\r\n    new ShowArticalClass(a1).do();\r\n    new WriteArticalInFileClass(new File(&quot;baza.csv&quot;), a1).do();\r\n\r\nso that data in file will be written in format like this:\r\n\r\n```\r\n841740102156; Monitor LG; 600.00;\r\n\r\n914918414989; Intel CPU; 250.00;\r\n```\r\n\r\n* Those 2 classes ShowArticalClass and WriteArticalInFileClass arent important, those are abstract classes.*\r\n\r\nSo my question is: How do I set **format** to look like this, where every line is new Artical.\r\n\r\n","title":"How to write data in file in specific format with FileOutputStream and PrintWriter","body":"<p>I have class Artical:</p>\n<p>first variable is code of artical, second variable is name of article and third is price of article.</p>\n<pre><code>public class Artical {\n    private final String codeOfArtical;\n    private final String nameOfArtical;\n    private double priceOfArtical;\n\n    public Artical(String codeOfArtical, String nameOfArtical, double priceOfArtical) {\n        this.codeOfArtical= codeOfArtical;\n        this.nameOfArtical= nameOfArtical;\n        this.priceOfArtical= priceOfArtical;\n    }\n   public void setPriceOfArtical(double priceOfArtical) {\n        this.priceOfArtical= priceOfArtical;\n    }\n\n    public String getCodeOfArtical() {\n        return codeOfArtical;\n    }\n\n    public String getNameOfArtical() {\n        return nameOfArtical;\n    }\n\n    public double getPriceOfArtical() {\n        return priceOfArtical;\n    }\n            \n}\n</code></pre>\n<p>I want in main class to write something like:</p>\n<pre><code>Artical a1 = new Artical(&quot;841740102156&quot;, &quot;LG Monitor&quot;, 600.00);\nnew ShowArticalClass(a1).do();\nnew WriteArticalInFileClass(new File(&quot;baza.csv&quot;), a1).do();\n</code></pre>\n<p>so that data in file will be written in format like this:</p>\n<pre><code>841740102156; Monitor LG; 600.00;\n\n914918414989; Intel CPU; 250.00;\n</code></pre>\n<ul>\n<li>Those 2 classes ShowArticalClass and WriteArticalInFileClass arent important, those are abstract classes.*</li>\n</ul>\n<p>So my question is: How do I set <strong>format</strong> to look like this, where every line is new Artical.</p>\n"},{"tags":["java","hashmap","key","dto"],"comments":[{"owner":{"account_id":74704,"reputation":11534,"user_id":214525,"accept_rate":100,"display_name":"f1sh"},"score":1,"creation_date":1656323062,"post_id":72769977,"comment_id":128534900,"body_markdown":"`Object[] objArr =DTOmap. Get(key)` will not compile for a `Map&lt;string,DTO&gt;`. Why do you expect this to work? And why is your question &quot;can I use..&quot;, have you not even tried to compile it?","body":"<code>Object[] objArr =DTOmap. Get(key)</code> will not compile for a <code>Map&lt;string,DTO&gt;</code>. Why do you expect this to work? And why is your question &quot;can I use..&quot;, have you not even tried to compile it?"}],"answers":[{"tags":[],"owner":{"account_id":25376058,"reputation":1338,"user_id":19189183,"display_name":"Sayan Bhattacharya"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1656327204,"creation_date":1656324552,"answer_id":72770332,"question_id":72769977,"body_markdown":"```\r\nfor(string key:rows){\r\n Object[] objArr =DTOmap.get(key);\r\n}\r\n```\r\nThis is invalid. Your map is `Map&lt;string,DTO&gt;` , by calling `.get(key)` you will get a single DTO instance not an array of it.\r\nYou need to store all the DTO instances in an array / List for all keys. \r\nSomething like this :\r\n```\r\nList&lt;DTO&gt; list = new ArrayList&lt;&gt;();\r\nfor(String key:rows){\r\n DTO dto = DTOmap.get(key);\r\n list.add(dto);\r\n}\r\n```\r\nAfter that you can do whatever you want iterating the list.\r\n```\r\nfor(DTO dto : list){\r\n //your code \r\n}\r\n```\r\n\r\n**EDIT**: As mentioned by [@f1sh][1] in the comments .You can do the same just by iterating the `map.keyset()`\r\n```\r\nfor(String key : DTOmap.keyset()){\r\n DTO dto = DTOmap.get(key);\r\n\r\n //your code\r\n Cell cell=row.createCell(cellnum++);\r\n}\r\n```\r\nIt is pointless to use two `for-loop` to perform some operation which can be done in one.\r\n\r\n\r\n  [1]: https://stackoverflow.com/users/214525/f1sh","title":"How to extract the value with the key field in hashmap","body":"<pre><code>for(string key:rows){\n Object[] objArr =DTOmap.get(key);\n}\n</code></pre>\n<p>This is invalid. Your map is <code>Map&lt;string,DTO&gt;</code> , by calling <code>.get(key)</code> you will get a single DTO instance not an array of it.\nYou need to store all the DTO instances in an array / List for all keys.\nSomething like this :</p>\n<pre><code>List&lt;DTO&gt; list = new ArrayList&lt;&gt;();\nfor(String key:rows){\n DTO dto = DTOmap.get(key);\n list.add(dto);\n}\n</code></pre>\n<p>After that you can do whatever you want iterating the list.</p>\n<pre><code>for(DTO dto : list){\n //your code \n}\n</code></pre>\n<p><strong>EDIT</strong>: As mentioned by <a href=\"https://stackoverflow.com/users/214525/f1sh\">@f1sh</a> in the comments .You can do the same just by iterating the <code>map.keyset()</code></p>\n<pre><code>for(String key : DTOmap.keyset()){\n DTO dto = DTOmap.get(key);\n\n //your code\n Cell cell=row.createCell(cellnum++);\n}\n</code></pre>\n<p>It is pointless to use two <code>for-loop</code> to perform some operation which can be done in one.</p>\n"}],"owner":{"account_id":25501907,"reputation":19,"user_id":19294975,"display_name":"ShiBui"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":849,"favorite_count":0,"down_vote_count":2,"up_vote_count":1,"accepted_answer_id":72770332,"answer_count":1,"score":-1,"last_activity_date":1656327204,"creation_date":1656322874,"question_id":72769977,"body_markdown":"    Map&lt;string,DTO&gt; DTOmap\r\nThe hash map has string as the key and the DTO as the value field in a hashmap\r\nI am trying to get the DTO values printed in an excel sheet.\\\r\n Can I use\r\n \r\n```\r\nSet&lt;string&gt; rows=DTOmap.keyset();\r\nFor(string key:rows)\r\nObject[] objArr =DTOmap. Get(key);\r\nFor (Object obj:objArr){\r\nCell cell=row.createCell(cellnum++);\r\n\r\n```\r\n\r\nCan I use the above method to get all the DTO values using the key field to extract it? ","title":"How to extract the value with the key field in hashmap","body":"<pre><code>Map&lt;string,DTO&gt; DTOmap\n</code></pre>\n<p>The hash map has string as the key and the DTO as the value field in a hashmap\nI am trying to get the DTO values printed in an excel sheet.<br />\nCan I use</p>\n<pre><code>Set&lt;string&gt; rows=DTOmap.keyset();\nFor(string key:rows)\nObject[] objArr =DTOmap. Get(key);\nFor (Object obj:objArr){\nCell cell=row.createCell(cellnum++);\n\n</code></pre>\n<p>Can I use the above method to get all the DTO values using the key field to extract it?</p>\n"},{"tags":["java","apache-spark","pyspark","pre-trained-model","johnsnowlabs-spark-nlp"],"owner":{"account_id":25570774,"reputation":11,"user_id":19351174,"display_name":"Luqman"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":449,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1656326643,"creation_date":1656326643,"question_id":72770806,"body_markdown":"Unable to load pre-trained model on both window and linux. set environment variables for all spark 3.2.1 ,hadoop 3.2, sparknlp 3.4.4 and 4.0.0 used both, python 3.8+ and using java 8. Need help\r\n\r\n    from sparknlp.base import *\r\n    from sparknlp.annotator import *\r\n    from sparknlp.pretrained import PretrainedPipeline\r\n    import sparknlp\r\n\r\n    spark = sparknlp.start()\r\n    pipeline = PretrainedPipeline(&#39;cardiffnlp/twitter-xlm-roberta-base-sentiment&#39;, lang=&#39;en&#39;)\r\n\r\nERROR IS:\r\n\r\n    Py4JJavaError: An error occurred while calling \r\n    z:com.johnsnowlabs.nlp.pretrained.PythonResourceDownloader.getDownloadSize.\r\n    : java.lang.NoClassDefFoundError: com/amazonaws/AmazonClientException\r\n\tat com.johnsnowlabs.nlp.pretrained.S3ResourceDownloader.awsGateway$lzycompute(S3ResourceDownloader.scala:47)\r\n\tat com.johnsnowlabs.nlp.pretrained.S3ResourceDownloader.awsGateway(S3ResourceDownloader.scala:47)\r\n\tat com.johnsnowlabs.nlp.pretrained.S3ResourceDownloader.downloadMetadataIfNeed(S3ResourceDownloader.scala:65)\r\n\tat com.johnsnowlabs.nlp.pretrained.S3ResourceDownloader.resolveLink(S3ResourceDownloader.scala:70)\r\n\tat com.johnsnowlabs.nlp.pretrained.S3ResourceDownloader.getDownloadSize(S3ResourceDownloader.scala:204)\r\n\tat com.johnsnowlabs.nlp.pretrained.ResourceDownloader$.getDownloadSize(ResourceDownloader.scala:544)\r\n\tat com.johnsnowlabs.nlp.pretrained.PythonResourceDownloader$.getDownloadSize(ResourceDownloader.scala:714)\r\n\tat com.johnsnowlabs.nlp.pretrained.PythonResourceDownloader.getDownloadSize(ResourceDownloader.scala)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\r\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\r\n\tat py4j.Gateway.invoke(Gateway.java:282)\r\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\r\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\r\n\tat py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\r\n\tat py4j.ClientServerConnection.run(ClientServerConnection.java:106)\r\n\tat java.lang.Thread.run(Thread.java:750)\r\n    Caused by: java.lang.ClassNotFoundException: com.amazonaws.AmazonClientException\r\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:387)\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:418)\r\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:355)\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:351)\r\n\t... 20 more\r\n\r\n","title":"Py4JJavaError: An error ocurred while caling z:comjohnsnowlabs.nlp.pretrained.PythonResourceDownloader.getDownloadSize: java.lang.NoClassDefFoundError","body":"<p>Unable to load pre-trained model on both window and linux. set environment variables for all spark 3.2.1 ,hadoop 3.2, sparknlp 3.4.4 and 4.0.0 used both, python 3.8+ and using java 8. Need help</p>\n<pre><code>from sparknlp.base import *\nfrom sparknlp.annotator import *\nfrom sparknlp.pretrained import PretrainedPipeline\nimport sparknlp\n\nspark = sparknlp.start()\npipeline = PretrainedPipeline('cardiffnlp/twitter-xlm-roberta-base-sentiment', lang='en')\n</code></pre>\n<p>ERROR IS:</p>\n<pre><code>Py4JJavaError: An error occurred while calling \nz:com.johnsnowlabs.nlp.pretrained.PythonResourceDownloader.getDownloadSize.\n: java.lang.NoClassDefFoundError: com/amazonaws/AmazonClientException\nat com.johnsnowlabs.nlp.pretrained.S3ResourceDownloader.awsGateway$lzycompute(S3ResourceDownloader.scala:47)\nat com.johnsnowlabs.nlp.pretrained.S3ResourceDownloader.awsGateway(S3ResourceDownloader.scala:47)\nat com.johnsnowlabs.nlp.pretrained.S3ResourceDownloader.downloadMetadataIfNeed(S3ResourceDownloader.scala:65)\nat com.johnsnowlabs.nlp.pretrained.S3ResourceDownloader.resolveLink(S3ResourceDownloader.scala:70)\nat com.johnsnowlabs.nlp.pretrained.S3ResourceDownloader.getDownloadSize(S3ResourceDownloader.scala:204)\nat com.johnsnowlabs.nlp.pretrained.ResourceDownloader$.getDownloadSize(ResourceDownloader.scala:544)\nat com.johnsnowlabs.nlp.pretrained.PythonResourceDownloader$.getDownloadSize(ResourceDownloader.scala:714)\nat com.johnsnowlabs.nlp.pretrained.PythonResourceDownloader.getDownloadSize(ResourceDownloader.scala)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:498)\nat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\nat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\nat py4j.Gateway.invoke(Gateway.java:282)\nat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\nat py4j.commands.CallCommand.execute(CallCommand.java:79)\nat py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\nat py4j.ClientServerConnection.run(ClientServerConnection.java:106)\nat java.lang.Thread.run(Thread.java:750)\nCaused by: java.lang.ClassNotFoundException: com.amazonaws.AmazonClientException\nat java.net.URLClassLoader.findClass(URLClassLoader.java:387)\nat java.lang.ClassLoader.loadClass(ClassLoader.java:418)\nat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:355)\nat java.lang.ClassLoader.loadClass(ClassLoader.java:351)\n... 20 more\n</code></pre>\n"},{"tags":["java","azure","image","file-upload","awt"],"comments":[{"owner":{"account_id":3072614,"reputation":12296,"user_id":2602877,"display_name":"Christoph Rackwitz"},"score":0,"creation_date":1656282430,"post_id":72765030,"comment_id":128527367,"body_markdown":"does `BinaryData.fromObject` know how to turn raster data (`RenderedImage thumbnailImage`) into compressed image data (jpeg, png, ...)? -- looks to me like your code doesn&#39;t even reach any azure-specific code... it fails to create the BinaryData already","body":"does <code>BinaryData.fromObject</code> know how to turn raster data (<code>RenderedImage thumbnailImage</code>) into compressed image data (jpeg, png, ...)? -- looks to me like your code doesn&#39;t even reach any azure-specific code... it fails to create the BinaryData already"},{"owner":{"account_id":4074975,"reputation":732,"user_id":4307149,"display_name":"Ashar"},"score":0,"creation_date":1656311933,"post_id":72765030,"comment_id":128531291,"body_markdown":"@ChristophRackwitz Thanks. Yes I noticed BinaryData.fromObject is failing. I have updated the logic but I would like to bypass the file writing logic and directly upload the file. Would this be possible?","body":"@ChristophRackwitz Thanks. Yes I noticed BinaryData.fromObject is failing. I have updated the logic but I would like to bypass the file writing logic and directly upload the file. Would this be possible?"},{"owner":{"account_id":3072614,"reputation":12296,"user_id":2602877,"display_name":"Christoph Rackwitz"},"score":1,"creation_date":1656315834,"post_id":72765030,"comment_id":128532413,"body_markdown":"ImageIO can write to some kind of buffer object too, right? something that satisfies the File interface but doesn&#39;t make a file?","body":"ImageIO can write to some kind of buffer object too, right? something that satisfies the File interface but doesn&#39;t make a file?"},{"owner":{"account_id":1531514,"reputation":26639,"user_id":1428606,"accept_rate":71,"display_name":"Harald K"},"score":0,"creation_date":1656317627,"post_id":72765030,"comment_id":128533046,"body_markdown":"The exception seems to be the result of an outdated version of the code in the question. If so, I strongly suggest to remove it to avoid confusion. And yes, you can write to a `ByteArrayOutputStream` if you like, to avoid the file.","body":"The exception seems to be the result of an outdated version of the code in the question. If so, I strongly suggest to remove it to avoid confusion. And yes, you can write to a <code>ByteArrayOutputStream</code> if you like, to avoid the file."},{"owner":{"account_id":4074975,"reputation":732,"user_id":4307149,"display_name":"Ashar"},"score":0,"creation_date":1656326574,"post_id":72765030,"comment_id":128536099,"body_markdown":"So I tried using ByteArrayOutputSteam. The file uploaded to azure as well (Code attached). But when I read the file the image viewer wasn&#39;t able to open it.","body":"So I tried using ByteArrayOutputSteam. The file uploaded to azure as well (Code attached). But when I read the file the image viewer wasn&#39;t able to open it."}],"owner":{"account_id":4074975,"reputation":732,"user_id":4307149,"display_name":"Ashar"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":204,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1656326521,"creation_date":1656276544,"question_id":72765030,"body_markdown":"I have generated an image thumbnail which I&#39;m trying to store in azure. BlobClient need the data to be of type &quot;BinaryData&quot; so I wrapped it as:\r\n\r\n    myBlobClient.upload(BinaryData.fromObject(thumbnailImage));\r\n\r\nThe code snippet is this:\r\n\r\n        RenderedImage thumbnailImage = CommonUtils.generateImageThumbnail(newFilePath + &#39;?&#39; + thumbnailFileSasToken);\r\n        String thumbnailFileName = CommonUtils.removeFileExtension(fileName) + &quot;_preview.&quot; + extension;\r\n        String thumbnailFilePath = &quot;./tmp/&quot; + thumbnailFileName;\r\n        File tempFile = new File(thumbnailFilePath);\r\n        assert thumbnailImage != null;\r\n        ImageIO.write(thumbnailImage, extension, tempFile);\r\n\r\n        if (item == null) {\r\n            sourceBlobName = String.format(&quot;%s/%s&quot;, savedOrder.getOrderNo(), thumbnailFileName);\r\n        } else {\r\n            sourceBlobName = String.format(&quot;%s/%s/%s&quot;, savedOrder.getOrderNo(), item.getItemNo(), thumbnailFileName);\r\n        }\r\n        BlobClient myBlobClient = fileService.getBlobClient(sourceBlobName);\r\n        myBlobClient.upload(BinaryData.fromStream(new FileInputStream(tempFile)));\r\n        return  myBlobClient;    \r\n\r\nHelper Methods:\r\n\r\n    public static BufferedImage convertToBufferedImage(Image image)\r\n        {\r\n            BufferedImage newImage = new BufferedImage(\r\n                    image.getWidth(null), image.getHeight(null),\r\n                    BufferedImage.TYPE_INT_RGB);\r\n            Graphics2D g = newImage.createGraphics();\r\n            g.drawImage(image, 0, 0, null);\r\n            g.dispose();\r\n            return newImage;\r\n        }\r\n    \r\n        public static RenderedImage generateImageThumbnail(String filePath) {\r\n            try {\r\n                BufferedImage image = ImageIO.read(new URL(filePath).openStream());\r\n                Image scaledImage = image.getScaledInstance(300, 300, Image.SCALE_DEFAULT);\r\n                return convertToBufferedImage(scaledImage);\r\n            } catch(IOException ex){\r\n                log.error(ex.getMessage());\r\n            }\r\n            return null;\r\n        }\r\n\r\nThe exception I get on the line myBlobClient.upload is:\r\n\r\n&gt; java.io.UncheckedIOException:\r\n&gt; com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Invalid\r\n&gt; type definition for type `sun.awt.image.IntegerInterleavedRaster`:\r\n&gt; Failed to construct BeanSerializer for [simple type, class\r\n&gt; sun.awt.image.IntegerInterleavedRaster]:\r\n&gt; (java.lang.IllegalArgumentException) Failed to call `setAccess()` on\r\n&gt; Field &#39;sampleModel&#39; due to\r\n&gt; `java.lang.reflect.InaccessibleObjectException`, problem: Unable to\r\n&gt; make field protected java.awt.image.SampleModel\r\n&gt; java.awt.image.Raster.sampleModel accessible: module java.desktop does\r\n&gt; not &quot;opens java.awt.image&quot; to unnamed module @4fb3ee4e (through\r\n&gt; reference chain: java.awt.image.BufferedImage[&quot;raster&quot;])\r\n\r\n**Update**\r\nSo I found a way to write the file first and convert it into InputStream which then uploads. Is there a way to bypass writing the file first and directly upload it? \r\n\r\n**New Attempt**\r\n\r\n    String thumbnailName = CommonUtils.removeFileExtension(fileName) + &quot;_preview.&quot; + extension;\r\n    String thumbnailPath = &quot;./tmp/&quot; + thumbnailName;\r\n    ByteArrayOutputStream baos = new ByteArrayOutputStream();\r\n    File tempFile = new File(thumbnailPath);\r\n    if (imageThumbnail != null) {\r\n        ImageIO.write(imageThumbnail, extension, baos);\r\n    }\r\n    sourceBlobName = item == null ? String.format(&quot;%s/%s&quot;, savedOrder.getOrderNo(), thumbnailName)\r\n                    : String.format(&quot;%s/%s/%s&quot;, savedOrder.getOrderNo(), item.getItemNo(), thumbnailName);\r\n    \r\n    BlobClient myBlobClient = fileService.getBlobClient(sourceBlobName);\r\n    myBlobClient.upload(BinaryData.fromObject(baos));\r\n    return  myBlobClient;","title":"Springboot: Directly Upload the Image to Azure BlobClient without writing to OS first","body":"<p>I have generated an image thumbnail which I'm trying to store in azure. BlobClient need the data to be of type &quot;BinaryData&quot; so I wrapped it as:</p>\n<pre><code>myBlobClient.upload(BinaryData.fromObject(thumbnailImage));\n</code></pre>\n<p>The code snippet is this:</p>\n<pre><code>    RenderedImage thumbnailImage = CommonUtils.generateImageThumbnail(newFilePath + '?' + thumbnailFileSasToken);\n    String thumbnailFileName = CommonUtils.removeFileExtension(fileName) + &quot;_preview.&quot; + extension;\n    String thumbnailFilePath = &quot;./tmp/&quot; + thumbnailFileName;\n    File tempFile = new File(thumbnailFilePath);\n    assert thumbnailImage != null;\n    ImageIO.write(thumbnailImage, extension, tempFile);\n\n    if (item == null) {\n        sourceBlobName = String.format(&quot;%s/%s&quot;, savedOrder.getOrderNo(), thumbnailFileName);\n    } else {\n        sourceBlobName = String.format(&quot;%s/%s/%s&quot;, savedOrder.getOrderNo(), item.getItemNo(), thumbnailFileName);\n    }\n    BlobClient myBlobClient = fileService.getBlobClient(sourceBlobName);\n    myBlobClient.upload(BinaryData.fromStream(new FileInputStream(tempFile)));\n    return  myBlobClient;    \n</code></pre>\n<p>Helper Methods:</p>\n<pre><code>public static BufferedImage convertToBufferedImage(Image image)\n    {\n        BufferedImage newImage = new BufferedImage(\n                image.getWidth(null), image.getHeight(null),\n                BufferedImage.TYPE_INT_RGB);\n        Graphics2D g = newImage.createGraphics();\n        g.drawImage(image, 0, 0, null);\n        g.dispose();\n        return newImage;\n    }\n\n    public static RenderedImage generateImageThumbnail(String filePath) {\n        try {\n            BufferedImage image = ImageIO.read(new URL(filePath).openStream());\n            Image scaledImage = image.getScaledInstance(300, 300, Image.SCALE_DEFAULT);\n            return convertToBufferedImage(scaledImage);\n        } catch(IOException ex){\n            log.error(ex.getMessage());\n        }\n        return null;\n    }\n</code></pre>\n<p>The exception I get on the line myBlobClient.upload is:</p>\n<blockquote>\n<p>java.io.UncheckedIOException:\ncom.fasterxml.jackson.databind.exc.InvalidDefinitionException: Invalid\ntype definition for type <code>sun.awt.image.IntegerInterleavedRaster</code>:\nFailed to construct BeanSerializer for [simple type, class\nsun.awt.image.IntegerInterleavedRaster]:\n(java.lang.IllegalArgumentException) Failed to call <code>setAccess()</code> on\nField 'sampleModel' due to\n<code>java.lang.reflect.InaccessibleObjectException</code>, problem: Unable to\nmake field protected java.awt.image.SampleModel\njava.awt.image.Raster.sampleModel accessible: module java.desktop does\nnot &quot;opens java.awt.image&quot; to unnamed module @4fb3ee4e (through\nreference chain: java.awt.image.BufferedImage[&quot;raster&quot;])</p>\n</blockquote>\n<p><strong>Update</strong>\nSo I found a way to write the file first and convert it into InputStream which then uploads. Is there a way to bypass writing the file first and directly upload it?</p>\n<p><strong>New Attempt</strong></p>\n<pre><code>String thumbnailName = CommonUtils.removeFileExtension(fileName) + &quot;_preview.&quot; + extension;\nString thumbnailPath = &quot;./tmp/&quot; + thumbnailName;\nByteArrayOutputStream baos = new ByteArrayOutputStream();\nFile tempFile = new File(thumbnailPath);\nif (imageThumbnail != null) {\n    ImageIO.write(imageThumbnail, extension, baos);\n}\nsourceBlobName = item == null ? String.format(&quot;%s/%s&quot;, savedOrder.getOrderNo(), thumbnailName)\n                : String.format(&quot;%s/%s/%s&quot;, savedOrder.getOrderNo(), item.getItemNo(), thumbnailName);\n\nBlobClient myBlobClient = fileService.getBlobClient(sourceBlobName);\nmyBlobClient.upload(BinaryData.fromObject(baos));\nreturn  myBlobClient;\n</code></pre>\n"},{"tags":["java","equals"],"comments":[{"owner":{"account_id":213468,"reputation":103488,"user_id":466862,"display_name":"Mark Rotteveel"},"score":1,"creation_date":1656317759,"post_id":72768847,"comment_id":128533095,"body_markdown":"What is your question?","body":"What is your question?"},{"owner":{"account_id":23783500,"reputation":5175,"user_id":17795888,"display_name":"Chaosfire"},"score":0,"creation_date":1656318468,"post_id":72768847,"comment_id":128533328,"body_markdown":"What exactly are you trying to achieve with that collection equals method? You compare every element from 1st collection to every element from 2nd collection, which is strange. Shouldn&#39;t you compare 1sl element to 1st element, then 2nd to 2nd and so on? Also is there any specific reason you don&#39;t extend the class the provide equals and hashCode implementations to suit your needs?","body":"What exactly are you trying to achieve with that collection equals method? You compare every element from 1st collection to every element from 2nd collection, which is strange. Shouldn&#39;t you compare 1sl element to 1st element, then 2nd to 2nd and so on? Also is there any specific reason you don&#39;t extend the class the provide equals and hashCode implementations to suit your needs?"},{"owner":{"account_id":11239210,"reputation":779,"user_id":8244162,"display_name":"J&#243;n&#225;s Bal&#225;zs"},"score":0,"creation_date":1656318483,"post_id":72768847,"comment_id":128533330,"body_markdown":"My first idea was to map the instances to their cardinality.  How should I count instances that I cannot put in a HashMap, or can I?","body":"My first idea was to map the instances to their cardinality.  How should I count instances that I cannot put in a HashMap, or can I?"},{"owner":{"account_id":11239210,"reputation":779,"user_id":8244162,"display_name":"J&#243;n&#225;s Bal&#225;zs"},"score":0,"creation_date":1656319286,"post_id":72768847,"comment_id":128533606,"body_markdown":"@Chaosfire to answer your last question this calss is an `Entity` which is generated from UML. On the other according to our new spec. two instances are equals if some of their fields are equal but not all of them (and this ignores the id).\n\nTo the other questions.: there is not quarantee on the order of elements.","body":"@Chaosfire to answer your last question this calss is an <code>Entity</code> which is generated from UML. On the other according to our new spec. two instances are equals if some of their fields are equal but not all of them (and this ignores the id).  To the other questions.: there is not quarantee on the order of elements."}],"answers":[{"tags":[],"owner":{"account_id":23783500,"reputation":5175,"user_id":17795888,"display_name":"Chaosfire"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1656325406,"creation_date":1656325406,"answer_id":72770513,"question_id":72768847,"body_markdown":"Since you can&#39;t provide `equals` and `hashCode`, most collections are out of the question. This leaves us only with tree structures([TreeMap][1] to be precise) and custom [Comparator][2] to work with. Example null safe comparator:\r\n```\r\npublic static final Comparator&lt;Box&gt; COMPARATOR = Comparator.nullsLast(Comparator.comparing(Box::getData));\r\n```\r\nCount the elements in each collection using `TreeMap`\r\n```\r\nstatic &lt;T&gt; boolean equals(Collection&lt;T&gt; collection1, Collection&lt;T&gt; collection2, BiPredicate&lt;T, T&gt; equals, Comparator&lt;T&gt; comparator) {\r\n  if (collection1.size() != collection2.size()) {\r\n    return false;\r\n  }\r\n  \r\n  Map&lt;T, Integer&gt; m1 = new TreeMap&lt;&gt;(comparator);\r\n  for (T t : collection1) {\r\n    m1.merge(t, 1, Integer::sum);\r\n  }\r\n  Map&lt;T, Integer&gt; m2 = new TreeMap&lt;&gt;(comparator);\r\n  for (T t : collection2) {\r\n    m2.merge(t, 1, Integer::sum);\r\n  }\r\n  \r\n  if (m1.size() != m2.size()) {\r\n    return false;\r\n  }\r\n  Iterator&lt;Map.Entry&lt;T, Integer&gt;&gt; m2Iterator = m2.entrySet().iterator();\r\n  for (Map.Entry&lt;T, Integer&gt; m1Entry : m1.entrySet()) {\r\n    Map.Entry&lt;T, Integer&gt; m2Entry = m2Iterator.next();\r\n    if (!equals.test(m1Entry.getKey(), m2Entry.getKey())) {\r\n      return false;\r\n    }\r\n    if (!m1Entry.getValue().equals(m2Entry.getValue())) {\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n```\r\nEntries now will be in the same order, so we can safely compare current keys(Box) with current counts.\r\n\r\nOther option would be to collect collections to sorted lists and compare each element.\r\n```\r\nstatic &lt;T&gt; boolean equals(Collection&lt;T&gt; collection1, Collection&lt;T&gt; collection2, BiPredicate&lt;T, T&gt; equals, Comparator&lt;T&gt; comparator) {\r\n  if (collection1.size() != collection2.size()) {\r\n    return false;\r\n  }\r\n  \r\n  List&lt;T&gt; l1 = collection1.stream().sorted(comparator).collect(Collectors.toList());\r\n  List&lt;T&gt; l2 = collection2.stream().sorted(comparator).collect(Collectors.toList());\r\n  for (int i = 0; i &lt; l1.size(); i++) {\r\n    if (!equals.test(l1.get(i), l2.get(i))) {\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n```\r\nIf collections are guaranteed to be lists and you don&#39;t need to keep them in input order, it&#39;s possible to sort directly without streaming. I would stick with 2nd option, if possible, it&#39;s shorter and more readable i think.\r\n\r\n  [1]: https://docs.oracle.com/javase/8/docs/api/java/util/TreeMap.html\r\n  [2]: https://docs.oracle.com/javase/8/docs/api/java/util/Comparator.html","title":"Collection of a type that does not have equals and hashCode","body":"<p>Since you can't provide <code>equals</code> and <code>hashCode</code>, most collections are out of the question. This leaves us only with tree structures(<a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/TreeMap.html\" rel=\"nofollow noreferrer\">TreeMap</a> to be precise) and custom <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/Comparator.html\" rel=\"nofollow noreferrer\">Comparator</a> to work with. Example null safe comparator:</p>\n<pre><code>public static final Comparator&lt;Box&gt; COMPARATOR = Comparator.nullsLast(Comparator.comparing(Box::getData));\n</code></pre>\n<p>Count the elements in each collection using <code>TreeMap</code></p>\n<pre><code>static &lt;T&gt; boolean equals(Collection&lt;T&gt; collection1, Collection&lt;T&gt; collection2, BiPredicate&lt;T, T&gt; equals, Comparator&lt;T&gt; comparator) {\n  if (collection1.size() != collection2.size()) {\n    return false;\n  }\n  \n  Map&lt;T, Integer&gt; m1 = new TreeMap&lt;&gt;(comparator);\n  for (T t : collection1) {\n    m1.merge(t, 1, Integer::sum);\n  }\n  Map&lt;T, Integer&gt; m2 = new TreeMap&lt;&gt;(comparator);\n  for (T t : collection2) {\n    m2.merge(t, 1, Integer::sum);\n  }\n  \n  if (m1.size() != m2.size()) {\n    return false;\n  }\n  Iterator&lt;Map.Entry&lt;T, Integer&gt;&gt; m2Iterator = m2.entrySet().iterator();\n  for (Map.Entry&lt;T, Integer&gt; m1Entry : m1.entrySet()) {\n    Map.Entry&lt;T, Integer&gt; m2Entry = m2Iterator.next();\n    if (!equals.test(m1Entry.getKey(), m2Entry.getKey())) {\n      return false;\n    }\n    if (!m1Entry.getValue().equals(m2Entry.getValue())) {\n      return false;\n    }\n  }\n  return true;\n}\n</code></pre>\n<p>Entries now will be in the same order, so we can safely compare current keys(Box) with current counts.</p>\n<p>Other option would be to collect collections to sorted lists and compare each element.</p>\n<pre><code>static &lt;T&gt; boolean equals(Collection&lt;T&gt; collection1, Collection&lt;T&gt; collection2, BiPredicate&lt;T, T&gt; equals, Comparator&lt;T&gt; comparator) {\n  if (collection1.size() != collection2.size()) {\n    return false;\n  }\n  \n  List&lt;T&gt; l1 = collection1.stream().sorted(comparator).collect(Collectors.toList());\n  List&lt;T&gt; l2 = collection2.stream().sorted(comparator).collect(Collectors.toList());\n  for (int i = 0; i &lt; l1.size(); i++) {\n    if (!equals.test(l1.get(i), l2.get(i))) {\n      return false;\n    }\n  }\n  return true;\n}\n</code></pre>\n<p>If collections are guaranteed to be lists and you don't need to keep them in input order, it's possible to sort directly without streaming. I would stick with 2nd option, if possible, it's shorter and more readable i think.</p>\n"}],"owner":{"account_id":11239210,"reputation":779,"user_id":8244162,"display_name":"J&#243;n&#225;s Bal&#225;zs"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":94,"favorite_count":0,"down_vote_count":2,"up_vote_count":4,"accepted_answer_id":72770513,"answer_count":1,"score":2,"last_activity_date":1656326295,"creation_date":1656317235,"question_id":72768847,"body_markdown":"I have to use a type from a 3rd party library that does not have `equals` and `hashCode`.\r\n\r\nIn my example this will be played by the class `Box` which contains some data.\r\nI have create a custom static method which compares to instances according to the specification. In the example if the data are the same.\r\n\r\nThe problem is that my implementation still does not take into account the cardinality of the unique instances.\r\n\r\n\r\n\timport org.junit.jupiter.api.Test;\r\n\r\n\timport java.util.Collection;\r\n\timport java.util.Objects;\r\n\timport java.util.function.BiPredicate;\r\n\r\n\timport static org.assertj.core.util.Lists.newArrayList;\r\n\timport static org.junit.jupiter.api.Assertions.assertFalse;\r\n\timport static org.junit.jupiter.api.Assertions.assertTrue;\r\n\r\n\tclass CustomEqualsTest {\r\n\r\n\t\tpublic static final BiPredicate&lt;Box, Box&gt; EQUALS = CustomEqualsTest::equals;\r\n\r\n\t\tstatic boolean equals(Box b1, Box b2) {\r\n\t\t\tif (b1 == b2) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif (b1 != null &amp;&amp; b2 != null) {\r\n\t\t\t\treturn Objects.equals(b1.data, b2.data);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tstatic class Box {\r\n\t\t\tInteger data;\r\n\r\n\t\t\tprivate Box(Integer data) {\r\n\t\t\t\tthis.data = data;\r\n\t\t\t}\r\n\r\n\t\t\tstatic Box of(Integer data) {\r\n\t\t\t\treturn new Box(data);\r\n\t\t\t}\r\n\t\t\t// intentionally skip equals\r\n\t\t\t// intentionally skip hashCode\r\n\t\t}\r\n\r\n\t\t@Test\r\n\t\tvoid testCustomEquals() {\r\n\t\t\tassertTrue(equals(\r\n\t\t\t\t\tnewArrayList(Box.of(1)),\r\n\t\t\t\t\tnewArrayList(Box.of(1)), EQUALS));\r\n\t\t\tassertFalse(equals(\r\n\t\t\t\t\tnewArrayList(Box.of(1)),\r\n\t\t\t\t\tnewArrayList(), EQUALS));\r\n\t\t\tassertFalse(equals(\r\n\t\t\t\t\tnewArrayList(Box.of(1)),\r\n\t\t\t\t\tnewArrayList((Box) null), EQUALS));\r\n\t\t\tassertFalse(equals(\r\n\t\t\t\t\tnewArrayList(Box.of(1)),\r\n\t\t\t\t\tnewArrayList(Box.of(2)), EQUALS));\r\n\t\t\tassertFalse(equals(\r\n\t\t\t\t\tnewArrayList(Box.of(1), Box.of(1)),\r\n\t\t\t\t\tnewArrayList(Box.of(1)), EQUALS));\r\n\r\n\t\t\t// This fails:\r\n\t\t\tassertFalse(\r\n\t\t\t\t\tequals(\r\n\t\t\t\t\t\t\tnewArrayList(Box.of(1), Box.of(1), Box.of(2)),\r\n\t\t\t\t\t\t\tnewArrayList(Box.of(1), Box.of(2), Box.of(2)),\r\n\t\t\t\t\t\t\tEQUALS));\r\n\r\n\t\t}\r\n\r\n\t\tstatic &lt;T&gt; boolean equals(Collection&lt;T&gt; collection1, Collection&lt;T&gt; collection2, BiPredicate&lt;T, T&gt; equals) {\r\n\t\t\tif (collection1.size() != collection2.size()) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tfor (T t1 : collection1) {\r\n\t\t\t\tboolean match = false;\r\n\t\t\t\tfor (T t2 : collection2) {\r\n\t\t\t\t\tif (equals.test(t1, t2)) {\r\n\t\t\t\t\t\tmatch = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!match) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n","title":"Collection of a type that does not have equals and hashCode","body":"<p>I have to use a type from a 3rd party library that does not have <code>equals</code> and <code>hashCode</code>.</p>\n<p>In my example this will be played by the class <code>Box</code> which contains some data.\nI have create a custom static method which compares to instances according to the specification. In the example if the data are the same.</p>\n<p>The problem is that my implementation still does not take into account the cardinality of the unique instances.</p>\n<pre><code>import org.junit.jupiter.api.Test;\n\nimport java.util.Collection;\nimport java.util.Objects;\nimport java.util.function.BiPredicate;\n\nimport static org.assertj.core.util.Lists.newArrayList;\nimport static org.junit.jupiter.api.Assertions.assertFalse;\nimport static org.junit.jupiter.api.Assertions.assertTrue;\n\nclass CustomEqualsTest {\n\n    public static final BiPredicate&lt;Box, Box&gt; EQUALS = CustomEqualsTest::equals;\n\n    static boolean equals(Box b1, Box b2) {\n        if (b1 == b2) {\n            return true;\n        }\n        if (b1 != null &amp;&amp; b2 != null) {\n            return Objects.equals(b1.data, b2.data);\n        }\n        return false;\n    }\n\n    static class Box {\n        Integer data;\n\n        private Box(Integer data) {\n            this.data = data;\n        }\n\n        static Box of(Integer data) {\n            return new Box(data);\n        }\n        // intentionally skip equals\n        // intentionally skip hashCode\n    }\n\n    @Test\n    void testCustomEquals() {\n        assertTrue(equals(\n                newArrayList(Box.of(1)),\n                newArrayList(Box.of(1)), EQUALS));\n        assertFalse(equals(\n                newArrayList(Box.of(1)),\n                newArrayList(), EQUALS));\n        assertFalse(equals(\n                newArrayList(Box.of(1)),\n                newArrayList((Box) null), EQUALS));\n        assertFalse(equals(\n                newArrayList(Box.of(1)),\n                newArrayList(Box.of(2)), EQUALS));\n        assertFalse(equals(\n                newArrayList(Box.of(1), Box.of(1)),\n                newArrayList(Box.of(1)), EQUALS));\n\n        // This fails:\n        assertFalse(\n                equals(\n                        newArrayList(Box.of(1), Box.of(1), Box.of(2)),\n                        newArrayList(Box.of(1), Box.of(2), Box.of(2)),\n                        EQUALS));\n\n    }\n\n    static &lt;T&gt; boolean equals(Collection&lt;T&gt; collection1, Collection&lt;T&gt; collection2, BiPredicate&lt;T, T&gt; equals) {\n        if (collection1.size() != collection2.size()) {\n            return false;\n        }\n\n        for (T t1 : collection1) {\n            boolean match = false;\n            for (T t2 : collection2) {\n                if (equals.test(t1, t2)) {\n                    match = true;\n                    break;\n                }\n            }\n            if (!match) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n}\n</code></pre>\n"},{"tags":["java","encryption","rsa","card"],"comments":[{"owner":{"account_id":20433516,"reputation":3,"user_id":14991942,"display_name":"Edgars"},"score":0,"creation_date":1657010647,"post_id":72770700,"comment_id":128701939,"body_markdown":"So, my question is still open... Anybody? I guess I have some fundamental misunderstanding with that padding of input data or smth. I tried implementing the AES algorithm meanwhile - everything works correctly only when I provide input data of the length of exactly 16 bytes (my data get encrypted and decrypted flawlessly). If I try 15 bytes, I get the same CryptoException with the reason code 5 (in this case, I initialize the Cipher instance like this: ```Cipher.getInstance(Cipher.ALG_AES_BLOCK_128_CBC_NOPAD, false);```).","body":"So, my question is still open... Anybody? I guess I have some fundamental misunderstanding with that padding of input data or smth. I tried implementing the AES algorithm meanwhile - everything works correctly only when I provide input data of the length of exactly 16 bytes (my data get encrypted and decrypted flawlessly). If I try 15 bytes, I get the same CryptoException with the reason code 5 (in this case, I initialize the Cipher instance like this: <code>Cipher.getInstance(Cipher.ALG_AES_BLOCK_128_CBC_NOPAD, false);</code>)."},{"owner":{"account_id":20433516,"reputation":3,"user_id":14991942,"display_name":"Edgars"},"score":0,"creation_date":1657011771,"post_id":72770700,"comment_id":128702255,"body_markdown":"I forgot to mention in my previous comment that I get that exception also using other Cipher algorithms besides the ..._NOPAD. I tried out all of them, I think, with no luck.","body":"I forgot to mention in my previous comment that I get that exception also using other Cipher algorithms besides the ..._NOPAD. I tried out all of them, I think, with no luck."}],"owner":{"account_id":20433516,"reputation":3,"user_id":14991942,"display_name":"Edgars"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":315,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1656326222,"creation_date":1656326222,"question_id":72770700,"body_markdown":"I want to create an Applet using the Java Card technology for encrypting and decrypting strings with RSA. Currently, I&#39;m trying to do it within the Oracle IDE using its CREF simulator (having Java Card v3.1.0), but afterwards I&#39;d like to try it on my smart card NXP J3H145 which has the Java Card v3.0.4 on it. In the constructor, I&#39;ve set the stage like this:\r\n```\r\nshort KeySize=(short)64;\r\nRSA_PRIV_KEY_EXP=JCSystem.makeTransientByteArray((byte) KeySize, JCSystem.CLEAR_ON_RESET);\r\nRSA_PUB_KEY_EXP=JCSystem.makeTransientByteArray((byte) KeySize, JCSystem.CLEAR_ON_RESET);\r\nRSA_PUB_PRIV_KEY_MOD=JCSystem.makeTransientByteArray((byte) KeySize, JCSystem.CLEAR_ON_RESET);\r\nfor (short i=0;i&lt;KeySize;i++) {\r\n  RSA_PRIV_KEY_EXP[i]=1;\r\n  RSA_PUB_KEY_EXP[i]=1;\r\n  RSA_PUB_PRIV_KEY_MOD[i]=1;\r\n}\r\npair=new KeyPair(KeyPair.ALG_RSA,KeyBuilder.LENGTH_RSA_2048);\r\nRSAPublicKey pubKey=(RSAPublicKey)pair.getPublic();\r\nRSAPrivateKey privKey=(RSAPrivateKey)pair.getPrivate();\r\npubKey.setExponent(RSA_PUB_KEY_EXP, (short) 0, (short) RSA_PUB_KEY_EXP.length);\r\npubKey.setModulus(RSA_PUB_PRIV_KEY_MOD, (short) 0, (short) RSA_PUB_PRIV_KEY_MOD.length);\r\nprivKey.setExponent(RSA_PRIV_KEY_EXP, (short) 0, (short) RSA_PRIV_KEY_EXP.length);\r\nprivKey.setModulus(RSA_PUB_PRIV_KEY_MOD, (short) 0, (short) RSA_PUB_PRIV_KEY_MOD.length);\r\npair.genKeyPair();\r\nCipher cip=Cipher.getInstance(Cipher.ALG_RSA_PKCS1_OAEP, false);\r\n```\r\nThen, my encryption method looks like this and works fine:\r\n```\r\nprivate void encrypt(APDU apdu) {\r\n  byte[] buffer=apdu.getBuffer();\r\n  short lc=buffer[ISO7816.OFFSET_LC];\r\n  RSAPublicKey pub=(RSAPublicKey) pair.getPublic();\r\n  cip.init(pub, Cipher.MODE_ENCRYPT);\r\n  byte[] temp=new byte[2048];\r\n  short cipLen = cip.doFinal(buffer, (short)ISO7816.OFFSET_CDATA, lc, temp, (short) 0);\r\n  apdu.setOutgoing();\r\n  apdu.setOutgoingLength((short)cipLen);\r\n  apdu.sendBytesLong(temp, (short) 0, (short)cipLen);\r\n}\r\n```\r\nFor example, if I try to send three bytes &quot;1 2 3&quot; to the encryption method, it encrypts them and returns an array of 63 bytes. Now, I would like to pass that array to my decryption method and to receive my original string back. My decryption method looks like this:\r\n```\r\nprivate void decrypt(APDU apdu) {\r\n  try {\r\n    byte[] buffer=apdu.getBuffer();\r\n    short lc=buffer[ISO7816.OFFSET_LC];\r\n    RSAPrivateKey priv=(RSAPrivateKey)pair.getPrivate();\r\n    cip.init(priv, Cipher.MODE_DECRYPT);\r\n    byte[] temp=new byte[2048];\r\n    short cipLen = cip.doFinal(buffer, (short)ISO7816.OFFSET_CDATA, lc, temp, (short) 0);\r\n    apdu.setOutgoing();\r\n    apdu.setOutgoingLength((short)cipLen);\r\n    apdu.sendBytesLong(temp, (short) 0, (short)cipLen);\r\n  }\r\n  catch (CryptoException e) {\r\n    short a=e.getReason();\r\n  }\r\n}\r\n```\r\nHere, the &quot;doFinal&quot; method call throws a CryptoException with the reason code 5. I have found that the reason code 5 means there is some kind of problem with the padding algorithm or the padding of input data or smth like this. I suspect that perhaps I&#39;ve written something wrong in the constructor, in the final line where I call the &quot;getInstance&quot; method of my Cipher. However, I&#39;ve tried using various kinds of parameters for this method instead of ALG_RSA_PKCS1_OAEP (I&#39;ve also tried to pass two parameters - one for the cipher algorithm and one for the padding algorithm -, but nothing has worked so far.\r\n\r\nIt seems like a simple problem - just to encrypt and decrypt data and to receive the original input -, but I have not managed to even find any examples of how it could be done and I&#39;ve spent so much time on this error... Can anyone point me to the problem with the exception and to how to get rid of it? I don&#39;t even care about the particular length of the keys or of the encrypted string, I just want one solution that works.","title":"Java Card: Data encryption/decryption with RSA","body":"<p>I want to create an Applet using the Java Card technology for encrypting and decrypting strings with RSA. Currently, I'm trying to do it within the Oracle IDE using its CREF simulator (having Java Card v3.1.0), but afterwards I'd like to try it on my smart card NXP J3H145 which has the Java Card v3.0.4 on it. In the constructor, I've set the stage like this:</p>\n<pre><code>short KeySize=(short)64;\nRSA_PRIV_KEY_EXP=JCSystem.makeTransientByteArray((byte) KeySize, JCSystem.CLEAR_ON_RESET);\nRSA_PUB_KEY_EXP=JCSystem.makeTransientByteArray((byte) KeySize, JCSystem.CLEAR_ON_RESET);\nRSA_PUB_PRIV_KEY_MOD=JCSystem.makeTransientByteArray((byte) KeySize, JCSystem.CLEAR_ON_RESET);\nfor (short i=0;i&lt;KeySize;i++) {\n  RSA_PRIV_KEY_EXP[i]=1;\n  RSA_PUB_KEY_EXP[i]=1;\n  RSA_PUB_PRIV_KEY_MOD[i]=1;\n}\npair=new KeyPair(KeyPair.ALG_RSA,KeyBuilder.LENGTH_RSA_2048);\nRSAPublicKey pubKey=(RSAPublicKey)pair.getPublic();\nRSAPrivateKey privKey=(RSAPrivateKey)pair.getPrivate();\npubKey.setExponent(RSA_PUB_KEY_EXP, (short) 0, (short) RSA_PUB_KEY_EXP.length);\npubKey.setModulus(RSA_PUB_PRIV_KEY_MOD, (short) 0, (short) RSA_PUB_PRIV_KEY_MOD.length);\nprivKey.setExponent(RSA_PRIV_KEY_EXP, (short) 0, (short) RSA_PRIV_KEY_EXP.length);\nprivKey.setModulus(RSA_PUB_PRIV_KEY_MOD, (short) 0, (short) RSA_PUB_PRIV_KEY_MOD.length);\npair.genKeyPair();\nCipher cip=Cipher.getInstance(Cipher.ALG_RSA_PKCS1_OAEP, false);\n</code></pre>\n<p>Then, my encryption method looks like this and works fine:</p>\n<pre><code>private void encrypt(APDU apdu) {\n  byte[] buffer=apdu.getBuffer();\n  short lc=buffer[ISO7816.OFFSET_LC];\n  RSAPublicKey pub=(RSAPublicKey) pair.getPublic();\n  cip.init(pub, Cipher.MODE_ENCRYPT);\n  byte[] temp=new byte[2048];\n  short cipLen = cip.doFinal(buffer, (short)ISO7816.OFFSET_CDATA, lc, temp, (short) 0);\n  apdu.setOutgoing();\n  apdu.setOutgoingLength((short)cipLen);\n  apdu.sendBytesLong(temp, (short) 0, (short)cipLen);\n}\n</code></pre>\n<p>For example, if I try to send three bytes &quot;1 2 3&quot; to the encryption method, it encrypts them and returns an array of 63 bytes. Now, I would like to pass that array to my decryption method and to receive my original string back. My decryption method looks like this:</p>\n<pre><code>private void decrypt(APDU apdu) {\n  try {\n    byte[] buffer=apdu.getBuffer();\n    short lc=buffer[ISO7816.OFFSET_LC];\n    RSAPrivateKey priv=(RSAPrivateKey)pair.getPrivate();\n    cip.init(priv, Cipher.MODE_DECRYPT);\n    byte[] temp=new byte[2048];\n    short cipLen = cip.doFinal(buffer, (short)ISO7816.OFFSET_CDATA, lc, temp, (short) 0);\n    apdu.setOutgoing();\n    apdu.setOutgoingLength((short)cipLen);\n    apdu.sendBytesLong(temp, (short) 0, (short)cipLen);\n  }\n  catch (CryptoException e) {\n    short a=e.getReason();\n  }\n}\n</code></pre>\n<p>Here, the &quot;doFinal&quot; method call throws a CryptoException with the reason code 5. I have found that the reason code 5 means there is some kind of problem with the padding algorithm or the padding of input data or smth like this. I suspect that perhaps I've written something wrong in the constructor, in the final line where I call the &quot;getInstance&quot; method of my Cipher. However, I've tried using various kinds of parameters for this method instead of ALG_RSA_PKCS1_OAEP (I've also tried to pass two parameters - one for the cipher algorithm and one for the padding algorithm -, but nothing has worked so far.</p>\n<p>It seems like a simple problem - just to encrypt and decrypt data and to receive the original input -, but I have not managed to even find any examples of how it could be done and I've spent so much time on this error... Can anyone point me to the problem with the exception and to how to get rid of it? I don't even care about the particular length of the keys or of the encrypted string, I just want one solution that works.</p>\n"},{"tags":["java","mysql","database","android-studio"],"answers":[{"tags":[],"owner":{"account_id":20120355,"reputation":38,"user_id":14754952,"display_name":"Gaba Miau"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656326217,"creation_date":1656326217,"answer_id":72770699,"question_id":72770492,"body_markdown":"If you are running this on your mobile phone(through usb or wifi), the ip in the connection string doesn’t work. You should go to your router settings enable port forwarding for port 3306, go to firewall enable port 3306 (inbound and outbound rules). Than you search what is my ip and replace 127.0.0.1 with your ip.(search for tutorial if you have problems with port forwarding)\r\nIt should work.\r\n\r\nYou could also try getting the private network ip for your pc (you still have to enable inbound and outbound rules) and replace 127.0.0.0 with private ip of pc. This will work only if both devices are connected to the same router.","title":"Connection to database failing for my mobile app on Android Studio","body":"<p>If you are running this on your mobile phone(through usb or wifi), the ip in the connection string doesn’t work. You should go to your router settings enable port forwarding for port 3306, go to firewall enable port 3306 (inbound and outbound rules). Than you search what is my ip and replace 127.0.0.1 with your ip.(search for tutorial if you have problems with port forwarding)\nIt should work.</p>\n<p>You could also try getting the private network ip for your pc (you still have to enable inbound and outbound rules) and replace 127.0.0.0 with private ip of pc. This will work only if both devices are connected to the same router.</p>\n"}],"owner":{"account_id":23916584,"reputation":25,"user_id":17912962,"display_name":"Tiav RANDRIA"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":77,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1656326217,"creation_date":1656325284,"question_id":72770492,"body_markdown":"I am currently coding a mobile App and I need to gather some data from a database and display it on my mobile app. I installed MYSQL JDBC Connector and I set up the database with PhpMyAdmin. I have put the jar file (of the jdbc connector) in the libs directory and implemented it in the gradle scripts. I can connect to my database using the MySQL Workbench and even PhpMyAdmin, but I can&#39;t connect through the app.\r\n\r\nYou can see the error I get here.\r\n[![Error][1]][1]\r\n\r\nHere is a part of my code :\r\n\r\n    public class Tasks extends AppCompatActivity {\r\n    Connection connection;\r\n    private static final String url = &quot;jdbc:mysql://127.0.0.1:3306/healthdb?useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=false&amp;serverTimezone=GMT&quot;;\r\n    private static final String user = &quot;root&quot;;\r\n    private static final String pass = &quot;phantom&quot;;\r\n    private static final String query = &quot;SELECT id FROM patient&quot;;\r\n    private Button doneBtn;\r\n    private Button nextBtn;\r\n    private ListView listView;\r\n    ArrayAdapter&lt;String&gt; adapter;\r\n    private Room room;\r\n    private TextView text;\r\n    String[] arrayTasks = {&quot;Changing the sheets&quot;, &quot;Blood test&quot; , &quot;Food distribution&quot;, &quot;Physiological Constants&quot;};\r\n\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_tasks);\r\n\r\n\r\n\r\n        try {\r\n            Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);\r\n            System.out.println(&quot;Connecting database...&quot;);\r\n            connection = DriverManager.getConnection(url, user, pass);\r\n            System.out.println(&quot;Connected&quot;);\r\n            Statement stmt = connection.createStatement();\r\n            ResultSet rs = stmt.executeQuery(query);\r\n                while (rs.next()) {\r\n                    // Retrieve by column name  \r\n                    System.out.print(&quot;ID: &quot; + rs.getInt(&quot;id&quot;));\r\n                }\r\n        }\r\n        catch (SQLException | ClassNotFoundException se) {\r\n            System.err.println(se);\r\n        }\r\n\r\n\r\nAnd here are my dependencies where you can see the jar file (I also moved the jar file into the libs directory)\r\n[![implementation][2]][2]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/pqhTs.png\r\n  [2]: https://i.stack.imgur.com/OcJNh.png","title":"Connection to database failing for my mobile app on Android Studio","body":"<p>I am currently coding a mobile App and I need to gather some data from a database and display it on my mobile app. I installed MYSQL JDBC Connector and I set up the database with PhpMyAdmin. I have put the jar file (of the jdbc connector) in the libs directory and implemented it in the gradle scripts. I can connect to my database using the MySQL Workbench and even PhpMyAdmin, but I can't connect through the app.</p>\n<p>You can see the error I get here.\n<a href=\"https://i.stack.imgur.com/pqhTs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pqhTs.png\" alt=\"Error\" /></a></p>\n<p>Here is a part of my code :</p>\n<pre><code>public class Tasks extends AppCompatActivity {\nConnection connection;\nprivate static final String url = &quot;jdbc:mysql://127.0.0.1:3306/healthdb?useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=false&amp;serverTimezone=GMT&quot;;\nprivate static final String user = &quot;root&quot;;\nprivate static final String pass = &quot;phantom&quot;;\nprivate static final String query = &quot;SELECT id FROM patient&quot;;\nprivate Button doneBtn;\nprivate Button nextBtn;\nprivate ListView listView;\nArrayAdapter&lt;String&gt; adapter;\nprivate Room room;\nprivate TextView text;\nString[] arrayTasks = {&quot;Changing the sheets&quot;, &quot;Blood test&quot; , &quot;Food distribution&quot;, &quot;Physiological Constants&quot;};\n\n\n@Override\nprotected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.activity_tasks);\n\n\n\n    try {\n        Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);\n        System.out.println(&quot;Connecting database...&quot;);\n        connection = DriverManager.getConnection(url, user, pass);\n        System.out.println(&quot;Connected&quot;);\n        Statement stmt = connection.createStatement();\n        ResultSet rs = stmt.executeQuery(query);\n            while (rs.next()) {\n                // Retrieve by column name  \n                System.out.print(&quot;ID: &quot; + rs.getInt(&quot;id&quot;));\n            }\n    }\n    catch (SQLException | ClassNotFoundException se) {\n        System.err.println(se);\n    }\n</code></pre>\n<p>And here are my dependencies where you can see the jar file (I also moved the jar file into the libs directory)\n<a href=\"https://i.stack.imgur.com/OcJNh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OcJNh.png\" alt=\"implementation\" /></a></p>\n"},{"tags":["java","spring","spring-boot","spring-validator"],"comments":[{"owner":{"account_id":378429,"reputation":3895,"user_id":731136,"accept_rate":69,"display_name":"doctore"},"score":0,"creation_date":1593953178,"post_id":62740539,"comment_id":110950507,"body_markdown":"Instead of return a &quot;number&quot; in your validation class, you can return specific exceptions (existing ones or created by yourself), managing them in your ExceptionHandler and return the Http code you need.","body":"Instead of return a &quot;number&quot; in your validation class, you can return specific exceptions (existing ones or created by yourself), managing them in your ExceptionHandler and return the Http code you need."},{"owner":{"account_id":4496339,"reputation":3703,"user_id":3656056,"accept_rate":53,"display_name":"VelNaga"},"score":0,"creation_date":1593953245,"post_id":62740539,"comment_id":110950527,"body_markdown":"I tried it ....but no use ...let me update the question to you","body":"I tried it ....but no use ...let me update the question to you"},{"owner":{"account_id":4496339,"reputation":3703,"user_id":3656056,"accept_rate":53,"display_name":"VelNaga"},"score":0,"creation_date":1593955061,"post_id":62740539,"comment_id":110951106,"body_markdown":"@doctore I have updated the question. If I return custom Exception then I used to get the above error message. Seems like spring-validator swallows the custom exception and throws ValidationException","body":"@doctore I have updated the question. If I return custom Exception then I used to get the above error message. Seems like spring-validator swallows the custom exception and throws ValidationException"},{"owner":{"account_id":2622304,"reputation":780,"user_id":2270081,"accept_rate":53,"display_name":"Gundamaiah"},"score":0,"creation_date":1593970759,"post_id":62740539,"comment_id":110956683,"body_markdown":"https://stackoverflow.com/questions/31780505/spring-validator-and-bindingresult-how-to-set-different-httpstatus-codes","body":"<a href=\"https://stackoverflow.com/questions/31780505/spring-validator-and-bindingresult-how-to-set-different-httpstatus-codes\" title=\"spring validator and bindingresult how to set different httpstatus codes\">stackoverflow.com/questions/31780505/&hellip;</a>"}],"answers":[{"tags":[],"owner":{"account_id":3122119,"reputation":1261,"user_id":2641683,"display_name":"Avnish"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1593956209,"creation_date":1593953403,"answer_id":62740919,"question_id":62740539,"body_markdown":"After understanding the question fully, following is what will give you what you need. You can add as many exceptions as you need in the hierarchy as child classes of IpValidationException and keep custom HTTP status code as per your business/technical use cases. \r\n\r\n    public abstract class IpValidationException extends ValidationException {\r\n        private HttpStatus status;\r\n        private String message;\r\n    \r\n        public IpValidationException(HttpStatus status, String message) {\r\n            this.status = status;\r\n            this.message = message;\r\n        }\r\n    \r\n        public HttpStatus getStatus() {\r\n            return status;\r\n        }\r\n    \r\n        public String getMessage() {\r\n            return message;\r\n        }\r\n    }\r\n    \r\n    public class InvalidIpException extends IpValidationException {\r\n        public InvalidIpException(HttpStatus status, String message) {\r\n            super(HttpStatus.BAD_REQUEST, &quot;Invalid IP address&quot;);\r\n        }\r\n    }\r\n    \r\n    public class InuseIpException extends IpValidationException {\r\n        public InuseIpException(HttpStatus status, String message) {\r\n            super(HttpStatus.CONFLICT, &quot;IP address already in use&quot;);\r\n        }\r\n    }\r\n    \r\n    public class IpAddressValidator implements ConstraintValidator&lt;IpAddress, String&gt; {\r\n    \r\n        @Override\r\n        public boolean isValid(String value, ConstraintValidatorContext context) {\r\n            Pattern pattern =\r\n                    Pattern.compile(&quot;^([0-9]{1,3})\\\\.([0-9]{1,3})\\\\.([0-9]{1,3})\\\\.([0-9]{1,3})$&quot;);\r\n            Matcher matcher = pattern.matcher(value);\r\n            //step 1\r\n            if (!matcher.matches()) {\r\n                throw new InvalidIpException();\r\n            }\r\n            //Step 2\r\n            if (ipAddress already in DB) {\r\n                throw new InuseIpException(); //conflict with other IP address\r\n            }\r\n            //Add more checks with more exception as you need.\r\n    \r\n        }\r\n    }\r\n    \r\n    // This is how your exception handler should look like\r\n    @ExceptionHandler(IpValidationException.class)\r\n    public ResponseEntity&lt;ErrorResponse&gt; handle(IpValidationException e) {\r\n        return ResponseEntity\r\n                .status(e.getStatus())\r\n                .body(e.getMessage());\r\n    }\r\n    \r\nHope this helps!!","title":"Return different HTTP status code from spring boot custom validators","body":"<p>After understanding the question fully, following is what will give you what you need. You can add as many exceptions as you need in the hierarchy as child classes of IpValidationException and keep custom HTTP status code as per your business/technical use cases.</p>\n<pre><code>public abstract class IpValidationException extends ValidationException {\n    private HttpStatus status;\n    private String message;\n\n    public IpValidationException(HttpStatus status, String message) {\n        this.status = status;\n        this.message = message;\n    }\n\n    public HttpStatus getStatus() {\n        return status;\n    }\n\n    public String getMessage() {\n        return message;\n    }\n}\n\npublic class InvalidIpException extends IpValidationException {\n    public InvalidIpException(HttpStatus status, String message) {\n        super(HttpStatus.BAD_REQUEST, &quot;Invalid IP address&quot;);\n    }\n}\n\npublic class InuseIpException extends IpValidationException {\n    public InuseIpException(HttpStatus status, String message) {\n        super(HttpStatus.CONFLICT, &quot;IP address already in use&quot;);\n    }\n}\n\npublic class IpAddressValidator implements ConstraintValidator&lt;IpAddress, String&gt; {\n\n    @Override\n    public boolean isValid(String value, ConstraintValidatorContext context) {\n        Pattern pattern =\n                Pattern.compile(&quot;^([0-9]{1,3})\\\\.([0-9]{1,3})\\\\.([0-9]{1,3})\\\\.([0-9]{1,3})$&quot;);\n        Matcher matcher = pattern.matcher(value);\n        //step 1\n        if (!matcher.matches()) {\n            throw new InvalidIpException();\n        }\n        //Step 2\n        if (ipAddress already in DB) {\n            throw new InuseIpException(); //conflict with other IP address\n        }\n        //Add more checks with more exception as you need.\n\n    }\n}\n\n// This is how your exception handler should look like\n@ExceptionHandler(IpValidationException.class)\npublic ResponseEntity&lt;ErrorResponse&gt; handle(IpValidationException e) {\n    return ResponseEntity\n            .status(e.getStatus())\n            .body(e.getMessage());\n}\n</code></pre>\n<p>Hope this helps!!</p>\n"},{"tags":[],"owner":{"account_id":15778308,"reputation":1608,"user_id":11385485,"display_name":"Nafaz M N M"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1593962269,"creation_date":1593960979,"answer_id":62742325,"question_id":62740539,"body_markdown":"create a class for Error under the model package\r\n\r\n    @NoArgsConstructor\r\n    @Geeter\r\n    @Setter\r\n    public class ErrorMessage\r\n    {\r\n        private int errorCode;\r\n        private String errorMsg;\r\n        private String documentation;\r\n\r\n         public ErrorMessage(int errorCode,String errorMsg,String documentation)\r\n           {\r\n              this.errorCode=errorCode;\r\n              this.errorMsg=errorMsg;\r\n              this.documentation=documentation;\r\n           }\r\n    }\r\n\r\ncreate a Custom Validation Exception class under the exception package\r\n\r\n    public class CustomValidationException extends RuntimeException\r\n    {\r\n              public CustomValidationException(String msg)\r\n             {\r\n                  super(msg);\r\n             }\r\n    }\r\n\r\ncreate ExceptionHandler class under the same(exception) package\r\n\r\n    @RestControllerAdvice\r\n    public class CustomValidationExceptionHandler\r\n    {\r\n       @ExceptionHandler\r\n       public ResponseEntity toResponse(CustomValidationException ex)\r\n       {\r\n            ErrorMessage errorMessage=new \r\n           ErrorMessage(400,ex.getMessage,&quot;www.stackoverflow.com&quot;);\r\n          return new ResponseEntity&lt;ErrorMessage&gt;(errorMessage,HttpStatus.BAD_REQUES);\r\n       }\r\n    \r\n    }\r\n\r\n","title":"Return different HTTP status code from spring boot custom validators","body":"<p>create a class for Error under the model package</p>\n<pre><code>@NoArgsConstructor\n@Geeter\n@Setter\npublic class ErrorMessage\n{\n    private int errorCode;\n    private String errorMsg;\n    private String documentation;\n\n     public ErrorMessage(int errorCode,String errorMsg,String documentation)\n       {\n          this.errorCode=errorCode;\n          this.errorMsg=errorMsg;\n          this.documentation=documentation;\n       }\n}\n</code></pre>\n<p>create a Custom Validation Exception class under the exception package</p>\n<pre><code>public class CustomValidationException extends RuntimeException\n{\n          public CustomValidationException(String msg)\n         {\n              super(msg);\n         }\n}\n</code></pre>\n<p>create ExceptionHandler class under the same(exception) package</p>\n<pre><code>@RestControllerAdvice\npublic class CustomValidationExceptionHandler\n{\n   @ExceptionHandler\n   public ResponseEntity toResponse(CustomValidationException ex)\n   {\n        ErrorMessage errorMessage=new \n       ErrorMessage(400,ex.getMessage,&quot;www.stackoverflow.com&quot;);\n      return new ResponseEntity&lt;ErrorMessage&gt;(errorMessage,HttpStatus.BAD_REQUES);\n   }\n\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":10699863,"reputation":8001,"user_id":7875623,"display_name":"Kavithakaran Kanapathippillai"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1593977529,"creation_date":1593965432,"answer_id":62743197,"question_id":62740539,"body_markdown":"**Current Behaviour**\r\n\r\n- When an exception (which does not extend `ConstraintDeclarationException`) is thrown by the validator code instead of returning false, `javax.validation` wraps the exception in `ValidationException`. This is validator framework&#39;s behaviour and not a spring framework issue.\r\n- When an exception which extends `ConstraintDeclarationException` is thrown by the validator code instead of returning false, `javax.validation` framework propagates it.\r\n  \r\n- If the validator returns false instead of throwing exception, Spring will convert all the validation errors into `global errors` or `field errors` and wrap them in `MethodArgumentNotValidException`  and throws it.\r\n\r\n**Issue**\r\n\r\n- The second option has field errors and global errors, custom status code can only be returned by inspecting the field name and error code. So this is not feasible as many fields can be added with that annotation.\r\n- In the first option, Custom exceptions which were thrown in the validator are wrapped in `ValidationException` so exception specific handler is not possible.\r\n\r\n**Possible Solutions**\r\n- Unwrap the specific exception which does not extend  `ConstraintDeclarationException` and map it \r\n\r\n\r\n```\r\n    @ExceptionHandler(ValidationException.class)\r\n    public ResponseEntity handle(ValidationException e) {\r\n        Throwable cause = e.getCause();\r\n        if (cause instanceof InvalidIpException) {\r\n            return ResponseEntity\r\n                    .status(HttpStatus.BAD_REQUEST)//may be different code\r\n                    .body(cause.getMessage());\r\n        }\r\n        if (cause instanceof InuseIpException) {\r\n            return ResponseEntity\r\n                    .status(HttpStatus.BAD_REQUEST)//may be different code\r\n                    .body(cause.getMessage());\r\n        }\r\n        return ResponseEntity\r\n                .status(HttpStatus.BAD_REQUEST)\r\n                .body(e.getMessage());\r\n    }\r\n```\r\n\r\n- Make your specific exception to extend  `ConstraintDeclarationException` and then have specific handler for it.\r\n```\r\n    public class InvalidIpException extends \r\n                                    ConstraintDeclarationException {\r\n```\r\n\r\n```\r\n    @ExceptionHandler(InvalidIpException.class)\r\n    public ResponseEntity handle(InvalidIpException e) {\r\n     ...\r\n    }\r\n```\r\n\r\n\r\n**Reference code**\r\n\r\n- https://github.com/hibernate/hibernate-validator/blob/master/engine/src/main/java/org/hibernate/validator/internal/engine/constraintvalidation/ConstraintTree.java#L183\r\n\r\n\r\n","title":"Return different HTTP status code from spring boot custom validators","body":"<p><strong>Current Behaviour</strong></p>\n<ul>\n<li><p>When an exception (which does not extend <code>ConstraintDeclarationException</code>) is thrown by the validator code instead of returning false, <code>javax.validation</code> wraps the exception in <code>ValidationException</code>. This is validator framework's behaviour and not a spring framework issue.</p>\n</li>\n<li><p>When an exception which extends <code>ConstraintDeclarationException</code> is thrown by the validator code instead of returning false, <code>javax.validation</code> framework propagates it.</p>\n</li>\n<li><p>If the validator returns false instead of throwing exception, Spring will convert all the validation errors into <code>global errors</code> or <code>field errors</code> and wrap them in <code>MethodArgumentNotValidException</code>  and throws it.</p>\n</li>\n</ul>\n<p><strong>Issue</strong></p>\n<ul>\n<li>The second option has field errors and global errors, custom status code can only be returned by inspecting the field name and error code. So this is not feasible as many fields can be added with that annotation.</li>\n<li>In the first option, Custom exceptions which were thrown in the validator are wrapped in <code>ValidationException</code> so exception specific handler is not possible.</li>\n</ul>\n<p><strong>Possible Solutions</strong></p>\n<ul>\n<li>Unwrap the specific exception which does not extend  <code>ConstraintDeclarationException</code> and map it</li>\n</ul>\n<pre><code>    @ExceptionHandler(ValidationException.class)\n    public ResponseEntity handle(ValidationException e) {\n        Throwable cause = e.getCause();\n        if (cause instanceof InvalidIpException) {\n            return ResponseEntity\n                    .status(HttpStatus.BAD_REQUEST)//may be different code\n                    .body(cause.getMessage());\n        }\n        if (cause instanceof InuseIpException) {\n            return ResponseEntity\n                    .status(HttpStatus.BAD_REQUEST)//may be different code\n                    .body(cause.getMessage());\n        }\n        return ResponseEntity\n                .status(HttpStatus.BAD_REQUEST)\n                .body(e.getMessage());\n    }\n</code></pre>\n<ul>\n<li>Make your specific exception to extend  <code>ConstraintDeclarationException</code> and then have specific handler for it.</li>\n</ul>\n<pre><code>    public class InvalidIpException extends \n                                    ConstraintDeclarationException {\n</code></pre>\n<pre><code>    @ExceptionHandler(InvalidIpException.class)\n    public ResponseEntity handle(InvalidIpException e) {\n     ...\n    }\n</code></pre>\n<p><strong>Reference code</strong></p>\n<ul>\n<li><a href=\"https://github.com/hibernate/hibernate-validator/blob/master/engine/src/main/java/org/hibernate/validator/internal/engine/constraintvalidation/ConstraintTree.java#L183\" rel=\"nofollow noreferrer\">https://github.com/hibernate/hibernate-validator/blob/master/engine/src/main/java/org/hibernate/validator/internal/engine/constraintvalidation/ConstraintTree.java#L183</a></li>\n</ul>\n"},{"tags":[],"owner":{"account_id":13304183,"reputation":1,"user_id":9604644,"display_name":"Ihnat Mikhalkovich"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1656326215,"creation_date":1655992814,"answer_id":72731483,"question_id":62740539,"body_markdown":"I will state my case here and you can apply my solution for your project I guess.\r\n\r\nMy annotation:\r\n\r\n```java\r\n@Target({ ElementType.PARAMETER, ElementType.FIELD })\r\n@Retention(RetentionPolicy.RUNTIME)\r\n@Constraint(validatedBy = ResourceIdConstraintValidator.class)\r\npublic @interface ResourceId {\r\n    String message() default &quot;Resource doesn&#39;t exist with given id.&quot;;\r\n    HttpStatus responseStatus() default HttpStatus.NOT_FOUND;\r\n    Class&lt;?&gt;[] groups() default {};\r\n    Class&lt;? extends Payload&gt;[] payload() default {};\r\n}\r\n```\r\n\r\nKeep in mind next line from annotation above, this is the key:\r\n\r\n```java\r\nHttpStatus responseStatus() default HttpStatus.NOT_FOUND;\r\n```\r\n\r\nMy validator:\r\n\r\n```java\r\n@Service\r\n@RequiredArgsConstructor\r\npublic class ResourceIdConstraintValidator implements ConstraintValidator&lt;ResourceId, Integer&gt; {\r\n\r\n    private final BinaryStorageService storageService;\r\n\r\n    @Override\r\n    public boolean isValid(Integer id, ConstraintValidatorContext context) {\r\n        return storageService.isResourceExist(id);\r\n    }\r\n}\r\n```\r\n\r\nMy Exception handler from my `RestControllerAdvice`:\r\n\r\n```java\r\n@ExceptionHandler(ConstraintViolationException.class)\r\npublic ResponseEntity&lt;ExceptionResponse&gt; handleConstraintViolationException(\r\n        ConstraintViolationException e,\r\n        HttpServletRequest request\r\n) {\r\n    final List&lt;String&gt; messages = e.getConstraintViolations().stream()\r\n            .map(ConstraintViolation::getMessage)\r\n            .toList();\r\n\r\n    final HttpStatus httpStatus = e.getConstraintViolations().stream()\r\n            .findFirst().map(violation -&gt;\r\n                    (HttpStatus) violation.getConstraintDescriptor().getAttributes().get(&quot;responseStatus&quot;)\r\n            ).orElse(HttpStatus.BAD_REQUEST);\r\n\r\n    final ExceptionResponse exceptionResponse = ExceptionResponse.builder()\r\n            .timestamp(ZonedDateTime.now())\r\n            .status(httpStatus.value())\r\n            .error(httpStatus.getReasonPhrase())\r\n            .message(messages)\r\n            .path(request.getServletPath())\r\n            .build();\r\n\r\n    return ResponseEntity.status(httpStatus)\r\n            .body(exceptionResponse);\r\n}\r\n```\r\n\r\nSo, I solved your issue in:\r\n\r\n```java\r\nfinal HttpStatus httpStatus = e.getConstraintViolations().stream()\r\n        .findFirst().map(violation -&gt;\r\n                (HttpStatus) violation.getConstraintDescriptor().getAttributes().get(&quot;responseStatus&quot;)\r\n        ).orElse(HttpStatus.BAD_REQUEST);\r\n```","title":"Return different HTTP status code from spring boot custom validators","body":"<p>I will state my case here and you can apply my solution for your project I guess.</p>\n<p>My annotation:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Target({ ElementType.PARAMETER, ElementType.FIELD })\n@Retention(RetentionPolicy.RUNTIME)\n@Constraint(validatedBy = ResourceIdConstraintValidator.class)\npublic @interface ResourceId {\n    String message() default &quot;Resource doesn't exist with given id.&quot;;\n    HttpStatus responseStatus() default HttpStatus.NOT_FOUND;\n    Class&lt;?&gt;[] groups() default {};\n    Class&lt;? extends Payload&gt;[] payload() default {};\n}\n</code></pre>\n<p>Keep in mind next line from annotation above, this is the key:</p>\n<pre class=\"lang-java prettyprint-override\"><code>HttpStatus responseStatus() default HttpStatus.NOT_FOUND;\n</code></pre>\n<p>My validator:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Service\n@RequiredArgsConstructor\npublic class ResourceIdConstraintValidator implements ConstraintValidator&lt;ResourceId, Integer&gt; {\n\n    private final BinaryStorageService storageService;\n\n    @Override\n    public boolean isValid(Integer id, ConstraintValidatorContext context) {\n        return storageService.isResourceExist(id);\n    }\n}\n</code></pre>\n<p>My Exception handler from my <code>RestControllerAdvice</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@ExceptionHandler(ConstraintViolationException.class)\npublic ResponseEntity&lt;ExceptionResponse&gt; handleConstraintViolationException(\n        ConstraintViolationException e,\n        HttpServletRequest request\n) {\n    final List&lt;String&gt; messages = e.getConstraintViolations().stream()\n            .map(ConstraintViolation::getMessage)\n            .toList();\n\n    final HttpStatus httpStatus = e.getConstraintViolations().stream()\n            .findFirst().map(violation -&gt;\n                    (HttpStatus) violation.getConstraintDescriptor().getAttributes().get(&quot;responseStatus&quot;)\n            ).orElse(HttpStatus.BAD_REQUEST);\n\n    final ExceptionResponse exceptionResponse = ExceptionResponse.builder()\n            .timestamp(ZonedDateTime.now())\n            .status(httpStatus.value())\n            .error(httpStatus.getReasonPhrase())\n            .message(messages)\n            .path(request.getServletPath())\n            .build();\n\n    return ResponseEntity.status(httpStatus)\n            .body(exceptionResponse);\n}\n</code></pre>\n<p>So, I solved your issue in:</p>\n<pre class=\"lang-java prettyprint-override\"><code>final HttpStatus httpStatus = e.getConstraintViolations().stream()\n        .findFirst().map(violation -&gt;\n                (HttpStatus) violation.getConstraintDescriptor().getAttributes().get(&quot;responseStatus&quot;)\n        ).orElse(HttpStatus.BAD_REQUEST);\n</code></pre>\n"}],"owner":{"account_id":4496339,"reputation":3703,"user_id":3656056,"accept_rate":53,"display_name":"VelNaga"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":6526,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":4,"score":2,"last_activity_date":1656326215,"creation_date":1593951214,"question_id":62740539,"body_markdown":"I am using `spring-boot version:2.0.5` \r\n\r\nGradle:\r\n\r\n    buildscript {\r\n    \text {\r\n    \t\tspringBootVersion = &#39;2.0.5.RELEASE&#39;\r\n    \t}\r\n    \trepositories {\r\n    \t\tmavenCentral()\r\n    \t}\r\n    \tdependencies {\r\n    \t\tclasspath(&quot;org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}&quot;)\r\n    \t}\r\n    }\r\n    \r\n    apply plugin: &#39;java&#39;\r\n    apply plugin: &#39;eclipse&#39;\r\n    apply plugin: &#39;org.springframework.boot&#39;\r\n    apply plugin: &#39;io.spring.dependency-management&#39;\r\n    \r\n    group = &#39;io.reflectoring&#39;\r\n    version = &#39;0.0.1-SNAPSHOT&#39;\r\n    sourceCompatibility = 11\r\n    \r\n    repositories {\r\n    \tmavenCentral()\r\n    }\r\n    \r\n    dependencies {\r\n    \timplementation(&#39;org.springframework.boot:spring-boot-starter-data-jpa&#39;)\r\n    \timplementation(&#39;org.springframework.boot:spring-boot-starter-validation&#39;)\r\n    \timplementation(&#39;org.springframework.boot:spring-boot-starter-web&#39;)\r\n    \truntimeOnly(&#39;com.h2database:h2&#39;)\r\n    \ttestImplementation(&#39;org.springframework.boot:spring-boot-starter-test&#39;)\r\n    \ttestImplementation(&#39;org.junit.jupiter:junit-jupiter-engine:5.0.1&#39;)\r\n    \r\n    \t// these dependencies are needed when running with Java 11, since they\r\n    \t// are no longer part of the JDK\r\n    \timplementation(&#39;javax.xml.bind:jaxb-api:2.3.1&#39;)\r\n    \timplementation(&#39;org.javassist:javassist:3.23.1-GA&#39;)\r\n    }\r\n    \r\n    test{\r\n    \tuseJUnitPlatform()\r\n    }\r\n\r\n\r\n**Controller**\r\n\r\n\r\n    @RestController\r\n    class ValidateRequestBodyController {\r\n    \r\n      @PostMapping(&quot;/validateBody&quot;)\r\n      ResponseEntity&lt;String&gt; validateBody(@Valid @RequestBody Input input) {\r\n        return ResponseEntity.ok(&quot;valid&quot;);\r\n      }\r\n    \r\n    }\r\n\r\n**Validator class**\r\n\r\n\r\n    class InputWithCustomValidator {\r\n    \r\n      @IpAddress\r\n      private String ipAddress;\r\n      \r\n      // ...\r\n    \r\n    }\r\n\r\n\r\n    class IpAddressValidator implements ConstraintValidator&lt;IpAddress, String&gt; {\r\n    \r\n      @Override\r\n      public boolean isValid(String value, ConstraintValidatorContext context) {\r\n        Pattern pattern = \r\n          Pattern.compile(&quot;^([0-9]{1,3})\\\\.([0-9]{1,3})\\\\.([0-9]{1,3})\\\\.([0-9]{1,3})$&quot;);\r\n        Matcher matcher = pattern.matcher(value);\r\n        //step 1\r\n        if (!matcher.matches()) {\r\n            return 400;\r\n          }\r\n        //Step 2\r\n          if (ipAddress already in DB) {\r\n            return 409; //conflict with other IP address\r\n          }\r\n          //Also I need to return different exception based on diff validations\r\n    \r\n      }\r\n    }\r\n\r\n\r\n**ControllerAdvice**\r\n\r\n\r\n    @ExceptionHandler(ValidationException.class)\r\n    public ResponseEntity&lt;ErrorResponse&gt; handle(ValidationException e) {\r\n        return ResponseEntity\r\n                .status(HttpStatus.BAD_REQUEST)\r\n                .body(e.getMessage());\r\n    }\r\n    \r\n        @ExceptionHandler(MethodArgumentNotValidException.class)\r\n    public ResponseEntity&lt;ErrorResponse&gt; handleMethodArgumentNotValidException(MethodArgumentNotValidException e) {\r\n        return ResponseEntity\r\n                .status(HttpStatus.BAD_REQUEST)\r\n                .body(e.getMessage());\r\n    }\r\n\r\n\r\nIf I throw customException from my validator then I used to get below error message even though I have corresponding controllerAdvice for it,\r\n\r\n\r\n    {\r\n      &quot;code&quot;: &quot;invalid_request&quot;\r\n        &quot;description&quot;: &quot;HV000028: Unexpected exception during isValid call.&quot;\r\n    }\r\n\r\n\r\nAlways, I am getting 400 Bad request since I have a controllerAdvice which always return 400.\r\n\r\nWhat I would like to achive here is, Is there any possibility to return customException with status code or is there anyway to return different status code from validator? I see similar posts in StackOverflow But there were no answer. I also checked other posts but I couldn&#39;t find it useful.\r\n\r\n\r\n\r\n","title":"Return different HTTP status code from spring boot custom validators","body":"<p>I am using <code>spring-boot version:2.0.5</code></p>\n<p>Gradle:</p>\n<pre><code>buildscript {\n    ext {\n        springBootVersion = '2.0.5.RELEASE'\n    }\n    repositories {\n        mavenCentral()\n    }\n    dependencies {\n        classpath(&quot;org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}&quot;)\n    }\n}\n\napply plugin: 'java'\napply plugin: 'eclipse'\napply plugin: 'org.springframework.boot'\napply plugin: 'io.spring.dependency-management'\n\ngroup = 'io.reflectoring'\nversion = '0.0.1-SNAPSHOT'\nsourceCompatibility = 11\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    implementation('org.springframework.boot:spring-boot-starter-data-jpa')\n    implementation('org.springframework.boot:spring-boot-starter-validation')\n    implementation('org.springframework.boot:spring-boot-starter-web')\n    runtimeOnly('com.h2database:h2')\n    testImplementation('org.springframework.boot:spring-boot-starter-test')\n    testImplementation('org.junit.jupiter:junit-jupiter-engine:5.0.1')\n\n    // these dependencies are needed when running with Java 11, since they\n    // are no longer part of the JDK\n    implementation('javax.xml.bind:jaxb-api:2.3.1')\n    implementation('org.javassist:javassist:3.23.1-GA')\n}\n\ntest{\n    useJUnitPlatform()\n}\n</code></pre>\n<p><strong>Controller</strong></p>\n<pre><code>@RestController\nclass ValidateRequestBodyController {\n\n  @PostMapping(&quot;/validateBody&quot;)\n  ResponseEntity&lt;String&gt; validateBody(@Valid @RequestBody Input input) {\n    return ResponseEntity.ok(&quot;valid&quot;);\n  }\n\n}\n</code></pre>\n<p><strong>Validator class</strong></p>\n<pre><code>class InputWithCustomValidator {\n\n  @IpAddress\n  private String ipAddress;\n  \n  // ...\n\n}\n\n\nclass IpAddressValidator implements ConstraintValidator&lt;IpAddress, String&gt; {\n\n  @Override\n  public boolean isValid(String value, ConstraintValidatorContext context) {\n    Pattern pattern = \n      Pattern.compile(&quot;^([0-9]{1,3})\\\\.([0-9]{1,3})\\\\.([0-9]{1,3})\\\\.([0-9]{1,3})$&quot;);\n    Matcher matcher = pattern.matcher(value);\n    //step 1\n    if (!matcher.matches()) {\n        return 400;\n      }\n    //Step 2\n      if (ipAddress already in DB) {\n        return 409; //conflict with other IP address\n      }\n      //Also I need to return different exception based on diff validations\n\n  }\n}\n</code></pre>\n<p><strong>ControllerAdvice</strong></p>\n<pre><code>@ExceptionHandler(ValidationException.class)\npublic ResponseEntity&lt;ErrorResponse&gt; handle(ValidationException e) {\n    return ResponseEntity\n            .status(HttpStatus.BAD_REQUEST)\n            .body(e.getMessage());\n}\n\n    @ExceptionHandler(MethodArgumentNotValidException.class)\npublic ResponseEntity&lt;ErrorResponse&gt; handleMethodArgumentNotValidException(MethodArgumentNotValidException e) {\n    return ResponseEntity\n            .status(HttpStatus.BAD_REQUEST)\n            .body(e.getMessage());\n}\n</code></pre>\n<p>If I throw customException from my validator then I used to get below error message even though I have corresponding controllerAdvice for it,</p>\n<pre><code>{\n  &quot;code&quot;: &quot;invalid_request&quot;\n    &quot;description&quot;: &quot;HV000028: Unexpected exception during isValid call.&quot;\n}\n</code></pre>\n<p>Always, I am getting 400 Bad request since I have a controllerAdvice which always return 400.</p>\n<p>What I would like to achive here is, Is there any possibility to return customException with status code or is there anyway to return different status code from validator? I see similar posts in StackOverflow But there were no answer. I also checked other posts but I couldn't find it useful.</p>\n"},{"tags":["java","android","exoplayer","referer"],"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1654186177,"post_id":72479178,"comment_id":128036451,"body_markdown":"Please trim your code to make it easier to find your problem. Follow these guidelines to create a [minimal reproducible example](https://stackoverflow.com/help/minimal-reproducible-example).","body":"Please trim your code to make it easier to find your problem. Follow these guidelines to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."},{"owner":{"account_id":39846,"reputation":991143,"user_id":115145,"accept_rate":84,"display_name":"CommonsWare"},"score":0,"creation_date":1654187151,"post_id":72479178,"comment_id":128036775,"body_markdown":"https://github.com/google/ExoPlayer/issues/1619#issuecomment-227915284 https://github.com/google/ExoPlayer/issues/8292","body":"<a href=\"https://github.com/google/ExoPlayer/issues/1619#issuecomment-227915284\" rel=\"nofollow noreferrer\">github.com/google/ExoPlayer/issues/1619#issuecomment-2279152&zwnj;&#8203;84</a> <a href=\"https://github.com/google/ExoPlayer/issues/8292\" rel=\"nofollow noreferrer\">github.com/google/ExoPlayer/issues/8292</a>"}],"answers":[{"tags":[],"owner":{"account_id":4255730,"reputation":11,"user_id":6179330,"display_name":"roxy"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1656326140,"creation_date":1656201561,"answer_id":72758064,"question_id":72479178,"body_markdown":"I remember that was changed with the newer updates at some point last year. Now you need to pass a map to `setDefaultRequestProperties` after building a `HttpDataSource`. Using a [`DefaultHttpDataSource.Factory`][1] should be enough if you are not considering using a custom one.\r\n\r\n\r\n  [1]: https://exoplayer.dev/doc/reference/com/google/android/exoplayer2/upstream/DefaultHttpDataSource.Factory.html","title":"How can we add referer in the exoplayer android java","body":"<p>I remember that was changed with the newer updates at some point last year. Now you need to pass a map to <code>setDefaultRequestProperties</code> after building a <code>HttpDataSource</code>. Using a <a href=\"https://exoplayer.dev/doc/reference/com/google/android/exoplayer2/upstream/DefaultHttpDataSource.Factory.html\" rel=\"nofollow noreferrer\"><code>DefaultHttpDataSource.Factory</code></a> should be enough if you are not considering using a custom one.</p>\n"}],"owner":{"account_id":14530020,"reputation":1,"user_id":10495227,"display_name":"Nadeem Ahmad"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1046,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1656326140,"creation_date":1654186070,"question_id":72479178,"body_markdown":"I want to play this link but i m unable to play this link in my exoplayer\r\n\r\nI will be able to play this link only when this referer will be added in the exoplayer but i m unable to add this referer. I dont know how can i add this referer to my exoplayer\r\n\r\nReferer: http://nbajunkie.xyz/jp1/\r\n\r\nhttps://reels2watch.com/hls/s1.m3u8\r\n\r\n    dataSourceFactory.getDefaultRequestProperties().set(&quot;Referer&quot;, &quot;https://yourdomain.com&quot;);\r\n\r\nI dont know how to add this referer in the header can someone help me about it or Anyone can do it for me ? Because i don’t know much about java kindly let me know how to solve this issue.\r\n\r\n\r\n\r\n\r\n\r\n\r\n    \r\n    import static com.google.android.exoplayer2.util.Util.getUserAgent;\r\n    \r\n    import android.content.Context;\r\n    import android.content.Intent;\r\n    import android.net.Uri;\r\n    import android.os.Bundle;\r\n    import android.os.Handler;\r\n    import android.support.v4.media.session.PlaybackStateCompat;\r\n    import android.text.TextUtils;\r\n    import android.util.Log;\r\n    import android.view.View;\r\n    import android.view.WindowManager;\r\n    import android.widget.ProgressBar;\r\n    import android.widget.Toast;\r\n    import androidx.annotation.NonNull;\r\n    import androidx.mediarouter.app.MediaRouteButton;\r\n    import com.google.android.exoplayer2.C;\r\n    import com.google.android.exoplayer2.DefaultLoadControl;\r\n    import com.google.android.exoplayer2.DefaultRenderersFactory;\r\n    import com.google.android.exoplayer2.LoadControl;\r\n    import com.google.android.exoplayer2.PlaybackException;\r\n    import com.google.android.exoplayer2.PlaybackParameters;\r\n    import com.google.android.exoplayer2.Player;\r\n    import com.google.android.exoplayer2.RenderersFactory;\r\n    import com.google.android.exoplayer2.SimpleExoPlayer;\r\n    import com.google.android.exoplayer2.source.DefaultMediaSourceFactory;\r\n    import com.google.android.exoplayer2.source.MediaSource;\r\n    import com.google.android.exoplayer2.source.ProgressiveMediaSource;\r\n    import com.google.android.exoplayer2.source.TrackGroupArray;\r\n    import com.google.android.exoplayer2.source.dash.DashMediaSource;\r\n    import com.google.android.exoplayer2.source.dash.DefaultDashChunkSource;\r\n    import com.google.android.exoplayer2.source.hls.HlsMediaSource;\r\n    import com.google.android.exoplayer2.source.smoothstreaming.DefaultSsChunkSource;\r\n    import com.google.android.exoplayer2.source.smoothstreaming.SsMediaSource;\r\n    import com.google.android.exoplayer2.trackselection.TrackSelectionArray;\r\n    import com.google.android.exoplayer2.ui.PlayerView;\r\n    import com.google.android.exoplayer2.upstream.BandwidthMeter;\r\n    import com.google.android.exoplayer2.upstream.DataSource;\r\n    import com.google.android.exoplayer2.upstream.DefaultBandwidthMeter;\r\n    import com.google.android.exoplayer2.upstream.DefaultDataSourceFactory;\r\n    import com.google.android.exoplayer2.upstream.DefaultHttpDataSource;\r\n    import com.google.android.exoplayer2.upstream.DefaultHttpDataSourceFactory;\r\n    import com.google.android.exoplayer2.upstream.HttpDataSource;\r\n    import com.google.android.exoplayer2.util.Util;\r\n    import com.google.android.gms.ads.AdRequest;\r\n    import com.google.android.gms.ads.LoadAdError;\r\n    import com.google.android.gms.ads.interstitial.InterstitialAd;\r\n    import com.google.android.gms.ads.interstitial.InterstitialAdLoadCallback;\r\n    import com.google.android.gms.cast.MediaInfo;\r\n    import com.google.android.gms.cast.MediaLoadOptions;\r\n    import com.google.android.gms.cast.MediaMetadata;\r\n    import com.google.android.gms.cast.framework.CastButtonFactory;\r\n    import com.google.android.gms.cast.framework.CastContext;\r\n    import com.google.android.gms.cast.framework.CastSession;\r\n    import com.google.android.gms.cast.framework.CastState;\r\n    import com.google.android.gms.cast.framework.CastStateListener;\r\n    import com.google.android.gms.cast.framework.SessionManagerListener;\r\n    import com.google.android.gms.cast.framework.media.RemoteMediaClient;\r\n    import com.google.firebase.FirebaseApp;\r\n    import com.google.firebase.firestore.FirebaseFirestore;\r\n    import com.Myapp.hd.Steaming.R;\r\n    import com.Myapp.hd.Steaming.HelperClass;\r\n    import com.Myapp.hd.Steaming.BaseActivity;\r\n    import com.Myapp.hd.Steaming.Location;\r\n    import com.Myapp.hd.Steaming.sessionManager.SessionManager;\r\n    import org.jetbrains.annotations.NotNull;\r\n    \r\n    import java.util.HashMap;\r\n    import java.util.Map;\r\n    \r\n    \r\n    public class Exo_Player extends BaseActivity {\r\n    \r\n        private static final String TAG = &quot;Exo_Player&quot;;\r\n        String url, userAgent;\r\n        boolean tokenEnable = false;\r\n        private InterstitialAd interstitial;\r\n        private PlayerView playerView;\r\n        private SimpleExoPlayer player;\r\n        private static final DefaultBandwidthMeter BANDWIDTH_METER = new DefaultBandwidthMeter();\r\n        private DataSource.Factory mediaDataSourceFactory;\r\n        private Handler mainHandler;\r\n        private ProgressBar progressBar;\r\n        FirebaseFirestore db;\r\n        SessionManager sessionManager;\r\n        FirebaseFirestore firebaseFirestore;\r\n    \r\n        @Override\r\n        protected void onCreate(Bundle savedInstanceState) {\r\n            super.onCreate(savedInstanceState);\r\n    \r\n            this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);\r\n            getWindow().setFlags(WindowManager.LayoutParams.FLAG_SECURE, WindowManager.LayoutParams.FLAG_SECURE);\r\n    //////////////////////////////////////////////////////\r\n            setContentView(R.layout.exo_player_ui);\r\n            castContext = CastContext.getSharedInstance(this);\r\n            initCast();\r\n            db = FirebaseFirestore.getInstance();\r\n            sessionManager = new SessionManager(this);\r\n            FirebaseApp.initializeApp(this);\r\n    \r\n            AdRequest adRequest = new AdRequest.Builder().build();\r\n    \r\n            InterstitialAd.load(Exo_Player.this, sessionManager.getBackads(), adRequest,\r\n                    new InterstitialAdLoadCallback() {\r\n                        @Override\r\n                        public void onAdLoaded(@NonNull InterstitialAd interstitialAd) {\r\n                            // The mInterstitialAd reference will be null until\r\n                            // an ad is loaded.\r\n                            interstitial = interstitialAd;\r\n                            Log.i(TAG, &quot;onAdLoaded&quot;);\r\n                        }\r\n    \r\n                        @Override\r\n                        public void onAdFailedToLoad(@NonNull LoadAdError loadAdError) {\r\n                            // Handle the error\r\n                            Log.i(TAG, loadAdError.getMessage());\r\n                            interstitial = null;\r\n                        }\r\n                    });\r\n    \r\n    \r\n            progressBar = findViewById(R.id.progressBar);\r\n    \r\n    \r\n            processToken();\r\n    \r\n            listenCast();\r\n    \r\n    \r\n    \r\n    \r\n        }\r\n    \r\n        MediaRouteButton mediaRouteButton;\r\n        CastContext castContext;\r\n        RemoteMediaClient remoteMediaClient;\r\n    \r\n        public boolean initCast() {\r\n            url = getIntent().getStringExtra(getString(R.string.url));\r\n            userAgent = getIntent().getStringExtra(getString(R.string.user_agent));\r\n            tokenEnable = getIntent().getBooleanExtra(getString(R.string.t_enable), false);\r\n    \r\n            mediaRouteButton = (MediaRouteButton) findViewById(R.id.media_route_button);\r\n            CastButtonFactory.setUpMediaRouteButton(getApplicationContext(), mediaRouteButton);\r\n            if (castContext == null)\r\n                castContext = CastContext.getSharedInstance(this);\r\n    \r\n            castContext.addCastStateListener(new CastStateListener() {\r\n                @Override\r\n                public void onCastStateChanged(int state) {\r\n                    /*if (state == CastState.NO_DEVICES_AVAILABLE) {\r\n    //                    mediaRouteButton.setVisibility(View.GONE);\r\n                    }\r\n                    else if(state==CastState.CONNECTING) {\r\n                        showToast(&quot;Connecting&quot;);\r\n                    } else*/ if (state == CastState.CONNECTED) {\r\n    //                    showToast(&quot;Connected&quot;);\r\n    //                    castMetadata();\r\n                        openCastPlayer();\r\n                    }/* else if (mediaRouteButton.getVisibility() == View.GONE) {\r\n                        mediaRouteButton.setVisibility(View.VISIBLE);\r\n                    }*/\r\n                }\r\n            });\r\n            if (castContext.getCastState() == CastState.CONNECTED) {\r\n                openCastPlayer();\r\n                return true;\r\n            } else {\r\n    //                showToast(&quot;not connected&quot;);\r\n            }\r\n            if (castContext.getCastState() != CastState.NO_DEVICES_AVAILABLE)\r\n                mediaRouteButton.setVisibility(View.VISIBLE);\r\n            return false;\r\n        }\r\n    \r\n        private void registerListener() {\r\n            if (mCastContext != null) {\r\n    \r\n                mCastContext.getSessionManager().addSessionManagerListener(\r\n                        mSessionManagerListener, CastSession.class);\r\n            }\r\n        }\r\n    \r\n        private void unRegisterListener() {\r\n            if (mCastContext != null) {\r\n                mCastContext.getSessionManager().removeSessionManagerListener(\r\n                        mSessionManagerListener, CastSession.class);\r\n            }\r\n        }\r\n    \r\n    \r\n        private void showToast(String connecting) {\r\n            Toast.makeText(this, connecting, Toast.LENGTH_SHORT).show();\r\n        }\r\n    \r\n    \r\n        private void processToken() {\r\n            if (!HelperClass.isValid(url) || !tokenEnable) {\r\n                init(&quot;&quot;);\r\n                return;\r\n            }\r\n    \r\n            HashMap&lt;String, Object&gt; hashMap = new HashMap&lt;&gt;();\r\n            enqueue(getLocInterface().getLoc(sessionManager.getToken(), hashMap), new CallBack&lt;Location&gt;() {\r\n                @Override\r\n                public void onComplete() {\r\n                    super.onComplete();\r\n                }\r\n    \r\n                @Override\r\n                public void onError(Throwable e) {\r\n                    super.onError(e);\r\n                    Toast.makeText(Exo_Player.this,\r\n                            &quot;Failed to process url&quot;, Toast.LENGTH_SHORT).show();\r\n                }\r\n    \r\n                @Override\r\n                public void onNext(@NotNull Location location) {\r\n                    super.onNext(location);\r\n                    if (location.appendResult != null)\r\n                        init(location.appendResult);\r\n                }\r\n            });\r\n        }\r\n    \r\n        private void init(String s) {\r\n    \r\n    \r\n            url += s;\r\n    \r\n            Log.e(TAG, &quot;init: new url is &quot; + url);\r\n            mediaDataSourceFactory = buildDataSourceFactory(true);\r\n    \r\n            mainHandler = new Handler();\r\n            BandwidthMeter bandwidthMeter = new DefaultBandwidthMeter();\r\n    \r\n            RenderersFactory renderersFactory = new DefaultRenderersFactory(this);\r\n    \r\n    //        TrackSelection.Factory videoTrackSelectionFactory = new AdaptiveTrackSelection.Factory(bandwidthMeter);\r\n    //        TrackSelector trackSelector = new DefaultTrackSelector(videoTrackSelectionFactory);\r\n    \r\n    //        TrackSelector trackSelector = new DefaultTrackSelector();\r\n    \r\n            LoadControl loadControl = new DefaultLoadControl();\r\n    \r\n            player = new SimpleExoPlayer.Builder(this, renderersFactory).setLoadControl(loadControl).build();\r\n    \r\n    \r\n            playerView = findViewById(R.id.exoPlayerView);\r\n            playerView.setPlayer(player);\r\n            playerView.setUseController(true);\r\n            playerView.requestFocus();\r\n    \r\n            Uri uri = Uri.parse(url);\r\n            final MediaSource mediaSource = buildMediaSource(uri, null);\r\n            player.prepare(mediaSource);\r\n            player.setPlayWhenReady(true);\r\n    \r\n            player.addListener(new Player.Listener() {\r\n                @Override\r\n                public void onTracksChanged(@NotNull TrackGroupArray trackGroups, @NotNull TrackSelectionArray trackSelections) {\r\n                    Log.d(TAG, &quot;onTracksChanged: &quot; + trackGroups.length);\r\n                }\r\n    \r\n                @Override\r\n                public void onIsLoadingChanged(boolean isLoading) {\r\n                    Log.d(TAG, &quot;onLoadingChanged: &quot; + isLoading);\r\n                }\r\n    \r\n                @Override\r\n                public void onPlayerStateChanged(boolean playWhenReady, int playbackState) {\r\n                    Log.d(TAG, &quot;onPlayerStateChanged: &quot; + playWhenReady);\r\n                    if (playbackState == PlaybackStateCompat.STATE_PLAYING) {\r\n                        progressBar.setVisibility(View.GONE);\r\n                    }\r\n                }\r\n    \r\n                @Override\r\n                public void onRepeatModeChanged(int repeatMode) {\r\n    \r\n                }\r\n    \r\n                @Override\r\n                public void onShuffleModeEnabledChanged(boolean shuffleModeEnabled) {\r\n    \r\n                }\r\n    \r\n                @Override\r\n                public void onPlayerError(@NotNull PlaybackException error) {\r\n                    Log.e(TAG, &quot;onPlayerError: &quot;, error);\r\n                    player.stop();\r\n    //                errorDialog();\r\n                    player.prepare(mediaSource);\r\n                    player.setPlayWhenReady(true);\r\n    \r\n    \r\n                }\r\n    \r\n                @Override\r\n                public void onPositionDiscontinuity(int reason) {\r\n                    Log.d(TAG, &quot;onPositionDiscontinuity: true&quot;);\r\n                }\r\n    \r\n                @Override\r\n                public void onPlaybackParametersChanged(@NotNull PlaybackParameters playbackParameters) {\r\n    \r\n    \r\n                }\r\n    \r\n                @Override\r\n                public void onSeekProcessed() {\r\n    \r\n                }\r\n            });\r\n    \r\n            Log.d(&quot;INFO&quot;, &quot;ActivityVideoPlayer&quot;);\r\n    \r\n        }\r\n    \r\n    \r\n        private void pausePlayer() {\r\n            player.setPlayWhenReady(false);\r\n            player.getPlaybackState();\r\n        }\r\n    \r\n        private void startPlayer() {\r\n            player.setPlayWhenReady(true);\r\n            player.getPlaybackState();\r\n        }\r\n    \r\n    \r\n        @Override\r\n        protected void onPause() {\r\n            super.onPause();\r\n            try {\r\n                unRegisterListener();\r\n                pausePlayer();\r\n            } catch (Exception e) {\r\n                e.printStackTrace();\r\n            }\r\n        }\r\n    \r\n        @Override\r\n        protected void onResume() {\r\n            super.onResume();\r\n            getWindow().getDecorView().setSystemUiVisibility(View.SYSTEM_UI_FLAG_FULLSCREEN\r\n                    | View.SYSTEM_UI_FLAG_IMMERSIVE_STICKY\r\n                    | View.SYSTEM_UI_FLAG_HIDE_NAVIGATION);\r\n            /////////////////////////////////////////////\r\n            try {\r\n                registerListener();\r\n                if (HelperClass.vpn(this)) {\r\n                    finish();\r\n                }\r\n                startPlayer();\r\n            } catch (Exception e) {\r\n                e.printStackTrace();\r\n            }\r\n        }\r\n    \r\n    \r\n        @Override\r\n        public void onDestroy() {\r\n            super.onDestroy();\r\n            Log.v(TAG, &quot;onDestroy()...&quot;);\r\n            if (player != null)\r\n                player.release();\r\n        }\r\n    \r\n        private MediaSource buildMediaSource(Uri uri, String overrideExtension) {\r\n            int type = TextUtils.isEmpty(overrideExtension) ? Util.inferContentType(uri)\r\n                    : Util.inferContentType(&quot;.&quot; + overrideExtension);\r\n            switch (type) {\r\n                case C.TYPE_SS:\r\n                    return new SsMediaSource.Factory(new DefaultSsChunkSource.Factory(mediaDataSourceFactory), buildDataSourceFactory(false)).createMediaSource(uri);\r\n                case C.TYPE_DASH:\r\n                    return new DashMediaSource.Factory(new DefaultDashChunkSource.Factory(mediaDataSourceFactory), buildDataSourceFactory(false)).createMediaSource(uri);\r\n                case C.TYPE_HLS:\r\n                    return new HlsMediaSource.Factory(mediaDataSourceFactory).createMediaSource(uri);\r\n                case C.TYPE_OTHER:\r\n                    return new ProgressiveMediaSource.Factory(mediaDataSourceFactory).createMediaSource(uri);\r\n                default: {\r\n                    throw new IllegalStateException(&quot;Unsupported type: &quot; + type);\r\n                }\r\n            }\r\n        }\r\n    \r\n    \r\n        private DataSource.Factory buildDataSourceFactory(boolean useBandwidthMeter) {\r\n            return buildDataSourceFactory(useBandwidthMeter ? BANDWIDTH_METER : null);\r\n        }\r\n    \r\n        public DataSource.Factory buildDataSourceFactory(DefaultBandwidthMeter bandwidthMeter) {\r\n            return new DefaultDataSourceFactory(this, bandwidthMeter,\r\n                    buildHttpDataSourceFactory(bandwidthMeter));\r\n        }\r\n    \r\n    \r\n        public HttpDataSource.Factory buildHttpDataSourceFactory(DefaultBandwidthMeter bandwidthMeter) {\r\n    \r\n    \r\n            String s = &quot;xxxxx&quot;;\r\n            if (userAgent != null &amp;&amp; !userAgent.isEmpty()) {\r\n                s = userAgent;\r\n            }\r\n            return new DefaultHttpDataSourceFactory(getUserAgent2(this, s), bandwidthMeter);\r\n    \r\n        }\r\n    \r\n    \r\n    \r\n        public static String getUserAgent2(Context context, String applicationName) {\r\n            return applicationName\r\n                    + &quot;&quot;;\r\n        }\r\n    \r\n    \r\n        @Override\r\n        public void onBackPressed() {\r\n            super.onBackPressed();\r\n            if (interstitial != null) {\r\n                interstitial.show(Exo_Player.this);\r\n            }\r\n            if (player != null)\r\n                player.stop();\r\n        }\r\n    \r\n    //    public void errorDialog() {\r\n    //        new AlertDialog.Builder(this)\r\n    //                .setIcon(android.R.drawable.ic_dialog_alert)\r\n    //                .setTitle(getResources().getString(R.string.msg_oops))\r\n    //                .setCancelable(false)\r\n    //                .setMessage(getResources().getString(R.string.msg_failed))\r\n    //                .setPositiveButton(getResources().getString(R.string.option_retry), new DialogInterface.OnClickListener() {\r\n    //                    @Override\r\n    //                    public void onClick(DialogInterface dialog, int which) {\r\n    //                        retryLoad();\r\n    //                  z  }\r\n    //\r\n    //                })\r\n    //                .setNegativeButton(getResources().getString(R.string.option_no), new DialogInterface.OnClickListener() {\r\n    //                    @Override\r\n    //                    public void onClick(DialogInterface dialogInterface, int i) {\r\n    //                        finish();\r\n    //                    }\r\n    //                })\r\n    //                .show();\r\n    //    }\r\n    \r\n    //    public void retryLoad() {\r\n    //        Uri uri = Uri.parse(url);\r\n    //        MediaSource mediaSource = buildMediaSource(uri, null);\r\n    //        player.prepare(mediaSource);\r\n    //        player.setPlayWhenReady(true);\r\n    //    }\r\n    \r\n        public void castplayer(String name, String link, String unique, String img) {\r\n    \r\n            if (!isCastApiAvailable()) {\r\n                return;\r\n            }\r\n    \r\n            Context context = this;\r\n            CastSession castSession = CastContext.getSharedInstance(context).getSessionManager()\r\n                    .getCurrentCastSession();\r\n            if (castSession.isConnected()) {\r\n    \r\n                MediaMetadata movieMetadata = new MediaMetadata(MediaMetadata.MEDIA_TYPE_GENERIC);\r\n                movieMetadata.putString(MediaMetadata.KEY_TITLE, name);\r\n    \r\n    \r\n    \r\n                MediaInfo mediaInfo = new MediaInfo.Builder(link)\r\n                        .setMetadata(movieMetadata)\r\n                        .setEntity(unique)\r\n                        .build();\r\n    \r\n                final RemoteMediaClient remoteMediaClient = castSession.getRemoteMediaClient();\r\n                if (remoteMediaClient == null) {\r\n    //                Timber.tag(TAG).w(&quot;showQueuePopup(): null RemoteMediaClient&quot;);\r\n                    return;\r\n                }\r\n    \r\n                if (remoteMediaClient.isPlaying()) {\r\n                    MediaInfo curMedia = remoteMediaClient.getMediaInfo();\r\n                    if (curMedia != null &amp;&amp; curMedia.getEntity().equals(unique)) {\r\n                        return;\r\n                    }\r\n                }\r\n    \r\n                if (remoteMediaClient.isLoadingNextItem() || remoteMediaClient.isBuffering()) {\r\n                    return;\r\n                }\r\n    //            final QueueDataProvider provider = QueueDataProvider.getInstance(context);\r\n    //            PopupMenu popup = new PopupMenu(context, binding.epLayout);\r\n    //            popup.getMenuInflater().inflate(\r\n    //                    provider.isQueueDetached() || provider.getCount() == 0\r\n    //                            ? R.menu.detached_popup_add_to_queue\r\n    //                            : R.menu.popup_add_to_queue, popup.getMenu());\r\n    //            PopupMenu.OnMenuItemClickListener clickListener = menuItem -&gt; {\r\n    //            QueueDataProvider provider1 = QueueDataProvider.getInstance(context);\r\n    //            MediaQueueItem queueItem = new MediaQueueItem.Builder(mediaInfo).setAutoplay(\r\n    //                    false).setPreloadTime(2).build();\r\n    //            MediaQueueItem[] newItemArray = new MediaQueueItem[]{queueItem};\r\n    //            String toastMessage = null;\r\n    //            if (provider1.isQueueDetached() &amp;&amp; provider1.getCount() &gt; 0) {\r\n    //                    if ((menuItem.getItemId() == R.id.action_play_now)\r\n    //                            || (menuItem.getItemId() == R.id.action_add_to_queue)) {\r\n    //                MediaQueueItem[] items = Utils\r\n    //                        .rebuildQueueAndAppend(provider1.getItems(), queueItem);\r\n    //                remoteMediaClient.queueLoad(items, provider1.getCount(),\r\n    //                        MediaStatus.REPEAT_MODE_REPEAT_OFF, null);\r\n    //                    } else {\r\n    //                        return false;\r\n    //                    }\r\n    //            } else {\r\n    //                if (provider1.getCount() == 0) {\r\n    //                    remoteMediaClient.queueLoad(newItemArray, 0,\r\n    //                            MediaStatus.REPEAT_MODE_REPEAT_OFF, null);\r\n    //                } else {\r\n    //                    int currentId = provider1.getCurrentItemId();\r\n    ////                        if (menuItem.getItemId() == R.id.action_play_now) {\r\n    //                    remoteMediaClient.queueInsertAndPlayItem(queueItem, currentId, null);\r\n                remoteMediaClient.load(mediaInfo, new MediaLoadOptions.Builder().build());\r\n    \r\n    \r\n    //                        } else if (menuItem.getItemId() == R.id.action_play_next) {\r\n    //                            int currentPosition = provider1.getPositionByItemId(currentId);\r\n    //                            if (currentPosition == provider1.getCount() - 1) {\r\n    //                                //we are adding to the end of queue\r\n    //                                remoteMediaClient.queueAppendItem(queueItem, null);\r\n    //                            } else {\r\n    //                                int nextItemId = provider1.getItem(currentPosition + 1).getItemId();\r\n    //                                remoteMediaClient.queueInsertItems(newItemArray, nextItemId, null);\r\n    //                            }\r\n    //                            toastMessage = context.getString(\r\n    //                                    R.string.queue_item_added_to_play_next);\r\n    //                        } else if (menuItem.getItemId() == R.id.action_add_to_queue) {\r\n    //                            remoteMediaClient.queueAppendItem(queueItem, null);\r\n    //                            toastMessage = context.getString(R.string.queue_item_added_to_queue);\r\n    //                        } else {\r\n    //                            return false;\r\n    //                        }\r\n    //                }\r\n    //            }\r\n    //                if (menuItem.getItemId() == R.id.action_play_now) {\r\n                Intent intent = new Intent(context, ExpandedControlsActivity.class);\r\n                context.startActivity(intent);\r\n    //                }\r\n    //            if (!TextUtils.isEmpty(toastMessage)) {\r\n    //                Toast.makeText(context, toastMessage, Toast.LENGTH_SHORT).show();\r\n    //            }\r\n    //                return true;\r\n    //            };\r\n    //            popup.setOnMenuItemClickListener(clickListener);\r\n    //            popup.show();\r\n    //        }\r\n            } else {\r\n                Toast.makeText(context,\r\n                        &quot;Not Connected&quot;, Toast.LENGTH_SHORT).show();\r\n            }\r\n        }\r\n    \r\n    \r\n    \r\n        private CastContext mCastContext;\r\n        private CastSession mCastSession;\r\n        private SessionManagerListener&lt;CastSession&gt; mSessionManagerListener;\r\n    \r\n        private void listenCast() {\r\n            if (!isCastApiAvailable()) {\r\n                return;\r\n            }\r\n            setupCastListener();\r\n            mCastContext = CastContext.getSharedInstance(this);\r\n            mCastSession = mCastContext.getSessionManager().getCurrentCastSession();\r\n        }\r\n    \r\n        private void setupCastListener() {\r\n            mSessionManagerListener = new SessionManagerListener&lt;CastSession&gt;() {\r\n    \r\n                @Override\r\n                public void onSessionEnded(CastSession session, int error) {\r\n                    onApplicationDisconnected();\r\n                    mCastContext = null;\r\n                    mCastSession = null;\r\n                }\r\n    \r\n                @Override\r\n                public void onSessionResumed(CastSession session, boolean wasSuspended) {\r\n                    onApplicationConnected(session);\r\n    \r\n                }\r\n    \r\n                @Override\r\n                public void onSessionResumeFailed(CastSession session, int error) {\r\n                    onApplicationDisconnected();\r\n    \r\n                }\r\n    \r\n                @Override\r\n                public void onSessionStarted(CastSession session, String sessionId) {\r\n                    onApplicationConnected(session);\r\n    \r\n                }\r\n    \r\n                @Override\r\n                public void onSessionStartFailed(CastSession session, int error) {\r\n                    onApplicationDisconnected();\r\n    \r\n                }\r\n    \r\n                @Override\r\n                public void onSessionStarting(CastSession session) {\r\n    \r\n                }\r\n    \r\n                @Override\r\n                public void onSessionEnding(CastSession session) {\r\n    \r\n                }\r\n    \r\n                @Override\r\n                public void onSessionResuming(CastSession session, String sessionId) {\r\n    \r\n                }\r\n    \r\n                @Override\r\n                public void onSessionSuspended(CastSession session, int reason) {\r\n    \r\n                }\r\n    \r\n                private void onApplicationConnected(CastSession castSession) {\r\n                    mCastSession = castSession;\r\n                    openCastPlayer();\r\n                    invalidateOptionsMenu();\r\n                }\r\n    \r\n                private void onApplicationDisconnected() {\r\n                    invalidateOptionsMenu();\r\n                }\r\n            };\r\n        }\r\n    \r\n        private void openCastPlayer() {\r\n            castplayer(getString(R.string.app_name), url, url, url);\r\n            finish();\r\n        }\r\n    \r\n    }\r\n\r\n\r\n","title":"How can we add referer in the exoplayer android java","body":"<p>I want to play this link but i m unable to play this link in my exoplayer</p>\n<p>I will be able to play this link only when this referer will be added in the exoplayer but i m unable to add this referer. I dont know how can i add this referer to my exoplayer</p>\n<p>Referer: <a href=\"http://nbajunkie.xyz/jp1/\" rel=\"nofollow noreferrer\">http://nbajunkie.xyz/jp1/</a></p>\n<p><a href=\"https://reels2watch.com/hls/s1.m3u8\" rel=\"nofollow noreferrer\">https://reels2watch.com/hls/s1.m3u8</a></p>\n<pre><code>dataSourceFactory.getDefaultRequestProperties().set(&quot;Referer&quot;, &quot;https://yourdomain.com&quot;);\n</code></pre>\n<p>I dont know how to add this referer in the header can someone help me about it or Anyone can do it for me ? Because i don’t know much about java kindly let me know how to solve this issue.</p>\n<pre><code>import static com.google.android.exoplayer2.util.Util.getUserAgent;\n\nimport android.content.Context;\nimport android.content.Intent;\nimport android.net.Uri;\nimport android.os.Bundle;\nimport android.os.Handler;\nimport android.support.v4.media.session.PlaybackStateCompat;\nimport android.text.TextUtils;\nimport android.util.Log;\nimport android.view.View;\nimport android.view.WindowManager;\nimport android.widget.ProgressBar;\nimport android.widget.Toast;\nimport androidx.annotation.NonNull;\nimport androidx.mediarouter.app.MediaRouteButton;\nimport com.google.android.exoplayer2.C;\nimport com.google.android.exoplayer2.DefaultLoadControl;\nimport com.google.android.exoplayer2.DefaultRenderersFactory;\nimport com.google.android.exoplayer2.LoadControl;\nimport com.google.android.exoplayer2.PlaybackException;\nimport com.google.android.exoplayer2.PlaybackParameters;\nimport com.google.android.exoplayer2.Player;\nimport com.google.android.exoplayer2.RenderersFactory;\nimport com.google.android.exoplayer2.SimpleExoPlayer;\nimport com.google.android.exoplayer2.source.DefaultMediaSourceFactory;\nimport com.google.android.exoplayer2.source.MediaSource;\nimport com.google.android.exoplayer2.source.ProgressiveMediaSource;\nimport com.google.android.exoplayer2.source.TrackGroupArray;\nimport com.google.android.exoplayer2.source.dash.DashMediaSource;\nimport com.google.android.exoplayer2.source.dash.DefaultDashChunkSource;\nimport com.google.android.exoplayer2.source.hls.HlsMediaSource;\nimport com.google.android.exoplayer2.source.smoothstreaming.DefaultSsChunkSource;\nimport com.google.android.exoplayer2.source.smoothstreaming.SsMediaSource;\nimport com.google.android.exoplayer2.trackselection.TrackSelectionArray;\nimport com.google.android.exoplayer2.ui.PlayerView;\nimport com.google.android.exoplayer2.upstream.BandwidthMeter;\nimport com.google.android.exoplayer2.upstream.DataSource;\nimport com.google.android.exoplayer2.upstream.DefaultBandwidthMeter;\nimport com.google.android.exoplayer2.upstream.DefaultDataSourceFactory;\nimport com.google.android.exoplayer2.upstream.DefaultHttpDataSource;\nimport com.google.android.exoplayer2.upstream.DefaultHttpDataSourceFactory;\nimport com.google.android.exoplayer2.upstream.HttpDataSource;\nimport com.google.android.exoplayer2.util.Util;\nimport com.google.android.gms.ads.AdRequest;\nimport com.google.android.gms.ads.LoadAdError;\nimport com.google.android.gms.ads.interstitial.InterstitialAd;\nimport com.google.android.gms.ads.interstitial.InterstitialAdLoadCallback;\nimport com.google.android.gms.cast.MediaInfo;\nimport com.google.android.gms.cast.MediaLoadOptions;\nimport com.google.android.gms.cast.MediaMetadata;\nimport com.google.android.gms.cast.framework.CastButtonFactory;\nimport com.google.android.gms.cast.framework.CastContext;\nimport com.google.android.gms.cast.framework.CastSession;\nimport com.google.android.gms.cast.framework.CastState;\nimport com.google.android.gms.cast.framework.CastStateListener;\nimport com.google.android.gms.cast.framework.SessionManagerListener;\nimport com.google.android.gms.cast.framework.media.RemoteMediaClient;\nimport com.google.firebase.FirebaseApp;\nimport com.google.firebase.firestore.FirebaseFirestore;\nimport com.Myapp.hd.Steaming.R;\nimport com.Myapp.hd.Steaming.HelperClass;\nimport com.Myapp.hd.Steaming.BaseActivity;\nimport com.Myapp.hd.Steaming.Location;\nimport com.Myapp.hd.Steaming.sessionManager.SessionManager;\nimport org.jetbrains.annotations.NotNull;\n\nimport java.util.HashMap;\nimport java.util.Map;\n\n\npublic class Exo_Player extends BaseActivity {\n\n    private static final String TAG = &quot;Exo_Player&quot;;\n    String url, userAgent;\n    boolean tokenEnable = false;\n    private InterstitialAd interstitial;\n    private PlayerView playerView;\n    private SimpleExoPlayer player;\n    private static final DefaultBandwidthMeter BANDWIDTH_METER = new DefaultBandwidthMeter();\n    private DataSource.Factory mediaDataSourceFactory;\n    private Handler mainHandler;\n    private ProgressBar progressBar;\n    FirebaseFirestore db;\n    SessionManager sessionManager;\n    FirebaseFirestore firebaseFirestore;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n\n        this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);\n        getWindow().setFlags(WindowManager.LayoutParams.FLAG_SECURE, WindowManager.LayoutParams.FLAG_SECURE);\n//////////////////////////////////////////////////////\n        setContentView(R.layout.exo_player_ui);\n        castContext = CastContext.getSharedInstance(this);\n        initCast();\n        db = FirebaseFirestore.getInstance();\n        sessionManager = new SessionManager(this);\n        FirebaseApp.initializeApp(this);\n\n        AdRequest adRequest = new AdRequest.Builder().build();\n\n        InterstitialAd.load(Exo_Player.this, sessionManager.getBackads(), adRequest,\n                new InterstitialAdLoadCallback() {\n                    @Override\n                    public void onAdLoaded(@NonNull InterstitialAd interstitialAd) {\n                        // The mInterstitialAd reference will be null until\n                        // an ad is loaded.\n                        interstitial = interstitialAd;\n                        Log.i(TAG, &quot;onAdLoaded&quot;);\n                    }\n\n                    @Override\n                    public void onAdFailedToLoad(@NonNull LoadAdError loadAdError) {\n                        // Handle the error\n                        Log.i(TAG, loadAdError.getMessage());\n                        interstitial = null;\n                    }\n                });\n\n\n        progressBar = findViewById(R.id.progressBar);\n\n\n        processToken();\n\n        listenCast();\n\n\n\n\n    }\n\n    MediaRouteButton mediaRouteButton;\n    CastContext castContext;\n    RemoteMediaClient remoteMediaClient;\n\n    public boolean initCast() {\n        url = getIntent().getStringExtra(getString(R.string.url));\n        userAgent = getIntent().getStringExtra(getString(R.string.user_agent));\n        tokenEnable = getIntent().getBooleanExtra(getString(R.string.t_enable), false);\n\n        mediaRouteButton = (MediaRouteButton) findViewById(R.id.media_route_button);\n        CastButtonFactory.setUpMediaRouteButton(getApplicationContext(), mediaRouteButton);\n        if (castContext == null)\n            castContext = CastContext.getSharedInstance(this);\n\n        castContext.addCastStateListener(new CastStateListener() {\n            @Override\n            public void onCastStateChanged(int state) {\n                /*if (state == CastState.NO_DEVICES_AVAILABLE) {\n//                    mediaRouteButton.setVisibility(View.GONE);\n                }\n                else if(state==CastState.CONNECTING) {\n                    showToast(&quot;Connecting&quot;);\n                } else*/ if (state == CastState.CONNECTED) {\n//                    showToast(&quot;Connected&quot;);\n//                    castMetadata();\n                    openCastPlayer();\n                }/* else if (mediaRouteButton.getVisibility() == View.GONE) {\n                    mediaRouteButton.setVisibility(View.VISIBLE);\n                }*/\n            }\n        });\n        if (castContext.getCastState() == CastState.CONNECTED) {\n            openCastPlayer();\n            return true;\n        } else {\n//                showToast(&quot;not connected&quot;);\n        }\n        if (castContext.getCastState() != CastState.NO_DEVICES_AVAILABLE)\n            mediaRouteButton.setVisibility(View.VISIBLE);\n        return false;\n    }\n\n    private void registerListener() {\n        if (mCastContext != null) {\n\n            mCastContext.getSessionManager().addSessionManagerListener(\n                    mSessionManagerListener, CastSession.class);\n        }\n    }\n\n    private void unRegisterListener() {\n        if (mCastContext != null) {\n            mCastContext.getSessionManager().removeSessionManagerListener(\n                    mSessionManagerListener, CastSession.class);\n        }\n    }\n\n\n    private void showToast(String connecting) {\n        Toast.makeText(this, connecting, Toast.LENGTH_SHORT).show();\n    }\n\n\n    private void processToken() {\n        if (!HelperClass.isValid(url) || !tokenEnable) {\n            init(&quot;&quot;);\n            return;\n        }\n\n        HashMap&lt;String, Object&gt; hashMap = new HashMap&lt;&gt;();\n        enqueue(getLocInterface().getLoc(sessionManager.getToken(), hashMap), new CallBack&lt;Location&gt;() {\n            @Override\n            public void onComplete() {\n                super.onComplete();\n            }\n\n            @Override\n            public void onError(Throwable e) {\n                super.onError(e);\n                Toast.makeText(Exo_Player.this,\n                        &quot;Failed to process url&quot;, Toast.LENGTH_SHORT).show();\n            }\n\n            @Override\n            public void onNext(@NotNull Location location) {\n                super.onNext(location);\n                if (location.appendResult != null)\n                    init(location.appendResult);\n            }\n        });\n    }\n\n    private void init(String s) {\n\n\n        url += s;\n\n        Log.e(TAG, &quot;init: new url is &quot; + url);\n        mediaDataSourceFactory = buildDataSourceFactory(true);\n\n        mainHandler = new Handler();\n        BandwidthMeter bandwidthMeter = new DefaultBandwidthMeter();\n\n        RenderersFactory renderersFactory = new DefaultRenderersFactory(this);\n\n//        TrackSelection.Factory videoTrackSelectionFactory = new AdaptiveTrackSelection.Factory(bandwidthMeter);\n//        TrackSelector trackSelector = new DefaultTrackSelector(videoTrackSelectionFactory);\n\n//        TrackSelector trackSelector = new DefaultTrackSelector();\n\n        LoadControl loadControl = new DefaultLoadControl();\n\n        player = new SimpleExoPlayer.Builder(this, renderersFactory).setLoadControl(loadControl).build();\n\n\n        playerView = findViewById(R.id.exoPlayerView);\n        playerView.setPlayer(player);\n        playerView.setUseController(true);\n        playerView.requestFocus();\n\n        Uri uri = Uri.parse(url);\n        final MediaSource mediaSource = buildMediaSource(uri, null);\n        player.prepare(mediaSource);\n        player.setPlayWhenReady(true);\n\n        player.addListener(new Player.Listener() {\n            @Override\n            public void onTracksChanged(@NotNull TrackGroupArray trackGroups, @NotNull TrackSelectionArray trackSelections) {\n                Log.d(TAG, &quot;onTracksChanged: &quot; + trackGroups.length);\n            }\n\n            @Override\n            public void onIsLoadingChanged(boolean isLoading) {\n                Log.d(TAG, &quot;onLoadingChanged: &quot; + isLoading);\n            }\n\n            @Override\n            public void onPlayerStateChanged(boolean playWhenReady, int playbackState) {\n                Log.d(TAG, &quot;onPlayerStateChanged: &quot; + playWhenReady);\n                if (playbackState == PlaybackStateCompat.STATE_PLAYING) {\n                    progressBar.setVisibility(View.GONE);\n                }\n            }\n\n            @Override\n            public void onRepeatModeChanged(int repeatMode) {\n\n            }\n\n            @Override\n            public void onShuffleModeEnabledChanged(boolean shuffleModeEnabled) {\n\n            }\n\n            @Override\n            public void onPlayerError(@NotNull PlaybackException error) {\n                Log.e(TAG, &quot;onPlayerError: &quot;, error);\n                player.stop();\n//                errorDialog();\n                player.prepare(mediaSource);\n                player.setPlayWhenReady(true);\n\n\n            }\n\n            @Override\n            public void onPositionDiscontinuity(int reason) {\n                Log.d(TAG, &quot;onPositionDiscontinuity: true&quot;);\n            }\n\n            @Override\n            public void onPlaybackParametersChanged(@NotNull PlaybackParameters playbackParameters) {\n\n\n            }\n\n            @Override\n            public void onSeekProcessed() {\n\n            }\n        });\n\n        Log.d(&quot;INFO&quot;, &quot;ActivityVideoPlayer&quot;);\n\n    }\n\n\n    private void pausePlayer() {\n        player.setPlayWhenReady(false);\n        player.getPlaybackState();\n    }\n\n    private void startPlayer() {\n        player.setPlayWhenReady(true);\n        player.getPlaybackState();\n    }\n\n\n    @Override\n    protected void onPause() {\n        super.onPause();\n        try {\n            unRegisterListener();\n            pausePlayer();\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n\n    @Override\n    protected void onResume() {\n        super.onResume();\n        getWindow().getDecorView().setSystemUiVisibility(View.SYSTEM_UI_FLAG_FULLSCREEN\n                | View.SYSTEM_UI_FLAG_IMMERSIVE_STICKY\n                | View.SYSTEM_UI_FLAG_HIDE_NAVIGATION);\n        /////////////////////////////////////////////\n        try {\n            registerListener();\n            if (HelperClass.vpn(this)) {\n                finish();\n            }\n            startPlayer();\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n\n\n    @Override\n    public void onDestroy() {\n        super.onDestroy();\n        Log.v(TAG, &quot;onDestroy()...&quot;);\n        if (player != null)\n            player.release();\n    }\n\n    private MediaSource buildMediaSource(Uri uri, String overrideExtension) {\n        int type = TextUtils.isEmpty(overrideExtension) ? Util.inferContentType(uri)\n                : Util.inferContentType(&quot;.&quot; + overrideExtension);\n        switch (type) {\n            case C.TYPE_SS:\n                return new SsMediaSource.Factory(new DefaultSsChunkSource.Factory(mediaDataSourceFactory), buildDataSourceFactory(false)).createMediaSource(uri);\n            case C.TYPE_DASH:\n                return new DashMediaSource.Factory(new DefaultDashChunkSource.Factory(mediaDataSourceFactory), buildDataSourceFactory(false)).createMediaSource(uri);\n            case C.TYPE_HLS:\n                return new HlsMediaSource.Factory(mediaDataSourceFactory).createMediaSource(uri);\n            case C.TYPE_OTHER:\n                return new ProgressiveMediaSource.Factory(mediaDataSourceFactory).createMediaSource(uri);\n            default: {\n                throw new IllegalStateException(&quot;Unsupported type: &quot; + type);\n            }\n        }\n    }\n\n\n    private DataSource.Factory buildDataSourceFactory(boolean useBandwidthMeter) {\n        return buildDataSourceFactory(useBandwidthMeter ? BANDWIDTH_METER : null);\n    }\n\n    public DataSource.Factory buildDataSourceFactory(DefaultBandwidthMeter bandwidthMeter) {\n        return new DefaultDataSourceFactory(this, bandwidthMeter,\n                buildHttpDataSourceFactory(bandwidthMeter));\n    }\n\n\n    public HttpDataSource.Factory buildHttpDataSourceFactory(DefaultBandwidthMeter bandwidthMeter) {\n\n\n        String s = &quot;xxxxx&quot;;\n        if (userAgent != null &amp;&amp; !userAgent.isEmpty()) {\n            s = userAgent;\n        }\n        return new DefaultHttpDataSourceFactory(getUserAgent2(this, s), bandwidthMeter);\n\n    }\n\n\n\n    public static String getUserAgent2(Context context, String applicationName) {\n        return applicationName\n                + &quot;&quot;;\n    }\n\n\n    @Override\n    public void onBackPressed() {\n        super.onBackPressed();\n        if (interstitial != null) {\n            interstitial.show(Exo_Player.this);\n        }\n        if (player != null)\n            player.stop();\n    }\n\n//    public void errorDialog() {\n//        new AlertDialog.Builder(this)\n//                .setIcon(android.R.drawable.ic_dialog_alert)\n//                .setTitle(getResources().getString(R.string.msg_oops))\n//                .setCancelable(false)\n//                .setMessage(getResources().getString(R.string.msg_failed))\n//                .setPositiveButton(getResources().getString(R.string.option_retry), new DialogInterface.OnClickListener() {\n//                    @Override\n//                    public void onClick(DialogInterface dialog, int which) {\n//                        retryLoad();\n//                  z  }\n//\n//                })\n//                .setNegativeButton(getResources().getString(R.string.option_no), new DialogInterface.OnClickListener() {\n//                    @Override\n//                    public void onClick(DialogInterface dialogInterface, int i) {\n//                        finish();\n//                    }\n//                })\n//                .show();\n//    }\n\n//    public void retryLoad() {\n//        Uri uri = Uri.parse(url);\n//        MediaSource mediaSource = buildMediaSource(uri, null);\n//        player.prepare(mediaSource);\n//        player.setPlayWhenReady(true);\n//    }\n\n    public void castplayer(String name, String link, String unique, String img) {\n\n        if (!isCastApiAvailable()) {\n            return;\n        }\n\n        Context context = this;\n        CastSession castSession = CastContext.getSharedInstance(context).getSessionManager()\n                .getCurrentCastSession();\n        if (castSession.isConnected()) {\n\n            MediaMetadata movieMetadata = new MediaMetadata(MediaMetadata.MEDIA_TYPE_GENERIC);\n            movieMetadata.putString(MediaMetadata.KEY_TITLE, name);\n\n\n\n            MediaInfo mediaInfo = new MediaInfo.Builder(link)\n                    .setMetadata(movieMetadata)\n                    .setEntity(unique)\n                    .build();\n\n            final RemoteMediaClient remoteMediaClient = castSession.getRemoteMediaClient();\n            if (remoteMediaClient == null) {\n//                Timber.tag(TAG).w(&quot;showQueuePopup(): null RemoteMediaClient&quot;);\n                return;\n            }\n\n            if (remoteMediaClient.isPlaying()) {\n                MediaInfo curMedia = remoteMediaClient.getMediaInfo();\n                if (curMedia != null &amp;&amp; curMedia.getEntity().equals(unique)) {\n                    return;\n                }\n            }\n\n            if (remoteMediaClient.isLoadingNextItem() || remoteMediaClient.isBuffering()) {\n                return;\n            }\n//            final QueueDataProvider provider = QueueDataProvider.getInstance(context);\n//            PopupMenu popup = new PopupMenu(context, binding.epLayout);\n//            popup.getMenuInflater().inflate(\n//                    provider.isQueueDetached() || provider.getCount() == 0\n//                            ? R.menu.detached_popup_add_to_queue\n//                            : R.menu.popup_add_to_queue, popup.getMenu());\n//            PopupMenu.OnMenuItemClickListener clickListener = menuItem -&gt; {\n//            QueueDataProvider provider1 = QueueDataProvider.getInstance(context);\n//            MediaQueueItem queueItem = new MediaQueueItem.Builder(mediaInfo).setAutoplay(\n//                    false).setPreloadTime(2).build();\n//            MediaQueueItem[] newItemArray = new MediaQueueItem[]{queueItem};\n//            String toastMessage = null;\n//            if (provider1.isQueueDetached() &amp;&amp; provider1.getCount() &gt; 0) {\n//                    if ((menuItem.getItemId() == R.id.action_play_now)\n//                            || (menuItem.getItemId() == R.id.action_add_to_queue)) {\n//                MediaQueueItem[] items = Utils\n//                        .rebuildQueueAndAppend(provider1.getItems(), queueItem);\n//                remoteMediaClient.queueLoad(items, provider1.getCount(),\n//                        MediaStatus.REPEAT_MODE_REPEAT_OFF, null);\n//                    } else {\n//                        return false;\n//                    }\n//            } else {\n//                if (provider1.getCount() == 0) {\n//                    remoteMediaClient.queueLoad(newItemArray, 0,\n//                            MediaStatus.REPEAT_MODE_REPEAT_OFF, null);\n//                } else {\n//                    int currentId = provider1.getCurrentItemId();\n////                        if (menuItem.getItemId() == R.id.action_play_now) {\n//                    remoteMediaClient.queueInsertAndPlayItem(queueItem, currentId, null);\n            remoteMediaClient.load(mediaInfo, new MediaLoadOptions.Builder().build());\n\n\n//                        } else if (menuItem.getItemId() == R.id.action_play_next) {\n//                            int currentPosition = provider1.getPositionByItemId(currentId);\n//                            if (currentPosition == provider1.getCount() - 1) {\n//                                //we are adding to the end of queue\n//                                remoteMediaClient.queueAppendItem(queueItem, null);\n//                            } else {\n//                                int nextItemId = provider1.getItem(currentPosition + 1).getItemId();\n//                                remoteMediaClient.queueInsertItems(newItemArray, nextItemId, null);\n//                            }\n//                            toastMessage = context.getString(\n//                                    R.string.queue_item_added_to_play_next);\n//                        } else if (menuItem.getItemId() == R.id.action_add_to_queue) {\n//                            remoteMediaClient.queueAppendItem(queueItem, null);\n//                            toastMessage = context.getString(R.string.queue_item_added_to_queue);\n//                        } else {\n//                            return false;\n//                        }\n//                }\n//            }\n//                if (menuItem.getItemId() == R.id.action_play_now) {\n            Intent intent = new Intent(context, ExpandedControlsActivity.class);\n            context.startActivity(intent);\n//                }\n//            if (!TextUtils.isEmpty(toastMessage)) {\n//                Toast.makeText(context, toastMessage, Toast.LENGTH_SHORT).show();\n//            }\n//                return true;\n//            };\n//            popup.setOnMenuItemClickListener(clickListener);\n//            popup.show();\n//        }\n        } else {\n            Toast.makeText(context,\n                    &quot;Not Connected&quot;, Toast.LENGTH_SHORT).show();\n        }\n    }\n\n\n\n    private CastContext mCastContext;\n    private CastSession mCastSession;\n    private SessionManagerListener&lt;CastSession&gt; mSessionManagerListener;\n\n    private void listenCast() {\n        if (!isCastApiAvailable()) {\n            return;\n        }\n        setupCastListener();\n        mCastContext = CastContext.getSharedInstance(this);\n        mCastSession = mCastContext.getSessionManager().getCurrentCastSession();\n    }\n\n    private void setupCastListener() {\n        mSessionManagerListener = new SessionManagerListener&lt;CastSession&gt;() {\n\n            @Override\n            public void onSessionEnded(CastSession session, int error) {\n                onApplicationDisconnected();\n                mCastContext = null;\n                mCastSession = null;\n            }\n\n            @Override\n            public void onSessionResumed(CastSession session, boolean wasSuspended) {\n                onApplicationConnected(session);\n\n            }\n\n            @Override\n            public void onSessionResumeFailed(CastSession session, int error) {\n                onApplicationDisconnected();\n\n            }\n\n            @Override\n            public void onSessionStarted(CastSession session, String sessionId) {\n                onApplicationConnected(session);\n\n            }\n\n            @Override\n            public void onSessionStartFailed(CastSession session, int error) {\n                onApplicationDisconnected();\n\n            }\n\n            @Override\n            public void onSessionStarting(CastSession session) {\n\n            }\n\n            @Override\n            public void onSessionEnding(CastSession session) {\n\n            }\n\n            @Override\n            public void onSessionResuming(CastSession session, String sessionId) {\n\n            }\n\n            @Override\n            public void onSessionSuspended(CastSession session, int reason) {\n\n            }\n\n            private void onApplicationConnected(CastSession castSession) {\n                mCastSession = castSession;\n                openCastPlayer();\n                invalidateOptionsMenu();\n            }\n\n            private void onApplicationDisconnected() {\n                invalidateOptionsMenu();\n            }\n        };\n    }\n\n    private void openCastPlayer() {\n        castplayer(getString(R.string.app_name), url, url, url);\n        finish();\n    }\n\n}\n</code></pre>\n"}],"has_more":true,"quota_max":10000,"quota_remaining":8761,"page":1231,"page_size":100}
