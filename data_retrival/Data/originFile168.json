{"items":[{"tags":["java","image","static","thymeleaf","flying-saucer"],"answers":[{"tags":[],"owner":{"account_id":173186,"reputation":4270,"user_id":401712,"display_name":"Dario Seidl"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1541078690,"creation_date":1541078690,"answer_id":53102242,"question_id":50203842,"body_markdown":"You can include resources from any URL (from the Internet or from your file system). Either way, there are several steps involved:\r\n\r\nWhen generating the HTML from the Thymeleaf template, you can use\r\n\r\n  - `@{/some/url}` to resolve a path relative to your Web context (assuming you have a Web context), or\r\n  - `@{classpath:/some/url}` with will just leave the URL as `classpath:/some/url`, or\r\n  - simply a string value constant or a value from a variable (`${var}`), doesn&#39;t matter if it&#39;s an absolute URL `https://some/url` or relative, Thymleaf will leave them unchanged in the resulting HTML.\r\n\r\nBefore you pass the HTML to Flying Saucer, make sure the URLs are correct. Then Flying Saucer will process all URLs with a `UserAgentCallback`, by default `ITextUserAgent`.\r\n\r\nThe relevant methods in `UserAgentCallBack` are `resolveURI` and `setBaseURL`.\r\n\r\nThere is some weird logic going on in the default `resolveURI` method of `ITextUserAgent` (inherited  from `NaiveUserAgent`). If the `baseURL` is null, it will try to set it, so it&#39;s best to always set it yourself. I had better results with overriding the `resolveURI`, the following is enough to keep absolute URLs and resolve relative URLs relative to the `baseURL`:\r\n\r\n    @Override\r\n    public String resolveURI(String uri) {\r\n       if (URI(uri).isAbsolute())\r\n           return uri;\r\n       else\r\n           return Paths.get(getBaseURL(), uri).toUri().toString();\r\n    }\r\n\r\nFinally, in order to resolve the `classpath:` protocol, [you need to define an `URLStreamHandler`](https://stackoverflow.com/questions/861500/url-to-load-resources-from-the-classpath-in-java) unless there is already one defined (for example, the embedded Tomcat of Spring Boot already does supports this). \r\n","title":"Static images not display with flying saucer and thymeleaf for generated pdf files","body":"<p>You can include resources from any URL (from the Internet or from your file system). Either way, there are several steps involved:</p>\n\n<p>When generating the HTML from the Thymeleaf template, you can use</p>\n\n<ul>\n<li><code>@{/some/url}</code> to resolve a path relative to your Web context (assuming you have a Web context), or</li>\n<li><code>@{classpath:/some/url}</code> with will just leave the URL as <code>classpath:/some/url</code>, or</li>\n<li>simply a string value constant or a value from a variable (<code>${var}</code>), doesn't matter if it's an absolute URL <code>https://some/url</code> or relative, Thymleaf will leave them unchanged in the resulting HTML.</li>\n</ul>\n\n<p>Before you pass the HTML to Flying Saucer, make sure the URLs are correct. Then Flying Saucer will process all URLs with a <code>UserAgentCallback</code>, by default <code>ITextUserAgent</code>.</p>\n\n<p>The relevant methods in <code>UserAgentCallBack</code> are <code>resolveURI</code> and <code>setBaseURL</code>.</p>\n\n<p>There is some weird logic going on in the default <code>resolveURI</code> method of <code>ITextUserAgent</code> (inherited  from <code>NaiveUserAgent</code>). If the <code>baseURL</code> is null, it will try to set it, so it's best to always set it yourself. I had better results with overriding the <code>resolveURI</code>, the following is enough to keep absolute URLs and resolve relative URLs relative to the <code>baseURL</code>:</p>\n\n<pre><code>@Override\npublic String resolveURI(String uri) {\n   if (URI(uri).isAbsolute())\n       return uri;\n   else\n       return Paths.get(getBaseURL(), uri).toUri().toString();\n}\n</code></pre>\n\n<p>Finally, in order to resolve the <code>classpath:</code> protocol, <a href=\"https://stackoverflow.com/questions/861500/url-to-load-resources-from-the-classpath-in-java\">you need to define an <code>URLStreamHandler</code></a> unless there is already one defined (for example, the embedded Tomcat of Spring Boot already does supports this). </p>\n"},{"tags":[],"owner":{"account_id":14054068,"reputation":30,"user_id":10151961,"display_name":"Gaurav Jestha"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1548247204,"creation_date":1548247204,"answer_id":54327512,"question_id":50203842,"body_markdown":"You can render image with the help of base 64 .You just convert your image on base 64 and it will show on your web page as well as mobile view.The tags are:\r\n\r\n&lt;!-- begin snippet: js hide: false console: true babel: false --&gt;\r\n\r\n&lt;!-- language: lang-html --&gt;\r\n\r\n    &lt;img th:src=&quot;@{data:image/png ;base64,your base 64}&quot;/&gt;\r\n\r\n&lt;!-- end snippet --&gt;\r\n\r\n","title":"Static images not display with flying saucer and thymeleaf for generated pdf files","body":"<p>You can render image with the help of base 64 .You just convert your image on base 64 and it will show on your web page as well as mobile view.The tags are:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;img th:src=\"@{data:image/png ;base64,your base 64}\"/&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"},{"tags":[],"owner":{"account_id":27581037,"reputation":21,"user_id":21050237,"display_name":"Jamshid SadiK"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695383121,"creation_date":1695383121,"answer_id":77157338,"question_id":50203842,"body_markdown":"You have the option to specify the complete file path instead of using the relative path &quot;images/logo_black.png&quot; within the Thymeleaf image source attribute. To achieve this, you can create a directory named &quot;templates&quot; within the &quot;resources&quot; folder of your project. Inside this &quot;templates&quot; directory, you can place your images under a subdirectory named &quot;images.&quot; For instance, you can structure it like this: &quot;templates/images/image.png.&quot;\r\n\r\nWith this setup, you can then reference the image using the full path in the Thymeleaf th:src attribute like so:\r\n\r\n    \r\n    &lt;img th:src=&quot;@{classpath:/templates/images/image.png}&quot; alt=&quot;image&quot;/&gt;\r\n\r\nThis approach ensures that you provide the complete path to the image located within your project&#39;s resources, enhancing the clarity and precision of the image reference.","title":"Static images not display with flying saucer and thymeleaf for generated pdf files","body":"<p>You have the option to specify the complete file path instead of using the relative path &quot;images/logo_black.png&quot; within the Thymeleaf image source attribute. To achieve this, you can create a directory named &quot;templates&quot; within the &quot;resources&quot; folder of your project. Inside this &quot;templates&quot; directory, you can place your images under a subdirectory named &quot;images.&quot; For instance, you can structure it like this: &quot;templates/images/image.png.&quot;</p>\n<p>With this setup, you can then reference the image using the full path in the Thymeleaf th:src attribute like so:</p>\n<pre><code>&lt;img th:src=&quot;@{classpath:/templates/images/image.png}&quot; alt=&quot;image&quot;/&gt;\n</code></pre>\n<p>This approach ensures that you provide the complete path to the image located within your project's resources, enhancing the clarity and precision of the image reference.</p>\n"}],"owner":{"display_name":"user7307131"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":2345,"favorite_count":0,"down_vote_count":0,"up_vote_count":8,"answer_count":3,"score":8,"last_activity_date":1695383121,"creation_date":1525635869,"question_id":50203842,"body_markdown":"I am using thymeleaf as my template engin to map XHTML to HTML and flying saucer to generate a pdf file afterwards. \r\n\r\nNow i failed to display my static images located at /src/main/resources/ inside y generated pdf file. The file itsself will be displayed fine only images disapear.\r\n\r\nEven other locations like /src/main/resources/static or /src/main/resources/public didnt help. \r\n\r\nMy HTML / XHTML looks like:\r\n\r\n    &lt;img src=&quot;images/logo_black.png&quot;&gt;&lt;/img&gt;\r\n            &lt;img src=&quot;/images/logo_black.png&quot;&gt;&lt;/img&gt;\r\n            &lt;img alt=&quot;mastercard&quot; th:src=&quot;@{classpath:static/images/logo_black.png}&quot; /&gt;\r\n            \r\n            &lt;div data-src=&quot;images/logo_black.png&quot;&gt;&lt;/div&gt;\r\n            &lt;div data-src=&quot;/images/logo_black.png&quot;&gt;&lt;/div&gt;\r\n            &lt;div data-src=&quot;@{classpath:static/images/logo_black.png}&quot;&gt;&lt;/div&gt;\r\nnone of them is working properly.\r\n\r\nThe Images itself are visible by localhost:8048/logo_black.png\r\n\r\nI dont want to refer my images with a full url (http://...)","title":"Static images not display with flying saucer and thymeleaf for generated pdf files","body":"<p>I am using thymeleaf as my template engin to map XHTML to HTML and flying saucer to generate a pdf file afterwards. </p>\n\n<p>Now i failed to display my static images located at /src/main/resources/ inside y generated pdf file. The file itsself will be displayed fine only images disapear.</p>\n\n<p>Even other locations like /src/main/resources/static or /src/main/resources/public didnt help. </p>\n\n<p>My HTML / XHTML looks like:</p>\n\n<pre><code>&lt;img src=\"images/logo_black.png\"&gt;&lt;/img&gt;\n        &lt;img src=\"/images/logo_black.png\"&gt;&lt;/img&gt;\n        &lt;img alt=\"mastercard\" th:src=\"@{classpath:static/images/logo_black.png}\" /&gt;\n\n        &lt;div data-src=\"images/logo_black.png\"&gt;&lt;/div&gt;\n        &lt;div data-src=\"/images/logo_black.png\"&gt;&lt;/div&gt;\n        &lt;div data-src=\"@{classpath:static/images/logo_black.png}\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p>none of them is working properly.</p>\n\n<p>The Images itself are visible by localhost:8048/logo_black.png</p>\n\n<p>I dont want to refer my images with a full url (<a href=\"http://..\" rel=\"noreferrer\">http://..</a>.)</p>\n"},{"tags":["java","logging","slf4j"],"answers":[{"tags":[],"owner":{"account_id":372682,"reputation":22426,"user_id":721855,"display_name":"aled"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1695382618,"creation_date":1695382618,"answer_id":77157278,"question_id":77156107,"body_markdown":"SLF4J is just a facade, it doesn&#39;t implement any logging mechanisms. What you need to search is how to configure a logging implementation, like for example log4j2, so it logs to the Windows Event Log. There are custom log4j2 appenders that do that. Current Stackoverflow guidelines forbid recommendations but an Internet search of &quot;log4j2 windows event log&quot; should give some answers.\r\n","title":"Slf4j implementation for Windows eventlogger","body":"<p>SLF4J is just a facade, it doesn't implement any logging mechanisms. What you need to search is how to configure a logging implementation, like for example log4j2, so it logs to the Windows Event Log. There are custom log4j2 appenders that do that. Current Stackoverflow guidelines forbid recommendations but an Internet search of &quot;log4j2 windows event log&quot; should give some answers.</p>\n"}],"owner":{"account_id":205579,"reputation":63,"user_id":1652309,"display_name":"eddy"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":28,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1695382618,"creation_date":1695372599,"question_id":77156107,"body_markdown":"We have developed a Java application that uses slf4j + logback-classic to log. One of our customers asks if it would be possible to log to Windows eventlogger. \r\n\r\nFrom what I understand the slf4j-api can have many implementations. They can be &quot;plugged in&quot; by supplying a jar file with that implementation, e.g. slf4j-simple.jar, slf4j-log4j12.jar  etc. Is there a plugin for making it log to Windows eventlogger? I have searched across the net but I couldn&#39;t find it. \r\n\r\nAlso any other solutions for moving the log to Windows eventlogger would be appreciated.","title":"Slf4j implementation for Windows eventlogger","body":"<p>We have developed a Java application that uses slf4j + logback-classic to log. One of our customers asks if it would be possible to log to Windows eventlogger.</p>\n<p>From what I understand the slf4j-api can have many implementations. They can be &quot;plugged in&quot; by supplying a jar file with that implementation, e.g. slf4j-simple.jar, slf4j-log4j12.jar  etc. Is there a plugin for making it log to Windows eventlogger? I have searched across the net but I couldn't find it.</p>\n<p>Also any other solutions for moving the log to Windows eventlogger would be appreciated.</p>\n"},{"tags":["java","sockets","java-threads"],"owner":{"account_id":27696700,"reputation":1,"user_id":21142256,"display_name":"Hubert Kiszka"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":17,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1695383850,"answer_count":0,"score":0,"last_activity_date":1695382061,"creation_date":1695382061,"question_id":77157217,"body_markdown":"I am trying to do simple banking application but i encountered problem, my server only sends 1 message instead of sending all of them. My App consists of 3 Files\r\n\r\n```\r\npackage com.kiszka.server;\r\n\r\nimport java.io.*;\r\nimport java.net.Socket;\r\nimport java.util.Map;\r\nimport java.util.HashMap;\r\n\r\npublic class BankServer extends Thread {\r\n    private final Socket socket;\r\n    private static volatile Map&lt;String,String&gt; accAccessData = new HashMap&lt;&gt;();\r\n    private static volatile boolean admitAccess = false;\r\n    public BankServer(Socket socket) {\r\n        accInfo();\r\n        this.socket = socket;\r\n    }\r\n\r\n    @Override\r\n    public void run() {\r\n        try {\r\n//            BufferedReader input = new BufferedReader(new InputStreamReader(socket.getInputStream()));\r\n//            PrintWriter output = new PrintWriter(socket.getOutputStream(),true);\r\n            for(;;){\r\n                checkAccAccess(socket);\r\n            }\r\n        } finally {\r\n            try{\r\n                socket.close();\r\n            } catch (IOException e){\r\n                throw new RuntimeException(e);\r\n            }\r\n        }\r\n    }\r\n    public void accInfo(){\r\n        try(BufferedReader reader = new BufferedReader(new FileReader(&quot;accInfo.csv&quot;))){\r\n            String line;\r\n            while((line = reader.readLine()) != null){\r\n                String[] parts = line.split(&quot;,&quot;);\r\n                if(parts.length&gt;=2){\r\n                    String key = parts[0].trim();\r\n                    String val = parts[1].trim();\r\n                    accAccessData.put(key,val);\r\n                }\r\n            }\r\n        } catch (IOException e){\r\n            throw new RuntimeException(e);\r\n        }\r\n        for (Map.Entry&lt;String, String&gt; entry : accAccessData.entrySet()) {\r\n            System.out.println(&quot;Key: &quot; + entry.getKey() + &quot;, Value: &quot; + entry.getValue());\r\n        }\r\n    }\r\n    public static void checkAccAccess(Socket socket){\r\n        String value;\r\n        int counter = 0;\r\n        try {\r\n            BufferedReader inputReader = new BufferedReader(new InputStreamReader(socket.getInputStream()));\r\n            PrintWriter output = new PrintWriter(socket.getOutputStream(),true);\r\n            for(;;){\r\n                output.println(&quot;Please insert your account Number&quot;);\r\n                String input = inputReader.readLine();\r\n                if(!accAccessData.containsKey(input)){\r\n                    output.println(&quot;Invalid Account Number&quot;);\r\n                } else{\r\n                    value = accAccessData.get(input);\r\n                    break;\r\n                }\r\n            }\r\n            while(counter&lt;3){\r\n                output.println(&quot;Please insert PIN to your account&quot;);\r\n                String input = inputReader.readLine();\r\n                if(!input.equals(value)){\r\n                    counter++;\r\n                }\r\n                if(input.equals(value)){\r\n                    output.println(&quot;Access granted&quot;);\r\n                    admitAccess = true;\r\n                    break;\r\n                }\r\n                if(counter == 3){\r\n                    output.println(&quot;Access denied&quot;);\r\n                }\r\n            }\r\n        } catch (IOException e) {\r\n            throw new RuntimeException(e);\r\n        } finally {\r\n            try {\r\n                socket.close();\r\n            } catch (IOException e) {\r\n                throw new RuntimeException(e);\r\n            }\r\n        }\r\n    }\r\n}\r\n```\r\n\r\n```\r\npackage com.kiszka.server;\r\n\r\nimport java.io.IOException;\r\nimport java.net.ServerSocket;\r\n\r\npublic class ServerRun {\r\n    public static void main(String[] args) {\r\n        try(ServerSocket serverSocket = new ServerSocket(5000)){\r\n            for(;;){\r\n                new BankServer(serverSocket.accept()).start();\r\n            }\r\n        } catch (IOException e) {\r\n            throw new RuntimeException(e);\r\n        }\r\n    }\r\n}\r\n```\r\n\r\n```\r\npackage com.kiszka.client;\r\n\r\nimport java.io.BufferedReader;\r\nimport java.io.IOException;\r\nimport java.io.InputStreamReader;\r\nimport java.io.PrintWriter;\r\nimport java.net.Socket;\r\nimport java.util.Scanner;\r\n\r\npublic class ClientRun {\r\n    public static void main(String[] args) {\r\n        try(Socket socket = new Socket(&quot;127.0.0.1&quot;,5000)){\r\n            BufferedReader reader = new BufferedReader(new InputStreamReader(socket.getInputStream()));\r\n            PrintWriter writer = new PrintWriter(socket.getOutputStream(),true);\r\n            Scanner scanner = new Scanner(System.in);\r\n            String input;\r\n            for(;;){\r\n                String response = reader.readLine();\r\n                System.out.println(response);\r\n                input = scanner.nextLine();\r\n                writer.println(input);\r\n            }\r\n        } catch(IOException e){\r\n            throw new RuntimeException(e);\r\n        }\r\n    }\r\n}\r\n\r\n```\r\nthe problem is when I type in wrong input it will only prints something like this\r\nPlease insert your account Number\r\n25\r\nInvalid Account Number\r\n\r\nand nothing more.\r\n\r\n\r\nBut it should like\r\n\r\nPlease insert your account Number\r\n25\r\nInvalid Account Number\r\nPlease insert your account Number\r\n\r\nSometimes it throws java.net.SocketException, i dont have an idea how to solve this problem to make this program sends all messages then waits for input from client","title":"Problem with sending mulltiple messages from server to client usign Java Socket","body":"<p>I am trying to do simple banking application but i encountered problem, my server only sends 1 message instead of sending all of them. My App consists of 3 Files</p>\n<pre><code>package com.kiszka.server;\n\nimport java.io.*;\nimport java.net.Socket;\nimport java.util.Map;\nimport java.util.HashMap;\n\npublic class BankServer extends Thread {\n    private final Socket socket;\n    private static volatile Map&lt;String,String&gt; accAccessData = new HashMap&lt;&gt;();\n    private static volatile boolean admitAccess = false;\n    public BankServer(Socket socket) {\n        accInfo();\n        this.socket = socket;\n    }\n\n    @Override\n    public void run() {\n        try {\n//            BufferedReader input = new BufferedReader(new InputStreamReader(socket.getInputStream()));\n//            PrintWriter output = new PrintWriter(socket.getOutputStream(),true);\n            for(;;){\n                checkAccAccess(socket);\n            }\n        } finally {\n            try{\n                socket.close();\n            } catch (IOException e){\n                throw new RuntimeException(e);\n            }\n        }\n    }\n    public void accInfo(){\n        try(BufferedReader reader = new BufferedReader(new FileReader(&quot;accInfo.csv&quot;))){\n            String line;\n            while((line = reader.readLine()) != null){\n                String[] parts = line.split(&quot;,&quot;);\n                if(parts.length&gt;=2){\n                    String key = parts[0].trim();\n                    String val = parts[1].trim();\n                    accAccessData.put(key,val);\n                }\n            }\n        } catch (IOException e){\n            throw new RuntimeException(e);\n        }\n        for (Map.Entry&lt;String, String&gt; entry : accAccessData.entrySet()) {\n            System.out.println(&quot;Key: &quot; + entry.getKey() + &quot;, Value: &quot; + entry.getValue());\n        }\n    }\n    public static void checkAccAccess(Socket socket){\n        String value;\n        int counter = 0;\n        try {\n            BufferedReader inputReader = new BufferedReader(new InputStreamReader(socket.getInputStream()));\n            PrintWriter output = new PrintWriter(socket.getOutputStream(),true);\n            for(;;){\n                output.println(&quot;Please insert your account Number&quot;);\n                String input = inputReader.readLine();\n                if(!accAccessData.containsKey(input)){\n                    output.println(&quot;Invalid Account Number&quot;);\n                } else{\n                    value = accAccessData.get(input);\n                    break;\n                }\n            }\n            while(counter&lt;3){\n                output.println(&quot;Please insert PIN to your account&quot;);\n                String input = inputReader.readLine();\n                if(!input.equals(value)){\n                    counter++;\n                }\n                if(input.equals(value)){\n                    output.println(&quot;Access granted&quot;);\n                    admitAccess = true;\n                    break;\n                }\n                if(counter == 3){\n                    output.println(&quot;Access denied&quot;);\n                }\n            }\n        } catch (IOException e) {\n            throw new RuntimeException(e);\n        } finally {\n            try {\n                socket.close();\n            } catch (IOException e) {\n                throw new RuntimeException(e);\n            }\n        }\n    }\n}\n</code></pre>\n<pre><code>package com.kiszka.server;\n\nimport java.io.IOException;\nimport java.net.ServerSocket;\n\npublic class ServerRun {\n    public static void main(String[] args) {\n        try(ServerSocket serverSocket = new ServerSocket(5000)){\n            for(;;){\n                new BankServer(serverSocket.accept()).start();\n            }\n        } catch (IOException e) {\n            throw new RuntimeException(e);\n        }\n    }\n}\n</code></pre>\n<pre><code>package com.kiszka.client;\n\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.io.PrintWriter;\nimport java.net.Socket;\nimport java.util.Scanner;\n\npublic class ClientRun {\n    public static void main(String[] args) {\n        try(Socket socket = new Socket(&quot;127.0.0.1&quot;,5000)){\n            BufferedReader reader = new BufferedReader(new InputStreamReader(socket.getInputStream()));\n            PrintWriter writer = new PrintWriter(socket.getOutputStream(),true);\n            Scanner scanner = new Scanner(System.in);\n            String input;\n            for(;;){\n                String response = reader.readLine();\n                System.out.println(response);\n                input = scanner.nextLine();\n                writer.println(input);\n            }\n        } catch(IOException e){\n            throw new RuntimeException(e);\n        }\n    }\n}\n\n</code></pre>\n<p>the problem is when I type in wrong input it will only prints something like this\nPlease insert your account Number\n25\nInvalid Account Number</p>\n<p>and nothing more.</p>\n<p>But it should like</p>\n<p>Please insert your account Number\n25\nInvalid Account Number\nPlease insert your account Number</p>\n<p>Sometimes it throws java.net.SocketException, i dont have an idea how to solve this problem to make this program sends all messages then waits for input from client</p>\n"},{"tags":["java","concurrency","java.util.concurrent"],"comments":[{"owner":{"account_id":47283,"reputation":703817,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":0,"creation_date":1695380910,"post_id":77156195,"comment_id":136020126,"body_markdown":"I don&#39;t think there is an &quot;idiomatic&quot; way.  That would imply that this problem occurs often enough for a recognizable idiom to emerge.  That&#39;s not the case.","body":"I don&#39;t think there is an &quot;idiomatic&quot; way.  That would imply that this problem occurs often enough for a recognizable idiom to emerge.  That&#39;s not the case."}],"answers":[{"tags":[],"owner":{"account_id":47283,"reputation":703817,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1695381910,"creation_date":1695381910,"answer_id":77157200,"question_id":77156195,"body_markdown":"The way to do it would be to get the clock time in the at the start of the `waitFor...` method. Then when you return from await and the condition is not satisfied, get the clock time again and compare it with the first time to decide if you need to await again.  \r\n\r\nThe code could look something like this:\r\n\r\n    void waitForUpToFiveSeconds() throws InterruptedException {\r\n        lock.lock();\r\n        long deadline = System.currentTimeMillis() + 5000L;\r\n        try {\r\n            flagSet.await(5000L, TimeUnit.MILLISECONDS);\r\n            while (!flag) {\r\n                long now = System.currentTimeMillis();\r\n                if (now &gt;= deadline) {\r\n                    break;\r\n                }\r\n                flagSet.await(deadline - now, TimeUnit.MILLISECONDS);\r\n            }\r\n        } finally {\r\n            lock.unlock();\r\n        }\r\n    }\r\n\r\n(It could probably be written in fewer lines of code, but I prefer to write code like this is a way that maximizes readability.)\r\n","title":"Idiom for 2 argument version of Condition#await(long, TimeUnit)","body":"<p>The way to do it would be to get the clock time in the at the start of the <code>waitFor...</code> method. Then when you return from await and the condition is not satisfied, get the clock time again and compare it with the first time to decide if you need to await again.</p>\n<p>The code could look something like this:</p>\n<pre><code>void waitForUpToFiveSeconds() throws InterruptedException {\n    lock.lock();\n    long deadline = System.currentTimeMillis() + 5000L;\n    try {\n        flagSet.await(5000L, TimeUnit.MILLISECONDS);\n        while (!flag) {\n            long now = System.currentTimeMillis();\n            if (now &gt;= deadline) {\n                break;\n            }\n            flagSet.await(deadline - now, TimeUnit.MILLISECONDS);\n        }\n    } finally {\n        lock.unlock();\n    }\n}\n</code></pre>\n<p>(It could probably be written in fewer lines of code, but I prefer to write code like this is a way that maximizes readability.)</p>\n"}],"owner":{"account_id":17087029,"reputation":67,"user_id":12363996,"display_name":"David O&#39;Loughlin"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":23,"favorite_count":0,"down_vote_count":2,"up_vote_count":0,"accepted_answer_id":77157200,"answer_count":1,"score":-2,"last_activity_date":1695381910,"creation_date":1695373254,"question_id":77156195,"body_markdown":"What&#39;s the idiomatic way of handling spurious wakeups when using the 2 argument version of Condition#await(long, TimeUnit)\r\n\r\nI understand the zero argument version:\r\n\r\n    import java.util.concurrent.Executors;\r\n    import java.util.concurrent.TimeUnit;\r\n    import java.util.concurrent.locks.Condition;\r\n    import java.util.concurrent.locks.Lock;\r\n    import java.util.concurrent.locks.ReentrantLock;\r\n    \r\n    class Scratch {\r\n        private final Lock lock = new ReentrantLock();\r\n        private final Condition flagSet = lock.newCondition();\r\n        private boolean flag;\r\n    \r\n        void waitForever() throws InterruptedException {\r\n            lock.lock();\r\n            try {\r\n                while (!flag) {\r\n                    flagSet.await();\r\n                }\r\n            } finally {\r\n                lock.unlock();\r\n            }\r\n        }\r\n   \r\n        void setFlag() {\r\n            lock.lock();\r\n            try {\r\n                flag = true;\r\n                System.out.println(&quot;Flag set to true&quot;);\r\n                flagSet.signalAll();\r\n            } finally {\r\n                lock.unlock();\r\n            }\r\n        }\r\n    \r\n        public static void main(String[] args) throws InterruptedException {\r\n            var scratch = new Scratch();\r\n            var executor = Executors.newSingleThreadScheduledExecutor();\r\n            executor.schedule(scratch::setFlag, 10000, TimeUnit.MILLISECONDS);\r\n            System.out.println(&quot;Waiting for flag...&quot;);\r\n            scratch.waitForever();\r\n            System.out.println(&quot;Finished waiting&quot;);\r\n            executor.shutdownNow();\r\n            System.exit(0);\r\n        }\r\n    }\r\n\r\nHow would I change this so that I wait a maximum of 5 seconds while catering for the possibility of a spurious wakeup?","title":"Idiom for 2 argument version of Condition#await(long, TimeUnit)","body":"<p>What's the idiomatic way of handling spurious wakeups when using the 2 argument version of Condition#await(long, TimeUnit)</p>\n<p>I understand the zero argument version:</p>\n<pre><code>import java.util.concurrent.Executors;\nimport java.util.concurrent.TimeUnit;\nimport java.util.concurrent.locks.Condition;\nimport java.util.concurrent.locks.Lock;\nimport java.util.concurrent.locks.ReentrantLock;\n\nclass Scratch {\n    private final Lock lock = new ReentrantLock();\n    private final Condition flagSet = lock.newCondition();\n    private boolean flag;\n\n    void waitForever() throws InterruptedException {\n        lock.lock();\n        try {\n            while (!flag) {\n                flagSet.await();\n            }\n        } finally {\n            lock.unlock();\n        }\n    }\n\n    void setFlag() {\n        lock.lock();\n        try {\n            flag = true;\n            System.out.println(&quot;Flag set to true&quot;);\n            flagSet.signalAll();\n        } finally {\n            lock.unlock();\n        }\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        var scratch = new Scratch();\n        var executor = Executors.newSingleThreadScheduledExecutor();\n        executor.schedule(scratch::setFlag, 10000, TimeUnit.MILLISECONDS);\n        System.out.println(&quot;Waiting for flag...&quot;);\n        scratch.waitForever();\n        System.out.println(&quot;Finished waiting&quot;);\n        executor.shutdownNow();\n        System.exit(0);\n    }\n}\n</code></pre>\n<p>How would I change this so that I wait a maximum of 5 seconds while catering for the possibility of a spurious wakeup?</p>\n"},{"tags":["java","spring-boot"],"answers":[{"tags":[],"owner":{"account_id":2513345,"reputation":381,"user_id":2185290,"accept_rate":20,"display_name":"Rajendra Gupta"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1564570687,"creation_date":1564570344,"answer_id":57289083,"question_id":57288932,"body_markdown":"@RestController is not meant to be used to return views to be resolved. It is supposed to return data which will be written to the body of the response\r\n\r\n            @RestController     //change it to @Controller\r\n            public class ProductController {\r\n            @Autowired\r\n            ProductService service;\r\n\r\nThis difference between @Controller and the @RestController annotation is that @Controller is to create a Map of model object and find a view but the @RestController simply returns the object and object data is directly written into HTTP response as JSON or XML.","title":"Getting resource not found when try to return html page from controller","body":"<p>@RestController is not meant to be used to return views to be resolved. It is supposed to return data which will be written to the body of the response</p>\n\n<pre><code>        @RestController     //change it to @Controller\n        public class ProductController {\n        @Autowired\n        ProductService service;\n</code></pre>\n\n<p>This difference between @Controller and the @RestController annotation is that @Controller is to create a Map of model object and find a view but the @RestController simply returns the object and object data is directly written into HTTP response as JSON or XML.</p>\n"},{"tags":[],"owner":{"account_id":16392366,"reputation":36,"user_id":11840810,"display_name":"Sivakumar Neelakandan"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1564572706,"creation_date":1564570701,"answer_id":57289196,"question_id":57288932,"body_markdown":"You should always use `@Controller` Annotation while using Spring MVC.\r\n`@RestController` is different from `@Controller`.\r\n\r\n`@Controller` returns a view, used in MVC applications,\r\n\r\nWhile `@RestController` returns a response(Mostly Json), it converts your your java object to Json by using Jackson jar, and these are used for api&#39;s.\r\n","title":"Getting resource not found when try to return html page from controller","body":"<p>You should always use <code>@Controller</code> Annotation while using Spring MVC.\n<code>@RestController</code> is different from <code>@Controller</code>.</p>\n\n<p><code>@Controller</code> returns a view, used in MVC applications,</p>\n\n<p>While <code>@RestController</code> returns a response(Mostly Json), it converts your your java object to Json by using Jackson jar, and these are used for api's.</p>\n"},{"tags":[],"owner":{"account_id":15190407,"reputation":13077,"user_id":10961238,"display_name":"Romil Patel"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1564581929,"creation_date":1564576828,"answer_id":57290978,"question_id":57288932,"body_markdown":"Avoid `@RestController` for *MVC Based Application* which has to return a view. It is mainly used for REST APIs. While *`@Controller` can return a view* \r\n\r\n*More On `@RestController`*:\r\n\r\n[![enter image description here][1]][1]\r\n\r\n - This annotation is a specialized version of `@Controller` which adds\r\n   `@Controller` and `@ResponseBody` annotation automatically. so we do not have to add `@ResponseBody` to our mapping methods. That means\r\n   `@ResponseBody` is default active.\r\n - If you use `@RestController` you cannot return a view (By using\r\n   `Viewresolver` in Spring/Spring-Boot)\r\n - `@RestController` also converts the response to `JSON/XML automatically` as `@ResponseBody` makes the returned objects to something that could be in the body, `e.g. JSON or XML`\r\n\r\n**[Controller vs RestController][2]**\r\n\r\n\r\n----------\r\n \r\n\r\n    @RestController\r\n        public class ProductController {\r\n            @Autowired\r\n            ProductService service;\r\n    \r\n            @RequestMapping(value = { &quot;/&quot;, &quot;/home&quot; })\r\n            public @ResponseBody ModelAndView home() {\r\n                System.out.println(&quot;sdasasas&quot;);\r\n                ModelAndView modelAndView = new ModelAndView();\r\n    \t        modelAndView.setViewName(&quot;home&quot;);\r\n    \t        return modelAndView;\r\n            }\r\n    }\r\n\r\nProject Structure\r\n[![enter image description here][3]][3]\r\n\r\nNo need to specify `spring.mvc.view.prefix=/WEB-INF/html/ spring.mvc.view.suffix=.html`\r\n\r\nAlso, make sure you don&#39;t have any additional class with `@EnableWebMvc` annotation. This can mess up the *spring-boot autoconfiguration.*\r\n\r\n  [1]: https://i.stack.imgur.com/U9mP2.png\r\n  [2]: https://stackoverflow.com/a/56882597/10961238\r\n  [3]: https://i.stack.imgur.com/GZcLt.png","title":"Getting resource not found when try to return html page from controller","body":"<p>Avoid <code>@RestController</code> for <em>MVC Based Application</em> which has to return a view. It is mainly used for REST APIs. While <em><code>@Controller</code> can return a view</em> </p>\n\n<p><em>More On <code>@RestController</code></em>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/U9mP2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U9mP2.png\" alt=\"enter image description here\"></a></p>\n\n<ul>\n<li>This annotation is a specialized version of <code>@Controller</code> which adds\n<code>@Controller</code> and <code>@ResponseBody</code> annotation automatically. so we do not have to add <code>@ResponseBody</code> to our mapping methods. That means\n<code>@ResponseBody</code> is default active.</li>\n<li>If you use <code>@RestController</code> you cannot return a view (By using\n<code>Viewresolver</code> in Spring/Spring-Boot)</li>\n<li><code>@RestController</code> also converts the response to <code>JSON/XML automatically</code> as <code>@ResponseBody</code> makes the returned objects to something that could be in the body, <code>e.g. JSON or XML</code></li>\n</ul>\n\n<p><strong><a href=\"https://stackoverflow.com/a/56882597/10961238\">Controller vs RestController</a></strong></p>\n\n<hr>\n\n<pre><code>@RestController\n    public class ProductController {\n        @Autowired\n        ProductService service;\n\n        @RequestMapping(value = { \"/\", \"/home\" })\n        public @ResponseBody ModelAndView home() {\n            System.out.println(\"sdasasas\");\n            ModelAndView modelAndView = new ModelAndView();\n            modelAndView.setViewName(\"home\");\n            return modelAndView;\n        }\n}\n</code></pre>\n\n<p>Project Structure\n<a href=\"https://i.stack.imgur.com/GZcLt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GZcLt.png\" alt=\"enter image description here\"></a></p>\n\n<p>No need to specify <code>spring.mvc.view.prefix=/WEB-INF/html/ spring.mvc.view.suffix=.html</code></p>\n\n<p>Also, make sure you don't have any additional class with <code>@EnableWebMvc</code> annotation. This can mess up the <em>spring-boot autoconfiguration.</em></p>\n"},{"tags":[],"owner":{"account_id":16947335,"reputation":1498,"user_id":12257758,"display_name":"ANUP SAJJAN"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1629052191,"creation_date":1629052191,"answer_id":68794339,"question_id":57288932,"body_markdown":"If you are returning a view page like .jsp from the controller, and it&#39;s throwing an error saying cannot locate resource .jsp or 404 not found, then try adding these dependencies to your pom file, it worked for me.\r\n\r\n     &lt;dependency&gt;\r\n        &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;\r\n        &lt;artifactId&gt;tomcat-embed-jasper&lt;/artifactId&gt;\r\n        &lt;scope&gt;provided&lt;/scope&gt;\r\n    &lt;/dependency&gt;\r\n\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;javax.servlet&lt;/groupId&gt;\r\n        &lt;artifactId&gt;jstl&lt;/artifactId&gt;\r\n    &lt;/dependency&gt;","title":"Getting resource not found when try to return html page from controller","body":"<p>If you are returning a view page like .jsp from the controller, and it's throwing an error saying cannot locate resource .jsp or 404 not found, then try adding these dependencies to your pom file, it worked for me.</p>\n<pre><code> &lt;dependency&gt;\n    &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;\n    &lt;artifactId&gt;tomcat-embed-jasper&lt;/artifactId&gt;\n    &lt;scope&gt;provided&lt;/scope&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;javax.servlet&lt;/groupId&gt;\n    &lt;artifactId&gt;jstl&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":11212691,"reputation":1,"user_id":8226319,"display_name":"rahuljain"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695381900,"creation_date":1695381900,"answer_id":77157199,"question_id":57288932,"body_markdown":"Please check your project structure.\r\nThe class where you are calling SpringApplication.run(XXX.class, args), hierarchy wise should be on top, and then other classes where you are using @RestController.","title":"Getting resource not found when try to return html page from controller","body":"<p>Please check your project structure.\nThe class where you are calling SpringApplication.run(XXX.class, args), hierarchy wise should be on top, and then other classes where you are using @RestController.</p>\n"}],"owner":{"account_id":14739504,"reputation":71,"user_id":10644487,"display_name":"Sahil"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":7993,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"accepted_answer_id":57290978,"answer_count":5,"score":3,"last_activity_date":1695381900,"creation_date":1564569781,"question_id":57288932,"body_markdown":"I am unable to render html page in springboot. \r\nHere is code...\r\n\r\n            \r\n    @RestController\r\n        public class ProductController {\r\n        \t@Autowired\r\n        \tProductService service;\r\n        \r\n        \t@InitBinder\r\n        \tpublic void initBinder(WebDataBinder webDataBinder) {\r\n        \t\tSimpleDateFormat dateFormat = new SimpleDateFormat(&quot;dd-MM-yyyy&quot;);\r\n        \t\tdateFormat.setLenient(false);\r\n        \t\twebDataBinder.registerCustomEditor(Date.class, new CustomDateEditor(dateFormat, true));\r\n        \t}\r\n        \t\r\n        \t@RequestMapping(value = { &quot;/&quot;, &quot;/home&quot; })\r\n        \tpublic ModelAndView home() {\r\n        \t\tSystem.out.println(&quot;sdasasas&quot;);\r\n        \t\treturn new ModelAndView(&quot;home&quot;);\r\n        \t}\r\n        \r\n        \r\n    \r\n    \r\n\r\nbut whenever i hit http://localhost:8080/home it shows following logs\r\n\r\n    -8080-exec-4] o.s.w.s.v.ContentNegotiatingViewResolver : Selected &#39;text/html&#39; given [text/html, application/xhtml+xml, image/webp, image/apng, application/signed-exchange;v=b3, application/xml;q=0.9,*/*;q=0.8]\r\n    2019-07-31 16:05:25.354 DEBUG 14850 --- [nio-8080-exec-4] o.s.w.servlet.view.InternalResourceView  : View name &#39;home&#39;, model {}\r\n    2019-07-31 16:05:25.354 DEBUG 14850 --- [nio-8080-exec-4] o.s.w.servlet.view.InternalResourceView  : Forwarding to [/WEB-INF/html/home.html]\r\n    2019-07-31 16:05:25.354 DEBUG 14850 --- [nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : &quot;FORWARD&quot; dispatch for GET &quot;/WEB-INF/html/home.html&quot;, parameters={}\r\n    2019-07-31 16:05:25.356 DEBUG 14850 --- [nio-8080-exec-4] o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapped to ResourceHttpRequestHandler [&quot;classpath:/META-INF/resources/&quot;, &quot;classpath:/resources/&quot;, &quot;classpath:/static/&quot;, &quot;classpath:/public/&quot;,&quot;/&quot;]\r\n    2019-07-31 16:05:25.356  WARN 14850 --- [nio-8080-exec-4] o.s.w.s.r.ResourceHttpRequestHandler     : Path with &quot;WEB-INF&quot; or &quot;META-INF&quot;: [WEB-INF/html/home.html]\r\n    2019-07-31 16:05:25.356 DEBUG 14850 --- [nio-8080-exec-4] o.s.w.s.r.ResourceHttpRequestHandler     : Resource not found\r\n    2019-07-31 16:05:25.357 DEBUG 14850 --- [nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Exiting from &quot;FORWARD&quot; dispatch, status 404\r\n    2019-07-31 16:05:25.357 DEBUG 14850 --- [nio-8080-exec-4] o.j.s.OpenEntityManagerInViewInterceptor : Closing JPA EntityManager in OpenEntityManagerInViewInterceptor\r\n    2019-07-31 16:05:25.357 DEBUG 14850 --- [nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 404 NOT_FOUND\r\n    2019-07-31 16:05:25.357 DEBUG 14850 --- [nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : &quot;ERROR&quot; dispatch for GET &quot;/error&quot;, parameters={}","title":"Getting resource not found when try to return html page from controller","body":"<p>I am unable to render html page in springboot.\nHere is code...</p>\n<pre><code>@RestController\n    public class ProductController {\n        @Autowired\n        ProductService service;\n    \n        @InitBinder\n        public void initBinder(WebDataBinder webDataBinder) {\n            SimpleDateFormat dateFormat = new SimpleDateFormat(&quot;dd-MM-yyyy&quot;);\n            dateFormat.setLenient(false);\n            webDataBinder.registerCustomEditor(Date.class, new CustomDateEditor(dateFormat, true));\n        }\n        \n        @RequestMapping(value = { &quot;/&quot;, &quot;/home&quot; })\n        public ModelAndView home() {\n            System.out.println(&quot;sdasasas&quot;);\n            return new ModelAndView(&quot;home&quot;);\n        }\n    \n    \n</code></pre>\n<p>but whenever i hit http://localhost:8080/home it shows following logs</p>\n<pre><code>-8080-exec-4] o.s.w.s.v.ContentNegotiatingViewResolver : Selected 'text/html' given [text/html, application/xhtml+xml, image/webp, image/apng, application/signed-exchange;v=b3, application/xml;q=0.9,*/*;q=0.8]\n2019-07-31 16:05:25.354 DEBUG 14850 --- [nio-8080-exec-4] o.s.w.servlet.view.InternalResourceView  : View name 'home', model {}\n2019-07-31 16:05:25.354 DEBUG 14850 --- [nio-8080-exec-4] o.s.w.servlet.view.InternalResourceView  : Forwarding to [/WEB-INF/html/home.html]\n2019-07-31 16:05:25.354 DEBUG 14850 --- [nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : &quot;FORWARD&quot; dispatch for GET &quot;/WEB-INF/html/home.html&quot;, parameters={}\n2019-07-31 16:05:25.356 DEBUG 14850 --- [nio-8080-exec-4] o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapped to ResourceHttpRequestHandler [&quot;classpath:/META-INF/resources/&quot;, &quot;classpath:/resources/&quot;, &quot;classpath:/static/&quot;, &quot;classpath:/public/&quot;,&quot;/&quot;]\n2019-07-31 16:05:25.356  WARN 14850 --- [nio-8080-exec-4] o.s.w.s.r.ResourceHttpRequestHandler     : Path with &quot;WEB-INF&quot; or &quot;META-INF&quot;: [WEB-INF/html/home.html]\n2019-07-31 16:05:25.356 DEBUG 14850 --- [nio-8080-exec-4] o.s.w.s.r.ResourceHttpRequestHandler     : Resource not found\n2019-07-31 16:05:25.357 DEBUG 14850 --- [nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Exiting from &quot;FORWARD&quot; dispatch, status 404\n2019-07-31 16:05:25.357 DEBUG 14850 --- [nio-8080-exec-4] o.j.s.OpenEntityManagerInViewInterceptor : Closing JPA EntityManager in OpenEntityManagerInViewInterceptor\n2019-07-31 16:05:25.357 DEBUG 14850 --- [nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 404 NOT_FOUND\n2019-07-31 16:05:25.357 DEBUG 14850 --- [nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : &quot;ERROR&quot; dispatch for GET &quot;/error&quot;, parameters={}\n</code></pre>\n"},{"tags":["java","hibernate","kotlin","jpa"],"comments":[{"owner":{"account_id":9531412,"reputation":2010,"user_id":7082956,"display_name":"Valerij Dobler"},"score":0,"creation_date":1695369656,"post_id":77155630,"comment_id":136017930,"body_markdown":"Generally, you want to use only one. Either ManyToOne or OneToMany. Why do you need both? `Parent` seems to be the aggregate. Just omit the parent field in the child and fetch the children always by the parent.","body":"Generally, you want to use only one. Either ManyToOne or OneToMany. Why do you need both? <code>Parent</code> seems to be the aggregate. Just omit the parent field in the child and fetch the children always by the parent."},{"owner":{"account_id":1915598,"reputation":863,"user_id":1728241,"accept_rate":57,"display_name":"Mr.Mountain"},"score":0,"creation_date":1695370217,"post_id":77155630,"comment_id":136018025,"body_markdown":"Since child is owning the foreign key, your comment is not quiet right: I should omit the child in the parent, and fetch the children using the parent id using the fk column. But It want to make both work - so instead of asking &quot;Why both&quot; - I would like to get help for the question: What do I have to do, to make it work.","body":"Since child is owning the foreign key, your comment is not quiet right: I should omit the child in the parent, and fetch the children using the parent id using the fk column. But It want to make both work - so instead of asking &quot;Why both&quot; - I would like to get help for the question: What do I have to do, to make it work."},{"owner":{"account_id":3973489,"reputation":2934,"user_id":3277386,"accept_rate":60,"display_name":"TreffnonX"},"score":1,"creation_date":1695373228,"post_id":77155630,"comment_id":136018554,"body_markdown":"You can&#39;t make it work. Assume this: If you fetch the list of children when you fetch a parent, then you would have to fetch all child entities as well. Those child entities then, would have their own child entities fetched (immediately). What you need is a lazy list, one that only fetches it&#39;s entities, once they are accessed, but this is (often) a very bad pattern, as it causes unexpected DB-calls in situations where you don&#39;t expect them, and depending on the implementation, you either fetch one, or all entities, either which can be inefficient, if generalized.","body":"You can&#39;t make it work. Assume this: If you fetch the list of children when you fetch a parent, then you would have to fetch all child entities as well. Those child entities then, would have their own child entities fetched (immediately). What you need is a lazy list, one that only fetches it&#39;s entities, once they are accessed, but this is (often) a very bad pattern, as it causes unexpected DB-calls in situations where you don&#39;t expect them, and depending on the implementation, you either fetch one, or all entities, either which can be inefficient, if generalized."},{"owner":{"account_id":9531412,"reputation":2010,"user_id":7082956,"display_name":"Valerij Dobler"},"score":0,"creation_date":1695375361,"post_id":77155630,"comment_id":136019024,"body_markdown":"@Mr.Mountain for a relational DB you just need one of those relations. I&#39;d add an FK in the child but have a `@OneToMany` at the parent combined with `@JoinColumn(name = &quot;parent_fk&quot;, nullable = false)`","body":"@Mr.Mountain for a relational DB you just need one of those relations. I&#39;d add an FK in the child but have a <code>@OneToMany</code> at the parent combined with <code>@JoinColumn(name = &quot;parent_fk&quot;, nullable = false)</code>"},{"owner":{"account_id":1915598,"reputation":863,"user_id":1728241,"accept_rate":57,"display_name":"Mr.Mountain"},"score":0,"creation_date":1695381486,"post_id":77155630,"comment_id":136020249,"body_markdown":"But this would create a new column at the parent &#39;parent_fk&#39; referencing the child. The relation should stay unidirectional. But the retrieval should collect the reference.","body":"But this would create a new column at the parent &#39;parent_fk&#39; referencing the child. The relation should stay unidirectional. But the retrieval should collect the reference."},{"owner":{"account_id":231721,"reputation":20460,"user_id":496099,"display_name":"Chris"},"score":0,"creation_date":1695396284,"post_id":77155630,"comment_id":136023404,"body_markdown":"I don&#39;t see any problems with your mappings - this a standard bidirectional OneToMany relationship. It is also the standard problem with bidirectional relationships - your application is only setting the ManyToOne side of things. JPA maintains a cache of managed entities, so every find call on the parent will return the managed instance. As these are just java objects, the Parent collection will never show the children referencing it if you don&#39;t set the references to keep the object in synch with the database; that is until it is refreshed or re-loaded from the database.","body":"I don&#39;t see any problems with your mappings - this a standard bidirectional OneToMany relationship. It is also the standard problem with bidirectional relationships - your application is only setting the ManyToOne side of things. JPA maintains a cache of managed entities, so every find call on the parent will return the managed instance. As these are just java objects, the Parent collection will never show the children referencing it if you don&#39;t set the references to keep the object in synch with the database; that is until it is refreshed or re-loaded from the database."},{"owner":{"account_id":231721,"reputation":20460,"user_id":496099,"display_name":"Chris"},"score":0,"creation_date":1695398818,"post_id":77155630,"comment_id":136023879,"body_markdown":"In short: add the child to the parent.children list when adding new children is the easiest solution. If you don&#39;t/can&#39;t do that, the other alternative is to force a refresh on the parent instance using em.refresh(parent), which will cause it to re fetch the children collection from the database with the current state.","body":"In short: add the child to the parent.children list when adding new children is the easiest solution. If you don&#39;t/can&#39;t do that, the other alternative is to force a refresh on the parent instance using em.refresh(parent), which will cause it to re fetch the children collection from the database with the current state."},{"owner":{"account_id":1915598,"reputation":863,"user_id":1728241,"accept_rate":57,"display_name":"Mr.Mountain"},"score":0,"creation_date":1695632238,"post_id":77155630,"comment_id":136045312,"body_markdown":"Ok - so JPA will not fetch the children and I have to do it manually. Right? If so, please provide a nice answer for the next JPA solution seeking developer and I will accept the answer.","body":"Ok - so JPA will not fetch the children and I have to do it manually. Right? If so, please provide a nice answer for the next JPA solution seeking developer and I will accept the answer."}],"owner":{"account_id":1915598,"reputation":863,"user_id":1728241,"accept_rate":57,"display_name":"Mr.Mountain"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":38,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1695381420,"creation_date":1695367874,"question_id":77155630,"body_markdown":"**Infos**\r\n\r\nSpring 3.1.2 / Kotlin 1.9.10\r\n\r\n**Code**\r\n```\r\n@Entity\r\ndata class Parent(\r\n    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    var id: Long? = -1,\r\n    @OneToMany(mappedBy = &quot;parent&quot;, fetch = FetchType.LAZY)\r\n    val children: List&lt;Child&gt;? = arrayListOf()\r\n)\r\n\r\n\r\n@Entity\r\ndata class Child(\r\n    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    var id: Long? = -1,\r\n    @ManyToOne(fetch = FetchType.LAZY, optional = true) @JoinColumn(name = &quot;fk_parent&quot;) // owns the foreign keys\r\n    val parent: Parent? = null\r\n)\r\n\r\n@Repository\r\ninterface ParentRepository : JpaRepository&lt;Parent, Long&gt;\r\n\r\n@Repository\r\ninterface ChildRepository : JpaRepository&lt;Child, Long&gt;\r\n\r\n```\r\n\r\n**Test with H2 and PostGres Dialect**\r\n\r\n\r\n```\r\n@Transactional\r\n@SpringBootTest(classes = [Application::class], webEnvironment = SpringBootTest.WebEnvironment.DEFINED_PORT)\r\n@ActiveProfiles(&quot;test&quot;)\r\ninternal class ParentRepositoryTest {\r\n\r\n    @Autowired\r\n    lateinit var parentRepository: ParentRepository\r\n\r\n    @Autowired\r\n    lateinit var childRepository: ChildRepository\r\n\r\n    @Test\r\n    fun test() {\r\n        var parent = parentRepository.saveAndFlush(Parent())\r\n        childRepository.saveAndFlush(Child().copy(parent = parent))\r\n        parent = parentRepository.findById(parent.id).get() // don&#39;t do this at home, kids\r\n        Assertions.assertNotNull(parent.children)\r\n        Assertions.assertTrue(parent.children!!.isNotEmpty()) // fails\r\n    }\r\n}\r\n```\r\n\r\n**Question**\r\n\r\nWhen running the test field of parent containing the children is always empty. But I want to use the list of the children.\r\n","title":"JPA Spring OneToMany ManyToOne Collection Empty","body":"<p><strong>Infos</strong></p>\n<p>Spring 3.1.2 / Kotlin 1.9.10</p>\n<p><strong>Code</strong></p>\n<pre><code>@Entity\ndata class Parent(\n    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)\n    var id: Long? = -1,\n    @OneToMany(mappedBy = &quot;parent&quot;, fetch = FetchType.LAZY)\n    val children: List&lt;Child&gt;? = arrayListOf()\n)\n\n\n@Entity\ndata class Child(\n    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)\n    var id: Long? = -1,\n    @ManyToOne(fetch = FetchType.LAZY, optional = true) @JoinColumn(name = &quot;fk_parent&quot;) // owns the foreign keys\n    val parent: Parent? = null\n)\n\n@Repository\ninterface ParentRepository : JpaRepository&lt;Parent, Long&gt;\n\n@Repository\ninterface ChildRepository : JpaRepository&lt;Child, Long&gt;\n\n</code></pre>\n<p><strong>Test with H2 and PostGres Dialect</strong></p>\n<pre><code>@Transactional\n@SpringBootTest(classes = [Application::class], webEnvironment = SpringBootTest.WebEnvironment.DEFINED_PORT)\n@ActiveProfiles(&quot;test&quot;)\ninternal class ParentRepositoryTest {\n\n    @Autowired\n    lateinit var parentRepository: ParentRepository\n\n    @Autowired\n    lateinit var childRepository: ChildRepository\n\n    @Test\n    fun test() {\n        var parent = parentRepository.saveAndFlush(Parent())\n        childRepository.saveAndFlush(Child().copy(parent = parent))\n        parent = parentRepository.findById(parent.id).get() // don't do this at home, kids\n        Assertions.assertNotNull(parent.children)\n        Assertions.assertTrue(parent.children!!.isNotEmpty()) // fails\n    }\n}\n</code></pre>\n<p><strong>Question</strong></p>\n<p>When running the test field of parent containing the children is always empty. But I want to use the list of the children.</p>\n"},{"tags":["java","apache-kafka","producer-consumer"],"comments":[{"owner":{"account_id":3285310,"reputation":150,"user_id":4316743,"accept_rate":20,"display_name":"Michal"},"score":0,"creation_date":1520954164,"post_id":47231775,"comment_id":85522733,"body_markdown":"could be same problem as here https://stackoverflow.com/questions/43315013/how-to-make-kafka-source-reconnect-when-kafka-restarts","body":"could be same problem as here <a href=\"https://stackoverflow.com/questions/43315013/how-to-make-kafka-source-reconnect-when-kafka-restarts\" title=\"how to make kafka source reconnect when kafka restarts\">stackoverflow.com/questions/43315013/&hellip;</a>"}],"answers":[{"tags":[],"owner":{"account_id":5201756,"reputation":1971,"user_id":4160889,"accept_rate":74,"display_name":"ForeverLearner"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1581280585,"creation_date":1581257192,"answer_id":60137450,"question_id":47231775,"body_markdown":"     bin/kafka-console-consumer.sh --bootstrap-server tt01.my.tech:9092,tt02.my.tech:9092,tt03.my.tech:9092 --topic wallet-test-topic1 --from-beginning\r\n    new message from topic1\r\n    hello\r\n    hello world\r\n    123\r\n    hello again\r\n    123\r\n    what do i publish ?\r\n    [2020-02-09 16:57:21,142] WARN [Consumer clientId=consumer-1, groupId=console-consumer-93672] Connection to node 2 (tt02.my.tech/192.168.35.118:9092) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)\r\n    [2020-02-09 16:57:25,999] WARN [Consumer clientId=consumer-1, groupId=console-consumer-93672] Connection to node 2 (tt02.my.tech/192.168.35.118:9092) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)\r\n    [2020-02-09 16:57:58,902] WARN [Consumer clientId=consumer-1, groupId=console-consumer-93672] Connection to node 2 (tt02.my.tech/192.168.35.118:9092) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)\r\n    [2020-02-09 16:57:59,024] WARN [Consumer clientId=consumer-1, groupId=console-consumer-93672] Connection to node 3 (tt03.my.tech/192.168.35.126:9092) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)\r\n    ^CProcessed a total of 7 messages\r\n\r\n\r\nOn the consumer side, if there is no message read after the poll , this warning is thrown.\r\n\r\nBasically, a call to `.poll` has a reference to \r\n\r\n`handleTimedOutRequests(responses, updatedNow);`\r\n\r\nIf there are no message read in this poll and there is a timeout, then `processDisconnection` will throw the warning.\r\n\r\n    private void handleTimedOutRequests(List&lt;ClientResponse&gt; responses, long now) {\r\n        List&lt;String&gt; nodeIds = this.inFlightRequests.nodesWithTimedOutRequests(now);\r\n        for (String nodeId : nodeIds) {\r\n            // close connection to the node\r\n            this.selector.close(nodeId);\r\n            log.debug(&quot;Disconnecting from node {} due to request timeout.&quot;, nodeId);\r\n            processDisconnection(responses, nodeId, now, ChannelState.LOCAL_CLOSE);\r\n        }\r\n    \r\n        // we disconnected, so we should probably refresh our metadata\r\n        if (!nodeIds.isEmpty())\r\n            metadataUpdater.requestUpdate();\r\n    }\r\n\t\r\n\r\nThis exact case-match in processDisconnection throws this warning:\r\n\r\n\r\n            case NOT_CONNECTED:\r\n            log.warn(&quot;Connection to node {} ({}) could not be established. Broker may not be available.&quot;, nodeId, disconnectState.remoteAddress());\r\n\r\nIn short, everything will work fine from producer-consumer perspective. And you should treat the message as any other `WARN`","title":"Kafka broker may not be available exception","body":"<pre><code> bin/kafka-console-consumer.sh --bootstrap-server tt01.my.tech:9092,tt02.my.tech:9092,tt03.my.tech:9092 --topic wallet-test-topic1 --from-beginning\nnew message from topic1\nhello\nhello world\n123\nhello again\n123\nwhat do i publish ?\n[2020-02-09 16:57:21,142] WARN [Consumer clientId=consumer-1, groupId=console-consumer-93672] Connection to node 2 (tt02.my.tech/192.168.35.118:9092) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)\n[2020-02-09 16:57:25,999] WARN [Consumer clientId=consumer-1, groupId=console-consumer-93672] Connection to node 2 (tt02.my.tech/192.168.35.118:9092) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)\n[2020-02-09 16:57:58,902] WARN [Consumer clientId=consumer-1, groupId=console-consumer-93672] Connection to node 2 (tt02.my.tech/192.168.35.118:9092) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)\n[2020-02-09 16:57:59,024] WARN [Consumer clientId=consumer-1, groupId=console-consumer-93672] Connection to node 3 (tt03.my.tech/192.168.35.126:9092) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)\n^CProcessed a total of 7 messages\n</code></pre>\n\n<p>On the consumer side, if there is no message read after the poll , this warning is thrown.</p>\n\n<p>Basically, a call to <code>.poll</code> has a reference to </p>\n\n<p><code>handleTimedOutRequests(responses, updatedNow);</code></p>\n\n<p>If there are no message read in this poll and there is a timeout, then <code>processDisconnection</code> will throw the warning.</p>\n\n<pre><code>private void handleTimedOutRequests(List&lt;ClientResponse&gt; responses, long now) {\n    List&lt;String&gt; nodeIds = this.inFlightRequests.nodesWithTimedOutRequests(now);\n    for (String nodeId : nodeIds) {\n        // close connection to the node\n        this.selector.close(nodeId);\n        log.debug(\"Disconnecting from node {} due to request timeout.\", nodeId);\n        processDisconnection(responses, nodeId, now, ChannelState.LOCAL_CLOSE);\n    }\n\n    // we disconnected, so we should probably refresh our metadata\n    if (!nodeIds.isEmpty())\n        metadataUpdater.requestUpdate();\n}\n</code></pre>\n\n<p>This exact case-match in processDisconnection throws this warning:</p>\n\n<pre><code>        case NOT_CONNECTED:\n        log.warn(\"Connection to node {} ({}) could not be established. Broker may not be available.\", nodeId, disconnectState.remoteAddress());\n</code></pre>\n\n<p>In short, everything will work fine from producer-consumer perspective. And you should treat the message as any other <code>WARN</code></p>\n"}],"owner":{"account_id":2939068,"reputation":2834,"user_id":2517384,"accept_rate":81,"display_name":"MeetJoeBlack"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":9653,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":1,"score":2,"last_activity_date":1695380860,"creation_date":1510351223,"question_id":47231775,"body_markdown":"I faced a strange issue with my Kafka producer. I use kafka-0.11 server/client version.\r\nI have one zookeper and one kafka broker node. Also, I created &#39;events&#39; topic with 3 partitions:\r\n\r\n    Topic:events    PartitionCount:3        ReplicationFactor:1     Configs:\r\n            Topic: events   Partition: 0    Leader: 0       Replicas: 0     Isr: 0\r\n            Topic: events   Partition: 1    Leader: 0       Replicas: 0     Isr: 0\r\n            Topic: events   Partition: 2    Leader: 0       Replicas: 0     Isr: 0\r\n\r\nIn my java code I create producer with the following properties:\r\n\r\n    Properties props = new Properties();\r\n    props.put(BOOTSTRAP_SERVERS_CONFIG, brokerUrl);\r\n    props.put(MAX_BLOCK_MS_CONFIG, 30000);\r\n    props.put(KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());\r\n    props.put(VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());\r\n    props.put(PARTITIONER_CLASS_CONFIG, KafkaCustomPartitioner.class);\r\n    this.producer = new KafkaProducer&lt;&gt;(props);\r\n\r\nAlso, I&#39;have added a callback to Producer#send() method that adds failed message to the queue that is iterated by the other &quot;re-sending&quot; thread in a loop:\r\n\r\n    this.producer.send(producerRecord, new ProducerCallback(producerRecord.value(), topic));\r\n    \r\n    private class ProducerCallback implements Callback {\r\n\t  private final String message;\r\n\t  private final String topic;\r\n\r\n\t  public ProducerCallback(String message, String topic) {\r\n\t\tthis.message = message;\r\n\t\tthis.topic = topic;\r\n\t  }\r\n\r\n\t  @Override\r\n\t  public void onCompletion(RecordMetadata metadata, Exception ex) {\r\n\t\tif (ex != null) {\r\n\t\t\tlogger.error(&quot;Kafka producer error. Topic: &quot; + topic +\r\n\t\t\t\t\t&quot;.Message will be added into failed messages queue.&quot;, ex);\r\n\t\t\tfailedMessagesQueue.enqueue(SerializationUtils.serialize(new FailedMessage(topic, message)));\r\n\t\t}\r\n\t  }\r\n    }\r\n\r\n    private class ResenderThread extends Thread {\r\n        private volatile boolean running = true;\r\n\r\n        public void stopGracefully() {\r\n            running = false;\r\n        }\r\n\r\n        @Override\r\n        public void run() {\r\n            while (running) {\r\n                try {\r\n                    byte[] val = failedMessagesQueue.peek();\r\n                    if (val != null) {\r\n                        FailedMessage failedMessage = SerializationUtils.deserialize(val);\r\n                        ProducerRecord&lt;String, String&gt; record;\r\n                        if (topic.equals(failedMessage.getTopic())) {\r\n                            String messageKey = generateMessageKey(failedMessage.getMessage());\r\n                            record = createProducerRecordWithKey(failedMessage.getMessage(), messageKey, failedMessage.getTopic());\r\n                        } else {\r\n                            record = new ProducerRecord&lt;&gt;(failedMessage.getTopic(), failedMessage.getMessage());\r\n                        }\r\n                        try {\r\n                            this.producer.send(record).get();\r\n                            failedMessagesQueue.dequeue();\r\n                        } catch (Exception e) {\r\n                            logger.debug(&quot;Kafka message resending attempt was failed. Topic &quot; + failedMessage.getTopic() +\r\n                                    &quot; Partition. &quot; + record.partition() + &quot;. &quot; + e.getMessage());\r\n                        }\r\n                    }\r\n\r\n                    Thread.sleep(200);\r\n                } catch (Exception e) {\r\n                    logger.error(&quot;Error resending an event&quot;, e);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\t\r\nEverything works fine until I decided to test Kafka broker kill/re-start scenario:\r\n\r\nI&#39;ve killed my Kafka broker node, and sent a 5 messages using my Kafka producer. The following message were logged by my producer app:\r\n\r\n    ....the application works fine....\r\n    // kafka broker was killed\r\n    2017-11-10 09:20:44,594 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\r\n    2017-11-10 09:20:44,646 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\r\n    2017-11-10 09:20:44,700 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\r\n    2017-11-10 09:20:44,759 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\r\n    2017-11-10 09:20:44,802 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\r\n    // sent 5 message using producer. message were put to the failedMessagesQueue and &quot;re-sender&quot; thread started resending \r\n    2017-11-10 09:20:44,905 ERROR [com.inq.kafka.KafkaETLService] - &lt;Kafka producer error. Topic: events.Message will be added into failed messages queue.&gt;\r\n    ....\r\n    2017-11-10 09:20:45,070 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\r\n    2017-11-10 09:20:45,129 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\r\n    2017-11-10 09:20:45,170 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\r\n    2017-11-10 09:20:45,217 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\r\n    \r\n    // kafka broker was restarted, some strange errors were logged\r\n    2017-11-10 09:20:51,103 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Error while fetching metadata with correlation id 29 : {events=INVALID_REPLICATION_FACTOR}&gt;\r\n    2017-11-10 09:20:51,205 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Error while fetching metadata with correlation id 31 : {events=INVALID_REPLICATION_FACTOR}&gt;\r\n    2017-11-10 09:20:51,308 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Error while fetching metadata with correlation id 32 : {events=INVALID_REPLICATION_FACTOR}&gt;\r\n    2017-11-10 09:20:51,114 WARN [org.apache.kafka.clients.producer.internals.Sender] - &lt;Received unknown topic or partition error in produce request on partition events-0. The topic/partition may not exist or the user may not have Describe access to it&gt;\r\n    2017-11-10 09:20:51,114 ERROR [com.inq.kafka.KafkaETLService] - &lt;Kafka message resending attempt was failed. Topic events. org.apache.kafka.common.errors.UnknownTopicOrPartitionException: This server does not host this topic-partition.&gt;\r\n    2017-11-10 09:20:52,485 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Error while fetching metadata with correlation id 33 : {events=INVALID_REPLICATION_FACTOR}&gt;\r\n    // messages were succesfully re-sent and received by consumer..\r\n\r\nHow can I get rid of these logs (that logs every 100ms when Kafka broker is down):\r\n\r\n    [org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\r\n\r\nWhy do I receive the following errors after Kafka broker startup(I didn&#39;t change any server props, and didn&#39;t alter the topic). It seems to me that these errors are result of some syncrhonization process between zookeeper and kafka during broker startup, because after some time procuder succesfully resent my messages. Am I wrong?:\r\n\r\n    [org.apache.kafka.clients.NetworkClient] - &lt;Error while fetching metadata with correlation id 29 : {events=INVALID_REPLICATION_FACTOR}&gt;\r\n    Received unknown topic or partition error in produce request on partition events-0. The topic/partition may not exist or the user may not have Describe access to it. ","title":"Kafka broker may not be available exception","body":"<p>I faced a strange issue with my Kafka producer. I use kafka-0.11 server/client version.\nI have one zookeper and one kafka broker node. Also, I created 'events' topic with 3 partitions:</p>\n\n<pre><code>Topic:events    PartitionCount:3        ReplicationFactor:1     Configs:\n        Topic: events   Partition: 0    Leader: 0       Replicas: 0     Isr: 0\n        Topic: events   Partition: 1    Leader: 0       Replicas: 0     Isr: 0\n        Topic: events   Partition: 2    Leader: 0       Replicas: 0     Isr: 0\n</code></pre>\n\n<p>In my java code I create producer with the following properties:</p>\n\n<pre><code>Properties props = new Properties();\nprops.put(BOOTSTRAP_SERVERS_CONFIG, brokerUrl);\nprops.put(MAX_BLOCK_MS_CONFIG, 30000);\nprops.put(KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());\nprops.put(VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());\nprops.put(PARTITIONER_CLASS_CONFIG, KafkaCustomPartitioner.class);\nthis.producer = new KafkaProducer&lt;&gt;(props);\n</code></pre>\n\n<p>Also, I'have added a callback to Producer#send() method that adds failed message to the queue that is iterated by the other \"re-sending\" thread in a loop:</p>\n\n<pre><code>this.producer.send(producerRecord, new ProducerCallback(producerRecord.value(), topic));\n\nprivate class ProducerCallback implements Callback {\n  private final String message;\n  private final String topic;\n\n  public ProducerCallback(String message, String topic) {\n    this.message = message;\n    this.topic = topic;\n  }\n\n  @Override\n  public void onCompletion(RecordMetadata metadata, Exception ex) {\n    if (ex != null) {\n        logger.error(\"Kafka producer error. Topic: \" + topic +\n                \".Message will be added into failed messages queue.\", ex);\n        failedMessagesQueue.enqueue(SerializationUtils.serialize(new FailedMessage(topic, message)));\n    }\n  }\n}\n\nprivate class ResenderThread extends Thread {\n    private volatile boolean running = true;\n\n    public void stopGracefully() {\n        running = false;\n    }\n\n    @Override\n    public void run() {\n        while (running) {\n            try {\n                byte[] val = failedMessagesQueue.peek();\n                if (val != null) {\n                    FailedMessage failedMessage = SerializationUtils.deserialize(val);\n                    ProducerRecord&lt;String, String&gt; record;\n                    if (topic.equals(failedMessage.getTopic())) {\n                        String messageKey = generateMessageKey(failedMessage.getMessage());\n                        record = createProducerRecordWithKey(failedMessage.getMessage(), messageKey, failedMessage.getTopic());\n                    } else {\n                        record = new ProducerRecord&lt;&gt;(failedMessage.getTopic(), failedMessage.getMessage());\n                    }\n                    try {\n                        this.producer.send(record).get();\n                        failedMessagesQueue.dequeue();\n                    } catch (Exception e) {\n                        logger.debug(\"Kafka message resending attempt was failed. Topic \" + failedMessage.getTopic() +\n                                \" Partition. \" + record.partition() + \". \" + e.getMessage());\n                    }\n                }\n\n                Thread.sleep(200);\n            } catch (Exception e) {\n                logger.error(\"Error resending an event\", e);\n                break;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Everything works fine until I decided to test Kafka broker kill/re-start scenario:</p>\n\n<p>I've killed my Kafka broker node, and sent a 5 messages using my Kafka producer. The following message were logged by my producer app:</p>\n\n<pre><code>....the application works fine....\n// kafka broker was killed\n2017-11-10 09:20:44,594 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\n2017-11-10 09:20:44,646 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\n2017-11-10 09:20:44,700 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\n2017-11-10 09:20:44,759 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\n2017-11-10 09:20:44,802 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\n// sent 5 message using producer. message were put to the failedMessagesQueue and \"re-sender\" thread started resending \n2017-11-10 09:20:44,905 ERROR [com.inq.kafka.KafkaETLService] - &lt;Kafka producer error. Topic: events.Message will be added into failed messages queue.&gt;\n....\n2017-11-10 09:20:45,070 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\n2017-11-10 09:20:45,129 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\n2017-11-10 09:20:45,170 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\n2017-11-10 09:20:45,217 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\n\n// kafka broker was restarted, some strange errors were logged\n2017-11-10 09:20:51,103 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Error while fetching metadata with correlation id 29 : {events=INVALID_REPLICATION_FACTOR}&gt;\n2017-11-10 09:20:51,205 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Error while fetching metadata with correlation id 31 : {events=INVALID_REPLICATION_FACTOR}&gt;\n2017-11-10 09:20:51,308 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Error while fetching metadata with correlation id 32 : {events=INVALID_REPLICATION_FACTOR}&gt;\n2017-11-10 09:20:51,114 WARN [org.apache.kafka.clients.producer.internals.Sender] - &lt;Received unknown topic or partition error in produce request on partition events-0. The topic/partition may not exist or the user may not have Describe access to it&gt;\n2017-11-10 09:20:51,114 ERROR [com.inq.kafka.KafkaETLService] - &lt;Kafka message resending attempt was failed. Topic events. org.apache.kafka.common.errors.UnknownTopicOrPartitionException: This server does not host this topic-partition.&gt;\n2017-11-10 09:20:52,485 WARN [org.apache.kafka.clients.NetworkClient] - &lt;Error while fetching metadata with correlation id 33 : {events=INVALID_REPLICATION_FACTOR}&gt;\n// messages were succesfully re-sent and received by consumer..\n</code></pre>\n\n<p>How can I get rid of these logs (that logs every 100ms when Kafka broker is down):</p>\n\n<pre><code>[org.apache.kafka.clients.NetworkClient] - &lt;Connection to node 0 could not be established. Broker may not be available.&gt;\n</code></pre>\n\n<p>Why do I receive the following errors after Kafka broker startup(I didn't change any server props, and didn't alter the topic). It seems to me that these errors are result of some syncrhonization process between zookeeper and kafka during broker startup, because after some time procuder succesfully resent my messages. Am I wrong?:</p>\n\n<pre><code>[org.apache.kafka.clients.NetworkClient] - &lt;Error while fetching metadata with correlation id 29 : {events=INVALID_REPLICATION_FACTOR}&gt;\nReceived unknown topic or partition error in produce request on partition events-0. The topic/partition may not exist or the user may not have Describe access to it. \n</code></pre>\n"},{"tags":["java","spring","spring-mvc","configuration"],"comments":[{"owner":{"account_id":195331,"reputation":275398,"user_id":438154,"accept_rate":98,"display_name":"Sotirios Delimanolis"},"score":0,"creation_date":1385697311,"post_id":20277883,"comment_id":30251562,"body_markdown":"Please post your full `SpringMvcExampleProfilesInitializer` and specify which `@Configuration` class contains profiles and which `@Configuration` class has the `ApplicationContextInitializer`.","body":"Please post your full <code>SpringMvcExampleProfilesInitializer</code> and specify which <code>@Configuration</code> class contains profiles and which <code>@Configuration</code> class has the <code>ApplicationContextInitializer</code>."},{"owner":{"account_id":3192259,"reputation":117599,"user_id":2696260,"display_name":"M. Deinum"},"score":0,"creation_date":1385720350,"post_id":20277883,"comment_id":30260182,"body_markdown":"Your problem is the fact that you are loading everything twice and that you are only specifing the initializer on the `DispatcherServlet`  and not on the `ContextLoaderListener`. You should split your configuration where the `ContextLoaderListener` loads the general things (services, daos, infrastructure etc.) and the `DispatcherServlet` only the web related things (controllers, viewresovlers etc).","body":"Your problem is the fact that you are loading everything twice and that you are only specifing the initializer on the <code>DispatcherServlet</code>  and not on the <code>ContextLoaderListener</code>. You should split your configuration where the <code>ContextLoaderListener</code> loads the general things (services, daos, infrastructure etc.) and the <code>DispatcherServlet</code> only the web related things (controllers, viewresovlers etc)."},{"owner":{"account_id":241158,"reputation":9333,"user_id":511804,"accept_rate":56,"display_name":"Alexandr"},"score":0,"creation_date":1385736910,"post_id":20277883,"comment_id":30268610,"body_markdown":"@M.Deinum, I tried to load web configuraion only in dispatcher servlet, and the InfrastructureContextConfiguration only via ContextLoaderListener. But the problem is that profiles are used by InfrastructureContextConfiguration. And they are activated only via SpringMvcExampleProfilesInitializer for web dispatcher servlet. And as a result, I got the same error:( The DataSource bean is not loaded.","body":"@M.Deinum, I tried to load web configuraion only in dispatcher servlet, and the InfrastructureContextConfiguration only via ContextLoaderListener. But the problem is that profiles are used by InfrastructureContextConfiguration. And they are activated only via SpringMvcExampleProfilesInitializer for web dispatcher servlet. And as a result, I got the same error:( The DataSource bean is not loaded."},{"owner":{"account_id":3192259,"reputation":117599,"user_id":2696260,"display_name":"M. Deinum"},"score":1,"creation_date":1385757571,"post_id":20277883,"comment_id":30277703,"body_markdown":"As mentioned you are only specifying the `SpringMvcExampleProfilesInitializer` not on the `ContextLoaderListener`. You specify it for the `ContextLoaderListener` through a context-param (which you can set directly on the `ServletContext`).","body":"As mentioned you are only specifying the <code>SpringMvcExampleProfilesInitializer</code> not on the <code>ContextLoaderListener</code>. You specify it for the <code>ContextLoaderListener</code> through a context-param (which you can set directly on the <code>ServletContext</code>)."},{"owner":{"account_id":241158,"reputation":9333,"user_id":511804,"accept_rate":56,"display_name":"Alexandr"},"score":0,"creation_date":1385765878,"post_id":20277883,"comment_id":30280287,"body_markdown":"@M.Deinum, it helped! Thank you very much!! But could you tell me which option is the best one. Profiles my by used by different configuration files (services, daos, infrastructure, web) and I&#39;d like to specify the only ApplicationContextInitializer. Now I invoke it in a couple of methods: When register and configure DispatcherServlet, second when register ContextLoaderListener.","body":"@M.Deinum, it helped! Thank you very much!! But could you tell me which option is the best one. Profiles my by used by different configuration files (services, daos, infrastructure, web) and I&#39;d like to specify the only ApplicationContextInitializer. Now I invoke it in a couple of methods: When register and configure DispatcherServlet, second when register ContextLoaderListener."},{"owner":{"account_id":241158,"reputation":9333,"user_id":511804,"accept_rate":56,"display_name":"Alexandr"},"score":0,"creation_date":1385765967,"post_id":20277883,"comment_id":30280311,"body_markdown":"@M.Deinum, and is there a way to pass ApplicationContextInitializer as class, not as string. Now it is configured as:     private void registerListener(ServletContext servletContext) {  servletContext.setInitParameter(&quot;contextInitializerClasses&quot;,&quot;com.savdev.springmvcexample.web.config.SpringMvcExampleProfilesInitializer&quot; ); WebApplicationContext rootContext = createContext(configurationClasses); servletContext.addListener(new ContextLoaderListener(rootContext));...","body":"@M.Deinum, and is there a way to pass ApplicationContextInitializer as class, not as string. Now it is configured as:     private void registerListener(ServletContext servletContext) {  servletContext.setInitParameter(&quot;contextInitializerClasses&quot;,&zwnj;&#8203;&quot;com.savdev.springmv&zwnj;&#8203;cexample.web.config.&zwnj;&#8203;SpringMvcExampleProf&zwnj;&#8203;ilesInitializer&quot; ); WebApplicationContext rootContext = createContext(configurationClasses); servletContext.addListener(new ContextLoaderListener(rootContext));..."},{"owner":{"account_id":3192259,"reputation":117599,"user_id":2696260,"display_name":"M. Deinum"},"score":0,"creation_date":1385885980,"post_id":20277883,"comment_id":30307039,"body_markdown":"No, currently there isn&#39;t at least not for the `ContextLoaderListener`. If you want this chained I suggest you register [an enhancement request](http://jira.springsource.org)","body":"No, currently there isn&#39;t at least not for the <code>ContextLoaderListener</code>. If you want this chained I suggest you register <a href=\"http://jira.springsource.org\" rel=\"nofollow noreferrer\">an enhancement request</a>"}],"answers":[{"tags":[],"owner":{"account_id":241158,"reputation":9333,"user_id":511804,"accept_rate":56,"display_name":"Alexandr"},"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1385767509,"creation_date":1385767509,"answer_id":20294670,"question_id":20277883,"body_markdown":"As M.Deinum recommended I set the profiles initialier to the `ServletContext`, instead of setting it to `DispatcherServlet`. Here is the updated configuration:\r\n\r\n    @Override\r\n     public void onStartup(ServletContext servletContext) throws ServletException {\r\n        configureServletContext( servletContext );\r\n        registerListener(servletContext);\r\n        registerDispatcherServlet(servletContext);\r\n        ...\r\n    }\r\n    \r\n    private void configureServletContext(ServletContext servletContext) {\r\n        String initializerClasses = servletContext.getInitParameter(ContextLoader.CONTEXT_INITIALIZER_CLASSES_PARAM);\r\n        String profilesInitClassName = SpringMvcExampleProfilesInitializer.class.getName();\r\n        if (StringUtils.hasText(initializerClasses)) {\r\n            initializerClasses += &quot; &quot; + profilesInitClassName;\r\n        }\r\n        else {\r\n            initializerClasses = profilesInitClassName;\r\n        }\r\n        servletContext.setInitParameter(ContextLoader.CONTEXT_INITIALIZER_CLASSES_PARAM, initializerClasses);\r\n    }","title":"Using Spring Mvc WebApplicationInitializer, ApplicationContextInitializer and ContextLoaderListener","body":"<p>As M.Deinum recommended I set the profiles initialier to the <code>ServletContext</code>, instead of setting it to <code>DispatcherServlet</code>. Here is the updated configuration:</p>\n\n<pre><code>@Override\n public void onStartup(ServletContext servletContext) throws ServletException {\n    configureServletContext( servletContext );\n    registerListener(servletContext);\n    registerDispatcherServlet(servletContext);\n    ...\n}\n\nprivate void configureServletContext(ServletContext servletContext) {\n    String initializerClasses = servletContext.getInitParameter(ContextLoader.CONTEXT_INITIALIZER_CLASSES_PARAM);\n    String profilesInitClassName = SpringMvcExampleProfilesInitializer.class.getName();\n    if (StringUtils.hasText(initializerClasses)) {\n        initializerClasses += \" \" + profilesInitClassName;\n    }\n    else {\n        initializerClasses = profilesInitClassName;\n    }\n    servletContext.setInitParameter(ContextLoader.CONTEXT_INITIALIZER_CLASSES_PARAM, initializerClasses);\n}\n</code></pre>\n"}],"owner":{"account_id":241158,"reputation":9333,"user_id":511804,"accept_rate":56,"display_name":"Alexandr"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":8892,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1695380860,"creation_date":1385695682,"question_id":20277883,"body_markdown":"I use java-based Spring Mvc configuration. \r\n\r\nI register the Spring dispatcher servlet in the WebApplicationInitializer implementation.\r\nLoad Spring ApplicationContext configuration files. Logic of Spring profiles management is implemented in the ApplicationContextInitializer implementation. And it worked fine. \r\n\r\nHere are full examples of the original files:\r\n**WebApplicationInitializer**\r\n\r\n    public class SpringMvcExampleWebApplicationInitializer implements WebApplicationInitializer {\r\n    \r\n        private static final String DISPATCHER_SERVLET_NAME = &quot;dispatcher&quot;;\r\n    \r\n        @Override\r\n         public void onStartup(ServletContext servletContext) throws ServletException {\r\n            registerDispatcherServlet(servletContext);\r\n            registerHiddenHttpMethodFilter(servletContext);\r\n        }\r\n    \r\n        private void registerDispatcherServlet(final ServletContext servletContext) {\r\n            WebApplicationContext dispatcherContext = createContext(WebMvcContextConfiguration.class, InfrastructureContextConfiguration.class);\r\n            DispatcherServlet dispatcherServlet = new DispatcherServlet(dispatcherContext);\r\n            dispatcherServlet.setContextInitializers(new SpringMvcExampleProfilesInitializer());\r\n            ServletRegistration.Dynamic dispatcher = servletContext.addServlet(DISPATCHER_SERVLET_NAME, dispatcherServlet);\r\n            dispatcher.setLoadOnStartup(1);\r\n            dispatcher.addMapping(&quot;/&quot;);\r\n        }\r\n    \r\n        private WebApplicationContext createContext(final Class&lt;?&gt;... annotatedClasses) {\r\n            AnnotationConfigWebApplicationContext context = new AnnotationConfigWebApplicationContext();\r\n            context.register(annotatedClasses);\r\n            return context;\r\n        }\r\n    \r\n        private void registerHiddenHttpMethodFilter(ServletContext servletContext) {\r\n            FilterRegistration.Dynamic registration = servletContext.addFilter(&quot;hiddenHttpMethodFilter&quot;, HiddenHttpMethodFilter.class);\r\n            registration.addMappingForServletNames(EnumSet.of(DispatcherType.REQUEST, DispatcherType.FORWARD),\r\n                    false, DISPATCHER_SERVLET_NAME);\r\n        }\r\n    }\r\n\r\n**SpringMvcExampleProfilesInitializer**\r\n\r\n    public class SpringMvcExampleProfilesInitializer implements ApplicationContextInitializer&lt;ConfigurableApplicationContext&gt; {\r\n    \r\n        @Override\r\n        public void initialize(ConfigurableApplicationContext ctx) {\r\n            ConfigurableEnvironment environment = ctx.getEnvironment();\r\n            List&lt;String&gt; profiles = new ArrayList&lt;String&gt;(getProfiles());\r\n            if( profiles == null || profiles.isEmpty() )\r\n            {\r\n                throw new IllegalArgumentException(&quot;Profiles have not been configured&quot;);\r\n            }\r\n            environment.setActiveProfiles(profiles.toArray( new String[0]));\r\n        }\r\n    \r\n        //TODO add logic\r\n        private Collection&lt;String&gt; getProfiles() {\r\n            return Lists.newArrayList(&quot;file_based&quot;, &quot;test_data&quot;);\r\n        }\r\n    }\r\n\r\n**InfrastructureContextConfiguration**\r\n\r\n    @Configuration\r\n    @ComponentScan(basePackages = {&quot;com.savdev.springmvcexample.repository&quot;, &quot;com.savdev.springmvcexample.config&quot;})\r\n    @EnableTransactionManagement\r\n    @EnableJpaRepositories(basePackages = {&quot;com.savdev.springmvcexample.repository&quot;})\r\n    public class InfrastructureContextConfiguration {\r\n    \r\n        @Configuration\r\n        @Profile(value = &quot;file_based&quot;)\r\n        @PropertySource(&quot;classpath:/db/config/file_based.properties&quot;)\r\n        public static class FileBasedConfiguration {\r\n    \r\n            @Inject\r\n            private Environment environment;\r\n    \r\n            @Bean\r\n            public DataSource dataSource() {\r\n                BasicDataSource dataSource = new org.apache.commons.dbcp.BasicDataSource();\r\n                dataSource.setDriverClassName(environment.getProperty(&quot;jdbc.driver&quot;));\r\n                dataSource.setUrl(environment.getProperty(&quot;jdbc.url&quot;));\r\n                dataSource.setUsername(environment.getProperty(&quot;jdbc.username&quot;));\r\n                dataSource.setPassword(environment.getProperty(&quot;jdbc.password&quot;));\r\n                return dataSource;\r\n            }\r\n        }\r\n    \r\n        @Bean\r\n        public SpringLiquibase liquibase(DataSource dataSource) {\r\n            SpringLiquibase liquibase = new SpringLiquibase();\r\n            liquibase.setDataSource(dataSource);\r\n            liquibase.setChangeLog(&quot;classpath:/db/liquibase/changelog/db.changelog-master.xml&quot;);\r\n            liquibase.setDropFirst(true);\r\n            return liquibase;\r\n        }\r\n\r\nThen I added Spring Security context configuration to the application. To use it the `DelegatingFilterProxy` have to be loaded. I\\ve updated the configuration:\r\n\r\nAdded new method and invoked it in the `onStartup`:\r\n\r\n    private void registerSpringSecurityFilterChain(ServletContext servletContext) {\r\n        FilterRegistration.Dynamic springSecurityFilterChain = servletContext.addFilter(\r\n                BeanIds.SPRING_SECURITY_FILTER_CHAIN,\r\n                new DelegatingFilterProxy());\r\n        springSecurityFilterChain.addMappingForUrlPatterns(null, false, &quot;/*&quot;);\r\n    }\r\n\r\n    @Override\r\n     public void onStartup(ServletContext servletContext) throws ServletException {\r\n        ...\r\n        registerDispatcherServlet(servletContext);\r\n        ...\r\n        registerSpringSecurityFilterChain(servletContext);\r\n    }\r\n\r\nNow when I try to request any url I&#39;m getting the error:\r\n\r\n    message No WebApplicationContext found: no ContextLoaderListener registered?\r\n    \r\n    description The server encountered an internal error that prevented it from fulfilling this request.\r\n    \r\n    exception\r\n    \r\n    java.lang.IllegalStateException: No WebApplicationContext found: no ContextLoaderListener registered?\r\n    \torg.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:251)\r\n\r\nOk, I added the following:\r\n\r\n            private static final Class&lt;?&gt;[] configurationClasses = new Class&lt;?&gt;[]{\r\n                    WebMvcContextConfiguration.class, InfrastructureContextConfiguration.class};\r\n        ...\r\n    \r\n    private void registerListener(ServletContext servletContext) {\r\n        WebApplicationContext rootContext = createContext(configurationClasses);\r\n        servletContext.addListener(new ContextLoaderListener(rootContext));\r\n    }\r\n\r\nAnd invoked it from:\r\n\r\n    @Override\r\n     public void onStartup(ServletContext servletContext) throws ServletException {\r\n        registerListener(servletContext);\r\n        registerDispatcherServlet(servletContext);\r\n        registerHiddenHttpMethodFilter(servletContext);\r\n        registerSpringSecurityFilterChain(servletContext);\r\n    }\r\n\r\nThe error has gone.\r\n\r\nBut all beans that depend on Spring profile are not loaded now. Adding the `ContextLoaderListener` has broken the  `SpringMvcExampleProfilesInitializer` logic.\r\n\r\n    No qualifying bean of type [javax.sql.DataSource] found for dependency\r\n\r\nWhat can I do to resolve it? Any ideas, please?\r\n\r\nHere is the full updated web initializer class:\r\n\r\n    public class SpringMvcExampleWebApplicationInitializer implements WebApplicationInitializer {\r\n    \r\n        private static final String DISPATCHER_SERVLET_NAME = &quot;dispatcher&quot;;\r\n    \r\n        private static final Class&lt;?&gt;[] configurationClasses = new Class&lt;?&gt;[]{\r\n                WebMvcContextConfiguration.class, InfrastructureContextConfiguration.class};\r\n    \r\n    \r\n        @Override\r\n         public void onStartup(ServletContext servletContext) throws ServletException {\r\n            registerListener(servletContext);\r\n            registerDispatcherServlet(servletContext);\r\n            registerHiddenHttpMethodFilter(servletContext);\r\n            registerSpringSecurityFilterChain(servletContext);\r\n        }\r\n    \r\n        private void registerSpringSecurityFilterChain(ServletContext servletContext) {\r\n            FilterRegistration.Dynamic springSecurityFilterChain = servletContext.addFilter(\r\n                    BeanIds.SPRING_SECURITY_FILTER_CHAIN,\r\n                    new DelegatingFilterProxy());\r\n            springSecurityFilterChain.addMappingForUrlPatterns(null, false, &quot;/*&quot;);\r\n        }\r\n    \r\n        private void registerDispatcherServlet(final ServletContext servletContext) {\r\n            WebApplicationContext dispatcherContext = createContext(WebMvcContextConfiguration.class, InfrastructureContextConfiguration.class);\r\n            DispatcherServlet dispatcherServlet = new DispatcherServlet(dispatcherContext);\r\n            dispatcherServlet.setContextInitializers(new SpringMvcExampleProfilesInitializer());\r\n            ServletRegistration.Dynamic dispatcher = servletContext.addServlet(DISPATCHER_SERVLET_NAME, dispatcherServlet);\r\n            dispatcher.setLoadOnStartup(1);\r\n            dispatcher.addMapping(&quot;/&quot;);\r\n        }\r\n    \r\n        private WebApplicationContext createContext(final Class&lt;?&gt;... annotatedClasses) {\r\n            AnnotationConfigWebApplicationContext context = new AnnotationConfigWebApplicationContext();\r\n            context.register(annotatedClasses);\r\n    //        context.refresh();\r\n            return context;\r\n        }\r\n    \r\n        private void registerListener(ServletContext servletContext) {\r\n            WebApplicationContext rootContext = createContext(configurationClasses);\r\n            servletContext.addListener(new ContextLoaderListener(rootContext));\r\n    //        servletContext.addListener(new RequestContextListener());\r\n        }\r\n    \r\n        private void registerHiddenHttpMethodFilter(ServletContext servletContext) {\r\n            FilterRegistration.Dynamic registration = servletContext.addFilter(&quot;hiddenHttpMethodFilter&quot;, HiddenHttpMethodFilter.class);\r\n            registration.addMappingForServletNames(EnumSet.of(DispatcherType.REQUEST, DispatcherType.FORWARD),\r\n                    false, DISPATCHER_SERVLET_NAME);\r\n        }\r\n    }\r\n\r\n","title":"Using Spring Mvc WebApplicationInitializer, ApplicationContextInitializer and ContextLoaderListener","body":"<p>I use java-based Spring Mvc configuration. </p>\n\n<p>I register the Spring dispatcher servlet in the WebApplicationInitializer implementation.\nLoad Spring ApplicationContext configuration files. Logic of Spring profiles management is implemented in the ApplicationContextInitializer implementation. And it worked fine. </p>\n\n<p>Here are full examples of the original files:\n<strong>WebApplicationInitializer</strong></p>\n\n<pre><code>public class SpringMvcExampleWebApplicationInitializer implements WebApplicationInitializer {\n\n    private static final String DISPATCHER_SERVLET_NAME = \"dispatcher\";\n\n    @Override\n     public void onStartup(ServletContext servletContext) throws ServletException {\n        registerDispatcherServlet(servletContext);\n        registerHiddenHttpMethodFilter(servletContext);\n    }\n\n    private void registerDispatcherServlet(final ServletContext servletContext) {\n        WebApplicationContext dispatcherContext = createContext(WebMvcContextConfiguration.class, InfrastructureContextConfiguration.class);\n        DispatcherServlet dispatcherServlet = new DispatcherServlet(dispatcherContext);\n        dispatcherServlet.setContextInitializers(new SpringMvcExampleProfilesInitializer());\n        ServletRegistration.Dynamic dispatcher = servletContext.addServlet(DISPATCHER_SERVLET_NAME, dispatcherServlet);\n        dispatcher.setLoadOnStartup(1);\n        dispatcher.addMapping(\"/\");\n    }\n\n    private WebApplicationContext createContext(final Class&lt;?&gt;... annotatedClasses) {\n        AnnotationConfigWebApplicationContext context = new AnnotationConfigWebApplicationContext();\n        context.register(annotatedClasses);\n        return context;\n    }\n\n    private void registerHiddenHttpMethodFilter(ServletContext servletContext) {\n        FilterRegistration.Dynamic registration = servletContext.addFilter(\"hiddenHttpMethodFilter\", HiddenHttpMethodFilter.class);\n        registration.addMappingForServletNames(EnumSet.of(DispatcherType.REQUEST, DispatcherType.FORWARD),\n                false, DISPATCHER_SERVLET_NAME);\n    }\n}\n</code></pre>\n\n<p><strong>SpringMvcExampleProfilesInitializer</strong></p>\n\n<pre><code>public class SpringMvcExampleProfilesInitializer implements ApplicationContextInitializer&lt;ConfigurableApplicationContext&gt; {\n\n    @Override\n    public void initialize(ConfigurableApplicationContext ctx) {\n        ConfigurableEnvironment environment = ctx.getEnvironment();\n        List&lt;String&gt; profiles = new ArrayList&lt;String&gt;(getProfiles());\n        if( profiles == null || profiles.isEmpty() )\n        {\n            throw new IllegalArgumentException(\"Profiles have not been configured\");\n        }\n        environment.setActiveProfiles(profiles.toArray( new String[0]));\n    }\n\n    //TODO add logic\n    private Collection&lt;String&gt; getProfiles() {\n        return Lists.newArrayList(\"file_based\", \"test_data\");\n    }\n}\n</code></pre>\n\n<p><strong>InfrastructureContextConfiguration</strong></p>\n\n<pre><code>@Configuration\n@ComponentScan(basePackages = {\"com.savdev.springmvcexample.repository\", \"com.savdev.springmvcexample.config\"})\n@EnableTransactionManagement\n@EnableJpaRepositories(basePackages = {\"com.savdev.springmvcexample.repository\"})\npublic class InfrastructureContextConfiguration {\n\n    @Configuration\n    @Profile(value = \"file_based\")\n    @PropertySource(\"classpath:/db/config/file_based.properties\")\n    public static class FileBasedConfiguration {\n\n        @Inject\n        private Environment environment;\n\n        @Bean\n        public DataSource dataSource() {\n            BasicDataSource dataSource = new org.apache.commons.dbcp.BasicDataSource();\n            dataSource.setDriverClassName(environment.getProperty(\"jdbc.driver\"));\n            dataSource.setUrl(environment.getProperty(\"jdbc.url\"));\n            dataSource.setUsername(environment.getProperty(\"jdbc.username\"));\n            dataSource.setPassword(environment.getProperty(\"jdbc.password\"));\n            return dataSource;\n        }\n    }\n\n    @Bean\n    public SpringLiquibase liquibase(DataSource dataSource) {\n        SpringLiquibase liquibase = new SpringLiquibase();\n        liquibase.setDataSource(dataSource);\n        liquibase.setChangeLog(\"classpath:/db/liquibase/changelog/db.changelog-master.xml\");\n        liquibase.setDropFirst(true);\n        return liquibase;\n    }\n</code></pre>\n\n<p>Then I added Spring Security context configuration to the application. To use it the <code>DelegatingFilterProxy</code> have to be loaded. I\\ve updated the configuration:</p>\n\n<p>Added new method and invoked it in the <code>onStartup</code>:</p>\n\n<pre><code>private void registerSpringSecurityFilterChain(ServletContext servletContext) {\n    FilterRegistration.Dynamic springSecurityFilterChain = servletContext.addFilter(\n            BeanIds.SPRING_SECURITY_FILTER_CHAIN,\n            new DelegatingFilterProxy());\n    springSecurityFilterChain.addMappingForUrlPatterns(null, false, \"/*\");\n}\n\n@Override\n public void onStartup(ServletContext servletContext) throws ServletException {\n    ...\n    registerDispatcherServlet(servletContext);\n    ...\n    registerSpringSecurityFilterChain(servletContext);\n}\n</code></pre>\n\n<p>Now when I try to request any url I'm getting the error:</p>\n\n<pre><code>message No WebApplicationContext found: no ContextLoaderListener registered?\n\ndescription The server encountered an internal error that prevented it from fulfilling this request.\n\nexception\n\njava.lang.IllegalStateException: No WebApplicationContext found: no ContextLoaderListener registered?\n    org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:251)\n</code></pre>\n\n<p>Ok, I added the following:</p>\n\n<pre><code>        private static final Class&lt;?&gt;[] configurationClasses = new Class&lt;?&gt;[]{\n                WebMvcContextConfiguration.class, InfrastructureContextConfiguration.class};\n    ...\n\nprivate void registerListener(ServletContext servletContext) {\n    WebApplicationContext rootContext = createContext(configurationClasses);\n    servletContext.addListener(new ContextLoaderListener(rootContext));\n}\n</code></pre>\n\n<p>And invoked it from:</p>\n\n<pre><code>@Override\n public void onStartup(ServletContext servletContext) throws ServletException {\n    registerListener(servletContext);\n    registerDispatcherServlet(servletContext);\n    registerHiddenHttpMethodFilter(servletContext);\n    registerSpringSecurityFilterChain(servletContext);\n}\n</code></pre>\n\n<p>The error has gone.</p>\n\n<p>But all beans that depend on Spring profile are not loaded now. Adding the <code>ContextLoaderListener</code> has broken the  <code>SpringMvcExampleProfilesInitializer</code> logic.</p>\n\n<pre><code>No qualifying bean of type [javax.sql.DataSource] found for dependency\n</code></pre>\n\n<p>What can I do to resolve it? Any ideas, please?</p>\n\n<p>Here is the full updated web initializer class:</p>\n\n<pre><code>public class SpringMvcExampleWebApplicationInitializer implements WebApplicationInitializer {\n\n    private static final String DISPATCHER_SERVLET_NAME = \"dispatcher\";\n\n    private static final Class&lt;?&gt;[] configurationClasses = new Class&lt;?&gt;[]{\n            WebMvcContextConfiguration.class, InfrastructureContextConfiguration.class};\n\n\n    @Override\n     public void onStartup(ServletContext servletContext) throws ServletException {\n        registerListener(servletContext);\n        registerDispatcherServlet(servletContext);\n        registerHiddenHttpMethodFilter(servletContext);\n        registerSpringSecurityFilterChain(servletContext);\n    }\n\n    private void registerSpringSecurityFilterChain(ServletContext servletContext) {\n        FilterRegistration.Dynamic springSecurityFilterChain = servletContext.addFilter(\n                BeanIds.SPRING_SECURITY_FILTER_CHAIN,\n                new DelegatingFilterProxy());\n        springSecurityFilterChain.addMappingForUrlPatterns(null, false, \"/*\");\n    }\n\n    private void registerDispatcherServlet(final ServletContext servletContext) {\n        WebApplicationContext dispatcherContext = createContext(WebMvcContextConfiguration.class, InfrastructureContextConfiguration.class);\n        DispatcherServlet dispatcherServlet = new DispatcherServlet(dispatcherContext);\n        dispatcherServlet.setContextInitializers(new SpringMvcExampleProfilesInitializer());\n        ServletRegistration.Dynamic dispatcher = servletContext.addServlet(DISPATCHER_SERVLET_NAME, dispatcherServlet);\n        dispatcher.setLoadOnStartup(1);\n        dispatcher.addMapping(\"/\");\n    }\n\n    private WebApplicationContext createContext(final Class&lt;?&gt;... annotatedClasses) {\n        AnnotationConfigWebApplicationContext context = new AnnotationConfigWebApplicationContext();\n        context.register(annotatedClasses);\n//        context.refresh();\n        return context;\n    }\n\n    private void registerListener(ServletContext servletContext) {\n        WebApplicationContext rootContext = createContext(configurationClasses);\n        servletContext.addListener(new ContextLoaderListener(rootContext));\n//        servletContext.addListener(new RequestContextListener());\n    }\n\n    private void registerHiddenHttpMethodFilter(ServletContext servletContext) {\n        FilterRegistration.Dynamic registration = servletContext.addFilter(\"hiddenHttpMethodFilter\", HiddenHttpMethodFilter.class);\n        registration.addMappingForServletNames(EnumSet.of(DispatcherType.REQUEST, DispatcherType.FORWARD),\n                false, DISPATCHER_SERVLET_NAME);\n    }\n}\n</code></pre>\n"},{"tags":["java","spring-boot","maven","java-17","maven-wrapper"],"comments":[{"owner":{"account_id":17835,"reputation":303895,"user_id":40342,"accept_rate":62,"display_name":"Joachim Sauer"},"score":1,"creation_date":1633077278,"post_id":69402824,"comment_id":122669064,"body_markdown":"It&#39;s possible that it came from `.mvn/jvm.config`.","body":"It&#39;s possible that it came from <code>.mvn&#47;jvm.config</code>."},{"owner":{"account_id":21994,"reputation":73798,"user_id":53897,"accept_rate":56,"display_name":"Thorbj&#248;rn Ravn Andersen"},"score":0,"creation_date":1633077328,"post_id":69402824,"comment_id":122669083,"body_markdown":"It is set _somewhere_. Consider searching all your files","body":"It is set <i>somewhere</i>. Consider searching all your files"},{"owner":{"account_id":22266993,"reputation":897,"user_id":16497617,"display_name":"Maneesha Indrachapa"},"score":1,"creation_date":1633077361,"post_id":69402824,"comment_id":122669099,"body_markdown":"Isn&#39;t this answers your question, https://stackoverflow.com/questions/47112412/unrecognized-vm-option-maxpermsize-512m-when-running-zeppelin . After Java9 it seems `MaxPermSize=512m` is removed.","body":"Isn&#39;t this answers your question, <a href=\"https://stackoverflow.com/questions/47112412/unrecognized-vm-option-maxpermsize-512m-when-running-zeppelin\" title=\"unrecognized vm option maxpermsize 512m when running zeppelin\">stackoverflow.com/questions/47112412/&hellip;</a> . After Java9 it seems <code>MaxPermSize=512m</code> is removed."},{"owner":{"account_id":4647011,"reputation":41835,"user_id":3764965,"accept_rate":94,"display_name":"Nikolas Charalambidis"},"score":0,"creation_date":1633077527,"post_id":69402824,"comment_id":122669170,"body_markdown":"@JoachimSauer There is no `.mvn/jvm.config` file. Only `wrapper` folder.","body":"@JoachimSauer There is no <code>.mvn&#47;jvm.config</code> file. Only <code>wrapper</code> folder."},{"owner":{"account_id":4647011,"reputation":41835,"user_id":3764965,"accept_rate":94,"display_name":"Nikolas Charalambidis"},"score":0,"creation_date":1633077599,"post_id":69402824,"comment_id":122669198,"body_markdown":"@Thorbj&#248;rnRavnAndersen: The only thing I switch is the home folder for Java 16 and 17 respectively. There is nothing set in my project as it is nearly empty and using downloaded Maven Wrapper.","body":"@Thorbj&#248;rnRavnAndersen: The only thing I switch is the home folder for Java 16 and 17 respectively. There is nothing set in my project as it is nearly empty and using downloaded Maven Wrapper."},{"owner":{"account_id":21994,"reputation":73798,"user_id":53897,"accept_rate":56,"display_name":"Thorbj&#248;rn Ravn Andersen"},"score":1,"creation_date":1633077856,"post_id":69402824,"comment_id":122669288,"body_markdown":"Yes.  The newer JVM does not like a command option which comes from somewhere. You may want to single step your mvnw script.","body":"Yes.  The newer JVM does not like a command option which comes from somewhere. You may want to single step your mvnw script."},{"owner":{"account_id":3211603,"reputation":289297,"user_id":2711488,"display_name":"Holger"},"score":1,"creation_date":1633100036,"post_id":69402824,"comment_id":122678268,"body_markdown":"@ManeeshaIndrachapa even Java&#160;8 does not support this option.","body":"@ManeeshaIndrachapa even Java 8 does not support this option."}],"answers":[{"tags":[],"owner":{"account_id":4647011,"reputation":41835,"user_id":3764965,"accept_rate":94,"display_name":"Nikolas Charalambidis"},"down_vote_count":0,"up_vote_count":39,"is_accepted":true,"score":39,"last_activity_date":1654827942,"creation_date":1633078955,"answer_id":69403266,"question_id":69402824,"body_markdown":"Indeed `-XX:MaxPermSize=size` is labelled as follows according to Java&#174; Development Kit Version 16/17 Tool Specifications (see the links):\r\n\r\n- For Java 16 it is [**obsolete**](https://docs.oracle.com/en/java/javase/16/docs/specs/man/java.html#obsolete-java-options).\r\n- For Java 17 it is [**removed**]( https://docs.oracle.com/en/java/javase/17/docs/specs/man/java.html#removed-java-options).\r\n\r\nThe Maven Wrapper in the `mvnw.cmd` script, however, aside from the required `JAVA_HOME`, uses also a bunch of *optional* environment variables such as `M2_HOME` and these starting with `MAVEN_` prefix.\r\n\r\nThe important one is `MAVEN_OPTS` where such a removed Java option can appear causing the inability to start the JVM on the newer version. In my case, I had something like:\r\n\r\n```shell\r\nMAVEN_OPTS=&quot;-Xmx4g -XX:MaxPermSize=512m -Dfile.encoding=UTF-8&quot;\r\n```\r\n\r\nThe solution is either to remove the option from the environment variables or add this line to the Maven Wrapper script to override the `MAVEN_OPTS` value, In the minimal form:\r\n \r\n```shell\r\nMAVEN_OPTS=\r\n```","title":"Java 17 with Maven Wrapper results in Unrecognized VM option &#39;MaxPermSize=512m&#39;","body":"<p>Indeed <code>-XX:MaxPermSize=size</code> is labelled as follows according to Java Development Kit Version 16/17 Tool Specifications (see the links):</p>\n<ul>\n<li>For Java 16 it is <a href=\"https://docs.oracle.com/en/java/javase/16/docs/specs/man/java.html#obsolete-java-options\" rel=\"noreferrer\"><strong>obsolete</strong></a>.</li>\n<li>For Java 17 it is <a href=\"https://docs.oracle.com/en/java/javase/17/docs/specs/man/java.html#removed-java-options\" rel=\"noreferrer\"><strong>removed</strong></a>.</li>\n</ul>\n<p>The Maven Wrapper in the <code>mvnw.cmd</code> script, however, aside from the required <code>JAVA_HOME</code>, uses also a bunch of <em>optional</em> environment variables such as <code>M2_HOME</code> and these starting with <code>MAVEN_</code> prefix.</p>\n<p>The important one is <code>MAVEN_OPTS</code> where such a removed Java option can appear causing the inability to start the JVM on the newer version. In my case, I had something like:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>MAVEN_OPTS=&quot;-Xmx4g -XX:MaxPermSize=512m -Dfile.encoding=UTF-8&quot;\n</code></pre>\n<p>The solution is either to remove the option from the environment variables or add this line to the Maven Wrapper script to override the <code>MAVEN_OPTS</code> value, In the minimal form:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>MAVEN_OPTS=\n</code></pre>\n"},{"tags":[],"owner":{"account_id":24367878,"reputation":31,"user_id":18301333,"display_name":"Prateek Sinha"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1695380779,"creation_date":1695380779,"answer_id":77157070,"question_id":69402824,"body_markdown":"Use MaxMetaspaceSize in place of MaxPermSize and MetaspaceSize in place of PermSize in jdk17. \r\n\r\nRefer to : https://docs.oracle.com/en/java/javase/17/docs/specs/man/java.html\r\n\r\n","title":"Java 17 with Maven Wrapper results in Unrecognized VM option &#39;MaxPermSize=512m&#39;","body":"<p>Use MaxMetaspaceSize in place of MaxPermSize and MetaspaceSize in place of PermSize in jdk17.</p>\n<p>Refer to : <a href=\"https://docs.oracle.com/en/java/javase/17/docs/specs/man/java.html\" rel=\"nofollow noreferrer\">https://docs.oracle.com/en/java/javase/17/docs/specs/man/java.html</a></p>\n"}],"owner":{"account_id":4647011,"reputation":41835,"user_id":3764965,"accept_rate":94,"display_name":"Nikolas Charalambidis"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":29573,"favorite_count":0,"down_vote_count":0,"up_vote_count":18,"accepted_answer_id":69403266,"answer_count":2,"score":18,"last_activity_date":1695380779,"creation_date":1633076985,"question_id":69402824,"body_markdown":"I use [OpenJDK 17][1] with Maven Wrapper 3.8.2 from [Spring Initializr][2] (Maven project, JAR packaging, Java 17, Spring Boot 2.6.0). No additional dependencies. \r\n\r\n&gt; ```\r\n&gt; user@DESKTOP-U2OU5HG MINGW64 /c/Projects/my-project (master)\r\n&gt; $ java -version\r\n&gt; openjdk version &quot;17&quot; 2021-09-14\r\n&gt; OpenJDK Runtime Environment (build 17+35-2724)\r\n&gt; OpenJDK 64-Bit Server VM (build 17+35-2724, mixed mode, sharing)\r\n&gt; ```\r\n\r\nUpon running any of `./mvnw.cmd -version` or `./mvnw.cmd clean install`, I always get the following message:\r\n\r\n&gt; ```\r\n&gt; Unrecognized VM option &#39;MaxPermSize=512m&#39;\r\n&gt; Error: Could not create the Java Virtual Machine.\r\n&gt; Error: A fatal exception has occurred. Program will exit.\r\n&gt; ``` \r\n\r\nSwitching to [OpenJDK 16.0.2][3] resolves the issue, however, I need to work with Java 17. \r\n\r\nHow to get it run? There is nowhere `MaxPermSize=512m` set.\r\n\r\n\r\n  [1]: https://jdk.java.net/17/\r\n  [2]: https://start.spring.io/\r\n  [3]: https://jdk.java.net/16/","title":"Java 17 with Maven Wrapper results in Unrecognized VM option &#39;MaxPermSize=512m&#39;","body":"<p>I use <a href=\"https://jdk.java.net/17/\" rel=\"noreferrer\">OpenJDK 17</a> with Maven Wrapper 3.8.2 from <a href=\"https://start.spring.io/\" rel=\"noreferrer\">Spring Initializr</a> (Maven project, JAR packaging, Java 17, Spring Boot 2.6.0). No additional dependencies.</p>\n<blockquote>\n<pre><code>user@DESKTOP-U2OU5HG MINGW64 /c/Projects/my-project (master)\n$ java -version\nopenjdk version &quot;17&quot; 2021-09-14\nOpenJDK Runtime Environment (build 17+35-2724)\nOpenJDK 64-Bit Server VM (build 17+35-2724, mixed mode, sharing)\n</code></pre>\n</blockquote>\n<p>Upon running any of <code>./mvnw.cmd -version</code> or <code>./mvnw.cmd clean install</code>, I always get the following message:</p>\n<blockquote>\n<pre><code>Unrecognized VM option 'MaxPermSize=512m'\nError: Could not create the Java Virtual Machine.\nError: A fatal exception has occurred. Program will exit.\n</code></pre>\n</blockquote>\n<p>Switching to <a href=\"https://jdk.java.net/16/\" rel=\"noreferrer\">OpenJDK 16.0.2</a> resolves the issue, however, I need to work with Java 17.</p>\n<p>How to get it run? There is nowhere <code>MaxPermSize=512m</code> set.</p>\n"},{"tags":["java","intellij-idea"],"comments":[{"owner":{"account_id":3538058,"reputation":5428,"user_id":2960034,"display_name":"y.bedrov"},"score":3,"creation_date":1557321384,"post_id":56039603,"comment_id":98725299,"body_markdown":"Please try to run &quot;File | Invalidate Caches&quot; and rebuild project.","body":"Please try to run &quot;File | Invalidate Caches&quot; and rebuild project."},{"owner":{"account_id":13508325,"reputation":113,"user_id":9745548,"display_name":"Matteo Bianchi"},"score":0,"creation_date":1557330217,"post_id":56039603,"comment_id":98730870,"body_markdown":"Thanks, it worked!","body":"Thanks, it worked!"},{"owner":{"account_id":6751849,"reputation":91,"user_id":5201650,"display_name":"Frederic Mamath"},"score":0,"creation_date":1621242242,"post_id":56039603,"comment_id":119426503,"body_markdown":"Thanks @y.bedrov, it also worked for me !","body":"Thanks @y.bedrov, it also worked for me !"}],"answers":[{"tags":[],"owner":{"account_id":3538058,"reputation":5428,"user_id":2960034,"display_name":"y.bedrov"},"down_vote_count":0,"up_vote_count":32,"is_accepted":true,"score":32,"last_activity_date":1661269343,"creation_date":1557387100,"answer_id":56054317,"question_id":56039603,"body_markdown":"Running &quot;File | Invalidate Caches&quot; helped.\r\n\r\nSee [manual][1].\r\n\r\n\r\n  [1]: https://www.jetbrains.com/help/idea/invalidate-caches.html","title":"Intellij doesn&#39;t recognize class","body":"<p>Running &quot;File | Invalidate Caches&quot; helped.</p>\n<p>See <a href=\"https://www.jetbrains.com/help/idea/invalidate-caches.html\" rel=\"noreferrer\">manual</a>.</p>\n"},{"tags":[],"owner":{"account_id":4564732,"reputation":426,"user_id":3706042,"display_name":"Dedkov Vadim"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1626423482,"creation_date":1626423482,"answer_id":68405768,"question_id":56039603,"body_markdown":"For me changes in `build.sbt` file worked. For example, you can remove some dependency from `build.sbt`, press new appeared button `Load sbt Changes` in top-right corner in `build.sbt`, then revert removed dependency and press again button `Load sbt changes`.\r\n\r\n`Load sbt Changes` button:\r\n[![Load sbt Changes][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/hTuGS.png","title":"Intellij doesn&#39;t recognize class","body":"<p>For me changes in <code>build.sbt</code> file worked. For example, you can remove some dependency from <code>build.sbt</code>, press new appeared button <code>Load sbt Changes</code> in top-right corner in <code>build.sbt</code>, then revert removed dependency and press again button <code>Load sbt changes</code>.</p>\n<p><code>Load sbt Changes</code> button:\n<a href=\"https://i.stack.imgur.com/hTuGS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hTuGS.png\" alt=\"Load sbt Changes\" /></a></p>\n"},{"tags":[],"owner":{"account_id":15503489,"reputation":25,"user_id":11184255,"display_name":"cyc8"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695380722,"creation_date":1695380159,"answer_id":77157006,"question_id":56039603,"body_markdown":"Came across the same problem that classes are not recognized. Running `File` &gt; `Invalidate Caches` or `File` &gt; `Repair IDE` didn&#39;t solve the problem for me.\r\n\r\nThe solution was deleting the `.idea` folder within the project and reopen intellij which scans all classes again [like it is mentioned here][1]. Hope it helps someone.\r\n\r\n\r\n  [1]: https://stackoverflow.com/a/5905931/11184255","title":"Intellij doesn&#39;t recognize class","body":"<p>Came across the same problem that classes are not recognized. Running <code>File</code> &gt; <code>Invalidate Caches</code> or <code>File</code> &gt; <code>Repair IDE</code> didn't solve the problem for me.</p>\n<p>The solution was deleting the <code>.idea</code> folder within the project and reopen intellij which scans all classes again <a href=\"https://stackoverflow.com/a/5905931/11184255\">like it is mentioned here</a>. Hope it helps someone.</p>\n"}],"owner":{"account_id":13508325,"reputation":113,"user_id":9745548,"display_name":"Matteo Bianchi"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":9910,"favorite_count":0,"down_vote_count":0,"up_vote_count":7,"accepted_answer_id":56054317,"answer_count":3,"score":7,"last_activity_date":1695380722,"creation_date":1557305275,"question_id":56039603,"body_markdown":"i was doing some homework in java but intellij doesn&#39;t recognize my class. It recognize the main class but it recognize the other class only on the first execution, whenever i modify the code and rebuild it intellij doesn&#39;t recognize the other class. I thought it was a jdk problem so i&#39;ve downloaded an open source jdk but the problem persits. I&#39;ve found  no solutions yet, neither in the intellij forum. It sees the class only if i do a refactor but that&#39;s annoying. Mine intellij is up to date(7/5/19).\r\n\r\nYou can see in the pictures that intellij doesn&#39;t give me any problem on the syntax but it says that he cannot resolve &quot;Matrix&quot;.\r\n\r\n![][1]\r\n![][2]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/XunrP.png\r\n  [2]: https://i.stack.imgur.com/UF4mX.png","title":"Intellij doesn&#39;t recognize class","body":"<p>i was doing some homework in java but intellij doesn't recognize my class. It recognize the main class but it recognize the other class only on the first execution, whenever i modify the code and rebuild it intellij doesn't recognize the other class. I thought it was a jdk problem so i've downloaded an open source jdk but the problem persits. I've found  no solutions yet, neither in the intellij forum. It sees the class only if i do a refactor but that's annoying. Mine intellij is up to date(7/5/19).</p>\n\n<p>You can see in the pictures that intellij doesn't give me any problem on the syntax but it says that he cannot resolve \"Matrix\".</p>\n\n<p><img src=\"https://i.stack.imgur.com/XunrP.png\" alt=\"\">\n<img src=\"https://i.stack.imgur.com/UF4mX.png\" alt=\"\"></p>\n"},{"tags":["java","spring","maven"],"answers":[{"tags":[],"owner":{"account_id":3558841,"reputation":2777,"user_id":2971820,"display_name":"jpmottin"},"down_vote_count":1,"up_vote_count":4,"is_accepted":false,"score":3,"last_activity_date":1459275924,"creation_date":1459275426,"answer_id":36292088,"question_id":36290953,"body_markdown":"1) how does Maven know which tests to run? By default, maven executes all tests. I mean, all test that Maven finds.\r\n\r\n2) how do I tell Maven to run other tests? To execute a specific test class (eg. HelloController2Test), you can do this :\r\n\r\n    mvn -Dtest=HelloController2Test test\r\n\r\n[Reference doc here][1]\r\n\r\n[One other explanation(from the well known site MKYong)][2]\r\n\r\n\r\n  [1]: https://maven.apache.org/surefire/maven-surefire-plugin/examples/single-test.html\r\n  [2]: http://www.mkyong.com/maven/how-to-run-unit-test-with-maven/","title":"How do you tell Maven which Tests to run?","body":"<p>1) how does Maven know which tests to run? By default, maven executes all tests. I mean, all test that Maven finds.</p>\n\n<p>2) how do I tell Maven to run other tests? To execute a specific test class (eg. HelloController2Test), you can do this :</p>\n\n<pre><code>mvn -Dtest=HelloController2Test test\n</code></pre>\n\n<p><a href=\"https://maven.apache.org/surefire/maven-surefire-plugin/examples/single-test.html\" rel=\"nofollow\">Reference doc here</a></p>\n\n<p><a href=\"http://www.mkyong.com/maven/how-to-run-unit-test-with-maven/\" rel=\"nofollow\">One other explanation(from the well known site MKYong)</a></p>\n"},{"tags":[],"owner":{"account_id":56124,"reputation":7256,"user_id":2506382,"accept_rate":67,"display_name":"dcsohl"},"down_vote_count":0,"up_vote_count":8,"is_accepted":true,"score":8,"last_activity_date":1459276679,"creation_date":1459276188,"answer_id":36292312,"question_id":36290953,"body_markdown":"The [maven-surefire-plugin](https://maven.apache.org/surefire/maven-surefire-plugin/) will, [by default](https://maven.apache.org/surefire/maven-surefire-plugin/examples/inclusion-exclusion.html), attempt to execute all tests that follow the pattern of `Test*.java` or `*Test.java` or `*TestCase.java`. It ignores your `HelloControllerIT` very intentionally, as by standard maven convention, that is not a **unit** test, it is an **integration** test. The maven-surefire-plugin is enabled by default in all maven projects.\r\n\r\nThere is a separate plugin, [maven-failsafe-plugin](https://maven.apache.org/surefire/maven-failsafe-plugin/), used to run integration tests, denoted ([by default](https://maven.apache.org/surefire/maven-failsafe-plugin/examples/inclusion-exclusion.html)) by the naming pattern `IT*.java` or `*IT.java` or `*ITCase.java`. It runs during the `integration-test` phase of the build rather than the `test` phase. However, unlike maven-surefire-plugin, you need to explicitly enable it. (I don&#39;t know why this is.)\r\n\r\n      &lt;plugin&gt;\r\n        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n        &lt;artifactId&gt;maven-failsafe-plugin&lt;/artifactId&gt;\r\n        &lt;version&gt;2.19.1&lt;/version&gt;\r\n        &lt;executions&gt;\r\n          &lt;execution&gt;\r\n            &lt;goals&gt;\r\n              &lt;goal&gt;integration-test&lt;/goal&gt;\r\n              &lt;goal&gt;verify&lt;/goal&gt;\r\n            &lt;/goals&gt;\r\n          &lt;/execution&gt;\r\n        &lt;/executions&gt;\r\n      &lt;/plugin&gt;\r\n\r\nAdd maven-failsafe-plugin to your project, and your integration test should run just fine.","title":"How do you tell Maven which Tests to run?","body":"<p>The <a href=\"https://maven.apache.org/surefire/maven-surefire-plugin/\" rel=\"noreferrer\">maven-surefire-plugin</a> will, <a href=\"https://maven.apache.org/surefire/maven-surefire-plugin/examples/inclusion-exclusion.html\" rel=\"noreferrer\">by default</a>, attempt to execute all tests that follow the pattern of <code>Test*.java</code> or <code>*Test.java</code> or <code>*TestCase.java</code>. It ignores your <code>HelloControllerIT</code> very intentionally, as by standard maven convention, that is not a <strong>unit</strong> test, it is an <strong>integration</strong> test. The maven-surefire-plugin is enabled by default in all maven projects.</p>\n\n<p>There is a separate plugin, <a href=\"https://maven.apache.org/surefire/maven-failsafe-plugin/\" rel=\"noreferrer\">maven-failsafe-plugin</a>, used to run integration tests, denoted (<a href=\"https://maven.apache.org/surefire/maven-failsafe-plugin/examples/inclusion-exclusion.html\" rel=\"noreferrer\">by default</a>) by the naming pattern <code>IT*.java</code> or <code>*IT.java</code> or <code>*ITCase.java</code>. It runs during the <code>integration-test</code> phase of the build rather than the <code>test</code> phase. However, unlike maven-surefire-plugin, you need to explicitly enable it. (I don't know why this is.)</p>\n\n<pre><code>  &lt;plugin&gt;\n    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n    &lt;artifactId&gt;maven-failsafe-plugin&lt;/artifactId&gt;\n    &lt;version&gt;2.19.1&lt;/version&gt;\n    &lt;executions&gt;\n      &lt;execution&gt;\n        &lt;goals&gt;\n          &lt;goal&gt;integration-test&lt;/goal&gt;\n          &lt;goal&gt;verify&lt;/goal&gt;\n        &lt;/goals&gt;\n      &lt;/execution&gt;\n    &lt;/executions&gt;\n  &lt;/plugin&gt;\n</code></pre>\n\n<p>Add maven-failsafe-plugin to your project, and your integration test should run just fine.</p>\n"},{"tags":[],"owner":{"account_id":4086251,"reputation":924,"user_id":3355465,"display_name":"RZet"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1459276256,"creation_date":1459276256,"answer_id":36292332,"question_id":36290953,"body_markdown":"Maven surefire plugin is responsible for running tests. The following link should answer your question: [Inclusions and Exclusions of Tests][1]\r\n\r\n\r\n  [1]: http://maven.apache.org/surefire/maven-surefire-plugin/examples/inclusion-exclusion.html","title":"How do you tell Maven which Tests to run?","body":"<p>Maven surefire plugin is responsible for running tests. The following link should answer your question: <a href=\"http://maven.apache.org/surefire/maven-surefire-plugin/examples/inclusion-exclusion.html\" rel=\"nofollow\">Inclusions and Exclusions of Tests</a></p>\n"},{"tags":[],"owner":{"account_id":292399,"reputation":127,"user_id":595132,"accept_rate":40,"display_name":"mohsen ny"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695380234,"creation_date":1695380234,"answer_id":77157015,"question_id":36290953,"body_markdown":"2023 update: According to [this Apache doc][1] this is the way to go:\r\n```\r\n    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n    &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;\r\n    &lt;version&gt;3.1.2&lt;/version&gt;\r\n    &lt;dependencies&gt;\r\n      &lt;dependency&gt;\r\n        &lt;groupId&gt;org.apache.maven.surefire&lt;/groupId&gt;\r\n        &lt;artifactId&gt;surefire-junit47&lt;/artifactId&gt;\r\n        &lt;version&gt;3.1.2&lt;/version&gt;\r\n      &lt;/dependency&gt;\r\n    &lt;/dependencies&gt;\r\n  &lt;/plugin&gt;\r\n```\r\nI tested it and works well\r\n\r\n\r\n  [1]: https://maven.apache.org/surefire/maven-surefire-plugin/examples/junit.html","title":"How do you tell Maven which Tests to run?","body":"<p>2023 update: According to <a href=\"https://maven.apache.org/surefire/maven-surefire-plugin/examples/junit.html\" rel=\"nofollow noreferrer\">this Apache doc</a> this is the way to go:</p>\n<pre><code>    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n    &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;\n    &lt;version&gt;3.1.2&lt;/version&gt;\n    &lt;dependencies&gt;\n      &lt;dependency&gt;\n        &lt;groupId&gt;org.apache.maven.surefire&lt;/groupId&gt;\n        &lt;artifactId&gt;surefire-junit47&lt;/artifactId&gt;\n        &lt;version&gt;3.1.2&lt;/version&gt;\n      &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n  &lt;/plugin&gt;\n</code></pre>\n<p>I tested it and works well</p>\n"}],"owner":{"account_id":551350,"reputation":1516,"user_id":976277,"accept_rate":86,"display_name":"Teofrostus"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":3633,"favorite_count":0,"down_vote_count":0,"up_vote_count":4,"accepted_answer_id":36292312,"answer_count":4,"score":4,"last_activity_date":1695380234,"creation_date":1459272057,"question_id":36290953,"body_markdown":"I am following [this tutorial][1] and have reached the testing portion. When I create the `HelloControllerTest` file as well as a `HelloControllerIT` file in my test directory at `src/test/java/hello/` only the `HelloControllerTest` test runs. However, if I rename the second file to end with the word `Test`, such as `HelloController2Test`, then it also runs. I&#39;m running the tests from command line during the Maven build with `mvn clean verify`. I&#39;m running Maven 3.3.9 on OSX.\r\n\r\nI have two main questions: how does Maven know which tests to run? And, more importantly, how do I tell Maven to run other tests? Below is my `pom.xml`, taken directly from the [tutorial][1]:\r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n    &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n        xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n        &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n    \r\n        &lt;groupId&gt;org.springframework&lt;/groupId&gt;\r\n        &lt;artifactId&gt;gs-spring-boot&lt;/artifactId&gt;\r\n        &lt;version&gt;0.1.0&lt;/version&gt;\r\n    \r\n        &lt;parent&gt;\r\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n            &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\r\n            &lt;version&gt;1.3.3.RELEASE&lt;/version&gt;\r\n        &lt;/parent&gt;\r\n    \r\n        &lt;dependencies&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n                &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n                &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\r\n                &lt;scope&gt;test&lt;/scope&gt;\r\n            &lt;/dependency&gt;\r\n        &lt;/dependencies&gt;\r\n    \r\n        &lt;properties&gt;\r\n            &lt;java.version&gt;1.8&lt;/java.version&gt;\r\n        &lt;/properties&gt;\r\n    \r\n    \r\n        &lt;build&gt;\r\n            &lt;plugins&gt;\r\n                &lt;plugin&gt;\r\n                    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n                    &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n                &lt;/plugin&gt;\r\n            &lt;/plugins&gt;\r\n        &lt;/build&gt;\r\n    \r\n    &lt;/project&gt;\r\n\r\n\r\n  [1]: https://spring.io/guides/gs/spring-boot/","title":"How do you tell Maven which Tests to run?","body":"<p>I am following <a href=\"https://spring.io/guides/gs/spring-boot/\" rel=\"nofollow\">this tutorial</a> and have reached the testing portion. When I create the <code>HelloControllerTest</code> file as well as a <code>HelloControllerIT</code> file in my test directory at <code>src/test/java/hello/</code> only the <code>HelloControllerTest</code> test runs. However, if I rename the second file to end with the word <code>Test</code>, such as <code>HelloController2Test</code>, then it also runs. I'm running the tests from command line during the Maven build with <code>mvn clean verify</code>. I'm running Maven 3.3.9 on OSX.</p>\n\n<p>I have two main questions: how does Maven know which tests to run? And, more importantly, how do I tell Maven to run other tests? Below is my <code>pom.xml</code>, taken directly from the <a href=\"https://spring.io/guides/gs/spring-boot/\" rel=\"nofollow\">tutorial</a>:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n    &lt;artifactId&gt;gs-spring-boot&lt;/artifactId&gt;\n    &lt;version&gt;0.1.0&lt;/version&gt;\n\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;1.3.3.RELEASE&lt;/version&gt;\n    &lt;/parent&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;properties&gt;\n        &lt;java.version&gt;1.8&lt;/java.version&gt;\n    &lt;/properties&gt;\n\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n</code></pre>\n"},{"tags":["java","android"],"comments":[{"owner":{"account_id":2094057,"reputation":506074,"user_id":1863229,"accept_rate":58,"display_name":"Tim Biegeleisen"},"score":1,"creation_date":1613715938,"post_id":66272663,"comment_id":117166645,"body_markdown":"We need to see your JSON, and fixing your JSON at the source is probably the best long term fix here.","body":"We need to see your JSON, and fixing your JSON at the source is probably the best long term fix here."}],"answers":[{"tags":[],"owner":{"account_id":18671929,"reputation":61,"user_id":13610473,"display_name":"Sunshine"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1695380085,"creation_date":1613720537,"answer_id":66273531,"question_id":66272663,"body_markdown":"On the AS, the object class is first converted into a row and then converted into a character string. In this case, when a space is parsed, the end is parsed by default. As a result, an error is reported. Therefore, you need to convert the file to the JSON format in one step to avoid errors.\r\n\r\n    gson.fromJson(gson.toJson(sharedPreferences.getString(NAME_KEY,null),type));","title":"java error when trying to parse json object with a space using gson","body":"<p>On the AS, the object class is first converted into a row and then converted into a character string. In this case, when a space is parsed, the end is parsed by default. As a result, an error is reported. Therefore, you need to convert the file to the JSON format in one step to avoid errors.</p>\n<pre><code>gson.fromJson(gson.toJson(sharedPreferences.getString(NAME_KEY,null),type));\n</code></pre>\n"}],"owner":{"account_id":18089628,"reputation":13,"user_id":13149562,"display_name":"champa"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":512,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1695380085,"creation_date":1613715762,"question_id":66272663,"body_markdown":"I have a class that takes in a String parameter. I then use sharedpreferences to preserve the String. To do this, I converted the input String using the gson.toJson method and then stored it into the sharedpreferences as a json. However, my getter method for the String requires the conversion of the json object of the String back to gson. The conversion works when there are no spaces in the initial input String. However, I get this error when there is a space within the initial input String\r\n\r\n         com.google.gson.JsonSyntaxException: com.google.gson.stream.MalformedJsonException: Use JsonReader.setLenient(true) to accept malformed JSON at line 1 column 6 path $\r\n\r\nHere is the class and parameter:\r\n\r\n        public City(String name)\r\n    {\r\n        this.name=name;\r\n        Gson gson=new Gson();\r\n        sharedPreferences=context.getSharedPreferences(&quot;alternate_db&quot;,Context.MODE_PRIVATE);\r\n        SharedPreferences.Editor editor=sharedPreferences.edit();\r\n        editor.putString(NAME_KEY,gson.toJson(this.name));\r\n        editor.apply();\r\n    }\r\nHere is the getter method for the String:\r\n\r\n        public String getName()\r\n    {\r\n        Gson gson=new Gson();\r\n        Type type=new TypeToken&lt;String&gt;(){}.getType();\r\n        return gson.fromJson(sharedPreferences.getString(NAME_KEY,null),type);\r\n    }\r\n","title":"java error when trying to parse json object with a space using gson","body":"<p>I have a class that takes in a String parameter. I then use sharedpreferences to preserve the String. To do this, I converted the input String using the gson.toJson method and then stored it into the sharedpreferences as a json. However, my getter method for the String requires the conversion of the json object of the String back to gson. The conversion works when there are no spaces in the initial input String. However, I get this error when there is a space within the initial input String</p>\n<pre><code>     com.google.gson.JsonSyntaxException: com.google.gson.stream.MalformedJsonException: Use JsonReader.setLenient(true) to accept malformed JSON at line 1 column 6 path $\n</code></pre>\n<p>Here is the class and parameter:</p>\n<pre><code>    public City(String name)\n{\n    this.name=name;\n    Gson gson=new Gson();\n    sharedPreferences=context.getSharedPreferences(&quot;alternate_db&quot;,Context.MODE_PRIVATE);\n    SharedPreferences.Editor editor=sharedPreferences.edit();\n    editor.putString(NAME_KEY,gson.toJson(this.name));\n    editor.apply();\n}\n</code></pre>\n<p>Here is the getter method for the String:</p>\n<pre><code>    public String getName()\n{\n    Gson gson=new Gson();\n    Type type=new TypeToken&lt;String&gt;(){}.getType();\n    return gson.fromJson(sharedPreferences.getString(NAME_KEY,null),type);\n}\n</code></pre>\n"},{"tags":["java","postgresql","spring-boot","hibernate","spring-data"],"comments":[{"owner":{"account_id":47283,"reputation":703817,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":0,"creation_date":1695378857,"post_id":77156804,"comment_id":136019750,"body_markdown":"I cannot think of an obvious conversion from a hex-encoded binary string to an array of `String`.  Could you explain how you would want that conversion to be done?  (Even converting `bytea` to a `String` is a bit dubious ... since you are not specifying what encoding scheme should be used to decode the binary string.)","body":"I cannot think of an obvious conversion from a hex-encoded binary string to an array of <code>String</code>.  Could you explain how you would want that conversion to be done?  (Even converting <code>bytea</code> to a <code>String</code> is a bit dubious ... since you are not specifying what encoding scheme should be used to decode the binary string.)"},{"owner":{"account_id":4771027,"reputation":1749,"user_id":3855773,"accept_rate":22,"display_name":"Jimmy"},"score":0,"creation_date":1695379233,"post_id":77156804,"comment_id":136019815,"body_markdown":"So encoding schema should be UTF-8. But that might not be concern here, as with @JdbcTypeCode I am able to convert Java objects but it has some issues with Object arrays.","body":"So encoding schema should be UTF-8. But that might not be concern here, as with @JdbcTypeCode I am able to convert Java objects but it has some issues with Object arrays."},{"owner":{"account_id":47283,"reputation":703817,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":0,"creation_date":1695379273,"post_id":77156804,"comment_id":136019822,"body_markdown":"What makes most sense to be is to try to map a `bytea` to a `byte[]` and then decode the `byte[]` yourself in code as appropriate.  That is, using a decoding scheme that is the reverse of the scheme used to encode the data before storing it in the database.","body":"What makes most sense to be is to try to map a <code>bytea</code> to a <code>byte[]</code> and then decode the <code>byte[]</code> yourself in code as appropriate.  That is, using a decoding scheme that is the reverse of the scheme used to encode the data before storing it in the database."},{"owner":{"account_id":47283,"reputation":703817,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":0,"creation_date":1695379346,"post_id":77156804,"comment_id":136019833,"body_markdown":"You haven&#39;t addressed the real question.  How is the `bytea` actually encoded?  Unless you know that, I don&#39;t know how you can expect Hibernate to understand what to do.","body":"You haven&#39;t addressed the real question.  How is the <code>bytea</code> actually encoded?  Unless you know that, I don&#39;t know how you can expect Hibernate to understand what to do."},{"owner":{"account_id":4771027,"reputation":1749,"user_id":3855773,"accept_rate":22,"display_name":"Jimmy"},"score":0,"creation_date":1695380012,"post_id":77156804,"comment_id":136019950,"body_markdown":"Thanks for reminding me of byte[]. I have updated my question. I already tried that but the problem is we can not use deserializer as it&#39;s method is deprecated. Alternative way has a security hotspot. And we didn&#39;t use and encoding while converting to String[] to byte[] it is default UTF-8","body":"Thanks for reminding me of byte[]. I have updated my question. I already tried that but the problem is we can not use deserializer as it&#39;s method is deprecated. Alternative way has a security hotspot. And we didn&#39;t use and encoding while converting to String[] to byte[] it is default UTF-8"}],"owner":{"account_id":4771027,"reputation":1749,"user_id":3855773,"accept_rate":22,"display_name":"Jimmy"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":354,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1695379839,"creation_date":1695378343,"question_id":77156804,"body_markdown":"As I am migrating from Spring boot 2.5 to 3.0 - it updated Hibernate to 6.0. I have a field in Java entity which stored as bytea in PostgreSQL database. And I am reading back in the String[]. \r\n\r\nTo fix this issue, I use @JdbcTypeCode annotation and tried to read the value but it is not working.  \r\n\r\n&gt; The problem is @JdbcTypeCode(SqlTypes.Array) can not convert bytea to\r\n&gt; String[]\r\n\r\n      @Column(name = &quot;dummy&quot;)\r\n      @JdbcTypeCode(SqlTypes.ARRAY)\r\n      private String[] dummy;\r\n\r\nWith the SqlTypes.Array I am getting below exception\r\n\r\n&gt; org.springframework.orm.jpa.JpaSystemException: Unable to extract JDBC value for position `3`\r\n\r\nAccording to http://www.java2s.com/example/java-api/java/sql/types/array-0.html\r\n  SqlTypes.Array returns Object[] but if I change from String[] to Object[] I am getting below error at compile time. \r\n\r\n&gt; Caused by: java.lang.ClassCastException: class org.hibernate.type.descriptor.java.spi.CollectionJavaType cannot be cast to class org.hibernate.type.descriptor.java.BasicPluralJavaType (org.hibernate.type.descriptor.java.spi.CollectionJavaType and org.hibernate.type.descriptor.java.BasicPluralJavaType are in unnamed module of loader &#39;app&#39;)\r\n\r\n**Alternative Approach tried**\r\n\r\nI tried getting the data in byte[] like below,\r\n\r\n \r\n\r\n      @Column(name = &quot;dummy&quot;)\r\n      private byte[] dummy;\r\n      \r\n      public String[] getDummy() {\r\n        SerializationUtils.deserialize(dummy); //This is deprecated\r\n      }\r\n\r\n**And tried converting using SerializationUtils but the deserialize method is deprecated and when with ObjectInputStream we are getting SecurityHotspot.** \r\n\r\nLooking for a lead on how I can convert stored bytea in postgres db to String[]\r\n\r\nThanks in advance. ","title":"Hibernate 6 JdbcTypeCode can not convert bytea to String[] array","body":"<p>As I am migrating from Spring boot 2.5 to 3.0 - it updated Hibernate to 6.0. I have a field in Java entity which stored as bytea in PostgreSQL database. And I am reading back in the String[].</p>\n<p>To fix this issue, I use @JdbcTypeCode annotation and tried to read the value but it is not working.</p>\n<blockquote>\n<p>The problem is @JdbcTypeCode(SqlTypes.Array) can not convert bytea to\nString[]</p>\n</blockquote>\n<pre><code>  @Column(name = &quot;dummy&quot;)\n  @JdbcTypeCode(SqlTypes.ARRAY)\n  private String[] dummy;\n</code></pre>\n<p>With the SqlTypes.Array I am getting below exception</p>\n<blockquote>\n<p>org.springframework.orm.jpa.JpaSystemException: Unable to extract JDBC value for position <code>3</code></p>\n</blockquote>\n<p>According to <a href=\"http://www.java2s.com/example/java-api/java/sql/types/array-0.html\" rel=\"nofollow noreferrer\">http://www.java2s.com/example/java-api/java/sql/types/array-0.html</a>\nSqlTypes.Array returns Object[] but if I change from String[] to Object[] I am getting below error at compile time.</p>\n<blockquote>\n<p>Caused by: java.lang.ClassCastException: class org.hibernate.type.descriptor.java.spi.CollectionJavaType cannot be cast to class org.hibernate.type.descriptor.java.BasicPluralJavaType (org.hibernate.type.descriptor.java.spi.CollectionJavaType and org.hibernate.type.descriptor.java.BasicPluralJavaType are in unnamed module of loader 'app')</p>\n</blockquote>\n<p><strong>Alternative Approach tried</strong></p>\n<p>I tried getting the data in byte[] like below,</p>\n<pre><code>  @Column(name = &quot;dummy&quot;)\n  private byte[] dummy;\n  \n  public String[] getDummy() {\n    SerializationUtils.deserialize(dummy); //This is deprecated\n  }\n</code></pre>\n<p><strong>And tried converting using SerializationUtils but the deserialize method is deprecated and when with ObjectInputStream we are getting SecurityHotspot.</strong></p>\n<p>Looking for a lead on how I can convert stored bytea in postgres db to String[]</p>\n<p>Thanks in advance.</p>\n"},{"tags":["java","kotlin","nfc","kotlin-multiplatform","st25"],"comments":[{"owner":{"account_id":1675086,"reputation":33855,"user_id":1540818,"accept_rate":82,"display_name":"Joffrey"},"score":1,"creation_date":1695380283,"post_id":77156754,"comment_id":136019994,"body_markdown":"As a side note, the name Kotlin Multiplatform Mobile (KMM) was deprecated in favor of Kotlin Multiplaform (KMP): https://blog.jetbrains.com/kotlin/2023/07/update-on-the-name-of-kotlin-multiplatform/","body":"As a side note, the name Kotlin Multiplatform Mobile (KMM) was deprecated in favor of Kotlin Multiplaform (KMP): <a href=\"https://blog.jetbrains.com/kotlin/2023/07/update-on-the-name-of-kotlin-multiplatform/\" rel=\"nofollow noreferrer\">blog.jetbrains.com/kotlin/2023/07/&hellip;</a>"}],"answers":[{"tags":[],"owner":{"account_id":1675086,"reputation":33855,"user_id":1540818,"accept_rate":82,"display_name":"Joffrey"},"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1695379705,"creation_date":1695379705,"answer_id":77156950,"question_id":77156754,"body_markdown":"The iOS version of your app will not run on the JVM, it runs natively on iOS. Therefore you cannot use JVM libraries in your iOS app.\r\n\r\nThat said, the Kotlin multiplatform technology does allow you to write common code that calls some functions/APIs that have a different implementation on different platform.\r\n\r\nThis means that, if you find an iOS library to do this, you could define the common API you need as `expect` declarations in common code, and then write the `actual` implementations in the JVM source set by delegating to the ST25 JVM library, and other `actual` implementations in the iOS source set by delegating to the iOS library.","title":"How to use a Java library with KMM (Kotlin Multiplatform Mobile)","body":"<p>The iOS version of your app will not run on the JVM, it runs natively on iOS. Therefore you cannot use JVM libraries in your iOS app.</p>\n<p>That said, the Kotlin multiplatform technology does allow you to write common code that calls some functions/APIs that have a different implementation on different platform.</p>\n<p>This means that, if you find an iOS library to do this, you could define the common API you need as <code>expect</code> declarations in common code, and then write the <code>actual</code> implementations in the JVM source set by delegating to the ST25 JVM library, and other <code>actual</code> implementations in the iOS source set by delegating to the iOS library.</p>\n"}],"owner":{"account_id":19629640,"reputation":15,"user_id":14368242,"display_name":"Matteo Trupia"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":179,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":77156950,"answer_count":1,"score":1,"last_activity_date":1695379705,"creation_date":1695377974,"question_id":77156754,"body_markdown":"I am developing an **Android** application that uses the **ST25 library** to read **NFC** ST tags. I would like to **port my application** also to **iOS** using **KMM**, a **cross-platform** solution based on **Kotlin**. The **ST25 library** is written in **Java** and I don&#39;t know if I can use it with KMM or if I should look for an alternative. The ST25 sdk includes an .aar and a .jar.\r\n\r\nMy question is, can I use the ST25 library with KMM?If yes, how can I integrate it into my project?If not, is there an equivalent library written in Kotlin or another language compatible with KMM?\r\n\r\n\r\nI tried to do some research online and found only old posts about it and wanted to know if there were any updates regarding the use of Java libraries in KKM.","title":"How to use a Java library with KMM (Kotlin Multiplatform Mobile)","body":"<p>I am developing an <strong>Android</strong> application that uses the <strong>ST25 library</strong> to read <strong>NFC</strong> ST tags. I would like to <strong>port my application</strong> also to <strong>iOS</strong> using <strong>KMM</strong>, a <strong>cross-platform</strong> solution based on <strong>Kotlin</strong>. The <strong>ST25 library</strong> is written in <strong>Java</strong> and I don't know if I can use it with KMM or if I should look for an alternative. The ST25 sdk includes an .aar and a .jar.</p>\n<p>My question is, can I use the ST25 library with KMM?If yes, how can I integrate it into my project?If not, is there an equivalent library written in Kotlin or another language compatible with KMM?</p>\n<p>I tried to do some research online and found only old posts about it and wanted to know if there were any updates regarding the use of Java libraries in KKM.</p>\n"},{"tags":["java","html","owasp","antisamy"],"comments":[{"owner":{"account_id":385460,"reputation":1357,"user_id":742609,"display_name":"Kevin W. Wall"},"score":0,"creation_date":1695010168,"post_id":77099785,"comment_id":135961842,"body_markdown":"I suggest you remove the &#39;esapi&#39; tag here as this is not an ESAPI issue. You are using AntiSamy directly. I suggest you email one or both of the AntiSamy maintainers. You can find their email addresses on https://owasp.org/www-project-antisamy/ under &quot;Leaders&quot; listed on the right-hand side. Maybe add a tag for &#39;antisamy&#39; in case anyone is watching for that. I don&#39;t really care to look into their code to see how it finds resources though, so ask them.","body":"I suggest you remove the &#39;esapi&#39; tag here as this is not an ESAPI issue. You are using AntiSamy directly. I suggest you email one or both of the AntiSamy maintainers. You can find their email addresses on <a href=\"https://owasp.org/www-project-antisamy/\" rel=\"nofollow noreferrer\">owasp.org/www-project-antisamy</a> under &quot;Leaders&quot; listed on the right-hand side. Maybe add a tag for &#39;antisamy&#39; in case anyone is watching for that. I don&#39;t really care to look into their code to see how it finds resources though, so ask them."},{"owner":{"account_id":19727548,"reputation":13,"user_id":14443800,"display_name":"Gafar"},"score":0,"creation_date":1695405075,"post_id":77099785,"comment_id":136024957,"body_markdown":"After several attempt at making this work, unfortunately it does not.\n\nHowever, I found a better solution https://stackoverflow.com/questions/3413297/how-to-sanitize-html-code-in-java-to-prevent-xss-attacks","body":"After several attempt at making this work, unfortunately it does not.  However, I found a better solution <a href=\"https://stackoverflow.com/questions/3413297/how-to-sanitize-html-code-in-java-to-prevent-xss-attacks\" title=\"how to sanitize html code in java to prevent xss attacks\">stackoverflow.com/questions/3413297/&hellip;</a>"}],"owner":{"account_id":19727548,"reputation":13,"user_id":14443800,"display_name":"Gafar"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":35,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1695379564,"creation_date":1694631155,"question_id":77099785,"body_markdown":"I am working on a project that takes html from the user and persist to the DB. The current implementation is vulnerable to XSS attack. \r\n\r\nIn order to prevent this attack, I am trying to implement the OWASP Antisamy as seen [here](https://wiki.owasp.org/index.php/Category:OWASP_AntiSamy_Project#tab=How_do_I_get_started_3F) but I am getting fileNotFoundError for the policy that I have downloaded and put in the resources directory of the project.\r\n\r\n#### Code\r\n```java\r\n//sanitize welcomeMessage\r\ntry {\r\n    Policy policy = Policy.getInstance(new File(&quot;antisamy-tinymce.xml&quot;));\r\n    AntiSamy as = new AntiSamy();\r\n    CleanResults cr = as.scan(welcomeMessage, policy);\r\n    preferences.setWelcomeMessage(cr.getCleanHTML());\r\n} catch (PolicyException | ScanException e) {\r\n    FacesContext.getCurrentInstance().addMessage(null, new FacesMessage(FacesMessage.SEVERITY_WARN, &quot;Invalid Welcome Message&quot;, e.getMessage()));\r\n    return;\r\n}\r\n```\r\n\r\n#### Project Structure\r\n```\r\n.\r\n src/\r\n     main/\r\n         resources/\r\n             antisamy-tinymce.xml\r\n```\r\n\r\nAny pointer to what I might be doing wrongly?\r\n\r\nI have tried using the absolute path of the antisamy-tinymce.xml file but it doesn&#39;t work when deployed to the application server.","title":"Error: FileNotFound thrown while trying to use antisamy-tinymce.xml OWASP","body":"<p>I am working on a project that takes html from the user and persist to the DB. The current implementation is vulnerable to XSS attack.</p>\n<p>In order to prevent this attack, I am trying to implement the OWASP Antisamy as seen <a href=\"https://wiki.owasp.org/index.php/Category:OWASP_AntiSamy_Project#tab=How_do_I_get_started_3F\" rel=\"nofollow noreferrer\">here</a> but I am getting fileNotFoundError for the policy that I have downloaded and put in the resources directory of the project.</p>\n<h4>Code</h4>\n<pre class=\"lang-java prettyprint-override\"><code>//sanitize welcomeMessage\ntry {\n    Policy policy = Policy.getInstance(new File(&quot;antisamy-tinymce.xml&quot;));\n    AntiSamy as = new AntiSamy();\n    CleanResults cr = as.scan(welcomeMessage, policy);\n    preferences.setWelcomeMessage(cr.getCleanHTML());\n} catch (PolicyException | ScanException e) {\n    FacesContext.getCurrentInstance().addMessage(null, new FacesMessage(FacesMessage.SEVERITY_WARN, &quot;Invalid Welcome Message&quot;, e.getMessage()));\n    return;\n}\n</code></pre>\n<h4>Project Structure</h4>\n<pre><code>.\n src/\n     main/\n         resources/\n             antisamy-tinymce.xml\n</code></pre>\n<p>Any pointer to what I might be doing wrongly?</p>\n<p>I have tried using the absolute path of the antisamy-tinymce.xml file but it doesn't work when deployed to the application server.</p>\n"},{"tags":["java","xslt"],"comments":[{"owner":{"account_id":22562945,"reputation":462,"user_id":16750357,"display_name":"al.truisme"},"score":0,"creation_date":1692517453,"post_id":76938166,"comment_id":135632150,"body_markdown":"Seems to be an exception thrown during the transformation when retrieving the source (input) document, here presented as a ```DOMSource```.","body":"Seems to be an exception thrown during the transformation when retrieving the source (input) document, here presented as a <code>DOMSource</code>."},{"owner":{"account_id":91947,"reputation":161814,"user_id":252228,"accept_rate":80,"display_name":"Martin Honnen"},"score":1,"creation_date":1692519998,"post_id":76938166,"comment_id":135632376,"body_markdown":"I would check whether it works or fails with Java 8 or 11, too. Then I would check whether it works with the latest Xalan release from Apache or in general, try to run my XSLT with Saxon HE anyway.","body":"I would check whether it works or fails with Java 8 or 11, too. Then I would check whether it works with the latest Xalan release from Apache or in general, try to run my XSLT with Saxon HE anyway."},{"owner":{"account_id":5289146,"reputation":8128,"user_id":4222206,"display_name":"queeg"},"score":0,"creation_date":1692520745,"post_id":76938166,"comment_id":135632440,"body_markdown":"If it were the source (input) document, it should fail the same way using the identity transformation - it does not.","body":"If it were the source (input) document, it should fail the same way using the identity transformation - it does not."}],"answers":[{"tags":[],"owner":{"account_id":5289146,"reputation":8128,"user_id":4222206,"display_name":"queeg"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1692521566,"creation_date":1692521566,"answer_id":76938659,"question_id":76938166,"body_markdown":"Martin Honnen had the key idea: Simply switch to Saxon HE.\r\nAll I did was to add this dependency to my project:\r\n\r\n    &lt;!-- https://mvnrepository.com/artifact/net.sf.saxon/Saxon-HE --&gt;\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;net.sf.saxon&lt;/groupId&gt;\r\n        &lt;artifactId&gt;Saxon-HE&lt;/artifactId&gt;\r\n        &lt;version&gt;12.3&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n\r\nNow the code runs without a single line changed. The issue must somehow be in the OpenJDK-embedded Xalan version, but it is no longer blocking me.","title":"XSLT in OpenJDK 17 gives NullPointerException (Bug in Xalan?)","body":"<p>Martin Honnen had the key idea: Simply switch to Saxon HE.\nAll I did was to add this dependency to my project:</p>\n<pre><code>&lt;!-- https://mvnrepository.com/artifact/net.sf.saxon/Saxon-HE --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;net.sf.saxon&lt;/groupId&gt;\n    &lt;artifactId&gt;Saxon-HE&lt;/artifactId&gt;\n    &lt;version&gt;12.3&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>Now the code runs without a single line changed. The issue must somehow be in the OpenJDK-embedded Xalan version, but it is no longer blocking me.</p>\n"},{"tags":[],"owner":{"account_id":8413095,"reputation":1,"user_id":6314354,"display_name":"pralys"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695379169,"creation_date":1695054070,"answer_id":77128842,"question_id":76938166,"body_markdown":"Since _stringRep depends on the XML namespace (see Xalan sources in JDK17) :\r\n\r\n    public QName(String namespace, String prefix, String localname) {\r\n        _namespace = namespace;\r\n        _prefix    = prefix;\r\n        _localname = localname;\r\n\r\n        _stringRep =\r\n            (namespace != null &amp;&amp; !namespace.equals(Constants.EMPTYSTRING)) ?\r\n            (namespace + &#39;:&#39; + localname) : localname;\r\n\r\n        _hashCode  = _stringRep.hashCode() + 19; // cached for speed\r\n    }\r\n\r\nAnd since your stylesheet contains some XML namespace (in your case &quot;xsl&quot;), setting isNamespaceAware to true (Kotlin) or doing a setNamespaceAware(true) (Java) on the document builder factory may solve your last problem. It will make the factory generate namespace aware parsers. The default value for namespaceAware is false.\r\n\r\nHere is some usefull documentation : https://xalan.apache.org/xalan-j/faq.html#faq-16","title":"XSLT in OpenJDK 17 gives NullPointerException (Bug in Xalan?)","body":"<p>Since _stringRep depends on the XML namespace (see Xalan sources in JDK17) :</p>\n<pre><code>public QName(String namespace, String prefix, String localname) {\n    _namespace = namespace;\n    _prefix    = prefix;\n    _localname = localname;\n\n    _stringRep =\n        (namespace != null &amp;&amp; !namespace.equals(Constants.EMPTYSTRING)) ?\n        (namespace + ':' + localname) : localname;\n\n    _hashCode  = _stringRep.hashCode() + 19; // cached for speed\n}\n</code></pre>\n<p>And since your stylesheet contains some XML namespace (in your case &quot;xsl&quot;), setting isNamespaceAware to true (Kotlin) or doing a setNamespaceAware(true) (Java) on the document builder factory may solve your last problem. It will make the factory generate namespace aware parsers. The default value for namespaceAware is false.</p>\n<p>Here is some usefull documentation : <a href=\"https://xalan.apache.org/xalan-j/faq.html#faq-16\" rel=\"nofollow noreferrer\">https://xalan.apache.org/xalan-j/faq.html#faq-16</a></p>\n"}],"owner":{"account_id":5289146,"reputation":8128,"user_id":4222206,"display_name":"queeg"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":273,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":76938659,"answer_count":2,"score":1,"last_activity_date":1695379169,"creation_date":1692512209,"question_id":76938166,"body_markdown":"I have used XSLT transformation many times in Java thus I am puzzled getting a NullPointerException.\r\n\r\nThis piece of code works without problem:\r\n\r\n        Document doc = generateXml(catalog);\r\n        \r\n        Transformer transformer = TransformerFactory.newInstance().newTransformer();\r\n        transformer.setOutputProperty(OutputKeys.INDENT, &quot;yes&quot;);\r\n        transformer.setOutputProperty(\r\n             &quot;{http://xml.apache.org/xslt}indent-amount&quot;, &quot;4&quot;);\r\n        transformer.transform(new DOMSource(doc), new StreamResult(out));\r\n\r\nNow I want to use a different stylesheet, thus I change the code into that:\r\n\r\n        Document doc = generateXml(catalog);\r\n        \r\n        URL stylesheet = getClass().getResource(&quot;catalog_html.xslt&quot;);\r\n        log.debug(&quot;stylesheet url: {}&quot;, stylesheet);\r\n        Transformer transformer = TransformerFactory.newInstance()\r\n                .newTransformer(new StreamSource(stylesheet.openStream()));\r\n        transformer.transform(new DOMSource(doc), new StreamResult(out));\r\n\r\nFrom the debug log I know that styleheet is not null. Otherwise I would get a NullPointerException when creating the transformer. But instead I get a NullPointerException when executing the transformer, and it looks like this:\r\n\r\n    javax.xml.transform.TransformerException: javax.xml.transform.TransformerException: java.lang.NullPointerException: Cannot invoke &quot;String.toCharArray()&quot; because &quot;data&quot; is null\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(TransformerImpl.java:792) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(TransformerImpl.java:395) ~[?:?]\r\n    \tat com.chaudhuri.cataloggenerator.Generator.writeHtml(Generator.java:318) ~[classes/:?]\r\n    \tat com.chaudhuri.cataloggenerator.Generator.lambda$run$3(Generator.java:248) ~[classes/:?]\r\n    \tat java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:992) ~[?:?]\r\n    \tat java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:762) ~[?:?]\r\n    \tat com.chaudhuri.cataloggenerator.Generator.run(Generator.java:230) ~[classes/:?]\r\n    \tat com.chaudhuri.cataloggenerator.GeneratorTest.testRun4(GeneratorTest.java:193) ~[test-classes/:?]\r\n    \tat jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]\r\n    \tat jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]\r\n    \tat jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]\r\n    \tat java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]\r\n    \tat org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:727) ~[junit-platform-commons-1.9.2.jar:1.9.2]\r\n    \tat org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:217) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]\r\n    \tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]\r\n    \tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:147) ~[junit-platform-launcher-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:127) ~[junit-platform-launcher-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:90) ~[junit-platform-launcher-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:55) ~[junit-platform-launcher-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:102) [junit-platform-launcher-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:54) [junit-platform-launcher-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114) [junit-platform-launcher-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86) [junit-platform-launcher-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86) [junit-platform-launcher-1.9.2.jar:1.9.2]\r\n    \tat org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:50) [surefire-junit-platform-3.0.0.jar:3.0.0]\r\n    \tat org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:184) [surefire-junit-platform-3.0.0.jar:3.0.0]\r\n    \tat org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:148) [surefire-junit-platform-3.0.0.jar:3.0.0]\r\n    \tat org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:122) [surefire-junit-platform-3.0.0.jar:3.0.0]\r\n    \tat org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385) [surefire-booter-3.0.0.jar:3.0.0]\r\n    \tat org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162) [surefire-booter-3.0.0.jar:3.0.0]\r\n    \tat org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507) [surefire-booter-3.0.0.jar:3.0.0]\r\n    \tat org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495) [surefire-booter-3.0.0.jar:3.0.0]\r\n    Caused by: javax.xml.transform.TransformerException: java.lang.NullPointerException: Cannot invoke &quot;String.toCharArray()&quot; because &quot;data&quot; is null\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.getDOM(TransformerImpl.java:603) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(TransformerImpl.java:782) ~[?:?]\r\n    \t... 78 more\r\n    Caused by: java.lang.NullPointerException: Cannot invoke &quot;String.toCharArray()&quot; because &quot;data&quot; is null\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX.java:294) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX.java:275) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX.java:275) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX.java:275) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX.java:192) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX.java:144) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.dom.XSLTCDTMManager.getDTM(XSLTCDTMManager.java:335) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.dom.XSLTCDTMManager.getDTM(XSLTCDTMManager.java:214) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.getDOM(TransformerImpl.java:581) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(TransformerImpl.java:782) ~[?:?]\r\n    \t... 78 more\r\n\r\nWhile I do not believe this is related to the stylesheet, well here it is:\r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n    &lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;1.0&quot;&gt;\r\n        &lt;xsl:output method=&quot;html&quot;/&gt;\r\n    \r\n        &lt;!-- TODO customize transformation rules \r\n             syntax recommendation http://www.w3.org/TR/xslt \r\n        --&gt;\r\n        &lt;xsl:template match=&quot;/&quot;&gt;\r\n            &lt;html&gt;\r\n                &lt;head&gt;\r\n                    &lt;title&gt;catalog_html.xsl&lt;/title&gt;\r\n                &lt;/head&gt;\r\n                &lt;body&gt;\r\n                &lt;/body&gt;\r\n            &lt;/html&gt;\r\n        &lt;/xsl:template&gt;\r\n    \r\n    &lt;/xsl:stylesheet&gt;\r\n\r\nAny ideas what could be the cause?\r\n\r\nEdit\r\n-\r\n\r\nJust to see whether the problem was in the StreamSource, I changed my code to\r\n\r\n        Document doc = generateXml(catalog);\r\n        \r\n        URL stylesheet = getClass().getResource(&quot;catalog_html.xslt&quot;);\r\n        Document ss = DocumentBuilderFactory.newInstance()\r\n                                            .newDocumentBuilder()\r\n                                            .parse(stylesheet.openStream());\r\n        Transformer transformer = \r\n            TransformerFactory.newInstance()\r\n                              .newTransformer(new DOMSource(ss));\r\n        transformer.transform(new DOMSource(doc), new StreamResult(out));\r\n\r\nDo I am parsing the stylesheet myself before injecting it as DOM structure into the transformer. This time I get another exception when initializing the transformer:\r\n\r\n    javax.xml.transform.TransformerConfigurationException: Cannot invoke &quot;String.hashCode()&quot; because &quot;this._stringRep&quot; is null\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl.newTemplates(TransformerFactoryImpl.java:1077) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl.newTransformer(TransformerFactoryImpl.java:834) ~[?:?]\r\n    \tat com.chaudhuri.cataloggenerator.Generator.writeHtml(Generator.java:319) ~[classes/:?]\r\n    \tat com.chaudhuri.cataloggenerator.Generator.lambda$run$3(Generator.java:249) ~[classes/:?]\r\n    \tat java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:992) ~[?:?]\r\n    \tat java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:762) ~[?:?]\r\n    \tat com.chaudhuri.cataloggenerator.Generator.run(Generator.java:231) ~[classes/:?]\r\n    \tat com.chaudhuri.cataloggenerator.GeneratorTest.testRun4(GeneratorTest.java:193) ~[test-classes/:?]\r\n    \tat jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]\r\n    \tat jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]\r\n    \tat jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]\r\n    \tat java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]\r\n    \tat org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:727) ~[junit-platform-commons-1.9.2.jar:1.9.2]\r\n    \tat org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:217) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]\r\n    \tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]\r\n    \tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54) ~[junit-platform-engine-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:147) ~[junit-platform-launcher-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:127) ~[junit-platform-launcher-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:90) ~[junit-platform-launcher-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:55) ~[junit-platform-launcher-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:102) [junit-platform-launcher-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:54) [junit-platform-launcher-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114) [junit-platform-launcher-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86) [junit-platform-launcher-1.9.2.jar:1.9.2]\r\n    \tat org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86) [junit-platform-launcher-1.9.2.jar:1.9.2]\r\n    \tat org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:50) [surefire-junit-platform-3.0.0.jar:3.0.0]\r\n    \tat org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:184) [surefire-junit-platform-3.0.0.jar:3.0.0]\r\n    \tat org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:148) [surefire-junit-platform-3.0.0.jar:3.0.0]\r\n    \tat org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:122) [surefire-junit-platform-3.0.0.jar:3.0.0]\r\n    \tat org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385) [surefire-booter-3.0.0.jar:3.0.0]\r\n    \tat org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162) [surefire-booter-3.0.0.jar:3.0.0]\r\n    \tat org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507) [surefire-booter-3.0.0.jar:3.0.0]\r\n    \tat org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495) [surefire-booter-3.0.0.jar:3.0.0]\r\n    Caused by: java.lang.NullPointerException: Cannot invoke &quot;String.hashCode()&quot; because &quot;this._stringRep&quot; is null\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.compiler.QName.&lt;init&gt;(QName.java:45) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.compiler.Parser.getQName(Parser.java:315) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.compiler.Parser.makeInstance(Parser.java:982) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.compiler.Parser.startElement(Parser.java:1312) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX.java:269) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX.java:192) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX.java:130) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.compiler.Parser.parse(Parser.java:439) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.compiler.XSLTC.compile(XSLTC.java:481) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.compiler.XSLTC.compile(XSLTC.java:575) ~[?:?]\r\n    \tat com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl.newTemplates(TransformerFactoryImpl.java:1036) ~[?:?]\r\n    \t... 78 more\r\n\r\nIt seems to be either my stylesheet or Xalan. But even if it were the stylesheet, I&#39;d expect a better message from Xalan than that.","title":"XSLT in OpenJDK 17 gives NullPointerException (Bug in Xalan?)","body":"<p>I have used XSLT transformation many times in Java thus I am puzzled getting a NullPointerException.</p>\n<p>This piece of code works without problem:</p>\n<pre><code>    Document doc = generateXml(catalog);\n    \n    Transformer transformer = TransformerFactory.newInstance().newTransformer();\n    transformer.setOutputProperty(OutputKeys.INDENT, &quot;yes&quot;);\n    transformer.setOutputProperty(\n         &quot;{http://xml.apache.org/xslt}indent-amount&quot;, &quot;4&quot;);\n    transformer.transform(new DOMSource(doc), new StreamResult(out));\n</code></pre>\n<p>Now I want to use a different stylesheet, thus I change the code into that:</p>\n<pre><code>    Document doc = generateXml(catalog);\n    \n    URL stylesheet = getClass().getResource(&quot;catalog_html.xslt&quot;);\n    log.debug(&quot;stylesheet url: {}&quot;, stylesheet);\n    Transformer transformer = TransformerFactory.newInstance()\n            .newTransformer(new StreamSource(stylesheet.openStream()));\n    transformer.transform(new DOMSource(doc), new StreamResult(out));\n</code></pre>\n<p>From the debug log I know that styleheet is not null. Otherwise I would get a NullPointerException when creating the transformer. But instead I get a NullPointerException when executing the transformer, and it looks like this:</p>\n<pre><code>javax.xml.transform.TransformerException: javax.xml.transform.TransformerException: java.lang.NullPointerException: Cannot invoke &quot;String.toCharArray()&quot; because &quot;data&quot; is null\n    at com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(TransformerImpl.java:792) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(TransformerImpl.java:395) ~[?:?]\n    at com.chaudhuri.cataloggenerator.Generator.writeHtml(Generator.java:318) ~[classes/:?]\n    at com.chaudhuri.cataloggenerator.Generator.lambda$run$3(Generator.java:248) ~[classes/:?]\n    at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:992) ~[?:?]\n    at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:762) ~[?:?]\n    at com.chaudhuri.cataloggenerator.Generator.run(Generator.java:230) ~[classes/:?]\n    at com.chaudhuri.cataloggenerator.GeneratorTest.testRun4(GeneratorTest.java:193) ~[test-classes/:?]\n    at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]\n    at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]\n    at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]\n    at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]\n    at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:727) ~[junit-platform-commons-1.9.2.jar:1.9.2]\n    at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:217) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]\n    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]\n    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:147) ~[junit-platform-launcher-1.9.2.jar:1.9.2]\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:127) ~[junit-platform-launcher-1.9.2.jar:1.9.2]\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:90) ~[junit-platform-launcher-1.9.2.jar:1.9.2]\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:55) ~[junit-platform-launcher-1.9.2.jar:1.9.2]\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:102) [junit-platform-launcher-1.9.2.jar:1.9.2]\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:54) [junit-platform-launcher-1.9.2.jar:1.9.2]\n    at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114) [junit-platform-launcher-1.9.2.jar:1.9.2]\n    at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86) [junit-platform-launcher-1.9.2.jar:1.9.2]\n    at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86) [junit-platform-launcher-1.9.2.jar:1.9.2]\n    at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:50) [surefire-junit-platform-3.0.0.jar:3.0.0]\n    at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:184) [surefire-junit-platform-3.0.0.jar:3.0.0]\n    at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:148) [surefire-junit-platform-3.0.0.jar:3.0.0]\n    at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:122) [surefire-junit-platform-3.0.0.jar:3.0.0]\n    at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385) [surefire-booter-3.0.0.jar:3.0.0]\n    at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162) [surefire-booter-3.0.0.jar:3.0.0]\n    at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507) [surefire-booter-3.0.0.jar:3.0.0]\n    at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495) [surefire-booter-3.0.0.jar:3.0.0]\nCaused by: javax.xml.transform.TransformerException: java.lang.NullPointerException: Cannot invoke &quot;String.toCharArray()&quot; because &quot;data&quot; is null\n    at com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.getDOM(TransformerImpl.java:603) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(TransformerImpl.java:782) ~[?:?]\n    ... 78 more\nCaused by: java.lang.NullPointerException: Cannot invoke &quot;String.toCharArray()&quot; because &quot;data&quot; is null\n    at com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX.java:294) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX.java:275) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX.java:275) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX.java:275) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX.java:192) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX.java:144) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.dom.XSLTCDTMManager.getDTM(XSLTCDTMManager.java:335) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.dom.XSLTCDTMManager.getDTM(XSLTCDTMManager.java:214) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.getDOM(TransformerImpl.java:581) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(TransformerImpl.java:782) ~[?:?]\n    ... 78 more\n</code></pre>\n<p>While I do not believe this is related to the stylesheet, well here it is:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;1.0&quot;&gt;\n    &lt;xsl:output method=&quot;html&quot;/&gt;\n\n    &lt;!-- TODO customize transformation rules \n         syntax recommendation http://www.w3.org/TR/xslt \n    --&gt;\n    &lt;xsl:template match=&quot;/&quot;&gt;\n        &lt;html&gt;\n            &lt;head&gt;\n                &lt;title&gt;catalog_html.xsl&lt;/title&gt;\n            &lt;/head&gt;\n            &lt;body&gt;\n            &lt;/body&gt;\n        &lt;/html&gt;\n    &lt;/xsl:template&gt;\n\n&lt;/xsl:stylesheet&gt;\n</code></pre>\n<p>Any ideas what could be the cause?</p>\n<h2>Edit</h2>\n<p>Just to see whether the problem was in the StreamSource, I changed my code to</p>\n<pre><code>    Document doc = generateXml(catalog);\n    \n    URL stylesheet = getClass().getResource(&quot;catalog_html.xslt&quot;);\n    Document ss = DocumentBuilderFactory.newInstance()\n                                        .newDocumentBuilder()\n                                        .parse(stylesheet.openStream());\n    Transformer transformer = \n        TransformerFactory.newInstance()\n                          .newTransformer(new DOMSource(ss));\n    transformer.transform(new DOMSource(doc), new StreamResult(out));\n</code></pre>\n<p>Do I am parsing the stylesheet myself before injecting it as DOM structure into the transformer. This time I get another exception when initializing the transformer:</p>\n<pre><code>javax.xml.transform.TransformerConfigurationException: Cannot invoke &quot;String.hashCode()&quot; because &quot;this._stringRep&quot; is null\n    at com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl.newTemplates(TransformerFactoryImpl.java:1077) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl.newTransformer(TransformerFactoryImpl.java:834) ~[?:?]\n    at com.chaudhuri.cataloggenerator.Generator.writeHtml(Generator.java:319) ~[classes/:?]\n    at com.chaudhuri.cataloggenerator.Generator.lambda$run$3(Generator.java:249) ~[classes/:?]\n    at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:992) ~[?:?]\n    at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:762) ~[?:?]\n    at com.chaudhuri.cataloggenerator.Generator.run(Generator.java:231) ~[classes/:?]\n    at com.chaudhuri.cataloggenerator.GeneratorTest.testRun4(GeneratorTest.java:193) ~[test-classes/:?]\n    at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]\n    at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[?:?]\n    at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]\n    at java.lang.reflect.Method.invoke(Method.java:568) ~[?:?]\n    at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:727) ~[junit-platform-commons-1.9.2.jar:1.9.2]\n    at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:217) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68) ~[junit-jupiter-engine-5.9.2.jar:5.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]\n    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at java.util.ArrayList.forEach(ArrayList.java:1511) ~[?:?]\n    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54) ~[junit-platform-engine-1.9.2.jar:1.9.2]\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:147) ~[junit-platform-launcher-1.9.2.jar:1.9.2]\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:127) ~[junit-platform-launcher-1.9.2.jar:1.9.2]\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:90) ~[junit-platform-launcher-1.9.2.jar:1.9.2]\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:55) ~[junit-platform-launcher-1.9.2.jar:1.9.2]\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:102) [junit-platform-launcher-1.9.2.jar:1.9.2]\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:54) [junit-platform-launcher-1.9.2.jar:1.9.2]\n    at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114) [junit-platform-launcher-1.9.2.jar:1.9.2]\n    at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86) [junit-platform-launcher-1.9.2.jar:1.9.2]\n    at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86) [junit-platform-launcher-1.9.2.jar:1.9.2]\n    at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:50) [surefire-junit-platform-3.0.0.jar:3.0.0]\n    at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:184) [surefire-junit-platform-3.0.0.jar:3.0.0]\n    at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:148) [surefire-junit-platform-3.0.0.jar:3.0.0]\n    at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:122) [surefire-junit-platform-3.0.0.jar:3.0.0]\n    at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385) [surefire-booter-3.0.0.jar:3.0.0]\n    at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162) [surefire-booter-3.0.0.jar:3.0.0]\n    at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507) [surefire-booter-3.0.0.jar:3.0.0]\n    at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495) [surefire-booter-3.0.0.jar:3.0.0]\nCaused by: java.lang.NullPointerException: Cannot invoke &quot;String.hashCode()&quot; because &quot;this._stringRep&quot; is null\n    at com.sun.org.apache.xalan.internal.xsltc.compiler.QName.&lt;init&gt;(QName.java:45) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.compiler.Parser.getQName(Parser.java:315) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.compiler.Parser.makeInstance(Parser.java:982) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.compiler.Parser.startElement(Parser.java:1312) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX.java:269) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX.java:192) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX.java:130) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.compiler.Parser.parse(Parser.java:439) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.compiler.XSLTC.compile(XSLTC.java:481) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.compiler.XSLTC.compile(XSLTC.java:575) ~[?:?]\n    at com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl.newTemplates(TransformerFactoryImpl.java:1036) ~[?:?]\n    ... 78 more\n</code></pre>\n<p>It seems to be either my stylesheet or Xalan. But even if it were the stylesheet, I'd expect a better message from Xalan than that.</p>\n"},{"tags":["java","unit-testing","assertj"],"answers":[{"tags":[],"owner":{"account_id":13463440,"reputation":1896,"user_id":9714611,"display_name":"Stefano Cordio"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1695379088,"creation_date":1695379088,"answer_id":77156891,"question_id":77156631,"body_markdown":"As the exception is caught in the method, AssertJ has no chance to see it, hence the assertion error you already experienced.\r\n\r\nAssuming you are in a unit test with a mock of the DB writer, you might intercept that call of the mock and assert the invocation parameter(s).\r\n\r\nIf you aren&#39;t in a unit test, you should read back from the DB and assert its content.","title":"AssertJ combine exception catching and return type assertions","body":"<p>As the exception is caught in the method, AssertJ has no chance to see it, hence the assertion error you already experienced.</p>\n<p>Assuming you are in a unit test with a mock of the DB writer, you might intercept that call of the mock and assert the invocation parameter(s).</p>\n<p>If you aren't in a unit test, you should read back from the DB and assert its content.</p>\n"}],"owner":{"account_id":1876051,"reputation":3428,"user_id":1697245,"accept_rate":69,"display_name":"Arthur Eirich"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":38,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"accepted_answer_id":77156891,"answer_count":1,"score":0,"last_activity_date":1695379088,"creation_date":1695376836,"question_id":77156631,"body_markdown":"I have a method which catches an ```IOException``` while trying to process a JSON file and if this exception occurs ```false``` is being returned. Something like:\r\n\r\n    public boolean method(){\r\n     try{\r\n      // process json file\r\n       return true;\r\n     } catch IOException {\r\n       // write stuff into db\r\n       return false;\r\n     }\r\n    }\r\n\r\nThe catch block writes exception message to the database. So given a method with a ```boolean``` return type and exception handling how can I combine both in my unit test to assert the instance of the exception/its message and method&#39;s return value?\r\nI am aware of\r\n\r\n    Assertions.assertThatThrownBy(() -&gt; objectUnderTest.method()).isInstanceOf(IOException.class)\r\nThe above statement results in ```java.lang.AssertionError: Expecting code to raise a throwable.```\r\n\r\nand\r\n\r\n    Assertions.assertThat(objectUnderTest.method()).isFalse() // works well\r\n\r\nThanks a lot!","title":"AssertJ combine exception catching and return type assertions","body":"<p>I have a method which catches an <code>IOException</code> while trying to process a JSON file and if this exception occurs <code>false</code> is being returned. Something like:</p>\n<pre><code>public boolean method(){\n try{\n  // process json file\n   return true;\n } catch IOException {\n   // write stuff into db\n   return false;\n }\n}\n</code></pre>\n<p>The catch block writes exception message to the database. So given a method with a <code>boolean</code> return type and exception handling how can I combine both in my unit test to assert the instance of the exception/its message and method's return value?\nI am aware of</p>\n<pre><code>Assertions.assertThatThrownBy(() -&gt; objectUnderTest.method()).isInstanceOf(IOException.class)\n</code></pre>\n<p>The above statement results in <code>java.lang.AssertionError: Expecting code to raise a throwable.</code></p>\n<p>and</p>\n<pre><code>Assertions.assertThat(objectUnderTest.method()).isFalse() // works well\n</code></pre>\n<p>Thanks a lot!</p>\n"},{"tags":["java","maven","junit","intellij-idea"],"answers":[{"tags":[],"owner":{"account_id":371054,"reputation":24474,"user_id":719363,"accept_rate":75,"display_name":"Alex Gitelman"},"down_vote_count":0,"up_vote_count":16,"is_accepted":false,"score":16,"last_activity_date":1309560901,"creation_date":1309560901,"answer_id":6553956,"question_id":6553881,"body_markdown":"In you run Maven from command line, you will be able to run it with debugger enabled and just attach Idea as remote debugger. That&#39;s how I usually use it.\r\n    \r\n    mvn -Dmaven.surefire.debug=&quot;-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=8000 -Xnoagent -Djava.compiler=NONE&quot; test\r\n\r\nSee http://maven.apache.org/plugins/maven-surefire-plugin/examples/debugging.html\r\n\r\nThis will allow debugger connection to port 8000 and wait for you to attach before execution.","title":"How can I run the IntelliJ debugger on unit tests in a Maven project?","body":"<p>In you run Maven from command line, you will be able to run it with debugger enabled and just attach Idea as remote debugger. That's how I usually use it.</p>\n\n<pre><code>mvn -Dmaven.surefire.debug=\"-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=8000 -Xnoagent -Djava.compiler=NONE\" test\n</code></pre>\n\n<p>See <a href=\"http://maven.apache.org/plugins/maven-surefire-plugin/examples/debugging.html\" rel=\"noreferrer\">http://maven.apache.org/plugins/maven-surefire-plugin/examples/debugging.html</a></p>\n\n<p>This will allow debugger connection to port 8000 and wait for you to attach before execution.</p>\n"},{"tags":[],"owner":{"account_id":45002,"reputation":13531,"user_id":132374,"accept_rate":87,"display_name":"Jon Onstott"},"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1309561503,"creation_date":1309561503,"answer_id":6554013,"question_id":6553881,"body_markdown":"I wanted to run the unit tests for a specific package.\r\n\r\nI was able to get this to work by making a new JUnit run/debug configuration in IntelliJ.  I told it to run the tests in the specific package and for &quot;Use classpath and JDK of module&quot;, I picked the root Maven artifact.","title":"How can I run the IntelliJ debugger on unit tests in a Maven project?","body":"<p>I wanted to run the unit tests for a specific package.</p>\n\n<p>I was able to get this to work by making a new JUnit run/debug configuration in IntelliJ.  I told it to run the tests in the specific package and for \"Use classpath and JDK of module\", I picked the root Maven artifact.</p>\n"},{"tags":[],"owner":{"account_id":2195221,"reputation":327,"user_id":1941095,"display_name":"Suraj"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695378786,"creation_date":1695378786,"answer_id":77156855,"question_id":6553881,"body_markdown":"Try adding this to the maven command: -DforkCount=0\r\ni.e clean verify -DforkCount=0 ","title":"How can I run the IntelliJ debugger on unit tests in a Maven project?","body":"<p>Try adding this to the maven command: -DforkCount=0\ni.e clean verify -DforkCount=0</p>\n"}],"owner":{"account_id":45002,"reputation":13531,"user_id":132374,"accept_rate":87,"display_name":"Jon Onstott"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":21310,"favorite_count":0,"down_vote_count":0,"up_vote_count":10,"accepted_answer_id":6554013,"answer_count":3,"score":10,"last_activity_date":1695378786,"creation_date":1309559936,"question_id":6553881,"body_markdown":"I&#39;m working with a multi-artifact Maven project where artifacts in the project have a few dependencies on each other.  I am using IntelliJ 9.  I&#39;d like to be able to set breakpoints in my unit tests, but when I right-click on the unit tests folder for my artifact and choose &quot;Debug &#39;All Tests&#39;&quot;, I get a Class not found exception referring to a class in a separate Maven artifact.\r\n\r\nI can run the Maven &quot;test&quot; goal on the parent artifact and it works fine.\r\n\r\nAny ideas?  Thanks.","title":"How can I run the IntelliJ debugger on unit tests in a Maven project?","body":"<p>I'm working with a multi-artifact Maven project where artifacts in the project have a few dependencies on each other.  I am using IntelliJ 9.  I'd like to be able to set breakpoints in my unit tests, but when I right-click on the unit tests folder for my artifact and choose \"Debug 'All Tests'\", I get a Class not found exception referring to a class in a separate Maven artifact.</p>\n\n<p>I can run the Maven \"test\" goal on the parent artifact and it works fine.</p>\n\n<p>Any ideas?  Thanks.</p>\n"},{"tags":["java","date","datetime"],"comments":[{"owner":{"account_id":130796,"reputation":4377,"user_id":330325,"accept_rate":55,"display_name":"Buddha"},"score":0,"creation_date":1385544174,"post_id":20238280,"comment_id":30182924,"body_markdown":"what is it returning?","body":"what is it returning?"},{"owner":{"account_id":2006972,"reputation":43182,"user_id":1796579,"display_name":"Henry"},"score":5,"creation_date":1385544357,"post_id":20238280,"comment_id":30183065,"body_markdown":"UTC is not a specific date format but something like a time zone.","body":"UTC is not a specific date format but something like a time zone."},{"owner":{"account_id":130796,"reputation":4377,"user_id":330325,"accept_rate":55,"display_name":"Buddha"},"score":2,"creation_date":1385544933,"post_id":20238280,"comment_id":30183416,"body_markdown":"do you want to return what time is it in UTC time zone?","body":"do you want to return what time is it in UTC time zone?"}],"answers":[{"tags":[],"owner":{"account_id":1268721,"reputation":2821,"user_id":1225463,"accept_rate":43,"display_name":"benjamin.d"},"down_vote_count":0,"up_vote_count":13,"is_accepted":true,"score":13,"last_activity_date":1385544250,"creation_date":1385544250,"answer_id":20238366,"question_id":20238280,"body_markdown":"Try to format your date with the `Z` or `z` timezone flags:\r\n\r\n    new SimpleDateFormat(&quot;MM/dd/yyyy KK:mm:ss a Z&quot;).format(dateObj);","title":"Date in to UTC format Java","body":"<p>Try to format your date with the <code>Z</code> or <code>z</code> timezone flags:</p>\n\n<pre><code>new SimpleDateFormat(\"MM/dd/yyyy KK:mm:ss a Z\").format(dateObj);\n</code></pre>\n"},{"tags":[],"owner":{"account_id":130796,"reputation":4377,"user_id":330325,"accept_rate":55,"display_name":"Buddha"},"down_vote_count":0,"up_vote_count":34,"is_accepted":false,"score":34,"last_activity_date":1519550141,"creation_date":1385544649,"answer_id":20238531,"question_id":20238280,"body_markdown":"Try this... Worked for me and printed `10/22/2013 01:37:56 AM` Ofcourse this is your code only with little modifications.\r\n\r\n    final SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&#39;T&#39;HH:mm:ss&quot;);\r\n    sdf.setTimeZone(TimeZone.getTimeZone(&quot;UTC&quot;));   // This line converts the given date into UTC time zone\r\n    final java.util.Date dateObj = sdf.parse(&quot;2013-10-22T01:37:56&quot;);\r\n\r\n    aRevisedDate = new SimpleDateFormat(&quot;MM/dd/yyyy KK:mm:ss a&quot;).format(dateObj);\r\n    System.out.println(aRevisedDate);\r\n\r\n    ","title":"Date in to UTC format Java","body":"<p>Try this... Worked for me and printed <code>10/22/2013 01:37:56 AM</code> Ofcourse this is your code only with little modifications.</p>\n\n<pre><code>final SimpleDateFormat sdf = new SimpleDateFormat(\"yyyy-MM-dd'T'HH:mm:ss\");\nsdf.setTimeZone(TimeZone.getTimeZone(\"UTC\"));   // This line converts the given date into UTC time zone\nfinal java.util.Date dateObj = sdf.parse(\"2013-10-22T01:37:56\");\n\naRevisedDate = new SimpleDateFormat(\"MM/dd/yyyy KK:mm:ss a\").format(dateObj);\nSystem.out.println(aRevisedDate);\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1290209,"reputation":994,"user_id":1242461,"display_name":"stan"},"down_vote_count":1,"up_vote_count":11,"is_accepted":false,"score":10,"last_activity_date":1385545088,"creation_date":1385545088,"answer_id":20238698,"question_id":20238280,"body_markdown":"    SimpleDateFormat sdf = new SimpleDateFormat( &quot;yyyy-MM-dd HH:mm:ss&quot; );\r\n    // or SimpleDateFormat sdf = new SimpleDateFormat( &quot;MM/dd/yyyy KK:mm:ss a Z&quot; );\r\n    sdf.setTimeZone( TimeZone.getTimeZone( &quot;UTC&quot; ) );\r\n    System.out.println( sdf.format( new Date() ) );","title":"Date in to UTC format Java","body":"<pre><code>SimpleDateFormat sdf = new SimpleDateFormat( \"yyyy-MM-dd HH:mm:ss\" );\n// or SimpleDateFormat sdf = new SimpleDateFormat( \"MM/dd/yyyy KK:mm:ss a Z\" );\nsdf.setTimeZone( TimeZone.getTimeZone( \"UTC\" ) );\nSystem.out.println( sdf.format( new Date() ) );\n</code></pre>\n"},{"tags":[],"owner":{"account_id":322981,"reputation":310745,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"down_vote_count":0,"up_vote_count":8,"is_accepted":false,"score":8,"last_activity_date":1403503535,"creation_date":1403465711,"answer_id":24354957,"question_id":20238280,"body_markdown":"# What Time Zones?\n\nNo where in your question do you mention [time zone][1]. What time zone is implied that input string? What time zone do you want for your output? And, [UTC][2] is a time zone (or lack thereof depending on your mindset) *not a string format*.\n\n# ISO 8601\n\nYour input string is in [ISO 8601][3] format, except that it lacks an [offset from UTC][4]. \n\n# Joda-Time\n\nHere is some example code in [Joda-Time][5] 2.3 to show you how to handle time zones. Joda-Time has built-in default [formatters][6] for parsing and generating String representations of date-time values.\n\n    String input = &quot;2013-10-22T01:37:56&quot;;\n    DateTime dateTimeUtc = new DateTime( input, DateTimeZone.UTC );\n    DateTime dateTimeMontr&#233;al = dateTimeUtc.withZone( DateTimeZone.forID( &quot;America/Montreal&quot; );\n    String output = dateTimeMontr&#233;al.toString();\n\n\nAs for generating string representations in other formats, search StackOverflow for &quot;Joda format&quot;.\n\n\n  [1]: http://en.wikipedia.org/wiki/List_of_tz_database_time_zones\n  [2]: http://en.wikipedia.org/wiki/Coordinated_Universal_Time\n  [3]: http://en.wikipedia.org/wiki/ISO_8601\n  [4]: http://en.wikipedia.org/wiki/ISO_8601#Time_offsets_from_UTC\n  [5]: http://www.joda.org/joda-time/\n  [6]: http://www.joda.org/joda-time/apidocs/org/joda/time/format/DateTimeFormatter.html","title":"Date in to UTC format Java","body":"<h1>What Time Zones?</h1>\n<p>No where in your question do you mention <a href=\"http://en.wikipedia.org/wiki/List_of_tz_database_time_zones\" rel=\"noreferrer\">time zone</a>. What time zone is implied that input string? What time zone do you want for your output? And, <a href=\"http://en.wikipedia.org/wiki/Coordinated_Universal_Time\" rel=\"noreferrer\">UTC</a> is a time zone (or lack thereof depending on your mindset) <em>not a string format</em>.</p>\n<h1>ISO 8601</h1>\n<p>Your input string is in <a href=\"http://en.wikipedia.org/wiki/ISO_8601\" rel=\"noreferrer\">ISO 8601</a> format, except that it lacks an <a href=\"http://en.wikipedia.org/wiki/ISO_8601#Time_offsets_from_UTC\" rel=\"noreferrer\">offset from UTC</a>.</p>\n<h1>Joda-Time</h1>\n<p>Here is some example code in <a href=\"http://www.joda.org/joda-time/\" rel=\"noreferrer\">Joda-Time</a> 2.3 to show you how to handle time zones. Joda-Time has built-in default <a href=\"http://www.joda.org/joda-time/apidocs/org/joda/time/format/DateTimeFormatter.html\" rel=\"noreferrer\">formatters</a> for parsing and generating String representations of date-time values.</p>\n<pre><code>String input = &quot;2013-10-22T01:37:56&quot;;\nDateTime dateTimeUtc = new DateTime( input, DateTimeZone.UTC );\nDateTime dateTimeMontral = dateTimeUtc.withZone( DateTimeZone.forID( &quot;America/Montreal&quot; );\nString output = dateTimeMontral.toString();\n</code></pre>\n<p>As for generating string representations in other formats, search StackOverflow for &quot;Joda format&quot;.</p>\n"},{"tags":[],"owner":{"account_id":7612423,"reputation":82486,"user_id":5772882,"display_name":"Anonymous"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1572188558,"creation_date":1572187424,"answer_id":58580395,"question_id":20238280,"body_markdown":"## java.time\r\n\r\nIts about time someone provides the modern answer. The modern solution uses java.time, the modern Java date and time API. The classes `SimpleDateFormat` and `Date` used in the question and in a couple of the other answers are poorly designed and long outdated, the former in particular notoriously troublesome. `TimeZone` is poorly designed to. I recommend you avoid those.\r\n\r\n\t\tZoneId utc = ZoneId.of(&quot;Etc/UTC&quot;);\r\n\t\tDateTimeFormatter targetFormatter = DateTimeFormatter.ofPattern(\r\n\t\t\t\t&quot;MM/dd/yyyy hh:mm:ss a zzz&quot;, Locale.ENGLISH);\r\n\t\t\r\n\t\tString itsAlarmDttm = &quot;2013-10-22T01:37:56&quot;;\r\n\t\tZonedDateTime utcDateTime = LocalDateTime.parse(itsAlarmDttm)\r\n\t\t\t\t.atZone(ZoneId.systemDefault())\r\n\t\t\t\t.withZoneSameInstant(utc);\r\n\t\tString formatterUtcDateTime = utcDateTime.format(targetFormatter);\r\n\t\tSystem.out.println(formatterUtcDateTime);\r\n\r\nWhen running in my time zone, Europe/Copenhagen, the output is:\r\n\r\n&gt; 10/21/2013 11:37:56 PM UTC\r\n\r\nI have assumed that the string you got was in the default time zone of your JVM, a fragile assumption since that default setting can be changed at any time from another part of your program or another programming running in the same JVM. If you can, instead specify time zone explicitly, for example `ZoneId.of(&quot;Europe/Podgorica&quot;)` or `ZoneId.of(&quot;Asia/Kolkata&quot;)`.\r\n\r\nI am exploiting the fact that you string is in ISO 8601 format, the format the the modern classes parse as their default, that is, without any explicit formatter.\r\n\r\nI am using a `ZonedDateTime` for the result date-time because it allows us to format it with `UTC` in the formatted string to eliminate any and all doubt. For other purposes one would typically have wanted an `OffsetDateTime` or an `Instant` instead.\r\n\r\n## Links\r\n\r\n - [Oracle tutorial: Date Time](https://docs.oracle.com/javase/tutorial/datetime/) explaining how to use java.time.\r\n - [Wikipedia article: ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)\r\n","title":"Date in to UTC format Java","body":"<h2>java.time</h2>\n\n<p>Its about time someone provides the modern answer. The modern solution uses java.time, the modern Java date and time API. The classes <code>SimpleDateFormat</code> and <code>Date</code> used in the question and in a couple of the other answers are poorly designed and long outdated, the former in particular notoriously troublesome. <code>TimeZone</code> is poorly designed to. I recommend you avoid those.</p>\n\n<pre><code>    ZoneId utc = ZoneId.of(\"Etc/UTC\");\n    DateTimeFormatter targetFormatter = DateTimeFormatter.ofPattern(\n            \"MM/dd/yyyy hh:mm:ss a zzz\", Locale.ENGLISH);\n\n    String itsAlarmDttm = \"2013-10-22T01:37:56\";\n    ZonedDateTime utcDateTime = LocalDateTime.parse(itsAlarmDttm)\n            .atZone(ZoneId.systemDefault())\n            .withZoneSameInstant(utc);\n    String formatterUtcDateTime = utcDateTime.format(targetFormatter);\n    System.out.println(formatterUtcDateTime);\n</code></pre>\n\n<p>When running in my time zone, Europe/Copenhagen, the output is:</p>\n\n<blockquote>\n  <p>10/21/2013 11:37:56 PM UTC</p>\n</blockquote>\n\n<p>I have assumed that the string you got was in the default time zone of your JVM, a fragile assumption since that default setting can be changed at any time from another part of your program or another programming running in the same JVM. If you can, instead specify time zone explicitly, for example <code>ZoneId.of(\"Europe/Podgorica\")</code> or <code>ZoneId.of(\"Asia/Kolkata\")</code>.</p>\n\n<p>I am exploiting the fact that you string is in ISO 8601 format, the format the the modern classes parse as their default, that is, without any explicit formatter.</p>\n\n<p>I am using a <code>ZonedDateTime</code> for the result date-time because it allows us to format it with <code>UTC</code> in the formatted string to eliminate any and all doubt. For other purposes one would typically have wanted an <code>OffsetDateTime</code> or an <code>Instant</code> instead.</p>\n\n<h2>Links</h2>\n\n<ul>\n<li><a href=\"https://docs.oracle.com/javase/tutorial/datetime/\" rel=\"nofollow noreferrer\">Oracle tutorial: Date Time</a> explaining how to use java.time.</li>\n<li><a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow noreferrer\">Wikipedia article: ISO 8601</a></li>\n</ul>\n"}],"owner":{"account_id":1815974,"reputation":1458,"user_id":1651042,"accept_rate":50,"display_name":"MadTech"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":163261,"favorite_count":0,"down_vote_count":1,"up_vote_count":22,"accepted_answer_id":20238366,"answer_count":5,"score":21,"last_activity_date":1695378701,"creation_date":1385544029,"question_id":20238280,"body_markdown":"I have a string like this `2013-10-22T01:37:56`. I Need to change this string into UTC Date format like this `MM/dd/yyyy KK:mm:ss a`. I have tried some code but it is not returning the UTC datetime.\r\n\r\nMy code is\r\n\r\n            String[] time = itsAlarmDttm.split(&quot;T&quot;);\r\n    \t\tString aFormatDate = time[0]+ &quot; &quot;+time[1];\r\n    \t\tString aRevisedDate = null;\r\n    \t\ttry {\r\n    \t\t    final SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);\r\n    \t\t    final Date dateObj = sdf.parse(aFormatDate);\r\n    \t\t    aRevisedDate = new SimpleDateFormat(&quot;MM/dd/yyyy KK:mm:ss a&quot;).format(dateObj);\r\n    \t\t    System.out.println(aRevisedDate);\r\n    \t\t} catch (ParseException e) {\r\n    \t\t    itsLogger.error(&quot;Error occured in Parsing the Data Time Object:  &quot; +e.getMessage());\r\n    \t\t} catch (Exception e) {\r\n    \t\t\titsLogger.error(&quot;Error occured in Data Time Objecct:  &quot; +e.getMessage());\r\n    \t\t}\r\n\r\n\r\nI am getting the output is `MM/dd/yyyy KK:mm:ss a` format. But Not UTC time format.\r\nHow to solve this issue?","title":"Date in to UTC format Java","body":"<p>I have a string like this <code>2013-10-22T01:37:56</code>. I Need to change this string into UTC Date format like this <code>MM/dd/yyyy KK:mm:ss a</code>. I have tried some code but it is not returning the UTC datetime.</p>\n\n<p>My code is</p>\n\n<pre><code>        String[] time = itsAlarmDttm.split(\"T\");\n        String aFormatDate = time[0]+ \" \"+time[1];\n        String aRevisedDate = null;\n        try {\n            final SimpleDateFormat sdf = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");\n            final Date dateObj = sdf.parse(aFormatDate);\n            aRevisedDate = new SimpleDateFormat(\"MM/dd/yyyy KK:mm:ss a\").format(dateObj);\n            System.out.println(aRevisedDate);\n        } catch (ParseException e) {\n            itsLogger.error(\"Error occured in Parsing the Data Time Object:  \" +e.getMessage());\n        } catch (Exception e) {\n            itsLogger.error(\"Error occured in Data Time Objecct:  \" +e.getMessage());\n        }\n</code></pre>\n\n<p>I am getting the output is <code>MM/dd/yyyy KK:mm:ss a</code> format. But Not UTC time format.\nHow to solve this issue?</p>\n"},{"tags":["java","amazon-web-services","amazon-quicksight"],"owner":{"account_id":29423450,"reputation":11,"user_id":22544725,"display_name":"Ilyasse hanafi"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":28,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":0,"score":0,"last_activity_date":1695378409,"creation_date":1695378373,"question_id":77156807,"body_markdown":"I am trying to update a DataSet using JAVA code in a JUNIT test class.\r\nI get the dataSet updated except the attribute &quot;dataSetUsageConfiguration&quot;.\r\nI wonder if there is a condition/ limitation while updating dataSets on quicksight.\r\nHere&#39;s My code :\r\n\r\n    `@Test\r\n    public void ModifyDataSet() {\r\n        List&lt;InputColumn&gt; inputColumns = new ArrayList&lt;&gt;();\r\n        List&lt;TransformOperation&gt; dataTransforms = new ArrayList&lt;&gt;();\r\n        Map&lt;String, PhysicalTable&gt; physicalTableMap = new HashMap&lt;&gt;();\r\n        Map&lt;String, LogicalTable&gt; logicalTableMap = new HashMap&lt;&gt;();\r\n        inputColumns.add(InputColumn.builder().name(&quot;id&quot;).type(&quot;STRING&quot;).build());\r\n        dataTransforms.add(TransformOperation\r\n            .builder()\r\n            .projectOperation(\r\n                ProjectOperation\r\n                    .builder()\r\n                    .projectedColumns(&quot;id&quot;).build()).build());\r\n        physicalTableMap\r\n            .put(\r\n                &quot;KEY&quot;,\r\n                PhysicalTable\r\n                    .builder()\r\n                    .relationalTable(\r\n                        RelationalTable\r\n                            .builder()\r\n                            .dataSourceArn(\r\n                                &quot;my_data_source_ARN&quot;)\r\n                            .schema(&quot;my_schema&quot;).name(&quot;name&quot;)\r\n                            .inputColumns(inputColumns).build()).build());\r\n        logicalTableMap.put(\r\n            &quot;key&quot;,\r\n            LogicalTable\r\n                .builder()\r\n                .alias(&quot;alias&quot;)\r\n                .dataTransforms(dataTransforms)\r\n                .source(\r\n                    LogicalTableSource.builder()\r\n                        .physicalTableId(&quot;physicalTableID&quot;).build()).build());\r\n        // the attribute doesn&#39;t get updated (except when we change it through the quicksight interface )\r\n        DataSetUsageConfiguration dataSetUsageConfig =\r\n            DataSetUsageConfiguration.builder().disableUseAsImportedSource(true)\r\n                .disableUseAsDirectQuerySource(true).build();\r\n\r\n        UpdateDataSetRequest updateDataSetRequest =\r\n            UpdateDataSetRequest.builder().awsAccountId(&quot;awsAccountId&quot;)\r\n                .dataSetId(&quot;dataSetId&quot;)\r\n                .physicalTableMap(physicalTableMap).logicalTableMap(logicalTableMap)\r\n                .dataSetUsageConfiguration(dataSetUsageConfig).name(&quot;name&quot;)\r\n                .importMode(&quot;importMode&quot;).build();\r\n        UpdateDataSetResponse response = this.quickSightClient.updateDataSet(updateDataSetRequest);\r\n\r\n        DescribeDataSetResponse reponse =\r\n            this.quickSightClient.describeDataSet(DescribeDataSetRequest.builder()\r\n                .awsAccountId(&quot;awsAccountId&quot;).dataSetId(&quot;dataSetId&quot;)\r\n                .build());\r\n        \r\n        Assert.assertEquals(reponse.dataSet().name(), &quot;name&quot;);\r\n        Assert.assertTrue(reponse.dataSet().dataSetUsageConfiguration()\r\n        .disableUseAsDirectQuerySource());\r\n        Assert.assertTrue(reponse.dataSet().dataSetUsageConfiguration()\r\n        .disableUseAsImportedSource());`\r\n\r\n\r\n\r\n\r\nThe test class fails since the Assert is wrong.\r\nI also tested that using the cli and the same issue.\r\ni only get to update this parameter when im using the quicksight interface.","title":"Amazon Quicksight API UpdateDataSet doesn&#39;t update the attribute DataSetUsageConfiguration","body":"<p>I am trying to update a DataSet using JAVA code in a JUNIT test class.\nI get the dataSet updated except the attribute &quot;dataSetUsageConfiguration&quot;.\nI wonder if there is a condition/ limitation while updating dataSets on quicksight.\nHere's My code :</p>\n<pre><code>`@Test\npublic void ModifyDataSet() {\n    List&lt;InputColumn&gt; inputColumns = new ArrayList&lt;&gt;();\n    List&lt;TransformOperation&gt; dataTransforms = new ArrayList&lt;&gt;();\n    Map&lt;String, PhysicalTable&gt; physicalTableMap = new HashMap&lt;&gt;();\n    Map&lt;String, LogicalTable&gt; logicalTableMap = new HashMap&lt;&gt;();\n    inputColumns.add(InputColumn.builder().name(&quot;id&quot;).type(&quot;STRING&quot;).build());\n    dataTransforms.add(TransformOperation\n        .builder()\n        .projectOperation(\n            ProjectOperation\n                .builder()\n                .projectedColumns(&quot;id&quot;).build()).build());\n    physicalTableMap\n        .put(\n            &quot;KEY&quot;,\n            PhysicalTable\n                .builder()\n                .relationalTable(\n                    RelationalTable\n                        .builder()\n                        .dataSourceArn(\n                            &quot;my_data_source_ARN&quot;)\n                        .schema(&quot;my_schema&quot;).name(&quot;name&quot;)\n                        .inputColumns(inputColumns).build()).build());\n    logicalTableMap.put(\n        &quot;key&quot;,\n        LogicalTable\n            .builder()\n            .alias(&quot;alias&quot;)\n            .dataTransforms(dataTransforms)\n            .source(\n                LogicalTableSource.builder()\n                    .physicalTableId(&quot;physicalTableID&quot;).build()).build());\n    // the attribute doesn't get updated (except when we change it through the quicksight interface )\n    DataSetUsageConfiguration dataSetUsageConfig =\n        DataSetUsageConfiguration.builder().disableUseAsImportedSource(true)\n            .disableUseAsDirectQuerySource(true).build();\n\n    UpdateDataSetRequest updateDataSetRequest =\n        UpdateDataSetRequest.builder().awsAccountId(&quot;awsAccountId&quot;)\n            .dataSetId(&quot;dataSetId&quot;)\n            .physicalTableMap(physicalTableMap).logicalTableMap(logicalTableMap)\n            .dataSetUsageConfiguration(dataSetUsageConfig).name(&quot;name&quot;)\n            .importMode(&quot;importMode&quot;).build();\n    UpdateDataSetResponse response = this.quickSightClient.updateDataSet(updateDataSetRequest);\n\n    DescribeDataSetResponse reponse =\n        this.quickSightClient.describeDataSet(DescribeDataSetRequest.builder()\n            .awsAccountId(&quot;awsAccountId&quot;).dataSetId(&quot;dataSetId&quot;)\n            .build());\n    \n    Assert.assertEquals(reponse.dataSet().name(), &quot;name&quot;);\n    Assert.assertTrue(reponse.dataSet().dataSetUsageConfiguration()\n    .disableUseAsDirectQuerySource());\n    Assert.assertTrue(reponse.dataSet().dataSetUsageConfiguration()\n    .disableUseAsImportedSource());`\n</code></pre>\n<p>The test class fails since the Assert is wrong.\nI also tested that using the cli and the same issue.\ni only get to update this parameter when im using the quicksight interface.</p>\n"},{"tags":["java","spring","hibernate","hikaricp","dialect"],"comments":[{"owner":{"account_id":11884699,"reputation":497,"user_id":8697412,"display_name":"Barracuda"},"score":0,"creation_date":1632759014,"post_id":69349713,"comment_id":122574141,"body_markdown":"What do you mean by multitenant code?","body":"What do you mean by multitenant code?"},{"owner":{"account_id":19670476,"reputation":207,"user_id":14399829,"display_name":"effedici"},"score":0,"creation_date":1632759576,"post_id":69349713,"comment_id":122574354,"body_markdown":"I have an all-in-one architecture: the same instance of the software and the same MySQL can be used with different tenants.\nEach tenant is identified by an input parameter which is mapped with a set of configurations (e.g.: the credentials and URL of the tenant&#39;s DB).\nEach tenant can be used to connect only to its DB (but all tenants are on the same instance of MySQL.\n\nIn the future, I would like to have one tenant on MySQL, one on PostgresSQL, and one on SQL server but all inside the same instance of the software.","body":"I have an all-in-one architecture: the same instance of the software and the same MySQL can be used with different tenants. Each tenant is identified by an input parameter which is mapped with a set of configurations (e.g.: the credentials and URL of the tenant&#39;s DB). Each tenant can be used to connect only to its DB (but all tenants are on the same instance of MySQL.  In the future, I would like to have one tenant on MySQL, one on PostgresSQL, and one on SQL server but all inside the same instance of the software."},{"owner":{"account_id":11884699,"reputation":497,"user_id":8697412,"display_name":"Barracuda"},"score":0,"creation_date":1632766875,"post_id":69349713,"comment_id":122577063,"body_markdown":"sorry , it&#39;s still hard for me to grasp my head around multitenant code. Maybe you need to put a dialect inside a properties file, add this properties file as a property source to the spring&#39;s environment abstraction and then use PropertySourcesPlaceholderConfigurer in combination with Value annotation inside your configuration class to set appropriate dialect. Then for each tenant you would have a different properties file.","body":"sorry , it&#39;s still hard for me to grasp my head around multitenant code. Maybe you need to put a dialect inside a properties file, add this properties file as a property source to the spring&#39;s environment abstraction and then use PropertySourcesPlaceholderConfigurer in combination with Value annotation inside your configuration class to set appropriate dialect. Then for each tenant you would have a different properties file."},{"owner":{"account_id":19670476,"reputation":207,"user_id":14399829,"display_name":"effedici"},"score":0,"creation_date":1632827580,"post_id":69349713,"comment_id":122593288,"body_markdown":"I do not understand...how can I set dynamically the dialect?\nHow can the same instance of the software switch from one to the other?","body":"I do not understand...how can I set dynamically the dialect? How can the same instance of the software switch from one to the other?"},{"owner":{"account_id":11884699,"reputation":497,"user_id":8697412,"display_name":"Barracuda"},"score":0,"creation_date":1632836744,"post_id":69349713,"comment_id":122597592,"body_markdown":"when in your program do you have a need to change dialect? If your program works with multiple databases at the same time, then maybe you can declare EntityManager for each with a different dialect.","body":"when in your program do you have a need to change dialect? If your program works with multiple databases at the same time, then maybe you can declare EntityManager for each with a different dialect."},{"owner":{"account_id":19670476,"reputation":207,"user_id":14399829,"display_name":"effedici"},"score":0,"creation_date":1632838266,"post_id":69349713,"comment_id":122598405,"body_markdown":"yes, I agree.\nWhat I do not understand is how can I tell when using one EntityManager (MySQL) and when the other one (Postgres or MsSQL).\n\nI was looking to this [solution](https://stackoverflow.com/questions/60796798/dynamically-set-hibernate-dialect-properties-in-spring-boot)\nbut is a little bit different because it discriminates the entities (each entity has its own DB) in my case all entities are on all DBs. Is the tenant that discriminate.","body":"yes, I agree. What I do not understand is how can I tell when using one EntityManager (MySQL) and when the other one (Postgres or MsSQL).  I was looking to this <a href=\"https://stackoverflow.com/questions/60796798/dynamically-set-hibernate-dialect-properties-in-spring-boot\">solution</a> but is a little bit different because it discriminates the entities (each entity has its own DB) in my case all entities are on all DBs. Is the tenant that discriminate."},{"owner":{"account_id":11884699,"reputation":497,"user_id":8697412,"display_name":"Barracuda"},"score":0,"creation_date":1632839417,"post_id":69349713,"comment_id":122598991,"body_markdown":"sorry, I can&#39;t really think something. To be honest , I still don&#39;t quite understand that meaning of tenant and what it means in your case: do you have multiple, let&#39;s say, web applications instances that each uses different dialect or inside your application do you have multiple services/layers that each use different dialect?","body":"sorry, I can&#39;t really think something. To be honest , I still don&#39;t quite understand that meaning of tenant and what it means in your case: do you have multiple, let&#39;s say, web applications instances that each uses different dialect or inside your application do you have multiple services/layers that each use different dialect?"},{"owner":{"account_id":19670476,"reputation":207,"user_id":14399829,"display_name":"effedici"},"score":0,"creation_date":1632839882,"post_id":69349713,"comment_id":122599248,"body_markdown":"I have one instance that should be able to connect to different dialects to execute the operations.\n\nSee the &quot;tenant&quot; as an input token that identifies the DB to be used for the operation (and classifies the users). If is tenant=A &gt; go to MySQL, if is tenant=B &gt; to to MsSQL, etc.\n\n All DBs have the same tables but with different data inside: people of tenant A cannot see the data of people of tenant B.","body":"I have one instance that should be able to connect to different dialects to execute the operations.  See the &quot;tenant&quot; as an input token that identifies the DB to be used for the operation (and classifies the users). If is tenant=A &gt; go to MySQL, if is tenant=B &gt; to to MsSQL, etc.   All DBs have the same tables but with different data inside: people of tenant A cannot see the data of people of tenant B."},{"owner":{"account_id":19670476,"reputation":207,"user_id":14399829,"display_name":"effedici"},"score":0,"creation_date":1632840273,"post_id":69349713,"comment_id":122599454,"body_markdown":"@Barracuda I&#39;ve tried to declare an entity EntityManager for each dialect but it fails with &quot;expected single matching bean but found 2&quot; (see the main message per further details)","body":"@Barracuda I&#39;ve tried to declare an entity EntityManager for each dialect but it fails with &quot;expected single matching bean but found 2&quot; (see the main message per further details)"},{"owner":{"account_id":11884699,"reputation":497,"user_id":8697412,"display_name":"Barracuda"},"score":0,"creation_date":1632840367,"post_id":69349713,"comment_id":122599505,"body_markdown":"Maybe you can declare your classes to use a Map&lt;String,EntityManager&gt; where map keys are going to be the tokens you are taking about.","body":"Maybe you can declare your classes to use a Map&lt;String,EntityManager&gt; where map keys are going to be the tokens you are taking about."},{"owner":{"account_id":11884699,"reputation":497,"user_id":8697412,"display_name":"Barracuda"},"score":0,"creation_date":1632840453,"post_id":69349713,"comment_id":122599560,"body_markdown":"Or, if you don&#39;t want to change your services to use maps, declare some other type of Map with services as values, for example.","body":"Or, if you don&#39;t want to change your services to use maps, declare some other type of Map with services as values, for example."}],"answers":[{"tags":[],"owner":{"account_id":179640,"reputation":15442,"user_id":412446,"accept_rate":41,"display_name":"Christian Beikov"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1634189870,"creation_date":1634189870,"answer_id":69565562,"question_id":69349713,"body_markdown":"That&#39;s not really possible as the dialect affects certain quoting rules etc. which you can&#39;t just &quot;swap out&quot; at runtime based on a tenant identifier. Just create two persistence units, each pointing to a different data source for every database type. You will have to somehow lookup the appropriate `EntityManager`/`EntityManagerFactory` based on your tenant identifier which makes it a bit harder when you want to use Spring Data JPA as that requires a compilation static name reference for the entity manager factory. Maybe you can create a custom `EntityManagerFactory` that delegates all method calls to the appropriate instance based on the tenant identifier. Overall, this is not so easy and you will probably have to do a lot of trial and error.\r\n\r\nIMO it would be better to have a separate application deployment with separate configuration if possible per database type.","title":"Dynamic dialect with Hibernate and Hikari","body":"<p>That's not really possible as the dialect affects certain quoting rules etc. which you can't just &quot;swap out&quot; at runtime based on a tenant identifier. Just create two persistence units, each pointing to a different data source for every database type. You will have to somehow lookup the appropriate <code>EntityManager</code>/<code>EntityManagerFactory</code> based on your tenant identifier which makes it a bit harder when you want to use Spring Data JPA as that requires a compilation static name reference for the entity manager factory. Maybe you can create a custom <code>EntityManagerFactory</code> that delegates all method calls to the appropriate instance based on the tenant identifier. Overall, this is not so easy and you will probably have to do a lot of trial and error.</p>\n<p>IMO it would be better to have a separate application deployment with separate configuration if possible per database type.</p>\n"},{"tags":[],"owner":{"account_id":24309347,"reputation":11,"user_id":18251625,"display_name":"Tsvetelin Yakimov"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1645267109,"creation_date":1645267109,"answer_id":71184162,"question_id":69349713,"body_markdown":"I finally managed to find a solution for this problem.\r\nI managed to get around the problem with the dialects by having an entity manager factory for each dialect (in this case MySQL, Postgres and MS SQL Server).\r\n\r\nCreate a bean for EntityManagerFactory and return a proxy of that interface and in the handler, based on your logic, you can switch which emf to use to suit the used data source.\r\n\r\nI have created a video for this because it seems like there is no documentation online.\r\n\r\n[Session Scoped Connection][1]\r\n\r\n\r\n  [1]: https://www.youtube.com/watch?v=mcHoaPIiL6w\r\n\r\nIt is pretty similar to what you&#39;re trying to achieve but in my case the users are providing the credentials, so it&#39;s even more complicated.","title":"Dynamic dialect with Hibernate and Hikari","body":"<p>I finally managed to find a solution for this problem.\nI managed to get around the problem with the dialects by having an entity manager factory for each dialect (in this case MySQL, Postgres and MS SQL Server).</p>\n<p>Create a bean for EntityManagerFactory and return a proxy of that interface and in the handler, based on your logic, you can switch which emf to use to suit the used data source.</p>\n<p>I have created a video for this because it seems like there is no documentation online.</p>\n<p><a href=\"https://www.youtube.com/watch?v=mcHoaPIiL6w\" rel=\"nofollow noreferrer\">Session Scoped Connection</a></p>\n<p>It is pretty similar to what you're trying to achieve but in my case the users are providing the credentials, so it's even more complicated.</p>\n"},{"tags":[],"owner":{"account_id":1000532,"reputation":956,"user_id":1015482,"accept_rate":70,"display_name":"regisxp"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695378210,"creation_date":1695378210,"answer_id":77156787,"question_id":69349713,"body_markdown":"@Tsvetelin answer pointed me on the right direction, but, after applying it, I started having problems with another libs, like Hazelcast that was being user as second level cache.\r\n\r\nSo, this is what I did:\r\n\r\n1) Instead of creating a `EntityManagerFactory` bean, I created a `LocalContainerEntityManagerFactoryBean` that instantiates a `DynamicTenantEntityManagerFactoryBean`.\r\n\r\n        @Bean\r\n        public LocalContainerEntityManagerFactoryBean entityManagerFactory() {\r\n        \r\n            DynamicTenantEntityManagerFactoryBean em = new DynamicTenantEntityManagerFactoryBean();\r\n            em.setPackagesToScan(getPackagesToScan());\r\n            em.setJpaProperties(additionalProperties());\r\n            em.setJpaVendorAdapter(new HibernateJpaVendorAdapter());\r\n            return em;\r\n        \r\n        }\r\n\r\n`getPackagesToScan()` and `additionalProperties()` are functions that reads the parameters that was set by Spring Boot on the application context.\r\n        \r\n    \r\n    private String[] getPackagesToScan() {\r\n\r\n        //Check if the defaults packagesToScan needs to be overrided\r\n        String[] packagesToScan = dynamicTenantRoutingPropertiesConfig.getPackagesToScan();\r\n\r\n        if (packagesToScan == null) {\r\n\r\n            List&lt;String&gt; packageNames = EntityScanPackages.get(context).getPackageNames();\r\n            if (packageNames.isEmpty() &amp;&amp; AutoConfigurationPackages.has(context)) {\r\n                packageNames = AutoConfigurationPackages.get(context);\r\n            }\r\n\r\n            packagesToScan = packageNames.toArray(new String[0]);\r\n\r\n        }\r\n\r\n        return packagesToScan;\r\n\r\n    }\r\n\r\n    private Properties additionalProperties() {\r\n        \r\n        //jpaProperties is an Autowired bean of type \r\n        //org.springframework.boot.autoconfigure.orm.jpa.JpaProperties\r\n\r\n        final Properties properties = new Properties();\r\n        properties.putAll(jpaProperties.getProperties());\r\n        return properties;\r\n    }\r\n\r\n\r\n\r\n\r\n`DynamicTenantEntityManagerFactoryBean` extends `LocalContainerEntityManagerFactoryBean` and overrides `createNativeEntityManagerFactory()`, using the same technique as @tsvetelin-yakimov\r\n\r\n    @Log4j2\r\n    @Configurable\r\n    public class DynamicTenantEntityManagerFactoryBean extends LocalContainerEntityManagerFactoryBean {\r\n\r\n        @Autowired\r\n        private ApplicationContext context;\r\n\r\n        @PostConstruct\r\n        public void postConstruct() {\r\n\r\n            //Obtem a referencia para o Datasource\r\n            AbstractDynamicTenantRoutingDataSource dataSource\r\n                    = context.getBean(AbstractDynamicTenantRoutingDataSource.class);\r\n\r\n            //Define o Datasource\r\n            this.setDataSource(dataSource);\r\n\r\n        }\r\n\r\n\r\n        @Override\r\n        protected EntityManagerFactory createNativeEntityManagerFactory() throws PersistenceException {\r\n\r\n            log.info(&quot;(DynamicTenantEntityManagerFactory): Iniciando Proxy...&quot;);\r\n            final int hashcode = UUID.randomUUID().toString().hashCode();\r\n            final Map&lt;String, EntityManagerFactory&gt; entityManagerFactoryMap = new HashMap&lt;&gt;();\r\n\r\n\r\n            Object emf = Proxy.newProxyInstance(\r\n                    Thread.currentThread().getContextClassLoader(),\r\n                    new Class[]{SessionFactory.class},\r\n                    (proxy, method, args) -&gt; {\r\n\r\n                        if (method.getName().equals(&quot;hashCode&quot;)) {\r\n                            return hashcode;\r\n                        }\r\n\r\n                        if (method.getName().equals(&quot;equals&quot;)) {\r\n                            return proxy == args[0];\r\n                        }\r\n\r\n                        //Verifica se o DataSource esta preenchido\r\n                        if (this.getDataSource() == null)\r\n                            throw new PersistenceException(&quot;O DataSource n&#227;o pode ser nulo&quot;);\r\n\r\n                        //Verifica se ja temos o EntityManager para esse Datasource\r\n                        String currentDriver = ((AbstractDynamicTenantRoutingDataSource) this.getDataSource()).resolveCurrentDriver();\r\n                        EntityManagerFactory instance = entityManagerFactoryMap.get(currentDriver);\r\n\r\n                        if (instance == null) {\r\n\r\n                            //Obtem o dialeto\r\n                            Dialect dialect = ((AbstractDynamicTenantRoutingDataSource) this.getDataSource()).resolveDialect(currentDriver);\r\n\r\n                            log.info(\r\n                                    &quot;(DynamicTenantEntityManagerFactory): Iniciando EntityManagerFactory para Driver {} Dialeto {}...&quot;,\r\n                                    currentDriver,\r\n                                    dialect\r\n                            );\r\n\r\n                            instance = this.createEntityManagerFactory(\r\n                                    dialect\r\n                            );\r\n\r\n                            entityManagerFactoryMap.put(\r\n                                    currentDriver,\r\n                                    instance\r\n                            );\r\n\r\n                        }\r\n\r\n                        log.debug(\r\n                                &quot;(DynamicTenantEntityManagerFactory): Retornando EntityManagerFactory para Driver {}...&quot;,\r\n                                currentDriver\r\n                        );\r\n                        return method.invoke(instance);\r\n\r\n                    }\r\n            );\r\n\r\n            log.info(&quot;(DynamicTenantEntityManagerFactory): Iniciando Proxy... Concluido!&quot;);\r\n            return (SessionFactory) emf;\r\n\r\n        }\r\n\r\n        private EntityManagerFactory createEntityManagerFactory(Dialect dialect) {\r\n\r\n            EntityManagerFactory factory = super.createNativeEntityManagerFactory();\r\n            factory\r\n                    .getProperties()\r\n                    .put(&quot;hibernate.dialect&quot;, dialect.getClass().getName());\r\n\r\n            return factory;\r\n\r\n        }\r\n\r\n    }\r\n\r\n","title":"Dynamic dialect with Hibernate and Hikari","body":"<p>@Tsvetelin answer pointed me on the right direction, but, after applying it, I started having problems with another libs, like Hazelcast that was being user as second level cache.</p>\n<p>So, this is what I did:</p>\n<ol>\n<li><p>Instead of creating a <code>EntityManagerFactory</code> bean, I created a <code>LocalContainerEntityManagerFactoryBean</code> that instantiates a <code>DynamicTenantEntityManagerFactoryBean</code>.</p>\n<pre><code> @Bean\n public LocalContainerEntityManagerFactoryBean entityManagerFactory() {\n\n     DynamicTenantEntityManagerFactoryBean em = new DynamicTenantEntityManagerFactoryBean();\n     em.setPackagesToScan(getPackagesToScan());\n     em.setJpaProperties(additionalProperties());\n     em.setJpaVendorAdapter(new HibernateJpaVendorAdapter());\n     return em;\n\n }\n</code></pre>\n</li>\n</ol>\n<p><code>getPackagesToScan()</code> and <code>additionalProperties()</code> are functions that reads the parameters that was set by Spring Boot on the application context.</p>\n<pre><code>private String[] getPackagesToScan() {\n\n    //Check if the defaults packagesToScan needs to be overrided\n    String[] packagesToScan = dynamicTenantRoutingPropertiesConfig.getPackagesToScan();\n\n    if (packagesToScan == null) {\n\n        List&lt;String&gt; packageNames = EntityScanPackages.get(context).getPackageNames();\n        if (packageNames.isEmpty() &amp;&amp; AutoConfigurationPackages.has(context)) {\n            packageNames = AutoConfigurationPackages.get(context);\n        }\n\n        packagesToScan = packageNames.toArray(new String[0]);\n\n    }\n\n    return packagesToScan;\n\n}\n\nprivate Properties additionalProperties() {\n    \n    //jpaProperties is an Autowired bean of type \n    //org.springframework.boot.autoconfigure.orm.jpa.JpaProperties\n\n    final Properties properties = new Properties();\n    properties.putAll(jpaProperties.getProperties());\n    return properties;\n}\n</code></pre>\n<p><code>DynamicTenantEntityManagerFactoryBean</code> extends <code>LocalContainerEntityManagerFactoryBean</code> and overrides <code>createNativeEntityManagerFactory()</code>, using the same technique as @tsvetelin-yakimov</p>\n<pre><code>@Log4j2\n@Configurable\npublic class DynamicTenantEntityManagerFactoryBean extends LocalContainerEntityManagerFactoryBean {\n\n    @Autowired\n    private ApplicationContext context;\n\n    @PostConstruct\n    public void postConstruct() {\n\n        //Obtem a referencia para o Datasource\n        AbstractDynamicTenantRoutingDataSource dataSource\n                = context.getBean(AbstractDynamicTenantRoutingDataSource.class);\n\n        //Define o Datasource\n        this.setDataSource(dataSource);\n\n    }\n\n\n    @Override\n    protected EntityManagerFactory createNativeEntityManagerFactory() throws PersistenceException {\n\n        log.info(&quot;(DynamicTenantEntityManagerFactory): Iniciando Proxy...&quot;);\n        final int hashcode = UUID.randomUUID().toString().hashCode();\n        final Map&lt;String, EntityManagerFactory&gt; entityManagerFactoryMap = new HashMap&lt;&gt;();\n\n\n        Object emf = Proxy.newProxyInstance(\n                Thread.currentThread().getContextClassLoader(),\n                new Class[]{SessionFactory.class},\n                (proxy, method, args) -&gt; {\n\n                    if (method.getName().equals(&quot;hashCode&quot;)) {\n                        return hashcode;\n                    }\n\n                    if (method.getName().equals(&quot;equals&quot;)) {\n                        return proxy == args[0];\n                    }\n\n                    //Verifica se o DataSource esta preenchido\n                    if (this.getDataSource() == null)\n                        throw new PersistenceException(&quot;O DataSource no pode ser nulo&quot;);\n\n                    //Verifica se ja temos o EntityManager para esse Datasource\n                    String currentDriver = ((AbstractDynamicTenantRoutingDataSource) this.getDataSource()).resolveCurrentDriver();\n                    EntityManagerFactory instance = entityManagerFactoryMap.get(currentDriver);\n\n                    if (instance == null) {\n\n                        //Obtem o dialeto\n                        Dialect dialect = ((AbstractDynamicTenantRoutingDataSource) this.getDataSource()).resolveDialect(currentDriver);\n\n                        log.info(\n                                &quot;(DynamicTenantEntityManagerFactory): Iniciando EntityManagerFactory para Driver {} Dialeto {}...&quot;,\n                                currentDriver,\n                                dialect\n                        );\n\n                        instance = this.createEntityManagerFactory(\n                                dialect\n                        );\n\n                        entityManagerFactoryMap.put(\n                                currentDriver,\n                                instance\n                        );\n\n                    }\n\n                    log.debug(\n                            &quot;(DynamicTenantEntityManagerFactory): Retornando EntityManagerFactory para Driver {}...&quot;,\n                            currentDriver\n                    );\n                    return method.invoke(instance);\n\n                }\n        );\n\n        log.info(&quot;(DynamicTenantEntityManagerFactory): Iniciando Proxy... Concluido!&quot;);\n        return (SessionFactory) emf;\n\n    }\n\n    private EntityManagerFactory createEntityManagerFactory(Dialect dialect) {\n\n        EntityManagerFactory factory = super.createNativeEntityManagerFactory();\n        factory\n                .getProperties()\n                .put(&quot;hibernate.dialect&quot;, dialect.getClass().getName());\n\n        return factory;\n\n    }\n\n}\n</code></pre>\n"}],"owner":{"account_id":19670476,"reputation":207,"user_id":14399829,"display_name":"effedici"},"comment_count":11,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":862,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":3,"score":1,"last_activity_date":1695378210,"creation_date":1632758317,"question_id":69349713,"body_markdown":"I am new at Hibernate.\r\nInto my code, the connection to the DB is managed with the Hikari data source.\r\n\r\nMy code is right now multitenant, but it manages the same hibernate dialect for all tenants.\r\n\r\n**Is it possible to create a configuration where each tenant can use a different dialect?**\r\nThe type of dialect can be provided as a tenant&#39;s property.\r\n\r\n----\r\nThis is an example of the entityManagerFactory:\r\n```java\r\n     @Bean\r\n     public LocalContainerEntityManagerFactoryBean entityManagerFactory() {\r\n\r\n        Map&lt;String, Object&gt; jpaProperties = new HashMap&lt;&gt;();\r\n        jpaProperties.put(..., ...);\r\n        jpaProperties.put(org.hibernate.cfg.Environment.DIALECT, &quot;myDialect&quot;);\r\n        \r\n        LocalContainerEntityManagerFactoryBean emfBean = new LocalContainerEntityManagerFactoryBean();\r\n        emfBean.setPackagesToScan(new String[] {MyEntity.class.getPackage().getName()});\r\n        emfBean.setJpaVendorAdapter(new HibernateJpaVendorAdapter());\r\n        emfBean.setJpaPropertyMap(jpaProperties);\r\n        return emfBean;\r\n    }\r\n```\r\n\r\n-----\r\n**Edit**\r\n\r\nI was looking to this [solution][1]: it suggests to create a duplicated LocalContainerEntityManagerFactoryBean for each dialect.\r\nWhat I do not understand is how can I tell when using one EntityManager (MySQL) and when the other one (Postgres or MsSQL): the [solution][1] discriminates the entities (each entity has its own DB) but in my case, all entities are on all DBs. Is the tenant that discriminates.\r\n\r\nFor example: if I create a second instance of LocalContainerEntityManagerFactoryBean (i.e. msSQLEntityManagerFactory()) with setted the dialect for SQL Server, the application fails to start with:\r\n```log\r\nApplication failed to start due to an exceptionorg.springframework.beans.factory.NoUniqueBeanDefinitionException:\r\n No qualifying bean of type &#39;javax.persistence.EntityManagerFactory&#39; available:\r\n expected single matching bean but found 2: \r\nmsSQLEntityManagerFactory,entityManagerFactory\r\n```\r\n\r\n  [1]: https://stackoverflow.com/questions/60796798/dynamically-set-hibernate-dialect-properties-in-spring-boot","title":"Dynamic dialect with Hibernate and Hikari","body":"<p>I am new at Hibernate.\nInto my code, the connection to the DB is managed with the Hikari data source.</p>\n<p>My code is right now multitenant, but it manages the same hibernate dialect for all tenants.</p>\n<p><strong>Is it possible to create a configuration where each tenant can use a different dialect?</strong>\nThe type of dialect can be provided as a tenant's property.</p>\n<hr />\n<p>This is an example of the entityManagerFactory:</p>\n<pre class=\"lang-java prettyprint-override\"><code>     @Bean\n     public LocalContainerEntityManagerFactoryBean entityManagerFactory() {\n\n        Map&lt;String, Object&gt; jpaProperties = new HashMap&lt;&gt;();\n        jpaProperties.put(..., ...);\n        jpaProperties.put(org.hibernate.cfg.Environment.DIALECT, &quot;myDialect&quot;);\n        \n        LocalContainerEntityManagerFactoryBean emfBean = new LocalContainerEntityManagerFactoryBean();\n        emfBean.setPackagesToScan(new String[] {MyEntity.class.getPackage().getName()});\n        emfBean.setJpaVendorAdapter(new HibernateJpaVendorAdapter());\n        emfBean.setJpaPropertyMap(jpaProperties);\n        return emfBean;\n    }\n</code></pre>\n<hr />\n<p><strong>Edit</strong></p>\n<p>I was looking to this <a href=\"https://stackoverflow.com/questions/60796798/dynamically-set-hibernate-dialect-properties-in-spring-boot\">solution</a>: it suggests to create a duplicated LocalContainerEntityManagerFactoryBean for each dialect.\nWhat I do not understand is how can I tell when using one EntityManager (MySQL) and when the other one (Postgres or MsSQL): the <a href=\"https://stackoverflow.com/questions/60796798/dynamically-set-hibernate-dialect-properties-in-spring-boot\">solution</a> discriminates the entities (each entity has its own DB) but in my case, all entities are on all DBs. Is the tenant that discriminates.</p>\n<p>For example: if I create a second instance of LocalContainerEntityManagerFactoryBean (i.e. msSQLEntityManagerFactory()) with setted the dialect for SQL Server, the application fails to start with:</p>\n<pre><code>Application failed to start due to an exceptionorg.springframework.beans.factory.NoUniqueBeanDefinitionException:\n No qualifying bean of type 'javax.persistence.EntityManagerFactory' available:\n expected single matching bean but found 2: \nmsSQLEntityManagerFactory,entityManagerFactory\n</code></pre>\n"},{"tags":["java","json","jackson"],"comments":[{"owner":{"account_id":1233122,"reputation":3934,"user_id":1197297,"accept_rate":67,"display_name":"StvnBrkdll"},"score":0,"creation_date":1509033253,"post_id":34180538,"comment_id":80864842,"body_markdown":"take a look at this post for how to use `JsonNodeFactory` to create an `ObjectNode`:\nhttps://stackoverflow.com/questions/11503604/how-to-create-insert-new-nodes-in-jsonnode","body":"take a look at this post for how to use <code>JsonNodeFactory</code> to create an <code>ObjectNode</code>: <a href=\"https://stackoverflow.com/questions/11503604/how-to-create-insert-new-nodes-in-jsonnode\" title=\"how to create insert new nodes in jsonnode\">stackoverflow.com/questions/11503604/&hellip;</a>"}],"answers":[{"tags":[],"owner":{"account_id":2567170,"reputation":10683,"user_id":3537858,"display_name":"Alexey Gavrilov"},"down_vote_count":1,"up_vote_count":29,"is_accepted":true,"score":28,"last_activity_date":1449682076,"creation_date":1449682076,"answer_id":34185174,"question_id":34180538,"body_markdown":"Use [ObjectMapper#convertValue][1] method to covert object to a JsonNode instance. Here is an example:\r\n\r\n    public class JacksonConvert {\r\n        public static void main(String[] args) {\r\n            final ObjectMapper mapper = new ObjectMapper();\r\n            final ObjectNode root = mapper.createObjectNode();\r\n            root.set(&quot;integer&quot;, mapper.convertValue(1, JsonNode.class));\r\n            root.set(&quot;string&quot;, mapper.convertValue(&quot;string&quot;, JsonNode.class));\r\n            root.set(&quot;bool&quot;, mapper.convertValue(true, JsonNode.class));\r\n            root.set(&quot;array&quot;, mapper.convertValue(Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;), JsonNode.class));\r\n            System.out.println(root);\r\n        }\r\n    }\r\n\r\n\r\nOutput:\r\n     \r\n    {&quot;integer&quot;:1,&quot;string&quot;:&quot;string&quot;,&quot;bool&quot;:true,&quot;array&quot;:[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;]}\r\n\r\n  [1]: https://fasterxml.github.io/jackson-databind/javadoc/2.6/com/fasterxml/jackson/databind/ObjectMapper.html#convertValue-java.lang.Object-java.lang.Class-\r\n","title":"Create Jackson ObjectNode from Object","body":"<p>Use <a href=\"https://fasterxml.github.io/jackson-databind/javadoc/2.6/com/fasterxml/jackson/databind/ObjectMapper.html#convertValue-java.lang.Object-java.lang.Class-\" rel=\"noreferrer\">ObjectMapper#convertValue</a> method to covert object to a JsonNode instance. Here is an example:</p>\n\n<pre><code>public class JacksonConvert {\n    public static void main(String[] args) {\n        final ObjectMapper mapper = new ObjectMapper();\n        final ObjectNode root = mapper.createObjectNode();\n        root.set(\"integer\", mapper.convertValue(1, JsonNode.class));\n        root.set(\"string\", mapper.convertValue(\"string\", JsonNode.class));\n        root.set(\"bool\", mapper.convertValue(true, JsonNode.class));\n        root.set(\"array\", mapper.convertValue(Arrays.asList(\"a\", \"b\", \"c\"), JsonNode.class));\n        System.out.println(root);\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{\"integer\":1,\"string\":\"string\",\"bool\":true,\"array\":[\"a\",\"b\",\"c\"]}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":8235,"reputation":87010,"user_id":14731,"accept_rate":89,"display_name":"Gili"},"down_vote_count":0,"up_vote_count":12,"is_accepted":false,"score":12,"last_activity_date":1695377771,"creation_date":1565713712,"answer_id":57481865,"question_id":34180538,"body_markdown":"Using the `put()` methods is a lot easier:\r\n\r\n    ObjectMapper mapper = new ObjectMapper();\r\n    ObjectNode root = mapper.createObjectNode();\r\n    \r\n    root.put(&quot;name1&quot;, 1);\r\n    root.put(&quot;name2&quot;, &quot;someString&quot;);\r\n    \r\n    ObjectNode child = root.putObject(&quot;child&quot;);\r\n    child.put(&quot;name3&quot;, 2);\r\n    child.put(&quot;name4&quot;, &quot;someString&quot;);\r\n\r\nThis code creates the following JSON structure:\r\n\r\n```\r\n{\r\n    &quot;name1&quot;: 1,\r\n    &quot;name2&quot;: &quot;someString&quot;,\r\n    &quot;child&quot;: {\r\n        &quot;name3&quot;: 2,\r\n        &quot;name4&quot;: &quot;someString&quot;\r\n    }\r\n}\r\n```","title":"Create Jackson ObjectNode from Object","body":"<p>Using the <code>put()</code> methods is a lot easier:</p>\n<pre><code>ObjectMapper mapper = new ObjectMapper();\nObjectNode root = mapper.createObjectNode();\n\nroot.put(&quot;name1&quot;, 1);\nroot.put(&quot;name2&quot;, &quot;someString&quot;);\n\nObjectNode child = root.putObject(&quot;child&quot;);\nchild.put(&quot;name3&quot;, 2);\nchild.put(&quot;name4&quot;, &quot;someString&quot;);\n</code></pre>\n<p>This code creates the following JSON structure:</p>\n<pre><code>{\n    &quot;name1&quot;: 1,\n    &quot;name2&quot;: &quot;someString&quot;,\n    &quot;child&quot;: {\n        &quot;name3&quot;: 2,\n        &quot;name4&quot;: &quot;someString&quot;\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":11337137,"reputation":838,"user_id":8312604,"display_name":"Alexandr Arhipov"},"down_vote_count":0,"up_vote_count":7,"is_accepted":false,"score":7,"last_activity_date":1630834062,"creation_date":1630669004,"answer_id":69044288,"question_id":34180538,"body_markdown":"For people who came here for the answer on the question: &quot;How to create Jackson ObjectNode from Object?&quot;.\r\n\r\nYou can do it this way:\r\n\r\n    ObjectNode objectNode = objectMapper.convertValue(yourObject, ObjectNode.class);\r\n","title":"Create Jackson ObjectNode from Object","body":"<p>For people who came here for the answer on the question: &quot;How to create Jackson ObjectNode from Object?&quot;.</p>\n<p>You can do it this way:</p>\n<pre><code>ObjectNode objectNode = objectMapper.convertValue(yourObject, ObjectNode.class);\n</code></pre>\n"}],"owner":{"account_id":47138,"reputation":361,"user_id":139494,"accept_rate":100,"display_name":"Chris"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":39457,"favorite_count":0,"down_vote_count":0,"up_vote_count":14,"accepted_answer_id":34185174,"answer_count":3,"score":14,"last_activity_date":1695377771,"creation_date":1449669243,"question_id":34180538,"body_markdown":"I need to add a new item to an existing `ObjectNode`, given a key and a value. The value is specified as an `Object` in the method sig and _should_ be one of the types that ObjectNode.set() accepts (`String`, `Integer`, `Boolean`, etc). But I can&#39;t just do `myObjectNode.set(key, value);` because value is just an `Object` and of course I get a _&quot;not applicable for the arguments (String, Object)&quot;_ error. \r\n\r\nMy make-it-work solution is to create a function to check the `instanceof` and cast it to create a `ValueNode`:\r\n\r\n    private static ValueNode getValueNode(Object obj) {\r\n      if (obj instanceof Integer) {\r\n        return mapper.createObjectNode().numberNode((Integer)obj);\r\n      }\r\n      if (obj instanceof Boolean) {\r\n        return mapper.createObjectNode().booleanNode((Boolean)obj);\r\n      }\r\n      //...Etc for all the types I expect\r\n    }\r\n..and then I can use `myObjectNode.set(key, getValueNode(value));`\r\n\r\n**There must be a better way** but I&#39;m having trouble finding it. \r\n\r\nI&#39;m guessing that there is a way to use `ObjectMapper` but how isn&#39;t clear to me at this point. For example [I can write the value out as a string][1] but I need it as something I can set on my ObjectNode and needs to be the correct type (ie everything can&#39;t just be converted to a String).\r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/15786129/converting-java-objects-to-json-with-jackson","title":"Create Jackson ObjectNode from Object","body":"<p>I need to add a new item to an existing <code>ObjectNode</code>, given a key and a value. The value is specified as an <code>Object</code> in the method sig and <em>should</em> be one of the types that ObjectNode.set() accepts (<code>String</code>, <code>Integer</code>, <code>Boolean</code>, etc). But I can't just do <code>myObjectNode.set(key, value);</code> because value is just an <code>Object</code> and of course I get a <em>\"not applicable for the arguments (String, Object)\"</em> error. </p>\n\n<p>My make-it-work solution is to create a function to check the <code>instanceof</code> and cast it to create a <code>ValueNode</code>:</p>\n\n<pre><code>private static ValueNode getValueNode(Object obj) {\n  if (obj instanceof Integer) {\n    return mapper.createObjectNode().numberNode((Integer)obj);\n  }\n  if (obj instanceof Boolean) {\n    return mapper.createObjectNode().booleanNode((Boolean)obj);\n  }\n  //...Etc for all the types I expect\n}\n</code></pre>\n\n<p>..and then I can use <code>myObjectNode.set(key, getValueNode(value));</code></p>\n\n<p><strong>There must be a better way</strong> but I'm having trouble finding it. </p>\n\n<p>I'm guessing that there is a way to use <code>ObjectMapper</code> but how isn't clear to me at this point. For example <a href=\"https://stackoverflow.com/questions/15786129/converting-java-objects-to-json-with-jackson\">I can write the value out as a string</a> but I need it as something I can set on my ObjectNode and needs to be the correct type (ie everything can't just be converted to a String).</p>\n"},{"tags":["java","algorithm","hashmap","complexity-theory"],"comments":[{"owner":{"account_id":949827,"reputation":1645,"user_id":976201,"display_name":"Ray"},"score":1,"creation_date":1346652370,"post_id":1850802,"comment_id":16409545,"body_markdown":"I don&#39;t think  walking through the set takes &#39;obviously&#39; O(n) time. The set may not be actually generate. It maybe just a object that can be used to iterate. And, what&#39;s the n here? The items or buckets?","body":"I don&#39;t think  walking through the set takes &#39;obviously&#39; O(n) time. The set may not be actually generate. It maybe just a object that can be used to iterate. And, what&#39;s the n here? The items or buckets?"},{"owner":{"account_id":52456,"reputation":309,"user_id":156765,"accept_rate":78,"display_name":"agrawalankur"},"score":0,"creation_date":1351807521,"post_id":1850802,"comment_id":17948089,"body_markdown":"here n is the number of entries in the hashmap. If the set has n elelments, to iterate over the set of n elements the time complexity will be O(n).","body":"here n is the number of entries in the hashmap. If the set has n elelments, to iterate over the set of n elements the time complexity will be O(n)."}],"answers":[{"tags":[],"owner":{"account_id":53046,"reputation":12677,"user_id":158595,"accept_rate":70,"display_name":"LorenVS"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1259978228,"creation_date":1259977791,"answer_id":1850813,"question_id":1850802,"body_markdown":"This should be doable in O(n) time... A hash map is usually implemented as a large bucket array, the bucket&#39;s size is (usually) directly proportional to the size of the hash map. In order to retrieve the key set, the bucket must be iterated through, and for each set item, the key must be retrieved (either through an intermediate collection or an iterator with direct access to the bucket)...\r\n\r\n**EDIT: As others have pointed out, the actual keyset() method will run in O(1) time, however, iterating over the keyset or transferring it to a dedicated collection will be an O(n) operation. Not quite sure which one you are looking for **","title":"What is the time complexity of java.util.HashMap class&#39; keySet() method?","body":"<p>This should be doable in O(n) time... A hash map is usually implemented as a large bucket array, the bucket's size is (usually) directly proportional to the size of the hash map. In order to retrieve the key set, the bucket must be iterated through, and for each set item, the key must be retrieved (either through an intermediate collection or an iterator with direct access to the bucket)...</p>\n\n<p>**EDIT: As others have pointed out, the actual keyset() method will run in O(1) time, however, iterating over the keyset or transferring it to a dedicated collection will be an O(n) operation. Not quite sure which one you are looking for **</p>\n"},{"tags":[],"owner":{"account_id":34514,"reputation":28046,"user_id":97627,"accept_rate":75,"display_name":"Paul Wagland"},"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1259977898,"creation_date":1259977898,"answer_id":1850820,"question_id":1850802,"body_markdown":"Surely it would be O(1). All that it is doing is returning a wrapper object on the HashMap.\r\n\r\nIf you are talking about walking over the keyset, then this is O(n), since each next() call is O(1), and this needs to be performed n times.","title":"What is the time complexity of java.util.HashMap class&#39; keySet() method?","body":"<p>Surely it would be O(1). All that it is doing is returning a wrapper object on the HashMap.</p>\n\n<p>If you are talking about walking over the keyset, then this is O(n), since each next() call is O(1), and this needs to be performed n times.</p>\n"},{"tags":[],"owner":{"account_id":44736,"reputation":98412,"user_id":131433,"accept_rate":76,"display_name":"bmargulies"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1259977906,"creation_date":1259977906,"answer_id":1850821,"question_id":1850802,"body_markdown":"Java collections have a lot of space and thus don&#39;t take much time. That method is, I believe, O(1). The collection is just sitting there.\r\n","title":"What is the time complexity of java.util.HashMap class&#39; keySet() method?","body":"<p>Java collections have a lot of space and thus don't take much time. That method is, I believe, O(1). The collection is just sitting there.</p>\n"},{"tags":[],"owner":{"account_id":47283,"reputation":703817,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"down_vote_count":0,"up_vote_count":28,"is_accepted":true,"score":28,"last_activity_date":1582626123,"creation_date":1259978360,"answer_id":1850835,"question_id":1850802,"body_markdown":"Getting the keyset is `O(1)` and cheap.  This is because `HashMap.keyset()` returns the actual `KeySet` object associated with the `HashMap`.  \r\n\r\nThe returned `Set` is *not a copy* of the keys, but a wrapper for the actual `HashMap`&#39;s state. Indeed, if you update the set you can actually change the `HashMap`&#39;s state; e.g. calling `clear()` on the set will clear the `HashMap`!\r\n\r\n-----------------\r\n\r\n&gt; ... iterating through the returned `Set` will take obviously `O(n)` time.\r\n\r\n\r\nActually that is not *always* true:\r\n\r\n  - It is true for a `HashMap` is created using `new HashMap&lt;&gt;()`.  The worst case is to have all `N` keys land in the same hash chain.  However if the map has grown naturally, there will still be `N` entries and `O(N)` slots in the hash array.  Thus iterating the entry set will involve `O(N)` operations.\r\n\r\n  - It is false if the `HashMap` is created with `new HashMap&lt;&gt;(capacity)` and a singularly bad (too large) `capacity` estimate.  Then it will take `O(Cap) + O(N)` operations to iterate the entry set.  If we treat `Cap` as a variable, that is `O(max(Cap, N))`, which could be worse than `O(N)`.\r\n\r\nThere is an escape clause though.  Since `capacity` is an `int` in the current `HashMap` API, the upper bound for `Cap` is 2&lt;sup&gt;31&lt;/sup&gt;.  So for *really* large values of `Cap` and `N`, the complexity is `O(N)`.  \r\n\r\nOn the other hand, `N` is limited by the amount of memory available and in practice you need a heap in the order of 2&lt;sup&gt;38&lt;/sup&gt; bytes (256GBytes) for `N` to exceed the largest possible `Cap` value.   And for a map that size, you would be better off using a hashtable implementation tuned for huge maps.  Or not using an excessively large capacity estimate!","title":"What is the time complexity of java.util.HashMap class&#39; keySet() method?","body":"<p>Getting the keyset is <code>O(1)</code> and cheap.  This is because <code>HashMap.keyset()</code> returns the actual <code>KeySet</code> object associated with the <code>HashMap</code>.  </p>\n\n<p>The returned <code>Set</code> is <em>not a copy</em> of the keys, but a wrapper for the actual <code>HashMap</code>'s state. Indeed, if you update the set you can actually change the <code>HashMap</code>'s state; e.g. calling <code>clear()</code> on the set will clear the <code>HashMap</code>!</p>\n\n<hr>\n\n<blockquote>\n  <p>... iterating through the returned <code>Set</code> will take obviously <code>O(n)</code> time.</p>\n</blockquote>\n\n<p>Actually that is not <em>always</em> true:</p>\n\n<ul>\n<li><p>It is true for a <code>HashMap</code> is created using <code>new HashMap&lt;&gt;()</code>.  The worst case is to have all <code>N</code> keys land in the same hash chain.  However if the map has grown naturally, there will still be <code>N</code> entries and <code>O(N)</code> slots in the hash array.  Thus iterating the entry set will involve <code>O(N)</code> operations.</p></li>\n<li><p>It is false if the <code>HashMap</code> is created with <code>new HashMap&lt;&gt;(capacity)</code> and a singularly bad (too large) <code>capacity</code> estimate.  Then it will take <code>O(Cap) + O(N)</code> operations to iterate the entry set.  If we treat <code>Cap</code> as a variable, that is <code>O(max(Cap, N))</code>, which could be worse than <code>O(N)</code>.</p></li>\n</ul>\n\n<p>There is an escape clause though.  Since <code>capacity</code> is an <code>int</code> in the current <code>HashMap</code> API, the upper bound for <code>Cap</code> is 2<sup>31</sup>.  So for <em>really</em> large values of <code>Cap</code> and <code>N</code>, the complexity is <code>O(N)</code>.  </p>\n\n<p>On the other hand, <code>N</code> is limited by the amount of memory available and in practice you need a heap in the order of 2<sup>38</sup> bytes (256GBytes) for <code>N</code> to exceed the largest possible <code>Cap</code> value.   And for a map that size, you would be better off using a hashtable implementation tuned for huge maps.  Or not using an excessively large capacity estimate!</p>\n"},{"tags":[],"owner":{"account_id":1119690,"reputation":15788,"user_id":1108305,"accept_rate":47,"display_name":"M. Justin"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1551127546,"creation_date":1551127546,"answer_id":54874409,"question_id":1850802,"body_markdown":"To address the &quot;iterating through the returned Set will take obviously O(n) time&quot; comment, this is not actually correct per the [doc comments](https://docs.oracle.com/javase/8/docs/api/java/util/HashMap.html) of `HashMap`:\r\n\r\n&gt; Iteration over collection views requires time proportional to the &quot;capacity&quot; of the HashMap instance (the number of buckets) plus its size (the number of key-value mappings). Thus, it&#39;s very important not to set the initial capacity too high (or the load factor too low) if iteration performance is important.\r\n\r\nSo in other words, iterating over the returned `Set` will take `O(n + c)` where `n` is the size of the map and `c` is its capacity, not `O(n)`.  If an inappropriately sized initial capacity or load factor were chosen, the value of `c` could outweigh the actual size of the map in terms of iteration time.","title":"What is the time complexity of java.util.HashMap class&#39; keySet() method?","body":"<p>To address the \"iterating through the returned Set will take obviously O(n) time\" comment, this is not actually correct per the <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/HashMap.html\" rel=\"nofollow noreferrer\">doc comments</a> of <code>HashMap</code>:</p>\n\n<blockquote>\n  <p>Iteration over collection views requires time proportional to the \"capacity\" of the HashMap instance (the number of buckets) plus its size (the number of key-value mappings). Thus, it's very important not to set the initial capacity too high (or the load factor too low) if iteration performance is important.</p>\n</blockquote>\n\n<p>So in other words, iterating over the returned <code>Set</code> will take <code>O(n + c)</code> where <code>n</code> is the size of the map and <code>c</code> is its capacity, not <code>O(n)</code>.  If an inappropriately sized initial capacity or load factor were chosen, the value of <code>c</code> could outweigh the actual size of the map in terms of iteration time.</p>\n"},{"tags":[],"owner":{"account_id":26924278,"reputation":41,"user_id":20497782,"display_name":"Mark"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1695377574,"creation_date":1695377574,"answer_id":77156724,"question_id":1850802,"body_markdown":"According to official Java documentation, \r\nThe time complexity of keySet() method is O(1). Because when anything changes happens in map at any time those all change related to key happens for keySet() method also.\r\n\r\nThink like there is a static ArrayList which is gobally and all changes are made when some key is added or removed.\r\n\r\nBut in interview or if you are implementing hashmap from scratch then You can do keySet() time complexity O(1) and if you are finding all those key&#39;s using some traversal then its time complexity will be O(n).\r\n\r\nFor More information read Java official hashmap documention.\r\n[Java Hashmap][1]\r\n\r\n\r\n  [1]: https://docs.oracle.com/javase/8/docs/api/java/util/HashMap.html","title":"What is the time complexity of java.util.HashMap class&#39; keySet() method?","body":"<p>According to official Java documentation,\nThe time complexity of keySet() method is O(1). Because when anything changes happens in map at any time those all change related to key happens for keySet() method also.</p>\n<p>Think like there is a static ArrayList which is gobally and all changes are made when some key is added or removed.</p>\n<p>But in interview or if you are implementing hashmap from scratch then You can do keySet() time complexity O(1) and if you are finding all those key's using some traversal then its time complexity will be O(n).</p>\n<p>For More information read Java official hashmap documention.\n<a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/HashMap.html\" rel=\"nofollow noreferrer\">Java Hashmap</a></p>\n"}],"owner":{"account_id":52456,"reputation":309,"user_id":156765,"accept_rate":78,"display_name":"agrawalankur"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":15160,"favorite_count":0,"down_vote_count":0,"up_vote_count":8,"accepted_answer_id":1850835,"answer_count":6,"score":8,"last_activity_date":1695377574,"creation_date":1259977444,"question_id":1850802,"body_markdown":"I am trying to implement a plane sweep algorithm and for this I need to know the time complexity of [java.util.HashMap class&#39; keySet()][1] method. I suspect that it is O(n log n). Am I correct?\r\n\r\n**Point of clarification:** I am talking about the time complexity of the keySet() method; iterating through the returned Set will take obviously O(n) time.\r\n\r\n  [1]: http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html#keySet()","title":"What is the time complexity of java.util.HashMap class&#39; keySet() method?","body":"<p>I am trying to implement a plane sweep algorithm and for this I need to know the time complexity of <a href=\"http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html#keySet()\" rel=\"noreferrer\">java.util.HashMap class' keySet()</a> method. I suspect that it is O(n log n). Am I correct?</p>\n\n<p><strong>Point of clarification:</strong> I am talking about the time complexity of the keySet() method; iterating through the returned Set will take obviously O(n) time.</p>\n"},{"tags":["java","methods","netbeans","game-development","flappy-bird-clone"],"comments":[{"owner":{"account_id":114128,"reputation":50422,"user_id":300257,"accept_rate":89,"display_name":"Gilbert Le Blanc"},"score":0,"creation_date":1695386924,"post_id":77156676,"comment_id":136021321,"body_markdown":"Oracle has a helpful tutorial, [Creating a GUI With Swing](https://docs.oracle.com/javase/tutorial/uiswing/index.html).  Skip the Learning Swing with the NetBeans IDE section.  Pay particular attention to the [How to Use CardLayout](https://docs.oracle.com/javase/tutorial/uiswing/layout/card.html) section.","body":"Oracle has a helpful tutorial, <a href=\"https://docs.oracle.com/javase/tutorial/uiswing/index.html\" rel=\"nofollow noreferrer\">Creating a GUI With Swing</a>.  Skip the Learning Swing with the NetBeans IDE section.  Pay particular attention to the <a href=\"https://docs.oracle.com/javase/tutorial/uiswing/layout/card.html\" rel=\"nofollow noreferrer\">How to Use CardLayout</a> section."},{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1695420952,"post_id":77156676,"comment_id":136027197,"body_markdown":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking.","body":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking."}],"owner":{"account_id":29101471,"reputation":1,"user_id":22293208,"display_name":"user22293208"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":16,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1695377239,"creation_date":1695377239,"question_id":77156676,"body_markdown":"I want to call my login screen first so that the uer can have an account before playing the game. However i do not know where to call the login screen without having it interfere with the game: \r\n\r\n\r\nSo essentially every time the game wants to start it obviously opens the login screen first because they are all within the constructor. Anyone know how i can seperate the two different processes? \r\n\r\n\r\ncurrently the set up looks like this:\r\n```\r\nprivate LoginScreen log;\r\n\r\n    public FlappyBird() {\r\n       \r\n        \r\n        //call login screen so that an account can be created\r\n        log= new LoginScreen();\r\n       \r\n        log.setVisible(decision);\r\n        \r\n         \r\n        Timer timer = new Timer(20, this);// used to ensure it repaints throught a schedule timer\r\n        render = new FlappyBirdUI1();\r\n        jframe = new JFrame();\r\n        \r\n        jframe.add(render);\r\n\r\n        jframe.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\r\n\r\n        jframe.setResizable(false);\r\n        \r\n        jframe.setSize(new java.awt.Dimension(WIDTH, HEIGHT));\r\n        jframe.setLocationRelativeTo(null);\r\n        jframe.addMouseListener(this);\r\n// set game screen to only be visible if the game button on home screen is clicked\r\n        jframe.setVisible(true);\r\n\r\n        //using a rectangle as the &quot;bird&quot;\r\n        \r\n        bird = new Rectangle(WIDTH / 2 - 10, HEIGHT / 2 - 10, 20, 20);\r\n\r\n        pipes = new ArrayList&lt;Rectangle&gt;();\r\n        addpipe(true);\r\n        addpipe(true);\r\n        addpipe(true);\r\n        addpipe(true);\r\n\r\n        // gsettings.setBounds(0, HEIGHT, 30, 25);\r\n        timer.start();\r\n         \r\n    }\r\n```","title":"How to seperate my game screen from my login screen","body":"<p>I want to call my login screen first so that the uer can have an account before playing the game. However i do not know where to call the login screen without having it interfere with the game:</p>\n<p>So essentially every time the game wants to start it obviously opens the login screen first because they are all within the constructor. Anyone know how i can seperate the two different processes?</p>\n<p>currently the set up looks like this:</p>\n<pre><code>private LoginScreen log;\n\n    public FlappyBird() {\n       \n        \n        //call login screen so that an account can be created\n        log= new LoginScreen();\n       \n        log.setVisible(decision);\n        \n         \n        Timer timer = new Timer(20, this);// used to ensure it repaints throught a schedule timer\n        render = new FlappyBirdUI1();\n        jframe = new JFrame();\n        \n        jframe.add(render);\n\n        jframe.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n\n        jframe.setResizable(false);\n        \n        jframe.setSize(new java.awt.Dimension(WIDTH, HEIGHT));\n        jframe.setLocationRelativeTo(null);\n        jframe.addMouseListener(this);\n// set game screen to only be visible if the game button on home screen is clicked\n        jframe.setVisible(true);\n\n        //using a rectangle as the &quot;bird&quot;\n        \n        bird = new Rectangle(WIDTH / 2 - 10, HEIGHT / 2 - 10, 20, 20);\n\n        pipes = new ArrayList&lt;Rectangle&gt;();\n        addpipe(true);\n        addpipe(true);\n        addpipe(true);\n        addpipe(true);\n\n        // gsettings.setBounds(0, HEIGHT, 30, 25);\n        timer.start();\n         \n    }\n</code></pre>\n"},{"tags":["java","loops","for-loop","foreach"],"comments":[{"owner":{"account_id":5404,"reputation":22089,"user_id":8681,"accept_rate":67,"display_name":"Jorn"},"score":0,"creation_date":1695375383,"post_id":77156471,"comment_id":136019030,"body_markdown":"Don&#39;t `return` inside the loop","body":"Don&#39;t <code>return</code> inside the loop"},{"owner":{"account_id":1894950,"reputation":18007,"user_id":1712135,"display_name":"deHaar"},"score":0,"creation_date":1695375434,"post_id":77156471,"comment_id":136019045,"body_markdown":"A `boolean[]` will never be `true`, so review your condition in `if (arr.equals(true))`","body":"A <code>boolean[]</code> will never be <code>true</code>, so review your condition in <code>if (arr.equals(true))</code>"},{"owner":{"account_id":4362282,"reputation":92954,"user_id":3558960,"accept_rate":60,"display_name":"Robby Cornelissen"},"score":0,"creation_date":1695375460,"post_id":77156471,"comment_id":136019052,"body_markdown":"You&#39;re comparing the array `arr` to `true` instead of the value `i`. That&#39;s all.","body":"You&#39;re comparing the array <code>arr</code> to <code>true</code> instead of the value <code>i</code>. That&#39;s all."},{"owner":{"account_id":4362282,"reputation":92954,"user_id":3558960,"accept_rate":60,"display_name":"Robby Cornelissen"},"score":0,"creation_date":1695375610,"post_id":77156471,"comment_id":136019084,"body_markdown":"@Jorn I stand corrected.","body":"@Jorn I stand corrected."},{"owner":{"account_id":21724606,"reputation":722,"user_id":16034206,"display_name":"experiment unit 1998X"},"score":0,"creation_date":1695375675,"post_id":77156471,"comment_id":136019098,"body_markdown":"replace the if else statement to `if (i) { amountTrue++;  }`","body":"replace the if else statement to <code>if (i) { amountTrue++;  }</code>"},{"owner":{"account_id":1894950,"reputation":18007,"user_id":1712135,"display_name":"deHaar"},"score":0,"creation_date":1695375701,"post_id":77156471,"comment_id":136019105,"body_markdown":"Compare the item `i` in the array instead of the whole array. Don&#39;t `return` inside the loop, just increment the counter if the condition is met and return the counter after the loop.","body":"Compare the item <code>i</code> in the array instead of the whole array. Don&#39;t <code>return</code> inside the loop, just increment the counter if the condition is met and return the counter after the loop."}],"answers":[{"tags":[],"owner":{"account_id":21977057,"reputation":27,"user_id":16252714,"display_name":"aTancredi"},"down_vote_count":2,"up_vote_count":3,"is_accepted":false,"score":1,"last_activity_date":1695375711,"creation_date":1695375711,"answer_id":77156511,"question_id":77156471,"body_markdown":"Try with this. You should not return inside the loop, also you were testing the array for true and not the element i, which will always return false, hence you always got zero  \r\n\r\n      public class Challenge {\r\n        public static int countTrue(boolean[] arr) {\r\n            // declaring the variable to return\r\n            int amountTrue = 0;\r\n            // for each to loop through the array\r\n            for (boolean i : arr) {\r\n                // if array item == true add 1 to variable amountTrue\r\n                // if false do nothing\r\n                if (i.equals(true)) {\r\n                    amountTrue += 1;\r\n                }\r\n            }\r\n            // returning the variable \r\n            return amountTrue; \r\n        }\r\n    }","title":"Create a function which returns the number of true values there are in an array","body":"<p>Try with this. You should not return inside the loop, also you were testing the array for true and not the element i, which will always return false, hence you always got zero</p>\n<pre><code>  public class Challenge {\n    public static int countTrue(boolean[] arr) {\n        // declaring the variable to return\n        int amountTrue = 0;\n        // for each to loop through the array\n        for (boolean i : arr) {\n            // if array item == true add 1 to variable amountTrue\n            // if false do nothing\n            if (i.equals(true)) {\n                amountTrue += 1;\n            }\n        }\n        // returning the variable \n        return amountTrue; \n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":29406979,"reputation":131,"user_id":22531817,"display_name":"Luca Micarelli"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1695375975,"creation_date":1695375975,"answer_id":77156542,"question_id":77156471,"body_markdown":"in the cycle for only write this:\r\n\r\n    if (i == true) {\r\n       amountTree++;\r\n    }\r\n\r\nwithout the else, and at the end simply return amountTree, in your code you check if the Object arr is equals to boolean true,but arr is an array, you have to check the i element that are boolean, you haven&#39;t to use the return in the cycle because this stop your code and at the end have no sense (add 0 if i != true), you can only add 1 if (i element == true)\r\n    \r\n","title":"Create a function which returns the number of true values there are in an array","body":"<p>in the cycle for only write this:</p>\n<pre><code>if (i == true) {\n   amountTree++;\n}\n</code></pre>\n<p>without the else, and at the end simply return amountTree, in your code you check if the Object arr is equals to boolean true,but arr is an array, you have to check the i element that are boolean, you haven't to use the return in the cycle because this stop your code and at the end have no sense (add 0 if i != true), you can only add 1 if (i element == true)</p>\n"},{"tags":[],"owner":{"account_id":29352300,"reputation":61,"user_id":22489120,"display_name":"Jack M"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1695376516,"creation_date":1695376516,"answer_id":77156602,"question_id":77156471,"body_markdown":"Ok, thanks for everyone&#39;s help, really appreciate the community. \r\n\r\nPicked up a few good bits from here like not returning in a loop, whereas, I think the concept of autoboxing is way out of my league atm (but do know not to use .equals() with primitives now).\r\n\r\nI solved the issue with this with the help of your advice:\r\n\r\n```\r\n\tpublic static int countTrue(boolean[] arr) {\r\n\t\tint amountTrue = 0;\r\n\t\tfor (boolean i : arr){ \r\n\t\t\tif (i == true) {\r\n\t\t\t\tamountTrue+=1;\r\n\t\t\t}} return amountTrue;\r\n\t}\r\n}\r\n``` ","title":"Create a function which returns the number of true values there are in an array","body":"<p>Ok, thanks for everyone's help, really appreciate the community.</p>\n<p>Picked up a few good bits from here like not returning in a loop, whereas, I think the concept of autoboxing is way out of my league atm (but do know not to use .equals() with primitives now).</p>\n<p>I solved the issue with this with the help of your advice:</p>\n<pre><code>    public static int countTrue(boolean[] arr) {\n        int amountTrue = 0;\n        for (boolean i : arr){ \n            if (i == true) {\n                amountTrue+=1;\n            }} return amountTrue;\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":29352300,"reputation":61,"user_id":22489120,"display_name":"Jack M"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":87,"favorite_count":0,"down_vote_count":5,"up_vote_count":2,"answer_count":3,"score":-3,"last_activity_date":1695376516,"creation_date":1695375342,"question_id":77156471,"body_markdown":"The code compiles but always returns 0. When I read the code out it makes sense that it should work; I&#39;ve spent a while troubleshooting, not sure why it isn&#39;t working.\r\n\r\n\r\n```\r\npublic class Challenge {\r\n   public static int countTrue(boolean[] arr) {\r\n     // declaring the variable to return\r\n      int amountTrue = 0;\r\n    // for each to loop through the array\r\n\tfor (boolean i : arr) {\r\n        // if array item == true add 1 to variable amountTrue, if false, add 0 to amountTrue\r\n\t\tif (arr.equals(true)) {\r\n\t\t  return amountTrue++;\r\n\t\t} else {\r\n\t\t  return amountTrue + 0;\r\n\t\t}} \r\n      // returning the variable \r\n       return amountTrue; }}\r\n```\r\n\r\n\r\nI am expecting the function to count all the trues in the array. I have tried both a for loop and for each loop. \r\n\r\n","title":"Create a function which returns the number of true values there are in an array","body":"<p>The code compiles but always returns 0. When I read the code out it makes sense that it should work; I've spent a while troubleshooting, not sure why it isn't working.</p>\n<pre><code>public class Challenge {\n   public static int countTrue(boolean[] arr) {\n     // declaring the variable to return\n      int amountTrue = 0;\n    // for each to loop through the array\n    for (boolean i : arr) {\n        // if array item == true add 1 to variable amountTrue, if false, add 0 to amountTrue\n        if (arr.equals(true)) {\n          return amountTrue++;\n        } else {\n          return amountTrue + 0;\n        }} \n      // returning the variable \n       return amountTrue; }}\n</code></pre>\n<p>I am expecting the function to count all the trues in the array. I have tried both a for loop and for each loop.</p>\n"},{"tags":["java","c#","regex"],"comments":[{"owner":{"account_id":323211,"reputation":43672,"user_id":643085,"accept_rate":100,"display_name":"Fede"},"score":0,"creation_date":1439445738,"post_id":31980475,"comment_id":51866644,"body_markdown":"you need to post more code. What is `data`? what is  `getRegex()`? Where does `TokenType`  come from? What are you *really* trying to do? Also,  in C# you use  real properties as opposed to java&#39;s horrible `getXXX()` and `setXXX()` syntax. C# is a modern language.","body":"you need to post more code. What is <code>data</code>? what is  <code>getRegex()</code>? Where does <code>TokenType</code>  come from? What are you <i>really</i> trying to do? Also,  in C# you use  real properties as opposed to java&#39;s horrible <code>getXXX()</code> and <code>setXXX()</code> syntax. C# is a modern language."},{"owner":{"account_id":323211,"reputation":43672,"user_id":643085,"accept_rate":100,"display_name":"Fede"},"score":1,"creation_date":1439446028,"post_id":31980475,"comment_id":51866763,"body_markdown":"Also, what do you mean by `the C# code doesn&#39;t behave` - what&#39;s the difference? In  what  way is the result wrong? Please specify.","body":"Also, what do you mean by <code>the C# code doesn&#39;t behave</code> - what&#39;s the difference? In  what  way is the result wrong? Please specify."},{"owner":{"account_id":6416404,"reputation":1101,"user_id":4974464,"display_name":"Sky Fang"},"score":0,"creation_date":1439446439,"post_id":31980475,"comment_id":51866932,"body_markdown":"Please show your regex patten,and show the result of `str` value both in java and c#","body":"Please show your regex patten,and show the result of <code>str</code> value both in java and c#"},{"owner":{"account_id":1494484,"reputation":56249,"user_id":1400768,"display_name":"nhahtdh"},"score":0,"creation_date":1439446859,"post_id":31980475,"comment_id":51867140,"body_markdown":"Where is the original Java code?","body":"Where is the original Java code?"},{"owner":{"account_id":6782089,"reputation":63,"user_id":5221952,"display_name":"Page"},"score":0,"creation_date":1439448457,"post_id":31980475,"comment_id":51867992,"body_markdown":"https://www.youtube.com/watch?v=_EQ5jdrgOlU&amp;index=3&amp;list=PLAF3anQEEkzRuJ7UW82CmSEtT6g-J4Q_p Im folowing this series and translating it to c# (also changing how the new language works at the same time)","body":"<a href=\"https://www.youtube.com/watch?v=_EQ5jdrgOlU&amp;index=3&amp;list=PLAF3anQEEkzRuJ7UW82CmSEtT6g-J4Q_p\" rel=\"nofollow noreferrer\">youtube.com/&hellip;</a> Im folowing this series and translating it to c# (also changing how the new language works at the same time)"}],"answers":[{"tags":[],"owner":{"account_id":5172945,"reputation":917,"user_id":4140943,"display_name":"finder2"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695376508,"creation_date":1695376508,"answer_id":77156600,"question_id":31980475,"body_markdown":"The trick is the [numbered parameter][1] in `rx.Replace`. only the first match is used. \r\n```c#\r\nString pattern = @&quot;The&quot;;\r\nRegex rx = new Regex(pattern);\r\n\r\nstring text = &quot;the The quick the brown fox  fox jumps over the lazy dog dog.&quot;;\r\n\r\nstring result = rx.Replace(text, &quot;&quot; , 1);\r\nConsole.WriteLine (result.Trim());\r\n```\r\n\r\n\r\n  [1]: https://learn.microsoft.com/en-us/dotnet/api/system.text.regularexpressions.regex.replace?view=net-7.0#system-text-regularexpressions-regex-replace(system-string-system-string-system-int32)","title":"Java to C# can&#39;t Translate code (Matcher.group() &amp; Matcher.replaceFirst)","body":"<p>The trick is the <a href=\"https://learn.microsoft.com/en-us/dotnet/api/system.text.regularexpressions.regex.replace?view=net-7.0#system-text-regularexpressions-regex-replace(system-string-system-string-system-int32)\" rel=\"nofollow noreferrer\">numbered parameter</a> in <code>rx.Replace</code>. only the first match is used.</p>\n<pre class=\"lang-cs prettyprint-override\"><code>String pattern = @&quot;The&quot;;\nRegex rx = new Regex(pattern);\n\nstring text = &quot;the The quick the brown fox  fox jumps over the lazy dog dog.&quot;;\n\nstring result = rx.Replace(text, &quot;&quot; , 1);\nConsole.WriteLine (result.Trim());\n</code></pre>\n"}],"owner":{"account_id":6782089,"reputation":63,"user_id":5221952,"display_name":"Page"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":165,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1695376508,"creation_date":1439445416,"question_id":31980475,"body_markdown":"I&#39;m trying to translate a piece of code from java to c# but I can&#39;t find how to do it properly.\r\nThe piece i need to translate is this:\r\n(getPattern returns a Pattern and data is a type that has a pattern variable and an enum (TokenType))\r\n\r\n    Match matcher = data.getPattern().matcher(str);//ThisLine\r\n    if (matcher.find())//ThisLine\r\n    {\r\n         String token = matcher.group().trim();//This Line\r\n         str = matcher.replaceFirst(&quot;&quot;); //This Line\r\n\r\n         if (data.getType() == TokenType.String_Literal)\r\n         {\r\n              return (lastToken = new Token(token.Substring(1, token.Length - 1), TokenType.String_Literal));\r\n         }\r\n         else\r\n         {\r\n              return (lastToken = new Token(token, data.getType()));\r\n         }\r\n    }\r\n\r\n\r\n    \r\nI tried to translate it and got this:\r\n\r\n     Match matcher = data.getRegex().Match(str);\r\n     if (matcher.Success)\r\n     {\r\n          String token = matcher.Value.Trim();\r\n          str = data.getRegex().Replace(token, &quot;&quot;, 1);\r\n\r\n          if (data.getType() == TokenType.String_Literal)\r\n          {\r\n               return (lastToken = new Token(token.Substring(1, token.Length - 1), TokenType.String_Literal));\r\n          }\r\n          else\r\n          {\r\n               return (lastToken = new Token(token, data.getType()));\r\n          }\r\n     }\r\n\r\nI&#39;m not at 100% understanding with the code but the parts all seem to be the correct replacement, they seem to do the same thing (when i read about them). They don&#39;t give any errors but the problem is that the c# code doesn&#39;t behave like the java code correctly.  \r\n\r\nEdit: I simply cannot find the c# equivalent of these lines of code.\r\n\r\n\r\n    Matcher matcher = A_Pattern.matcher(A_String)\r\n    matcher = matcher.group().trim();\r\n    boolean A_bool = matcher.find\r\n    String Another_String = matcher.replaceFirst(&quot;&quot;);","title":"Java to C# can&#39;t Translate code (Matcher.group() &amp; Matcher.replaceFirst)","body":"<p>I'm trying to translate a piece of code from java to c# but I can't find how to do it properly.\nThe piece i need to translate is this:\n(getPattern returns a Pattern and data is a type that has a pattern variable and an enum (TokenType))</p>\n\n<pre><code>Match matcher = data.getPattern().matcher(str);//ThisLine\nif (matcher.find())//ThisLine\n{\n     String token = matcher.group().trim();//This Line\n     str = matcher.replaceFirst(\"\"); //This Line\n\n     if (data.getType() == TokenType.String_Literal)\n     {\n          return (lastToken = new Token(token.Substring(1, token.Length - 1), TokenType.String_Literal));\n     }\n     else\n     {\n          return (lastToken = new Token(token, data.getType()));\n     }\n}\n</code></pre>\n\n<p>I tried to translate it and got this:</p>\n\n<pre><code> Match matcher = data.getRegex().Match(str);\n if (matcher.Success)\n {\n      String token = matcher.Value.Trim();\n      str = data.getRegex().Replace(token, \"\", 1);\n\n      if (data.getType() == TokenType.String_Literal)\n      {\n           return (lastToken = new Token(token.Substring(1, token.Length - 1), TokenType.String_Literal));\n      }\n      else\n      {\n           return (lastToken = new Token(token, data.getType()));\n      }\n }\n</code></pre>\n\n<p>I'm not at 100% understanding with the code but the parts all seem to be the correct replacement, they seem to do the same thing (when i read about them). They don't give any errors but the problem is that the c# code doesn't behave like the java code correctly.  </p>\n\n<p>Edit: I simply cannot find the c# equivalent of these lines of code.</p>\n\n<pre><code>Matcher matcher = A_Pattern.matcher(A_String)\nmatcher = matcher.group().trim();\nboolean A_bool = matcher.find\nString Another_String = matcher.replaceFirst(\"\");\n</code></pre>\n"},{"tags":["java","kotlin","native","kotlin-native"],"comments":[{"owner":{"account_id":5168089,"reputation":26671,"user_id":4137489,"accept_rate":100,"display_name":"marstran"},"score":0,"creation_date":1512206768,"post_id":47604276,"comment_id":82171206,"body_markdown":"I guess you could normal `exit` function from C.","body":"I guess you could normal <code>exit</code> function from C."}],"answers":[{"tags":[],"owner":{"account_id":6473006,"reputation":27420,"user_id":6296561,"accept_rate":95,"display_name":"Zoe is on strike"},"down_vote_count":0,"up_vote_count":20,"is_accepted":true,"score":20,"last_activity_date":1695376447,"creation_date":1517233575,"answer_id":48502754,"question_id":47604276,"body_markdown":"Use `exitProcess`:\r\n\r\n    import kotlin.system.exitProcess\r\n    ...\r\n    exitProcess(exitCode)\r\n\r\n[Declaration and documentation](https://github.com/JetBrains/kotlin/blob/master/kotlin-native/runtime/src/main/kotlin/kotlin/system/Process.kt#L19) in the Kotlin source code.\r\n\r\n","title":"Kotlin Native equivalent of System.exit(-1)","body":"<p>Use <code>exitProcess</code>:</p>\n<pre><code>import kotlin.system.exitProcess\n...\nexitProcess(exitCode)\n</code></pre>\n<p><a href=\"https://github.com/JetBrains/kotlin/blob/master/kotlin-native/runtime/src/main/kotlin/kotlin/system/Process.kt#L19\" rel=\"nofollow noreferrer\">Declaration and documentation</a> in the Kotlin source code.</p>\n"}],"owner":{"account_id":5372553,"reputation":3631,"user_id":4280615,"accept_rate":73,"display_name":"Nate Vaughan"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":9073,"favorite_count":0,"down_vote_count":0,"up_vote_count":13,"accepted_answer_id":48502754,"answer_count":1,"score":13,"last_activity_date":1695376447,"creation_date":1512185383,"question_id":47604276,"body_markdown":"In the following Kotlin/JVM program `System.exit(-1)` stops the execution of the program with an error exit code:\r\n\r\n    fun main(args: Array&lt;String&gt;) {\r\n        if (args.size &lt; 2) {\r\n            println(&quot;too few args!&quot;)\r\n            System.exit(-1)\r\n        }\r\n        println(&quot;Hello, ${args[1]} from ${args[0]}&quot;)\r\n    }\r\n\r\nKotlin/Native does not have access to any Java classes, including `System`. So what would the equivalent function be for a Kotlin/Native program to stop execution of the program with an error code?","title":"Kotlin Native equivalent of System.exit(-1)","body":"<p>In the following Kotlin/JVM program <code>System.exit(-1)</code> stops the execution of the program with an error exit code:</p>\n\n<pre><code>fun main(args: Array&lt;String&gt;) {\n    if (args.size &lt; 2) {\n        println(\"too few args!\")\n        System.exit(-1)\n    }\n    println(\"Hello, ${args[1]} from ${args[0]}\")\n}\n</code></pre>\n\n<p>Kotlin/Native does not have access to any Java classes, including <code>System</code>. So what would the equivalent function be for a Kotlin/Native program to stop execution of the program with an error code?</p>\n"},{"tags":["java","spring","jsp","spring-mvc","jsp-tags"],"comments":[{"owner":{"account_id":4474969,"reputation":1676,"user_id":3640307,"accept_rate":71,"display_name":"Sajib Acharya"},"score":1,"creation_date":1462996452,"post_id":37171879,"comment_id":61878875,"body_markdown":"Try this. Use a **getter** method to get the list of exercises from your `goal` object. `List&lt;Exercises&gt; e = goal.getExercises()`. Next iterate over this list like `for(Exercise ex : e) { ex.getParameter() ... }`. Tell me if this works.","body":"Try this. Use a <b>getter</b> method to get the list of exercises from your <code>goal</code> object. <code>List&lt;Exercises&gt; e = goal.getExercises()</code>. Next iterate over this list like <code>for(Exercise ex : e) { ex.getParameter() ... }</code>. Tell me if this works."},{"owner":{"account_id":3354052,"reputation":1057,"user_id":2817452,"display_name":"Leonardo Lobato"},"score":0,"creation_date":1462997631,"post_id":37171879,"comment_id":61879487,"body_markdown":"Thanks @SajibAcharya but one more thing, how my .jsp file should be structured to make it possible?","body":"Thanks @SajibAcharya but one more thing, how my .jsp file should be structured to make it possible?"},{"owner":{"account_id":4474969,"reputation":1676,"user_id":3640307,"accept_rate":71,"display_name":"Sajib Acharya"},"score":1,"creation_date":1462998185,"post_id":37171879,"comment_id":61879789,"body_markdown":"Though this is out of your current question context, but I thought you already knew how to do that since you mentioned you went through some tutorials. Anyway, look into [this](http://bitbybitblog.com/forms-and-data-models-in-spring-mvc/) tutorial, this&#39;ll give you a pretty good idea of what to do. We need to use wrapper classes and use spring forms since spring forms can handle only one object at a time. Or else if you are stuck, you should really ask a new question on that, as it literally forms a new question far apart from the current context.","body":"Though this is out of your current question context, but I thought you already knew how to do that since you mentioned you went through some tutorials. Anyway, look into <a href=\"http://bitbybitblog.com/forms-and-data-models-in-spring-mvc/\" rel=\"nofollow noreferrer\">this</a> tutorial, this&#39;ll give you a pretty good idea of what to do. We need to use wrapper classes and use spring forms since spring forms can handle only one object at a time. Or else if you are stuck, you should really ask a new question on that, as it literally forms a new question far apart from the current context."},{"owner":{"account_id":3354052,"reputation":1057,"user_id":2817452,"display_name":"Leonardo Lobato"},"score":0,"creation_date":1462998612,"post_id":37171879,"comment_id":61880033,"body_markdown":"That&#39;s the point, the form, with one object I can handle, the problem is when dealing with two objects, especially when one is nested inside the other like in the example I&#39;ve described above.","body":"That&#39;s the point, the form, with one object I can handle, the problem is when dealing with two objects, especially when one is nested inside the other like in the example I&#39;ve described above."},{"owner":{"account_id":4474969,"reputation":1676,"user_id":3640307,"accept_rate":71,"display_name":"Sajib Acharya"},"score":1,"creation_date":1462998828,"post_id":37171879,"comment_id":61880158,"body_markdown":"You cannot create a form with two objects. Since you can send only one object from within the Model. Use wrapper classes to literally wrap multiple classes as one.","body":"You cannot create a form with two objects. Since you can send only one object from within the Model. Use wrapper classes to literally wrap multiple classes as one."},{"owner":{"account_id":3354052,"reputation":1057,"user_id":2817452,"display_name":"Leonardo Lobato"},"score":0,"creation_date":1462999015,"post_id":37171879,"comment_id":61880253,"body_markdown":"ah! Okay I got it, thanks very much!","body":"ah! Okay I got it, thanks very much!"}],"owner":{"account_id":3354052,"reputation":1057,"user_id":2817452,"display_name":"Leonardo Lobato"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":183,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1695376294,"creation_date":1462995572,"question_id":37171879,"body_markdown":"I&#39;m studying Spring MVC and I can&#39;t figure out how to retrieve nested information from a form in a .jsp file to my controller.\r\n\r\nLet&#39;s say I have a form page where the user put information about a `Goal` and multiple `Exercise`, each one represents one Object, so the POJO of `Goal` would be something like that:\r\n\r\n    public class Goal{\r\n        private List&lt;Exercise&gt; exercises = new ArrayList&lt;Exercise&gt;();\r\n        ...\r\n    }\r\n\r\nAnd my controller, something like that:\r\n\r\n    @Controller\r\n    public class GoalController {\r\n    \t\r\n    \t@Autowired\r\n    \tprivate GoalService goalService;\r\n    \t\r\n    \t@RequestMapping(value = &quot;addGoal&quot;, method = RequestMethod.POST)\r\n    \tpublic String updateGoal(@ModelAttribute(&quot;goal&quot;) Goal goal)   {\r\n    \r\n    \t\tgoalService.save(goal);\t\r\n    \t\treturn &quot;redirect:index.jsp&quot;;\r\n    \t}\r\n    }\r\n\r\nThe problem in this case is, I know how to get the `Goal` prior information, but I don&#39;t know how to get the `Exercise` information that is nested.\r\n\r\nI&#39;ve looked for some information about it, but just found articles talking about how to *show* nested information on the page, not *retrieve* it.\r\n\r\nHow should my .jsp page be structured to allow this?","title":"Retrieve nested information from a .JSP File/Form in Spring MVC","body":"<p>I'm studying Spring MVC and I can't figure out how to retrieve nested information from a form in a .jsp file to my controller.</p>\n<p>Let's say I have a form page where the user put information about a <code>Goal</code> and multiple <code>Exercise</code>, each one represents one Object, so the POJO of <code>Goal</code> would be something like that:</p>\n<pre><code>public class Goal{\n    private List&lt;Exercise&gt; exercises = new ArrayList&lt;Exercise&gt;();\n    ...\n}\n</code></pre>\n<p>And my controller, something like that:</p>\n<pre><code>@Controller\npublic class GoalController {\n    \n    @Autowired\n    private GoalService goalService;\n    \n    @RequestMapping(value = &quot;addGoal&quot;, method = RequestMethod.POST)\n    public String updateGoal(@ModelAttribute(&quot;goal&quot;) Goal goal)   {\n\n        goalService.save(goal); \n        return &quot;redirect:index.jsp&quot;;\n    }\n}\n</code></pre>\n<p>The problem in this case is, I know how to get the <code>Goal</code> prior information, but I don't know how to get the <code>Exercise</code> information that is nested.</p>\n<p>I've looked for some information about it, but just found articles talking about how to <em>show</em> nested information on the page, not <em>retrieve</em> it.</p>\n<p>How should my .jsp page be structured to allow this?</p>\n"},{"tags":["java","multithreading"],"comments":[{"owner":{"account_id":91900,"reputation":4872,"user_id":252116,"display_name":"Ilia K."},"score":1,"creation_date":1331730250,"post_id":9700871,"comment_id":12331031,"body_markdown":"Rule of thumb: 1) never use `yield()`; 2) use `sleep()` only when the program is *explicitly* required to wait for the specified amount of time (if you only need to &quot;wait a little bit&quot;, most chances are that you are doing it wrong and you need to implement a proper waiting/signaling mechanism).","body":"Rule of thumb: 1) never use <code>yield()</code>; 2) use <code>sleep()</code> only when the program is <i>explicitly</i> required to wait for the specified amount of time (if you only need to &quot;wait a little bit&quot;, most chances are that you are doing it wrong and you need to implement a proper waiting/signaling mechanism)."}],"answers":[{"tags":[],"owner":{"account_id":428148,"reputation":3078,"user_id":810277,"accept_rate":55,"display_name":"Anantha Krishnan"},"down_vote_count":0,"up_vote_count":155,"is_accepted":false,"score":155,"last_activity_date":1607008990,"creation_date":1331724150,"answer_id":9700972,"question_id":9700871,"body_markdown":"We can prevent a thread from execution by using any of the 3 methods of Thread class:\r\n\r\n1. `yield()` method pauses the currently executing thread temporarily for giving a chance to the remaining waiting threads of the same priority or higher priority to execute. If there is no waiting thread or all the waiting threads have a lower priority then the same thread will continue its execution. The yielded thread when it will get the chance for execution is decided by the thread scheduler whose behavior is vendor dependent.\r\n    \r\n2. `join()` If any executing thread t1 calls `join()` on t2 (i.e. `t2.join()`) immediately t1 will enter into waiting state until t2 completes its execution.\r\n    \r\n3. `sleep()` Based on our requirement we can make a thread to be in sleeping state for a specified period of time (hope not much explanation required for our favorite method).","title":"What is difference between sleep() method and yield() method of multi threading?","body":"<p>We can prevent a thread from execution by using any of the 3 methods of Thread class:</p>\n<ol>\n<li><p><code>yield()</code> method pauses the currently executing thread temporarily for giving a chance to the remaining waiting threads of the same priority or higher priority to execute. If there is no waiting thread or all the waiting threads have a lower priority then the same thread will continue its execution. The yielded thread when it will get the chance for execution is decided by the thread scheduler whose behavior is vendor dependent.</p>\n</li>\n<li><p><code>join()</code> If any executing thread t1 calls <code>join()</code> on t2 (i.e. <code>t2.join()</code>) immediately t1 will enter into waiting state until t2 completes its execution.</p>\n</li>\n<li><p><code>sleep()</code> Based on our requirement we can make a thread to be in sleeping state for a specified period of time (hope not much explanation required for our favorite method).</p>\n</li>\n</ol>\n"},{"tags":[],"owner":{"account_id":962030,"reputation":13691,"user_id":986169,"accept_rate":75,"display_name":"giorashc"},"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1331724173,"creation_date":1331724173,"answer_id":9700982,"question_id":9700871,"body_markdown":"Sleep causes thread to suspend itself for x milliseconds while yield suspends the thread and immediately moves it to the ready queue (the queue which the CPU uses to run threads). \r\n\r\n","title":"What is difference between sleep() method and yield() method of multi threading?","body":"<p>Sleep causes thread to suspend itself for x milliseconds while yield suspends the thread and immediately moves it to the ready queue (the queue which the CPU uses to run threads). </p>\n"},{"tags":[],"owner":{"account_id":9193,"reputation":343113,"user_id":16883,"accept_rate":83,"display_name":"Michael Borgwardt"},"down_vote_count":2,"up_vote_count":115,"is_accepted":true,"score":113,"last_activity_date":1331724184,"creation_date":1331724184,"answer_id":9700983,"question_id":9700871,"body_markdown":"`sleep()` causes the thread to definitely stop executing for a given amount of time; if no other thread or process needs to be run, the CPU will be idle (and probably enter a power saving mode).\r\n\r\n`yield()` basically means that the thread is not doing anything particularly important and if any other threads or processes need to be run, they should. Otherwise, the current thread will continue to run.","title":"What is difference between sleep() method and yield() method of multi threading?","body":"<p><code>sleep()</code> causes the thread to definitely stop executing for a given amount of time; if no other thread or process needs to be run, the CPU will be idle (and probably enter a power saving mode).</p>\n\n<p><code>yield()</code> basically means that the thread is not doing anything particularly important and if any other threads or processes need to be run, they should. Otherwise, the current thread will continue to run.</p>\n"},{"tags":[],"owner":{"account_id":439593,"reputation":15022,"user_id":828625,"accept_rate":88,"display_name":"Kazekage Gaara"},"down_vote_count":1,"up_vote_count":34,"is_accepted":false,"score":33,"last_activity_date":1695376220,"creation_date":1331724407,"answer_id":9701048,"question_id":9700871,"body_markdown":"[Sleep()][1] causes the currently executing thread to sleep (temporarily cease execution).\r\n\r\n[Yield()][2] causes the currently executing thread object to temporarily pause and allow other threads to execute. \r\n\r\n\r\n ![enter image description here][3]\r\n\r\n\r\n\r\n  [1]: http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Thread.html#sleep%28long%29\r\n  [2]: http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Thread.html#yield%28%29\r\n  [3]: http://i.stack.imgur.com/yZVZk.gif\r\n  ","title":"What is difference between sleep() method and yield() method of multi threading?","body":"<p><a href=\"http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Thread.html#sleep%28long%29\" rel=\"nofollow noreferrer\">Sleep()</a> causes the currently executing thread to sleep (temporarily cease execution).</p>\n<p><a href=\"http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Thread.html#yield%28%29\" rel=\"nofollow noreferrer\">Yield()</a> causes the currently executing thread object to temporarily pause and allow other threads to execute.</p>\n<p><img src=\"https://i.stack.imgur.com/yZVZk.gif\" alt=\"enter image description here\" /></p>\n"},{"tags":[],"owner":{"account_id":928111,"reputation":1021,"user_id":958470,"accept_rate":12,"display_name":"Sai Sunder"},"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1546492739,"creation_date":1390977662,"answer_id":21423891,"question_id":9700871,"body_markdown":"sleep()causes the thread to definitely stop executing for a given amount of time; if no other thread or process needs to be run, the CPU will be idle (and probably enter a power saving mode).\r\nyield()basically means that the thread is not doing anything particularly important and if any other threads or processes need to be run, they should. Otherwise, the current thread will continue to run.\r\n","title":"What is difference between sleep() method and yield() method of multi threading?","body":"<p>sleep()causes the thread to definitely stop executing for a given amount of time; if no other thread or process needs to be run, the CPU will be idle (and probably enter a power saving mode).\nyield()basically means that the thread is not doing anything particularly important and if any other threads or processes need to be run, they should. Otherwise, the current thread will continue to run.</p>\n"},{"tags":[],"owner":{"account_id":4306699,"reputation":51,"user_id":3518889,"display_name":"Preetham"},"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1397123593,"creation_date":1397123593,"answer_id":22984553,"question_id":9700871,"body_markdown":"Yield : will make thread to wait for the currently executing thread and the thread which has called yield() will attaches itself at the end of the thread execution. The thread which call yield() will be in Blocked state till its turn.\r\n\r\nSleep : will cause the thread to sleep in sleep mode for span of time mentioned in arguments. \r\n\r\nJoin : t1 and t2 are two threads , t2.join() is called then t1 enters into wait state until t2 completes execution. Then t1 will into runnable state then our specialist JVM thread scheduler will pick t1 based on criteria&#39;s. \r\n\r\n","title":"What is difference between sleep() method and yield() method of multi threading?","body":"<p>Yield : will make thread to wait for the currently executing thread and the thread which has called yield() will attaches itself at the end of the thread execution. The thread which call yield() will be in Blocked state till its turn.</p>\n\n<p>Sleep : will cause the thread to sleep in sleep mode for span of time mentioned in arguments. </p>\n\n<p>Join : t1 and t2 are two threads , t2.join() is called then t1 enters into wait state until t2 completes execution. Then t1 will into runnable state then our specialist JVM thread scheduler will pick t1 based on criteria's. </p>\n"},{"tags":[],"owner":{"account_id":4735248,"reputation":2938,"user_id":3829818,"display_name":"Prashant_M"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1547167678,"creation_date":1460125777,"answer_id":36502243,"question_id":9700871,"body_markdown":"**Yield**: It is a hint (not guaranteed) to the scheduler that you have done enough and that some other thread of same priority might run and use the CPU.\r\n\r\n    Thread.sleep();\r\n\r\n**Sleep**: It blocks the execution of that particular thread for a given time.\r\n\r\n    TimeUnit.MILLISECONDS.sleep(1000);","title":"What is difference between sleep() method and yield() method of multi threading?","body":"<p><strong>Yield</strong>: It is a hint (not guaranteed) to the scheduler that you have done enough and that some other thread of same priority might run and use the CPU.</p>\n\n<pre><code>Thread.sleep();\n</code></pre>\n\n<p><strong>Sleep</strong>: It blocks the execution of that particular thread for a given time.</p>\n\n<pre><code>TimeUnit.MILLISECONDS.sleep(1000);\n</code></pre>\n"},{"tags":[],"owner":{"account_id":8004185,"reputation":1391,"user_id":6037956,"display_name":"Soudipta Dutta"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1546394477,"creation_date":1524423316,"answer_id":49969599,"question_id":9700871,"body_markdown":"One way to request the current thread to relinquish CPU so that other threads can get a chance to execute is to use `yield` in Java.\r\n\r\n`yield` is a static method.\r\nIt doesn&#39;t say which other thread will get the CPU.\r\nIt is possible for the same thread to get back the CPU and start its execution again.\r\n\r\n&lt;!-- language: java --&gt;\r\n\r\n    public class Solution9  {\r\n    \r\n    public static void main(String[] args) {\r\n    \t\tyclass yy = new yclass ();\r\n    \t\tThread t1= new Thread(yy);\r\n    \t\tt1.start();\r\n    \t\tfor (int i = 0; i &lt;3; i++) {\r\n    \t\t\tThread.yield();\r\n    \t\t\tSystem.out.println(&quot;during yield control =&gt; &quot; + Thread.currentThread().getName());\r\n    \t\t}\r\n    \t}\r\n    }\r\n    \r\n    class yclass implements Runnable{\r\n    \r\n    \t@Override\r\n    \tpublic void run() {\r\n    \t\tfor (int i = 0; i &lt; 3; i++) {\r\n    \t\t\tSystem.out.println(&quot;control =&gt; &quot; + Thread.currentThread().getName());\r\n    \t\t}\r\n    \t}\r\n    }\r\n","title":"What is difference between sleep() method and yield() method of multi threading?","body":"<p>One way to request the current thread to relinquish CPU so that other threads can get a chance to execute is to use <code>yield</code> in Java.</p>\n\n<p><code>yield</code> is a static method.\nIt doesn't say which other thread will get the CPU.\nIt is possible for the same thread to get back the CPU and start its execution again.</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>public class Solution9  {\n\npublic static void main(String[] args) {\n        yclass yy = new yclass ();\n        Thread t1= new Thread(yy);\n        t1.start();\n        for (int i = 0; i &lt;3; i++) {\n            Thread.yield();\n            System.out.println(\"during yield control =&gt; \" + Thread.currentThread().getName());\n        }\n    }\n}\n\nclass yclass implements Runnable{\n\n    @Override\n    public void run() {\n        for (int i = 0; i &lt; 3; i++) {\n            System.out.println(\"control =&gt; \" + Thread.currentThread().getName());\n        }\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":6689932,"reputation":81,"user_id":5159723,"display_name":"Pankaj Goyal"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1544418534,"creation_date":1525116585,"answer_id":50106977,"question_id":9700871,"body_markdown":"yield(): yield method is used to pause the execution of currently running process so that other waiting thread with the same priority will get CPU to execute.Threads with lower priority will not be executed on yield. if there is no waiting thread then this thread will start its execution.\r\n\r\njoin(): join method stops currently executing thread and wait for another to complete on which in calls the join method after that it will resume its own execution.\r\n\r\n\r\nFor detailed explanation, see [this link][1].\r\n\r\n\r\n  [1]: https://theweblearn.blogspot.in/2018/04/difference-between-yield-and-join.html","title":"What is difference between sleep() method and yield() method of multi threading?","body":"<p>yield(): yield method is used to pause the execution of currently running process so that other waiting thread with the same priority will get CPU to execute.Threads with lower priority will not be executed on yield. if there is no waiting thread then this thread will start its execution.</p>\n\n<p>join(): join method stops currently executing thread and wait for another to complete on which in calls the join method after that it will resume its own execution.</p>\n\n<p>For detailed explanation, see <a href=\"https://theweblearn.blogspot.in/2018/04/difference-between-yield-and-join.html\" rel=\"nofollow noreferrer\">this link</a>.</p>\n"},{"tags":[],"owner":{"account_id":5999902,"reputation":111,"user_id":4713505,"display_name":"Sumit Singh"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1609871713,"creation_date":1548359622,"answer_id":54354365,"question_id":9700871,"body_markdown":"Yield():  method will stop the currently executing thread and give a chance to another thread of same priority which are waiting in queue. If thier is no thread then current thread will continue to execute. **CPU will never be in ideal state**.\r\n\r\nSleep(): method will stop the thread for particular time (time will be given in milisecond). If this is single thread which is running then **CPU will be in ideal state** at that period of time.\r\n\r\nBoth are static menthod.","title":"What is difference between sleep() method and yield() method of multi threading?","body":"<p>Yield():  method will stop the currently executing thread and give a chance to another thread of same priority which are waiting in queue. If thier is no thread then current thread will continue to execute. <strong>CPU will never be in ideal state</strong>.</p>\n<p>Sleep(): method will stop the thread for particular time (time will be given in milisecond). If this is single thread which is running then <strong>CPU will be in ideal state</strong> at that period of time.</p>\n<p>Both are static menthod.</p>\n"},{"tags":[],"owner":{"account_id":19849639,"reputation":1,"user_id":14540401,"display_name":"asxd"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1603963877,"creation_date":1603951672,"answer_id":64585851,"question_id":9700871,"body_markdown":"`sleep()` causes the thread to definitely stop executing for a given amount of time; if no other thread or process needs to be run, the CPU will be idle (and probably enter a power saving mode).  \r\n\r\n`yield()` basically means that the thread is not doing anything particularly important and if any other threads or processes need to be run, they should. Otherwise, the current thread will continue to run.","title":"What is difference between sleep() method and yield() method of multi threading?","body":"<p><code>sleep()</code> causes the thread to definitely stop executing for a given amount of time; if no other thread or process needs to be run, the CPU will be idle (and probably enter a power saving mode).</p>\n<p><code>yield()</code> basically means that the thread is not doing anything particularly important and if any other threads or processes need to be run, they should. Otherwise, the current thread will continue to run.</p>\n"},{"tags":[],"owner":{"account_id":19273932,"reputation":11,"user_id":14087366,"display_name":"Incredible 1710"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1604771601,"creation_date":1604771601,"answer_id":64730726,"question_id":9700871,"body_markdown":"Both methods are used to prevent thread execution.\r\nBut specifically,\r\nsleep():\r\npurpose:if a thread don&#39;t want to perform any operation for particular amount of time then we should go for sleep().for e.x. slide show .\r\nyield():\r\npurpose:if a thread wants to pause it&#39;s execution to give chance of execution to another waiting threads of same priority.thread which requires more execution time should call yield() in between execution.\r\n\r\nNote:some platform may not provide proper support for yield() . because underlying system may not provide support for preemptive scheduling.moreover yield() is native method.","title":"What is difference between sleep() method and yield() method of multi threading?","body":"<p>Both methods are used to prevent thread execution.\nBut specifically,\nsleep():\npurpose:if a thread don't want to perform any operation for particular amount of time then we should go for sleep().for e.x. slide show .\nyield():\npurpose:if a thread wants to pause it's execution to give chance of execution to another waiting threads of same priority.thread which requires more execution time should call yield() in between execution.</p>\n<p>Note:some platform may not provide proper support for yield() . because underlying system may not provide support for preemptive scheduling.moreover yield() is native method.</p>\n"}],"owner":{"account_id":463980,"reputation":6162,"user_id":867206,"accept_rate":14,"display_name":"Ajay Takur"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":170945,"favorite_count":0,"down_vote_count":2,"up_vote_count":73,"accepted_answer_id":9700983,"answer_count":12,"score":71,"last_activity_date":1695376220,"creation_date":1331723823,"question_id":9700871,"body_markdown":"As currently executing thread while it encounters the call [`sleep()`][1] then thread moves immediately into sleeping stat.\r\nWhereas for [`yield()`][2] thread moves into *runnable* state / *ready* state. \r\n\r\n\r\n  [1]: http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Thread.html#sleep%28long%29\r\n  [2]: http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Thread.html#yield%28%29","title":"What is difference between sleep() method and yield() method of multi threading?","body":"<p>As currently executing thread while it encounters the call <a href=\"http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Thread.html#sleep%28long%29\" rel=\"noreferrer\"><code>sleep()</code></a> then thread moves immediately into sleeping stat.\nWhereas for <a href=\"http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Thread.html#yield%28%29\" rel=\"noreferrer\"><code>yield()</code></a> thread moves into <em>runnable</em> state / <em>ready</em> state.</p>\n"},{"tags":["java","maven","compilation","google-cloud-dataflow","apache-beam"],"comments":[{"owner":{"account_id":27880607,"reputation":314,"user_id":21289117,"display_name":"XQ Hu"},"score":0,"creation_date":1695504189,"post_id":77156564,"comment_id":136033993,"body_markdown":"Have you checked this example? https://github.com/GoogleCloudPlatform/dataflow-cookbook/tree/main/Java","body":"Have you checked this example? <a href=\"https://github.com/GoogleCloudPlatform/dataflow-cookbook/tree/main/Java\" rel=\"nofollow noreferrer\">github.com/GoogleCloudPlatform/dataflow-cookbook/tree/main/J&zwnj;&#8203;ava</a>"},{"owner":{"account_id":29507894,"reputation":3,"user_id":22613539,"display_name":"kbenzakrilelp"},"score":0,"creation_date":1695721949,"post_id":77156564,"comment_id":136059261,"body_markdown":"Well, I&#39;ve seen many examples, but I still don&#39;t understand how it works","body":"Well, I&#39;ve seen many examples, but I still don&#39;t understand how it works"},{"owner":{"account_id":1874246,"reputation":1390,"user_id":1695821,"display_name":"Bruno Volpato"},"score":0,"creation_date":1695905065,"post_id":77156564,"comment_id":136087930,"body_markdown":"We have some plans to make a more self-contained project / Maven archetype, but there&#39;s some work to do. I&#39;d say that for now you could simply start off from this POM https://github.com/GoogleCloudPlatform/DataflowTemplates/blob/main/v1/pom.xml so you can compile your code.","body":"We have some plans to make a more self-contained project / Maven archetype, but there&#39;s some work to do. I&#39;d say that for now you could simply start off from this POM <a href=\"https://github.com/GoogleCloudPlatform/DataflowTemplates/blob/main/v1/pom.xml\" rel=\"nofollow noreferrer\">github.com/GoogleCloudPlatform/DataflowTemplates/blob/main/v&zwnj;&#8203;1/&hellip;</a> so you can compile your code."}],"owner":{"account_id":29507894,"reputation":3,"user_id":22613539,"display_name":"kbenzakrilelp"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":53,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1695376214,"creation_date":1695376214,"question_id":77156564,"body_markdown":"I&#39;m trying to write a Dataflow Classic Template in Java which I&#39;m not used to. I copied the code from the **Bulk Decompress Cloud Storage Files** template that decompress gzip files, then I added some lines to extract files from the resulting tar file (as in my case, I&#39;m trying to decompress a .tar.gz file).\r\nHowever, I get stuck compiling the code with Maven, I don&#39;t know how to do my files and folder structure, and I really don&#39;t know what to write in the pom.xml file.\r\n\r\n\r\n\r\n```\r\n/*\r\n * Copyright (C) 2018 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not\r\n * use this file except in compliance with the License. You may obtain a copy of\r\n * the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT\r\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\r\n * License for the specific language governing permissions and limitations under\r\n * the License.\r\n */\r\npackage com.google.cloud.teleport.templates;\r\n\r\nimport com.google.cloud.teleport.metadata.Template;\r\nimport com.google.cloud.teleport.metadata.TemplateCategory;\r\nimport com.google.cloud.teleport.metadata.TemplateParameter;\r\nimport com.google.cloud.teleport.templates.BulkDecompressor.Options;\r\nimport com.google.common.annotations.VisibleForTesting;\r\nimport com.google.common.collect.ImmutableList;\r\nimport com.google.common.io.ByteStreams;\r\nimport com.google.common.io.Files;\r\nimport java.io.IOException;\r\nimport java.io.StringWriter;\r\nimport java.nio.channels.ReadableByteChannel;\r\nimport java.nio.channels.WritableByteChannel;\r\nimport java.util.Set;\r\nimport java.util.stream.Collectors;\r\nimport java.util.stream.Stream;\r\nimport javax.annotation.Nullable;\r\nimport org.apache.beam.sdk.Pipeline;\r\nimport org.apache.beam.sdk.PipelineResult;\r\nimport org.apache.beam.sdk.io.Compression;\r\nimport org.apache.beam.sdk.io.FileIO;\r\nimport org.apache.beam.sdk.io.FileSystems;\r\nimport org.apache.beam.sdk.io.TextIO;\r\nimport org.apache.beam.sdk.io.fs.MatchResult;\r\nimport org.apache.beam.sdk.io.fs.MoveOptions;\r\nimport org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions;\r\nimport org.apache.beam.sdk.io.fs.ResourceId;\r\nimport org.apache.beam.sdk.options.PipelineOptions;\r\nimport org.apache.beam.sdk.options.PipelineOptionsFactory;\r\nimport org.apache.beam.sdk.options.Validation.Required;\r\nimport org.apache.beam.sdk.options.ValueProvider;\r\nimport org.apache.beam.sdk.transforms.DoFn;\r\nimport org.apache.beam.sdk.transforms.MapElements;\r\nimport org.apache.beam.sdk.transforms.ParDo;\r\nimport org.apache.beam.sdk.util.MimeTypes;\r\nimport org.apache.beam.sdk.values.KV;\r\nimport org.apache.beam.sdk.values.PCollectionTuple;\r\nimport org.apache.beam.sdk.values.TupleTag;\r\nimport org.apache.beam.sdk.values.TupleTagList;\r\nimport org.apache.beam.sdk.values.TypeDescriptors;\r\nimport org.apache.commons.compress.archivers.tar.TarArchiveEntry;\r\nimport org.apache.commons.compress.archivers.tar.TarArchiveInputStream;\r\nimport org.apache.commons.csv.CSVFormat;\r\nimport org.apache.commons.csv.CSVPrinter;\r\nimport org.apache.commons.csv.QuoteMode;\r\nimport org.slf4j.Logger;\r\nimport org.slf4j.LoggerFactory;\r\n\r\n\r\n/**\r\n * This pipeline decompresses file(s) from Google Cloud Storage and re-uploads them to a destination\r\n * location.\r\n *\r\n * &lt;p&gt;&lt;b&gt;Parameters&lt;/b&gt;\r\n *\r\n * &lt;p&gt;The {@code --inputFilePattern} parameter specifies a file glob to process. Files found can be\r\n * expressed in the following formats:\r\n *\r\n * &lt;pre&gt;\r\n * --inputFilePattern=gs://bucket-name/compressed-dir/*\r\n * --inputFilePattern=gs://bucket-name/compressed-dir/demo*.gz\r\n * &lt;/pre&gt;\r\n *\r\n * &lt;p&gt;The {@code --outputDirectory} parameter can be expressed in the following formats:\r\n *\r\n * &lt;pre&gt;\r\n * --outputDirectory=gs://bucket-name\r\n * --outputDirectory=gs://bucket-name/decompressed-dir\r\n * &lt;/pre&gt;\r\n *\r\n * &lt;p&gt;The {@code --outputFailureFile} parameter indicates the file to write the names of the files\r\n * which failed decompression and their associated error messages. This file can then be used for\r\n * subsequent processing by another process outside of Dataflow (e.g. send an email with the\r\n * failures, etc.). If there are no failures, the file will still be created but will be empty. The\r\n * failure file structure contains both the file that caused the error and the error message in CSV\r\n * format. The file will contain one header row and two columns (Filename, Error). The filename\r\n * output to the failureFile will be the full path of the file for ease of debugging.\r\n *\r\n * &lt;pre&gt;\r\n * --outputFailureFile=gs://bucket-name/decompressed-dir/failed.csv\r\n * &lt;/pre&gt;\r\n *\r\n * &lt;p&gt;Example Output File:\r\n *\r\n * &lt;pre&gt;\r\n * Filename,Error\r\n * gs://docs-demo/compressedFile.gz, File is malformed or not compressed in BZIP2 format.\r\n * &lt;/pre&gt;\r\n *\r\n * &lt;p&gt;Check out &lt;a\r\n * href=&quot;https://github.com/GoogleCloudPlatform/DataflowTemplates/blob/main/v1/README_Bulk_Decompress_GCS_Files.md&quot;&gt;README&lt;/a&gt;\r\n * for instructions on how to use or modify this template.\r\n */\r\n@Template(\r\n    name = &quot;Bulk_Decompress_GCS_Files&quot;,\r\n    category = TemplateCategory.UTILITIES,\r\n    displayName = &quot;Bulk Decompress Files on Cloud Storage&quot;,\r\n    description = {\r\n      &quot;The Bulk Decompress Cloud Storage Files template is a batch pipeline that decompresses files on Cloud Storage to a specified location. &quot;\r\n          + &quot;This functionality is useful when you want to use compressed data to minimize network bandwidth costs during a migration, but would like to maximize analytical processing speed by operating on uncompressed data after migration. &quot;\r\n          + &quot;The pipeline automatically handles multiple compression modes during a single run and determines the decompression mode to use based on the file extension (.bzip2, .deflate, .gz, .zip).&quot;,\r\n      &quot;Note: The Bulk Decompress Cloud Storage Files template is intended for single compressed files and not compressed folders.&quot;\r\n    },\r\n    optionsClass = Options.class,\r\n    documentation =\r\n        &quot;https://cloud.google.com/dataflow/docs/guides/templates/provided/bulk-decompress-cloud-storage&quot;,\r\n    contactInformation = &quot;https://cloud.google.com/support&quot;,\r\n    requirements = {\r\n      &quot;The files to decompress must be in one of the following formats: Bzip2, Deflate, and Gzip.&quot;,\r\n      &quot;The output directory must exist prior to running the pipeline.&quot;\r\n    })\r\npublic class BulkDecompressor {\r\n\r\n  /** The logger to output status messages to. */\r\n  private static final Logger LOG = LoggerFactory.getLogger(BulkDecompressor.class);\r\n\r\n  /**\r\n   * A list of the {@link Compression} values excluding {@link Compression#AUTO} and {@link\r\n   * Compression#UNCOMPRESSED}.\r\n   */\r\n  @VisibleForTesting\r\n  static final Set&lt;Compression&gt; SUPPORTED_COMPRESSIONS =\r\n      Stream.of(Compression.values())\r\n          .filter(value -&gt; value != Compression.AUTO &amp;&amp; value != Compression.UNCOMPRESSED)\r\n          .collect(Collectors.toSet());\r\n\r\n  /** The error msg given when the pipeline matches a file but cannot determine the compression. */\r\n  @VisibleForTesting\r\n  static final String UNCOMPRESSED_ERROR_MSG =\r\n      &quot;Skipping file %s because it did not match any compression mode (%s)&quot;;\r\n\r\n  @VisibleForTesting\r\n  static final String MALFORMED_ERROR_MSG =\r\n      &quot;The file resource %s is malformed or not in %s compressed format.&quot;;\r\n\r\n  /** The tag used to identify the main output of the {@link Decompress} DoFn. */\r\n  @VisibleForTesting\r\n  static final TupleTag&lt;String&gt; DECOMPRESS_MAIN_OUT_TAG = new TupleTag&lt;String&gt;() {};\r\n\r\n  /** The tag used to identify the dead-letter sideOutput of the {@link Decompress} DoFn. */\r\n  @VisibleForTesting\r\n  static final TupleTag&lt;KV&lt;String, String&gt;&gt; DEADLETTER_TAG = new TupleTag&lt;KV&lt;String, String&gt;&gt;() {};\r\n\r\n  /**\r\n   * The {@link Options} class provides the custom execution options passed by the executor at the\r\n   * command-line.\r\n   */\r\n  public interface Options extends PipelineOptions {\r\n    @TemplateParameter.GcsReadFile(\r\n        order = 1,\r\n        description = &quot;Input Cloud Storage File(s)&quot;,\r\n        helpText = &quot;The Cloud Storage location of the files you&#39;d like to process.&quot;,\r\n        example = &quot;gs://your-bucket/your-files/*.gz&quot;)\r\n    @Required\r\n    ValueProvider&lt;String&gt; getInputFilePattern();\r\n\r\n    void setInputFilePattern(ValueProvider&lt;String&gt; value);\r\n\r\n    @TemplateParameter.GcsWriteFolder(\r\n        order = 2,\r\n        description = &quot;Output file directory in Cloud Storage&quot;,\r\n        helpText =\r\n            &quot;The path and filename prefix for writing output files. Must end with a slash. DateTime formatting is used to parse directory path for date &amp; time formatters.&quot;,\r\n        example = &quot;gs://your-bucket/decompressed/&quot;)\r\n    @Required\r\n    ValueProvider&lt;String&gt; getOutputDirectory();\r\n\r\n    void setOutputDirectory(ValueProvider&lt;String&gt; value);\r\n\r\n    @TemplateParameter.GcsWriteFile(\r\n        order = 3,\r\n        description = &quot;The output file for failures during the decompression process&quot;,\r\n        helpText =\r\n            &quot;The output file to write failures to during the decompression process. If there are no failures, the file will still be created but will be empty. The contents will be one line for each file which failed decompression in CSV format (Filename, Error). Note that this parameter will allow the pipeline to continue processing in the event of a failure.&quot;,\r\n        example = &quot;gs://your-bucket/decompressed/failed.csv&quot;)\r\n    @Required\r\n    ValueProvider&lt;String&gt; getOutputFailureFile();\r\n\r\n    void setOutputFailureFile(ValueProvider&lt;String&gt; value);\r\n  }\r\n\r\n  /**\r\n   * The main entry-point for pipeline execution. This method will start the pipeline but will not\r\n   * wait for it&#39;s execution to finish. If blocking execution is required, use the {@link\r\n   * BulkDecompressor#run(Options)} method to start the pipeline and invoke {@code\r\n   * result.waitUntilFinish()} on the {@link PipelineResult}.\r\n   *\r\n   * @param args The command-line args passed by the executor.\r\n   */\r\n  public static void main(String[] args) {\r\n\r\n    Options options = PipelineOptionsFactory.fromArgs(args).withValidation().as(Options.class);\r\n\r\n    run(options);\r\n  }\r\n\r\n  /**\r\n   * Runs the pipeline to completion with the specified options. This method does not wait until the\r\n   * pipeline is finished before returning. Invoke {@code result.waitUntilFinish()} on the result\r\n   * object to block until the pipeline is finished running if blocking programmatic execution is\r\n   * required.\r\n   *\r\n   * @param options The execution options.\r\n   * @return The pipeline result.\r\n   */\r\n  public static PipelineResult run(Options options) {\r\n\r\n    /*\r\n     * Steps:\r\n     *   1) Find all files matching the input pattern\r\n     *   2) Decompress the files found and output them to the output directory\r\n     *   3) Write any errors to the failure output file\r\n     */\r\n\r\n    // Create the pipeline\r\n    Pipeline pipeline = Pipeline.create(options);\r\n\r\n    // Run the pipeline over the work items.\r\n    PCollectionTuple decompressOut =\r\n        pipeline\r\n            .apply(&quot;MatchFile(s)&quot;, FileIO.match().filepattern(options.getInputFilePattern()))\r\n            .apply(\r\n                &quot;DecompressFile(s)&quot;,\r\n                ParDo.of(new Decompress(options.getOutputDirectory()))\r\n                    .withOutputTags(DECOMPRESS_MAIN_OUT_TAG, TupleTagList.of(DEADLETTER_TAG)));\r\n\r\n    decompressOut\r\n        .get(DEADLETTER_TAG)\r\n        .apply(\r\n            &quot;FormatErrors&quot;,\r\n            MapElements.into(TypeDescriptors.strings())\r\n                .via(\r\n                    kv -&gt; {\r\n                      StringWriter stringWriter = new StringWriter();\r\n                      try {\r\n                        CSVPrinter printer =\r\n                            new CSVPrinter(\r\n                                stringWriter,\r\n                                CSVFormat.DEFAULT\r\n                                    .withEscape(&#39;\\\\&#39;)\r\n                                    .withQuoteMode(QuoteMode.NONE)\r\n                                    .withRecordSeparator(&#39;\\n&#39;));\r\n                        printer.printRecord(kv.getKey(), kv.getValue());\r\n                      } catch (IOException e) {\r\n                        throw new RuntimeException(e);\r\n                      }\r\n\r\n                      return stringWriter.toString();\r\n                    }))\r\n\r\n        // We don&#39;t expect error files to be large so we&#39;ll create a single\r\n        // file for ease of reprocessing by processes outside of Dataflow.\r\n        .apply(\r\n            &quot;WriteErrorFile&quot;,\r\n            TextIO.write()\r\n                .to(options.getOutputFailureFile())\r\n                .withHeader(&quot;Filename,Error&quot;)\r\n                .withoutSharding());\r\n\r\n    return pipeline.run();\r\n  }\r\n\r\n  /**\r\n   * Performs the decompression of an object on Google Cloud Storage and uploads the decompressed\r\n   * object back to a specified destination location.\r\n   */\r\n  @SuppressWarnings(&quot;serial&quot;)\r\n  public static class Decompress extends DoFn&lt;MatchResult.Metadata, String&gt; {\r\n\r\n    private final ValueProvider&lt;String&gt; destinationLocation;\r\n\r\n    Decompress(ValueProvider&lt;String&gt; destinationLocation) {\r\n      this.destinationLocation = destinationLocation;\r\n    }\r\n\r\n    @ProcessElement\r\n    public void processElement(ProcessContext context) {\r\n      ResourceId inputFile = context.element().resourceId();\r\n\r\n      // Output a record to the failure file if the file doesn&#39;t match a known compression.\r\n      if (!Compression.AUTO.isCompressed(inputFile.toString())) {\r\n        String errorMsg =\r\n            String.format(UNCOMPRESSED_ERROR_MSG, inputFile.toString(), SUPPORTED_COMPRESSIONS);\r\n\r\n        context.output(DEADLETTER_TAG, KV.of(inputFile.toString(), errorMsg));\r\n      } else {\r\n        try {\r\n          ResourceId outputFile = decompress(inputFile);\r\n          context.output(outputFile.toString());\r\n        } catch (IOException e) {\r\n          LOG.error(e.getMessage());\r\n          context.output(DEADLETTER_TAG, KV.of(inputFile.toString(), e.getMessage()));\r\n        }\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Decompresses the inputFile using the specified compression and outputs to the main output of\r\n     * the {@link Decompress} doFn. Files output to the destination will be first written as temp\r\n     * files with a &quot;temp-&quot; prefix within the output directory. If a file fails decompression, the\r\n     * filename and the associated error will be output to the dead-letter.\r\n     *\r\n     * @param inputFile The inputFile to decompress.\r\n     * @return A {@link ResourceId} which points to the resulting file from the decompression.\r\n     */\r\n    private ResourceId decompress(ResourceId inputFile) throws IOException {\r\n      // Remove the compressed extension from the file. Example: demo.txt.gz -&gt; demo.txt\r\n      String outputFilename = Files.getNameWithoutExtension(inputFile.toString());\r\n\r\n      // Resolve the necessary resources to perform the transfer.\r\n      ResourceId outputDir = FileSystems.matchNewResource(destinationLocation.get(), true);\r\n      ResourceId outputFile =\r\n          outputDir.resolve(outputFilename, StandardResolveOptions.RESOLVE_FILE);\r\n      ResourceId tempFile =\r\n          outputDir.resolve(\r\n              Files.getFileExtension(inputFile.toString()) + &quot;-temp-&quot; + outputFilename,\r\n              StandardResolveOptions.RESOLVE_FILE);\r\n\r\n      // Resolve the compression\r\n      Compression compression = Compression.detect(inputFile.toString());\r\n\r\n      // Perform the copy of the decompressed channel into the destination.\r\n      try (ReadableByteChannel readerChannel =\r\n          compression.readDecompressed(FileSystems.open(inputFile))) {\r\n        try (WritableByteChannel writerChannel = FileSystems.create(tempFile, MimeTypes.TEXT)) {\r\n          ByteStreams.copy(readerChannel, writerChannel);\r\n        }\r\n\r\n        // Rename the temp file to the output file.\r\n        FileSystems.rename(\r\n            ImmutableList.of(tempFile),\r\n            ImmutableList.of(outputFile),\r\n            MoveOptions.StandardMoveOptions.IGNORE_MISSING_FILES);\r\n      } catch (IOException e) {\r\n        String msg = e.getMessage();\r\n\r\n        LOG.error(&quot;Error occurred during decompression of {}&quot;, inputFile.toString(), e);\r\n        throw new IOException(sanitizeDecompressionErrorMsg(msg, inputFile, compression));\r\n      }\r\n\r\n      return outputFile;\r\n    }\r\n\t\r\n\t/**\r\n\t * Extracts the files from a TAR archive.\r\n\t *\r\n\t * @param tarFile The input TAR file.\r\n\t * @param outputDir The directory where the extracted files should be placed.\r\n\t * @throws IOException If an error occurs during extraction.\r\n\t */\r\n\tprivate void extractTar(File tarFile, File outputDir) throws IOException {\r\n\t  try (FileInputStream fileInputStream = new FileInputStream(tarFile);\r\n\t\t   GZIPInputStream gzipInputStream = new GZIPInputStream(fileInputStream);\r\n\t\t   TarArchiveInputStream tarInputStream = new TarArchiveInputStream(gzipInputStream)) {\r\n\r\n\t\tTarArchiveEntry entry;\r\n\t\twhile ((entry = tarInputStream.getNextTarEntry()) != null) {\r\n\t\t  if (!entry.isDirectory()) {\r\n\t\t\tFile outputFile = new File(outputDir, entry.getName());\r\n\t\t\ttry (FileOutputStream fileOutputStream = new FileOutputStream(outputFile)) {\r\n\t\t\t  byte[] buffer = new byte[4096];\r\n\t\t\t  int bytesRead;\r\n\t\t\t  while ((bytesRead = tarInputStream.read(buffer)) != -1) {\r\n\t\t\t\tfileOutputStream.write(buffer, 0, bytesRead);\r\n\t\t\t  }\r\n\t\t\t}\r\n\t\t  }\r\n\t\t}\r\n\t  }\r\n\t}\r\n\r\n\r\n\r\n    /**\r\n     * The error messages coming from the compression library are not consistent across compression\r\n     * modes. Here we&#39;ll attempt to unify the messages to inform the user more clearly when we&#39;ve\r\n     * encountered a file which is not compressed or malformed. Note that GZIP and ZIP compression\r\n     * modes will not throw an exception when a decompression is attempted on a file which is not\r\n     * compressed.\r\n     *\r\n     * @param errorMsg The error message thrown during decompression.\r\n     * @param inputFile The input file which failed decompression.\r\n     * @param compression The compression mode used during decompression.\r\n     * @return The sanitized error message. If the error was not from a malformed file, the same\r\n     *     error message passed will be returned (if not null) or an empty string will be returned\r\n     *     (if null).\r\n     */\r\n    private String sanitizeDecompressionErrorMsg(\r\n        @Nullable String errorMsg, ResourceId inputFile, Compression compression) {\r\n      if (errorMsg != null\r\n          &amp;&amp; (errorMsg.contains(&quot;not in the BZip2 format&quot;)\r\n              || errorMsg.contains(&quot;incorrect header check&quot;))) {\r\n        errorMsg = String.format(MALFORMED_ERROR_MSG, inputFile.toString(), compression);\r\n      }\r\n\r\n      return errorMsg == null ? &quot;&quot; : errorMsg;\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n\r\nI tried to write some pom.xml file myself and with the help of ChatGPT (which of course didn&#39;t help for such a complex Java code), but I couldn&#39;t compile at the end. I also tried with a pom.xml file that I found on Apache beam&#39;s github just to try, but it didn&#39;t work of course. \r\n\r\nFYI, I use this command as indicated by GCP to compile the code : \r\n\r\n```\r\n    mvn compile exec:java \\\r\n     -Dexec.mainClass=com.example.myclass \\\r\n     -Dexec.args=&quot;--runner=DataflowRunner \\\r\n                  --project=PROJECT_ID \\\r\n                  --stagingLocation=gs://BUCKET_NAME/staging \\\r\n                  --templateLocation=gs://BUCKET_NAME/templates/TEMPLATE_NAME \\\r\n                  --region=REGION&quot; \\\r\n     -P dataflow-runner\r\n```\r\n\r\nThanks a lot for your help","title":"Can&#39;t compile a custom Dataflow Classic Template","body":"<p>I'm trying to write a Dataflow Classic Template in Java which I'm not used to. I copied the code from the <strong>Bulk Decompress Cloud Storage Files</strong> template that decompress gzip files, then I added some lines to extract files from the resulting tar file (as in my case, I'm trying to decompress a .tar.gz file).\nHowever, I get stuck compiling the code with Maven, I don't know how to do my files and folder structure, and I really don't know what to write in the pom.xml file.</p>\n<pre><code>/*\n * Copyright (C) 2018 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not\n * use this file except in compliance with the License. You may obtain a copy of\n * the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n * License for the specific language governing permissions and limitations under\n * the License.\n */\npackage com.google.cloud.teleport.templates;\n\nimport com.google.cloud.teleport.metadata.Template;\nimport com.google.cloud.teleport.metadata.TemplateCategory;\nimport com.google.cloud.teleport.metadata.TemplateParameter;\nimport com.google.cloud.teleport.templates.BulkDecompressor.Options;\nimport com.google.common.annotations.VisibleForTesting;\nimport com.google.common.collect.ImmutableList;\nimport com.google.common.io.ByteStreams;\nimport com.google.common.io.Files;\nimport java.io.IOException;\nimport java.io.StringWriter;\nimport java.nio.channels.ReadableByteChannel;\nimport java.nio.channels.WritableByteChannel;\nimport java.util.Set;\nimport java.util.stream.Collectors;\nimport java.util.stream.Stream;\nimport javax.annotation.Nullable;\nimport org.apache.beam.sdk.Pipeline;\nimport org.apache.beam.sdk.PipelineResult;\nimport org.apache.beam.sdk.io.Compression;\nimport org.apache.beam.sdk.io.FileIO;\nimport org.apache.beam.sdk.io.FileSystems;\nimport org.apache.beam.sdk.io.TextIO;\nimport org.apache.beam.sdk.io.fs.MatchResult;\nimport org.apache.beam.sdk.io.fs.MoveOptions;\nimport org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions;\nimport org.apache.beam.sdk.io.fs.ResourceId;\nimport org.apache.beam.sdk.options.PipelineOptions;\nimport org.apache.beam.sdk.options.PipelineOptionsFactory;\nimport org.apache.beam.sdk.options.Validation.Required;\nimport org.apache.beam.sdk.options.ValueProvider;\nimport org.apache.beam.sdk.transforms.DoFn;\nimport org.apache.beam.sdk.transforms.MapElements;\nimport org.apache.beam.sdk.transforms.ParDo;\nimport org.apache.beam.sdk.util.MimeTypes;\nimport org.apache.beam.sdk.values.KV;\nimport org.apache.beam.sdk.values.PCollectionTuple;\nimport org.apache.beam.sdk.values.TupleTag;\nimport org.apache.beam.sdk.values.TupleTagList;\nimport org.apache.beam.sdk.values.TypeDescriptors;\nimport org.apache.commons.compress.archivers.tar.TarArchiveEntry;\nimport org.apache.commons.compress.archivers.tar.TarArchiveInputStream;\nimport org.apache.commons.csv.CSVFormat;\nimport org.apache.commons.csv.CSVPrinter;\nimport org.apache.commons.csv.QuoteMode;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\n\n/**\n * This pipeline decompresses file(s) from Google Cloud Storage and re-uploads them to a destination\n * location.\n *\n * &lt;p&gt;&lt;b&gt;Parameters&lt;/b&gt;\n *\n * &lt;p&gt;The {@code --inputFilePattern} parameter specifies a file glob to process. Files found can be\n * expressed in the following formats:\n *\n * &lt;pre&gt;\n * --inputFilePattern=gs://bucket-name/compressed-dir/*\n * --inputFilePattern=gs://bucket-name/compressed-dir/demo*.gz\n * &lt;/pre&gt;\n *\n * &lt;p&gt;The {@code --outputDirectory} parameter can be expressed in the following formats:\n *\n * &lt;pre&gt;\n * --outputDirectory=gs://bucket-name\n * --outputDirectory=gs://bucket-name/decompressed-dir\n * &lt;/pre&gt;\n *\n * &lt;p&gt;The {@code --outputFailureFile} parameter indicates the file to write the names of the files\n * which failed decompression and their associated error messages. This file can then be used for\n * subsequent processing by another process outside of Dataflow (e.g. send an email with the\n * failures, etc.). If there are no failures, the file will still be created but will be empty. The\n * failure file structure contains both the file that caused the error and the error message in CSV\n * format. The file will contain one header row and two columns (Filename, Error). The filename\n * output to the failureFile will be the full path of the file for ease of debugging.\n *\n * &lt;pre&gt;\n * --outputFailureFile=gs://bucket-name/decompressed-dir/failed.csv\n * &lt;/pre&gt;\n *\n * &lt;p&gt;Example Output File:\n *\n * &lt;pre&gt;\n * Filename,Error\n * gs://docs-demo/compressedFile.gz, File is malformed or not compressed in BZIP2 format.\n * &lt;/pre&gt;\n *\n * &lt;p&gt;Check out &lt;a\n * href=&quot;https://github.com/GoogleCloudPlatform/DataflowTemplates/blob/main/v1/README_Bulk_Decompress_GCS_Files.md&quot;&gt;README&lt;/a&gt;\n * for instructions on how to use or modify this template.\n */\n@Template(\n    name = &quot;Bulk_Decompress_GCS_Files&quot;,\n    category = TemplateCategory.UTILITIES,\n    displayName = &quot;Bulk Decompress Files on Cloud Storage&quot;,\n    description = {\n      &quot;The Bulk Decompress Cloud Storage Files template is a batch pipeline that decompresses files on Cloud Storage to a specified location. &quot;\n          + &quot;This functionality is useful when you want to use compressed data to minimize network bandwidth costs during a migration, but would like to maximize analytical processing speed by operating on uncompressed data after migration. &quot;\n          + &quot;The pipeline automatically handles multiple compression modes during a single run and determines the decompression mode to use based on the file extension (.bzip2, .deflate, .gz, .zip).&quot;,\n      &quot;Note: The Bulk Decompress Cloud Storage Files template is intended for single compressed files and not compressed folders.&quot;\n    },\n    optionsClass = Options.class,\n    documentation =\n        &quot;https://cloud.google.com/dataflow/docs/guides/templates/provided/bulk-decompress-cloud-storage&quot;,\n    contactInformation = &quot;https://cloud.google.com/support&quot;,\n    requirements = {\n      &quot;The files to decompress must be in one of the following formats: Bzip2, Deflate, and Gzip.&quot;,\n      &quot;The output directory must exist prior to running the pipeline.&quot;\n    })\npublic class BulkDecompressor {\n\n  /** The logger to output status messages to. */\n  private static final Logger LOG = LoggerFactory.getLogger(BulkDecompressor.class);\n\n  /**\n   * A list of the {@link Compression} values excluding {@link Compression#AUTO} and {@link\n   * Compression#UNCOMPRESSED}.\n   */\n  @VisibleForTesting\n  static final Set&lt;Compression&gt; SUPPORTED_COMPRESSIONS =\n      Stream.of(Compression.values())\n          .filter(value -&gt; value != Compression.AUTO &amp;&amp; value != Compression.UNCOMPRESSED)\n          .collect(Collectors.toSet());\n\n  /** The error msg given when the pipeline matches a file but cannot determine the compression. */\n  @VisibleForTesting\n  static final String UNCOMPRESSED_ERROR_MSG =\n      &quot;Skipping file %s because it did not match any compression mode (%s)&quot;;\n\n  @VisibleForTesting\n  static final String MALFORMED_ERROR_MSG =\n      &quot;The file resource %s is malformed or not in %s compressed format.&quot;;\n\n  /** The tag used to identify the main output of the {@link Decompress} DoFn. */\n  @VisibleForTesting\n  static final TupleTag&lt;String&gt; DECOMPRESS_MAIN_OUT_TAG = new TupleTag&lt;String&gt;() {};\n\n  /** The tag used to identify the dead-letter sideOutput of the {@link Decompress} DoFn. */\n  @VisibleForTesting\n  static final TupleTag&lt;KV&lt;String, String&gt;&gt; DEADLETTER_TAG = new TupleTag&lt;KV&lt;String, String&gt;&gt;() {};\n\n  /**\n   * The {@link Options} class provides the custom execution options passed by the executor at the\n   * command-line.\n   */\n  public interface Options extends PipelineOptions {\n    @TemplateParameter.GcsReadFile(\n        order = 1,\n        description = &quot;Input Cloud Storage File(s)&quot;,\n        helpText = &quot;The Cloud Storage location of the files you'd like to process.&quot;,\n        example = &quot;gs://your-bucket/your-files/*.gz&quot;)\n    @Required\n    ValueProvider&lt;String&gt; getInputFilePattern();\n\n    void setInputFilePattern(ValueProvider&lt;String&gt; value);\n\n    @TemplateParameter.GcsWriteFolder(\n        order = 2,\n        description = &quot;Output file directory in Cloud Storage&quot;,\n        helpText =\n            &quot;The path and filename prefix for writing output files. Must end with a slash. DateTime formatting is used to parse directory path for date &amp; time formatters.&quot;,\n        example = &quot;gs://your-bucket/decompressed/&quot;)\n    @Required\n    ValueProvider&lt;String&gt; getOutputDirectory();\n\n    void setOutputDirectory(ValueProvider&lt;String&gt; value);\n\n    @TemplateParameter.GcsWriteFile(\n        order = 3,\n        description = &quot;The output file for failures during the decompression process&quot;,\n        helpText =\n            &quot;The output file to write failures to during the decompression process. If there are no failures, the file will still be created but will be empty. The contents will be one line for each file which failed decompression in CSV format (Filename, Error). Note that this parameter will allow the pipeline to continue processing in the event of a failure.&quot;,\n        example = &quot;gs://your-bucket/decompressed/failed.csv&quot;)\n    @Required\n    ValueProvider&lt;String&gt; getOutputFailureFile();\n\n    void setOutputFailureFile(ValueProvider&lt;String&gt; value);\n  }\n\n  /**\n   * The main entry-point for pipeline execution. This method will start the pipeline but will not\n   * wait for it's execution to finish. If blocking execution is required, use the {@link\n   * BulkDecompressor#run(Options)} method to start the pipeline and invoke {@code\n   * result.waitUntilFinish()} on the {@link PipelineResult}.\n   *\n   * @param args The command-line args passed by the executor.\n   */\n  public static void main(String[] args) {\n\n    Options options = PipelineOptionsFactory.fromArgs(args).withValidation().as(Options.class);\n\n    run(options);\n  }\n\n  /**\n   * Runs the pipeline to completion with the specified options. This method does not wait until the\n   * pipeline is finished before returning. Invoke {@code result.waitUntilFinish()} on the result\n   * object to block until the pipeline is finished running if blocking programmatic execution is\n   * required.\n   *\n   * @param options The execution options.\n   * @return The pipeline result.\n   */\n  public static PipelineResult run(Options options) {\n\n    /*\n     * Steps:\n     *   1) Find all files matching the input pattern\n     *   2) Decompress the files found and output them to the output directory\n     *   3) Write any errors to the failure output file\n     */\n\n    // Create the pipeline\n    Pipeline pipeline = Pipeline.create(options);\n\n    // Run the pipeline over the work items.\n    PCollectionTuple decompressOut =\n        pipeline\n            .apply(&quot;MatchFile(s)&quot;, FileIO.match().filepattern(options.getInputFilePattern()))\n            .apply(\n                &quot;DecompressFile(s)&quot;,\n                ParDo.of(new Decompress(options.getOutputDirectory()))\n                    .withOutputTags(DECOMPRESS_MAIN_OUT_TAG, TupleTagList.of(DEADLETTER_TAG)));\n\n    decompressOut\n        .get(DEADLETTER_TAG)\n        .apply(\n            &quot;FormatErrors&quot;,\n            MapElements.into(TypeDescriptors.strings())\n                .via(\n                    kv -&gt; {\n                      StringWriter stringWriter = new StringWriter();\n                      try {\n                        CSVPrinter printer =\n                            new CSVPrinter(\n                                stringWriter,\n                                CSVFormat.DEFAULT\n                                    .withEscape('\\\\')\n                                    .withQuoteMode(QuoteMode.NONE)\n                                    .withRecordSeparator('\\n'));\n                        printer.printRecord(kv.getKey(), kv.getValue());\n                      } catch (IOException e) {\n                        throw new RuntimeException(e);\n                      }\n\n                      return stringWriter.toString();\n                    }))\n\n        // We don't expect error files to be large so we'll create a single\n        // file for ease of reprocessing by processes outside of Dataflow.\n        .apply(\n            &quot;WriteErrorFile&quot;,\n            TextIO.write()\n                .to(options.getOutputFailureFile())\n                .withHeader(&quot;Filename,Error&quot;)\n                .withoutSharding());\n\n    return pipeline.run();\n  }\n\n  /**\n   * Performs the decompression of an object on Google Cloud Storage and uploads the decompressed\n   * object back to a specified destination location.\n   */\n  @SuppressWarnings(&quot;serial&quot;)\n  public static class Decompress extends DoFn&lt;MatchResult.Metadata, String&gt; {\n\n    private final ValueProvider&lt;String&gt; destinationLocation;\n\n    Decompress(ValueProvider&lt;String&gt; destinationLocation) {\n      this.destinationLocation = destinationLocation;\n    }\n\n    @ProcessElement\n    public void processElement(ProcessContext context) {\n      ResourceId inputFile = context.element().resourceId();\n\n      // Output a record to the failure file if the file doesn't match a known compression.\n      if (!Compression.AUTO.isCompressed(inputFile.toString())) {\n        String errorMsg =\n            String.format(UNCOMPRESSED_ERROR_MSG, inputFile.toString(), SUPPORTED_COMPRESSIONS);\n\n        context.output(DEADLETTER_TAG, KV.of(inputFile.toString(), errorMsg));\n      } else {\n        try {\n          ResourceId outputFile = decompress(inputFile);\n          context.output(outputFile.toString());\n        } catch (IOException e) {\n          LOG.error(e.getMessage());\n          context.output(DEADLETTER_TAG, KV.of(inputFile.toString(), e.getMessage()));\n        }\n      }\n    }\n\n    /**\n     * Decompresses the inputFile using the specified compression and outputs to the main output of\n     * the {@link Decompress} doFn. Files output to the destination will be first written as temp\n     * files with a &quot;temp-&quot; prefix within the output directory. If a file fails decompression, the\n     * filename and the associated error will be output to the dead-letter.\n     *\n     * @param inputFile The inputFile to decompress.\n     * @return A {@link ResourceId} which points to the resulting file from the decompression.\n     */\n    private ResourceId decompress(ResourceId inputFile) throws IOException {\n      // Remove the compressed extension from the file. Example: demo.txt.gz -&gt; demo.txt\n      String outputFilename = Files.getNameWithoutExtension(inputFile.toString());\n\n      // Resolve the necessary resources to perform the transfer.\n      ResourceId outputDir = FileSystems.matchNewResource(destinationLocation.get(), true);\n      ResourceId outputFile =\n          outputDir.resolve(outputFilename, StandardResolveOptions.RESOLVE_FILE);\n      ResourceId tempFile =\n          outputDir.resolve(\n              Files.getFileExtension(inputFile.toString()) + &quot;-temp-&quot; + outputFilename,\n              StandardResolveOptions.RESOLVE_FILE);\n\n      // Resolve the compression\n      Compression compression = Compression.detect(inputFile.toString());\n\n      // Perform the copy of the decompressed channel into the destination.\n      try (ReadableByteChannel readerChannel =\n          compression.readDecompressed(FileSystems.open(inputFile))) {\n        try (WritableByteChannel writerChannel = FileSystems.create(tempFile, MimeTypes.TEXT)) {\n          ByteStreams.copy(readerChannel, writerChannel);\n        }\n\n        // Rename the temp file to the output file.\n        FileSystems.rename(\n            ImmutableList.of(tempFile),\n            ImmutableList.of(outputFile),\n            MoveOptions.StandardMoveOptions.IGNORE_MISSING_FILES);\n      } catch (IOException e) {\n        String msg = e.getMessage();\n\n        LOG.error(&quot;Error occurred during decompression of {}&quot;, inputFile.toString(), e);\n        throw new IOException(sanitizeDecompressionErrorMsg(msg, inputFile, compression));\n      }\n\n      return outputFile;\n    }\n    \n    /**\n     * Extracts the files from a TAR archive.\n     *\n     * @param tarFile The input TAR file.\n     * @param outputDir The directory where the extracted files should be placed.\n     * @throws IOException If an error occurs during extraction.\n     */\n    private void extractTar(File tarFile, File outputDir) throws IOException {\n      try (FileInputStream fileInputStream = new FileInputStream(tarFile);\n           GZIPInputStream gzipInputStream = new GZIPInputStream(fileInputStream);\n           TarArchiveInputStream tarInputStream = new TarArchiveInputStream(gzipInputStream)) {\n\n        TarArchiveEntry entry;\n        while ((entry = tarInputStream.getNextTarEntry()) != null) {\n          if (!entry.isDirectory()) {\n            File outputFile = new File(outputDir, entry.getName());\n            try (FileOutputStream fileOutputStream = new FileOutputStream(outputFile)) {\n              byte[] buffer = new byte[4096];\n              int bytesRead;\n              while ((bytesRead = tarInputStream.read(buffer)) != -1) {\n                fileOutputStream.write(buffer, 0, bytesRead);\n              }\n            }\n          }\n        }\n      }\n    }\n\n\n\n    /**\n     * The error messages coming from the compression library are not consistent across compression\n     * modes. Here we'll attempt to unify the messages to inform the user more clearly when we've\n     * encountered a file which is not compressed or malformed. Note that GZIP and ZIP compression\n     * modes will not throw an exception when a decompression is attempted on a file which is not\n     * compressed.\n     *\n     * @param errorMsg The error message thrown during decompression.\n     * @param inputFile The input file which failed decompression.\n     * @param compression The compression mode used during decompression.\n     * @return The sanitized error message. If the error was not from a malformed file, the same\n     *     error message passed will be returned (if not null) or an empty string will be returned\n     *     (if null).\n     */\n    private String sanitizeDecompressionErrorMsg(\n        @Nullable String errorMsg, ResourceId inputFile, Compression compression) {\n      if (errorMsg != null\n          &amp;&amp; (errorMsg.contains(&quot;not in the BZip2 format&quot;)\n              || errorMsg.contains(&quot;incorrect header check&quot;))) {\n        errorMsg = String.format(MALFORMED_ERROR_MSG, inputFile.toString(), compression);\n      }\n\n      return errorMsg == null ? &quot;&quot; : errorMsg;\n    }\n  }\n}\n</code></pre>\n<p>I tried to write some pom.xml file myself and with the help of ChatGPT (which of course didn't help for such a complex Java code), but I couldn't compile at the end. I also tried with a pom.xml file that I found on Apache beam's github just to try, but it didn't work of course.</p>\n<p>FYI, I use this command as indicated by GCP to compile the code :</p>\n<pre><code>    mvn compile exec:java \\\n     -Dexec.mainClass=com.example.myclass \\\n     -Dexec.args=&quot;--runner=DataflowRunner \\\n                  --project=PROJECT_ID \\\n                  --stagingLocation=gs://BUCKET_NAME/staging \\\n                  --templateLocation=gs://BUCKET_NAME/templates/TEMPLATE_NAME \\\n                  --region=REGION&quot; \\\n     -P dataflow-runner\n</code></pre>\n<p>Thanks a lot for your help</p>\n"},{"tags":["java","servlets","tomcat8"],"comments":[{"owner":{"account_id":1266294,"reputation":8027,"user_id":1223532,"accept_rate":67,"display_name":"MrSimpleMind"},"score":0,"creation_date":1453476717,"post_id":34950164,"comment_id":57632043,"body_markdown":"do you run from eclipse? or ... please let us know more about your environment, application, and settings.","body":"do you run from eclipse? or ... please let us know more about your environment, application, and settings."},{"owner":{"account_id":923153,"reputation":5107,"user_id":954442,"accept_rate":83,"display_name":"Andrew Regan"},"score":0,"creation_date":1453476933,"post_id":34950164,"comment_id":57632204,"body_markdown":"Are you definitely using Tomcat 8? Your post is tagged &#39;tomcat7&#39;...","body":"Are you definitely using Tomcat 8? Your post is tagged &#39;tomcat7&#39;..."},{"owner":{"account_id":4301027,"reputation":3755,"user_id":3514736,"accept_rate":42,"display_name":"Rahman"},"score":0,"creation_date":1453477143,"post_id":34950164,"comment_id":57632377,"body_markdown":"@AndrewRegan Sorry it was a mistake. I edited. I am using tomcat 8","body":"@AndrewRegan Sorry it was a mistake. I edited. I am using tomcat 8"},{"owner":{"account_id":1266294,"reputation":8027,"user_id":1223532,"accept_rate":67,"display_name":"MrSimpleMind"},"score":1,"creation_date":1453477152,"post_id":34950164,"comment_id":57632381,"body_markdown":"what I was thinking too, thats why I asked about the environment... do you use pom.xml ? maybe you should change the property to `&lt;tomcat.version&gt;`xxxx`&lt;/tomcat.version&gt;` to tomcat 8... ?","body":"what I was thinking too, thats why I asked about the environment... do you use pom.xml ? maybe you should change the property to <code>&lt;tomcat.version&gt;</code>xxxx<code>&lt;&#47;tomcat.version&gt;</code> to tomcat 8... ?"},{"owner":{"account_id":4301027,"reputation":3755,"user_id":3514736,"accept_rate":42,"display_name":"Rahman"},"score":0,"creation_date":1453477303,"post_id":34950164,"comment_id":57632497,"body_markdown":"@MrSimpleMind Yes I am using POM. But I have not declared `&lt;tomcat.version&gt;` . So if I dont declare what it will take by default ?","body":"@MrSimpleMind Yes I am using POM. But I have not declared <code>&lt;tomcat.version&gt;</code> . So if I dont declare what it will take by default ?"},{"owner":{"account_id":1266294,"reputation":8027,"user_id":1223532,"accept_rate":67,"display_name":"MrSimpleMind"},"score":0,"creation_date":1453477453,"post_id":34950164,"comment_id":57632607,"body_markdown":"Is it spring solution? I think default it will run tomcat 7.. so if you want to run 8xxx.. then add that info.","body":"Is it spring solution? I think default it will run tomcat 7.. so if you want to run 8xxx.. then add that info."},{"owner":{"account_id":4301027,"reputation":3755,"user_id":3514736,"accept_rate":42,"display_name":"Rahman"},"score":0,"creation_date":1453477756,"post_id":34950164,"comment_id":57632819,"body_markdown":"@MrSimpleMind Yes . Its having Spring","body":"@MrSimpleMind Yes . Its having Spring"},{"owner":{"account_id":71739,"reputation":307142,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":0,"creation_date":1453480704,"post_id":34950164,"comment_id":57634864,"body_markdown":"You have twice written 1.3 where you mean 3.1.","body":"You have twice written 1.3 where you mean 3.1."}],"answers":[{"tags":[],"owner":{"account_id":923153,"reputation":5107,"user_id":954442,"accept_rate":83,"display_name":"Andrew Regan"},"down_vote_count":0,"up_vote_count":27,"is_accepted":false,"score":27,"last_activity_date":1453477475,"creation_date":1453477475,"answer_id":34950531,"question_id":34950164,"body_markdown":"Check all your Maven (or equivalent) dependencies and make sure that you - or most likely another dependency - are not pulling in a pre-3.1 version of the `javax.servlet / servlet-api` that may be taking precedence over what&#39;s in your Tomcat 8. If you&#39;ve manually deployed, make sure you haven&#39;t manually copied any servlet-api JARs into Tomcat itself.\r\n\r\nSee: https://stackoverflow.com/a/26232535/954442","title":"Getting NoSuchMethodError:javax.servlet.ServletContext.getVirtualServerName()","body":"<p>Check all your Maven (or equivalent) dependencies and make sure that you - or most likely another dependency - are not pulling in a pre-3.1 version of the <code>javax.servlet / servlet-api</code> that may be taking precedence over what's in your Tomcat 8. If you've manually deployed, make sure you haven't manually copied any servlet-api JARs into Tomcat itself.</p>\n\n<p>See: <a href=\"https://stackoverflow.com/a/26232535/954442\">https://stackoverflow.com/a/26232535/954442</a></p>\n"},{"tags":[],"owner":{"account_id":1266294,"reputation":8027,"user_id":1223532,"accept_rate":67,"display_name":"MrSimpleMind"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1453477767,"creation_date":1453477767,"answer_id":34950623,"question_id":34950164,"body_markdown":"Spring boot will run **tomcat 7** per default, you have to override maven build tomcat.version in your pom.xml. See below to run **tomcat 8.0.30**\r\n\r\n    &lt;properties&gt;\r\n      &lt;tomcat.version&gt;8.0.30&lt;/tomcat.version&gt;\r\n    &lt;/properties&gt;\r\n\r\n\r\nShould fix your problem.","title":"Getting NoSuchMethodError:javax.servlet.ServletContext.getVirtualServerName()","body":"<p>Spring boot will run <strong>tomcat 7</strong> per default, you have to override maven build tomcat.version in your pom.xml. See below to run <strong>tomcat 8.0.30</strong></p>\n\n<pre><code>&lt;properties&gt;\n  &lt;tomcat.version&gt;8.0.30&lt;/tomcat.version&gt;\n&lt;/properties&gt;\n</code></pre>\n\n<p>Should fix your problem.</p>\n"},{"tags":[],"owner":{"account_id":249974,"reputation":788,"user_id":526386,"accept_rate":71,"display_name":"Ankur"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1498666014,"creation_date":1498666014,"answer_id":44807607,"question_id":34950164,"body_markdown":"**Solved**\r\nOn my mac with java 8 was facing issue with downloaded tomcat from site and unzip.\r\n\r\nMy issue got solved because there was a extra servlet-api.jar file which was getting picked up. It was coming from \r\n/Library/Java/Extensions/servlet-api.jar\r\n\r\nFor finding it in your system you can use\r\nsudo find / -name servlet-api.jar\r\n\r\nRemoved it by backing it up somewhere else.\r\n\r\nI was following this for intallation\r\nhttps://gist.github.com/ddanailov-nmdp/c97aba2ca926b9627f6b4f7174083a32","title":"Getting NoSuchMethodError:javax.servlet.ServletContext.getVirtualServerName()","body":"<p><strong>Solved</strong>\nOn my mac with java 8 was facing issue with downloaded tomcat from site and unzip.</p>\n\n<p>My issue got solved because there was a extra servlet-api.jar file which was getting picked up. It was coming from \n/Library/Java/Extensions/servlet-api.jar</p>\n\n<p>For finding it in your system you can use\nsudo find / -name servlet-api.jar</p>\n\n<p>Removed it by backing it up somewhere else.</p>\n\n<p>I was following this for intallation\n<a href=\"https://gist.github.com/ddanailov-nmdp/c97aba2ca926b9627f6b4f7174083a32\" rel=\"nofollow noreferrer\">https://gist.github.com/ddanailov-nmdp/c97aba2ca926b9627f6b4f7174083a32</a></p>\n"},{"tags":[],"owner":{"account_id":7320991,"reputation":1110,"user_id":5577048,"display_name":"zlandorf"},"down_vote_count":0,"up_vote_count":10,"is_accepted":false,"score":10,"last_activity_date":1502189119,"creation_date":1502189119,"answer_id":45566217,"question_id":34950164,"body_markdown":"I had this error on IntelliJ with maven after updating IntelliJ.\r\n\r\nI could run the tests with maven but not from my IDE.\r\n\r\nI solved the problem by removing the `./idea` and `project.iml` files and reloading the project.","title":"Getting NoSuchMethodError:javax.servlet.ServletContext.getVirtualServerName()","body":"<p>I had this error on IntelliJ with maven after updating IntelliJ.</p>\n\n<p>I could run the tests with maven but not from my IDE.</p>\n\n<p>I solved the problem by removing the <code>./idea</code> and <code>project.iml</code> files and reloading the project.</p>\n"},{"tags":[],"owner":{"account_id":182665,"reputation":851,"user_id":417541,"accept_rate":42,"display_name":"Do Will"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1510091967,"creation_date":1510091967,"answer_id":47168144,"question_id":34950164,"body_markdown":"This surely has something to do with the version of javax.servlet and version of Tomcat. \r\n\r\nIn my case, it went away when I declared javax.servlet dependency in gradle with no version. Like this - \r\n\r\n    compile(&#39;javax.servlet:servlet-api&#39;)","title":"Getting NoSuchMethodError:javax.servlet.ServletContext.getVirtualServerName()","body":"<p>This surely has something to do with the version of javax.servlet and version of Tomcat. </p>\n\n<p>In my case, it went away when I declared javax.servlet dependency in gradle with no version. Like this - </p>\n\n<pre><code>compile('javax.servlet:servlet-api')\n</code></pre>\n"},{"tags":[],"owner":{"account_id":7118627,"reputation":2330,"user_id":5443977,"accept_rate":45,"display_name":"Python Basketball"},"down_vote_count":1,"up_vote_count":23,"is_accepted":false,"score":22,"last_activity_date":1570213849,"creation_date":1511753458,"answer_id":47503564,"question_id":34950164,"body_markdown":"The method `getVirtualServerName` has been added in ServletContext in Servlet 3.1. See the java doc&#39;s method [getVirtualServerName][1].\r\n\r\nThis problem has 3 primary causes:\r\n\r\n 1. Your servlet version is older than 3.1.\r\n\r\n 2. Some other jar has the servlet with a version older than 3.1.\r\n\r\n 3. Your tomcat version is older than 8\r\n\r\nto solve it, you can try the below way.\r\n \r\n\r\nI. Check your pom.xml for the code below.\r\n   \r\n      &lt;dependency&gt;\r\n    \t   &lt;groupId&gt;javax.servlet&lt;/groupId&gt;\r\n    \t   &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;\r\n           &lt;version&gt;3.1.0&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n\r\nif your pom.xml has the above code, it would still has that problem. you can do the second way.\r\n\r\nII. to check your other jar has refer to the `javax.servlet-api` jar. for example, the `org.apache.santuario` has refer to the `javax.servlet-api` jar. the pom.xml:\r\n\r\n    &lt;dependency&gt;  \r\n        &lt;groupId&gt;org.apache.santuario&lt;/groupId&gt;  \r\n        &lt;artifactId&gt;xmlsec&lt;/artifactId&gt;  \r\n        &lt;version&gt;1.4.3&lt;/version&gt;   \r\n    &lt;/dependency&gt; \r\nbut when you look at the maven dependencies, it refer to the `javax.servlet-api` jar whose version is 2.3 older than 3.1. \r\n\r\n[![enter image description here][2]][2]\r\n\r\nso you should exclude the 2.3 version. pom.xml:\r\n\r\n    &lt;!-- exclude servlet-api 2.3 jar--&gt;  \r\n    &lt;dependency&gt;  \r\n        &lt;groupId&gt;org.apache.santuario&lt;/groupId&gt;  \r\n        &lt;artifactId&gt;xmlsec&lt;/artifactId&gt;  \r\n        &lt;version&gt;1.4.3&lt;/version&gt;  \r\n        &lt;exclusions&gt;  \r\n            &lt;exclusion&gt;  \r\n                &lt;groupId&gt;javax.servlet&lt;/groupId&gt;  \r\n                &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;  \r\n            &lt;/exclusion&gt;  \r\n        &lt;/exclusions&gt;  \r\n    &lt;/dependency&gt;  \r\n      \r\n    &lt;!-- servlet-api 3.1 version has getVirtualServerName() --&gt;  \r\n    &lt;dependency&gt;  \r\n        &lt;groupId&gt;javax.servlet&lt;/groupId&gt;  \r\n        &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;  \r\n        &lt;version&gt;3.1.0&lt;/version&gt;  \r\n    &lt;/dependency&gt; \r\n\r\nIII. spring boot run the default tomcat 7. so define your tomcat version 8 instead of tomcat 7. so add the code your pom.xml:\r\n\t\r\n\r\n       &lt;properties&gt;\r\n    \t\t&lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\r\n    \t\t&lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;\r\n    \t\t&lt;java.version&gt;1.8&lt;/java.version&gt;\r\n            &lt;tomcat.version&gt;8.5.5&lt;/tomcat.version&gt;\r\n    \t&lt;/properties&gt;\r\n\r\n  [1]: https://docs.oracle.com/javaee/7/api/javax/servlet/ServletContext.html#getVirtualServerName--\r\n  [2]: https://i.stack.imgur.com/UsFWB.png","title":"Getting NoSuchMethodError:javax.servlet.ServletContext.getVirtualServerName()","body":"<p>The method <code>getVirtualServerName</code> has been added in ServletContext in Servlet 3.1. See the java doc's method <a href=\"https://docs.oracle.com/javaee/7/api/javax/servlet/ServletContext.html#getVirtualServerName--\" rel=\"noreferrer\">getVirtualServerName</a>.</p>\n\n<p>This problem has 3 primary causes:</p>\n\n<ol>\n<li><p>Your servlet version is older than 3.1.</p></li>\n<li><p>Some other jar has the servlet with a version older than 3.1.</p></li>\n<li><p>Your tomcat version is older than 8</p></li>\n</ol>\n\n<p>to solve it, you can try the below way.</p>\n\n<p>I. Check your pom.xml for the code below.</p>\n\n<pre><code>  &lt;dependency&gt;\n       &lt;groupId&gt;javax.servlet&lt;/groupId&gt;\n       &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;\n       &lt;version&gt;3.1.0&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre>\n\n<p>if your pom.xml has the above code, it would still has that problem. you can do the second way.</p>\n\n<p>II. to check your other jar has refer to the <code>javax.servlet-api</code> jar. for example, the <code>org.apache.santuario</code> has refer to the <code>javax.servlet-api</code> jar. the pom.xml:</p>\n\n<pre><code>&lt;dependency&gt;  \n    &lt;groupId&gt;org.apache.santuario&lt;/groupId&gt;  \n    &lt;artifactId&gt;xmlsec&lt;/artifactId&gt;  \n    &lt;version&gt;1.4.3&lt;/version&gt;   \n&lt;/dependency&gt; \n</code></pre>\n\n<p>but when you look at the maven dependencies, it refer to the <code>javax.servlet-api</code> jar whose version is 2.3 older than 3.1. </p>\n\n<p><a href=\"https://i.stack.imgur.com/UsFWB.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/UsFWB.png\" alt=\"enter image description here\"></a></p>\n\n<p>so you should exclude the 2.3 version. pom.xml:</p>\n\n<pre><code>&lt;!-- exclude servlet-api 2.3 jar--&gt;  \n&lt;dependency&gt;  \n    &lt;groupId&gt;org.apache.santuario&lt;/groupId&gt;  \n    &lt;artifactId&gt;xmlsec&lt;/artifactId&gt;  \n    &lt;version&gt;1.4.3&lt;/version&gt;  \n    &lt;exclusions&gt;  \n        &lt;exclusion&gt;  \n            &lt;groupId&gt;javax.servlet&lt;/groupId&gt;  \n            &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;  \n        &lt;/exclusion&gt;  \n    &lt;/exclusions&gt;  \n&lt;/dependency&gt;  \n\n&lt;!-- servlet-api 3.1 version has getVirtualServerName() --&gt;  \n&lt;dependency&gt;  \n    &lt;groupId&gt;javax.servlet&lt;/groupId&gt;  \n    &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;  \n    &lt;version&gt;3.1.0&lt;/version&gt;  \n&lt;/dependency&gt; \n</code></pre>\n\n<p>III. spring boot run the default tomcat 7. so define your tomcat version 8 instead of tomcat 7. so add the code your pom.xml:</p>\n\n<pre><code>   &lt;properties&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;\n        &lt;java.version&gt;1.8&lt;/java.version&gt;\n        &lt;tomcat.version&gt;8.5.5&lt;/tomcat.version&gt;\n    &lt;/properties&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2284586,"reputation":33,"user_id":2008914,"display_name":"user2008914"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1536157236,"creation_date":1536157236,"answer_id":52187426,"question_id":34950164,"body_markdown":"After a huge pain &amp; sifting through all these stackoverflow answers the only thing that ended up working for me was downgrading from tomcat8 to tomcat7. I know this isn&#39;t an ideal solution, and perhaps it was just a fresh install of tomcat that solved my problem. If all else fails give that a shot.","title":"Getting NoSuchMethodError:javax.servlet.ServletContext.getVirtualServerName()","body":"<p>After a huge pain &amp; sifting through all these stackoverflow answers the only thing that ended up working for me was downgrading from tomcat8 to tomcat7. I know this isn't an ideal solution, and perhaps it was just a fresh install of tomcat that solved my problem. If all else fails give that a shot.</p>\n"},{"tags":[],"owner":{"account_id":12613723,"reputation":930,"user_id":9171899,"display_name":"yuen26"},"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1567221670,"creation_date":1567221670,"answer_id":57734921,"question_id":34950164,"body_markdown":"If you have used this dependency:\r\n\r\n```xml\r\n&lt;dependency&gt;\r\n    &lt;groupId&gt;com.google.oauth-client&lt;/groupId&gt;\r\n    &lt;artifactId&gt;google-oauth-client-jetty&lt;/artifactId&gt;\r\n    &lt;version&gt;1.23.0&lt;/version&gt;\r\n&lt;/dependency&gt;\r\n```\r\n\r\nThen please exclude as below:\r\n\r\n```xml\r\n&lt;dependency&gt;\r\n    &lt;groupId&gt;com.google.oauth-client&lt;/groupId&gt;\r\n    &lt;artifactId&gt;google-oauth-client-jetty&lt;/artifactId&gt;\r\n    &lt;version&gt;1.23.0&lt;/version&gt;\r\n    &lt;exclusions&gt;\r\n        &lt;exclusion&gt;\r\n            &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;\r\n            &lt;groupId&gt;org.mortbay.jetty&lt;/groupId&gt;\r\n        &lt;/exclusion&gt;\r\n    &lt;/exclusions&gt;\r\n&lt;/dependency&gt;\r\n```","title":"Getting NoSuchMethodError:javax.servlet.ServletContext.getVirtualServerName()","body":"<p>If you have used this dependency:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.google.oauth-client&lt;/groupId&gt;\n    &lt;artifactId&gt;google-oauth-client-jetty&lt;/artifactId&gt;\n    &lt;version&gt;1.23.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n\n<p>Then please exclude as below:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.google.oauth-client&lt;/groupId&gt;\n    &lt;artifactId&gt;google-oauth-client-jetty&lt;/artifactId&gt;\n    &lt;version&gt;1.23.0&lt;/version&gt;\n    &lt;exclusions&gt;\n        &lt;exclusion&gt;\n            &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;\n            &lt;groupId&gt;org.mortbay.jetty&lt;/groupId&gt;\n        &lt;/exclusion&gt;\n    &lt;/exclusions&gt;\n&lt;/dependency&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":3248475,"reputation":23,"user_id":2739392,"display_name":"Max Wang"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1594885482,"creation_date":1594885482,"answer_id":62929875,"question_id":34950164,"body_markdown":"Assuming this problem appears when you ran the application in Eclipse. \r\nUse Dependency Hierarchy view to search for servlet-api in pom.xm","title":"Getting NoSuchMethodError:javax.servlet.ServletContext.getVirtualServerName()","body":"<p>Assuming this problem appears when you ran the application in Eclipse.\nUse Dependency Hierarchy view to search for servlet-api in pom.xm</p>\n"},{"tags":[],"owner":{"account_id":8201651,"reputation":1736,"user_id":6172826,"display_name":"seunggabi"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1651915444,"creation_date":1651769230,"answer_id":72130841,"question_id":34950164,"body_markdown":"I attach `gradle` style dependencies code.\r\n\r\n```\r\ndependencies {\r\n    compileOnly(&quot;javax.servlet:javax.servlet-api:3.1.0&quot;)\r\n```","title":"Getting NoSuchMethodError:javax.servlet.ServletContext.getVirtualServerName()","body":"<p>I attach <code>gradle</code> style dependencies code.</p>\n<pre><code>dependencies {\n    compileOnly(&quot;javax.servlet:javax.servlet-api:3.1.0&quot;)\n</code></pre>\n"},{"tags":[],"owner":{"account_id":8038125,"reputation":31,"user_id":6060637,"display_name":"Alan Ackart"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695376158,"creation_date":1695376158,"answer_id":77156561,"question_id":34950164,"body_markdown":"In my case, I  add vm option `-verbose:class` to find the wrong jar and \r\nexcluded the conflicted jar then add the higer version of javax.servlet-api(3.1.0), the problem was sovled.","title":"Getting NoSuchMethodError:javax.servlet.ServletContext.getVirtualServerName()","body":"<p>In my case, I  add vm option <code>-verbose:class</code> to find the wrong jar and\nexcluded the conflicted jar then add the higer version of javax.servlet-api(3.1.0), the problem was sovled.</p>\n"}],"owner":{"account_id":4301027,"reputation":3755,"user_id":3514736,"accept_rate":42,"display_name":"Rahman"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":78716,"favorite_count":0,"down_vote_count":0,"up_vote_count":41,"answer_count":11,"score":41,"last_activity_date":1695376158,"creation_date":1453476369,"question_id":34950164,"body_markdown":"I am facing an issue during deployment of a service in Tomcat 8. Getting following error :\r\n\r\n&gt; Caused by: java.lang.NoSuchMethodError:\r\n&gt; javax.servlet.ServletContext.getVirtualServerName()Ljava/lang/String;\r\n&gt;        at org.apache.tomcat.websocket.server.WsServerContainer.&lt;init&gt;(WsServerContainer.java:149)\r\n&gt;        at org.apache.tomcat.websocket.server.WsSci.init(WsSci.java:131)\r\n&gt;        at org.apache.tomcat.websocket.server.WsSci.onStartup(WsSci.java:47)\r\n&gt;        at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5244)\r\n&gt;        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\r\n&gt;        ... 10 more\r\n\r\nMethod `getVirtualServerName` was introduced in Servlet 3.1  and after extracting `MANIFEST.MF` from my `servlet-api` jar I got following details :\r\n\r\n    Specification-Title: Java API for Servlets \r\n    Specification-Version: 3.1 \r\n    Specification-Vendor: Sun Microsystems, Inc. \r\n    Implementation-Title: javax.servlet \r\n\r\nWhich says that its having 3.1. So is there any other reason for this error? Please help\r\n\r\n","title":"Getting NoSuchMethodError:javax.servlet.ServletContext.getVirtualServerName()","body":"<p>I am facing an issue during deployment of a service in Tomcat 8. Getting following error :</p>\n\n<blockquote>\n  <p>Caused by: java.lang.NoSuchMethodError:\n  javax.servlet.ServletContext.getVirtualServerName()Ljava/lang/String;\n         at org.apache.tomcat.websocket.server.WsServerContainer.(WsServerContainer.java:149)\n         at org.apache.tomcat.websocket.server.WsSci.init(WsSci.java:131)\n         at org.apache.tomcat.websocket.server.WsSci.onStartup(WsSci.java:47)\n         at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5244)\n         at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n         ... 10 more</p>\n</blockquote>\n\n<p>Method <code>getVirtualServerName</code> was introduced in Servlet 3.1  and after extracting <code>MANIFEST.MF</code> from my <code>servlet-api</code> jar I got following details :</p>\n\n<pre><code>Specification-Title: Java API for Servlets \nSpecification-Version: 3.1 \nSpecification-Vendor: Sun Microsystems, Inc. \nImplementation-Title: javax.servlet \n</code></pre>\n\n<p>Which says that its having 3.1. So is there any other reason for this error? Please help</p>\n"},{"tags":["javascript","java","html","email"],"answers":[{"tags":[],"owner":{"account_id":10633569,"reputation":103,"user_id":7830910,"display_name":"sajid"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1695375893,"creation_date":1492413591,"answer_id":43447032,"question_id":43445571,"body_markdown":"I hope it will help. \r\nI have added an  [JsFidler](https://jsfiddle.net/SajidSidhu/mqsftj54/) for you.\r\n```javascript\r\n     var varificetioncode = &quot;code-to-send&quot;;\r\n     var token_link = &quot;http://example.org/questions/123/&quot; + varificetioncode;\r\n     message.setContent(\r\n                        &quot;&lt;h2&gt;Reset password request &lt;/h2&gt;&quot; + \r\n                        &quot;&lt;h3&gt; Please click on the button to reset password &lt;/h3&gt;&quot;+\r\n                        &quot;&lt;a target=&#39;_blank&#39; href=&quot;+ token_link +&quot;&gt;\r\n                           &lt;button&gt;Reset your password&lt;/button&gt;\r\n                        &lt;/a&gt;&quot;,\r\n                       &quot;text/html; charset=utf-8&quot;\r\n                      );\r\n```","title":"How to send Link on html button click in java mail?","body":"<p>I hope it will help.\nI have added an  <a href=\"https://jsfiddle.net/SajidSidhu/mqsftj54/\" rel=\"nofollow noreferrer\">JsFidler</a> for you.</p>\n<pre class=\"lang-js prettyprint-override\"><code>     var varificetioncode = &quot;code-to-send&quot;;\n     var token_link = &quot;http://example.org/questions/123/&quot; + varificetioncode;\n     message.setContent(\n                        &quot;&lt;h2&gt;Reset password request &lt;/h2&gt;&quot; + \n                        &quot;&lt;h3&gt; Please click on the button to reset password &lt;/h3&gt;&quot;+\n                        &quot;&lt;a target='_blank' href=&quot;+ token_link +&quot;&gt;\n                           &lt;button&gt;Reset your password&lt;/button&gt;\n                        &lt;/a&gt;&quot;,\n                       &quot;text/html; charset=utf-8&quot;\n                      );\n</code></pre>\n"}],"owner":{"account_id":5499950,"reputation":125,"user_id":4369594,"accept_rate":83,"display_name":"maria salahuddin"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":2592,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":43447032,"answer_count":1,"score":1,"last_activity_date":1695375893,"creation_date":1492406405,"question_id":43445571,"body_markdown":"In my code I send reset password mail to the user , now I want to send some html content in the mail , I want a button on which user clicks and then reset password links opens in new tab , but I don&#39;t know how to embedded a link on html button , my link is saved in variable `token`\r\nhere is my code \r\n\r\n**MailServiice.java**\r\n\r\n    public void sendMail(String email,String token)\r\n    \t{\r\n    \t\tthis.email=email;\r\n    \t\tthis.token=token;\r\n         try {\r\n        \t\t   // Create a default MimeMessage object.\r\n        \t\t   Message message = new MimeMessage(session);\r\n        \t\t\r\n        \t\t   // Set From: header field of the header.\r\n        \t\t   message.setFrom(new InternetAddress(from));\r\n        \t\t\r\n        \t\t   // Set To: header field of the header.\r\n        \t\t   message.setRecipients(Message.RecipientType.TO,\r\n        \t               InternetAddress.parse(to));\r\n        \t\t\r\n        \t\t   // Set Subject: header field\r\n        \t\t   message.setSubject(&quot;change password request&quot;);\r\n        \t\t   \r\n        \t\t  \r\n        \t\t\r\n        \t\t   // Now set the actual message \r\n        \t      //  message.setText(messages);\r\n        \t        message.setContent(\r\n        \t                &quot;&lt;h2&gt;Reset password request &lt;/h2&gt;&quot; + \r\n        \t                &quot;&lt;h3&gt; Plaese click on the button to reset password \\n &lt;/h3&gt; &quot;+\r\n        \t                &quot; &lt;a href=token&gt;&quot; +&quot;&lt;button&gt;Reset your password&lt;/button&gt;&lt;/a&gt;&quot; + token,\r\n        \t                &quot;text/html&quot;);\r\n        \t\r\n        \r\n        \t\t   // Send message\r\n        \t\t   Transport.send(message);\r\n        \r\n        \t\t   System.out.println(&quot;Sent message successfully....&quot;);\r\n        \r\n        \t      } catch (MessagingException e) {\r\n        \t         throw new RuntimeException(e);\r\n        \t      }","title":"How to send Link on html button click in java mail?","body":"<p>In my code I send reset password mail to the user , now I want to send some html content in the mail , I want a button on which user clicks and then reset password links opens in new tab , but I don't know how to embedded a link on html button , my link is saved in variable <code>token</code>\nhere is my code </p>\n\n<p><strong>MailServiice.java</strong></p>\n\n<pre><code>public void sendMail(String email,String token)\n    {\n        this.email=email;\n        this.token=token;\n     try {\n               // Create a default MimeMessage object.\n               Message message = new MimeMessage(session);\n\n               // Set From: header field of the header.\n               message.setFrom(new InternetAddress(from));\n\n               // Set To: header field of the header.\n               message.setRecipients(Message.RecipientType.TO,\n                       InternetAddress.parse(to));\n\n               // Set Subject: header field\n               message.setSubject(\"change password request\");\n\n\n\n               // Now set the actual message \n              //  message.setText(messages);\n                message.setContent(\n                        \"&lt;h2&gt;Reset password request &lt;/h2&gt;\" + \n                        \"&lt;h3&gt; Plaese click on the button to reset password \\n &lt;/h3&gt; \"+\n                        \" &lt;a href=token&gt;\" +\"&lt;button&gt;Reset your password&lt;/button&gt;&lt;/a&gt;\" + token,\n                        \"text/html\");\n\n\n               // Send message\n               Transport.send(message);\n\n               System.out.println(\"Sent message successfully....\");\n\n              } catch (MessagingException e) {\n                 throw new RuntimeException(e);\n              }\n</code></pre>\n"},{"tags":["java","visual-studio-code"],"answers":[{"tags":[],"owner":{"account_id":15396644,"reputation":25733,"user_id":11107541,"display_name":"starball"},"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1687278576,"creation_date":1687278576,"answer_id":76516730,"question_id":76511565,"body_markdown":"There&#39;s an issue with VS Code related to the Electron framework when the workspace folder&#39;s path has any symlinks in it. See https://github.com/microsoft/vscode-java-test/issues/1463#issuecomment-1201046418, https://github.com/microsoft/vscode/issues/74104, and https://github.com/microsoft/vscode-java-test/issues/630. The issue might have to do with gtk4 ([source](https://github.com/microsoft/vscode/issues/74104#issuecomment-1175549012)).\r\n\r\nTo work around the issue, open the workspace folder using the canonical path and not the symlinked path.","title":"How to fix &quot;Failed to get workspace folder from test item&quot; for a Java tester project in VS Code?","body":"<p>There's an issue with VS Code related to the Electron framework when the workspace folder's path has any symlinks in it. See <a href=\"https://github.com/microsoft/vscode-java-test/issues/1463#issuecomment-1201046418\" rel=\"nofollow noreferrer\">https://github.com/microsoft/vscode-java-test/issues/1463#issuecomment-1201046418</a>, <a href=\"https://github.com/microsoft/vscode/issues/74104\" rel=\"nofollow noreferrer\">https://github.com/microsoft/vscode/issues/74104</a>, and <a href=\"https://github.com/microsoft/vscode-java-test/issues/630\" rel=\"nofollow noreferrer\">https://github.com/microsoft/vscode-java-test/issues/630</a>. The issue might have to do with gtk4 (<a href=\"https://github.com/microsoft/vscode/issues/74104#issuecomment-1175549012\" rel=\"nofollow noreferrer\">source</a>).</p>\n<p>To work around the issue, open the workspace folder using the canonical path and not the symlinked path.</p>\n"},{"tags":[],"owner":{"account_id":12935136,"reputation":1,"user_id":9352748,"display_name":"Bryan-dike Uwanaka"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695374488,"creation_date":1695374488,"answer_id":77156346,"question_id":76511565,"body_markdown":"It might be a symlink error. Try using opening your directory via the absolute path on your machine.","title":"How to fix &quot;Failed to get workspace folder from test item&quot; for a Java tester project in VS Code?","body":"<p>It might be a symlink error. Try using opening your directory via the absolute path on your machine.</p>\n"}],"owner":{"account_id":25597,"reputation":9442,"user_id":65889,"accept_rate":79,"display_name":"halloleo"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":349,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":76516730,"answer_count":2,"score":0,"last_activity_date":1695374488,"creation_date":1687237890,"question_id":76511565,"body_markdown":"I have a Java project in VS Code (v.1.79.2) using the Java Extension pack (v.0.25) and the Test Runner for Java (v.0.39).\r\n\r\nWhen I run the tests I get the error message &quot;*Failed to get workspace folder from test item*&quot;. Running the normal main app works fine.\r\n\r\nHowever this problem does not happen on *all* Java projects with tests. In another project the tests run fine.\r\n\r\nHow do I fix this issue?","title":"How to fix &quot;Failed to get workspace folder from test item&quot; for a Java tester project in VS Code?","body":"<p>I have a Java project in VS Code (v.1.79.2) using the Java Extension pack (v.0.25) and the Test Runner for Java (v.0.39).</p>\n<p>When I run the tests I get the error message &quot;<em>Failed to get workspace folder from test item</em>&quot;. Running the normal main app works fine.</p>\n<p>However this problem does not happen on <em>all</em> Java projects with tests. In another project the tests run fine.</p>\n<p>How do I fix this issue?</p>\n"},{"tags":["java","spring-boot","kotlin","gradle"],"comments":[{"owner":{"account_id":9291622,"reputation":11361,"user_id":6899896,"display_name":"M.Ricciuti"},"score":1,"creation_date":1676195453,"post_id":75426082,"comment_id":133085331,"body_markdown":"springboot plugin generates two jars,  an executable and a plain jar. maybe you just try to execute the wrong one ?  try `java -jar build/libs/spring302-0.0.1-SNAPSHOT.jar`","body":"springboot plugin generates two jars,  an executable and a plain jar. maybe you just try to execute the wrong one ?  try <code>java -jar build&#47;libs&#47;spring302-0.0.1-SNAPSHOT.jar</code>"},{"owner":{"account_id":14649698,"reputation":340,"user_id":11620467,"display_name":"KAEDE"},"score":0,"creation_date":1676195559,"post_id":75426082,"comment_id":133085352,"body_markdown":"No, my springboot generates just **plain** one.\n`ls build/libs/` -&gt;  `spring302-0.0.1-SNAPSHOT-plain.jar`","body":"No, my springboot generates just <b>plain</b> one. <code>ls build&#47;libs&#47;</code> -&gt;  <code>spring302-0.0.1-SNAPSHOT-plain.jar</code>"},{"owner":{"account_id":14649698,"reputation":340,"user_id":11620467,"display_name":"KAEDE"},"score":0,"creation_date":1676195768,"post_id":75426082,"comment_id":133085392,"body_markdown":"Sorry, ` ./gradlew build` out put not plain one.\nBut cannot found main class too. `java -jar build/libs/spring302-0.0.1-SNAPSHOT.jar` -&gt;      \n`Error: Could not find or load main class com.kaede.spring302.Spring302ApplicationKt`p","body":"Sorry, ` ./gradlew build` out put not plain one. But cannot found main class too. <code>java -jar build&#47;libs&#47;spring302-0.0.1-SNAPSHOT.jar</code> -&gt;       <code>Error: Could not find or load main class com.kaede.spring302.Spring302ApplicationKt</code>p"},{"owner":{"account_id":9291622,"reputation":11361,"user_id":6899896,"display_name":"M.Ricciuti"},"score":1,"creation_date":1676195852,"post_id":75426082,"comment_id":133085402,"body_markdown":"what task did you use to generate this &quot;-plain&quot; jar ?  Spring boot gradle plugin provides a `bootJar` task used to generate the executable (fatjar) jar .  `jar` task on the other hand, will produce the &quot;plain&quot; jar . see https://docs.spring.io/spring-boot/docs/current/gradle-plugin/reference/htmlsingle/#packaging-executable.and-plain-archives .  if you execute the lifecycle task &quot;build&quot; you should get both jar &amp; bootJar jars","body":"what task did you use to generate this &quot;-plain&quot; jar ?  Spring boot gradle plugin provides a <code>bootJar</code> task used to generate the executable (fatjar) jar .  <code>jar</code> task on the other hand, will produce the &quot;plain&quot; jar . see <a href=\"https://docs.spring.io/spring-boot/docs/current/gradle-plugin/reference/htmlsingle/#packaging-executable.and-plain-archives\" rel=\"nofollow noreferrer\">docs.spring.io/spring-boot/docs/current/gradle-plugin/refere&zwnj;&#8203;nce/&hellip;</a> .  if you execute the lifecycle task &quot;build&quot; you should get both jar &amp; bootJar jars"},{"owner":{"account_id":9291622,"reputation":11361,"user_id":6899896,"display_name":"M.Ricciuti"},"score":2,"creation_date":1676195905,"post_id":75426082,"comment_id":133085412,"body_markdown":"you need to remove the ` attributes[&quot;Main-Class&quot;] = &quot;com.kaede.spring302.Spring302ApplicationKt&quot;`  from your build file, let Springboot plugin detect the class automatically itself","body":"you need to remove the ` attributes[&quot;Main-Class&quot;] = &quot;com.kaede.spring302.Spring302ApplicationKt&quot;`  from your build file, let Springboot plugin detect the class automatically itself"},{"owner":{"account_id":14649698,"reputation":340,"user_id":11620467,"display_name":"KAEDE"},"score":0,"creation_date":1676256526,"post_id":75426082,"comment_id":133094637,"body_markdown":"@M.Ricciuti Thank you sooooo much! \nProblem solved!\n\nI removed `tasks.withType&lt;Jar&gt; {\n\tmanifest {\n\t\tattributes[&quot;Main-Class&quot;] = &quot;com.kaede.spring302.Spring302ApplicationKt&quot;\n\t}\n}`\n\nAnd execute `./gradlew bulild` \nAfter that I execute `java -jar build/libs/spring302-0.0.1-SNAPSHOT.jar` \nThen, `Started Spring302ApplicationKt in 5.47 seconds`","body":"@M.Ricciuti Thank you sooooo much!  Problem solved!  I removed <code>tasks.withType&lt;Jar&gt; { \tmanifest { \t\tattributes[&quot;Main-Class&quot;] = &quot;com.kaede.spring302.Spring302ApplicationKt&quot; \t} }</code>  And execute <code>.&#47;gradlew bulild</code>  After that I execute <code>java -jar build&#47;libs&#47;spring302-0.0.1-SNAPSHOT.jar</code>  Then, <code>Started Spring302ApplicationKt in 5.47 seconds</code>"},{"owner":{"account_id":14649698,"reputation":340,"user_id":11620467,"display_name":"KAEDE"},"score":0,"creation_date":1676256943,"post_id":75426082,"comment_id":133094672,"body_markdown":"I should build Spring gradle project by `./gradlew buiild` . NOT by IntelliJ&#39;s build button. Because IntelliJ&#39;s build button outputs `plain` one only.","body":"I should build Spring gradle project by <code>.&#47;gradlew buiild</code> . NOT by IntelliJ&#39;s build button. Because IntelliJ&#39;s build button outputs <code>plain</code> one only."}],"answers":[{"tags":[],"owner":{"account_id":13626539,"reputation":1469,"user_id":9829662,"display_name":"Mahdi Zareei"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695374323,"creation_date":1695374323,"answer_id":77156327,"question_id":75426082,"body_markdown":"check your spring boot project build gradle configuration file if you have something like this:\r\n\r\n    application {\r\n       mainClass.set(&quot;MainKt&quot;)\r\n    }\r\n    \r\nremove it and build your project again","title":"Spring Application&#39;s build file cannot execute by java.lang.NoClassDefFoundError","body":"<p>check your spring boot project build gradle configuration file if you have something like this:</p>\n<pre><code>application {\n   mainClass.set(&quot;MainKt&quot;)\n}\n</code></pre>\n<p>remove it and build your project again</p>\n"}],"owner":{"account_id":14649698,"reputation":340,"user_id":11620467,"display_name":"KAEDE"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":280,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1695374323,"creation_date":1676194875,"question_id":75426082,"body_markdown":"## what happend and What I want to do\r\n\r\nI made a Springboot Project with spring initializr (https://start.spring.io/).\r\n\r\nBut I cannot executed built jar file with this error.\r\n\r\n```\r\n java -jar build/libs/spring302-0.0.1-SNAPSHOT-plain.jar \r\nException in thread &quot;main&quot; java.lang.NoClassDefFoundError: kotlin/jvm/internal/Intrinsics\r\n        at com.kaede.spring302.Spring302ApplicationKt.main(Spring302Application.kt)\r\nCaused by: java.lang.ClassNotFoundException: kotlin.jvm.internal.Intrinsics\r\n        at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)\r\n        at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)\r\n        at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:520)\r\n        ... 1 more\r\n```\r\n\r\n\r\nWhat should I do ?\r\n\r\nI want to do this because I need to build to Docker Container.\r\n\r\n\r\n## How I made this project\r\n\r\nI selected \r\n\r\n- Kotlin\r\n- Gradle 7.2\r\n- Spring 3.0.2 \r\n- Java 17\r\n\r\nAnd I used IntelliJ to build.\r\n\r\n\r\nProject Name is spring302\r\nNameSpace is com.kaede\r\n\r\n## 1. Tried to Add Manifest Main-Class\r\n\r\n\r\n```\r\njava -jar build/libs/kotlin1-0.0.1-SNAPSHOT-plain.jar\r\n\r\nError: Could not find or load main class\r\n```\r\n\r\nFirst, I tried to just build, then happend this error.\r\n\r\n```\r\ntasks.withType&lt;Jar&gt; {\r\n    manifest {\r\n        attributes[&quot;Main-Class&quot;] = &quot;com.kaede.spring302.Spring302Application&quot;\r\n    }\r\n}\r\n```\r\n\r\nSo I added Manifest Main-Class in spring302/build.gradle.kts\r\n\r\n```\r\njava -jar build/libs/spring302-0.0.1-SNAPSHOT-plain.jar\r\nError: Main method not found in class com.kaede.spring302.Spring302Application, \r\nplease define the main method as:\r\n   public static void main(String[] args)\r\n```\r\n\r\nThen I got it is not Java Main Method Error.\r\n\r\n\r\n## 2. Changed Main-Class to classNameKt\r\n\r\nI changed Main-Class from Spring302Application to Spring302ApplicationKt\r\n\r\nI heard Kotlin class will change classNameKt.java.\r\n\r\n```\r\ntasks.withType&lt;Jar&gt; {\r\n    manifest {\r\n        attributes[&quot;Main-Class&quot;] = &quot;com.kaede.spring302.Spring302ApplicationKt&quot;\r\n    }\r\n}\r\n```\r\n\r\nSo I changed my Main-Class .\r\n\r\n```\r\njava -jar build/libs/spring302-0.0.1-SNAPSHOT-plain.jar\r\nException in thread &quot;main&quot; java.lang.NoClassDefFoundError: \r\nkotlin/jvm/internal/Intrinsics\r\n        at com.kaede.spring302.Spring302ApplicationKt.main(Spring302Application.kt)\r\nCaused by: java.lang.ClassNotFoundException: kotlin.jvm.internal.Intrinsics\r\n        at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)\r\n        at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)\r\n        at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:520)\r\n        ... 1 more\r\n```\r\n\r\nThen I got NoClassDefFoundError in Spring302ApplicationKt.main.\r\n\r\n```\r\njavap spring302-0.0.1-SNAPSHOT-plain/com/kaede/spring302/Spring302ApplicationKt.class \r\nCompiled from &quot;Spring302Application.kt&quot;\r\npublic final class com.kaede.spring302.Spring302ApplicationKt {\r\n  public static final void main(java.lang.String[]);\r\n}\r\n```\r\n\r\nEven my output has main.\r\n\r\n\r\n## 3. Removed .m2/repository and rebuild\r\n\r\n```\r\n rm -rf ~/.m2/repository \r\n```\r\n\r\nI thought dependencies are complicated, So I removed all and re-build.\r\n\r\nBut things did not change.\r\n\r\n## what I expect\r\n\r\nI can execute jar file\r\n\r\n## 4. Changed Main Method from runApplication to SpringApplication.run\r\n\r\nIn main\r\n\r\n```\r\nrunApplication&lt;Spring302Application&gt;(*args)\r\n```\r\n\r\nto \r\n\r\n```\r\nSpringApplication.run(Spring302Application::class.java, *args\r\n```\r\n\r\nBut NoClassDefFoundError does not change\r\n\r\n## build.gradle.kts\r\n\r\nThis is my full dependencies.\r\n\r\n```\r\nimport org.jetbrains.kotlin.gradle.tasks.KotlinCompile\r\n\r\nplugins {\r\n\tid(&quot;org.springframework.boot&quot;) version &quot;3.0.2&quot;\r\n\tid(&quot;io.spring.dependency-management&quot;) version &quot;1.1.0&quot;\r\n\tkotlin(&quot;jvm&quot;) version &quot;1.7.22&quot;\r\n\tkotlin(&quot;plugin.spring&quot;) version &quot;1.7.22&quot;\r\n}\r\n\r\ngroup = &quot;com.kaede&quot;\r\nversion = &quot;0.0.1-SNAPSHOT&quot;\r\njava.sourceCompatibility = JavaVersion.VERSION_17\r\n\r\nrepositories {\r\n\tmavenCentral()\r\n}\r\n\r\ndependencies {\r\n\timplementation(&quot;org.springframework.boot:spring-boot-starter-web&quot;)\r\n\timplementation(&quot;com.fasterxml.jackson.module:jackson-module-kotlin&quot;)\r\n\timplementation(&quot;org.jetbrains.kotlin:kotlin-reflect&quot;)\r\n\timplementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8&quot;)\r\n\ttestImplementation(&quot;org.springframework.boot:spring-boot-starter-test&quot;)\r\n}\r\n\r\ntasks.withType&lt;KotlinCompile&gt; {\r\n\tkotlinOptions {\r\n\t\tfreeCompilerArgs = listOf(&quot;-Xjsr305=strict&quot;)\r\n\t\tjvmTarget = &quot;17&quot;\r\n\t}\r\n}\r\n\r\ntasks.withType&lt;Test&gt; {\r\n\tuseJUnitPlatform()\r\n}\r\ntasks.withType&lt;Jar&gt; {\r\n\tmanifest {\r\n\t\tattributes[&quot;Main-Class&quot;] = &quot;com.kaede.spring302.Spring302ApplicationKt&quot;\r\n\t}\r\n\r\n}\r\n```\r\n","title":"Spring Application&#39;s build file cannot execute by java.lang.NoClassDefFoundError","body":"<h2>what happend and What I want to do</h2>\n<p>I made a Springboot Project with spring initializr (<a href=\"https://start.spring.io/\" rel=\"nofollow noreferrer\">https://start.spring.io/</a>).</p>\n<p>But I cannot executed built jar file with this error.</p>\n<pre><code> java -jar build/libs/spring302-0.0.1-SNAPSHOT-plain.jar \nException in thread &quot;main&quot; java.lang.NoClassDefFoundError: kotlin/jvm/internal/Intrinsics\n        at com.kaede.spring302.Spring302ApplicationKt.main(Spring302Application.kt)\nCaused by: java.lang.ClassNotFoundException: kotlin.jvm.internal.Intrinsics\n        at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)\n        at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)\n        at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:520)\n        ... 1 more\n</code></pre>\n<p>What should I do ?</p>\n<p>I want to do this because I need to build to Docker Container.</p>\n<h2>How I made this project</h2>\n<p>I selected</p>\n<ul>\n<li>Kotlin</li>\n<li>Gradle 7.2</li>\n<li>Spring 3.0.2</li>\n<li>Java 17</li>\n</ul>\n<p>And I used IntelliJ to build.</p>\n<p>Project Name is spring302\nNameSpace is com.kaede</p>\n<h2>1. Tried to Add Manifest Main-Class</h2>\n<pre><code>java -jar build/libs/kotlin1-0.0.1-SNAPSHOT-plain.jar\n\nError: Could not find or load main class\n</code></pre>\n<p>First, I tried to just build, then happend this error.</p>\n<pre><code>tasks.withType&lt;Jar&gt; {\n    manifest {\n        attributes[&quot;Main-Class&quot;] = &quot;com.kaede.spring302.Spring302Application&quot;\n    }\n}\n</code></pre>\n<p>So I added Manifest Main-Class in spring302/build.gradle.kts</p>\n<pre><code>java -jar build/libs/spring302-0.0.1-SNAPSHOT-plain.jar\nError: Main method not found in class com.kaede.spring302.Spring302Application, \nplease define the main method as:\n   public static void main(String[] args)\n</code></pre>\n<p>Then I got it is not Java Main Method Error.</p>\n<h2>2. Changed Main-Class to classNameKt</h2>\n<p>I changed Main-Class from Spring302Application to Spring302ApplicationKt</p>\n<p>I heard Kotlin class will change classNameKt.java.</p>\n<pre><code>tasks.withType&lt;Jar&gt; {\n    manifest {\n        attributes[&quot;Main-Class&quot;] = &quot;com.kaede.spring302.Spring302ApplicationKt&quot;\n    }\n}\n</code></pre>\n<p>So I changed my Main-Class .</p>\n<pre><code>java -jar build/libs/spring302-0.0.1-SNAPSHOT-plain.jar\nException in thread &quot;main&quot; java.lang.NoClassDefFoundError: \nkotlin/jvm/internal/Intrinsics\n        at com.kaede.spring302.Spring302ApplicationKt.main(Spring302Application.kt)\nCaused by: java.lang.ClassNotFoundException: kotlin.jvm.internal.Intrinsics\n        at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)\n        at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)\n        at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:520)\n        ... 1 more\n</code></pre>\n<p>Then I got NoClassDefFoundError in Spring302ApplicationKt.main.</p>\n<pre><code>javap spring302-0.0.1-SNAPSHOT-plain/com/kaede/spring302/Spring302ApplicationKt.class \nCompiled from &quot;Spring302Application.kt&quot;\npublic final class com.kaede.spring302.Spring302ApplicationKt {\n  public static final void main(java.lang.String[]);\n}\n</code></pre>\n<p>Even my output has main.</p>\n<h2>3. Removed .m2/repository and rebuild</h2>\n<pre><code> rm -rf ~/.m2/repository \n</code></pre>\n<p>I thought dependencies are complicated, So I removed all and re-build.</p>\n<p>But things did not change.</p>\n<h2>what I expect</h2>\n<p>I can execute jar file</p>\n<h2>4. Changed Main Method from runApplication to SpringApplication.run</h2>\n<p>In main</p>\n<pre><code>runApplication&lt;Spring302Application&gt;(*args)\n</code></pre>\n<p>to</p>\n<pre><code>SpringApplication.run(Spring302Application::class.java, *args\n</code></pre>\n<p>But NoClassDefFoundError does not change</p>\n<h2>build.gradle.kts</h2>\n<p>This is my full dependencies.</p>\n<pre><code>import org.jetbrains.kotlin.gradle.tasks.KotlinCompile\n\nplugins {\n    id(&quot;org.springframework.boot&quot;) version &quot;3.0.2&quot;\n    id(&quot;io.spring.dependency-management&quot;) version &quot;1.1.0&quot;\n    kotlin(&quot;jvm&quot;) version &quot;1.7.22&quot;\n    kotlin(&quot;plugin.spring&quot;) version &quot;1.7.22&quot;\n}\n\ngroup = &quot;com.kaede&quot;\nversion = &quot;0.0.1-SNAPSHOT&quot;\njava.sourceCompatibility = JavaVersion.VERSION_17\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    implementation(&quot;org.springframework.boot:spring-boot-starter-web&quot;)\n    implementation(&quot;com.fasterxml.jackson.module:jackson-module-kotlin&quot;)\n    implementation(&quot;org.jetbrains.kotlin:kotlin-reflect&quot;)\n    implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8&quot;)\n    testImplementation(&quot;org.springframework.boot:spring-boot-starter-test&quot;)\n}\n\ntasks.withType&lt;KotlinCompile&gt; {\n    kotlinOptions {\n        freeCompilerArgs = listOf(&quot;-Xjsr305=strict&quot;)\n        jvmTarget = &quot;17&quot;\n    }\n}\n\ntasks.withType&lt;Test&gt; {\n    useJUnitPlatform()\n}\ntasks.withType&lt;Jar&gt; {\n    manifest {\n        attributes[&quot;Main-Class&quot;] = &quot;com.kaede.spring302.Spring302ApplicationKt&quot;\n    }\n\n}\n</code></pre>\n"},{"tags":["java","spring-boot","gradle","build.gradle","annotation-processing"],"comments":[{"owner":{"account_id":8879412,"reputation":159,"user_id":6630210,"display_name":"jundev"},"score":0,"creation_date":1695371414,"post_id":77155734,"comment_id":136018216,"body_markdown":"What exact version of java 1.8 do you use? Have you checked your gradle wrapper on IDE?\n\nPlease, check this link :\nhttps://stackoverflow.com/questions/36408706/java-lang-illegalstateexception-endpostable-already-set","body":"What exact version of java 1.8 do you use? Have you checked your gradle wrapper on IDE?  Please, check this link : <a href=\"https://stackoverflow.com/questions/36408706/java-lang-illegalstateexception-endpostable-already-set\" title=\"java lang illegalstateexception endpostable already set\">stackoverflow.com/questions/36408706/&hellip;</a>"}],"answers":[{"tags":[],"owner":{"account_id":3169829,"reputation":63,"user_id":2679086,"display_name":"ridersingh92"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695374244,"creation_date":1695374244,"answer_id":77156318,"question_id":77155734,"body_markdown":"I got the solution by deleting build dirs before compile job and it works\r\n\r\nadd doFirst block in compile task\r\n\r\nref\r\n```\r\ncompileJava {\r\n    options.incremental = true\r\n    \r\n    \r\n//    doFirst {\r\n//        // force a clean of generatedSourceDir to prevent java.lang.IllegalStateException: endPosTable already set\r\n//        project.delete(generatedSourceDir)\r\n//        project.mkdir(generatedSourceDir)\r\n//    }\r\n}\r\n```\r\n\r\nReference\r\nhttps://github.com/gradle/gradle/pull/4700#issuecomment-378711369","title":"Spring boot Gradle Build Java Compiler issue java.lang.IllegalStateException: endPosTable already set","body":"<p>I got the solution by deleting build dirs before compile job and it works</p>\n<p>add doFirst block in compile task</p>\n<p>ref</p>\n<pre><code>compileJava {\n    options.incremental = true\n    \n    \n//    doFirst {\n//        // force a clean of generatedSourceDir to prevent java.lang.IllegalStateException: endPosTable already set\n//        project.delete(generatedSourceDir)\n//        project.mkdir(generatedSourceDir)\n//    }\n}\n</code></pre>\n<p>Reference\n<a href=\"https://github.com/gradle/gradle/pull/4700#issuecomment-378711369\" rel=\"nofollow noreferrer\">https://github.com/gradle/gradle/pull/4700#issuecomment-378711369</a></p>\n"}],"owner":{"account_id":3169829,"reputation":63,"user_id":2679086,"display_name":"ridersingh92"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":91,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1695374244,"creation_date":1695368874,"question_id":77155734,"body_markdown":"I am facing java compiler issue while running gradle build. It passes when I rerun it locally. But I cannot rerun on jenkins and build always fails there. \r\n\r\ngradle version : 6.9\r\njava 1.8\r\nspring boot : 2.7.15\r\n\r\nafter running `clean build` following exception comes for `compileJava` task.\r\n\r\nAnd it build is success after retry, then while starting application\r\n\r\nsame exception comes but for `compileQuerydsl` task. What m i doing wrong, or any flag i need to update in gradle file\r\n\r\n\r\n\r\n\r\nException:\r\n\r\n```An exception has occurred in the compiler (1.8.0_382). Please file a bug against the Java compiler via the Java bug reporting page (http://bugreport.java.com) after checking the Bug Database (http://bugs.java.com) for duplicates. Include your program and the following diagnostic in your report. Thank you.\r\njava.lang.IllegalStateException: endPosTable already set\r\n        at com.sun.tools.javac.util.DiagnosticSource.setEndPosTable(DiagnosticSource.java:136)\r\n        at com.sun.tools.javac.util.Log.setEndPosTable(Log.java:350)\r\n        at com.sun.tools.javac.main.JavaCompiler.parse(JavaCompiler.java:667)\r\n        at com.sun.tools.javac.main.JavaCompiler.parseFiles(JavaCompiler.java:950)\r\n        at com.sun.tools.javac.processing.JavacProcessingEnvironment$Round.&lt;init&gt;(JavacProcessingEnvironment.java:900)\r\n        at com.sun.tools.javac.processing.JavacProcessingEnvironment$Round.next(JavacProcessingEnvironment.java:929)\r\n        at com.sun.tools.javac.processing.JavacProcessingEnvironment.doProcessing(JavacProcessingEnvironment.java:1195)\r\n        at com.sun.tools.javac.main.JavaCompiler.processAnnotations(JavaCompiler.java:1170)\r\n        at com.sun.tools.javac.main.JavaCompiler.compile(JavaCompiler.java:856)\r\n        at com.sun.tools.javac.main.Main.compile(Main.java:523)\r\n        at com.sun.tools.javac.api.JavacTaskImpl.doCall(JavacTaskImpl.java:129)\r\n        at com.sun.tools.javac.api.JavacTaskImpl.call(JavacTaskImpl.java:138)\r\n        at org.gradle.internal.compiler.java.IncrementalCompileTask.call(IncrementalCompileTask.java:77)\r\n        at org.gradle.api.internal.tasks.compile.AnnotationProcessingCompileTask.call(AnnotationProcessingCompileTask.java:94)\r\n        at org.gradle.api.internal.tasks.compile.ResourceCleaningCompilationTask.call(ResourceCleaningCompilationTask.java:57)\r\n        at org.gradle.api.internal.tasks.compile.JdkJavaCompiler.execute(JdkJavaCompiler.java:55)\r\n        at org.gradle.api.internal.tasks.compile.JdkJavaCompiler.execute(JdkJavaCompiler.java:40)\r\n        at org.gradle.api.internal.tasks.compile.NormalizingJavaCompiler.delegateAndHandleErrors(NormalizingJavaCompiler.java:97)\r\n        at org.gradle.api.internal.tasks.compile.NormalizingJavaCompiler.execute(NormalizingJavaCompiler.java:51)\r\n        at org.gradle.api.internal.tasks.compile.NormalizingJavaCompiler.execute(NormalizingJavaCompiler.java:37)\r\n        at org.gradle.api.internal.tasks.compile.AnnotationProcessorDiscoveringCompiler.execute(AnnotationProcessorDiscoveringCompiler.java:51)\r\n        at org.gradle.api.internal.tasks.compile.AnnotationProcessorDiscoveringCompiler.execute(AnnotationProcessorDiscoveringCompiler.java:37)\r\n        at org.gradle.api.internal.tasks.compile.ModuleApplicationNameWritingCompiler.execute(ModuleApplicationNameWritingCompiler.java:46)\r\n        at org.gradle.api.internal.tasks.compile.ModuleApplicationNameWritingCompiler.execute(ModuleApplicationNameWritingCompiler.java:36)\r\n        at org.gradle.api.internal.tasks.compile.CleaningJavaCompiler.execute(CleaningJavaCompiler.java:53)\r\n        at org.gradle.api.internal.tasks.compile.incremental.IncrementalCompilerFactory.lambda$createRebuildAllCompiler$0(IncrementalCompilerFactory.java:98)\r\n        at org.gradle.api.internal.tasks.compile.incremental.IncrementalResultStoringCompiler.execute(IncrementalResultStoringCompiler.java:61)\r\n        at org.gradle.api.internal.tasks.compile.incremental.IncrementalResultStoringCompiler.execute(IncrementalResultStoringCompiler.java:45)\r\n        at org.gradle.api.internal.tasks.compile.CompileJavaBuildOperationReportingCompiler$2.call(CompileJavaBuildOperationReportingCompiler.java:59)\r\n        at org.gradle.api.internal.tasks.compile.CompileJavaBuildOperationReportingCompiler$2.call(CompileJavaBuildOperationReportingCompiler.java:51)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:200)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:195)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$3.execute(DefaultBuildOperationRunner.java:75)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$3.execute(DefaultBuildOperationRunner.java:68)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:153)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:68)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.call(DefaultBuildOperationRunner.java:62)\r\n        at org.gradle.internal.operations.DefaultBuildOperationExecutor.lambda$call$2(DefaultBuildOperationExecutor.java:76)\r\n        at org.gradle.internal.operations.UnmanagedBuildOperationWrapper.callWithUnmanagedSupport(UnmanagedBuildOperationWrapper.java:54)\r\n        at org.gradle.internal.operations.DefaultBuildOperationExecutor.call(DefaultBuildOperationExecutor.java:76)\r\n        at org.gradle.api.internal.tasks.compile.CompileJavaBuildOperationReportingCompiler.execute(CompileJavaBuildOperationReportingCompiler.java:51)\r\n        at org.gradle.api.tasks.compile.JavaCompile.performCompilation(JavaCompile.java:345)\r\n        at org.gradle.api.tasks.compile.JavaCompile.performIncrementalCompilation(JavaCompile.java:239)\r\n        at org.gradle.api.tasks.compile.JavaCompile.compile(JavaCompile.java:211)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.reflect.JavaMethod.invoke(JavaMethod.java:104)\r\n        at org.gradle.api.internal.project.taskfactory.IncrementalInputsTaskAction.doExecute(IncrementalInputsTaskAction.java:32)\r\n        at org.gradle.api.internal.project.taskfactory.StandardTaskAction.execute(StandardTaskAction.java:51)\r\n        at org.gradle.api.internal.project.taskfactory.AbstractIncrementalTaskAction.execute(AbstractIncrementalTaskAction.java:25)\r\n        at org.gradle.api.internal.project.taskfactory.StandardTaskAction.execute(StandardTaskAction.java:29)\r\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter$2.run(ExecuteActionsTaskExecuter.java:494)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$1.execute(DefaultBuildOperationRunner.java:29)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$1.execute(DefaultBuildOperationRunner.java:26)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$3.execute(DefaultBuildOperationRunner.java:75)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$3.execute(DefaultBuildOperationRunner.java:68)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:153)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:68)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.run(DefaultBuildOperationRunner.java:56)\r\n        at org.gradle.internal.operations.DefaultBuildOperationExecutor.lambda$run$1(DefaultBuildOperationExecutor.java:71)\r\n        at org.gradle.internal.operations.UnmanagedBuildOperationWrapper.runWithUnmanagedSupport(UnmanagedBuildOperationWrapper.java:45)\r\n        at org.gradle.internal.operations.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:71)\r\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeAction(ExecuteActionsTaskExecuter.java:479)\r\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeActions(ExecuteActionsTaskExecuter.java:462)\r\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.access$400(ExecuteActionsTaskExecuter.java:105)\r\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter$TaskExecution.executeWithPreviousOutputFiles(ExecuteActionsTaskExecuter.java:273)\r\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter$TaskExecution.execute(ExecuteActionsTaskExecuter.java:251)\r\n        at org.gradle.internal.execution.steps.ExecuteStep.lambda$executeOperation$0(ExecuteStep.java:65)\r\n        at java.util.Optional.map(Optional.java:215)\r\n        at org.gradle.internal.execution.steps.ExecuteStep.executeOperation(ExecuteStep.java:65)\r\n        at org.gradle.internal.execution.steps.ExecuteStep.access$000(ExecuteStep.java:34)\r\n        at org.gradle.internal.execution.steps.ExecuteStep$1.call(ExecuteStep.java:47)\r\n        at org.gradle.internal.execution.steps.ExecuteStep$1.call(ExecuteStep.java:44)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:200)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:195)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$3.execute(DefaultBuildOperationRunner.java:75)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$3.execute(DefaultBuildOperationRunner.java:68)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:153)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:68)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.call(DefaultBuildOperationRunner.java:62)\r\n        at org.gradle.internal.operations.DefaultBuildOperationExecutor.lambda$call$2(DefaultBuildOperationExecutor.java:76)\r\n        at org.gradle.internal.operations.UnmanagedBuildOperationWrapper.callWithUnmanagedSupport(UnmanagedBuildOperationWrapper.java:54)\r\n        at org.gradle.internal.operations.DefaultBuildOperationExecutor.call(DefaultBuildOperationExecutor.java:76)\r\n        at org.gradle.internal.execution.steps.ExecuteStep.execute(ExecuteStep.java:44)\r\n        at org.gradle.internal.execution.steps.ExecuteStep.execute(ExecuteStep.java:34)\r\n        at org.gradle.internal.execution.steps.RemovePreviousOutputsStep.execute(RemovePreviousOutputsStep.java:72)\r\n        at org.gradle.internal.execution.steps.RemovePreviousOutputsStep.execute(RemovePreviousOutputsStep.java:42)\r\n        at org.gradle.internal.execution.steps.ResolveInputChangesStep.execute(ResolveInputChangesStep.java:53)\r\n        at org.gradle.internal.execution.steps.ResolveInputChangesStep.execute(ResolveInputChangesStep.java:39)\r\n        at org.gradle.internal.execution.steps.CancelExecutionStep.execute(CancelExecutionStep.java:44)\r\n        at org.gradle.internal.execution.steps.TimeoutStep.executeWithoutTimeout(TimeoutStep.java:77)\r\n        at org.gradle.internal.execution.steps.TimeoutStep.execute(TimeoutStep.java:58)\r\n        at org.gradle.internal.execution.steps.CreateOutputsStep.execute(CreateOutputsStep.java:54)\r\n        at org.gradle.internal.execution.steps.CreateOutputsStep.execute(CreateOutputsStep.java:32)\r\n        at org.gradle.internal.execution.steps.CaptureStateAfterExecutionStep.execute(CaptureStateAfterExecutionStep.java:57)\r\n        at org.gradle.internal.execution.steps.CaptureStateAfterExecutionStep.execute(CaptureStateAfterExecutionStep.java:38)\r\n        at org.gradle.internal.execution.steps.BroadcastChangingOutputsStep.execute(BroadcastChangingOutputsStep.java:63)\r\n        at org.gradle.internal.execution.steps.BroadcastChangingOutputsStep.execute(BroadcastChangingOutputsStep.java:30)\r\n        at org.gradle.internal.execution.steps.BuildCacheStep.executeWithoutCache(BuildCacheStep.java:176)\r\n        at org.gradle.internal.execution.steps.BuildCacheStep.execute(BuildCacheStep.java:76)\r\n        at org.gradle.internal.execution.steps.BuildCacheStep.execute(BuildCacheStep.java:47)\r\n        at org.gradle.internal.execution.steps.StoreExecutionStateStep.execute(StoreExecutionStateStep.java:43)\r\n        at org.gradle.internal.execution.steps.StoreExecutionStateStep.execute(StoreExecutionStateStep.java:32)\r\n        at org.gradle.internal.execution.steps.RecordOutputsStep.execute(RecordOutputsStep.java:39)\r\n        at org.gradle.internal.execution.steps.RecordOutputsStep.execute(RecordOutputsStep.java:25)\r\n        at org.gradle.internal.execution.steps.SkipUpToDateStep.executeBecause(SkipUpToDateStep.java:102)\r\n        at org.gradle.internal.execution.steps.SkipUpToDateStep.lambda$execute$0(SkipUpToDateStep.java:95)\r\n        at java.util.Optional.map(Optional.java:215)\r\n        at org.gradle.internal.execution.steps.SkipUpToDateStep.execute(SkipUpToDateStep.java:55)\r\n        at org.gradle.internal.execution.steps.SkipUpToDateStep.execute(SkipUpToDateStep.java:39)\r\n        at org.gradle.internal.execution.steps.ResolveChangesStep.execute(ResolveChangesStep.java:83)\r\n        at org.gradle.internal.execution.steps.ResolveChangesStep.execute(ResolveChangesStep.java:44)\r\n        at org.gradle.internal.execution.steps.legacy.MarkSnapshottingInputsFinishedStep.execute(MarkSnapshottingInputsFinishedStep.java:37)\r\n        at org.gradle.internal.execution.steps.legacy.MarkSnapshottingInputsFinishedStep.execute(MarkSnapshottingInputsFinishedStep.java:27)\r\n        at org.gradle.internal.execution.steps.ResolveCachingStateStep.execute(ResolveCachingStateStep.java:96)\r\n        at org.gradle.internal.execution.steps.ResolveCachingStateStep.execute(ResolveCachingStateStep.java:52)\r\n        at org.gradle.internal.execution.steps.CaptureStateBeforeExecutionStep.execute(CaptureStateBeforeExecutionStep.java:83)\r\n        at org.gradle.internal.execution.steps.CaptureStateBeforeExecutionStep.execute(CaptureStateBeforeExecutionStep.java:54)\r\n        at org.gradle.internal.execution.steps.ValidateStep.execute(ValidateStep.java:74)\r\n        at org.gradle.internal.execution.steps.SkipEmptyWorkStep.lambda$execute$2(SkipEmptyWorkStep.java:88)\r\n        at java.util.Optional.orElseGet(Optional.java:267)\r\n        at org.gradle.internal.execution.steps.SkipEmptyWorkStep.execute(SkipEmptyWorkStep.java:88)\r\n        at org.gradle.internal.execution.steps.SkipEmptyWorkStep.execute(SkipEmptyWorkStep.java:34)\r\n        at org.gradle.internal.execution.steps.legacy.MarkSnapshottingInputsStartedStep.execute(MarkSnapshottingInputsStartedStep.java:38)\r\n        at org.gradle.internal.execution.steps.LoadExecutionStateStep.execute(LoadExecutionStateStep.java:46)\r\n        at org.gradle.internal.execution.steps.LoadExecutionStateStep.execute(LoadExecutionStateStep.java:34)\r\n        at org.gradle.internal.execution.steps.AssignWorkspaceStep.lambda$execute$0(AssignWorkspaceStep.java:43)\r\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter$TaskExecution$3.withWorkspace(ExecuteActionsTaskExecuter.java:286)\r\n        at org.gradle.internal.execution.steps.AssignWorkspaceStep.execute(AssignWorkspaceStep.java:43)\r\n        at org.gradle.internal.execution.steps.AssignWorkspaceStep.execute(AssignWorkspaceStep.java:33)\r\n        at org.gradle.internal.execution.steps.IdentityCacheStep.execute(IdentityCacheStep.java:40)\r\n        at org.gradle.internal.execution.steps.IdentityCacheStep.execute(IdentityCacheStep.java:30)\r\n        at org.gradle.internal.execution.steps.IdentifyStep.execute(IdentifyStep.java:54)\r\n        at org.gradle.internal.execution.steps.IdentifyStep.execute(IdentifyStep.java:40)\r\n        at org.gradle.internal.execution.impl.DefaultExecutionEngine.execute(DefaultExecutionEngine.java:41)\r\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.lambda$executeIfValid$1(ExecuteActionsTaskExecuter.java:183)\r\n        at java.util.Optional.orElseGet(Optional.java:267)\r\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeIfValid(ExecuteActionsTaskExecuter.java:183)\r\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.execute(ExecuteActionsTaskExecuter.java:173)\r\n        at org.gradle.api.internal.tasks.execution.CleanupStaleOutputsExecuter.execute(CleanupStaleOutputsExecuter.java:109)\r\n        at org.gradle.api.internal.tasks.execution.FinalizePropertiesTaskExecuter.execute(FinalizePropertiesTaskExecuter.java:46)\r\n        at org.gradle.api.internal.tasks.execution.ResolveTaskExecutionModeExecuter.execute(ResolveTaskExecutionModeExecuter.java:62)\r\n        at org.gradle.api.internal.tasks.execution.SkipTaskWithNoActionsExecuter.execute(SkipTaskWithNoActionsExecuter.java:57)\r\n        at org.gradle.api.internal.tasks.execution.SkipOnlyIfTaskExecuter.execute(SkipOnlyIfTaskExecuter.java:56)\r\n        at org.gradle.api.internal.tasks.execution.CatchExceptionTaskExecuter.execute(CatchExceptionTaskExecuter.java:36)\r\n        at org.gradle.api.internal.tasks.execution.EventFiringTaskExecuter$1.executeTask(EventFiringTaskExecuter.java:77)\r\n        at org.gradle.api.internal.tasks.execution.EventFiringTaskExecuter$1.call(EventFiringTaskExecuter.java:55)\r\n        at org.gradle.api.internal.tasks.execution.EventFiringTaskExecuter$1.call(EventFiringTaskExecuter.java:52)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:200)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:195)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$3.execute(DefaultBuildOperationRunner.java:75)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$3.execute(DefaultBuildOperationRunner.java:68)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:153)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:68)\r\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.call(DefaultBuildOperationRunner.java:62)\r\n        at org.gradle.internal.operations.DefaultBuildOperationExecutor.lambda$call$2(DefaultBuildOperationExecutor.java:76)\r\n        at org.gradle.internal.operations.UnmanagedBuildOperationWrapper.callWithUnmanagedSupport(UnmanagedBuildOperationWrapper.java:54)\r\n        at org.gradle.internal.operations.DefaultBuildOperationExecutor.call(DefaultBuildOperationExecutor.java:76)\r\n        at org.gradle.api.internal.tasks.execution.EventFiringTaskExecuter.execute(EventFiringTaskExecuter.java:52)\r\n        at org.gradle.execution.plan.LocalTaskNodeExecutor.execute(LocalTaskNodeExecutor.java:41)\r\n        at org.gradle.execution.taskgraph.DefaultTaskExecutionGraph$InvokeNodeExecutorsAction.execute(DefaultTaskExecutionGraph.java:411)\r\n        at org.gradle.execution.taskgraph.DefaultTaskExecutionGraph$InvokeNodeExecutorsAction.execute(DefaultTaskExecutionGraph.java:398)\r\n        \r\n\r\n&gt; Task :compileJava FAILED\r\n```\r\n\r\n\r\nBuild.gradle file\r\n\r\n```\r\nbuildscript {\r\n    repositories {\r\n        maven {\r\n            url &quot;https://plugins.gradle.org/m2/&quot;\r\n        }\r\n    }\r\n    dependencies {\r\n        classpath &#39;org.hibernate:hibernate-gradle-plugin:5.6.0.Final&#39;\r\n    }\r\n}\r\n\r\nplugins {\r\n    id &#39;java&#39;\r\n    id &#39;org.springframework.boot&#39; version &quot;${springBootVersion}&quot;\r\n    id &#39;io.spring.dependency-management&#39; version &quot;${springDependencyMgmt}&quot;\r\n    id &#39;org.hidetake.swagger.generator&#39; version &quot;${hideTakeSwaggerGen}&quot;\r\n    id &#39;java-library&#39;\r\n    id &#39;maven-publish&#39;\r\n    id &#39;groovy&#39;\r\n    id &#39;com.palantir.docker&#39; version &quot;${dockerPlugin}&quot;\r\n    id &quot;org.sonarqube&quot; version &quot;3.3&quot;\r\n    id &#39;jacoco&#39;\r\n    id &#39;io.franzbecker.gradle-lombok&#39; version &#39;5.0.0&#39;\r\n    id &#39;com.ewerk.gradle.plugins.querydsl&#39; version &#39;1.0.10&#39;\r\n}\r\n\r\napply plugin: &#39;jacoco&#39;\r\napply plugin: &quot;application&quot;\r\napply plugin: &#39;org.hibernate.orm&#39;\r\n\r\ngroup &#39;com.abcxyz&#39;\r\nversion &#39;1.1.5-SNAPSHOT&#39;\r\n\r\nsourceCompatibility = 1.8\r\n\r\nspringBoot {\r\n    buildInfo()\r\n}\r\n\r\nbootJar {\r\n    launchScript()\r\n}\r\nmainClassName = &quot;com.abcxyz.items.ItemApplication&quot;\r\n\r\nloadConfiguration()\r\n\r\nhibernate {\r\n    sourceSets = [project.sourceSets.main]\r\n    enhance {\r\n        enableLazyInitialization = true\r\n        enableDirtyTracking = true\r\n    }\r\n}\r\next[&#39;mockito.version&#39;] = &#39;4.3.1&#39;\r\next[&#39;snakeyaml.version&#39;] = &#39;1.33&#39;\r\n\r\n\r\ndef loadConfiguration() {\r\n    def environment = hasProperty(&#39;env&#39;) ? env : &#39;local&#39;\r\n    println &quot;Environment is set to $environment&quot;\r\n\r\n    def configFile = file(&#39;environment.groovy&#39;)\r\n    def config = new ConfigSlurper(environment).parse(configFile.toURL())\r\n\r\n    config.forEach { k, v -&gt;\r\n        project.ext[k] = v\r\n    }\r\n}\r\n\r\nrepositories {\r\n    mavenLocal()\r\n    mavenCentral()\r\n    maven {\r\n        url artifactory_build_url\r\n        credentials {\r\n            username System.env.CODEARTIFACT_USER\r\n            password System.env.CODEARTIFACT_AUTH_TOKEN\r\n        }\r\n    }\r\n\r\n    maven {\r\n        url &quot;https://packages.confluent.io/maven/&quot;\r\n    }\r\n}\r\n\r\njacoco {\r\n    toolVersion = &quot;0.8.4&quot;\r\n    reportsDir = file(&quot;$buildDir/jacoco&quot;)\r\n}\r\n\r\ndocker {\r\n    name &quot;items_ms&quot;\r\n    dockerfile file(&quot;Dockerfile-local&quot;)\r\n    copySpec.from(jar).rename(&quot;.*&quot;, &quot;items.jar&quot;)\r\n    buildArgs([&#39;JAR_FILE&#39;: &quot;items.jar&quot;])\r\n\r\n}\r\n\r\n\r\nsourceSets.main.java.srcDirs = [&#39;src/main/java&#39;, &#39;build/generated/sources/annotationProcessor/java/main&#39;]\r\nsourceSets {\r\n    integration {\r\n        groovy.srcDir &quot;$projectDir/src/integrationTest/groovy&quot;\r\n        resources.srcDir &quot;$projectDir/src/integrationTest/resources&quot;\r\n        compileClasspath += main.output + test.output\r\n        runtimeClasspath += main.output + test.output\r\n    }\r\n}\r\n\r\nconfigurations {\r\n    integrationImplementation.extendsFrom testImplementation\r\n    integrationRuntime.extendsFrom testRuntime\r\n}\r\n\r\ndependencyManagement {\r\n    imports {\r\n        mavenBom &quot;org.springframework.cloud:spring-cloud-dependencies:${hoxton}&quot;\r\n    }\r\n}\r\n\r\ndependencies {\r\n\r\n    // spring dependencies\r\n    compile &#39;org.springframework.boot:spring-boot-starter-validation&#39;\r\n    compile &#39;org.springframework.boot:spring-boot-configuration-processor&#39;\r\n    compile &#39;org.springframework:spring-context-support&#39;\r\n    compile &#39;org.springframework.boot:spring-boot-starter-actuator&#39;\r\n    compile &#39;org.springframework.boot:spring-boot-starter-batch&#39;\r\n    compile(&#39;org.springframework.boot:spring-boot-starter-data-jpa&#39;) {\r\n        exclude group: &quot;org.hibernate&quot;, module: &quot;hibernate-core&quot;\r\n    }\r\n    // https://mvnrepository.com/artifact/org.apache.tomcat/tomcat-jdbc\r\n    implementation &#39;org.apache.tomcat:tomcat-jdbc:10.0.0&#39;\r\n    implementation &quot;org.hibernate:hibernate-core:5.5.8.Final&quot;\r\n    compile &#39;org.springframework.boot:spring-boot-starter-security&#39;\r\n    compile &#39;org.springframework.boot:spring-boot-starter-web&#39;\r\n\r\n    implementation &#39;org.springframework.cloud:spring-cloud-context:3.1.7&#39;\r\n    implementation &#39;org.springframework.cloud:spring-cloud-commons:3.1.7&#39;\r\n    implementation &#39;org.springframework.cloud:spring-cloud-starter:3.1.7&#39;\r\n    // spring cloud dependencies\r\n    compile (&quot;org.springframework.cloud:spring-cloud-aws-context:2.2.6.RELEASE&quot;) {\r\n        exclude group: &quot;org.springframework.cloud&quot;, module: &quot;spring-cloud-commons&quot;\r\n        exclude group: &quot;org.springframework.cloud&quot;, module: &quot;spring-cloud-context&quot;\r\n        exclude group: &quot;org.springframework.cloud&quot;, module: &quot;spring-cloud-starter&quot;\r\n    }\r\n    compile &#39;org.springframework.cloud:spring-cloud-aws-messaging:2.2.6.RELEASE&#39;\r\n\r\n    // postgres\r\n    compile &#39;org.postgresql:postgresql&#39;\r\n\r\n    \r\n    // lombok dependencies\r\n    compileOnly &#39;org.projectlombok:lombok&#39;\r\n    annotationProcessor &#39;org.projectlombok:lombok&#39;\r\n    annotationProcessor &quot;com.abcxyz.cb-ms-core:cb-ms-annotation-processor:${msCore}&quot;\r\n\r\n    // my dep\r\n    annotationProcessor &quot;javax.persistence:javax.persistence-api:${jpa}&quot;\r\n    implementation &#39;org.springframework.boot:spring-boot-starter-web&#39;\r\n    implementation &#39;org.springframework.boot:spring-boot-starter-data-jpa&#39;\r\n    implementation &#39;com.querydsl:querydsl-jpa:5.0.0&#39;\r\n\r\n    // other annotation processors\r\n    annotationProcessor &quot;com.querydsl:querydsl-apt:${queryDsl}&quot;\r\n    annotationProcessor &quot;com.querydsl:querydsl-jpa:${queryDsl}:apt&quot;\r\n\r\n\r\n    // mapstruct dependencies\r\n    compile &quot;org.mapstruct:mapstruct:${mapstruct}&quot;\r\n    annotationProcessor &quot;org.mapstruct:mapstruct-processor:${mapstruct}&quot;\r\n    testCompile &quot;org.mapstruct:mapstruct:${mapstruct}&quot;\r\n    testAnnotationProcessor &quot;org.mapstruct:mapstruct-processor:${mapstruct}&quot;\r\n\r\n    // unit test dependencies\r\n    testImplementation &#39;org.springframework.boot:spring-boot-starter-test&#39;\r\n    testImplementation(&quot;org.spockframework:spock-core:${spockCore}&quot;) {\r\n        exclude group: &#39;org.codehaus.groovy&#39;\r\n    }\r\n    testImplementation &quot;org.codehaus.groovy:groovy:${codehausGroovy}&quot;\r\n    testImplementation &quot;org.spockframework:spock-spring:${spockCore}&quot;\r\n    testImplementation &#39;com.h2database:h2:2.2.222&#39;\r\n    testCompile &quot;cglib:cglib-nodep:${cglibNodep}&quot;\r\n    testImplementation &quot;org.mockito:mockito-inline&quot;\r\n    testImplementation &#39;com.tngtech.archunit:archunit:0.22.0&#39;\r\n\r\n    // flyway dependency\r\n    compile &quot;org.flywaydb:flyway-core:${flywayCore}&quot;\r\n\r\n    // swagger dependencies\r\n    implementation &quot;org.springdoc:springdoc-openapi-ui:${springDoc}&quot;\r\n    implementation &quot;org.springdoc:springdoc-openapi-webmvc-core:${springDoc}&quot;\r\n\r\n    // other dependencies\r\n    compile &quot;javax.inject:javax.inject:${javaxInject}&quot;\r\n    compile &quot;org.json:json:${orgJson}&quot;\r\n    compile &quot;com.google.code.gson:gson:${gson}&quot;\r\n    //compile &#39;io.swagger.codegen.v3:swagger-codegen-cli:3.0.10&#39;\r\n\r\n    //slueth - log tracing dependency\r\n    compile &#39;org.springframework.cloud:spring-cloud-starter-sleuth&#39;\r\n\r\n    //integration test dependencies\r\n    integrationImplementation &quot;org.testcontainers:spock:${testContainers}&quot;\r\n    integrationImplementation &quot;org.testcontainers:postgresql:${testContainers}&quot;\r\n    integrationRuntime &quot;org.codehaus.groovy:groovy-all:${codehausGroovy}&quot;\r\n    integrationImplementation(&quot;org.spockframework:spock-core:${spockCore}&quot;) {\r\n        exclude group: &#39;org.codehaus.groovy&#39;\r\n    }\r\n    integrationImplementation &quot;org.spockframework:spock-spring:${spockCore}&quot;\r\n    integrationImplementation &#39;org.springframework.security:spring-security-test&#39;\r\n    integrationImplementation &quot;org.testcontainers:localstack:${testContainers}&quot;\r\n\r\n    //security fix for https://blog.cloudflare.com/cve-2021-44228-log4j-rce-0-day-mitigation/\r\n    implementation &#39;org.apache.logging.log4j:log4j-to-slf4j:2.16.0&#39;\r\n    implementation &#39;org.apache.logging.log4j:log4j-api:2.16.0&#39;\r\n    implementation group: &#39;org.apache.commons&#39;, name: &#39;commons-text&#39;, version: &#39;1.10.0&#39;\r\n\r\n    //graphql dependencies\r\n    implementation &quot;org.springframework.boot:spring-boot-starter-graphql:${springBootVersion}&quot;\r\n    \r\n\r\n}\r\n\r\ndef generatedClassesPath= &quot;build/generated/sources/annotationProcessor/java/main&quot;\r\n\r\nquerydsl {\r\n    library = &#39;com.querydsl:querydsl-apt:5.0.0&#39;\r\n    jpa = true\r\n    querydslSourcesDir = generatedClassesPath\r\n}\r\n\r\n\r\nconfigurations {\r\n    querydsl.extendsFrom implementation, compileClasspath\r\n}\r\n\r\n\r\ncompileQuerydsl {\r\n    options.annotationProcessorPath = configurations.querydsl\r\n}\r\n\r\nproject.afterEvaluate {\r\n    project.tasks.compileQuerydsl.options.compilerArgs = [\r\n            &quot;-proc:only&quot;,\r\n            &quot;-processor&quot;, project.querydsl.processors() +\r\n                    &#39;,lombok.launch.AnnotationProcessorHider$AnnotationProcessor&#39;\r\n    ]\r\n}\r\n\r\n\r\ntest.finalizedBy jacocoTestReport\r\ncheck.dependsOn jacocoTestCoverageVerification\r\n\r\ntask genOperationsModels(type: JavaExec) {\r\n    main = &#39;com.abcxyz.items.ApiModelGenerator&#39;\r\n    classpath = configurations.compile + configurations.compileOnly + files(&quot;${buildDir}/resources/main&quot;) + files(&quot;${buildDir}/classes/java/main&quot;)\r\n    String resourceName = &quot;public/resources/spec.yaml&quot;\r\n    String microServiceName = &quot;plan ms&quot;\r\n    String outputPath = &quot;${project.projectDir}&quot;\r\n    String generatorName = &quot;cb-spring&quot;\r\n    String apiPackage = &quot;com.abcxyz.items.api&quot;\r\n    String modelPackage = &quot;com.abcxyz.items.api.model&quot;\r\n    String callableApis = &quot;false&quot;\r\n    args += [microServiceName, resourceName, outputPath, generatorName, apiPackage, modelPackage, callableApis]\r\n}\r\ngenOperationsModels.dependsOn build\r\n```\r\n\r\n","title":"Spring boot Gradle Build Java Compiler issue java.lang.IllegalStateException: endPosTable already set","body":"<p>I am facing java compiler issue while running gradle build. It passes when I rerun it locally. But I cannot rerun on jenkins and build always fails there.</p>\n<p>gradle version : 6.9\njava 1.8\nspring boot : 2.7.15</p>\n<p>after running <code>clean build</code> following exception comes for <code>compileJava</code> task.</p>\n<p>And it build is success after retry, then while starting application</p>\n<p>same exception comes but for <code>compileQuerydsl</code> task. What m i doing wrong, or any flag i need to update in gradle file</p>\n<p>Exception:</p>\n<pre><code>java.lang.IllegalStateException: endPosTable already set\n        at com.sun.tools.javac.util.DiagnosticSource.setEndPosTable(DiagnosticSource.java:136)\n        at com.sun.tools.javac.util.Log.setEndPosTable(Log.java:350)\n        at com.sun.tools.javac.main.JavaCompiler.parse(JavaCompiler.java:667)\n        at com.sun.tools.javac.main.JavaCompiler.parseFiles(JavaCompiler.java:950)\n        at com.sun.tools.javac.processing.JavacProcessingEnvironment$Round.&lt;init&gt;(JavacProcessingEnvironment.java:900)\n        at com.sun.tools.javac.processing.JavacProcessingEnvironment$Round.next(JavacProcessingEnvironment.java:929)\n        at com.sun.tools.javac.processing.JavacProcessingEnvironment.doProcessing(JavacProcessingEnvironment.java:1195)\n        at com.sun.tools.javac.main.JavaCompiler.processAnnotations(JavaCompiler.java:1170)\n        at com.sun.tools.javac.main.JavaCompiler.compile(JavaCompiler.java:856)\n        at com.sun.tools.javac.main.Main.compile(Main.java:523)\n        at com.sun.tools.javac.api.JavacTaskImpl.doCall(JavacTaskImpl.java:129)\n        at com.sun.tools.javac.api.JavacTaskImpl.call(JavacTaskImpl.java:138)\n        at org.gradle.internal.compiler.java.IncrementalCompileTask.call(IncrementalCompileTask.java:77)\n        at org.gradle.api.internal.tasks.compile.AnnotationProcessingCompileTask.call(AnnotationProcessingCompileTask.java:94)\n        at org.gradle.api.internal.tasks.compile.ResourceCleaningCompilationTask.call(ResourceCleaningCompilationTask.java:57)\n        at org.gradle.api.internal.tasks.compile.JdkJavaCompiler.execute(JdkJavaCompiler.java:55)\n        at org.gradle.api.internal.tasks.compile.JdkJavaCompiler.execute(JdkJavaCompiler.java:40)\n        at org.gradle.api.internal.tasks.compile.NormalizingJavaCompiler.delegateAndHandleErrors(NormalizingJavaCompiler.java:97)\n        at org.gradle.api.internal.tasks.compile.NormalizingJavaCompiler.execute(NormalizingJavaCompiler.java:51)\n        at org.gradle.api.internal.tasks.compile.NormalizingJavaCompiler.execute(NormalizingJavaCompiler.java:37)\n        at org.gradle.api.internal.tasks.compile.AnnotationProcessorDiscoveringCompiler.execute(AnnotationProcessorDiscoveringCompiler.java:51)\n        at org.gradle.api.internal.tasks.compile.AnnotationProcessorDiscoveringCompiler.execute(AnnotationProcessorDiscoveringCompiler.java:37)\n        at org.gradle.api.internal.tasks.compile.ModuleApplicationNameWritingCompiler.execute(ModuleApplicationNameWritingCompiler.java:46)\n        at org.gradle.api.internal.tasks.compile.ModuleApplicationNameWritingCompiler.execute(ModuleApplicationNameWritingCompiler.java:36)\n        at org.gradle.api.internal.tasks.compile.CleaningJavaCompiler.execute(CleaningJavaCompiler.java:53)\n        at org.gradle.api.internal.tasks.compile.incremental.IncrementalCompilerFactory.lambda$createRebuildAllCompiler$0(IncrementalCompilerFactory.java:98)\n        at org.gradle.api.internal.tasks.compile.incremental.IncrementalResultStoringCompiler.execute(IncrementalResultStoringCompiler.java:61)\n        at org.gradle.api.internal.tasks.compile.incremental.IncrementalResultStoringCompiler.execute(IncrementalResultStoringCompiler.java:45)\n        at org.gradle.api.internal.tasks.compile.CompileJavaBuildOperationReportingCompiler$2.call(CompileJavaBuildOperationReportingCompiler.java:59)\n        at org.gradle.api.internal.tasks.compile.CompileJavaBuildOperationReportingCompiler$2.call(CompileJavaBuildOperationReportingCompiler.java:51)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:200)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:195)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$3.execute(DefaultBuildOperationRunner.java:75)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$3.execute(DefaultBuildOperationRunner.java:68)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:153)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:68)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.call(DefaultBuildOperationRunner.java:62)\n        at org.gradle.internal.operations.DefaultBuildOperationExecutor.lambda$call$2(DefaultBuildOperationExecutor.java:76)\n        at org.gradle.internal.operations.UnmanagedBuildOperationWrapper.callWithUnmanagedSupport(UnmanagedBuildOperationWrapper.java:54)\n        at org.gradle.internal.operations.DefaultBuildOperationExecutor.call(DefaultBuildOperationExecutor.java:76)\n        at org.gradle.api.internal.tasks.compile.CompileJavaBuildOperationReportingCompiler.execute(CompileJavaBuildOperationReportingCompiler.java:51)\n        at org.gradle.api.tasks.compile.JavaCompile.performCompilation(JavaCompile.java:345)\n        at org.gradle.api.tasks.compile.JavaCompile.performIncrementalCompilation(JavaCompile.java:239)\n        at org.gradle.api.tasks.compile.JavaCompile.compile(JavaCompile.java:211)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:498)\n        at org.gradle.internal.reflect.JavaMethod.invoke(JavaMethod.java:104)\n        at org.gradle.api.internal.project.taskfactory.IncrementalInputsTaskAction.doExecute(IncrementalInputsTaskAction.java:32)\n        at org.gradle.api.internal.project.taskfactory.StandardTaskAction.execute(StandardTaskAction.java:51)\n        at org.gradle.api.internal.project.taskfactory.AbstractIncrementalTaskAction.execute(AbstractIncrementalTaskAction.java:25)\n        at org.gradle.api.internal.project.taskfactory.StandardTaskAction.execute(StandardTaskAction.java:29)\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter$2.run(ExecuteActionsTaskExecuter.java:494)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$1.execute(DefaultBuildOperationRunner.java:29)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$1.execute(DefaultBuildOperationRunner.java:26)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$3.execute(DefaultBuildOperationRunner.java:75)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$3.execute(DefaultBuildOperationRunner.java:68)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:153)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:68)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.run(DefaultBuildOperationRunner.java:56)\n        at org.gradle.internal.operations.DefaultBuildOperationExecutor.lambda$run$1(DefaultBuildOperationExecutor.java:71)\n        at org.gradle.internal.operations.UnmanagedBuildOperationWrapper.runWithUnmanagedSupport(UnmanagedBuildOperationWrapper.java:45)\n        at org.gradle.internal.operations.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:71)\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeAction(ExecuteActionsTaskExecuter.java:479)\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeActions(ExecuteActionsTaskExecuter.java:462)\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.access$400(ExecuteActionsTaskExecuter.java:105)\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter$TaskExecution.executeWithPreviousOutputFiles(ExecuteActionsTaskExecuter.java:273)\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter$TaskExecution.execute(ExecuteActionsTaskExecuter.java:251)\n        at org.gradle.internal.execution.steps.ExecuteStep.lambda$executeOperation$0(ExecuteStep.java:65)\n        at java.util.Optional.map(Optional.java:215)\n        at org.gradle.internal.execution.steps.ExecuteStep.executeOperation(ExecuteStep.java:65)\n        at org.gradle.internal.execution.steps.ExecuteStep.access$000(ExecuteStep.java:34)\n        at org.gradle.internal.execution.steps.ExecuteStep$1.call(ExecuteStep.java:47)\n        at org.gradle.internal.execution.steps.ExecuteStep$1.call(ExecuteStep.java:44)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:200)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:195)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$3.execute(DefaultBuildOperationRunner.java:75)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$3.execute(DefaultBuildOperationRunner.java:68)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:153)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:68)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.call(DefaultBuildOperationRunner.java:62)\n        at org.gradle.internal.operations.DefaultBuildOperationExecutor.lambda$call$2(DefaultBuildOperationExecutor.java:76)\n        at org.gradle.internal.operations.UnmanagedBuildOperationWrapper.callWithUnmanagedSupport(UnmanagedBuildOperationWrapper.java:54)\n        at org.gradle.internal.operations.DefaultBuildOperationExecutor.call(DefaultBuildOperationExecutor.java:76)\n        at org.gradle.internal.execution.steps.ExecuteStep.execute(ExecuteStep.java:44)\n        at org.gradle.internal.execution.steps.ExecuteStep.execute(ExecuteStep.java:34)\n        at org.gradle.internal.execution.steps.RemovePreviousOutputsStep.execute(RemovePreviousOutputsStep.java:72)\n        at org.gradle.internal.execution.steps.RemovePreviousOutputsStep.execute(RemovePreviousOutputsStep.java:42)\n        at org.gradle.internal.execution.steps.ResolveInputChangesStep.execute(ResolveInputChangesStep.java:53)\n        at org.gradle.internal.execution.steps.ResolveInputChangesStep.execute(ResolveInputChangesStep.java:39)\n        at org.gradle.internal.execution.steps.CancelExecutionStep.execute(CancelExecutionStep.java:44)\n        at org.gradle.internal.execution.steps.TimeoutStep.executeWithoutTimeout(TimeoutStep.java:77)\n        at org.gradle.internal.execution.steps.TimeoutStep.execute(TimeoutStep.java:58)\n        at org.gradle.internal.execution.steps.CreateOutputsStep.execute(CreateOutputsStep.java:54)\n        at org.gradle.internal.execution.steps.CreateOutputsStep.execute(CreateOutputsStep.java:32)\n        at org.gradle.internal.execution.steps.CaptureStateAfterExecutionStep.execute(CaptureStateAfterExecutionStep.java:57)\n        at org.gradle.internal.execution.steps.CaptureStateAfterExecutionStep.execute(CaptureStateAfterExecutionStep.java:38)\n        at org.gradle.internal.execution.steps.BroadcastChangingOutputsStep.execute(BroadcastChangingOutputsStep.java:63)\n        at org.gradle.internal.execution.steps.BroadcastChangingOutputsStep.execute(BroadcastChangingOutputsStep.java:30)\n        at org.gradle.internal.execution.steps.BuildCacheStep.executeWithoutCache(BuildCacheStep.java:176)\n        at org.gradle.internal.execution.steps.BuildCacheStep.execute(BuildCacheStep.java:76)\n        at org.gradle.internal.execution.steps.BuildCacheStep.execute(BuildCacheStep.java:47)\n        at org.gradle.internal.execution.steps.StoreExecutionStateStep.execute(StoreExecutionStateStep.java:43)\n        at org.gradle.internal.execution.steps.StoreExecutionStateStep.execute(StoreExecutionStateStep.java:32)\n        at org.gradle.internal.execution.steps.RecordOutputsStep.execute(RecordOutputsStep.java:39)\n        at org.gradle.internal.execution.steps.RecordOutputsStep.execute(RecordOutputsStep.java:25)\n        at org.gradle.internal.execution.steps.SkipUpToDateStep.executeBecause(SkipUpToDateStep.java:102)\n        at org.gradle.internal.execution.steps.SkipUpToDateStep.lambda$execute$0(SkipUpToDateStep.java:95)\n        at java.util.Optional.map(Optional.java:215)\n        at org.gradle.internal.execution.steps.SkipUpToDateStep.execute(SkipUpToDateStep.java:55)\n        at org.gradle.internal.execution.steps.SkipUpToDateStep.execute(SkipUpToDateStep.java:39)\n        at org.gradle.internal.execution.steps.ResolveChangesStep.execute(ResolveChangesStep.java:83)\n        at org.gradle.internal.execution.steps.ResolveChangesStep.execute(ResolveChangesStep.java:44)\n        at org.gradle.internal.execution.steps.legacy.MarkSnapshottingInputsFinishedStep.execute(MarkSnapshottingInputsFinishedStep.java:37)\n        at org.gradle.internal.execution.steps.legacy.MarkSnapshottingInputsFinishedStep.execute(MarkSnapshottingInputsFinishedStep.java:27)\n        at org.gradle.internal.execution.steps.ResolveCachingStateStep.execute(ResolveCachingStateStep.java:96)\n        at org.gradle.internal.execution.steps.ResolveCachingStateStep.execute(ResolveCachingStateStep.java:52)\n        at org.gradle.internal.execution.steps.CaptureStateBeforeExecutionStep.execute(CaptureStateBeforeExecutionStep.java:83)\n        at org.gradle.internal.execution.steps.CaptureStateBeforeExecutionStep.execute(CaptureStateBeforeExecutionStep.java:54)\n        at org.gradle.internal.execution.steps.ValidateStep.execute(ValidateStep.java:74)\n        at org.gradle.internal.execution.steps.SkipEmptyWorkStep.lambda$execute$2(SkipEmptyWorkStep.java:88)\n        at java.util.Optional.orElseGet(Optional.java:267)\n        at org.gradle.internal.execution.steps.SkipEmptyWorkStep.execute(SkipEmptyWorkStep.java:88)\n        at org.gradle.internal.execution.steps.SkipEmptyWorkStep.execute(SkipEmptyWorkStep.java:34)\n        at org.gradle.internal.execution.steps.legacy.MarkSnapshottingInputsStartedStep.execute(MarkSnapshottingInputsStartedStep.java:38)\n        at org.gradle.internal.execution.steps.LoadExecutionStateStep.execute(LoadExecutionStateStep.java:46)\n        at org.gradle.internal.execution.steps.LoadExecutionStateStep.execute(LoadExecutionStateStep.java:34)\n        at org.gradle.internal.execution.steps.AssignWorkspaceStep.lambda$execute$0(AssignWorkspaceStep.java:43)\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter$TaskExecution$3.withWorkspace(ExecuteActionsTaskExecuter.java:286)\n        at org.gradle.internal.execution.steps.AssignWorkspaceStep.execute(AssignWorkspaceStep.java:43)\n        at org.gradle.internal.execution.steps.AssignWorkspaceStep.execute(AssignWorkspaceStep.java:33)\n        at org.gradle.internal.execution.steps.IdentityCacheStep.execute(IdentityCacheStep.java:40)\n        at org.gradle.internal.execution.steps.IdentityCacheStep.execute(IdentityCacheStep.java:30)\n        at org.gradle.internal.execution.steps.IdentifyStep.execute(IdentifyStep.java:54)\n        at org.gradle.internal.execution.steps.IdentifyStep.execute(IdentifyStep.java:40)\n        at org.gradle.internal.execution.impl.DefaultExecutionEngine.execute(DefaultExecutionEngine.java:41)\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.lambda$executeIfValid$1(ExecuteActionsTaskExecuter.java:183)\n        at java.util.Optional.orElseGet(Optional.java:267)\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeIfValid(ExecuteActionsTaskExecuter.java:183)\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.execute(ExecuteActionsTaskExecuter.java:173)\n        at org.gradle.api.internal.tasks.execution.CleanupStaleOutputsExecuter.execute(CleanupStaleOutputsExecuter.java:109)\n        at org.gradle.api.internal.tasks.execution.FinalizePropertiesTaskExecuter.execute(FinalizePropertiesTaskExecuter.java:46)\n        at org.gradle.api.internal.tasks.execution.ResolveTaskExecutionModeExecuter.execute(ResolveTaskExecutionModeExecuter.java:62)\n        at org.gradle.api.internal.tasks.execution.SkipTaskWithNoActionsExecuter.execute(SkipTaskWithNoActionsExecuter.java:57)\n        at org.gradle.api.internal.tasks.execution.SkipOnlyIfTaskExecuter.execute(SkipOnlyIfTaskExecuter.java:56)\n        at org.gradle.api.internal.tasks.execution.CatchExceptionTaskExecuter.execute(CatchExceptionTaskExecuter.java:36)\n        at org.gradle.api.internal.tasks.execution.EventFiringTaskExecuter$1.executeTask(EventFiringTaskExecuter.java:77)\n        at org.gradle.api.internal.tasks.execution.EventFiringTaskExecuter$1.call(EventFiringTaskExecuter.java:55)\n        at org.gradle.api.internal.tasks.execution.EventFiringTaskExecuter$1.call(EventFiringTaskExecuter.java:52)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:200)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:195)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$3.execute(DefaultBuildOperationRunner.java:75)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner$3.execute(DefaultBuildOperationRunner.java:68)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:153)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:68)\n        at org.gradle.internal.operations.DefaultBuildOperationRunner.call(DefaultBuildOperationRunner.java:62)\n        at org.gradle.internal.operations.DefaultBuildOperationExecutor.lambda$call$2(DefaultBuildOperationExecutor.java:76)\n        at org.gradle.internal.operations.UnmanagedBuildOperationWrapper.callWithUnmanagedSupport(UnmanagedBuildOperationWrapper.java:54)\n        at org.gradle.internal.operations.DefaultBuildOperationExecutor.call(DefaultBuildOperationExecutor.java:76)\n        at org.gradle.api.internal.tasks.execution.EventFiringTaskExecuter.execute(EventFiringTaskExecuter.java:52)\n        at org.gradle.execution.plan.LocalTaskNodeExecutor.execute(LocalTaskNodeExecutor.java:41)\n        at org.gradle.execution.taskgraph.DefaultTaskExecutionGraph$InvokeNodeExecutorsAction.execute(DefaultTaskExecutionGraph.java:411)\n        at org.gradle.execution.taskgraph.DefaultTaskExecutionGraph$InvokeNodeExecutorsAction.execute(DefaultTaskExecutionGraph.java:398)\n        \n\n&gt; Task :compileJava FAILED\n</code></pre>\n<p>Build.gradle file</p>\n<pre><code>buildscript {\n    repositories {\n        maven {\n            url &quot;https://plugins.gradle.org/m2/&quot;\n        }\n    }\n    dependencies {\n        classpath 'org.hibernate:hibernate-gradle-plugin:5.6.0.Final'\n    }\n}\n\nplugins {\n    id 'java'\n    id 'org.springframework.boot' version &quot;${springBootVersion}&quot;\n    id 'io.spring.dependency-management' version &quot;${springDependencyMgmt}&quot;\n    id 'org.hidetake.swagger.generator' version &quot;${hideTakeSwaggerGen}&quot;\n    id 'java-library'\n    id 'maven-publish'\n    id 'groovy'\n    id 'com.palantir.docker' version &quot;${dockerPlugin}&quot;\n    id &quot;org.sonarqube&quot; version &quot;3.3&quot;\n    id 'jacoco'\n    id 'io.franzbecker.gradle-lombok' version '5.0.0'\n    id 'com.ewerk.gradle.plugins.querydsl' version '1.0.10'\n}\n\napply plugin: 'jacoco'\napply plugin: &quot;application&quot;\napply plugin: 'org.hibernate.orm'\n\ngroup 'com.abcxyz'\nversion '1.1.5-SNAPSHOT'\n\nsourceCompatibility = 1.8\n\nspringBoot {\n    buildInfo()\n}\n\nbootJar {\n    launchScript()\n}\nmainClassName = &quot;com.abcxyz.items.ItemApplication&quot;\n\nloadConfiguration()\n\nhibernate {\n    sourceSets = [project.sourceSets.main]\n    enhance {\n        enableLazyInitialization = true\n        enableDirtyTracking = true\n    }\n}\next['mockito.version'] = '4.3.1'\next['snakeyaml.version'] = '1.33'\n\n\ndef loadConfiguration() {\n    def environment = hasProperty('env') ? env : 'local'\n    println &quot;Environment is set to $environment&quot;\n\n    def configFile = file('environment.groovy')\n    def config = new ConfigSlurper(environment).parse(configFile.toURL())\n\n    config.forEach { k, v -&gt;\n        project.ext[k] = v\n    }\n}\n\nrepositories {\n    mavenLocal()\n    mavenCentral()\n    maven {\n        url artifactory_build_url\n        credentials {\n            username System.env.CODEARTIFACT_USER\n            password System.env.CODEARTIFACT_AUTH_TOKEN\n        }\n    }\n\n    maven {\n        url &quot;https://packages.confluent.io/maven/&quot;\n    }\n}\n\njacoco {\n    toolVersion = &quot;0.8.4&quot;\n    reportsDir = file(&quot;$buildDir/jacoco&quot;)\n}\n\ndocker {\n    name &quot;items_ms&quot;\n    dockerfile file(&quot;Dockerfile-local&quot;)\n    copySpec.from(jar).rename(&quot;.*&quot;, &quot;items.jar&quot;)\n    buildArgs(['JAR_FILE': &quot;items.jar&quot;])\n\n}\n\n\nsourceSets.main.java.srcDirs = ['src/main/java', 'build/generated/sources/annotationProcessor/java/main']\nsourceSets {\n    integration {\n        groovy.srcDir &quot;$projectDir/src/integrationTest/groovy&quot;\n        resources.srcDir &quot;$projectDir/src/integrationTest/resources&quot;\n        compileClasspath += main.output + test.output\n        runtimeClasspath += main.output + test.output\n    }\n}\n\nconfigurations {\n    integrationImplementation.extendsFrom testImplementation\n    integrationRuntime.extendsFrom testRuntime\n}\n\ndependencyManagement {\n    imports {\n        mavenBom &quot;org.springframework.cloud:spring-cloud-dependencies:${hoxton}&quot;\n    }\n}\n\ndependencies {\n\n    // spring dependencies\n    compile 'org.springframework.boot:spring-boot-starter-validation'\n    compile 'org.springframework.boot:spring-boot-configuration-processor'\n    compile 'org.springframework:spring-context-support'\n    compile 'org.springframework.boot:spring-boot-starter-actuator'\n    compile 'org.springframework.boot:spring-boot-starter-batch'\n    compile('org.springframework.boot:spring-boot-starter-data-jpa') {\n        exclude group: &quot;org.hibernate&quot;, module: &quot;hibernate-core&quot;\n    }\n    // https://mvnrepository.com/artifact/org.apache.tomcat/tomcat-jdbc\n    implementation 'org.apache.tomcat:tomcat-jdbc:10.0.0'\n    implementation &quot;org.hibernate:hibernate-core:5.5.8.Final&quot;\n    compile 'org.springframework.boot:spring-boot-starter-security'\n    compile 'org.springframework.boot:spring-boot-starter-web'\n\n    implementation 'org.springframework.cloud:spring-cloud-context:3.1.7'\n    implementation 'org.springframework.cloud:spring-cloud-commons:3.1.7'\n    implementation 'org.springframework.cloud:spring-cloud-starter:3.1.7'\n    // spring cloud dependencies\n    compile (&quot;org.springframework.cloud:spring-cloud-aws-context:2.2.6.RELEASE&quot;) {\n        exclude group: &quot;org.springframework.cloud&quot;, module: &quot;spring-cloud-commons&quot;\n        exclude group: &quot;org.springframework.cloud&quot;, module: &quot;spring-cloud-context&quot;\n        exclude group: &quot;org.springframework.cloud&quot;, module: &quot;spring-cloud-starter&quot;\n    }\n    compile 'org.springframework.cloud:spring-cloud-aws-messaging:2.2.6.RELEASE'\n\n    // postgres\n    compile 'org.postgresql:postgresql'\n\n    \n    // lombok dependencies\n    compileOnly 'org.projectlombok:lombok'\n    annotationProcessor 'org.projectlombok:lombok'\n    annotationProcessor &quot;com.abcxyz.cb-ms-core:cb-ms-annotation-processor:${msCore}&quot;\n\n    // my dep\n    annotationProcessor &quot;javax.persistence:javax.persistence-api:${jpa}&quot;\n    implementation 'org.springframework.boot:spring-boot-starter-web'\n    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'\n    implementation 'com.querydsl:querydsl-jpa:5.0.0'\n\n    // other annotation processors\n    annotationProcessor &quot;com.querydsl:querydsl-apt:${queryDsl}&quot;\n    annotationProcessor &quot;com.querydsl:querydsl-jpa:${queryDsl}:apt&quot;\n\n\n    // mapstruct dependencies\n    compile &quot;org.mapstruct:mapstruct:${mapstruct}&quot;\n    annotationProcessor &quot;org.mapstruct:mapstruct-processor:${mapstruct}&quot;\n    testCompile &quot;org.mapstruct:mapstruct:${mapstruct}&quot;\n    testAnnotationProcessor &quot;org.mapstruct:mapstruct-processor:${mapstruct}&quot;\n\n    // unit test dependencies\n    testImplementation 'org.springframework.boot:spring-boot-starter-test'\n    testImplementation(&quot;org.spockframework:spock-core:${spockCore}&quot;) {\n        exclude group: 'org.codehaus.groovy'\n    }\n    testImplementation &quot;org.codehaus.groovy:groovy:${codehausGroovy}&quot;\n    testImplementation &quot;org.spockframework:spock-spring:${spockCore}&quot;\n    testImplementation 'com.h2database:h2:2.2.222'\n    testCompile &quot;cglib:cglib-nodep:${cglibNodep}&quot;\n    testImplementation &quot;org.mockito:mockito-inline&quot;\n    testImplementation 'com.tngtech.archunit:archunit:0.22.0'\n\n    // flyway dependency\n    compile &quot;org.flywaydb:flyway-core:${flywayCore}&quot;\n\n    // swagger dependencies\n    implementation &quot;org.springdoc:springdoc-openapi-ui:${springDoc}&quot;\n    implementation &quot;org.springdoc:springdoc-openapi-webmvc-core:${springDoc}&quot;\n\n    // other dependencies\n    compile &quot;javax.inject:javax.inject:${javaxInject}&quot;\n    compile &quot;org.json:json:${orgJson}&quot;\n    compile &quot;com.google.code.gson:gson:${gson}&quot;\n    //compile 'io.swagger.codegen.v3:swagger-codegen-cli:3.0.10'\n\n    //slueth - log tracing dependency\n    compile 'org.springframework.cloud:spring-cloud-starter-sleuth'\n\n    //integration test dependencies\n    integrationImplementation &quot;org.testcontainers:spock:${testContainers}&quot;\n    integrationImplementation &quot;org.testcontainers:postgresql:${testContainers}&quot;\n    integrationRuntime &quot;org.codehaus.groovy:groovy-all:${codehausGroovy}&quot;\n    integrationImplementation(&quot;org.spockframework:spock-core:${spockCore}&quot;) {\n        exclude group: 'org.codehaus.groovy'\n    }\n    integrationImplementation &quot;org.spockframework:spock-spring:${spockCore}&quot;\n    integrationImplementation 'org.springframework.security:spring-security-test'\n    integrationImplementation &quot;org.testcontainers:localstack:${testContainers}&quot;\n\n    //security fix for https://blog.cloudflare.com/cve-2021-44228-log4j-rce-0-day-mitigation/\n    implementation 'org.apache.logging.log4j:log4j-to-slf4j:2.16.0'\n    implementation 'org.apache.logging.log4j:log4j-api:2.16.0'\n    implementation group: 'org.apache.commons', name: 'commons-text', version: '1.10.0'\n\n    //graphql dependencies\n    implementation &quot;org.springframework.boot:spring-boot-starter-graphql:${springBootVersion}&quot;\n    \n\n}\n\ndef generatedClassesPath= &quot;build/generated/sources/annotationProcessor/java/main&quot;\n\nquerydsl {\n    library = 'com.querydsl:querydsl-apt:5.0.0'\n    jpa = true\n    querydslSourcesDir = generatedClassesPath\n}\n\n\nconfigurations {\n    querydsl.extendsFrom implementation, compileClasspath\n}\n\n\ncompileQuerydsl {\n    options.annotationProcessorPath = configurations.querydsl\n}\n\nproject.afterEvaluate {\n    project.tasks.compileQuerydsl.options.compilerArgs = [\n            &quot;-proc:only&quot;,\n            &quot;-processor&quot;, project.querydsl.processors() +\n                    ',lombok.launch.AnnotationProcessorHider$AnnotationProcessor'\n    ]\n}\n\n\ntest.finalizedBy jacocoTestReport\ncheck.dependsOn jacocoTestCoverageVerification\n\ntask genOperationsModels(type: JavaExec) {\n    main = 'com.abcxyz.items.ApiModelGenerator'\n    classpath = configurations.compile + configurations.compileOnly + files(&quot;${buildDir}/resources/main&quot;) + files(&quot;${buildDir}/classes/java/main&quot;)\n    String resourceName = &quot;public/resources/spec.yaml&quot;\n    String microServiceName = &quot;plan ms&quot;\n    String outputPath = &quot;${project.projectDir}&quot;\n    String generatorName = &quot;cb-spring&quot;\n    String apiPackage = &quot;com.abcxyz.items.api&quot;\n    String modelPackage = &quot;com.abcxyz.items.api.model&quot;\n    String callableApis = &quot;false&quot;\n    args += [microServiceName, resourceName, outputPath, generatorName, apiPackage, modelPackage, callableApis]\n}\ngenOperationsModels.dependsOn build\n</code></pre>\n"},{"tags":["java","spring","spring-batch"],"owner":{"account_id":19188329,"reputation":1,"user_id":14018622,"display_name":"Arsenal"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":27,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1695286733,"answer_count":0,"score":0,"last_activity_date":1695374240,"creation_date":1695264382,"question_id":77146904,"body_markdown":"I&#39;m working on migration Spring Batch 5. I&#39;m using Jave 17 and Spring Boot 3. I didn&#39;t have any issue on step and job. However, In spring batch 5 DefaultBatchConfigurer is removed. setting datasource is different. I tried to use  Spring Batch 5 migiration guide but I&#39;m getting PreparedStatementCallback; bad SQL grammar [INSERT INTO BATCH_JOB_EXECUTION_PARAMS(JOB_EXECUTION_ID, PARAMETER_NAME,... error.\r\n\r\nmy Batchconf file is:\r\n\r\n```\r\n@Configuration\r\n@AutoConfigureAfter(JobRepo.class)\r\n@EnableBatchProcessing(dataSourceRef = &quot;batchDataSource&quot;, transactionManagerRef = &quot;batchTransactionManager&quot;)\r\npublic class BatchConfiguration {\r\n\r\n    @Autowired\r\n    @Qualifier(&quot;BatchConfig&quot;)\r\n    DataSource dataSource;\r\n    \r\n    @Bean\r\n    public DataSource batchDataSource() {\r\n        return dataSource;\r\n    }\r\n\r\n    @Bean\r\n    public JdbcTransactionManager batchTransactionManager(DataSource dataSource) {\r\n        return new JdbcTransactionManager(dataSource);\r\n    }\r\n\r\n    public static void main(String e []) throws Exception {\r\n        JobParameters jobParameters = new JobParametersBuilder().addLong(&quot;time&quot;, System.currentTimeMillis()).toJobParameters();\r\n\r\n        ApplicationContext context = new AnnotationConfigApplicationContext(LoadController.class);\r\n        JobLauncher jobLauncher = context.getBean(JobLauncher.class);\r\n\r\n        JobExecution jobExecution = jobLauncher.run(context.getBean(Job.class), jobParameters);\r\n        System.out.println(&quot;Job Exit Status : &quot; + jobExecution.getStatus());\r\n    }\r\n\r\n    @Bean\r\n    public Step step(JobRepository jobRepository, JdbcTransactionManager transactionManager) {\r\n        return new StepBuilder(&quot;step&quot;, jobRepository)\r\n                .&lt;Employee, Employee&gt;chunk(5, transactionManager)\r\n                .reader(itemReader())\r\n                .writer(itemWriter())\r\n                .processor(new CSVItemProcessor())\r\n                .build();\r\n    }\r\n\r\n    @Bean\r\n    public Job job(JobRepository jobRepository, JdbcTransactionManager transactionManager) {\r\n        return new JobBuilder(&quot;job&quot;)\r\n                .start(step(jobRepository, transactionManager))\r\n                .build();\r\n    }\r\n\r\n\r\n    @Bean\r\n    public FlatFileItemWriter&lt;Employee&gt; itemWriter() {\r\n        return new FlatFileItemWriterBuilder&lt;Employee&gt;()\r\n                .resource(new FileSystemResource(&quot;persons.csv&quot;))\r\n                .name(&quot;personItemWriter&quot;)\r\n                .delimited()\r\n                .names(&quot;id&quot;, &quot;name&quot;)\r\n                .build();\r\n    }\r\n\r\n\r\n\r\n}\r\n```\r\nthis is How I used datasource before spring batch 5 migration\r\n\r\n\r\n\r\n```\r\n@EnableBatchProcessing\r\n@Configuration\r\n@AutoConfigureAfter(JobRepo.class)\r\npublic class BatchConfiguration {\r\n\r\n    @Bean\r\n    public DefaultBatchConfiguration dataSource(@Qualifier(&quot;BatchConfig&quot;) DataSource dataSource) {\r\n        return new DefaultBatchConfigurer(dataSource);\r\n    }\r\n\r\n    //step\r\n\r\n   //job\r\n\r\n   ...\r\n\r\n\r\n\r\n}\r\n \r\n```\r\n \r\nJobRepo class is where I&#39;m loading the db USERNAME, PASSWORD....\r\n\r\n```\r\n@Configuration\r\n@ConfigurationProperties(prefix=&quot;spring.datasource&quot;)\r\npublic class JobRepo extends HikariConfig{\r\n\r\n  @Bean(&quot;BatchConfig&quot;)\r\n  public DataSource dataSource() throws SQLException{\r\n\r\n   return new HikariDataSource(this);\r\n  }\r\n\r\n}\r\n```\r\nthis is my job luncher class\r\n\r\n\r\n```\r\n@Configuration\r\npublic class BatchUtil{\r\n\r\n    @Autowired\r\n    @Qualifier(&quot;BatchConfig&quot;)\r\n    DataSource dataSource;\r\n  \r\n    private JobRepository getJobRep() throws Exception {\r\n      JobRepositoryFactoryBean factory = new JobRepositoryFactoryBean();\r\n      factory.setDataSource(dataSource);\r\n      factory.setTransactionManager(new ResourcelessTransactionManager());\r\n      factory.afterPropertiesSet();\r\n      return (JobRepository) factory.getObject();\r\n      }\r\n\r\n    @Bean(&quot;JobLauncher&quot;)\r\n    public SimpleJobLauncher simpleJobLauncher () throws Exception {\r\n      SimpleJobLauncher jobLauncher = new SimpleJobLauncher();\r\n      jobLauncher.setJobRepository(getJobRep());\r\n      jobLauncher.setTaskExecutor(asyncTaskExecutor());\r\n      return jobLauncher;\r\n    }\r\n\r\n}\r\n```\r\nApplication.property\r\n\r\n\r\n```\r\nspring.datasource.url=jdbc:oracle:thin:@localhost:1527:OR_DEV\r\nspring.datasource.username=USER12\r\nspring.datasource.password=txz$2Zhr\r\nspring.datasource.driver-class-name=oracle.jdbc.OracleDriver\r\nspring.batch.jdbc.initialize-schema=always\r\n```\r\n\r\n\r\n \r\n\r\nI tried to follow the spring batch 5 migration guide but it doesn&#39;t have an example. ","title":"PreparedStatementCallback; bad SQL grammar [INSERT INTO BATCH_JOB_EXECUTION_PARAMS(JOB_EXECUTION_ID, PARAMETER_NAME,","body":"<p>I'm working on migration Spring Batch 5. I'm using Jave 17 and Spring Boot 3. I didn't have any issue on step and job. However, In spring batch 5 DefaultBatchConfigurer is removed. setting datasource is different. I tried to use  Spring Batch 5 migiration guide but I'm getting PreparedStatementCallback; bad SQL grammar [INSERT INTO BATCH_JOB_EXECUTION_PARAMS(JOB_EXECUTION_ID, PARAMETER_NAME,... error.</p>\n<p>my Batchconf file is:</p>\n<pre><code>@Configuration\n@AutoConfigureAfter(JobRepo.class)\n@EnableBatchProcessing(dataSourceRef = &quot;batchDataSource&quot;, transactionManagerRef = &quot;batchTransactionManager&quot;)\npublic class BatchConfiguration {\n\n    @Autowired\n    @Qualifier(&quot;BatchConfig&quot;)\n    DataSource dataSource;\n    \n    @Bean\n    public DataSource batchDataSource() {\n        return dataSource;\n    }\n\n    @Bean\n    public JdbcTransactionManager batchTransactionManager(DataSource dataSource) {\n        return new JdbcTransactionManager(dataSource);\n    }\n\n    public static void main(String e []) throws Exception {\n        JobParameters jobParameters = new JobParametersBuilder().addLong(&quot;time&quot;, System.currentTimeMillis()).toJobParameters();\n\n        ApplicationContext context = new AnnotationConfigApplicationContext(LoadController.class);\n        JobLauncher jobLauncher = context.getBean(JobLauncher.class);\n\n        JobExecution jobExecution = jobLauncher.run(context.getBean(Job.class), jobParameters);\n        System.out.println(&quot;Job Exit Status : &quot; + jobExecution.getStatus());\n    }\n\n    @Bean\n    public Step step(JobRepository jobRepository, JdbcTransactionManager transactionManager) {\n        return new StepBuilder(&quot;step&quot;, jobRepository)\n                .&lt;Employee, Employee&gt;chunk(5, transactionManager)\n                .reader(itemReader())\n                .writer(itemWriter())\n                .processor(new CSVItemProcessor())\n                .build();\n    }\n\n    @Bean\n    public Job job(JobRepository jobRepository, JdbcTransactionManager transactionManager) {\n        return new JobBuilder(&quot;job&quot;)\n                .start(step(jobRepository, transactionManager))\n                .build();\n    }\n\n\n    @Bean\n    public FlatFileItemWriter&lt;Employee&gt; itemWriter() {\n        return new FlatFileItemWriterBuilder&lt;Employee&gt;()\n                .resource(new FileSystemResource(&quot;persons.csv&quot;))\n                .name(&quot;personItemWriter&quot;)\n                .delimited()\n                .names(&quot;id&quot;, &quot;name&quot;)\n                .build();\n    }\n\n\n\n}\n</code></pre>\n<p>this is How I used datasource before spring batch 5 migration</p>\n<pre><code>@EnableBatchProcessing\n@Configuration\n@AutoConfigureAfter(JobRepo.class)\npublic class BatchConfiguration {\n\n    @Bean\n    public DefaultBatchConfiguration dataSource(@Qualifier(&quot;BatchConfig&quot;) DataSource dataSource) {\n        return new DefaultBatchConfigurer(dataSource);\n    }\n\n    //step\n\n   //job\n\n   ...\n\n\n\n}\n \n</code></pre>\n<p>JobRepo class is where I'm loading the db USERNAME, PASSWORD....</p>\n<pre><code>@Configuration\n@ConfigurationProperties(prefix=&quot;spring.datasource&quot;)\npublic class JobRepo extends HikariConfig{\n\n  @Bean(&quot;BatchConfig&quot;)\n  public DataSource dataSource() throws SQLException{\n\n   return new HikariDataSource(this);\n  }\n\n}\n</code></pre>\n<p>this is my job luncher class</p>\n<pre><code>@Configuration\npublic class BatchUtil{\n\n    @Autowired\n    @Qualifier(&quot;BatchConfig&quot;)\n    DataSource dataSource;\n  \n    private JobRepository getJobRep() throws Exception {\n      JobRepositoryFactoryBean factory = new JobRepositoryFactoryBean();\n      factory.setDataSource(dataSource);\n      factory.setTransactionManager(new ResourcelessTransactionManager());\n      factory.afterPropertiesSet();\n      return (JobRepository) factory.getObject();\n      }\n\n    @Bean(&quot;JobLauncher&quot;)\n    public SimpleJobLauncher simpleJobLauncher () throws Exception {\n      SimpleJobLauncher jobLauncher = new SimpleJobLauncher();\n      jobLauncher.setJobRepository(getJobRep());\n      jobLauncher.setTaskExecutor(asyncTaskExecutor());\n      return jobLauncher;\n    }\n\n}\n</code></pre>\n<p>Application.property</p>\n<pre><code>spring.datasource.url=jdbc:oracle:thin:@localhost:1527:OR_DEV\nspring.datasource.username=USER12\nspring.datasource.password=txz$2Zhr\nspring.datasource.driver-class-name=oracle.jdbc.OracleDriver\nspring.batch.jdbc.initialize-schema=always\n</code></pre>\n<p>I tried to follow the spring batch 5 migration guide but it doesn't have an example.</p>\n"},{"tags":["java","spring","spring-boot","docker","maven"],"comments":[{"owner":{"account_id":9911696,"reputation":1656,"user_id":7338171,"accept_rate":17,"display_name":"Piyush Patel"},"score":0,"creation_date":1591295685,"post_id":62201502,"comment_id":110009922,"body_markdown":"You&#39;re not getting dependencies from Maven. Instead you&#39;ve them locally. Did you correctly mount those files in `lib` into docker.","body":"You&#39;re not getting dependencies from Maven. Instead you&#39;ve them locally. Did you correctly mount those files in <code>lib</code> into docker."},{"owner":{"account_id":112317,"reputation":93939,"user_id":296328,"accept_rate":60,"display_name":"khmarbaise"},"score":0,"creation_date":1591300207,"post_id":62201502,"comment_id":110012070,"body_markdown":"If this is really a spring boot app you should not try to use maven-jar-plugin yourself. Use the spring-boot-maven-plugin. Have you tested to start your spring-boot app without docker first to check if it&#39;s correctly starting up?","body":"If this is really a spring boot app you should not try to use maven-jar-plugin yourself. Use the spring-boot-maven-plugin. Have you tested to start your spring-boot app without docker first to check if it&#39;s correctly starting up?"},{"owner":{"account_id":8538081,"reputation":1031,"user_id":6399074,"display_name":"alan9uo"},"score":0,"creation_date":1615519096,"post_id":62201502,"comment_id":117721755,"body_markdown":"@khmarbaise I remove maven-jar-plugin, and I got no main manifest attribute, in /app.jar error when docker run . And I run the jar file local successfully.","body":"@khmarbaise I remove maven-jar-plugin, and I got no main manifest attribute, in /app.jar error when docker run . And I run the jar file local successfully."},{"owner":{"account_id":112317,"reputation":93939,"user_id":296328,"accept_rate":60,"display_name":"khmarbaise"},"score":0,"creation_date":1615536006,"post_id":62201502,"comment_id":117725914,"body_markdown":"What is this: `&lt;version&gt;${parent.version}&lt;/version&gt;` ? Yes because the manifest main entry is done by spring-boot-maven-plugin and there is s a bootstrap within Spring Boot jar file ... if you done correctly you can start the app via `java -jar xyz.jar` if not there is something missing/wrong... I can&#39;t see everything you configured so I can&#39;t say what exactly is wrong...","body":"What is this: <code>&lt;version&gt;${parent.version}&lt;&#47;version&gt;</code> ? Yes because the manifest main entry is done by spring-boot-maven-plugin and there is s a bootstrap within Spring Boot jar file ... if you done correctly you can start the app via <code>java -jar xyz.jar</code> if not there is something missing/wrong... I can&#39;t see everything you configured so I can&#39;t say what exactly is wrong..."},{"owner":{"account_id":3460362,"reputation":752,"user_id":2897683,"accept_rate":93,"display_name":"thahgr"},"score":1,"creation_date":1643360187,"post_id":62201502,"comment_id":125323743,"body_markdown":"@emuleumassi did you find what was the problem eventually ? I have a similar issue","body":"@emuleumassi did you find what was the problem eventually ? I have a similar issue"},{"owner":{"account_id":2990507,"reputation":4955,"user_id":2538180,"accept_rate":53,"display_name":"emoleumassi"},"score":0,"creation_date":1643442405,"post_id":62201502,"comment_id":125344687,"body_markdown":"@thahgr see my answer","body":"@thahgr see my answer"},{"owner":{"account_id":10517283,"reputation":998,"user_id":7750999,"display_name":"Caffeine Coder"},"score":0,"creation_date":1650123460,"post_id":62201502,"comment_id":127044528,"body_markdown":"The plugin config mentioned in the answer here would help- https://stackoverflow.com/questions/54867295/springboot-no-main-manifest-attribute-maven","body":"The plugin config mentioned in the answer here would help- <a href=\"https://stackoverflow.com/questions/54867295/springboot-no-main-manifest-attribute-maven\" title=\"springboot no main manifest attribute maven\">stackoverflow.com/questions/54867295/&hellip;</a>"}],"answers":[{"tags":[],"owner":{"account_id":1174873,"reputation":837,"user_id":1151108,"display_name":"ukasz Olszewski"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1591296569,"creation_date":1591296569,"answer_id":62202070,"question_id":62201502,"body_markdown":"add `maven-assembly-plugin` to your pom.xml\r\n\r\neg:\r\n   \r\n \r\n\r\n    &lt;plugin&gt;\r\n        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n        &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;\r\n        &lt;configuration&gt;\r\n            &lt;descriptorRefs&gt;\r\n                &lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;\r\n            &lt;/descriptorRefs&gt;\r\n        &lt;/configuration&gt;\r\n        &lt;executions&gt;\r\n            &lt;execution&gt;\r\n                &lt;id&gt;make-assembly&lt;/id&gt;\r\n                &lt;phase&gt;package&lt;/phase&gt;\r\n                &lt;goals&gt;\r\n                    &lt;goal&gt;single&lt;/goal&gt;\r\n                &lt;/goals&gt;\r\n            &lt;/execution&gt;\r\n        &lt;/executions&gt;\r\n    &lt;/plugin&gt;","title":"Spring boot docker Exception in thread &quot;main&quot; java.lang.NoClassDefFoundError: org/springframework/boot/SpringApplication","body":"<p>add <code>maven-assembly-plugin</code> to your pom.xml</p>\n\n<p>eg:</p>\n\n<pre><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n    &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;\n    &lt;configuration&gt;\n        &lt;descriptorRefs&gt;\n            &lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;\n        &lt;/descriptorRefs&gt;\n    &lt;/configuration&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;id&gt;make-assembly&lt;/id&gt;\n            &lt;phase&gt;package&lt;/phase&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;single&lt;/goal&gt;\n            &lt;/goals&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2990507,"reputation":4955,"user_id":2538180,"accept_rate":53,"display_name":"emoleumassi"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1643442375,"creation_date":1643442375,"answer_id":70903304,"question_id":62201502,"body_markdown":"with spring boot we can use `spring-boot-maven-plugin`\r\n```\r\n &lt;build&gt;\r\n        &lt;plugins&gt;\r\n            &lt;plugin&gt;\r\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n                &lt;executions&gt;\r\n                    &lt;execution&gt;\r\n                        &lt;id&gt;repackage&lt;/id&gt;\r\n                        &lt;goals&gt;\r\n                            &lt;goal&gt;repackage&lt;/goal&gt;\r\n                        &lt;/goals&gt;\r\n                        &lt;configuration&gt;\r\n                            &lt;classifier&gt;exec&lt;/classifier&gt;\r\n                        &lt;/configuration&gt;\r\n                    &lt;/execution&gt;\r\n                &lt;/executions&gt;\r\n            &lt;/plugin&gt;\r\n        &lt;/plugins&gt;\r\n    &lt;/build&gt;\r\n```","title":"Spring boot docker Exception in thread &quot;main&quot; java.lang.NoClassDefFoundError: org/springframework/boot/SpringApplication","body":"<p>with spring boot we can use <code>spring-boot-maven-plugin</code></p>\n<pre><code> &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;id&gt;repackage&lt;/id&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;repackage&lt;/goal&gt;\n                        &lt;/goals&gt;\n                        &lt;configuration&gt;\n                            &lt;classifier&gt;exec&lt;/classifier&gt;\n                        &lt;/configuration&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":13626539,"reputation":1469,"user_id":9829662,"display_name":"Mahdi Zareei"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695374206,"creation_date":1695374206,"answer_id":77156310,"question_id":62201502,"body_markdown":"check your project build gradle file if you have something like this:\r\n\r\n    application {\r\n       mainClass.set(&quot;MainKt&quot;)\r\n    }\r\n    \r\njust remove it and build your project again","title":"Spring boot docker Exception in thread &quot;main&quot; java.lang.NoClassDefFoundError: org/springframework/boot/SpringApplication","body":"<p>check your project build gradle file if you have something like this:</p>\n<pre><code>application {\n   mainClass.set(&quot;MainKt&quot;)\n}\n</code></pre>\n<p>just remove it and build your project again</p>\n"}],"owner":{"account_id":2990507,"reputation":4955,"user_id":2538180,"accept_rate":53,"display_name":"emoleumassi"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":4199,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":70903304,"answer_count":3,"score":1,"last_activity_date":1695374206,"creation_date":1591294562,"question_id":62201502,"body_markdown":"I want to start my spring-boot application in docker an i got an error in `docker run`\r\n\r\nMy Main-Class:\r\n```\r\n@SpringBootApplication\r\npublic class Application {\r\n\r\n    public static void main(String[] args) {\r\n        SpringApplication.run(Application.class, args);\r\n    }\r\n}\r\n```\r\n\r\nMy pom.xml:\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\r\n         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n\r\n    &lt;parent&gt;\r\n        &lt;groupId&gt;com.emo.test&lt;/groupId&gt;\r\n        &lt;artifactId&gt;test&lt;/artifactId&gt;\r\n        &lt;version&gt;0.1-SNAPSHOT&lt;/version&gt;\r\n    &lt;/parent&gt;\r\n\r\n    &lt;artifactId&gt;test-core&lt;/artifactId&gt;\r\n    &lt;version&gt;${parent.version}&lt;/version&gt;\r\n    &lt;packaging&gt;jar&lt;/packaging&gt;\r\n\r\n    &lt;name&gt;test-core&lt;/name&gt;\r\n    &lt;url&gt;http://maven.apache.org&lt;/url&gt;\r\n\r\n    &lt;dependencies&gt;\r\n        ....\r\n    &lt;/dependencies&gt;\r\n\r\n    &lt;build&gt;\r\n        &lt;plugins&gt;\r\n            &lt;plugin&gt;\r\n                &lt;!-- Build an executable JAR --&gt;\r\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n                &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;\r\n                &lt;configuration&gt;\r\n                    &lt;archive&gt;\r\n                        &lt;manifest&gt;\r\n                            &lt;addClasspath&gt;true&lt;/addClasspath&gt;\r\n                            &lt;classpathPrefix&gt;lib/&lt;/classpathPrefix&gt;\r\n                            &lt;mainClass&gt;com.test.Application&lt;/mainClass&gt;\r\n                        &lt;/manifest&gt;\r\n                    &lt;/archive&gt;\r\n                &lt;/configuration&gt;\r\n            &lt;/plugin&gt;\r\n        &lt;/plugins&gt;\r\n    &lt;/build&gt;\r\n&lt;/project&gt;\r\n```\r\nMy manifest:\r\n```\r\nManifest-Version: 1.0\r\nBuilt-By: emo.leumassi\r\nBuild-Jdk: 11.0.7\r\nMain-Class: com.test.Application\r\nCreated-By: Apache Maven\r\n```\r\n\r\nFor some reasons, i don&#39;t want to use the `spring-boot-maven-plugin`\r\n\r\nMy Dockerfile\r\n```\r\nFROM openjdk:8-jdk-alpine\r\nARG JAR_FILE=test-*.jar\r\nCOPY ${JAR_FILE} test.jar\r\nENTRYPOINT [&quot;java&quot;, &quot;-jar&quot;, &quot;test.jar&quot;]\r\n```\r\n\r\nI created the container with this script:\r\n```\r\ndocker build -t test .\r\n\r\ndocker run -p 8080:8080 test\r\n```\r\n\r\nI get this error:\r\n```\r\nSending build context to Docker daemon  18.94kB\r\nStep 1/4 : FROM openjdk:8-jdk-alpine\r\n ---&gt; a3562aa0b991\r\nStep 2/4 : ARG JAR_FILE=test-*.jar\r\n ---&gt; Running in 739ab5566b9f\r\nRemoving intermediate container 739ab5566b9f\r\n ---&gt; 9d2e5a894070\r\nStep 3/4 : COPY ${JAR_FILE} test.jar\r\n ---&gt; 2746354c80a5\r\nStep 4/4 : ENTRYPOINT [&quot;java&quot;, &quot;-jar&quot;, &quot;test.jar&quot;]\r\n ---&gt; Running in 9850a06d6686\r\nRemoving intermediate container 9850a06d6686\r\n ---&gt; e5ec33eac8a9\r\nSuccessfully built e5ec33eac8a9\r\nSuccessfully tagged kazi-core:latest\r\nException in thread &quot;main&quot; java.lang.NoClassDefFoundError: org/springframework/boot/SpringApplication\r\n        at com.test.Application.main(Application.java:10)\r\nCaused by: java.lang.ClassNotFoundException: org.springframework.boot.SpringApplication\r\n        at java.net.URLClassLoader.findClass(URLClassLoader.java:382)\r\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:424)\r\n        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:349)\r\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:357)\r\n        ... 1 more\r\n\r\n```","title":"Spring boot docker Exception in thread &quot;main&quot; java.lang.NoClassDefFoundError: org/springframework/boot/SpringApplication","body":"<p>I want to start my spring-boot application in docker an i got an error in <code>docker run</code></p>\n\n<p>My Main-Class:</p>\n\n<pre><code>@SpringBootApplication\npublic class Application {\n\n    public static void main(String[] args) {\n        SpringApplication.run(Application.class, args);\n    }\n}\n</code></pre>\n\n<p>My pom.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;parent&gt;\n        &lt;groupId&gt;com.emo.test&lt;/groupId&gt;\n        &lt;artifactId&gt;test&lt;/artifactId&gt;\n        &lt;version&gt;0.1-SNAPSHOT&lt;/version&gt;\n    &lt;/parent&gt;\n\n    &lt;artifactId&gt;test-core&lt;/artifactId&gt;\n    &lt;version&gt;${parent.version}&lt;/version&gt;\n    &lt;packaging&gt;jar&lt;/packaging&gt;\n\n    &lt;name&gt;test-core&lt;/name&gt;\n    &lt;url&gt;http://maven.apache.org&lt;/url&gt;\n\n    &lt;dependencies&gt;\n        ....\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;!-- Build an executable JAR --&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;\n                &lt;configuration&gt;\n                    &lt;archive&gt;\n                        &lt;manifest&gt;\n                            &lt;addClasspath&gt;true&lt;/addClasspath&gt;\n                            &lt;classpathPrefix&gt;lib/&lt;/classpathPrefix&gt;\n                            &lt;mainClass&gt;com.test.Application&lt;/mainClass&gt;\n                        &lt;/manifest&gt;\n                    &lt;/archive&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n&lt;/project&gt;\n</code></pre>\n\n<p>My manifest:</p>\n\n<pre><code>Manifest-Version: 1.0\nBuilt-By: emo.leumassi\nBuild-Jdk: 11.0.7\nMain-Class: com.test.Application\nCreated-By: Apache Maven\n</code></pre>\n\n<p>For some reasons, i don't want to use the <code>spring-boot-maven-plugin</code></p>\n\n<p>My Dockerfile</p>\n\n<pre><code>FROM openjdk:8-jdk-alpine\nARG JAR_FILE=test-*.jar\nCOPY ${JAR_FILE} test.jar\nENTRYPOINT [\"java\", \"-jar\", \"test.jar\"]\n</code></pre>\n\n<p>I created the container with this script:</p>\n\n<pre><code>docker build -t test .\n\ndocker run -p 8080:8080 test\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>Sending build context to Docker daemon  18.94kB\nStep 1/4 : FROM openjdk:8-jdk-alpine\n ---&gt; a3562aa0b991\nStep 2/4 : ARG JAR_FILE=test-*.jar\n ---&gt; Running in 739ab5566b9f\nRemoving intermediate container 739ab5566b9f\n ---&gt; 9d2e5a894070\nStep 3/4 : COPY ${JAR_FILE} test.jar\n ---&gt; 2746354c80a5\nStep 4/4 : ENTRYPOINT [\"java\", \"-jar\", \"test.jar\"]\n ---&gt; Running in 9850a06d6686\nRemoving intermediate container 9850a06d6686\n ---&gt; e5ec33eac8a9\nSuccessfully built e5ec33eac8a9\nSuccessfully tagged kazi-core:latest\nException in thread \"main\" java.lang.NoClassDefFoundError: org/springframework/boot/SpringApplication\n        at com.test.Application.main(Application.java:10)\nCaused by: java.lang.ClassNotFoundException: org.springframework.boot.SpringApplication\n        at java.net.URLClassLoader.findClass(URLClassLoader.java:382)\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:349)\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n        ... 1 more\n\n</code></pre>\n"},{"tags":["java","spring","jpa"],"comments":[{"owner":{"account_id":4470050,"reputation":68258,"user_id":3636601,"accept_rate":75,"display_name":"Jens"},"score":0,"creation_date":1695367036,"post_id":77155467,"comment_id":136017451,"body_markdown":"Maybe [this](https://stackoverflow.com/questions/29467886/implementing-crudrepository-in-spring-whats-the-best-design-i-should-follow) helps","body":"Maybe <a href=\"https://stackoverflow.com/questions/29467886/implementing-crudrepository-in-spring-whats-the-best-design-i-should-follow\">this</a> helps"}],"answers":[{"tags":[],"owner":{"account_id":8565752,"reputation":615,"user_id":6418277,"accept_rate":81,"display_name":"Gaetan L."},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695373853,"creation_date":1695373853,"answer_id":77156263,"question_id":77155467,"body_markdown":"Okay after a bit of research, for @Transational to work, the @Service/@Repository in which it is declared (at class or method-level) needs to implement an interface (in my case it implements CrudRepository&lt;Message, Long&gt;) and all its methods need to be declared in that interface (you cannot declare new methods). Then you autowire this interface instead of the custom class, in my case, instead of:\r\n\r\n    @Autowired\r\n    private MessageRepository messageRepository;\r\n\r\nI&#39;m doing:\r\n\r\n    @Autowired\r\n    private CrudRepository&lt;Message, Long&gt; messageRepository;\r\n\r\nThis is because of the way Spring uses proxies (I didn&#39;t understand the details tbh).","title":"Spring Transactional + EnableTransactionManagement = BeanNotOfRequiredTypeException","body":"<p>Okay after a bit of research, for @Transational to work, the @Service/@Repository in which it is declared (at class or method-level) needs to implement an interface (in my case it implements CrudRepository&lt;Message, Long&gt;) and all its methods need to be declared in that interface (you cannot declare new methods). Then you autowire this interface instead of the custom class, in my case, instead of:</p>\n<pre><code>@Autowired\nprivate MessageRepository messageRepository;\n</code></pre>\n<p>I'm doing:</p>\n<pre><code>@Autowired\nprivate CrudRepository&lt;Message, Long&gt; messageRepository;\n</code></pre>\n<p>This is because of the way Spring uses proxies (I didn't understand the details tbh).</p>\n"}],"owner":{"account_id":8565752,"reputation":615,"user_id":6418277,"accept_rate":81,"display_name":"Gaetan L."},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":54,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"answer_count":1,"score":-1,"last_activity_date":1695373853,"creation_date":1695366273,"question_id":77155467,"body_markdown":"I&#39;m currently trying to learn Spring that&#39;s why I&#39;m not using Spring Boot at the moment.\r\n\r\nI&#39;m trying to use the @Transactional annotation on one of my @Repository methods. I added EnableTransactionManagement in my Main class, but I get a BeanNotOfRequiredTypeException error when I run my app. If I remove either @Transactional or @EnableTransactionManagement, the app runs fine (but the function doesn&#39;t work as there&#39;s no commit).\r\n\r\nHere is the error I get:\r\n\r\n    Caused by: org.springframework.beans.factory.BeanNotOfRequiredTypeException: Bean named &#39;messageRepository&#39; is expected to be of type &#39;com.cypherf.repository.MessageRepository&#39; but was actually of type &#39;jdk.proxy2.$Proxy25&#39;\r\n\r\nCan someone explain to me how this works?\r\n\r\nMain class\r\n\r\n    package com.cypherf;\r\n    import com.cypherf.model.Message;\r\n    import com.cypherf.repository.MessageRepository;\r\n    import com.cypherf.service.MessageService;\r\n    import org.slf4j.Logger;\r\n    import org.slf4j.LoggerFactory;\r\n    import org.springframework.beans.factory.annotation.Autowired;\r\n    import org.springframework.context.ApplicationContext;\r\n    import org.springframework.context.annotation.AnnotationConfigApplicationContext;\r\n    import org.springframework.context.annotation.ComponentScan;\r\n    import org.springframework.context.annotation.Configuration;\r\n    import org.springframework.transaction.annotation.EnableTransactionManagement;\r\n\r\n    @Configuration\r\n    @ComponentScan\r\n    @EnableTransactionManagement\r\n    public class TestSpringApplication {\r\n        @Autowired\r\n        private ApplicationContext context;\r\n\r\n        @Autowired\r\n        private MessageRepository messageRepository;\r\n\r\n        @Autowired\r\n        private MessageService messageService;\r\n\r\n        final static Logger logger = LoggerFactory.getLogger(TestSpringApplication.class);\r\n\r\n        public static void main(String[] args) {\r\n            ApplicationContext ctx = new AnnotationConfigApplicationContext(TestSpringApplication.class);\r\n            TestSpringApplication app = ctx.getBean(TestSpringApplication.class);\r\n            logger.info(&quot;Running app...&quot;);\r\n            app.run(args);\r\n            //TestSpringApplication app = context.getBean(TestSpringApplication.class);\r\n            //TestSpringApplication app = new TestSpringApplication();\r\n            //app.run(args);\r\n\r\n        }\r\n\r\n        public void run(String... args) {\r\n            messageRepository.mrSave(new Message(&quot;Message one&quot;));\r\n            messageRepository.mrSave(new Message(&quot;Message two&quot;));\r\n            messageService.printAllMessages();\r\n\r\n            messageRepository.mrSaveTransactional(new Message(&quot;Message two&quot;));\r\n            messageService.printAllMessages();\r\n\r\n    //        System.out.println(&quot;BEANS:&quot;);\r\n    //        List&lt;String&gt; beans = Arrays.asList(context.getBeanDefinitionNames());\r\n    //        beans.forEach(bean -&gt; System.out.println(bean));\r\n        }\r\n    }\r\n\r\nMessageRepository\r\n\r\n    package com.cypherf.repository;\r\n    import com.cypherf.model.Message;\r\n    import java.util.List;\r\n    import java.util.Optional;\r\n\r\n    import com.cypherf.service.MessageService;\r\n    import jakarta.persistence.EntityManager;\r\n    import jakarta.persistence.PersistenceException;\r\n    import jakarta.transaction.Transactional;\r\n    import org.slf4j.Logger;\r\n    import org.slf4j.LoggerFactory;\r\n    import org.springframework.beans.factory.annotation.Autowired;\r\n    import org.springframework.data.repository.CrudRepository;\r\n    import org.springframework.stereotype.Repository;\r\n\r\n    @Repository\r\n    public class MessageRepository implements CrudRepository&lt;Message, Long&gt; {\r\n        @Autowired\r\n        PersistenceUtil pu;\r\n\r\n        final static Logger logger = LoggerFactory.getLogger(MessageRepository.class);\r\n\r\n        public void mrSave(Message message) {\r\n            EntityManager em = pu.getEntityManager();\r\n            try {\r\n                em.getTransaction().begin();\r\n                em.persist(message);\r\n                em.getTransaction().commit();\r\n                System.out.println(&quot;here&quot;);\r\n            }\r\n            catch (PersistenceException e) {\r\n                System.err.printf(&quot;%s already exists%n&quot;, message);\r\n                e.printStackTrace();\r\n            }\r\n            finally {\r\n                System.out.println();\r\n                em.close();\r\n            }\r\n        }\r\n\r\n        @Transactional\r\n        public void mrSaveTransactional(Message message) {\r\n            logger.info(&quot;MessageRepository.mrSaveTransactional()&quot;);\r\n            pu.getEntityManager().persist(message);\r\n        }\r\n\r\n        public List&lt;Message&gt; getAll() {\r\n            EntityManager em = pu.getEntityManager();\r\n            List&lt;Message&gt; messages = em.createQuery(&quot;from Message&quot;, Message.class).getResultList();\r\n            em.close();\r\n            return messages;\r\n        }\r\n\r\n        [...]\r\n    }\r\n\r\nhibernate.cfg.xml\r\n\r\n```xml\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;!DOCTYPE hibernate-configuration PUBLIC &quot;-//Hibernate/Hibernate Configuration DTD 3.0//EN&quot; &quot;http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd&quot;&gt;\r\n\r\n&lt;hibernate-configuration&gt;\r\n    &lt;session-factory&gt;\r\n        &lt;property name=&quot;show_sql&quot;&gt;true&lt;/property&gt;\r\n        &lt;property name=&quot;format_sql&quot;&gt;true&lt;/property&gt;\r\n        &lt;property name=&quot;dialect&quot;&gt;org.hibernate.community.dialect.H2LegacyDialect&lt;/property&gt;\r\n        &lt;property name=&quot;connection.driver_class&quot;&gt;org.h2.Driver&lt;/property&gt;\r\n        &lt;property name=&quot;connection.url&quot;&gt;jdbc:h2:./spring&lt;/property&gt;\r\n        &lt;property name=&quot;connection.username&quot;&gt;sa&lt;/property&gt;\r\n        &lt;property name=&quot;connection.password&quot;&gt;&lt;/property&gt;\r\n        &lt;property name=&quot;hibernate.hbm2ddl.auto&quot;&gt;create-drop&lt;/property&gt;\r\n        &lt;property name=&quot;hibernate.show_sql&quot;&gt;true&lt;/property&gt;\r\n        &lt;mapping class=&quot;com.cypherf.model.Message&quot;/&gt;\r\n    &lt;/session-factory&gt;\r\n&lt;/hibernate-configuration&gt;\r\n```","title":"Spring Transactional + EnableTransactionManagement = BeanNotOfRequiredTypeException","body":"<p>I'm currently trying to learn Spring that's why I'm not using Spring Boot at the moment.</p>\n<p>I'm trying to use the @Transactional annotation on one of my @Repository methods. I added EnableTransactionManagement in my Main class, but I get a BeanNotOfRequiredTypeException error when I run my app. If I remove either @Transactional or @EnableTransactionManagement, the app runs fine (but the function doesn't work as there's no commit).</p>\n<p>Here is the error I get:</p>\n<pre><code>Caused by: org.springframework.beans.factory.BeanNotOfRequiredTypeException: Bean named 'messageRepository' is expected to be of type 'com.cypherf.repository.MessageRepository' but was actually of type 'jdk.proxy2.$Proxy25'\n</code></pre>\n<p>Can someone explain to me how this works?</p>\n<p>Main class</p>\n<pre><code>package com.cypherf;\nimport com.cypherf.model.Message;\nimport com.cypherf.repository.MessageRepository;\nimport com.cypherf.service.MessageService;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.context.ApplicationContext;\nimport org.springframework.context.annotation.AnnotationConfigApplicationContext;\nimport org.springframework.context.annotation.ComponentScan;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.transaction.annotation.EnableTransactionManagement;\n\n@Configuration\n@ComponentScan\n@EnableTransactionManagement\npublic class TestSpringApplication {\n    @Autowired\n    private ApplicationContext context;\n\n    @Autowired\n    private MessageRepository messageRepository;\n\n    @Autowired\n    private MessageService messageService;\n\n    final static Logger logger = LoggerFactory.getLogger(TestSpringApplication.class);\n\n    public static void main(String[] args) {\n        ApplicationContext ctx = new AnnotationConfigApplicationContext(TestSpringApplication.class);\n        TestSpringApplication app = ctx.getBean(TestSpringApplication.class);\n        logger.info(&quot;Running app...&quot;);\n        app.run(args);\n        //TestSpringApplication app = context.getBean(TestSpringApplication.class);\n        //TestSpringApplication app = new TestSpringApplication();\n        //app.run(args);\n\n    }\n\n    public void run(String... args) {\n        messageRepository.mrSave(new Message(&quot;Message one&quot;));\n        messageRepository.mrSave(new Message(&quot;Message two&quot;));\n        messageService.printAllMessages();\n\n        messageRepository.mrSaveTransactional(new Message(&quot;Message two&quot;));\n        messageService.printAllMessages();\n\n//        System.out.println(&quot;BEANS:&quot;);\n//        List&lt;String&gt; beans = Arrays.asList(context.getBeanDefinitionNames());\n//        beans.forEach(bean -&gt; System.out.println(bean));\n    }\n}\n</code></pre>\n<p>MessageRepository</p>\n<pre><code>package com.cypherf.repository;\nimport com.cypherf.model.Message;\nimport java.util.List;\nimport java.util.Optional;\n\nimport com.cypherf.service.MessageService;\nimport jakarta.persistence.EntityManager;\nimport jakarta.persistence.PersistenceException;\nimport jakarta.transaction.Transactional;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.data.repository.CrudRepository;\nimport org.springframework.stereotype.Repository;\n\n@Repository\npublic class MessageRepository implements CrudRepository&lt;Message, Long&gt; {\n    @Autowired\n    PersistenceUtil pu;\n\n    final static Logger logger = LoggerFactory.getLogger(MessageRepository.class);\n\n    public void mrSave(Message message) {\n        EntityManager em = pu.getEntityManager();\n        try {\n            em.getTransaction().begin();\n            em.persist(message);\n            em.getTransaction().commit();\n            System.out.println(&quot;here&quot;);\n        }\n        catch (PersistenceException e) {\n            System.err.printf(&quot;%s already exists%n&quot;, message);\n            e.printStackTrace();\n        }\n        finally {\n            System.out.println();\n            em.close();\n        }\n    }\n\n    @Transactional\n    public void mrSaveTransactional(Message message) {\n        logger.info(&quot;MessageRepository.mrSaveTransactional()&quot;);\n        pu.getEntityManager().persist(message);\n    }\n\n    public List&lt;Message&gt; getAll() {\n        EntityManager em = pu.getEntityManager();\n        List&lt;Message&gt; messages = em.createQuery(&quot;from Message&quot;, Message.class).getResultList();\n        em.close();\n        return messages;\n    }\n\n    [...]\n}\n</code></pre>\n<p>hibernate.cfg.xml</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC &quot;-//Hibernate/Hibernate Configuration DTD 3.0//EN&quot; &quot;http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd&quot;&gt;\n\n&lt;hibernate-configuration&gt;\n    &lt;session-factory&gt;\n        &lt;property name=&quot;show_sql&quot;&gt;true&lt;/property&gt;\n        &lt;property name=&quot;format_sql&quot;&gt;true&lt;/property&gt;\n        &lt;property name=&quot;dialect&quot;&gt;org.hibernate.community.dialect.H2LegacyDialect&lt;/property&gt;\n        &lt;property name=&quot;connection.driver_class&quot;&gt;org.h2.Driver&lt;/property&gt;\n        &lt;property name=&quot;connection.url&quot;&gt;jdbc:h2:./spring&lt;/property&gt;\n        &lt;property name=&quot;connection.username&quot;&gt;sa&lt;/property&gt;\n        &lt;property name=&quot;connection.password&quot;&gt;&lt;/property&gt;\n        &lt;property name=&quot;hibernate.hbm2ddl.auto&quot;&gt;create-drop&lt;/property&gt;\n        &lt;property name=&quot;hibernate.show_sql&quot;&gt;true&lt;/property&gt;\n        &lt;mapping class=&quot;com.cypherf.model.Message&quot;/&gt;\n    &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n"},{"tags":["java","java.util.scanner","calculation"],"comments":[{"owner":{"account_id":5404,"reputation":22089,"user_id":8681,"accept_rate":67,"display_name":"Jorn"},"score":0,"creation_date":1695372618,"post_id":77156103,"comment_id":136018444,"body_markdown":"`num1.close();` will close `System.in`. After that, you cannot read from it any more, which causes that error.","body":"<code>num1.close();</code> will close <code>System.in</code>. After that, you cannot read from it any more, which causes that error."}],"answers":[{"tags":[],"owner":{"account_id":1868353,"reputation":9514,"user_id":1691311,"accept_rate":100,"display_name":"Randy"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1695372699,"creation_date":1695372699,"answer_id":77156118,"question_id":77156103,"body_markdown":"The error you are experiencing is due to the way you are using the Scanner object and subsequently closing it. When you close the Scanner object that is attached to `System.in`, you are essentially closing the underlying input stream (`System.in`). Once you close that stream, you can&#39;t read from it again using another Scanner or any other method.\r\n\r\nTo fix this, you should use a single Scanner object for all your input, and avoid closing it until your program is completely done with user input.\r\n\r\nI created an example using an online Java compiler, test it here:\r\nhttp://tpcg.io/_WXXH4N\r\n\r\nRevised code with a working scanner:\r\n\r\n```\r\nimport java.util.Scanner;\r\n\r\npublic class Java_Calculator {\r\n    private static final Scanner scanner = new Scanner(System.in); // Single scanner object for the entire program\r\n\r\n    public static void main(String[] args) {\r\n        mainMenu();\r\n    }\r\n\r\n    static void mainMenu() {\r\n        System.out.println(&quot;Welcome to Java Calculator!!&quot;);\r\n        System.out.println(&quot;By-theclassicalguy&quot;);\r\n        System.out.println(&quot;&lt;------------------------------------------------------&gt;&quot;);\r\n        System.out.println(&quot;1. Perform a Calculation&quot;);\r\n        System.out.println(&quot;2. Exit&quot;);\r\n        System.out.print(&quot;Enter your choice (1/2): &quot;);\r\n\r\n        int user_choice = scanner.nextInt();\r\n        if (user_choice == 1) {\r\n            calculation();\r\n        } else {\r\n            System.out.println(&quot;Thank you for using this program&quot;);\r\n        }\r\n    }\r\n\r\n    static void calculation() {\r\n        System.out.println(&quot;1. Add&quot;);\r\n        System.out.println(&quot;2. Subtract&quot;);\r\n        System.out.println(&quot;3. Multiply&quot;);\r\n        System.out.println(&quot;4. Divide&quot;);\r\n        System.out.print(&quot;Enter your choice (1/2/3/4): &quot;);\r\n\r\n        int choice = scanner.nextInt();\r\n        switch (choice) {\r\n            case 1:\r\n                add();\r\n                break;\r\n            case 2:\r\n                sub();\r\n                break;\r\n            case 3:\r\n                mult();\r\n                break;\r\n            case 4:\r\n                div();\r\n                break;\r\n            default:\r\n                System.out.println(&quot;Invalid choice&quot;);\r\n        }\r\n    }\r\n\r\n    static double readNumber(String prompt) {\r\n        System.out.print(prompt);\r\n        return scanner.nextDouble();\r\n    }\r\n\r\n    static void add() {\r\n        double a = readNumber(&quot;Enter a number: &quot;);\r\n        double b = readNumber(&quot;Enter a second number: &quot;);\r\n        System.out.println(&quot;The sum is &quot; + (a + b));\r\n    }\r\n\r\n    static void sub() {\r\n        double a = readNumber(&quot;Enter a number: &quot;);\r\n        double b = readNumber(&quot;Enter a second number: &quot;);\r\n        System.out.println(&quot;The difference is &quot; + (a - b));\r\n    }\r\n\r\n    static void mult() {\r\n        double a = readNumber(&quot;Enter a number: &quot;);\r\n        double b = readNumber(&quot;Enter a second number: &quot;);\r\n        System.out.println(&quot;The product is &quot; + (a * b));\r\n    }\r\n\r\n    static void div() {\r\n        double a = readNumber(&quot;Enter numerator: &quot;);\r\n        double b;\r\n        do {\r\n            b = readNumber(&quot;Enter a denominator: &quot;);\r\n            if (b == 0) {\r\n                System.out.println(&quot;Denominator cannot be zero. Please enter again.&quot;);\r\n            }\r\n        } while (b == 0);\r\n        System.out.println(&quot;The result is &quot; + (a / b));\r\n    }\r\n}\r\n```","title":"i keep getting into this error while running this java code","body":"<p>The error you are experiencing is due to the way you are using the Scanner object and subsequently closing it. When you close the Scanner object that is attached to <code>System.in</code>, you are essentially closing the underlying input stream (<code>System.in</code>). Once you close that stream, you can't read from it again using another Scanner or any other method.</p>\n<p>To fix this, you should use a single Scanner object for all your input, and avoid closing it until your program is completely done with user input.</p>\n<p>I created an example using an online Java compiler, test it here:\n<a href=\"http://tpcg.io/_WXXH4N\" rel=\"nofollow noreferrer\">http://tpcg.io/_WXXH4N</a></p>\n<p>Revised code with a working scanner:</p>\n<pre><code>import java.util.Scanner;\n\npublic class Java_Calculator {\n    private static final Scanner scanner = new Scanner(System.in); // Single scanner object for the entire program\n\n    public static void main(String[] args) {\n        mainMenu();\n    }\n\n    static void mainMenu() {\n        System.out.println(&quot;Welcome to Java Calculator!!&quot;);\n        System.out.println(&quot;By-theclassicalguy&quot;);\n        System.out.println(&quot;&lt;------------------------------------------------------&gt;&quot;);\n        System.out.println(&quot;1. Perform a Calculation&quot;);\n        System.out.println(&quot;2. Exit&quot;);\n        System.out.print(&quot;Enter your choice (1/2): &quot;);\n\n        int user_choice = scanner.nextInt();\n        if (user_choice == 1) {\n            calculation();\n        } else {\n            System.out.println(&quot;Thank you for using this program&quot;);\n        }\n    }\n\n    static void calculation() {\n        System.out.println(&quot;1. Add&quot;);\n        System.out.println(&quot;2. Subtract&quot;);\n        System.out.println(&quot;3. Multiply&quot;);\n        System.out.println(&quot;4. Divide&quot;);\n        System.out.print(&quot;Enter your choice (1/2/3/4): &quot;);\n\n        int choice = scanner.nextInt();\n        switch (choice) {\n            case 1:\n                add();\n                break;\n            case 2:\n                sub();\n                break;\n            case 3:\n                mult();\n                break;\n            case 4:\n                div();\n                break;\n            default:\n                System.out.println(&quot;Invalid choice&quot;);\n        }\n    }\n\n    static double readNumber(String prompt) {\n        System.out.print(prompt);\n        return scanner.nextDouble();\n    }\n\n    static void add() {\n        double a = readNumber(&quot;Enter a number: &quot;);\n        double b = readNumber(&quot;Enter a second number: &quot;);\n        System.out.println(&quot;The sum is &quot; + (a + b));\n    }\n\n    static void sub() {\n        double a = readNumber(&quot;Enter a number: &quot;);\n        double b = readNumber(&quot;Enter a second number: &quot;);\n        System.out.println(&quot;The difference is &quot; + (a - b));\n    }\n\n    static void mult() {\n        double a = readNumber(&quot;Enter a number: &quot;);\n        double b = readNumber(&quot;Enter a second number: &quot;);\n        System.out.println(&quot;The product is &quot; + (a * b));\n    }\n\n    static void div() {\n        double a = readNumber(&quot;Enter numerator: &quot;);\n        double b;\n        do {\n            b = readNumber(&quot;Enter a denominator: &quot;);\n            if (b == 0) {\n                System.out.println(&quot;Denominator cannot be zero. Please enter again.&quot;);\n            }\n        } while (b == 0);\n        System.out.println(&quot;The result is &quot; + (a / b));\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":29371858,"reputation":3,"user_id":22504292,"display_name":"Aaron Thomas Cherian"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":55,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1695384286,"accepted_answer_id":77156118,"answer_count":1,"score":0,"last_activity_date":1695373289,"creation_date":1695372549,"question_id":77156103,"body_markdown":"Im trying to make a calculator program which can do addition, subtraction, multiplication and division, but i keep getting this error after the main method is executed\r\n\r\n```\r\n\r\nException in thread &quot;main&quot; java.util.NoSuchElementException\r\n        at java.base/java.util.Scanner.throwFor(Scanner.java:937)\r\n        at java.base/java.util.Scanner.next(Scanner.java:1594)\r\n        at java.base/java.util.Scanner.nextInt(Scanner.java:2258)\r\n        at java.base/java.util.Scanner.nextInt(Scanner.java:2212)\r\n        at Java_Calculator.calculation(Java_Calculator.java:36)\r\n        at Java_Calculator.main(Java_Calculator.java:19)\r\n        at Java_Calculator.main(Java_Calculator.java:5)\r\n\r\n```\r\n\r\nHere is my code for reference. \r\n\r\n\r\n```\r\nimport java.util.Scanner;\r\n\r\npublic class Java_Calculator{\r\n    public static void main(String[] args) {\r\n        main();\r\n        \r\n    }\r\n    static void main(){\r\n        System.out.println(&quot;Welcome to Java Calculator!!&quot;);\r\n        System.out.println(&quot;By-theclassicalguy&quot;);\r\n        System.out.println(&quot;&lt;------------------------------------------------------&gt;&quot;);\r\n        System.out.println(&quot;1. Perform a Calculation&quot;);\r\n        System.out.println(&quot;2. Exit&quot;);\r\n        System.out.println(&quot;Enter your choice (1/2):&quot;);\r\n        Scanner input= new Scanner(System.in);\r\n        int user_choice=input.nextInt();\r\n        input.close();\r\n        if (user_choice==1){\r\n            calculation();\r\n\r\n        }else{\r\n            System.out.println(&quot;Thank you for using this program&quot;);\r\n\r\n        }\r\n\r\n    }\r\n\r\n    static void calculation(){\r\n        System.out.println(&quot;1. Add&quot;);\r\n        System.out.println(&quot;2. Subtract&quot;);\r\n        System.out.println(&quot;3. Multiply&quot;);\r\n        System.out.println(&quot;4. Divide&quot;);\r\n        Scanner calc_choice=new Scanner(System.in);\r\n        System.out.println(&quot;Enter your choice (1/2/3/4):&quot;);\r\n        \r\n        int choice=calc_choice.nextInt();\r\n        calc_choice.close();\r\n        if (choice==1){\r\n            add();\r\n        } else if(choice==2){\r\n            sub();\r\n\r\n        }else if(choice==3){\r\n            mult();\r\n            \r\n        }else if(choice==4){\r\n            div();\r\n            \r\n        }\r\n\r\n\r\n    }\r\n\r\n    static void add(){\r\n        Scanner num1= new Scanner(System.in);\r\n        System.out.println(&quot;Enter a number:&quot;);\r\n        double a=num1.nextDouble();\r\n        num1.close();\r\n        Scanner num2= new Scanner(System.in);\r\n        System.out.println(&quot;Enter a second number&quot;);\r\n        double b=num2.nextDouble();\r\n        num2.close();\r\n        double add=a+b;\r\n        System.out.println(&quot;The sum is &quot;+add);\r\n        \r\n    }\r\n\r\n    static void sub(){\r\n        Scanner num1= new Scanner(System.in);\r\n        System.out.println(&quot;Enter a number:&quot;);\r\n        double a=num1.nextDouble();\r\n        num1.close();\r\n        Scanner num2= new Scanner(System.in);\r\n        System.out.println(&quot;Enter a seconf number:&quot;);\r\n        double b=num2.nextDouble();\r\n        num2.close();\r\n        double sub=a-b;\r\n        System.out.println(&quot;The difference is &quot;+sub);\r\n    }\r\n    static void mult(){\r\n        Scanner num1= new Scanner(System.in);\r\n        System.out.println(&quot;Enter a number:&quot;);\r\n        double a=num1.nextDouble();\r\n        num1.close();\r\n        Scanner num2= new Scanner(System.in);\r\n        System.out.println(&quot;Enter a second number:&quot;);\r\n        double b=num2.nextDouble();\r\n        num2.close();\r\n        double mult=a*b;\r\n        System.out.println(&quot;The sum is &quot;+mult);\r\n    }\r\n    static void div(){\r\n        Scanner num1= new Scanner(System.in);\r\n        System.out.println(&quot;Enter numerator:&quot;);\r\n        double a=num1.nextDouble();\r\n        num1.close();\r\n        Scanner num2= new Scanner(System.in);\r\n        System.out.println(&quot;Enter a denominator&quot;);\r\n        double b=num2.nextDouble();\r\n        num2.close();\r\n        double div=a/b;\r\n        System.out.println(&quot;The sum is &quot;+div);\r\n    }\r\n\r\n    \r\n\r\n\r\n\r\n}\r\n```\r\n\r\n\r\nBasically, what i wanted to do was to create multiple methods each with its particular function like addition, subtraction etc. and these functions will be linked to another calculations method which is again linked to another method called main. in each method ive added a scanner class to collect the numbers from the user. but i keep getting the error mention above,when i run the program, the main method runs properly then when i type 1 to proceed to the calculations method, which also prints what is required but after that  instead of the scanner class working and asking me to answer, it prints the error and exits from the program.","title":"i keep getting into this error while running this java code","body":"<p>Im trying to make a calculator program which can do addition, subtraction, multiplication and division, but i keep getting this error after the main method is executed</p>\n<pre><code>\nException in thread &quot;main&quot; java.util.NoSuchElementException\n        at java.base/java.util.Scanner.throwFor(Scanner.java:937)\n        at java.base/java.util.Scanner.next(Scanner.java:1594)\n        at java.base/java.util.Scanner.nextInt(Scanner.java:2258)\n        at java.base/java.util.Scanner.nextInt(Scanner.java:2212)\n        at Java_Calculator.calculation(Java_Calculator.java:36)\n        at Java_Calculator.main(Java_Calculator.java:19)\n        at Java_Calculator.main(Java_Calculator.java:5)\n\n</code></pre>\n<p>Here is my code for reference.</p>\n<pre><code>import java.util.Scanner;\n\npublic class Java_Calculator{\n    public static void main(String[] args) {\n        main();\n        \n    }\n    static void main(){\n        System.out.println(&quot;Welcome to Java Calculator!!&quot;);\n        System.out.println(&quot;By-theclassicalguy&quot;);\n        System.out.println(&quot;&lt;------------------------------------------------------&gt;&quot;);\n        System.out.println(&quot;1. Perform a Calculation&quot;);\n        System.out.println(&quot;2. Exit&quot;);\n        System.out.println(&quot;Enter your choice (1/2):&quot;);\n        Scanner input= new Scanner(System.in);\n        int user_choice=input.nextInt();\n        input.close();\n        if (user_choice==1){\n            calculation();\n\n        }else{\n            System.out.println(&quot;Thank you for using this program&quot;);\n\n        }\n\n    }\n\n    static void calculation(){\n        System.out.println(&quot;1. Add&quot;);\n        System.out.println(&quot;2. Subtract&quot;);\n        System.out.println(&quot;3. Multiply&quot;);\n        System.out.println(&quot;4. Divide&quot;);\n        Scanner calc_choice=new Scanner(System.in);\n        System.out.println(&quot;Enter your choice (1/2/3/4):&quot;);\n        \n        int choice=calc_choice.nextInt();\n        calc_choice.close();\n        if (choice==1){\n            add();\n        } else if(choice==2){\n            sub();\n\n        }else if(choice==3){\n            mult();\n            \n        }else if(choice==4){\n            div();\n            \n        }\n\n\n    }\n\n    static void add(){\n        Scanner num1= new Scanner(System.in);\n        System.out.println(&quot;Enter a number:&quot;);\n        double a=num1.nextDouble();\n        num1.close();\n        Scanner num2= new Scanner(System.in);\n        System.out.println(&quot;Enter a second number&quot;);\n        double b=num2.nextDouble();\n        num2.close();\n        double add=a+b;\n        System.out.println(&quot;The sum is &quot;+add);\n        \n    }\n\n    static void sub(){\n        Scanner num1= new Scanner(System.in);\n        System.out.println(&quot;Enter a number:&quot;);\n        double a=num1.nextDouble();\n        num1.close();\n        Scanner num2= new Scanner(System.in);\n        System.out.println(&quot;Enter a seconf number:&quot;);\n        double b=num2.nextDouble();\n        num2.close();\n        double sub=a-b;\n        System.out.println(&quot;The difference is &quot;+sub);\n    }\n    static void mult(){\n        Scanner num1= new Scanner(System.in);\n        System.out.println(&quot;Enter a number:&quot;);\n        double a=num1.nextDouble();\n        num1.close();\n        Scanner num2= new Scanner(System.in);\n        System.out.println(&quot;Enter a second number:&quot;);\n        double b=num2.nextDouble();\n        num2.close();\n        double mult=a*b;\n        System.out.println(&quot;The sum is &quot;+mult);\n    }\n    static void div(){\n        Scanner num1= new Scanner(System.in);\n        System.out.println(&quot;Enter numerator:&quot;);\n        double a=num1.nextDouble();\n        num1.close();\n        Scanner num2= new Scanner(System.in);\n        System.out.println(&quot;Enter a denominator&quot;);\n        double b=num2.nextDouble();\n        num2.close();\n        double div=a/b;\n        System.out.println(&quot;The sum is &quot;+div);\n    }\n\n    \n\n\n\n}\n</code></pre>\n<p>Basically, what i wanted to do was to create multiple methods each with its particular function like addition, subtraction etc. and these functions will be linked to another calculations method which is again linked to another method called main. in each method ive added a scanner class to collect the numbers from the user. but i keep getting the error mention above,when i run the program, the main method runs properly then when i type 1 to proceed to the calculations method, which also prints what is required but after that  instead of the scanner class working and asking me to answer, it prints the error and exits from the program.</p>\n"},{"tags":["java","android","android-studio","gradle"],"answers":[{"tags":[],"owner":{"account_id":24273987,"reputation":21,"user_id":18221553,"display_name":"Ash Anand"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1645003122,"creation_date":1645003122,"answer_id":71139070,"question_id":70340427,"body_markdown":"Generally, when you install android studio it will install the latest SDK and latest build tool version which is not compatible with the existing projects.\r\n\r\nAccording to the [build.gradle][1] present in [00-Evan/shattered-pixel-dungeon][2]\r\n\r\nYou should try installing the SDK version 30. And the SDK build tool version: 30.0.X. \r\nIt should work.\r\n\r\nFor me, it is working with SDK version 30 and build tool version 30.0.3.\r\n\r\nAnd just make sure you have java version 8 as mentioned in build.gradle.\r\n\r\n\r\n  [1]: https://github.com/00-Evan/shattered-pixel-dungeon/blob/master/build.gradle\r\n  [2]: https://github.com/00-Evan/shattered-pixel-dungeon","title":"&quot;Unable to find method &#39;&#39;void org.apache.commons.compress.archivers.zip.ZipFile.&lt;init&gt;(java.nio.channels.SeekableByteChannel)&#39;&#39;&quot;","body":"<p>Generally, when you install android studio it will install the latest SDK and latest build tool version which is not compatible with the existing projects.</p>\n<p>According to the <a href=\"https://github.com/00-Evan/shattered-pixel-dungeon/blob/master/build.gradle\" rel=\"nofollow noreferrer\">build.gradle</a> present in <a href=\"https://github.com/00-Evan/shattered-pixel-dungeon\" rel=\"nofollow noreferrer\">00-Evan/shattered-pixel-dungeon</a></p>\n<p>You should try installing the SDK version 30. And the SDK build tool version: 30.0.X.\nIt should work.</p>\n<p>For me, it is working with SDK version 30 and build tool version 30.0.3.</p>\n<p>And just make sure you have java version 8 as mentioned in build.gradle.</p>\n"},{"tags":[],"owner":{"account_id":5035124,"reputation":113,"user_id":4044175,"display_name":"Gonza"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1647959327,"creation_date":1647959327,"answer_id":71573797,"question_id":70340427,"body_markdown":"Try to install `Android 11.0 (R)` or `Android 12.00 (S)` on the SDK Platform tab on the Android SDK. That fixed the issue for me ","title":"&quot;Unable to find method &#39;&#39;void org.apache.commons.compress.archivers.zip.ZipFile.&lt;init&gt;(java.nio.channels.SeekableByteChannel)&#39;&#39;&quot;","body":"<p>Try to install <code>Android 11.0 (R)</code> or <code>Android 12.00 (S)</code> on the SDK Platform tab on the Android SDK. That fixed the issue for me</p>\n"},{"tags":[],"owner":{"account_id":24840101,"reputation":51,"user_id":18718222,"display_name":"adamdoes"},"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1649197809,"creation_date":1649197809,"answer_id":71759095,"question_id":70340427,"body_markdown":"For anyone looking for more information, this specific issue has been covered [in Google&#39;s issue tracker](https://issuetracker.google.com/issues/213757977).  In short, the problem stems from mismatched dependency resolution of Apache&#39;s `commons-compress` between `robovm-gradle-plugin` and Gradle itself. As for Shattered Pixel Dungeon, the fix is present [in this commit](https://github.com/00-Evan/shattered-pixel-dungeon/commit/1b28cd19b5f59a5a8b7b9acf4c3565b19033f378).","title":"&quot;Unable to find method &#39;&#39;void org.apache.commons.compress.archivers.zip.ZipFile.&lt;init&gt;(java.nio.channels.SeekableByteChannel)&#39;&#39;&quot;","body":"<p>For anyone looking for more information, this specific issue has been covered <a href=\"https://issuetracker.google.com/issues/213757977\" rel=\"noreferrer\">in Google's issue tracker</a>.  In short, the problem stems from mismatched dependency resolution of Apache's <code>commons-compress</code> between <code>robovm-gradle-plugin</code> and Gradle itself. As for Shattered Pixel Dungeon, the fix is present <a href=\"https://github.com/00-Evan/shattered-pixel-dungeon/commit/1b28cd19b5f59a5a8b7b9acf4c3565b19033f378\" rel=\"noreferrer\">in this commit</a>.</p>\n"},{"tags":[],"owner":{"account_id":1897481,"reputation":1530,"user_id":1714102,"display_name":"PrzemekTom"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1664878181,"creation_date":1650881681,"answer_id":71997907,"question_id":70340427,"body_markdown":"After fresh Android Studio installation I&#39;ve downloaded proposed `Android SDK` and `build tools`, but my project was configured for the older ones. Then issue happened. I fixed it by downloading appropriate `Android SDK` and `build tools`.\r\n\r\nFor example, if your project has `compileSdkVersion 31` value, then download `Android SDK 31` and `build tools 31.0.0`. In `Tools/SDK Manager/Show Package Details` you can find correct versions for your case.","title":"&quot;Unable to find method &#39;&#39;void org.apache.commons.compress.archivers.zip.ZipFile.&lt;init&gt;(java.nio.channels.SeekableByteChannel)&#39;&#39;&quot;","body":"<p>After fresh Android Studio installation I've downloaded proposed <code>Android SDK</code> and <code>build tools</code>, but my project was configured for the older ones. Then issue happened. I fixed it by downloading appropriate <code>Android SDK</code> and <code>build tools</code>.</p>\n<p>For example, if your project has <code>compileSdkVersion 31</code> value, then download <code>Android SDK 31</code> and <code>build tools 31.0.0</code>. In <code>Tools/SDK Manager/Show Package Details</code> you can find correct versions for your case.</p>\n"},{"tags":[],"owner":{"account_id":7883507,"reputation":306,"user_id":10869204,"display_name":"Konstantin"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1660937968,"creation_date":1660937968,"answer_id":73421545,"question_id":70340427,"body_markdown":"In my case it was error with robovm, I was trying build libGDX for iOS on Windows PC, when I remove iOS project, error gone too.","title":"&quot;Unable to find method &#39;&#39;void org.apache.commons.compress.archivers.zip.ZipFile.&lt;init&gt;(java.nio.channels.SeekableByteChannel)&#39;&#39;&quot;","body":"<p>In my case it was error with robovm, I was trying build libGDX for iOS on Windows PC, when I remove iOS project, error gone too.</p>\n"},{"tags":[],"owner":{"account_id":1756724,"reputation":1546,"user_id":1604579,"accept_rate":80,"display_name":"myyk"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694505991,"creation_date":1694505991,"answer_id":77087143,"question_id":70340427,"body_markdown":"I was able able to remove `buildToolsVersion` after migrating to `Hedgehog` (currently the preview build) and migrate AGP to the `com.android.tools.build:gradle:8.2.0-beta03` version. I also upgraded all my API to `34`. This might be too bleeding edge for many, but it does seem to work.","title":"&quot;Unable to find method &#39;&#39;void org.apache.commons.compress.archivers.zip.ZipFile.&lt;init&gt;(java.nio.channels.SeekableByteChannel)&#39;&#39;&quot;","body":"<p>I was able able to remove <code>buildToolsVersion</code> after migrating to <code>Hedgehog</code> (currently the preview build) and migrate AGP to the <code>com.android.tools.build:gradle:8.2.0-beta03</code> version. I also upgraded all my API to <code>34</code>. This might be too bleeding edge for many, but it does seem to work.</p>\n"},{"tags":[],"owner":{"account_id":13828030,"reputation":169,"user_id":9981772,"display_name":"ilya_kas"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695372346,"creation_date":1695372346,"answer_id":77156090,"question_id":70340427,"body_markdown":"Even if you build IOS version and face this problem during gradle sync, you might need to downgrade gradle build tools version. For me it was \r\n\r\n    buildToolsVersion &quot;33.0.1&quot;\r\n    compileSdkVersion 33\r\n\r\nfrom \r\n\r\n    buildToolsVersion &quot;34.0.0&quot;","title":"&quot;Unable to find method &#39;&#39;void org.apache.commons.compress.archivers.zip.ZipFile.&lt;init&gt;(java.nio.channels.SeekableByteChannel)&#39;&#39;&quot;","body":"<p>Even if you build IOS version and face this problem during gradle sync, you might need to downgrade gradle build tools version. For me it was</p>\n<pre><code>buildToolsVersion &quot;33.0.1&quot;\ncompileSdkVersion 33\n</code></pre>\n<p>from</p>\n<pre><code>buildToolsVersion &quot;34.0.0&quot;\n</code></pre>\n"}],"owner":{"account_id":23637629,"reputation":121,"user_id":17668418,"display_name":"b4cku"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":5601,"favorite_count":0,"down_vote_count":0,"up_vote_count":12,"answer_count":7,"score":12,"last_activity_date":1695372346,"creation_date":1639426645,"question_id":70340427,"body_markdown":"**The problem:** I&#39;m currently using **Android Studio** and **Gradle** to compile code from a github repository ([00-Evan/shattered-pixel-dungeon](https://github.com/00-Evan/shattered-pixel-dungeon/)) and while I can run some tasks (tried &#39;desktop:release&#39;, &#39;desktop:debug&#39;), gradle refuses to sync properly and every time I try to do it, an error log pops up:\r\n```\r\nFAILURE: Build failed with an exception.\r\n\r\n* What went wrong:\r\n&#39;void org.apache.commons.compress.archivers.zip.ZipFile.&lt;init&gt;(java.nio.channels.SeekableByteChannel)&#39;\r\n\r\n* Try:\r\nRun with --info or --debug option to get more log output. Run with --scan to get full insights.\r\n\r\n* Exception is:\r\njava.lang.NoSuchMethodError: &#39;void org.apache.commons.compress.archivers.zip.ZipFile.&lt;init&gt;(java.nio.channels.SeekableByteChannel)&#39;\r\n\tat com.android.repository.util.InstallerUtil.unzip(InstallerUtil.java:99)\r\n```\r\n**Important:** I&#39;ve had this issue before (while compiling previous version of this code) and back then downloading a specific version of SDK build tools (30.0.0 and 26.0.0 if I recall correctly) helped, however this doesn&#39;t help anymore.  \r\nOther people using this code don&#39;t report the same issue and I seem to be the only one.\r\n\r\nAlso for some reason android tasks also don&#39;t seem to work, as if the android studio didn&#39;t recognize them:\r\n```\r\nTask &#39;release&#39; not found in project &#39;:android&#39;.\r\n\r\n * Try:\r\nRun gradle tasks to get a list of available tasks. Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output. Run with --scan to get full insights.\r\n```\r\n**What I&#39;ve tried:** \r\n* Clearing cache and restarting Android Studio/my PC\r\n* Enabling/disabling different build tools versions (see the &quot;Important&quot; section). At the moment I have tried enabling all 30.0.X and 26.0.X versions and disabling any newer versions that were enabled\r\n* Browsed similar Stackoverflow threads, however they either didn&#39;t seem to apply to my situation or didn&#39;t include enough information. [Link](https://stackoverflow.com/questions/52381075/apache-poi-java-lang-noclassdeffounderror-org-apache-commons-compress-archivers), [link](https://stackoverflow.com/questions/68982459/i-try-to-build-a-project-but-it-continuely-fails-the-build-with-two-errors) and [link](https://stackoverflow.com/questions/48343759/java-lang-nosuchmethoderror-org-apache-commons-compress-utils-ioutils-readfully).\r\n* Uninstalling Android Studio and re-downloading it from scratch.\r\n\r\n**Additional info:**\r\n* Android Studio version: Android Studio Arctic Fox | 2020.3.1 Patch 4 (Currently latest)\r\n* Gradle version: 7.2 (I tried using 7.1.1, but that didn&#39;t solve the issue)","title":"&quot;Unable to find method &#39;&#39;void org.apache.commons.compress.archivers.zip.ZipFile.&lt;init&gt;(java.nio.channels.SeekableByteChannel)&#39;&#39;&quot;","body":"<p><strong>The problem:</strong> I'm currently using <strong>Android Studio</strong> and <strong>Gradle</strong> to compile code from a github repository (<a href=\"https://github.com/00-Evan/shattered-pixel-dungeon/\" rel=\"noreferrer\">00-Evan/shattered-pixel-dungeon</a>) and while I can run some tasks (tried 'desktop:release', 'desktop:debug'), gradle refuses to sync properly and every time I try to do it, an error log pops up:</p>\n<pre><code>FAILURE: Build failed with an exception.\n\n* What went wrong:\n'void org.apache.commons.compress.archivers.zip.ZipFile.&lt;init&gt;(java.nio.channels.SeekableByteChannel)'\n\n* Try:\nRun with --info or --debug option to get more log output. Run with --scan to get full insights.\n\n* Exception is:\njava.lang.NoSuchMethodError: 'void org.apache.commons.compress.archivers.zip.ZipFile.&lt;init&gt;(java.nio.channels.SeekableByteChannel)'\n    at com.android.repository.util.InstallerUtil.unzip(InstallerUtil.java:99)\n</code></pre>\n<p><strong>Important:</strong> I've had this issue before (while compiling previous version of this code) and back then downloading a specific version of SDK build tools (30.0.0 and 26.0.0 if I recall correctly) helped, however this doesn't help anymore.<br />\nOther people using this code don't report the same issue and I seem to be the only one.</p>\n<p>Also for some reason android tasks also don't seem to work, as if the android studio didn't recognize them:</p>\n<pre><code>Task 'release' not found in project ':android'.\n\n * Try:\nRun gradle tasks to get a list of available tasks. Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output. Run with --scan to get full insights.\n</code></pre>\n<p><strong>What I've tried:</strong></p>\n<ul>\n<li>Clearing cache and restarting Android Studio/my PC</li>\n<li>Enabling/disabling different build tools versions (see the &quot;Important&quot; section). At the moment I have tried enabling all 30.0.X and 26.0.X versions and disabling any newer versions that were enabled</li>\n<li>Browsed similar Stackoverflow threads, however they either didn't seem to apply to my situation or didn't include enough information. <a href=\"https://stackoverflow.com/questions/52381075/apache-poi-java-lang-noclassdeffounderror-org-apache-commons-compress-archivers\">Link</a>, <a href=\"https://stackoverflow.com/questions/68982459/i-try-to-build-a-project-but-it-continuely-fails-the-build-with-two-errors\">link</a> and <a href=\"https://stackoverflow.com/questions/48343759/java-lang-nosuchmethoderror-org-apache-commons-compress-utils-ioutils-readfully\">link</a>.</li>\n<li>Uninstalling Android Studio and re-downloading it from scratch.</li>\n</ul>\n<p><strong>Additional info:</strong></p>\n<ul>\n<li>Android Studio version: Android Studio Arctic Fox | 2020.3.1 Patch 4 (Currently latest)</li>\n<li>Gradle version: 7.2 (I tried using 7.1.1, but that didn't solve the issue)</li>\n</ul>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":12404,"reputation":62016,"user_id":24396,"accept_rate":74,"display_name":"Steve Kuo"},"score":14,"creation_date":1281214727,"post_id":3431529,"comment_id":3574383,"body_markdown":"This gets asked about once a month","body":"This gets asked about once a month"},{"owner":{"account_id":1128247,"reputation":32665,"user_id":1114966,"accept_rate":100,"display_name":"squiguy"},"score":0,"creation_date":1357176994,"post_id":3431529,"comment_id":19565912,"body_markdown":"In PHP, you are using an associative array which is not synonymous Java&#39;s array.","body":"In PHP, you are using an associative array which is not synonymous Java&#39;s array."},{"owner":{"account_id":12683000,"reputation":3138,"user_id":9215955,"display_name":"mstgnz"},"score":0,"creation_date":1633032196,"post_id":3431529,"comment_id":122661035,"body_markdown":"Arrays.asList(question).indexOf(song)","body":"Arrays.asList(question).indexOf(song)"}],"answers":[{"tags":[],"owner":{"account_id":137942,"reputation":14900,"user_id":342518,"accept_rate":89,"display_name":"TheLQ"},"down_vote_count":0,"up_vote_count":16,"is_accepted":false,"score":16,"last_activity_date":1281205466,"creation_date":1281205466,"answer_id":3431541,"question_id":3431529,"body_markdown":"In Java, you can&#39;t, as foreach was meant to hide the iterator. You must do the normal For loop in order to get the current iteration.","title":"How do I get the current index/key in a &quot;for each&quot; loop","body":"<p>In Java, you can't, as foreach was meant to hide the iterator. You must do the normal For loop in order to get the current iteration.</p>\n"},{"tags":[],"owner":{"account_id":118337,"reputation":170822,"user_id":309308,"accept_rate":74,"display_name":"Michael Mrozek"},"down_vote_count":1,"up_vote_count":454,"is_accepted":true,"score":453,"last_activity_date":1281205491,"creation_date":1281205491,"answer_id":3431543,"question_id":3431529,"body_markdown":"You can&#39;t, you either need to keep the index separately:\r\n\r\n    int index = 0;\r\n    for(Element song : question) {\r\n        System.out.println(&quot;Current index is: &quot; + (index++));\r\n    }\r\n\r\nor use a normal for loop:\r\n\r\n    for(int i = 0; i &lt; question.length; i++) {\r\n        System.out.println(&quot;Current index is: &quot; + i);\r\n    }\r\n\r\nThe reason is you can use the condensed for syntax to loop over any [Iterable](http://download-llnw.oracle.com/javase/6/docs/api/java/lang/Iterable.html), and it&#39;s not guaranteed that the values actually have an &quot;index&quot;\r\n","title":"How do I get the current index/key in a &quot;for each&quot; loop","body":"<p>You can't, you either need to keep the index separately:</p>\n\n<pre><code>int index = 0;\nfor(Element song : question) {\n    System.out.println(\"Current index is: \" + (index++));\n}\n</code></pre>\n\n<p>or use a normal for loop:</p>\n\n<pre><code>for(int i = 0; i &lt; question.length; i++) {\n    System.out.println(\"Current index is: \" + i);\n}\n</code></pre>\n\n<p>The reason is you can use the condensed for syntax to loop over any <a href=\"http://download-llnw.oracle.com/javase/6/docs/api/java/lang/Iterable.html\" rel=\"noreferrer\">Iterable</a>, and it's not guaranteed that the values actually have an \"index\"</p>\n"},{"tags":[],"owner":{"account_id":152658,"reputation":9096,"user_id":367319,"accept_rate":85,"display_name":"Saher Ahwal"},"down_vote_count":3,"up_vote_count":22,"is_accepted":false,"score":19,"last_activity_date":1695371970,"creation_date":1281207377,"answer_id":3431643,"question_id":3431529,"body_markdown":"Keep track of your index: That&#39;s how it is done in Java:\r\n   \r\n\r\n    int index = 0;\r\n    for (Element song: question){\r\n        // Do whatever\r\n        index++;\r\n    }","title":"How do I get the current index/key in a &quot;for each&quot; loop","body":"<p>Keep track of your index: That's how it is done in Java:</p>\n<pre><code>int index = 0;\nfor (Element song: question){\n    // Do whatever\n    index++;\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":642686,"reputation":119,"user_id":414007,"display_name":"Zeffer"},"down_vote_count":6,"up_vote_count":13,"is_accepted":false,"score":7,"last_activity_date":1659512737,"creation_date":1281209156,"answer_id":3431754,"question_id":3431529,"body_markdown":"**Not possible in Java.**\r\n\r\n---\r\n\r\nHere&#39;s the Scala way:\r\n\r\n    val m = List(5, 4, 2, 89)\r\n    \r\n    for((el, i) &lt;- m.zipWithIndex)\r\n      println(el +&quot; &quot;+ i)\r\n\r\nIn Java either you need to run simple &quot;for&quot; loop or use an additional integer to track index, for example :\r\n\r\n    int songIndex = 0;\r\n    for (Element song: album){\r\n            // Do whatever\r\n             songIndex++;\r\n    }\r\n\r\nHope it will help :)","title":"How do I get the current index/key in a &quot;for each&quot; loop","body":"<p><strong>Not possible in Java.</strong></p>\n<hr />\n<p>Here's the Scala way:</p>\n<pre><code>val m = List(5, 4, 2, 89)\n\nfor((el, i) &lt;- m.zipWithIndex)\n  println(el +&quot; &quot;+ i)\n</code></pre>\n<p>In Java either you need to run simple &quot;for&quot; loop or use an additional integer to track index, for example :</p>\n<pre><code>int songIndex = 0;\nfor (Element song: album){\n        // Do whatever\n         songIndex++;\n}\n</code></pre>\n<p>Hope it will help :)</p>\n"},{"tags":[],"owner":{"account_id":171134,"reputation":3434,"user_id":398348,"accept_rate":67,"display_name":"likejudo"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1357175346,"creation_date":1357175346,"answer_id":14131749,"question_id":3431529,"body_markdown":"As others pointed out, &#39;not possible directly&#39;.\r\nI am guessing that you want some kind of index key for Song?\r\nJust create another field (a member variable) in Element. Increment it when you add Song to the collection.","title":"How do I get the current index/key in a &quot;for each&quot; loop","body":"<p>As others pointed out, 'not possible directly'.\nI am guessing that you want some kind of index key for Song?\nJust create another field (a member variable) in Element. Increment it when you add Song to the collection.</p>\n"},{"tags":[],"owner":{"account_id":7041204,"reputation":191,"user_id":5393646,"display_name":"Erik Brandsberg"},"down_vote_count":10,"up_vote_count":5,"is_accepted":false,"score":-5,"last_activity_date":1476363127,"creation_date":1463106610,"answer_id":37200328,"question_id":3431529,"body_markdown":"Example from current code I&#39;m working with:\r\n    \r\n    int index=-1;\r\n    for (Policy rule : rules)\r\n    {   \r\n         index++;\r\n         // do stuff here\r\n    }\r\n    \r\nLets you cleanly start with an index of zero, and increment as you process.\r\n\r\n","title":"How do I get the current index/key in a &quot;for each&quot; loop","body":"<p>Example from current code I'm working with:</p>\n\n<pre><code>int index=-1;\nfor (Policy rule : rules)\n{   \n     index++;\n     // do stuff here\n}\n</code></pre>\n\n<p>Lets you cleanly start with an index of zero, and increment as you process.</p>\n"}],"owner":{"account_id":74931,"reputation":6938,"user_id":215088,"accept_rate":91,"display_name":"droidgren"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":555030,"favorite_count":0,"down_vote_count":0,"up_vote_count":312,"closed_date":1468951677,"accepted_answer_id":3431543,"answer_count":6,"score":312,"last_activity_date":1695371970,"creation_date":1281205257,"question_id":3431529,"body_markdown":"In Java, how do I get the index of the current element?\r\n\r\n    for (Element song: question){\r\n        song.currentIndex();         //&lt;&lt;want the current index\r\n    }\r\n\r\nIn PHP, you could do this:\r\n\r\n    foreach ($arr as $index =&gt; $value) {\r\n        echo &quot;Key: $index; Value: $value&quot;;\r\n    }\r\n\r\n","title":"How do I get the current index/key in a &quot;for each&quot; loop","body":"<p>In Java, how do I get the index of the current element?</p>\n<pre><code>for (Element song: question){\n    song.currentIndex();         //&lt;&lt;want the current index\n}\n</code></pre>\n<p>In PHP, you could do this:</p>\n<pre><code>foreach ($arr as $index =&gt; $value) {\n    echo &quot;Key: $index; Value: $value&quot;;\n}\n</code></pre>\n"},{"tags":["java","sql","spring","jdbc"],"answers":[{"tags":[],"owner":{"account_id":29479773,"reputation":36,"user_id":22590790,"display_name":"Chunlin Wu"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1695371788,"creation_date":1695176447,"answer_id":77138922,"question_id":77138477,"body_markdown":"I tried your code and didn&#39;t reproduce the same error.Here is my code:\r\n\r\n```java\r\n@Repository\r\npublic class GardeningPostRepository {\r\n\r\n    private JdbcTemplate jdbcTemplate;\r\n\r\n    @Autowired\r\n    public GardeningPostRepository(DataSource dataSource) {\r\n        this.jdbcTemplate = new JdbcTemplate(dataSource);\r\n    }\r\n\r\n    public void test() {\r\n        RowMapper&lt;GardeningPost&gt; gardeningPostRowMapper = (rs, i) -&gt; {\r\n            GardeningPost post = new GardeningPost();\r\n            post.setUser_image_url(rs.getString(&quot;user_image_url&quot;));\r\n            return post;\r\n        };\r\n        List&lt;GardeningPost&gt; postList = jdbcTemplate.query(&quot;SELECT GardeningPost.*, Users.image_url AS user_image_url &quot; +\r\n                &quot;FROM GardeningPost &quot; +\r\n                &quot;INNER JOIN Users ON GardeningPost.users_gardening_post_id = Users.id &quot;, gardeningPostRowMapper);\r\n        System.out.println(postList);\r\n    }\r\n}\r\n\r\n```\r\n\r\nSince your error sql script is `SELECT * FROM GardeningPost limit ? offset ?`  and it&#39;s not the same one in `getAllGardeningPosts` method, I guess you called another method, and used the wrong rowMapper that tries to map `user_image_url` from an non-existent column in GardeningPost table.","title":"Column not found in JDBC join method","body":"<p>I tried your code and didn't reproduce the same error.Here is my code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Repository\npublic class GardeningPostRepository {\n\n    private JdbcTemplate jdbcTemplate;\n\n    @Autowired\n    public GardeningPostRepository(DataSource dataSource) {\n        this.jdbcTemplate = new JdbcTemplate(dataSource);\n    }\n\n    public void test() {\n        RowMapper&lt;GardeningPost&gt; gardeningPostRowMapper = (rs, i) -&gt; {\n            GardeningPost post = new GardeningPost();\n            post.setUser_image_url(rs.getString(&quot;user_image_url&quot;));\n            return post;\n        };\n        List&lt;GardeningPost&gt; postList = jdbcTemplate.query(&quot;SELECT GardeningPost.*, Users.image_url AS user_image_url &quot; +\n                &quot;FROM GardeningPost &quot; +\n                &quot;INNER JOIN Users ON GardeningPost.users_gardening_post_id = Users.id &quot;, gardeningPostRowMapper);\n        System.out.println(postList);\n    }\n}\n\n</code></pre>\n<p>Since your error sql script is <code>SELECT * FROM GardeningPost limit ? offset ?</code>  and it's not the same one in <code>getAllGardeningPosts</code> method, I guess you called another method, and used the wrong rowMapper that tries to map <code>user_image_url</code> from an non-existent column in GardeningPost table.</p>\n"}],"owner":{"account_id":23420828,"reputation":389,"user_id":17481061,"display_name":"Ilze"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":56,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77138922,"answer_count":1,"score":0,"last_activity_date":1695371788,"creation_date":1695165789,"question_id":77138477,"body_markdown":"I tried several options, but every time get the same error:\r\n\r\n&gt; PreparedStatementCallback; uncategorized SQLException for SQL [SELECT\r\n&gt; * FROM GardeningPost limit ? offset ?]; SQL state [S0022]; error code [0]; Column &#39;user_image_url&#39; not found.\r\n\r\n```\r\n@Override\r\npublic List&lt;GardeningPost&gt; getAllGardeningPosts(int pageSize, int offset) {\r\n    return jdbcTemplate.query(&quot;SELECT GardeningPost.*, Users.image_url AS user_image_url &quot; +\r\n            &quot;FROM GardeningPost &quot; +\r\n            &quot;INNER JOIN Users ON GardeningPost.users_gardening_post_id = Users.id &quot; +\r\n            &quot;LIMIT ? OFFSET ?&quot;, gardeningPostRowMapper, pageSize, offset);\r\n}\r\n```\r\n\r\nSince I&#39;m using only JDBC, I didn&#39;t modify my schema.sql which is: \r\n\r\n```sql\r\nCREATE TABLE Users\r\n(\r\n    id         BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,\r\n    username VARCHAR(50) NOT NULL,\r\n    email      VARCHAR(100) NOT NULL,\r\n    password   VARCHAR(255) DEFAULT NULL,\r\n    enabled    BOOLEAN DEFAULT FALSE,\r\n    non_locked BOOLEAN DEFAULT TRUE,\r\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\r\n    image_url  VARCHAR(255) DEFAULT &#39;https://cdn-icons-png.flaticon.com/512/149/149071.png&#39;,\r\n    CONSTRAINT UQ_Users_Email UNIQUE (email)\r\n); \r\nCREATE TABLE GardeningPost (\r\n                      id BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,\r\n                      date DATETIME DEFAULT CURRENT_TIMESTAMP,\r\n                      title VARCHAR(60) NOT NULL,\r\n                      description TEXT,\r\n                      tag VARCHAR(50),\r\n                      likes INT,\r\n                      view_count INT,\r\n                      img_url  VARCHAR(255),\r\n                      users_gardening_post_id BIGINT UNSIGNED NOT NULL,\r\n                      FOREIGN KEY (users_gardening_post_id) REFERENCES Users(id)\r\n);\r\n```\r\n\r\nI added a new column user_image_url in the class directly: \r\n\r\n```\r\n@Data\r\n@SuperBuilder\r\n@NoArgsConstructor\r\n@AllArgsConstructor\r\n@JsonInclude(NON_DEFAULT)\r\npublic class GardeningPost {\r\n    private Long id;\r\n    @JsonFormat(pattern = &quot;yyyy-MM-dd&#39;T&#39;HH:mm:ss&quot;)\r\n    private LocalDateTime date;\r\n    private String title;\r\n    private String description;\r\n    private String tag;\r\n    private Long likes;\r\n    private Long view_count;\r\n    private String img_url;\r\n    private String user_image_url;\r\n}\r\n```\r\n\r\nThe reason I created the method is because I want to use the relation and provide in controller response which would include in GardeningPost also user_image_url as user profile picture.","title":"Column not found in JDBC join method","body":"<p>I tried several options, but every time get the same error:</p>\n<blockquote>\n<p>PreparedStatementCallback; uncategorized SQLException for SQL [SELECT</p>\n<ul>\n<li>FROM GardeningPost limit ? offset ?]; SQL state [S0022]; error code [0]; Column 'user_image_url' not found.</li>\n</ul>\n</blockquote>\n<pre><code>@Override\npublic List&lt;GardeningPost&gt; getAllGardeningPosts(int pageSize, int offset) {\n    return jdbcTemplate.query(&quot;SELECT GardeningPost.*, Users.image_url AS user_image_url &quot; +\n            &quot;FROM GardeningPost &quot; +\n            &quot;INNER JOIN Users ON GardeningPost.users_gardening_post_id = Users.id &quot; +\n            &quot;LIMIT ? OFFSET ?&quot;, gardeningPostRowMapper, pageSize, offset);\n}\n</code></pre>\n<p>Since I'm using only JDBC, I didn't modify my schema.sql which is:</p>\n<pre class=\"lang-sql prettyprint-override\"><code>CREATE TABLE Users\n(\n    id         BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,\n    username VARCHAR(50) NOT NULL,\n    email      VARCHAR(100) NOT NULL,\n    password   VARCHAR(255) DEFAULT NULL,\n    enabled    BOOLEAN DEFAULT FALSE,\n    non_locked BOOLEAN DEFAULT TRUE,\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n    image_url  VARCHAR(255) DEFAULT 'https://cdn-icons-png.flaticon.com/512/149/149071.png',\n    CONSTRAINT UQ_Users_Email UNIQUE (email)\n); \nCREATE TABLE GardeningPost (\n                      id BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,\n                      date DATETIME DEFAULT CURRENT_TIMESTAMP,\n                      title VARCHAR(60) NOT NULL,\n                      description TEXT,\n                      tag VARCHAR(50),\n                      likes INT,\n                      view_count INT,\n                      img_url  VARCHAR(255),\n                      users_gardening_post_id BIGINT UNSIGNED NOT NULL,\n                      FOREIGN KEY (users_gardening_post_id) REFERENCES Users(id)\n);\n</code></pre>\n<p>I added a new column user_image_url in the class directly:</p>\n<pre><code>@Data\n@SuperBuilder\n@NoArgsConstructor\n@AllArgsConstructor\n@JsonInclude(NON_DEFAULT)\npublic class GardeningPost {\n    private Long id;\n    @JsonFormat(pattern = &quot;yyyy-MM-dd'T'HH:mm:ss&quot;)\n    private LocalDateTime date;\n    private String title;\n    private String description;\n    private String tag;\n    private Long likes;\n    private Long view_count;\n    private String img_url;\n    private String user_image_url;\n}\n</code></pre>\n<p>The reason I created the method is because I want to use the relation and provide in controller response which would include in GardeningPost also user_image_url as user profile picture.</p>\n"},{"tags":["java","random","motion"],"owner":{"account_id":16995186,"reputation":105,"user_id":12293801,"display_name":"sushiwithoutsushi"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":35,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1695371692,"creation_date":1695371692,"question_id":77156023,"body_markdown":"I have a `Drone` class implemented as a Thread that is called from a `Map` class and every X milliseconds the `movement()` function of the `Drone` class is called to update the position and show it on the map.\r\n\r\nCurrently the `movement()` function looks as follows. \r\n```\r\n\tpublic void moveDrone() {\r\n\t\tdouble increment = 0.000007;\r\n//\t\tStraight line movement\r\n\t\tif(this.mode == true)\r\n\t\t\tp.setX(this.p.getX() + increment);\r\n\t\tif(this.mode == false)\r\n\t\t\tp.setX(p.getX() - increment);\r\n\t\tif(p.getX()&gt;38.88602||p.getX()&lt;38.88453)\r\n\t\t\tthis.mode = !this.mode;\r\n```\r\nWhich creates a movement in a straight line that looks pretty simple.\r\n\r\nI would like to simulate a random motion that looks kind of natural. I&#39;ve been reading about different implementations like brownian motion and boids but I couldn&#39;t find how to implement them for a single particle (drone in this case) that moves randomly inside a bounding box.\r\n\r\nAny link or pseudocode will help.\r\n","title":"How to implement a random natural motion for a single particle?","body":"<p>I have a <code>Drone</code> class implemented as a Thread that is called from a <code>Map</code> class and every X milliseconds the <code>movement()</code> function of the <code>Drone</code> class is called to update the position and show it on the map.</p>\n<p>Currently the <code>movement()</code> function looks as follows.</p>\n<pre><code>    public void moveDrone() {\n        double increment = 0.000007;\n//      Straight line movement\n        if(this.mode == true)\n            p.setX(this.p.getX() + increment);\n        if(this.mode == false)\n            p.setX(p.getX() - increment);\n        if(p.getX()&gt;38.88602||p.getX()&lt;38.88453)\n            this.mode = !this.mode;\n</code></pre>\n<p>Which creates a movement in a straight line that looks pretty simple.</p>\n<p>I would like to simulate a random motion that looks kind of natural. I've been reading about different implementations like brownian motion and boids but I couldn't find how to implement them for a single particle (drone in this case) that moves randomly inside a bounding box.</p>\n<p>Any link or pseudocode will help.</p>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1695373594,"post_id":77156013,"comment_id":136018628,"body_markdown":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking.","body":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking."}],"owner":{"account_id":22647836,"reputation":1,"user_id":16822947,"display_name":"10TN3 T&#242;ng"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":10,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1695371577,"creation_date":1695371577,"question_id":77156013,"body_markdown":"i want to ask after i verify with \r\n```\r\nfrom(&quot;direct:signJwt&quot;)\r\n                 .setHeader(DigitalSignatureConstants.SIGNATURE_PRIVATE_KEY, constant(keys.getPrivate()))\r\n                 .to(&quot;crypto:sign:message?algorithm=SHA256withRSA&quot;)\r\n                 .to(&quot;direct:verify&quot;);\r\n\r\nfrom(&quot;direct:verify&quot;)\r\n                .setHeader(DigitalSignatureConstants.SIGNATURE_PUBLIC_KEY_OR_CERT, constant(keys.getPublic()))\r\n                .to(&quot;crypto:verify:check?algorithm=SHA256withRSA&quot;)\r\n                 .end();\r\n```\r\nHow to get the result if it&#39;s success or fail. Thank you\r\nI used camel crypto version 2.25.4\r\n\r\ni try to sign a jwt token with privatekey and use a public key to verify it","title":"Camel-Crypto sign and verify","body":"<p>i want to ask after i verify with</p>\n<pre><code>from(&quot;direct:signJwt&quot;)\n                 .setHeader(DigitalSignatureConstants.SIGNATURE_PRIVATE_KEY, constant(keys.getPrivate()))\n                 .to(&quot;crypto:sign:message?algorithm=SHA256withRSA&quot;)\n                 .to(&quot;direct:verify&quot;);\n\nfrom(&quot;direct:verify&quot;)\n                .setHeader(DigitalSignatureConstants.SIGNATURE_PUBLIC_KEY_OR_CERT, constant(keys.getPublic()))\n                .to(&quot;crypto:verify:check?algorithm=SHA256withRSA&quot;)\n                 .end();\n</code></pre>\n<p>How to get the result if it's success or fail. Thank you\nI used camel crypto version 2.25.4</p>\n<p>i try to sign a jwt token with privatekey and use a public key to verify it</p>\n"},{"tags":["java","sql","jdbc"],"comments":[{"owner":{"account_id":8591840,"reputation":46475,"user_id":6436191,"display_name":"The Impaler"},"score":0,"creation_date":1695241917,"post_id":77144908,"comment_id":135999962,"body_markdown":"What for? Do you want to parse a query for some specific goal? What&#39;s the use case?","body":"What for? Do you want to parse a query for some specific goal? What&#39;s the use case?"},{"owner":{"account_id":1245174,"reputation":344,"user_id":1206791,"display_name":"makrom"},"score":0,"creation_date":1695248497,"post_id":77144908,"comment_id":136000805,"body_markdown":"No quite the opposite actually, parsing is pretty much what I want to avoid (and might be outright impossible without DB specific implementations since different DBs interpret statements differently). What I want to do is pretty much what the title says, execute arbitrary statements and receive a meaningful result, which is different depending on the type of the statement (returning a result set for select statements, or a message &quot;40 rows updated&quot; for an update statement, &quot;30 rows inserted for an insert statement, &quot;table xyz created&quot; for a create table statement and so on).","body":"No quite the opposite actually, parsing is pretty much what I want to avoid (and might be outright impossible without DB specific implementations since different DBs interpret statements differently). What I want to do is pretty much what the title says, execute arbitrary statements and receive a meaningful result, which is different depending on the type of the statement (returning a result set for select statements, or a message &quot;40 rows updated&quot; for an update statement, &quot;30 rows inserted for an insert statement, &quot;table xyz created&quot; for a create table statement and so on)."},{"owner":{"account_id":213468,"reputation":103494,"user_id":466862,"display_name":"Mark Rotteveel"},"score":1,"creation_date":1695371484,"post_id":77144908,"comment_id":136018229,"body_markdown":"_&quot;most informative method to execute arbitrary statements is likely .executeUpdate()&quot;_ That is not correct. The most flexible way is using `execute()`. If it returns `true` the first result is a result set (use `getResultSet()` to get the result set), if it is false, it is an update count (use `getUpdateCount()`, if that returns -1, there are no more results), after processing that result, use `getMoreResults()` to process subsequent results, if any. Its return value has the same meaning as for `execute()` (true result set, false update count), etc.","body":"<i>&quot;most informative method to execute arbitrary statements is likely .executeUpdate()&quot;</i> That is not correct. The most flexible way is using <code>execute()</code>. If it returns <code>true</code> the first result is a result set (use <code>getResultSet()</code> to get the result set), if it is false, it is an update count (use <code>getUpdateCount()</code>, if that returns -1, there are no more results), after processing that result, use <code>getMoreResults()</code> to process subsequent results, if any. Its return value has the same meaning as for <code>execute()</code> (true result set, false update count), etc."},{"owner":{"account_id":213468,"reputation":103494,"user_id":466862,"display_name":"Mark Rotteveel"},"score":0,"creation_date":1695371540,"post_id":77144908,"comment_id":136018242,"body_markdown":"This will allow you to process arbitrary results, but does not actually identify the type of statement at hand. There is no common way that database systems expose information like that (if they even expose such information, or if they don&#39;t use a different level of abstraction).","body":"This will allow you to process arbitrary results, but does not actually identify the type of statement at hand. There is no common way that database systems expose information like that (if they even expose such information, or if they don&#39;t use a different level of abstraction)."},{"owner":{"account_id":1245174,"reputation":344,"user_id":1206791,"display_name":"makrom"},"score":0,"creation_date":1695402548,"post_id":77144908,"comment_id":136024519,"body_markdown":"@Mark Rotteveel Are you sure .execute() would be more flexible? Even if not, you are right that .getUpdateCount() can substitute the return value of .executeUpdate(), just like checking .getResultSet() for null could substitute the return value of .execute(). But even if they are equivalent in that regard, aesthetically .execute() would definitely be preferable. And perhaps you are right after all, in case there are DBs that refuse non-writing statements through .executeUpdate() (though I haven&#39;t encountered that yet).","body":"@Mark Rotteveel Are you sure .execute() would be more flexible? Even if not, you are right that .getUpdateCount() can substitute the return value of .executeUpdate(), just like checking .getResultSet() for null could substitute the return value of .execute(). But even if they are equivalent in that regard, aesthetically .execute() would definitely be preferable. And perhaps you are right after all, in case there are DBs that refuse non-writing statements through .executeUpdate() (though I haven&#39;t encountered that yet)."},{"owner":{"account_id":213468,"reputation":103494,"user_id":466862,"display_name":"Mark Rotteveel"},"score":0,"creation_date":1695458242,"post_id":77144908,"comment_id":136029505,"body_markdown":"Yes, I&#39;m sure. The `execute()` method is for cases where you don&#39;t know what the result will be and how many results there will be (e.g. for example a SQL Server stored procedure can return multiple result sets and update counts in arbitrary order).","body":"Yes, I&#39;m sure. The <code>execute()</code> method is for cases where you don&#39;t know what the result will be and how many results there will be (e.g. for example a SQL Server stored procedure can return multiple result sets and update counts in arbitrary order)."},{"owner":{"account_id":213468,"reputation":103494,"user_id":466862,"display_name":"Mark Rotteveel"},"score":0,"creation_date":1695458288,"post_id":77144908,"comment_id":136029510,"body_markdown":"Just checking `getResultSet` for `null` is not a good substitute, because that would go against the protocol established for `execute()` and `getMoreResults()`, and calling `executeUpdate()` when the first result is a result set should produce an exception, and it is driver-specific if that exception happens *before* or *after* the statement is executed on the server, so trying that might work on one driver, but not on another (not to mention that the driver might clear results on exceptions, or rollback the transaction in auto-commit, etc).","body":"Just checking <code>getResultSet</code> for <code>null</code> is not a good substitute, because that would go against the protocol established for <code>execute()</code> and <code>getMoreResults()</code>, and calling <code>executeUpdate()</code> when the first result is a result set should produce an exception, and it is driver-specific if that exception happens <i>before</i> or <i>after</i> the statement is executed on the server, so trying that might work on one driver, but not on another (not to mention that the driver might clear results on exceptions, or rollback the transaction in auto-commit, etc)."}],"answers":[{"tags":[],"owner":{"account_id":2730061,"reputation":1242,"user_id":2867361,"accept_rate":100,"display_name":"CHHIBI AMOR"},"down_vote_count":1,"up_vote_count":2,"is_accepted":false,"score":1,"last_activity_date":1695239937,"creation_date":1695239937,"answer_id":77145599,"question_id":77144908,"body_markdown":"Determining the exact type of an SQL statement without parsing it extensively can be challenging, especially when you want to cover all possible SQL dialects and variations across different database systems. JDBC and the `PreparedStatement` interface do not provide a direct way to ascertain the statement type.\r\n\r\nAs you&#39;ve mentioned, checking the first keyword might give you a rough idea but isn&#39;t foolproof due to the variety of SQL dialects and proprietary extensions. Additionally, using `executeUpdate()` for all statements isn&#39;t a good practice and won&#39;t reliably indicate the statement type.\r\n\r\nA more reliable approach would involve parsing the SQL statement, but this can be complex and error-prone. There are third-party SQL parsers available that can help with this, but they may not cover every possible SQL variation.\r\n\r\nHere are a few considerations:\r\n\r\n1. **Database-Specific Features**: Some databases provide extensions or system tables/functions to determine the statement type. For example, PostgreSQL has `pg_stat_statements`, and Oracle has `V$SQL` for tracking SQL statements. However, these are database-specific solutions and not part of standard JDBC.\r\n\r\n2. **Custom Logging**: Another approach is to log the SQL statements along with their types in your application for auditing purposes. This way, you can record the statement types at the time they are executed.\r\n\r\n3. **Stored Procedures**: Encapsulating SQL statements within stored procedures can provide more control and auditing capabilities. You can create stored procedures for different types of statements and then call those procedures from your application.\r\n\r\n4. **Query Builder**: Consider using a query builder or an Object-Relational Mapping (ORM) framework like Hibernate. These tools often abstract away the need to write raw SQL statements and can provide a more reliable way to perform database operations.\r\n\r\nIn summary, while there isn&#39;t a foolproof, database-agnostic way to determine the exact type of an SQL statement using `PreparedStatement`, you can combine various approaches based on your specific requirements and constraints. Custom logging and database-specific features can be useful, but you may still need to rely on some level of SQL parsing or use higher-level abstractions provided by frameworks to make your code more robust and maintainable.","title":"Getting meaningful results when executing arbitrary SQL statements (DML, DDL)","body":"<p>Determining the exact type of an SQL statement without parsing it extensively can be challenging, especially when you want to cover all possible SQL dialects and variations across different database systems. JDBC and the <code>PreparedStatement</code> interface do not provide a direct way to ascertain the statement type.</p>\n<p>As you've mentioned, checking the first keyword might give you a rough idea but isn't foolproof due to the variety of SQL dialects and proprietary extensions. Additionally, using <code>executeUpdate()</code> for all statements isn't a good practice and won't reliably indicate the statement type.</p>\n<p>A more reliable approach would involve parsing the SQL statement, but this can be complex and error-prone. There are third-party SQL parsers available that can help with this, but they may not cover every possible SQL variation.</p>\n<p>Here are a few considerations:</p>\n<ol>\n<li><p><strong>Database-Specific Features</strong>: Some databases provide extensions or system tables/functions to determine the statement type. For example, PostgreSQL has <code>pg_stat_statements</code>, and Oracle has <code>V$SQL</code> for tracking SQL statements. However, these are database-specific solutions and not part of standard JDBC.</p>\n</li>\n<li><p><strong>Custom Logging</strong>: Another approach is to log the SQL statements along with their types in your application for auditing purposes. This way, you can record the statement types at the time they are executed.</p>\n</li>\n<li><p><strong>Stored Procedures</strong>: Encapsulating SQL statements within stored procedures can provide more control and auditing capabilities. You can create stored procedures for different types of statements and then call those procedures from your application.</p>\n</li>\n<li><p><strong>Query Builder</strong>: Consider using a query builder or an Object-Relational Mapping (ORM) framework like Hibernate. These tools often abstract away the need to write raw SQL statements and can provide a more reliable way to perform database operations.</p>\n</li>\n</ol>\n<p>In summary, while there isn't a foolproof, database-agnostic way to determine the exact type of an SQL statement using <code>PreparedStatement</code>, you can combine various approaches based on your specific requirements and constraints. Custom logging and database-specific features can be useful, but you may still need to rely on some level of SQL parsing or use higher-level abstractions provided by frameworks to make your code more robust and maintainable.</p>\n"}],"owner":{"account_id":1245174,"reputation":344,"user_id":1206791,"display_name":"makrom"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":85,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"answer_count":1,"score":-1,"last_activity_date":1695371283,"creation_date":1695232390,"question_id":77144908,"body_markdown":"Is there a reliable way to get the type of an SQL statement (SELECT, INSERT, UPDATE, DELETE, if possible also CREATE, TRUNCATE, DROP, ALTER...) without extensively parsing it? Do DBs return a reliable indicator for the type of the executed statement, ideally one that can be deducted from a `java.sql.PreparedStatement`?\r\n\r\nTo elaborate on the problem: A trivial way would be to check the first keyword, however this seems very error prone (e.g. statements starting with `WITH`, PL/SQL syntax, proprietary keywords and so on). The idea of reliably determining the type purely in Java without external resources seems daunting, especially when considering various DB vendors and versions (including future versions).\r\n\r\nAs far as I can tell, the most informative method to execute arbitrary statements is likely .executeUpdate(), as it returns the number of affected rows for writing statements; furthermore it won&#39;t return SQL errors for successfully executed DDLs (which from what I understand is the only indicator of success) and the `PreparedStatement` still has a retrievable `java.sql.ResultSet` for SELECT statements. But beside the fact that this would be in breach of various best practice approaches due to the misnomer/abuse of the method, this would still not give a clear indication of the type of the executed statement.","title":"Getting meaningful results when executing arbitrary SQL statements (DML, DDL)","body":"<p>Is there a reliable way to get the type of an SQL statement (SELECT, INSERT, UPDATE, DELETE, if possible also CREATE, TRUNCATE, DROP, ALTER...) without extensively parsing it? Do DBs return a reliable indicator for the type of the executed statement, ideally one that can be deducted from a <code>java.sql.PreparedStatement</code>?</p>\n<p>To elaborate on the problem: A trivial way would be to check the first keyword, however this seems very error prone (e.g. statements starting with <code>WITH</code>, PL/SQL syntax, proprietary keywords and so on). The idea of reliably determining the type purely in Java without external resources seems daunting, especially when considering various DB vendors and versions (including future versions).</p>\n<p>As far as I can tell, the most informative method to execute arbitrary statements is likely .executeUpdate(), as it returns the number of affected rows for writing statements; furthermore it won't return SQL errors for successfully executed DDLs (which from what I understand is the only indicator of success) and the <code>PreparedStatement</code> still has a retrievable <code>java.sql.ResultSet</code> for SELECT statements. But beside the fact that this would be in breach of various best practice approaches due to the misnomer/abuse of the method, this would still not give a clear indication of the type of the executed statement.</p>\n"},{"tags":["java","java.util.scanner"],"comments":[{"owner":{"account_id":788777,"reputation":28977,"user_id":857132,"accept_rate":69,"display_name":"John3136"},"score":6,"creation_date":1695345542,"post_id":77154395,"comment_id":136015425,"body_markdown":"Does this answer your question? [Scanner is skipping nextLine() after using next() or nextFoo()?](https://stackoverflow.com/questions/13102045/scanner-is-skipping-nextline-after-using-next-or-nextfoo) - this answer is clear and concise https://stackoverflow.com/a/7056782/857132","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/13102045/scanner-is-skipping-nextline-after-using-next-or-nextfoo\">Scanner is skipping nextLine() after using next() or nextFoo()?</a> - this answer is clear and concise <a href=\"https://stackoverflow.com/a/7056782/857132\">stackoverflow.com/a/7056782/857132</a>"},{"owner":{"account_id":5584931,"reputation":2048,"user_id":4425643,"accept_rate":64,"display_name":"CausingUnderflowsEverywhere"},"score":0,"creation_date":1695346283,"post_id":77154395,"comment_id":136015486,"body_markdown":"When you call scanner.nextInt() it retrieves the next number it finds. Calling scanner.nextLine() retrieves any remaining input until it encounters a new line character which happens when the person presses enter. Try this out by inputting &quot;1 Heart&quot;. That should end up working in the following code. The solution is skipping the line after getting the int.","body":"When you call scanner.nextInt() it retrieves the next number it finds. Calling scanner.nextLine() retrieves any remaining input until it encounters a new line character which happens when the person presses enter. Try this out by inputting &quot;1 Heart&quot;. That should end up working in the following code. The solution is skipping the line after getting the int."},{"owner":{"account_id":71739,"reputation":307142,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":0,"creation_date":1695371305,"post_id":77154395,"comment_id":136018192,"body_markdown":"Nothing to do with [tag:switch-statement], [tag:contains], or [tag:if-statement] whatsoever.","body":"Nothing to do with <a href=\"https://stackoverflow.com/questions/tagged/switch-statement\">switch-statement</a>, <a href=\"https://stackoverflow.com/questions/tagged/contains\">contains</a>, or <a href=\"https://stackoverflow.com/questions/tagged/if-statement\">if-statement</a> whatsoever."}],"owner":{"account_id":29504770,"reputation":1,"user_id":22610986,"display_name":"satanicseraphs"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":21,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1695345888,"answer_count":0,"score":0,"last_activity_date":1695371266,"creation_date":1695345361,"question_id":77154395,"body_markdown":"I have an assignment due for a class and I have to use contains() and toUpperCase(). I am not allowed to use loops or arrays. I know a loop would make this a whole lot easier, but I have to do it the long way. Also, I am using Eclipse for this class if that matters.\r\n\r\nI run the program for this case and it skips right over my `bookSearch = input.nextLine();` and just displays the first if statement but with no output after `System.out.println(&quot;You searched for: &quot; + bookSearch.toUpperCase());` and displays bookOne. My problem is that I need to be able to get input for bookSearch or have some way to compare it to the 3 string variables books using contains().\r\n\r\nI have tried adjusting how I present the string bookSearch and reorganizing where it is, I&#39;ve tried running it without the else-if statements as well and that also results in skipping over the user input and just ending the case. I am honestly not even sure if the else-if statements work yet because I cannot get input for bookSearch. \r\n\r\nI have only included the first case so ignore that there are 2 other options for the switch.\r\n\r\n```\r\npublic class DemoMathCharString {\r\n\r\n\tpublic static void main(String[] args) {\r\n\t\tScanner input = new Scanner(System.in);\r\n\t\t\r\n\t\tSystem.out.println(&quot;~~ Hello and welcome to your Local Library Portal. Please select from one of the following options. ~~&quot;);\r\n\t\t\tSystem.out.println(&quot;1.) Library Catalog\\n2.) Library Visitors Statistics\\n3.) Library Books Statistics&quot;);\r\n\t\t\r\n\t\tint option = input.nextInt(); //get user&#39;s menu selection\r\n\t\t\r\n\t\tswitch(option) { \r\n\t\tcase 1: \r\n\t\t\tString bookOne = &quot;The Telltale Heart&quot;;\r\n\t\t\tString bookTwo = &quot;Wuthering Heights&quot;;\r\n\t\t\tString bookThree = &quot;A Court of Thorns and Roses&quot;; \r\n\t\t\tString bookSearch;\r\n\t\t\t\r\n\t\t\tSystem.out.println(&quot;Please enter your search for this library catalog. Please note that search is case sensitive.\\nThe books shown after your search are the books we have available for borrowing at this time.&quot;);\r\n\t\t\tbookSearch = input.nextLine();\r\n\t\t\tif (bookOne.contains(bookSearch)) {\r\n\t\t\t\tSystem.out.println(&quot;You searched for: &quot; + bookSearch.toUpperCase());\r\n\t\t\t\tSystem.out.println(&quot;We have the following book available to be borrowed: &quot; + bookOne);\r\n\t\t\t}\r\n\r\n```\r\n\r\n","title":"Switch case skipping input and going straight to first if statement","body":"<p>I have an assignment due for a class and I have to use contains() and toUpperCase(). I am not allowed to use loops or arrays. I know a loop would make this a whole lot easier, but I have to do it the long way. Also, I am using Eclipse for this class if that matters.</p>\n<p>I run the program for this case and it skips right over my <code>bookSearch = input.nextLine();</code> and just displays the first if statement but with no output after <code>System.out.println(&quot;You searched for: &quot; + bookSearch.toUpperCase());</code> and displays bookOne. My problem is that I need to be able to get input for bookSearch or have some way to compare it to the 3 string variables books using contains().</p>\n<p>I have tried adjusting how I present the string bookSearch and reorganizing where it is, I've tried running it without the else-if statements as well and that also results in skipping over the user input and just ending the case. I am honestly not even sure if the else-if statements work yet because I cannot get input for bookSearch.</p>\n<p>I have only included the first case so ignore that there are 2 other options for the switch.</p>\n<pre><code>public class DemoMathCharString {\n\n    public static void main(String[] args) {\n        Scanner input = new Scanner(System.in);\n        \n        System.out.println(&quot;~~ Hello and welcome to your Local Library Portal. Please select from one of the following options. ~~&quot;);\n            System.out.println(&quot;1.) Library Catalog\\n2.) Library Visitors Statistics\\n3.) Library Books Statistics&quot;);\n        \n        int option = input.nextInt(); //get user's menu selection\n        \n        switch(option) { \n        case 1: \n            String bookOne = &quot;The Telltale Heart&quot;;\n            String bookTwo = &quot;Wuthering Heights&quot;;\n            String bookThree = &quot;A Court of Thorns and Roses&quot;; \n            String bookSearch;\n            \n            System.out.println(&quot;Please enter your search for this library catalog. Please note that search is case sensitive.\\nThe books shown after your search are the books we have available for borrowing at this time.&quot;);\n            bookSearch = input.nextLine();\n            if (bookOne.contains(bookSearch)) {\n                System.out.println(&quot;You searched for: &quot; + bookSearch.toUpperCase());\n                System.out.println(&quot;We have the following book available to be borrowed: &quot; + bookOne);\n            }\n\n</code></pre>\n"},{"tags":["java","spring","spring-boot","jdbc"],"owner":{"account_id":20570786,"reputation":25,"user_id":15099175,"display_name":"Pasindu Prabhath"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":34,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1695371047,"creation_date":1695359488,"question_id":77155007,"body_markdown":"I have a project which is running in java 1.8 and spring 1.x, It runs finely without any errors. But I just want to handle the error happens when it loose the DB connection.\r\n\r\nI kill the process to test using sudo kill and then it give typical jdbc connection error.\r\n\r\n```\r\nCould not open JDBC Connection for transaction; nested exception is org.postgresql.util.PSQLException: FATAL: terminating connection due to administrator command\r\n\tat org.springframework.jdbc.datasource.DataSourceTransactionManager.doBegin(DataSourceTransactionManager.java:242)\r\n```\r\n\r\nI want to handle this and want to reconnect the DB. I&#39;m new to spring. And also this finely work after I restart the application. It again create jdbc connection and work finely.\r\n\r\nAnd this is the properties file\r\n\r\n```\r\n\r\nspring.batch.job.enabled=false\r\n\r\n# HikariCP configuration\r\nspring.datasource.type=com.zaxxer.hikari.HikariDataSource\r\nspring.datasource.hikari.connection-test-query=SELECT 1\r\nspring.datasource.hikari.maximum-pool-size=20 \r\nspring.datasource.hikari.idle-timeout=30000 \r\n\r\nspring.datasource.hikari.minimumIdle=5\r\nspring.datasource.hikari.maximumPoolSize=20\r\nspring.datasource.hikari.idleTimeout=30000\r\nspring.datasource.hikari.poolName=SpringBootJPAHikariCP\r\nspring.datasource.hikari.maxLifetime=2000000\r\nspring.datasource.hikari.connectionTimeout=30000\r\n\r\n# Database connection details\r\nspring.datasource.url=jdbc:postgresql://127.0.0.1:5432/octopus_retaildemo\r\nspring.datasource.driver-class-name=org.postgresql.Driver\r\nspring.datasource.username=retaildemo\r\nspring.datasource.password=demo\r\n#spring.jpa.database=default\r\n\r\nautocount.datasource.url=jdbc:postgresql://127.0.0.1:5432/aed_foroctopustestdata\r\nautocount.datasource.username=pasinduprabhath\r\nautocount.datasource.password=demo\r\nautocount.datasource.default_schema=public\r\nautocount.datasource.driver-class-name=org.postgresql.Driver\r\nspring.jpa.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect\r\nspring.jpa.hibernate.ddl-auto=none\r\nspring.jpa.show-sql=false\r\n\r\n\r\noctopus.directoryPath=/Users/pasinduprabhath/Documents/workspace-spring-tool-suite-4-4.19.1.RELEASE/Sentinal/reports\r\n\r\noctopus.testmode=0\r\noctopus.maxpoolsize=20\r\noctopus.terminal=HQ001\r\noctopus.location=HQ\r\noctopus.username=admin\r\n\r\noctopus.invjob.enabled=false\r\noctopus.invjob.attachzip=0\r\noctopus.invjob.time=1 * * * * *\r\n\r\noctopus.autocount.enabled=true\r\n\r\noctopus.autocount.salescsvread.enabled=false\r\noctopus.autocount.salescsvread.readtime=1 * * * * *\r\noctopus.autocount.salescsvread.salesfilename=POS Sales Transaction\r\noctopus.autocount.salescsvread.salesfilename.columns=dateTime,empty1,documentNo,itemCode,description,qty,unitPrice,gross,discount,subTotal,tax,totalEx,totalInc\r\n#octopus.autocount.salescsvread.paymentfilename=Sale Receipt by payment\r\noctopus.autocount.salescsvread.paymentfilename=Cash Receipt Report \r\noctopus.autocount.salescsvread.paymentfilename.columns=documentDate,documentNo,totalEx,tax,total,roundAdj,finalTotal,cashPayment,creditCardPayment,debitCardPayment,chequePayment,voucherPayment,pointPayment,creditPayment\r\noctopus.autocount.salescsvread.customerfilename=Customer Transaction\r\noctopus.autocount.salescsvread.customerfilename.columns=date,docNo,customerid,customerName,email\r\noctopus.autocount.salescsvread.hpenabled=false\r\n\r\npos.customer.point.job.enabled=false\r\npos.customer.point.job.time=1 * * * * *\r\nlogging.file=sentinal.log\r\nlogging.level.root=INFO\r\n\r\noctopus.autocount.readitemenabled=true\r\noctopus.autocount.readitemtable=1 * * * * *\r\n\r\noctopus.autocount.doreadenabled=false\r\noctopus.autocount.readdotable=1 * * * * *\r\n#octopus.autocount.readitemtable=0 0/1 * * * *\r\n\r\n# Reconnect properties\r\nspring.datasource.hikari.initialization-fail-fast=true\r\nspring.datasource.hikari.connection-init-sql=SELECT 1\r\n```\r\n\r\nI just tried with a class(ConnectionValidator class)\r\n\r\n```\r\npackage com.octopus.services.common.network;\r\nimport org.apache.commons.logging.Log;\r\nimport org.apache.commons.logging.LogFactory;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.jdbc.core.JdbcTemplate;\r\nimport org.springframework.scheduling.annotation.Scheduled;\r\nimport org.springframework.stereotype.Component;\r\n\r\nimport com.Application;\r\n\r\nimport javax.sql.DataSource;\r\nimport java.sql.Connection;\r\nimport java.sql.SQLException;\r\n\r\n@Component\r\npublic class ConnectionValidator {\r\n\r\n    private final DataSource dataSource;\r\n    private int maxReconnectAttempts = 3; // Maximum number of reconnection attempts\r\n    private int reconnectAttemptInterval = 3000; // Interval between reconnection attempts in milliseconds\r\n    \r\n    @Autowired\r\n    public ConnectionValidator(DataSource dataSource) {\r\n        this.dataSource = dataSource;\r\n    }\r\n\r\n    @Scheduled(fixedRate = 50000) // Run every minute\r\n    public void validateConnection() {\r\n        try (Connection connection = dataSource.getConnection()) {\r\n            // Perform a simple query to validate the connection\r\n            JdbcTemplate jdbcTemplate = new JdbcTemplate(dataSource);\r\n            jdbcTemplate.queryForObject(&quot;SELECT 1&quot;, Integer.class);\r\n        } catch (SQLException e) {\r\n            // Handle the exception (e.g., attempt to reconnect)\r\n            if (isConnectionClosedException(e)) {\r\n                reconnect();\r\n            } else {\r\n                // Handle other types of SQLExceptions as needed\r\n                log.error(&quot;Error occurred during connection validation:&quot;, e);\r\n            }\r\n        }\r\n    }\r\n    \r\n    private boolean isConnectionClosedException(SQLException e) {\r\n        return e.getMessage() != null &amp;&amp; e.getMessage().contains(&quot;This connection has been closed&quot;);\r\n    }\r\n\r\n    private void handleReconnectionFailure() {\r\n        System.err.println(&quot;Failed to reconnect after max attempts. Performing custom action...&quot;);\r\n    }\r\n    \r\n    private void reconnect() {\r\n        int reconnectAttempts = 0;\r\n        while (reconnectAttempts &lt; maxReconnectAttempts) {\r\n            try {\r\n                Thread.sleep(reconnectAttemptInterval);\r\n                Connection connection = dataSource.getConnection();\r\n                if (connection.isValid(5)) { // Check if the reconnected connection is valid\r\n                    return;\r\n                }\r\n            } catch (SQLException | InterruptedException ex) {\r\n                log.error(&quot;Reconnection attempt failed:&quot;, ex);\r\n            }\r\n            reconnectAttempts++;\r\n        }\r\n        handleReconnectionFailure();\r\n    }\r\n}\r\n```\r\n\r\nlike above and calling it in main. Here is the main,\r\n\r\n```\r\npackage com;\r\n\r\nimport java.io.IOException;\r\nimport com.octopus.pos.utils.DatabaseManager;\r\nimport com.octopus.services.common.network.ConnectionValidator;\r\n\r\nimport org.apache.commons.logging.Log;\r\nimport org.apache.commons.logging.LogFactory;\r\nimport org.springframework.batch.core.JobParametersInvalidException;\r\nimport org.springframework.batch.core.repository.JobExecutionAlreadyRunningException;\r\nimport org.springframework.batch.core.repository.JobInstanceAlreadyCompleteException;\r\nimport org.springframework.batch.core.repository.JobRestartException;\r\nimport org.springframework.beans.BeansException;\r\nimport org.springframework.boot.SpringApplication;\r\nimport org.springframework.boot.autoconfigure.EnableAutoConfiguration;\r\nimport org.springframework.context.ConfigurableApplicationContext;\r\nimport org.springframework.context.annotation.ComponentScan;\r\nimport org.springframework.context.annotation.PropertySource;\r\nimport org.springframework.scheduling.annotation.EnableScheduling;\r\n\r\n@ComponentScan\r\n@EnableAutoConfiguration\r\n@PropertySource(&quot;file:application.properties&quot;)\r\n@EnableScheduling\r\npublic class Application {\r\n\tprivate static Log log = LogFactory.getLog(Application.class);\r\n\tpublic static void main(String[] args)\r\n\t\t\tthrows BeansException, JobExecutionAlreadyRunningException, JobRestartException,\r\n\t\t\tJobInstanceAlreadyCompleteException, JobParametersInvalidException, InterruptedException, IOException {\r\n\r\n\t\tSpringApplication app = new SpringApplication(Application.class);\r\n\t\tapp.setWebEnvironment(false);\r\n\t\tConfigurableApplicationContext ctx = app.run(args);\r\n\t\t\r\n\t\t Application application = ctx.getBean(Application.class);\r\n\t\t ConnectionValidator connectionValidator = ctx.getBean(ConnectionValidator.class);\r\n\t\t log.info(&quot;PP calling validation&quot;);\r\n\t\t connectionValidator.validateConnection();\r\n\t}\t\r\n\r\n}\r\n```\r\n\r\nBut it still gives the same jdbc error. Can someone tell me what can I do to fix this? I just want to reconnect when DB connection killed.  \r\nI&#39;m using postgres DB. And tried both&#160;**Apache Commons DBCP**&#160;and the HikariCP.","title":"How to setup spring project reconnect automatically after losing the jdbc connection","body":"<p>I have a project which is running in java 1.8 and spring 1.x, It runs finely without any errors. But I just want to handle the error happens when it loose the DB connection.</p>\n<p>I kill the process to test using sudo kill and then it give typical jdbc connection error.</p>\n<pre><code>Could not open JDBC Connection for transaction; nested exception is org.postgresql.util.PSQLException: FATAL: terminating connection due to administrator command\n    at org.springframework.jdbc.datasource.DataSourceTransactionManager.doBegin(DataSourceTransactionManager.java:242)\n</code></pre>\n<p>I want to handle this and want to reconnect the DB. I'm new to spring. And also this finely work after I restart the application. It again create jdbc connection and work finely.</p>\n<p>And this is the properties file</p>\n<pre><code>\nspring.batch.job.enabled=false\n\n# HikariCP configuration\nspring.datasource.type=com.zaxxer.hikari.HikariDataSource\nspring.datasource.hikari.connection-test-query=SELECT 1\nspring.datasource.hikari.maximum-pool-size=20 \nspring.datasource.hikari.idle-timeout=30000 \n\nspring.datasource.hikari.minimumIdle=5\nspring.datasource.hikari.maximumPoolSize=20\nspring.datasource.hikari.idleTimeout=30000\nspring.datasource.hikari.poolName=SpringBootJPAHikariCP\nspring.datasource.hikari.maxLifetime=2000000\nspring.datasource.hikari.connectionTimeout=30000\n\n# Database connection details\nspring.datasource.url=jdbc:postgresql://127.0.0.1:5432/octopus_retaildemo\nspring.datasource.driver-class-name=org.postgresql.Driver\nspring.datasource.username=retaildemo\nspring.datasource.password=demo\n#spring.jpa.database=default\n\nautocount.datasource.url=jdbc:postgresql://127.0.0.1:5432/aed_foroctopustestdata\nautocount.datasource.username=pasinduprabhath\nautocount.datasource.password=demo\nautocount.datasource.default_schema=public\nautocount.datasource.driver-class-name=org.postgresql.Driver\nspring.jpa.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect\nspring.jpa.hibernate.ddl-auto=none\nspring.jpa.show-sql=false\n\n\noctopus.directoryPath=/Users/pasinduprabhath/Documents/workspace-spring-tool-suite-4-4.19.1.RELEASE/Sentinal/reports\n\noctopus.testmode=0\noctopus.maxpoolsize=20\noctopus.terminal=HQ001\noctopus.location=HQ\noctopus.username=admin\n\noctopus.invjob.enabled=false\noctopus.invjob.attachzip=0\noctopus.invjob.time=1 * * * * *\n\noctopus.autocount.enabled=true\n\noctopus.autocount.salescsvread.enabled=false\noctopus.autocount.salescsvread.readtime=1 * * * * *\noctopus.autocount.salescsvread.salesfilename=POS Sales Transaction\noctopus.autocount.salescsvread.salesfilename.columns=dateTime,empty1,documentNo,itemCode,description,qty,unitPrice,gross,discount,subTotal,tax,totalEx,totalInc\n#octopus.autocount.salescsvread.paymentfilename=Sale Receipt by payment\noctopus.autocount.salescsvread.paymentfilename=Cash Receipt Report \noctopus.autocount.salescsvread.paymentfilename.columns=documentDate,documentNo,totalEx,tax,total,roundAdj,finalTotal,cashPayment,creditCardPayment,debitCardPayment,chequePayment,voucherPayment,pointPayment,creditPayment\noctopus.autocount.salescsvread.customerfilename=Customer Transaction\noctopus.autocount.salescsvread.customerfilename.columns=date,docNo,customerid,customerName,email\noctopus.autocount.salescsvread.hpenabled=false\n\npos.customer.point.job.enabled=false\npos.customer.point.job.time=1 * * * * *\nlogging.file=sentinal.log\nlogging.level.root=INFO\n\noctopus.autocount.readitemenabled=true\noctopus.autocount.readitemtable=1 * * * * *\n\noctopus.autocount.doreadenabled=false\noctopus.autocount.readdotable=1 * * * * *\n#octopus.autocount.readitemtable=0 0/1 * * * *\n\n# Reconnect properties\nspring.datasource.hikari.initialization-fail-fast=true\nspring.datasource.hikari.connection-init-sql=SELECT 1\n</code></pre>\n<p>I just tried with a class(ConnectionValidator class)</p>\n<pre><code>package com.octopus.services.common.network;\nimport org.apache.commons.logging.Log;\nimport org.apache.commons.logging.LogFactory;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.jdbc.core.JdbcTemplate;\nimport org.springframework.scheduling.annotation.Scheduled;\nimport org.springframework.stereotype.Component;\n\nimport com.Application;\n\nimport javax.sql.DataSource;\nimport java.sql.Connection;\nimport java.sql.SQLException;\n\n@Component\npublic class ConnectionValidator {\n\n    private final DataSource dataSource;\n    private int maxReconnectAttempts = 3; // Maximum number of reconnection attempts\n    private int reconnectAttemptInterval = 3000; // Interval between reconnection attempts in milliseconds\n    \n    @Autowired\n    public ConnectionValidator(DataSource dataSource) {\n        this.dataSource = dataSource;\n    }\n\n    @Scheduled(fixedRate = 50000) // Run every minute\n    public void validateConnection() {\n        try (Connection connection = dataSource.getConnection()) {\n            // Perform a simple query to validate the connection\n            JdbcTemplate jdbcTemplate = new JdbcTemplate(dataSource);\n            jdbcTemplate.queryForObject(&quot;SELECT 1&quot;, Integer.class);\n        } catch (SQLException e) {\n            // Handle the exception (e.g., attempt to reconnect)\n            if (isConnectionClosedException(e)) {\n                reconnect();\n            } else {\n                // Handle other types of SQLExceptions as needed\n                log.error(&quot;Error occurred during connection validation:&quot;, e);\n            }\n        }\n    }\n    \n    private boolean isConnectionClosedException(SQLException e) {\n        return e.getMessage() != null &amp;&amp; e.getMessage().contains(&quot;This connection has been closed&quot;);\n    }\n\n    private void handleReconnectionFailure() {\n        System.err.println(&quot;Failed to reconnect after max attempts. Performing custom action...&quot;);\n    }\n    \n    private void reconnect() {\n        int reconnectAttempts = 0;\n        while (reconnectAttempts &lt; maxReconnectAttempts) {\n            try {\n                Thread.sleep(reconnectAttemptInterval);\n                Connection connection = dataSource.getConnection();\n                if (connection.isValid(5)) { // Check if the reconnected connection is valid\n                    return;\n                }\n            } catch (SQLException | InterruptedException ex) {\n                log.error(&quot;Reconnection attempt failed:&quot;, ex);\n            }\n            reconnectAttempts++;\n        }\n        handleReconnectionFailure();\n    }\n}\n</code></pre>\n<p>like above and calling it in main. Here is the main,</p>\n<pre><code>package com;\n\nimport java.io.IOException;\nimport com.octopus.pos.utils.DatabaseManager;\nimport com.octopus.services.common.network.ConnectionValidator;\n\nimport org.apache.commons.logging.Log;\nimport org.apache.commons.logging.LogFactory;\nimport org.springframework.batch.core.JobParametersInvalidException;\nimport org.springframework.batch.core.repository.JobExecutionAlreadyRunningException;\nimport org.springframework.batch.core.repository.JobInstanceAlreadyCompleteException;\nimport org.springframework.batch.core.repository.JobRestartException;\nimport org.springframework.beans.BeansException;\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.EnableAutoConfiguration;\nimport org.springframework.context.ConfigurableApplicationContext;\nimport org.springframework.context.annotation.ComponentScan;\nimport org.springframework.context.annotation.PropertySource;\nimport org.springframework.scheduling.annotation.EnableScheduling;\n\n@ComponentScan\n@EnableAutoConfiguration\n@PropertySource(&quot;file:application.properties&quot;)\n@EnableScheduling\npublic class Application {\n    private static Log log = LogFactory.getLog(Application.class);\n    public static void main(String[] args)\n            throws BeansException, JobExecutionAlreadyRunningException, JobRestartException,\n            JobInstanceAlreadyCompleteException, JobParametersInvalidException, InterruptedException, IOException {\n\n        SpringApplication app = new SpringApplication(Application.class);\n        app.setWebEnvironment(false);\n        ConfigurableApplicationContext ctx = app.run(args);\n        \n         Application application = ctx.getBean(Application.class);\n         ConnectionValidator connectionValidator = ctx.getBean(ConnectionValidator.class);\n         log.info(&quot;PP calling validation&quot;);\n         connectionValidator.validateConnection();\n    }   \n\n}\n</code></pre>\n<p>But it still gives the same jdbc error. Can someone tell me what can I do to fix this? I just want to reconnect when DB connection killed.<br />\nI'm using postgres DB. And tried both<strong>Apache Commons DBCP</strong>and the HikariCP.</p>\n"},{"tags":["java","spring","spring-boot","spring-mvc","model-view-controller"],"answers":[{"tags":[],"owner":{"account_id":7313335,"reputation":4794,"user_id":5571795,"display_name":"Hezy Ziv"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695335920,"creation_date":1695335920,"answer_id":77154010,"question_id":77153899,"body_markdown":"use getAttribute \r\n\r\n    @Controller\r\n    public class SampleController1 {\r\n    \r\n        @GetMapping(&quot;/endpoint1&quot;)\r\n        public String handleRequest1(Model model) {\r\n            // You can access the shared attribute directly\r\n            String attrValue = (String) model.getAttribute(&quot;sharedAttribute&quot;);\r\n            // Do something with the attribute\r\n            return &quot;view1&quot;;\r\n        }\r\n    }","title":"How to share model attribute through controllers","body":"<p>use getAttribute</p>\n<pre><code>@Controller\npublic class SampleController1 {\n\n    @GetMapping(&quot;/endpoint1&quot;)\n    public String handleRequest1(Model model) {\n        // You can access the shared attribute directly\n        String attrValue = (String) model.getAttribute(&quot;sharedAttribute&quot;);\n        // Do something with the attribute\n        return &quot;view1&quot;;\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":24561597,"reputation":21,"user_id":18469257,"display_name":"alpha"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":28,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1695370085,"creation_date":1695334060,"question_id":77153899,"body_markdown":"I have three controllers for ordering tacos, either through a menu or design custom ones.\r\n\r\nThis is the menu controller, we can order pre-made taco and then it redirects to current order where it shows the tacos in the order made.\r\n```\r\n@Slf4j\r\n@Controller\r\n@RequestMapping(&quot;/menu&quot;)\r\n@SessionAttributes(&quot;tacoOrder&quot;)\r\npublic class MenuController {\r\n    private final PreMadeTacoRepository preMadeTacoRepository;\r\n    private final PreMadeTacoToTacoService preMadeTacoToTacoService;\r\n\r\n    public MenuController(PreMadeTacoRepository preMadeTacoRepository, PreMadeTacoToTacoService preMadeTacoToTacoService){\r\n        this.preMadeTacoRepository=preMadeTacoRepository;\r\n        this.preMadeTacoToTacoService=preMadeTacoToTacoService;\r\n    }\r\n\r\n    @GetMapping\r\n    public String getMenu(){\r\n        return &quot;menu&quot;;\r\n    }\r\n\r\n    @PostMapping\r\n    public String orderMenu(@Valid PreMadeTacoList preMadeTacoList, Errors errors,@ModelAttribute TacoOrder tacoOrder){\r\n        if(errors.hasErrors()){\r\n            return &quot;menu&quot;;\r\n        }\r\n        List&lt;Taco&gt; tacos = preMadeTacoToTacoService.convert(preMadeTacoList);\r\n        tacos.forEach(tacoOrder::addTaco);\r\n        if(tacos.size()==1){\r\n            log.info(&quot;Processing taco: {}&quot; , tacos);\r\n        }\r\n        else {\r\n            log.info(&quot;Processing tacos: {}&quot;,tacos);\r\n        }\r\n        return &quot;redirect:/orders/current&quot;;\r\n    }\r\n\r\n    @ModelAttribute\r\n    public void addTacoToModel(Model model){\r\n        Iterable&lt;PreMadeTaco&gt; tempo= preMadeTacoRepository.findAll();\r\n        List&lt;PreMadeTaco&gt; preMadeTacos = new ArrayList&lt;&gt;();\r\n        tempo.forEach(preMadeTacos::add);\r\n        model.addAttribute(&quot;preMadeTacos&quot;,preMadeTacos);\r\n    }\r\n\r\n    @ModelAttribute\r\n    public TacoOrder tacoOrder(){\r\n        return new TacoOrder();\r\n    }\r\n\r\n    @ModelAttribute\r\n    public PreMadeTaco preMadeTaco(){\r\n        return new PreMadeTaco();\r\n    }\r\n\r\n    @ModelAttribute\r\n    public PreMadeTacoList preMadeTacoList(){\r\n        return new PreMadeTacoList();\r\n    }\r\n}\r\n```\r\n\r\nThis is custom design controller, we can customize our own taco and it redirects similarly to current orders and it shows tacos in order\r\n```\r\n@Slf4j\r\n@Controller\r\n@RequestMapping(&quot;/design&quot;)\r\n@SessionAttributes(&quot;tacoOrder&quot;)\r\npublic class DesignTacoController {\r\n    private IngredientRepository ingredientRepository;\r\n\r\n    @Autowired\r\n    public DesignTacoController(IngredientRepository ingredientRepository){\r\n        this.ingredientRepository=ingredientRepository;\r\n    }\r\n\r\n    @GetMapping\r\n    public String showDesignForm() {\r\n        return &quot;design&quot;;\r\n    }\r\n\r\n    @PostMapping\r\n    public String processTaco(@Valid Taco taco,Errors errors, @ModelAttribute(&quot;tacoOrder&quot;) TacoOrder tacoOrder) {\r\n        if(errors.hasErrors()){\r\n            return &quot;design&quot;;\r\n        }\r\n        tacoOrder.addTaco(taco);\r\n        log.info(&quot;Processing taco: {}&quot;, taco);\r\n        return &quot;redirect:/orders/current&quot;;\r\n    }\r\n\r\n    @ModelAttribute\r\n    public void addIngredientsToModel(Model model){\r\n        Iterable&lt;Ingredient&gt; tempo = ingredientRepository.findAll();\r\n        List&lt;Ingredient&gt; ingredients = new ArrayList&lt;&gt;();\r\n        tempo.forEach(ingredients::add);\r\n        Ingredient.Type[] types = Ingredient.Type.values();\r\n        for(Ingredient.Type type: types){\r\n            model.addAttribute(type.toString().toLowerCase(),filterByType(ingredients , type));\r\n        }\r\n    }\r\n\r\n    @ModelAttribute(name = &quot;tacoOrder&quot;)\r\n    public TacoOrder order() {\r\n        return new TacoOrder();\r\n    }\r\n\r\n    @ModelAttribute(name = &quot;taco&quot;)\r\n    public Taco taco() {\r\n        return new Taco();\r\n    }\r\n\r\n    private Iterable&lt;Ingredient&gt; filterByType(\r\n            List&lt;Ingredient&gt; ingredients, Ingredient.Type type) {\r\n        return ingredients\r\n                .stream()\r\n                .filter(x -&gt; x.getType().equals(type))\r\n                .collect(Collectors.toList());\r\n    }\r\n}\r\n```\r\nThis is order class which shows current Order as it takes tacoOrder model attribute from session in either of them. The model with this class accepts one custom taco per request and a list of tacos from menu. (Ignore reviews they work fine)\r\n```\r\n@Slf4j\r\n@Controller\r\n@RequestMapping(&quot;/orders&quot;)\r\npublic class OrderController {\r\n    private final OrderRepository orderRepository;\r\n    private final ReviewRepository reviewRepository;\r\n\r\n    public OrderController(OrderRepository orderRepository, ReviewRepository reviewRepository){\r\n        this.orderRepository=orderRepository;\r\n        this.reviewRepository = reviewRepository;\r\n    }\r\n\r\n    @GetMapping\r\n    public String returnOrder(Model model){\r\n        return &quot;return&quot;;\r\n    }\r\n\r\n    @PostMapping\r\n    public String saveReview(@Valid Review review,Errors errors){\r\n        if(errors.hasErrors()){\r\n            return &quot;return&quot;;\r\n        }\r\n        reviewRepository.save(review);\r\n        log.info(&quot;Review saved:\\n By: &quot; + review.getUser().getFullName() + &quot;\\n Comment: &quot; + review.getComment()\r\n        + &quot;\\n Rating: &quot; + review.getRating());\r\n        return &quot;return&quot;;\r\n    }\r\n\r\n    @GetMapping(&quot;/current&quot;)\r\n    public String orderForm(@ModelAttribute(&quot;tacoOrder&quot;) TacoOrder tacoOrder){\r\n        return &quot;orderForm&quot;;\r\n    }\r\n\r\n    @PostMapping\r\n    public String processOrder(@Valid TacoOrder order, Errors errors, SessionStatus sessionStatus,\r\n                               @AuthenticationPrincipal User user, RedirectAttributes redirectAttributes) {\r\n        if(errors.hasErrors()){\r\n            return &quot;orderForm&quot;;\r\n        }\r\n        order.setUser(user);\r\n        TacoOrder tacoOrder = orderRepository.save(order);\r\n        user.addTacoOrder(order);\r\n        log.info(&quot;Order submitted: {}&quot;, tacoOrder);\r\n        redirectAttributes.addFlashAttribute(&quot;order&quot;,order);\r\n        sessionStatus.setComplete();\r\n        return &quot;redirect:/orders&quot;;\r\n    }\r\n\r\n    @ModelAttribute\r\n    public Review reviews(){\r\n        return new Review();\r\n    }\r\n\r\n    @ModelAttribute\r\n    public void addReviewsToModel(Model model){\r\n        Iterable&lt;Review&gt; tempo = reviewRepository.findAll();\r\n        List&lt;Review&gt; reviews = new ArrayList&lt;&gt;();\r\n        tempo.forEach(reviews::add);\r\n        model.addAttribute(&quot;reviews&quot;,reviews);\r\n    }\r\n}\r\n```\r\nIt all works fine if I just order from menu or design a custom one. However, I want to be able to add both custom and from menu in one Order.\r\n\r\nHow will SessionAttribute work as both names are same in design and menu? (Spring will make two instances of tacoOrder and I will have two orders as far as I can tell.) I thought of using a super class annotated with @SessionAttribute and it makes one instance of that model attribute and then remove that from menu and design. Please let me know how to fix this issue.","title":"How to share model attribute through controllers","body":"<p>I have three controllers for ordering tacos, either through a menu or design custom ones.</p>\n<p>This is the menu controller, we can order pre-made taco and then it redirects to current order where it shows the tacos in the order made.</p>\n<pre><code>@Slf4j\n@Controller\n@RequestMapping(&quot;/menu&quot;)\n@SessionAttributes(&quot;tacoOrder&quot;)\npublic class MenuController {\n    private final PreMadeTacoRepository preMadeTacoRepository;\n    private final PreMadeTacoToTacoService preMadeTacoToTacoService;\n\n    public MenuController(PreMadeTacoRepository preMadeTacoRepository, PreMadeTacoToTacoService preMadeTacoToTacoService){\n        this.preMadeTacoRepository=preMadeTacoRepository;\n        this.preMadeTacoToTacoService=preMadeTacoToTacoService;\n    }\n\n    @GetMapping\n    public String getMenu(){\n        return &quot;menu&quot;;\n    }\n\n    @PostMapping\n    public String orderMenu(@Valid PreMadeTacoList preMadeTacoList, Errors errors,@ModelAttribute TacoOrder tacoOrder){\n        if(errors.hasErrors()){\n            return &quot;menu&quot;;\n        }\n        List&lt;Taco&gt; tacos = preMadeTacoToTacoService.convert(preMadeTacoList);\n        tacos.forEach(tacoOrder::addTaco);\n        if(tacos.size()==1){\n            log.info(&quot;Processing taco: {}&quot; , tacos);\n        }\n        else {\n            log.info(&quot;Processing tacos: {}&quot;,tacos);\n        }\n        return &quot;redirect:/orders/current&quot;;\n    }\n\n    @ModelAttribute\n    public void addTacoToModel(Model model){\n        Iterable&lt;PreMadeTaco&gt; tempo= preMadeTacoRepository.findAll();\n        List&lt;PreMadeTaco&gt; preMadeTacos = new ArrayList&lt;&gt;();\n        tempo.forEach(preMadeTacos::add);\n        model.addAttribute(&quot;preMadeTacos&quot;,preMadeTacos);\n    }\n\n    @ModelAttribute\n    public TacoOrder tacoOrder(){\n        return new TacoOrder();\n    }\n\n    @ModelAttribute\n    public PreMadeTaco preMadeTaco(){\n        return new PreMadeTaco();\n    }\n\n    @ModelAttribute\n    public PreMadeTacoList preMadeTacoList(){\n        return new PreMadeTacoList();\n    }\n}\n</code></pre>\n<p>This is custom design controller, we can customize our own taco and it redirects similarly to current orders and it shows tacos in order</p>\n<pre><code>@Slf4j\n@Controller\n@RequestMapping(&quot;/design&quot;)\n@SessionAttributes(&quot;tacoOrder&quot;)\npublic class DesignTacoController {\n    private IngredientRepository ingredientRepository;\n\n    @Autowired\n    public DesignTacoController(IngredientRepository ingredientRepository){\n        this.ingredientRepository=ingredientRepository;\n    }\n\n    @GetMapping\n    public String showDesignForm() {\n        return &quot;design&quot;;\n    }\n\n    @PostMapping\n    public String processTaco(@Valid Taco taco,Errors errors, @ModelAttribute(&quot;tacoOrder&quot;) TacoOrder tacoOrder) {\n        if(errors.hasErrors()){\n            return &quot;design&quot;;\n        }\n        tacoOrder.addTaco(taco);\n        log.info(&quot;Processing taco: {}&quot;, taco);\n        return &quot;redirect:/orders/current&quot;;\n    }\n\n    @ModelAttribute\n    public void addIngredientsToModel(Model model){\n        Iterable&lt;Ingredient&gt; tempo = ingredientRepository.findAll();\n        List&lt;Ingredient&gt; ingredients = new ArrayList&lt;&gt;();\n        tempo.forEach(ingredients::add);\n        Ingredient.Type[] types = Ingredient.Type.values();\n        for(Ingredient.Type type: types){\n            model.addAttribute(type.toString().toLowerCase(),filterByType(ingredients , type));\n        }\n    }\n\n    @ModelAttribute(name = &quot;tacoOrder&quot;)\n    public TacoOrder order() {\n        return new TacoOrder();\n    }\n\n    @ModelAttribute(name = &quot;taco&quot;)\n    public Taco taco() {\n        return new Taco();\n    }\n\n    private Iterable&lt;Ingredient&gt; filterByType(\n            List&lt;Ingredient&gt; ingredients, Ingredient.Type type) {\n        return ingredients\n                .stream()\n                .filter(x -&gt; x.getType().equals(type))\n                .collect(Collectors.toList());\n    }\n}\n</code></pre>\n<p>This is order class which shows current Order as it takes tacoOrder model attribute from session in either of them. The model with this class accepts one custom taco per request and a list of tacos from menu. (Ignore reviews they work fine)</p>\n<pre><code>@Slf4j\n@Controller\n@RequestMapping(&quot;/orders&quot;)\npublic class OrderController {\n    private final OrderRepository orderRepository;\n    private final ReviewRepository reviewRepository;\n\n    public OrderController(OrderRepository orderRepository, ReviewRepository reviewRepository){\n        this.orderRepository=orderRepository;\n        this.reviewRepository = reviewRepository;\n    }\n\n    @GetMapping\n    public String returnOrder(Model model){\n        return &quot;return&quot;;\n    }\n\n    @PostMapping\n    public String saveReview(@Valid Review review,Errors errors){\n        if(errors.hasErrors()){\n            return &quot;return&quot;;\n        }\n        reviewRepository.save(review);\n        log.info(&quot;Review saved:\\n By: &quot; + review.getUser().getFullName() + &quot;\\n Comment: &quot; + review.getComment()\n        + &quot;\\n Rating: &quot; + review.getRating());\n        return &quot;return&quot;;\n    }\n\n    @GetMapping(&quot;/current&quot;)\n    public String orderForm(@ModelAttribute(&quot;tacoOrder&quot;) TacoOrder tacoOrder){\n        return &quot;orderForm&quot;;\n    }\n\n    @PostMapping\n    public String processOrder(@Valid TacoOrder order, Errors errors, SessionStatus sessionStatus,\n                               @AuthenticationPrincipal User user, RedirectAttributes redirectAttributes) {\n        if(errors.hasErrors()){\n            return &quot;orderForm&quot;;\n        }\n        order.setUser(user);\n        TacoOrder tacoOrder = orderRepository.save(order);\n        user.addTacoOrder(order);\n        log.info(&quot;Order submitted: {}&quot;, tacoOrder);\n        redirectAttributes.addFlashAttribute(&quot;order&quot;,order);\n        sessionStatus.setComplete();\n        return &quot;redirect:/orders&quot;;\n    }\n\n    @ModelAttribute\n    public Review reviews(){\n        return new Review();\n    }\n\n    @ModelAttribute\n    public void addReviewsToModel(Model model){\n        Iterable&lt;Review&gt; tempo = reviewRepository.findAll();\n        List&lt;Review&gt; reviews = new ArrayList&lt;&gt;();\n        tempo.forEach(reviews::add);\n        model.addAttribute(&quot;reviews&quot;,reviews);\n    }\n}\n</code></pre>\n<p>It all works fine if I just order from menu or design a custom one. However, I want to be able to add both custom and from menu in one Order.</p>\n<p>How will SessionAttribute work as both names are same in design and menu? (Spring will make two instances of tacoOrder and I will have two orders as far as I can tell.) I thought of using a super class annotated with @SessionAttribute and it makes one instance of that model attribute and then remove that from menu and design. Please let me know how to fix this issue.</p>\n"},{"tags":["java","spring-boot","maven","cucumber"],"comments":[{"owner":{"account_id":4895787,"reputation":10833,"user_id":3945473,"display_name":"M.P. Korstanje"},"score":0,"creation_date":1695327257,"post_id":77148272,"comment_id":136013407,"body_markdown":"What is the full stacktrace?","body":"What is the full stacktrace?"},{"owner":{"account_id":10633773,"reputation":123,"user_id":7831061,"display_name":"Aditya Abinash"},"score":0,"creation_date":1695369719,"post_id":77148272,"comment_id":136017945,"body_markdown":"I have added the full stacktrace to the post.","body":"I have added the full stacktrace to the post."},{"owner":{"account_id":4895787,"reputation":10833,"user_id":3945473,"display_name":"M.P. Korstanje"},"score":1,"creation_date":1695372295,"post_id":77148272,"comment_id":136018378,"body_markdown":"Looks like you&#39;re not correctly assembling your executable jar file. You need to merge the files from `META-INF/services`. See https://stackoverflow.com/questions/47310215/merging-meta-inf-services-files-with-maven-assembly-plugin","body":"Looks like you&#39;re not correctly assembling your executable jar file. You need to merge the files from <code>META-INF&#47;services</code>. See <a href=\"https://stackoverflow.com/questions/47310215/merging-meta-inf-services-files-with-maven-assembly-plugin\" title=\"merging meta inf services files with maven assembly plugin\">stackoverflow.com/questions/47310215/&hellip;</a>"},{"owner":{"account_id":10633773,"reputation":123,"user_id":7831061,"display_name":"Aditya Abinash"},"score":0,"creation_date":1695497487,"post_id":77148272,"comment_id":136033407,"body_markdown":"Thanks, @M.P.Korstanje for looking into this, but this still doesn&#39;t work for me.","body":"Thanks, @M.P.Korstanje for looking into this, but this still doesn&#39;t work for me."},{"owner":{"account_id":4895787,"reputation":10833,"user_id":3945473,"display_name":"M.P. Korstanje"},"score":0,"creation_date":1695505673,"post_id":77148272,"comment_id":136034121,"body_markdown":"Did you verify that the contents of `META-INF/services` is correct?","body":"Did you verify that the contents of <code>META-INF&#47;services</code> is correct?"},{"owner":{"account_id":10633773,"reputation":123,"user_id":7831061,"display_name":"Aditya Abinash"},"score":0,"creation_date":1696191626,"post_id":77148272,"comment_id":136118756,"body_markdown":"Yes, I see a lot of new classes being added in spring.factories, and I also see\n\n&quot;&quot;&quot;# PropertySource Loaders\norg.springframework.boot.env.PropertySourceLoader=\\\norg.springframework.boot.env.PropertiesPropertySourceLoader,\\\norg.springframework.boot.env.YamlPropertySourceLoader&quot;&quot;&quot;\n\nBut it still doesn&#39;t work.","body":"Yes, I see a lot of new classes being added in spring.factories, and I also see  &quot;&quot;&quot;# PropertySource Loaders org.springframework.boot.env.PropertySourceLoader=\\ org.springframework.boot.env.PropertiesPropertySourceLoader,&zwnj;&#8203;\\ org.springframework.boot.env.YamlPropertySourceLoader&quot;&quot;&quot;  But it still doesn&#39;t work."},{"owner":{"account_id":4895787,"reputation":10833,"user_id":3945473,"display_name":"M.P. Korstanje"},"score":0,"creation_date":1696204448,"post_id":77148272,"comment_id":136119826,"body_markdown":"Seeing lots of classes being added does not mean that what is being added is correct. These files must be merged - not overwritten.","body":"Seeing lots of classes being added does not mean that what is being added is correct. These files must be merged - not overwritten."},{"owner":{"account_id":10633773,"reputation":123,"user_id":7831061,"display_name":"Aditya Abinash"},"score":0,"creation_date":1696271445,"post_id":77148272,"comment_id":136129052,"body_markdown":"I&#39;m not sure what I should be looking for. Could you please provide me with some links to documentation related to this stuff?\nI&#39;ve never worked on this part of Spring.","body":"I&#39;m not sure what I should be looking for. Could you please provide me with some links to documentation related to this stuff? I&#39;ve never worked on this part of Spring."},{"owner":{"account_id":4895787,"reputation":10833,"user_id":3945473,"display_name":"M.P. Korstanje"},"score":0,"creation_date":1696280208,"post_id":77148272,"comment_id":136130529,"body_markdown":"You are merging multiple jar files into one. Some files in the jars may have identical names but different content. This content should be merged. You should be looking for a effect called clobbering.  https://en.m.wikipedia.org/wiki/Clobbering","body":"You are merging multiple jar files into one. Some files in the jars may have identical names but different content. This content should be merged. You should be looking for a effect called clobbering.  <a href=\"https://en.m.wikipedia.org/wiki/Clobbering\" rel=\"nofollow noreferrer\">en.m.wikipedia.org/wiki/Clobbering</a>"},{"owner":{"account_id":4895787,"reputation":10833,"user_id":3945473,"display_name":"M.P. Korstanje"},"score":0,"creation_date":1696280287,"post_id":77148272,"comment_id":136130545,"body_markdown":"If you are not familiar with how Jar files are structured then consider using the Spring Boot Maven plugin to create a jar file for you. https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#build-tool-plugins.maven This will package the jar in a way that is supported and understood by Spring. It has it&#39;s limitations, Cucumber only understands it partially. But if you have only a single module, it should be fine.","body":"If you are not familiar with how Jar files are structured then consider using the Spring Boot Maven plugin to create a jar file for you. <a href=\"https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#build-tool-plugins.maven\" rel=\"nofollow noreferrer\">docs.spring.io/spring-boot/docs/current/reference/htmlsingle&zwnj;&#8203;/&hellip;</a> This will package the jar in a way that is supported and understood by Spring. It has it&#39;s limitations, Cucumber only understands it partially. But if you have only a single module, it should be fine."},{"owner":{"account_id":10633773,"reputation":123,"user_id":7831061,"display_name":"Aditya Abinash"},"score":0,"creation_date":1696348797,"post_id":77148272,"comment_id":136140002,"body_markdown":"Thanks @M.P.Korstanje, I&#39;ll have a look.","body":"Thanks @M.P.Korstanje, I&#39;ll have a look."}],"owner":{"account_id":10633773,"reputation":123,"user_id":7831061,"display_name":"Aditya Abinash"},"comment_count":11,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":132,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1695369702,"creation_date":1695283277,"question_id":77148272,"body_markdown":"I have a requirement to run the Software Qualification Tests of my project as an **executable JAR**. I&#39;m using *Cucumber* along with *SpringBootTests* for the tests and used *maven-assembly-plugin* to create the executable JAR.\r\nI have created a sample project ([link][1] to GitHub) where I have implemented what I want to do. \r\n\r\nIn the project, I am able to:\r\n\r\n 1. Execute ```CucumberMainTest```, which is simple runner that can be executed from an IDE\r\n```\r\nimport io.cucumber.junit.Cucumber;\r\nimport io.cucumber.junit.CucumberOptions;\r\nimport org.junit.runner.RunWith;\r\n\r\n@RunWith(Cucumber.class)\r\n@CucumberOptions(\r\n    features = &quot;src/test/resources/features&quot;,\r\n    glue = &quot;example/cucumberspringexecutabletests/steps&quot;)\r\npublic class CucumberMainTest {\r\n}\r\n```\r\n\r\n2. Execute ```MainTest``` from the IDE, which is the *main* class\r\n```\r\nimport io.cucumber.core.cli.Main;\r\n\r\npublic class MainTest {\r\n\r\n    public static void main(String[] args) {\r\n        String[] defaultArgs = {\r\n            &quot;--glue&quot;, &quot;example/cucumberspringexecutabletests/steps&quot;,\r\n            &quot;classpath:features&quot;,\r\n            &quot;--plugin&quot;, &quot;pretty&quot;\r\n        };\r\n\r\n        Main.main(defaultArgs);\r\n    }\r\n}\r\n```\r\n\r\nBut, I&#39;m not able to achieve my main goal of executing the *main* class from an executable JAR. When I try to execute the JAR, after packaging, I get an error.\r\n\r\nCommand used:\r\n```\r\njava -jar .\\target\\cucumber-spring-executable-tests-3.1.3-test-jar-with-dependencies.jar\r\n```\r\nError:\r\n```\r\nScenario: As a developer, I want to run an executable test jar # features/spring.feature:3\r\n  Given the test jar is built                                  # example.cucumberspringexecutabletests.steps.MyStepDefs.MyStepDefs()                              \r\n      io.cucumber.core.exception.CucumberException: class example.cucumberspringexecutabletests.steps.MyStepDefs does not have a public zero-argument constructor.\r\n                                                                                                                                                                  \r\nTo use dependency injection add an other ObjectFactory implementation such as:                                                                                    \r\n * cucumber-picocontainer                                                                                                                                         \r\n * cucumber-spring                                                                                                                                                \r\n * cucumber-jakarta-cdi                                                                                                                                           \r\n * ...etc                                                                                                                                                         \r\n\r\n        at io.cucumber.core.backend.DefaultObjectFactory.cacheNewInstance(DefaultObjectFactory.java:57)\r\n        at io.cucumber.core.backend.DefaultObjectFactory.getInstance(DefaultObjectFactory.java:45)\r\n        at io.cucumber.java.AbstractGlueDefinition.invokeMethod(AbstractGlueDefinition.java:47)\r\n        at io.cucumber.java.JavaStepDefinition.execute(JavaStepDefinition.java:29)\r\n        at io.cucumber.core.runner.CoreStepDefinition.execute(CoreStepDefinition.java:66)\r\n        at io.cucumber.core.runner.PickleStepDefinitionMatch.runStep(PickleStepDefinitionMatch.java:63)\r\n        at io.cucumber.core.runner.ExecutionMode$1.execute(ExecutionMode.java:10)\r\n        at io.cucumber.core.runner.TestStep.executeStep(TestStep.java:84)\r\n        at io.cucumber.core.runner.TestStep.run(TestStep.java:56)\r\n        at io.cucumber.core.runner.PickleStepTestStep.run(PickleStepTestStep.java:51)\r\n        at io.cucumber.core.runner.TestCase.run(TestCase.java:84)\r\n        at io.cucumber.core.runner.Runner.runPickle(Runner.java:75)\r\n        at io.cucumber.core.runtime.Runtime.lambda$executePickle$6(Runtime.java:107)\r\n        at io.cucumber.core.runtime.CucumberExecutionContext.lambda$runTestCase$5(CucumberExecutionContext.java:137)\r\n        at io.cucumber.core.runtime.RethrowingThrowableCollector.executeAndThrow(RethrowingThrowableCollector.java:23)\r\n        at io.cucumber.core.runtime.CucumberExecutionContext.runTestCase(CucumberExecutionContext.java:137)\r\n        at io.cucumber.core.runtime.Runtime.lambda$executePickle$7(Runtime.java:107)\r\n        at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)\r\n        at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\r\n        at io.cucumber.core.runtime.Runtime$SameThreadExecutorService.execute(Runtime.java:235)\r\n        at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:123)\r\n        at io.cucumber.core.runtime.Runtime.lambda$runFeatures$3(Runtime.java:89)\r\n        at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197)\r\n        at java.base/java.util.stream.SliceOps$1$1.accept(SliceOps.java:200)\r\n        at java.base/java.util.ArrayList$ArrayListSpliterator.tryAdvance(ArrayList.java:1602)\r\n        at java.base/java.util.stream.ReferencePipeline.forEachWithCancel(ReferencePipeline.java:129)\r\n        at java.base/java.util.stream.AbstractPipeline.copyIntoWithCancel(AbstractPipeline.java:527)\r\n        at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:513)\r\n        at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)\r\n        at java.base/java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:921)\r\n        at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)\r\n        at java.base/java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:682)\r\n        at io.cucumber.core.runtime.Runtime.runFeatures(Runtime.java:90)\r\n        at io.cucumber.core.runtime.Runtime.lambda$run$0(Runtime.java:78)\r\n        at io.cucumber.core.runtime.CucumberExecutionContext.lambda$runFeatures$6(CucumberExecutionContext.java:148)\r\n        at io.cucumber.core.runtime.CucumberExecutionContext.execute(CucumberExecutionContext.java:163)\r\n        at io.cucumber.core.runtime.CucumberExecutionContext.runFeatures(CucumberExecutionContext.java:146)\r\n        at io.cucumber.core.runtime.Runtime.run(Runtime.java:78)\r\n        at io.cucumber.core.cli.Main.run(Main.java:87)\r\n        at io.cucumber.core.cli.Main.main(Main.java:30)\r\n        at example.cucumberspringexecutabletests.MainTest.main(MainTest.java:14)\r\nCaused by: java.lang.NoSuchMethodException: example.cucumberspringexecutabletests.steps.MyStepDefs.&lt;init&gt;()\r\n        at java.base/java.lang.Class.getConstructor0(Class.java:3585)\r\n        at java.base/java.lang.Class.getConstructor(Class.java:2271)\r\n        at io.cucumber.core.backend.DefaultObjectFactory.cacheNewInstance(DefaultObjectFactory.java:52)\r\n        ... 40 more\r\n\r\n  When the test jar is executed                                # example.cucumberspringexecutabletests.steps.MyStepDefs.when()\r\n  Then the test jar prints &quot;Hello World&quot;                       # example.cucumberspringexecutabletests.steps.MyStepDefs.then()\r\n\r\nFailed scenarios:\r\nclasspath:features/spring.feature:3 # As a developer, I want to run an executable test jar\r\n\r\n1 Scenarios (1 failed)\r\n3 Steps (1 failed, 2 skipped)\r\n0m0.183s\r\n\r\n\r\nio.cucumber.core.exception.CucumberException: class example.cucumberspringexecutabletests.steps.MyStepDefs does not have a public zero-argument constructor.\r\n\r\nTo use dependency injection add an other ObjectFactory implementation such as:\r\n * cucumber-picocontainer\r\n * cucumber-spring\r\n * cucumber-jakarta-cdi\r\n * ...etc\r\n        at io.cucumber.core.runtime.Runtime.lambda$run$0(Runtime.java:78)\r\n        at io.cucumber.core.runtime.CucumberExecutionContext.lambda$runFeatures$6(CucumberExecutionContext.java:148)\r\n        at io.cucumber.core.runtime.CucumberExecutionContext.execute(CucumberExecutionContext.java:163)\r\n        at io.cucumber.core.runtime.CucumberExecutionContext.runFeatures(CucumberExecutionContext.java:146)\r\n        at io.cucumber.core.runtime.Runtime.run(Runtime.java:78)\r\n        at io.cucumber.core.cli.Main.run(Main.java:87)\r\n        at io.cucumber.core.cli.Main.main(Main.java:30)\r\n        at example.cucumberspringexecutabletests.MainTest.main(MainTest.java:14)\r\nCaused by: java.lang.NoSuchMethodException: example.cucumberspringexecutabletests.steps.MyStepDefs.&lt;init&gt;()\r\n        at java.base/java.lang.Class.getConstructor0(Class.java:3585)\r\n        at java.base/java.lang.Class.getConstructor(Class.java:2271)\r\n        at io.cucumber.core.backend.DefaultObjectFactory.cacheNewInstance(DefaultObjectFactory.java:52)\r\n        ... 40 more\r\n```\r\n\r\nIt seems like the Spring context is not getting initialized/invoked. I looked into the following links to reach this point but looks like some configuration is still missing:\r\n\r\n - [Running Cucumber from command line][2]\r\n\r\n - [Running spring tests from executable jar][3]\r\n\r\n\r\nRight now the only way it works using the executable JAR is to remove any Autowiring.\r\n\r\n\r\n\r\n  [1]: https://github.com/AdityaAbinash-TomTom/cucumber-spring-executable-tests\r\n  [2]: https://cucumber.io/docs/cucumber/api/?lang=java#running-cucumber\r\n  [3]: https://stackoverflow.com/questions/52188683/running-spring-tests-from-executable-jar","title":"Running Cucumber + SpringBootTest in an executable test JAR","body":"<p>I have a requirement to run the Software Qualification Tests of my project as an <strong>executable JAR</strong>. I'm using <em>Cucumber</em> along with <em>SpringBootTests</em> for the tests and used <em>maven-assembly-plugin</em> to create the executable JAR.\nI have created a sample project (<a href=\"https://github.com/AdityaAbinash-TomTom/cucumber-spring-executable-tests\" rel=\"nofollow noreferrer\">link</a> to GitHub) where I have implemented what I want to do.</p>\n<p>In the project, I am able to:</p>\n<ol>\n<li>Execute <code>CucumberMainTest</code>, which is simple runner that can be executed from an IDE</li>\n</ol>\n<pre><code>import io.cucumber.junit.Cucumber;\nimport io.cucumber.junit.CucumberOptions;\nimport org.junit.runner.RunWith;\n\n@RunWith(Cucumber.class)\n@CucumberOptions(\n    features = &quot;src/test/resources/features&quot;,\n    glue = &quot;example/cucumberspringexecutabletests/steps&quot;)\npublic class CucumberMainTest {\n}\n</code></pre>\n<ol start=\"2\">\n<li>Execute <code>MainTest</code> from the IDE, which is the <em>main</em> class</li>\n</ol>\n<pre><code>import io.cucumber.core.cli.Main;\n\npublic class MainTest {\n\n    public static void main(String[] args) {\n        String[] defaultArgs = {\n            &quot;--glue&quot;, &quot;example/cucumberspringexecutabletests/steps&quot;,\n            &quot;classpath:features&quot;,\n            &quot;--plugin&quot;, &quot;pretty&quot;\n        };\n\n        Main.main(defaultArgs);\n    }\n}\n</code></pre>\n<p>But, I'm not able to achieve my main goal of executing the <em>main</em> class from an executable JAR. When I try to execute the JAR, after packaging, I get an error.</p>\n<p>Command used:</p>\n<pre><code>java -jar .\\target\\cucumber-spring-executable-tests-3.1.3-test-jar-with-dependencies.jar\n</code></pre>\n<p>Error:</p>\n<pre><code>Scenario: As a developer, I want to run an executable test jar # features/spring.feature:3\n  Given the test jar is built                                  # example.cucumberspringexecutabletests.steps.MyStepDefs.MyStepDefs()                              \n      io.cucumber.core.exception.CucumberException: class example.cucumberspringexecutabletests.steps.MyStepDefs does not have a public zero-argument constructor.\n                                                                                                                                                                  \nTo use dependency injection add an other ObjectFactory implementation such as:                                                                                    \n * cucumber-picocontainer                                                                                                                                         \n * cucumber-spring                                                                                                                                                \n * cucumber-jakarta-cdi                                                                                                                                           \n * ...etc                                                                                                                                                         \n\n        at io.cucumber.core.backend.DefaultObjectFactory.cacheNewInstance(DefaultObjectFactory.java:57)\n        at io.cucumber.core.backend.DefaultObjectFactory.getInstance(DefaultObjectFactory.java:45)\n        at io.cucumber.java.AbstractGlueDefinition.invokeMethod(AbstractGlueDefinition.java:47)\n        at io.cucumber.java.JavaStepDefinition.execute(JavaStepDefinition.java:29)\n        at io.cucumber.core.runner.CoreStepDefinition.execute(CoreStepDefinition.java:66)\n        at io.cucumber.core.runner.PickleStepDefinitionMatch.runStep(PickleStepDefinitionMatch.java:63)\n        at io.cucumber.core.runner.ExecutionMode$1.execute(ExecutionMode.java:10)\n        at io.cucumber.core.runner.TestStep.executeStep(TestStep.java:84)\n        at io.cucumber.core.runner.TestStep.run(TestStep.java:56)\n        at io.cucumber.core.runner.PickleStepTestStep.run(PickleStepTestStep.java:51)\n        at io.cucumber.core.runner.TestCase.run(TestCase.java:84)\n        at io.cucumber.core.runner.Runner.runPickle(Runner.java:75)\n        at io.cucumber.core.runtime.Runtime.lambda$executePickle$6(Runtime.java:107)\n        at io.cucumber.core.runtime.CucumberExecutionContext.lambda$runTestCase$5(CucumberExecutionContext.java:137)\n        at io.cucumber.core.runtime.RethrowingThrowableCollector.executeAndThrow(RethrowingThrowableCollector.java:23)\n        at io.cucumber.core.runtime.CucumberExecutionContext.runTestCase(CucumberExecutionContext.java:137)\n        at io.cucumber.core.runtime.Runtime.lambda$executePickle$7(Runtime.java:107)\n        at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)\n        at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\n        at io.cucumber.core.runtime.Runtime$SameThreadExecutorService.execute(Runtime.java:235)\n        at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:123)\n        at io.cucumber.core.runtime.Runtime.lambda$runFeatures$3(Runtime.java:89)\n        at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197)\n        at java.base/java.util.stream.SliceOps$1$1.accept(SliceOps.java:200)\n        at java.base/java.util.ArrayList$ArrayListSpliterator.tryAdvance(ArrayList.java:1602)\n        at java.base/java.util.stream.ReferencePipeline.forEachWithCancel(ReferencePipeline.java:129)\n        at java.base/java.util.stream.AbstractPipeline.copyIntoWithCancel(AbstractPipeline.java:527)\n        at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:513)\n        at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)\n        at java.base/java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:921)\n        at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)\n        at java.base/java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:682)\n        at io.cucumber.core.runtime.Runtime.runFeatures(Runtime.java:90)\n        at io.cucumber.core.runtime.Runtime.lambda$run$0(Runtime.java:78)\n        at io.cucumber.core.runtime.CucumberExecutionContext.lambda$runFeatures$6(CucumberExecutionContext.java:148)\n        at io.cucumber.core.runtime.CucumberExecutionContext.execute(CucumberExecutionContext.java:163)\n        at io.cucumber.core.runtime.CucumberExecutionContext.runFeatures(CucumberExecutionContext.java:146)\n        at io.cucumber.core.runtime.Runtime.run(Runtime.java:78)\n        at io.cucumber.core.cli.Main.run(Main.java:87)\n        at io.cucumber.core.cli.Main.main(Main.java:30)\n        at example.cucumberspringexecutabletests.MainTest.main(MainTest.java:14)\nCaused by: java.lang.NoSuchMethodException: example.cucumberspringexecutabletests.steps.MyStepDefs.&lt;init&gt;()\n        at java.base/java.lang.Class.getConstructor0(Class.java:3585)\n        at java.base/java.lang.Class.getConstructor(Class.java:2271)\n        at io.cucumber.core.backend.DefaultObjectFactory.cacheNewInstance(DefaultObjectFactory.java:52)\n        ... 40 more\n\n  When the test jar is executed                                # example.cucumberspringexecutabletests.steps.MyStepDefs.when()\n  Then the test jar prints &quot;Hello World&quot;                       # example.cucumberspringexecutabletests.steps.MyStepDefs.then()\n\nFailed scenarios:\nclasspath:features/spring.feature:3 # As a developer, I want to run an executable test jar\n\n1 Scenarios (1 failed)\n3 Steps (1 failed, 2 skipped)\n0m0.183s\n\n\nio.cucumber.core.exception.CucumberException: class example.cucumberspringexecutabletests.steps.MyStepDefs does not have a public zero-argument constructor.\n\nTo use dependency injection add an other ObjectFactory implementation such as:\n * cucumber-picocontainer\n * cucumber-spring\n * cucumber-jakarta-cdi\n * ...etc\n        at io.cucumber.core.runtime.Runtime.lambda$run$0(Runtime.java:78)\n        at io.cucumber.core.runtime.CucumberExecutionContext.lambda$runFeatures$6(CucumberExecutionContext.java:148)\n        at io.cucumber.core.runtime.CucumberExecutionContext.execute(CucumberExecutionContext.java:163)\n        at io.cucumber.core.runtime.CucumberExecutionContext.runFeatures(CucumberExecutionContext.java:146)\n        at io.cucumber.core.runtime.Runtime.run(Runtime.java:78)\n        at io.cucumber.core.cli.Main.run(Main.java:87)\n        at io.cucumber.core.cli.Main.main(Main.java:30)\n        at example.cucumberspringexecutabletests.MainTest.main(MainTest.java:14)\nCaused by: java.lang.NoSuchMethodException: example.cucumberspringexecutabletests.steps.MyStepDefs.&lt;init&gt;()\n        at java.base/java.lang.Class.getConstructor0(Class.java:3585)\n        at java.base/java.lang.Class.getConstructor(Class.java:2271)\n        at io.cucumber.core.backend.DefaultObjectFactory.cacheNewInstance(DefaultObjectFactory.java:52)\n        ... 40 more\n</code></pre>\n<p>It seems like the Spring context is not getting initialized/invoked. I looked into the following links to reach this point but looks like some configuration is still missing:</p>\n<ul>\n<li><p><a href=\"https://cucumber.io/docs/cucumber/api/?lang=java#running-cucumber\" rel=\"nofollow noreferrer\">Running Cucumber from command line</a></p>\n</li>\n<li><p><a href=\"https://stackoverflow.com/questions/52188683/running-spring-tests-from-executable-jar\">Running spring tests from executable jar</a></p>\n</li>\n</ul>\n<p>Right now the only way it works using the executable JAR is to remove any Autowiring.</p>\n"},{"tags":["java","android","android-activity","android-button","back"],"comments":[{"owner":{"account_id":6017569,"reputation":3366,"user_id":8007341,"display_name":"Kishan Maurya"},"score":0,"creation_date":1695365748,"post_id":77155314,"comment_id":136017206,"body_markdown":"Back arrow, its device back button or your custom arrow button? Can you share code for back click on Activity B?","body":"Back arrow, its device back button or your custom arrow button? Can you share code for back click on Activity B?"},{"owner":{"account_id":4851581,"reputation":2569,"user_id":3913732,"accept_rate":53,"display_name":"Sudheesh Mohan"},"score":0,"creation_date":1695365806,"post_id":77155314,"comment_id":136017215,"body_markdown":"Post the code for moving from Activity A to B. You might be starting Activity B 2 times.","body":"Post the code for moving from Activity A to B. You might be starting Activity B 2 times."},{"owner":{"account_id":20866182,"reputation":114,"user_id":15327167,"display_name":"Saif Khan"},"score":0,"creation_date":1695366040,"post_id":77155314,"comment_id":136017247,"body_markdown":"Use the finish() method to finish the current activity when you want to navigate back to the previous activity. This will remove the current activity from the back button stack and ensure that the back button will navigate back to the previous activity.\n@Override\npublic void onBackPressed() {\n    super.onBackPressed();\n\n    // Finish the current activity to navigate back to the previous activity.\n    finish();\n}","body":"Use the finish() method to finish the current activity when you want to navigate back to the previous activity. This will remove the current activity from the back button stack and ensure that the back button will navigate back to the previous activity. @Override public void onBackPressed() {     super.onBackPressed();      // Finish the current activity to navigate back to the previous activity.     finish(); }"},{"owner":{"account_id":2647431,"reputation":9890,"user_id":2289835,"accept_rate":38,"display_name":"Rumit Patel"},"score":0,"creation_date":1695367003,"post_id":77155314,"comment_id":136017445,"body_markdown":"May be ActivityB is opening twice.","body":"May be ActivityB is opening twice."},{"owner":{"account_id":27318490,"reputation":1,"user_id":20832625,"display_name":"Nayana Petkar"},"score":0,"creation_date":1695368671,"post_id":77155314,"comment_id":136017765,"body_markdown":"I am using my custom back arrow. For back click, I am using onBackPressed mentioned in my question","body":"I am using my custom back arrow. For back click, I am using onBackPressed mentioned in my question"},{"owner":{"account_id":402229,"reputation":93994,"user_id":769265,"display_name":"David Wasser"},"score":0,"creation_date":1695908126,"post_id":77155314,"comment_id":136088680,"body_markdown":"Sounds strange. Please edit your question and post your manifest.","body":"Sounds strange. Please edit your question and post your manifest."},{"owner":{"account_id":402229,"reputation":93994,"user_id":769265,"display_name":"David Wasser"},"score":0,"creation_date":1695908213,"post_id":77155314,"comment_id":136088698,"body_markdown":"Your code for `onBackPressed()` makes no sense and basically does nothing. It just calls the default implementation of `onBackPressed()` in the super class, which calls `finish()` on the current `Activity`. If you remove this code, the effect is the same, as the default implementation of `onBackPressed()` will be called when the BACK button is tapped.","body":"Your code for <code>onBackPressed()</code> makes no sense and basically does nothing. It just calls the default implementation of <code>onBackPressed()</code> in the super class, which calls <code>finish()</code> on the current <code>Activity</code>. If you remove this code, the effect is the same, as the default implementation of <code>onBackPressed()</code> will be called when the BACK button is tapped."}],"answers":[{"tags":[],"owner":{"account_id":21741636,"reputation":1166,"user_id":16048914,"display_name":"David Weber"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695368250,"creation_date":1695368250,"answer_id":77155676,"question_id":77155314,"body_markdown":"You need to define the parent Activity of your Activity in your Manifest and get lost of the onBackPressed method:\r\n\r\n    &lt;activity\r\n        android:name=&quot;.BActivity&quot;\r\n        android:parentActivityName=&quot;.AActivity&quot;&gt;\r\n        &lt;meta-data\r\n            android:name=&quot;android.support.PARENT_ACTIVITY&quot;\r\n            android:value=&quot;.AActivity&quot;/&gt;\r\n    &lt;/activity&gt;\r\n\r\nThat is how it is done.","title":"Need to click back arrow twice to go back to previous activity, how to prevent it","body":"<p>You need to define the parent Activity of your Activity in your Manifest and get lost of the onBackPressed method:</p>\n<pre><code>&lt;activity\n    android:name=&quot;.BActivity&quot;\n    android:parentActivityName=&quot;.AActivity&quot;&gt;\n    &lt;meta-data\n        android:name=&quot;android.support.PARENT_ACTIVITY&quot;\n        android:value=&quot;.AActivity&quot;/&gt;\n&lt;/activity&gt;\n</code></pre>\n<p>That is how it is done.</p>\n"}],"owner":{"account_id":27318490,"reputation":1,"user_id":20832625,"display_name":"Nayana Petkar"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":29,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1695369632,"creation_date":1695364357,"question_id":77155314,"body_markdown":"I have one activity A and when I click on one button from activity A and come to an another activity B and when I click on back arrow from activity B to go back to A, its comes to the same activity B, so I need to click the back arrow again to go back and when I click on second time, it works.\r\n\r\nI have used below approach.\r\n\r\n    @Override\r\n    public void onBackPressed() {\r\n        super.onBackPressed();\r\n    }\r\n\r\nI have also used onKeyDown() approach. But it does not work, its comes to the same activity B, so I need to click the back arrow again to go back to previous activity.\r\n\r\nIs there any way to prevent this from happening?","title":"Need to click back arrow twice to go back to previous activity, how to prevent it","body":"<p>I have one activity A and when I click on one button from activity A and come to an another activity B and when I click on back arrow from activity B to go back to A, its comes to the same activity B, so I need to click the back arrow again to go back and when I click on second time, it works.</p>\n<p>I have used below approach.</p>\n<pre><code>@Override\npublic void onBackPressed() {\n    super.onBackPressed();\n}\n</code></pre>\n<p>I have also used onKeyDown() approach. But it does not work, its comes to the same activity B, so I need to click the back arrow again to go back to previous activity.</p>\n<p>Is there any way to prevent this from happening?</p>\n"},{"tags":["java","docker","cpu","threadpool","vmware"],"comments":[{"owner":{"account_id":322981,"reputation":310745,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"score":0,"creation_date":1695368804,"post_id":77155707,"comment_id":136017789,"body_markdown":"Be aware that a CPU with hyper-threading can have that feature disabled if the sysadmin so chooses.","body":"Be aware that a CPU with hyper-threading can have that feature disabled if the sysadmin so chooses."},{"owner":{"account_id":213468,"reputation":103494,"user_id":466862,"display_name":"Mark Rotteveel"},"score":2,"creation_date":1695370615,"post_id":77155707,"comment_id":136018093,"body_markdown":"There is not a single answer to this, as it will actually depend on what your threads will be doing (e.g. CPU-bound work vs IO-bound work). In addition, just looking at it in the form of logical/hyper-threading or physical cores is too simple, especially when working with virtualization technology like Kubernetes.","body":"There is not a single answer to this, as it will actually depend on what your threads will be doing (e.g. CPU-bound work vs IO-bound work). In addition, just looking at it in the form of logical/hyper-threading or physical cores is too simple, especially when working with virtualization technology like Kubernetes."},{"owner":{"account_id":213468,"reputation":103494,"user_id":466862,"display_name":"Mark Rotteveel"},"score":0,"creation_date":1695370727,"post_id":77155707,"comment_id":136018112,"body_markdown":"Also, Java can report on the number of CPUs it *thinks* it has available, either because the OS reported that to Java (possibly taking into account quotas or virtualization limits), or it was configured with a specific value on the commandline.","body":"Also, Java can report on the number of CPUs it <i>thinks</i> it has available, either because the OS reported that to Java (possibly taking into account quotas or virtualization limits), or it was configured with a specific value on the commandline."},{"owner":{"account_id":13863020,"reputation":137023,"user_id":10008173,"display_name":"David Maze"},"score":2,"creation_date":1695378284,"post_id":77155707,"comment_id":136019655,"body_markdown":"You may intentionally want to set the thread pool larger than the number of cores (physical, virtual, CPU execution units).  If one of them is blocked on something like database I/O, that would let another thread work rather than forcing a CPU to sit idle.  This is more of a tuning question, along the same lines as &quot;what should I set the heap size to&quot;.","body":"You may intentionally want to set the thread pool larger than the number of cores (physical, virtual, CPU execution units).  If one of them is blocked on something like database I/O, that would let another thread work rather than forcing a CPU to sit idle.  This is more of a tuning question, along the same lines as &quot;what should I set the heap size to&quot;."}],"owner":{"account_id":17334403,"reputation":1,"user_id":12556668,"display_name":"turtler000"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":49,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1695369246,"creation_date":1695368561,"question_id":77155707,"body_markdown":"When the java program sets thread pool parameters, it will refer to the number of cpu cores.\r\nWhen configuring the number of core threads in the thread pool, should we use the number of physical cores or logical cores of the CPU?\r\nIn addition, I also want to know the number of CPU cores displayed by container technology, such as docker or vmware, is the number of logical cores or the number of physical cores?\r\nFor CPUs that support hyper-threading, these two values are different.","title":"When configuring the number of core threads in the thread pool, should we use the number of physical cores or logical cores of the CPU?","body":"<p>When the java program sets thread pool parameters, it will refer to the number of cpu cores.\nWhen configuring the number of core threads in the thread pool, should we use the number of physical cores or logical cores of the CPU?\nIn addition, I also want to know the number of CPU cores displayed by container technology, such as docker or vmware, is the number of logical cores or the number of physical cores?\nFor CPUs that support hyper-threading, these two values are different.</p>\n"},{"tags":["java","android","delphi","bluetooth-lowenergy","firemonkey"],"comments":[{"owner":{"account_id":3814324,"reputation":3408,"user_id":3164070,"accept_rate":60,"display_name":"Dave Nottage"},"score":0,"creation_date":1695369261,"post_id":77155516,"comment_id":136017852,"body_markdown":"You don&#39;t actually create an instance of `TJBluetoothGatt` (which you&#39;re doing wrong anyway) - an instance of `JBluetoothGatt` is returned when you call `connectGatt` on an instance of `JBluetoothDevice`. I expect you would call `requestConnectionPriority` once you&#39;ve done that. It might help you understand how it works by looking at the `System.Android.Bluetooth` unit","body":"You don&#39;t actually create an instance of <code>TJBluetoothGatt</code> (which you&#39;re doing wrong anyway) - an instance of <code>JBluetoothGatt</code> is returned when you call <code>connectGatt</code> on an instance of <code>JBluetoothDevice</code>. I expect you would call <code>requestConnectionPriority</code> once you&#39;ve done that. It might help you understand how it works by looking at the <code>System.Android.Bluetooth</code> unit"},{"owner":{"account_id":3814324,"reputation":3408,"user_id":3164070,"accept_rate":60,"display_name":"Dave Nottage"},"score":0,"creation_date":1695369492,"post_id":77155516,"comment_id":136017900,"body_markdown":"Also, the call would look like this: `requestConnectionPriority(TJBluetoothGatt.JavaClass.CONNECTION_PRIORITY_HIGH)` (you are missing a T). It&#39;s not nonsense - it&#39;s how the Java bridge works","body":"Also, the call would look like this: <code>requestConnectionPriority(TJBluetoothGatt.JavaClass.CONNECTI&zwnj;&#8203;ON_PRIORITY_HIGH)</code> (you are missing a T). It&#39;s not nonsense - it&#39;s how the Java bridge works"},{"owner":{"account_id":29506685,"reputation":1,"user_id":22612512,"display_name":"kdu300"},"score":0,"creation_date":1695652893,"post_id":77155516,"comment_id":136049662,"body_markdown":"Hello Dave,\nThanks for your help.\nBut I&#39;m afraid it&#39;s not enough. Unfortunately, the FMX is completely new material for me. \nI tried to call requestConnectionPriority() after the device is connected and the notification is switched on.\n\nlike this:\nADevice is the connected device. \n\nconst ADevice: TBluetoothLEDevice\n\nTJBluetoothGatt.Wrap(ADevice).requestConnectionPriority(TJBluetoothGatt.JavaClass.CONNECTION_PRIORITY_LOW) ;\n\nUnfortunately, my calls are aborted with an error. Maybe you can show me the complete functioncall.","body":"Hello Dave, Thanks for your help. But I&#39;m afraid it&#39;s not enough. Unfortunately, the FMX is completely new material for me.  I tried to call requestConnectionPriority() after the device is connected and the notification is switched on.  like this: ADevice is the connected device.   const ADevice: TBluetoothLEDevice  TJBluetoothGatt.Wrap(ADevice).requestConnectionPriority(TJBl&zwnj;&#8203;uetoothGatt.JavaClas&zwnj;&#8203;s.CONNECTION_PRIORIT&zwnj;&#8203;Y_LOW) ;  Unfortunately, my calls are aborted with an error. Maybe you can show me the complete functioncall."},{"owner":{"account_id":3814324,"reputation":3408,"user_id":3164070,"accept_rate":60,"display_name":"Dave Nottage"},"score":0,"creation_date":1695672211,"post_id":77155516,"comment_id":136053192,"body_markdown":"The code in your comment is incorrect, since `TBluetoothLEDevice` is a Delphi class, and you cannot use `TJBluetoothGatt.Wrap` with it, not to mention that it does not even make sense. As per my earlier comment: an instance of `JBluetoothGatt` is returned when you call `connectGatt` on an instance of `JBluetoothDevice`. If all this is new, that is why I suggested looking at the Delphi source to learn from it.","body":"The code in your comment is incorrect, since <code>TBluetoothLEDevice</code> is a Delphi class, and you cannot use <code>TJBluetoothGatt.Wrap</code> with it, not to mention that it does not even make sense. As per my earlier comment: an instance of <code>JBluetoothGatt</code> is returned when you call <code>connectGatt</code> on an instance of <code>JBluetoothDevice</code>. If all this is new, that is why I suggested looking at the Delphi source to learn from it."}],"owner":{"account_id":29506685,"reputation":1,"user_id":22612512,"display_name":"kdu300"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":72,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1695368824,"creation_date":1695366725,"question_id":77155516,"body_markdown":"I can&#39;t get `requestConnectionPriority` called correctly in Delphi Alexandria 11.3 FMX for Andoid BLE?\r\n\r\nI actually assumed that the following code is sufficient to get the `requestConnectionPriority`.\r\n`Androidapi.JNI.Bluetooth` is included in uses and declared in `Androidapi.JNI.Bluetooth.pas` like this:\r\n\r\n    TJBluetoothGatt = class(TJavaGenericImport&lt;JBluetoothGattClass, JBluetoothGatt&gt;) end;\r\n\r\nNow here is my code:\r\n\r\n*&lt;snip&gt;*\r\n\r\n    var\r\n      JBluetoothGatt: TJBluetoothGatt; // requestConnectionPriority added in API level 21\r\n    begin\r\n      JBluetoothGatt.Create;\r\n     \r\n     JBluetoothGatt.Wrap(self).requestConnectionPriority(JBluetoothGatt.JavaClass.CONNECTION_PRIORITY_HIGH); // this is nonsense but all function calls are visible, why ????\r\n      JBluetoothGatt.Free;\r\n    end;\r\n\r\n*&lt;snip&gt;*\r\n\r\nI would have expected more of a function like this now: \r\n\r\n    JBluetoothGatt.requestConnectionPriority(CONNECTION_PRIORITY_HIGH);\r\n\r\nJBluetoothGatt has no functions. Only wrap lets me access the functions (list).\r\nI have no idea what AJINIObjectID or IJavaInstance is supposed to be, with is to call Wrap.\r\n\r\nAnyway, I&#39;m sure it is to act completely different. What is the right way? \r\n","title":"How to call requestConnectionPriority correctly in FMX for Andoid BLE?","body":"<p>I can't get <code>requestConnectionPriority</code> called correctly in Delphi Alexandria 11.3 FMX for Andoid BLE?</p>\n<p>I actually assumed that the following code is sufficient to get the <code>requestConnectionPriority</code>.\n<code>Androidapi.JNI.Bluetooth</code> is included in uses and declared in <code>Androidapi.JNI.Bluetooth.pas</code> like this:</p>\n<pre><code>TJBluetoothGatt = class(TJavaGenericImport&lt;JBluetoothGattClass, JBluetoothGatt&gt;) end;\n</code></pre>\n<p>Now here is my code:</p>\n<p><em></em></p>\n<pre><code>var\n  JBluetoothGatt: TJBluetoothGatt; // requestConnectionPriority added in API level 21\nbegin\n  JBluetoothGatt.Create;\n \n JBluetoothGatt.Wrap(self).requestConnectionPriority(JBluetoothGatt.JavaClass.CONNECTION_PRIORITY_HIGH); // this is nonsense but all function calls are visible, why ????\n  JBluetoothGatt.Free;\nend;\n</code></pre>\n<p><em></em></p>\n<p>I would have expected more of a function like this now:</p>\n<pre><code>JBluetoothGatt.requestConnectionPriority(CONNECTION_PRIORITY_HIGH);\n</code></pre>\n<p>JBluetoothGatt has no functions. Only wrap lets me access the functions (list).\nI have no idea what AJINIObjectID or IJavaInstance is supposed to be, with is to call Wrap.</p>\n<p>Anyway, I'm sure it is to act completely different. What is the right way?</p>\n"},{"tags":["java","maven","security","access-control","project-structure"],"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1695365303,"post_id":77155331,"comment_id":136017126,"body_markdown":"Please edit the question to limit it to a specific problem with enough detail to identify an adequate answer.","body":"Please edit the question to limit it to a specific problem with enough detail to identify an adequate answer."}],"answers":[{"tags":[],"owner":{"account_id":888714,"reputation":34077,"user_id":927493,"accept_rate":61,"display_name":"J Fabian Meier"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695368544,"creation_date":1695368544,"answer_id":77155706,"question_id":77155331,"body_markdown":"If you allow someone to extend a class, then you give them access to the implementation details.\r\n\r\nThere is no real way around that.","title":"How to Restrict Access to Maven automation testing framework Project&#39;s Main Folder Contents?","body":"<p>If you allow someone to extend a class, then you give them access to the implementation details.</p>\n<p>There is no real way around that.</p>\n"}],"owner":{"account_id":20856181,"reputation":1,"user_id":15319440,"display_name":"Dheeraj Kumar Rajak"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":39,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1695368544,"creation_date":1695364588,"question_id":77155331,"body_markdown":"I have a Maven automation testing BDD-Cucumber framework project where the main folder contains essential testing configurations and reusable components. I want to allow clients to use these components and extend classes from the main folder, but I need to prevent them from viewing the implementation details available in main folder.\r\n\r\nWhat would be the best approach or set of configurations to achieve this level of access restriction in a Maven project? Any insights or suggestions would be greatly appreciated.\r\n\r\nI&#39;ve explored various Maven configuration options and access control mechanisms, but haven&#39;t found a specific solution that addresses this scenario. I&#39;ve looked into Maven&#39;s build profiles and resource filtering, but they don&#39;t seem to provide the level of access restriction I&#39;m aiming for.\r\n\r\nI&#39;m looking for a way to configure my Maven automation testing BDD-Cucumber project so that clients can utilize the reusable components and extend classes from the main folder, but they shouldn&#39;t be able to view the implementation details within the main folder. This would provide a level of abstraction and protect sensitive information.","title":"How to Restrict Access to Maven automation testing framework Project&#39;s Main Folder Contents?","body":"<p>I have a Maven automation testing BDD-Cucumber framework project where the main folder contains essential testing configurations and reusable components. I want to allow clients to use these components and extend classes from the main folder, but I need to prevent them from viewing the implementation details available in main folder.</p>\n<p>What would be the best approach or set of configurations to achieve this level of access restriction in a Maven project? Any insights or suggestions would be greatly appreciated.</p>\n<p>I've explored various Maven configuration options and access control mechanisms, but haven't found a specific solution that addresses this scenario. I've looked into Maven's build profiles and resource filtering, but they don't seem to provide the level of access restriction I'm aiming for.</p>\n<p>I'm looking for a way to configure my Maven automation testing BDD-Cucumber project so that clients can utilize the reusable components and extend classes from the main folder, but they shouldn't be able to view the implementation details within the main folder. This would provide a level of abstraction and protect sensitive information.</p>\n"},{"tags":["java","proguard"],"comments":[{"owner":{"account_id":4555218,"reputation":32585,"user_id":3699139,"display_name":"Jorn Vernee"},"score":0,"creation_date":1571849306,"post_id":58527481,"comment_id":103379474,"body_markdown":"FWIW 55.0 is the class file version for Java 11. So it seems that somewhere `javac` from JDK11 is being picked up (maybe check `javac -version` output).","body":"FWIW 55.0 is the class file version for Java 11. So it seems that somewhere <code>javac</code> from JDK11 is being picked up (maybe check <code>javac -version</code> output)."},{"owner":{"account_id":26863828,"reputation":51,"user_id":20446879,"display_name":"Payal Rajput"},"score":0,"creation_date":1672144118,"post_id":58527481,"comment_id":132228350,"body_markdown":"I had similar issue and I have answered for the same [here](https://stackoverflow.com/a/74928391/20446879)","body":"I had similar issue and I have answered for the same <a href=\"https://stackoverflow.com/a/74928391/20446879\">here</a>"}],"answers":[{"tags":[],"owner":{"account_id":6780825,"reputation":155680,"user_id":5221149,"display_name":"Andreas"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1571850122,"creation_date":1571850122,"answer_id":58527774,"question_id":58527481,"body_markdown":"The `company.application.actions.AboutAction` class has been compiled for Java 11.\n\nProGuard 6.0 only supports Java 10.\n\nYou need ProGuard 6.1 for Java 11 support.\n\nSee [Version history][1] in the [ProGuard Manual][2]:\n\n &gt; &lt;h3&gt;Version 6.1 (May 2019)&lt;/h3&gt;\n &gt;\n &gt;  - ...\n &gt;  - [PGD-188] Added support for Java 10, 11, and 12.\n &gt;  - ...\n &gt;\n &gt; &lt;h3&gt;Version 6.0 (Feb 2018)&lt;/h3&gt;\n &gt;\n &gt;  - ...\n &gt;  - [PGD-186] Added support for Java 10.\n &gt;  - ...\n\n\n  [1]: https://www.guardsquare.com/en/products/proguard/manual/versions\n  [2]: https://www.guardsquare.com/en/products/proguard/manual","title":"java.io.IOException: Can&#39;t process class [class path] (Unsupported version number [55.0] (maximum 54.0, Java 10))","body":"<p>The <code>company.application.actions.AboutAction</code> class has been compiled for Java 11.</p>\n<p>ProGuard 6.0 only supports Java 10.</p>\n<p>You need ProGuard 6.1 for Java 11 support.</p>\n<p>See <a href=\"https://www.guardsquare.com/en/products/proguard/manual/versions\" rel=\"nofollow noreferrer\">Version history</a> in the <a href=\"https://www.guardsquare.com/en/products/proguard/manual\" rel=\"nofollow noreferrer\">ProGuard Manual</a>:</p>\n<blockquote>\n<h3>Version 6.1 (May 2019)</h3>\n<ul>\n<li>...</li>\n<li>[PGD-188] Added support for Java 10, 11, and 12.</li>\n<li>...</li>\n</ul>\n<h3>Version 6.0 (Feb 2018)</h3>\n<ul>\n<li>...</li>\n<li>[PGD-186] Added support for Java 10.</li>\n<li>...</li>\n</ul>\n</blockquote>\n"},{"tags":[],"owner":{"account_id":3814553,"reputation":722,"user_id":3164227,"display_name":"shubomb"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1680187747,"creation_date":1680187747,"answer_id":75889728,"question_id":58527481,"body_markdown":"    Update gradle version work for me\r\n\r\nI have updated gradle version and gradle wrapper version and its work for me \r\n\r\n    classpath &#39;com.android.tools.build:gradle:7.0.4&#39;  \r\n\r\n    distributionUrl=https\\://services.gradle.org/distributions/gradle-7.0.2-bin.zip\r\n\r\n","title":"java.io.IOException: Can&#39;t process class [class path] (Unsupported version number [55.0] (maximum 54.0, Java 10))","body":"<pre><code>Update gradle version work for me\n</code></pre>\n<p>I have updated gradle version and gradle wrapper version and its work for me</p>\n<pre><code>classpath 'com.android.tools.build:gradle:7.0.4'  \n\ndistributionUrl=https\\://services.gradle.org/distributions/gradle-7.0.2-bin.zip\n</code></pre>\n"},{"tags":[],"owner":{"account_id":26947292,"reputation":11,"user_id":20517083,"display_name":"Jairin"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695368154,"creation_date":1694817581,"answer_id":77115663,"question_id":58527481,"body_markdown":"It worked for me to perform an upgrade of Android Studio and my Java version, in addition to the Android Gradle plugin, as I began encountering issues with Android Studio after updating the Gradle plugin to 7+. These are the configured versions that made the &#39;Unsupported version number [55.0] (maximum 54.0, Java 10)&#39; error disappear:\r\n\r\nPrevious:\r\n\r\n - Android Studio 4.1 \r\n - Java 8 \r\n - Gradle 4.6 \r\n - Android Gradle Plugin 2.3.3\r\n\r\nNew:\r\n\r\n- Android Studio Giraffe | 2022.3.1 Patch 1\r\n- Java 11\r\n- Gradle 7.4\r\n- Android Gradle Plugin 7.3","title":"java.io.IOException: Can&#39;t process class [class path] (Unsupported version number [55.0] (maximum 54.0, Java 10))","body":"<p>It worked for me to perform an upgrade of Android Studio and my Java version, in addition to the Android Gradle plugin, as I began encountering issues with Android Studio after updating the Gradle plugin to 7+. These are the configured versions that made the 'Unsupported version number [55.0] (maximum 54.0, Java 10)' error disappear:</p>\n<p>Previous:</p>\n<ul>\n<li>Android Studio 4.1</li>\n<li>Java 8</li>\n<li>Gradle 4.6</li>\n<li>Android Gradle Plugin 2.3.3</li>\n</ul>\n<p>New:</p>\n<ul>\n<li>Android Studio Giraffe | 2022.3.1 Patch 1</li>\n<li>Java 11</li>\n<li>Gradle 7.4</li>\n<li>Android Gradle Plugin 7.3</li>\n</ul>\n"}],"owner":{"account_id":16831332,"reputation":21,"user_id":12169233,"display_name":"deputylactose"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":7381,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"closed_date":1694818918,"answer_count":3,"score":2,"last_activity_date":1695368154,"creation_date":1571848773,"question_id":58527481,"body_markdown":"I&#39;m unable to compile java code that my coworker can successfully compile.\r\n\r\nI have JRE 8u221.\r\n\r\nProguard is version 6.03\r\n\r\nFrom my build.bat output:\r\n\r\ndist-obfuscate:\r\n     [echo] Extracting Objfuscator\r\n    [unzip] Expanding: c:\\Workspaces\\abcd\\efg\\Trunk\\ESDE\\Scripts\\proguard\\proguard6.0.3.zip into c:\\Workspaces\\abcd\\efg\\Trunk\\ESDE\\Scripts\\proguard\r\n     [echo] Jarring Base ESDE\r\n     [copy] Copying 1 file to c:\\Workspaces\\abcd\\efg\\Trunk\\ESDE\\Scripts\\proguard\r\n\r\n     [java] ProGuard, version 6.0.3java.io.IOException: Can&#39;t read [c:\\Workspaces\\abcd\\efg\\Trunk\\ESDE\\Scripts\\proguard\\sdeIn.jar] (Can&#39;t process class [company/application/actions/AboutAction.class] (Unsupported version number [55.0] (maximum 54.0, Java 10)))\r\n\r\n     [java]\r\n     [java] Reading input...\r\n     [java]     at proguard.InputReader.readInput(InputReader.java:214)Reading program jar [c:\\Workspaces\\abcd\\efg\\Trunk\\ESDE\\Scripts\\proguard\\sdeIn.jar]\r\n     [java]\r\n     [java]     at proguard.InputReader.readInput(InputReader.java:184)\r\n     [java]     at proguard.InputReader.readInput(InputReader.java:162)\r\n     [java]     at proguard.InputReader.execute(InputReader.java:90)\r\n     [java]     at proguard.ProGuard.readInput(ProGuard.java:255)\r\n     [java]     at proguard.ProGuard.execute(ProGuard.java:96)\r\n     [java]     at proguard.ProGuard.main(ProGuard.java:572)\r\n     [java] Caused by: java.io.IOException: Can&#39;t process class [company/application/actions/AboutAction.class] (Unsupported version number [55.0] (maximum 54.0, Java 10))\r\n     [java]     at proguard.io.ClassReader.read(ClassReader.java:114)\r\n     [java]     at proguard.io.FilteredDataEntryReader.read(FilteredDataEntryReader.java:87)\r\n     [java]     at proguard.io.FilteredDataEntryReader.read(FilteredDataEntryReader.java:87)\r\n     [java]     at proguard.io.JarReader.read(JarReader.java:83)\r\n     [java]     at proguard.io.DirectoryPump.readFiles(DirectoryPump.java:65)\r\n     [java]     at proguard.io.DirectoryPump.pumpDataEntries(DirectoryPump.java:53)\r\n     [java]     at proguard.InputReader.readInput(InputReader.java:210)\r\n     [java]     ... 6 more\r\n     [java] Caused by: java.lang.UnsupportedOperationException: Unsupported version number [55.0] (maximum 54.0, Java 10)\r\n     [java]     at proguard.classfile.util.ClassUtil.checkVersionNumbers(ClassUtil.java:148)\r\n     [java]     at proguard.classfile.io.ProgramClassReader.visitProgramClass(ProgramClassReader.java:101)\r\n     [java]     at proguard.classfile.ProgramClass.accept(ProgramClass.java:430)\r\n     [java]     at proguard.io.ClassReader.read(ClassReader.java:91)\r\n     [java]     ... 12 more\r\n     [java] Java Result: 1\r\n\r\nBUILD FAILED\r\nc:\\Workspaces\\abcd\\efg\\Trunk\\ESDE\\build.xml:877: Warning: Could not find file c:\\Workspaces\\abcd\\efg\\Trunk\\ESDE\\Scripts\\proguard\\sde.jar to copy.\r\n\r\nQuestions:\r\n\r\n1) &quot;Version 55.0&quot;?  Version of...what?\r\n\r\nProguard version = 6.0.3.\r\n\r\n2) &quot;Java 10&quot;?  Nope.\r\n\r\njava -version\r\njava version &quot;1.8.0_221&quot;\r\nJava(TM) SE Runtime Environment (build 1.8.0_221-b11)\r\nJava HotSpot(TM) 64-Bit Server VM (build 25.221-b11, mixed mode)\r\n\r\nThis is Java *8*, not 10.\r\n\r\n","title":"java.io.IOException: Can&#39;t process class [class path] (Unsupported version number [55.0] (maximum 54.0, Java 10))","body":"<p>I'm unable to compile java code that my coworker can successfully compile.</p>\n\n<p>I have JRE 8u221.</p>\n\n<p>Proguard is version 6.03</p>\n\n<p>From my build.bat output:</p>\n\n<p>dist-obfuscate:\n     [echo] Extracting Objfuscator\n    [unzip] Expanding: c:\\Workspaces\\abcd\\efg\\Trunk\\ESDE\\Scripts\\proguard\\proguard6.0.3.zip into c:\\Workspaces\\abcd\\efg\\Trunk\\ESDE\\Scripts\\proguard\n     [echo] Jarring Base ESDE\n     [copy] Copying 1 file to c:\\Workspaces\\abcd\\efg\\Trunk\\ESDE\\Scripts\\proguard</p>\n\n<pre><code> [java] ProGuard, version 6.0.3java.io.IOException: Can't read [c:\\Workspaces\\abcd\\efg\\Trunk\\ESDE\\Scripts\\proguard\\sdeIn.jar] (Can't process class [company/application/actions/AboutAction.class] (Unsupported version number [55.0] (maximum 54.0, Java 10)))\n\n [java]\n [java] Reading input...\n [java]     at proguard.InputReader.readInput(InputReader.java:214)Reading program jar [c:\\Workspaces\\abcd\\efg\\Trunk\\ESDE\\Scripts\\proguard\\sdeIn.jar]\n [java]\n [java]     at proguard.InputReader.readInput(InputReader.java:184)\n [java]     at proguard.InputReader.readInput(InputReader.java:162)\n [java]     at proguard.InputReader.execute(InputReader.java:90)\n [java]     at proguard.ProGuard.readInput(ProGuard.java:255)\n [java]     at proguard.ProGuard.execute(ProGuard.java:96)\n [java]     at proguard.ProGuard.main(ProGuard.java:572)\n [java] Caused by: java.io.IOException: Can't process class [company/application/actions/AboutAction.class] (Unsupported version number [55.0] (maximum 54.0, Java 10))\n [java]     at proguard.io.ClassReader.read(ClassReader.java:114)\n [java]     at proguard.io.FilteredDataEntryReader.read(FilteredDataEntryReader.java:87)\n [java]     at proguard.io.FilteredDataEntryReader.read(FilteredDataEntryReader.java:87)\n [java]     at proguard.io.JarReader.read(JarReader.java:83)\n [java]     at proguard.io.DirectoryPump.readFiles(DirectoryPump.java:65)\n [java]     at proguard.io.DirectoryPump.pumpDataEntries(DirectoryPump.java:53)\n [java]     at proguard.InputReader.readInput(InputReader.java:210)\n [java]     ... 6 more\n [java] Caused by: java.lang.UnsupportedOperationException: Unsupported version number [55.0] (maximum 54.0, Java 10)\n [java]     at proguard.classfile.util.ClassUtil.checkVersionNumbers(ClassUtil.java:148)\n [java]     at proguard.classfile.io.ProgramClassReader.visitProgramClass(ProgramClassReader.java:101)\n [java]     at proguard.classfile.ProgramClass.accept(ProgramClass.java:430)\n [java]     at proguard.io.ClassReader.read(ClassReader.java:91)\n [java]     ... 12 more\n [java] Java Result: 1\n</code></pre>\n\n<p>BUILD FAILED\nc:\\Workspaces\\abcd\\efg\\Trunk\\ESDE\\build.xml:877: Warning: Could not find file c:\\Workspaces\\abcd\\efg\\Trunk\\ESDE\\Scripts\\proguard\\sde.jar to copy.</p>\n\n<p>Questions:</p>\n\n<p>1) \"Version 55.0\"?  Version of...what?</p>\n\n<p>Proguard version = 6.0.3.</p>\n\n<p>2) \"Java 10\"?  Nope.</p>\n\n<p>java -version\njava version \"1.8.0_221\"\nJava(TM) SE Runtime Environment (build 1.8.0_221-b11)\nJava HotSpot(TM) 64-Bit Server VM (build 25.221-b11, mixed mode)</p>\n\n<p>This is Java <em>8</em>, not 10.</p>\n"},{"tags":["java","eclipse","hibernate","maven"],"comments":[{"owner":{"account_id":21741636,"reputation":1166,"user_id":16048914,"display_name":"David Weber"},"score":0,"creation_date":1695367545,"post_id":77155438,"comment_id":136017566,"body_markdown":"I recommend you to try to do changes in the pom.xml directly with text and not with an visual editor. Have you installed any new Plugins? Can you right click on the pom.xml and &quot;Open with&quot; an &quot;Text Editor&quot;? If nothing works, you can workaround this by opening the pom.xml not in Eclipse but in your OS-Explorer with Notepad++ e.g..","body":"I recommend you to try to do changes in the pom.xml directly with text and not with an visual editor. Have you installed any new Plugins? Can you right click on the pom.xml and &quot;Open with&quot; an &quot;Text Editor&quot;? If nothing works, you can workaround this by opening the pom.xml not in Eclipse but in your OS-Explorer with Notepad++ e.g.."},{"owner":{"account_id":21741636,"reputation":1166,"user_id":16048914,"display_name":"David Weber"},"score":0,"creation_date":1695367866,"post_id":77155438,"comment_id":136017621,"body_markdown":"No problem, please mark my answer below as &quot;Answer&quot; so that everybody sees the solution too! :)","body":"No problem, please mark my answer below as &quot;Answer&quot; so that everybody sees the solution too! :)"},{"owner":{"account_id":8692823,"reputation":31810,"user_id":6505250,"display_name":"howlger"},"score":0,"creation_date":1695368548,"post_id":77155438,"comment_id":136017741,"body_markdown":"Please go to the _Error Log_ view, select the error (do not open it, just select it), hit Ctrl+C and paste it into your question formatted as _Sample Code_. Did you do a fresh installation or an (maybe incomplete) upgrade? Does right-clicking the `pom.xml` file and choosing _Open With &gt; Generic Editor_ work? Please be aware that something like Notepad++ does not show problems and information that an IDE does.","body":"Please go to the <i>Error Log</i> view, select the error (do not open it, just select it), hit Ctrl+C and paste it into your question formatted as <i>Sample Code</i>. Did you do a fresh installation or an (maybe incomplete) upgrade? Does right-clicking the <code>pom.xml</code> file and choosing <i>Open With &gt; Generic Editor</i> work? Please be aware that something like Notepad++ does not show problems and information that an IDE does."}],"answers":[{"tags":[],"owner":{"account_id":21741636,"reputation":1166,"user_id":16048914,"display_name":"David Weber"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1695367801,"creation_date":1695367801,"answer_id":77155618,"question_id":77155438,"body_markdown":"I recommend you to try to do changes in the pom.xml directly with text and not with an visual editor. Have you installed any new Plugins? Can you right click on the pom.xml and &quot;Open with&quot; an &quot;Text Editor&quot;? If nothing works, you can workaround this by opening the pom.xml not in Eclipse but in your OS-Explorer with Notepad++ e.g.. ","title":"Unable to Edit pom.xml in Eclipse Maven Project - Only Overview Mode Available","body":"<p>I recommend you to try to do changes in the pom.xml directly with text and not with an visual editor. Have you installed any new Plugins? Can you right click on the pom.xml and &quot;Open with&quot; an &quot;Text Editor&quot;? If nothing works, you can workaround this by opening the pom.xml not in Eclipse but in your OS-Explorer with Notepad++ e.g..</p>\n"}],"owner":{"account_id":29506070,"reputation":3,"user_id":22612014,"display_name":"Pratik Lokhande "},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":134,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77155618,"answer_count":1,"score":0,"last_activity_date":1695367801,"creation_date":1695365904,"question_id":77155438,"body_markdown":"**I created a Maven project in Eclipse, but I can&#39;t edit the pom.xml file because it&#39;s not showing the editing window to add dependencies. It&#39;s only showing the overview window when I open it.**\r\n\r\nWhat could be causing this problem, and how can I fix it?\r\n\r\nAdditional information:\r\n\r\nI am using Eclipse version 2023-09(4.29.2).\r\nI have tried restarting Eclipse.\r\nI have tried making new project.\r\nI have checked my Window \\&gt; Preferences \\&gt; Maven \\&gt; User Interface settings, and the &quot;Open XML page in the POM editor by default&quot; checkbox is checked.\r\n\r\n[This is what my eclipse showing](https://i.stack.imgur.com/covbA.png)\r\n\r\nPlease help!","title":"Unable to Edit pom.xml in Eclipse Maven Project - Only Overview Mode Available","body":"<p><strong>I created a Maven project in Eclipse, but I can't edit the pom.xml file because it's not showing the editing window to add dependencies. It's only showing the overview window when I open it.</strong></p>\n<p>What could be causing this problem, and how can I fix it?</p>\n<p>Additional information:</p>\n<p>I am using Eclipse version 2023-09(4.29.2).\nI have tried restarting Eclipse.\nI have tried making new project.\nI have checked my Window &gt; Preferences &gt; Maven &gt; User Interface settings, and the &quot;Open XML page in the POM editor by default&quot; checkbox is checked.</p>\n<p><a href=\"https://i.stack.imgur.com/covbA.png\" rel=\"nofollow noreferrer\">This is what my eclipse showing</a></p>\n<p>Please help!</p>\n"},{"tags":["java","arrays","string","yaml","pattern-matching"],"comments":[{"owner":{"account_id":6104455,"reputation":4456,"user_id":4762502,"accept_rate":73,"display_name":"Gaurav Jeswani"},"score":0,"creation_date":1695211001,"post_id":77141613,"comment_id":135993264,"body_markdown":"What you have tried so far? Would you please share that?","body":"What you have tried so far? Would you please share that?"},{"owner":{"account_id":15689318,"reputation":21,"user_id":11320951,"display_name":"maria_so"},"score":0,"creation_date":1695213400,"post_id":77141613,"comment_id":135993805,"body_markdown":"I have tried \n```\n requestBody:\n        description: &#39;&#39;\n        required: true\n        content:\n          application/json:\n            schema:\n              type: &#39;object&#39;\n              properties:\n                languages:\n                  type: &#39;array&#39;\n                  items:\n                    type: &#39;string&#39;\n                    pattern: &quot;^[0-9a-zA-Z]{1,50}$&quot;\n                    maxLength: 50\n                    example: &#39;english&#39;\n```","body":"I have tried  ```  requestBody:         description: &#39;&#39;         required: true         content:           application/json:             schema:               type: &#39;object&#39;               properties:                 languages:                   type: &#39;array&#39;                   items:                     type: &#39;string&#39;                     pattern: &quot;^[0-9a-zA-Z]{1,50}$&quot;                     maxLength: 50                     example: &#39;english&#39; ```"},{"owner":{"account_id":6104455,"reputation":4456,"user_id":4762502,"accept_rate":73,"display_name":"Gaurav Jeswani"},"score":0,"creation_date":1695276616,"post_id":77141613,"comment_id":136003276,"body_markdown":"please add your current swagger in the question. Not in comments.","body":"please add your current swagger in the question. Not in comments."}],"answers":[{"tags":[],"owner":{"account_id":6104455,"reputation":4456,"user_id":4762502,"accept_rate":73,"display_name":"Gaurav Jeswani"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695211405,"creation_date":1695211405,"answer_id":77142234,"question_id":77141613,"body_markdown":"It should look like this:\r\n\r\n    Languages:\r\n      type: object\r\n      properties:\r\n        languages:\r\n          type: array\r\n          items:\r\n            type: string\r\n\r\nAnd you can refer this `Language` Schema.","title":"Swagger Schema - Pattern and length not applied to string array","body":"<p>It should look like this:</p>\n<pre><code>Languages:\n  type: object\n  properties:\n    languages:\n      type: array\n      items:\n        type: string\n</code></pre>\n<p>And you can refer this <code>Language</code> Schema.</p>\n"}],"owner":{"account_id":15689318,"reputation":21,"user_id":11320951,"display_name":"maria_so"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":86,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1695367526,"creation_date":1695206494,"question_id":77141613,"body_markdown":"This is related to this question: https://stackoverflow.com/questions/68184411/swagger-schema-pattern-not-applied-to-string-array which has received an answer that checks an array of fields (like key-values) instead of a list of single strings. I need the body of the request to look like this: \r\n```\r\n{\r\n    &quot;languages&quot;: [\r\n        &quot;english&quot;\r\n    ]\r\n}\r\n```\r\nnot like this (as the answer I was mentioning refers to):\r\n```\r\n{\r\n  &quot;languages&quot;: [\r\n    {\r\n      &quot;language&quot;: &quot;english&quot;\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nThis is the swagger piece I am using right now: \r\n```\r\n      requestBody:\r\n        required: true\r\n        content:\r\n          application/json:\r\n            schema:\r\n              type: &#39;object&#39;\r\n              additionalProperties: false\r\n              properties:\r\n                languages:\r\n                  type: &#39;array&#39;\r\n                  items:\r\n                    type: &#39;string&#39;\r\n                    pattern: &quot;^[0-9a-zA-Z]{1,50}$&quot;\r\n                    maxLength: 50\r\n                    example: &#39;english&#39;\r\n```","title":"Swagger Schema - Pattern and length not applied to string array","body":"<p>This is related to this question: <a href=\"https://stackoverflow.com/questions/68184411/swagger-schema-pattern-not-applied-to-string-array\">Swagger Schema - Pattern not applied to string array</a> which has received an answer that checks an array of fields (like key-values) instead of a list of single strings. I need the body of the request to look like this:</p>\n<pre><code>{\n    &quot;languages&quot;: [\n        &quot;english&quot;\n    ]\n}\n</code></pre>\n<p>not like this (as the answer I was mentioning refers to):</p>\n<pre><code>{\n  &quot;languages&quot;: [\n    {\n      &quot;language&quot;: &quot;english&quot;\n    }\n  ]\n}\n</code></pre>\n<p>This is the swagger piece I am using right now:</p>\n<pre><code>      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              type: 'object'\n              additionalProperties: false\n              properties:\n                languages:\n                  type: 'array'\n                  items:\n                    type: 'string'\n                    pattern: &quot;^[0-9a-zA-Z]{1,50}$&quot;\n                    maxLength: 50\n                    example: 'english'\n</code></pre>\n"},{"tags":["java","hibernate"],"comments":[{"owner":{"account_id":2536797,"reputation":618,"user_id":2203665,"display_name":"joaonlima"},"score":0,"creation_date":1367019781,"post_id":16246675,"comment_id":23244649,"body_markdown":"See if this [**answer**](http://stackoverflow.com/questions/1074081/hibernate-error-org-hibernate-nonuniqueobjectexception-a-different-object-with) helps you..","body":"See if this <a href=\"http://stackoverflow.com/questions/1074081/hibernate-error-org-hibernate-nonuniqueobjectexception-a-different-object-with\"><b>answer</b></a> helps you.."}],"answers":[{"tags":[],"owner":{"account_id":136531,"reputation":21531,"user_id":340088,"accept_rate":68,"display_name":"jbx"},"down_vote_count":0,"up_vote_count":118,"is_accepted":true,"score":118,"last_activity_date":1367020623,"creation_date":1367020623,"answer_id":16246858,"question_id":16246675,"body_markdown":"Most probably its because the B objects are not referring to the same Java C object instance. They are referring to the same row in the database (i.e. the same primary key) but they&#39;re different copies of it. \r\n\r\nSo what is happening is that the Hibernate session, which is managing the entities would be keeping track of which Java object corresponds to the row with the same primary key.\r\n\r\nOne option would be to make sure that the Entities of objects B that refer to the same row are actually referring to the same object instance of C. Alternatively turn off cascading for that member variable. This way when B is persisted C is not. You will have to save C manually separately though. If C is a type/category table, then it probably makes sense to be that way.\r\n","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>Most probably its because the B objects are not referring to the same Java C object instance. They are referring to the same row in the database (i.e. the same primary key) but they're different copies of it. </p>\n\n<p>So what is happening is that the Hibernate session, which is managing the entities would be keeping track of which Java object corresponds to the row with the same primary key.</p>\n\n<p>One option would be to make sure that the Entities of objects B that refer to the same row are actually referring to the same object instance of C. Alternatively turn off cascading for that member variable. This way when B is persisted C is not. You will have to save C manually separately though. If C is a type/category table, then it probably makes sense to be that way.</p>\n"},{"tags":[],"owner":{"account_id":1315905,"reputation":89,"user_id":1262787,"display_name":"Fawad Khaliq"},"down_vote_count":2,"up_vote_count":2,"is_accepted":false,"score":0,"last_activity_date":1384163982,"creation_date":1384163982,"answer_id":19903478,"question_id":16246675,"body_markdown":"you might not be setting the identifier of the object before calling update query.","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>you might not be setting the identifier of the object before calling update query.</p>\n"},{"tags":[],"owner":{"account_id":80980,"reputation":3007,"user_id":228638,"accept_rate":52,"display_name":"Ales Potocnik Hahonina"},"down_vote_count":1,"up_vote_count":3,"is_accepted":false,"score":2,"last_activity_date":1403085298,"creation_date":1403085298,"answer_id":24282492,"question_id":16246675,"body_markdown":"Just came across this message but in c# code. Not sure if it&#39;s relevant (exactly the same error message though).\r\n\r\nI was debugging the code with breakpoints and expanded some collections through private members while debugger was at a breakpoint. Having re-run the code without digging through structures made the error message go away. It seems like the act of looking into private lazy-loaded collections has made NHibernate load things that were not supposed to be loaded at that time (because they were in private members).\r\n\r\nThe code itself is wrapped in a fairly complicated transaction that can update large number of records and many dependencies as part of that transaction (import process).\r\n\r\nHopefully a clue to anyone else who comes across the issue.","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>Just came across this message but in c# code. Not sure if it's relevant (exactly the same error message though).</p>\n\n<p>I was debugging the code with breakpoints and expanded some collections through private members while debugger was at a breakpoint. Having re-run the code without digging through structures made the error message go away. It seems like the act of looking into private lazy-loaded collections has made NHibernate load things that were not supposed to be loaded at that time (because they were in private members).</p>\n\n<p>The code itself is wrapped in a fairly complicated transaction that can update large number of records and many dependencies as part of that transaction (import process).</p>\n\n<p>Hopefully a clue to anyone else who comes across the issue.</p>\n"},{"tags":[],"owner":{"account_id":3391156,"reputation":1765,"user_id":2845946,"display_name":"user2845946"},"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1406222780,"creation_date":1406222780,"answer_id":24940189,"question_id":16246675,"body_markdown":"Transfer the task of assigning the object ID from Hibernate to the database by using:\r\n\r\n&lt;!-- language: lang-java --&gt;\r\n\r\n    &lt;generator class=&quot;native&quot;/&gt;\r\n\r\nThis solved the problem for me.","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>Transfer the task of assigning the object ID from Hibernate to the database by using:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>&lt;generator class=\"native\"/&gt;\n</code></pre>\n\n<p>This solved the problem for me.</p>\n"},{"tags":[],"owner":{"account_id":4532124,"reputation":615,"user_id":3682254,"accept_rate":33,"display_name":"dsk"},"down_vote_count":1,"up_vote_count":21,"is_accepted":false,"score":20,"last_activity_date":1452026836,"creation_date":1411026943,"answer_id":25907179,"question_id":16246675,"body_markdown":"You only need to do one thing. Run `session_object.clear()` and then save the new object. This will clear the session (as aptly named) and remove the offending duplicate object from your session.","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>You only need to do one thing. Run <code>session_object.clear()</code> and then save the new object. This will clear the session (as aptly named) and remove the offending duplicate object from your session.</p>\n"},{"tags":[],"owner":{"account_id":3761985,"reputation":428,"user_id":3126639,"accept_rate":100,"display_name":"Waqar"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1450446296,"creation_date":1412660448,"answer_id":26229217,"question_id":16246675,"body_markdown":"One way to solve the above problem will be to override the `hashcode()`.  \r\nAlso flush the hibernate session before and after save.  \r\n\r\n    getHibernateTemplate().flush();\r\n\r\nExplicitly setting the detached object to `null` also helps.","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>One way to solve the above problem will be to override the <code>hashcode()</code>.<br>\nAlso flush the hibernate session before and after save.  </p>\n\n<pre><code>getHibernateTemplate().flush();\n</code></pre>\n\n<p>Explicitly setting the detached object to <code>null</code> also helps.</p>\n"},{"tags":[],"owner":{"account_id":2415860,"reputation":41,"user_id":2109879,"display_name":"Hemant kumar"},"down_vote_count":1,"up_vote_count":4,"is_accepted":false,"score":3,"last_activity_date":1695367478,"creation_date":1427371309,"answer_id":29277906,"question_id":16246675,"body_markdown":"Add the annotation\r\n`@GeneratedValue`\r\nto the bean you are inserting.","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>Add the annotation\n<code>@GeneratedValue</code>\nto the bean you are inserting.</p>\n"},{"tags":[],"owner":{"account_id":1918867,"reputation":85,"user_id":1730814,"accept_rate":100,"display_name":"Buddhi"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1435430719,"creation_date":1435430719,"answer_id":31092266,"question_id":16246675,"body_markdown":"I had this error few days a go and I sped too many time on fixing this error. \r\n\r\n     public boolean save(OrderHeader header) {\r\n        Session session = sessionFactory.openSession();\r\n\r\n\r\n        Transaction transaction = session.beginTransaction();\r\n\r\n        try {\r\n            session.save(header);\r\n\r\n            for (OrderDetail detail : header.getDetails()) {\r\n                session.save(detail);\r\n            }\r\n\r\n            transaction.commit();\r\n            session.close();\r\n\r\n            return true;\r\n        } catch (HibernateException exception) {\r\n\r\n            exception.printStackTrace();\r\n            transaction.rollback();\r\n            return false;\r\n        }\r\n    }\r\n\r\nBefore i get this error , I didn&#39;t have mentioned ID generation type on the OrderDetil Object. when without generating Orderdetails&#39; id it keeps Id as 0 for every OrderDetail objects.  this what #jbx explained. Yes it is the best answer. this one example how it happens.  ","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>I had this error few days a go and I sped too many time on fixing this error. </p>\n\n<pre><code> public boolean save(OrderHeader header) {\n    Session session = sessionFactory.openSession();\n\n\n    Transaction transaction = session.beginTransaction();\n\n    try {\n        session.save(header);\n\n        for (OrderDetail detail : header.getDetails()) {\n            session.save(detail);\n        }\n\n        transaction.commit();\n        session.close();\n\n        return true;\n    } catch (HibernateException exception) {\n\n        exception.printStackTrace();\n        transaction.rollback();\n        return false;\n    }\n}\n</code></pre>\n\n<p>Before i get this error , I didn't have mentioned ID generation type on the OrderDetil Object. when without generating Orderdetails' id it keeps Id as 0 for every OrderDetail objects.  this what #jbx explained. Yes it is the best answer. this one example how it happens.  </p>\n"},{"tags":[],"owner":{"account_id":402206,"reputation":1256,"user_id":4136337,"accept_rate":40,"display_name":"0x4ndy"},"down_vote_count":1,"up_vote_count":42,"is_accepted":false,"score":41,"last_activity_date":1439068911,"creation_date":1439068911,"answer_id":31898721,"question_id":16246675,"body_markdown":"Just set cascade to MERGE, that should do the trick.","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>Just set cascade to MERGE, that should do the trick.</p>\n"},{"tags":[],"owner":{"account_id":7644072,"reputation":287,"user_id":7427275,"display_name":"Ice Blue"},"down_vote_count":0,"up_vote_count":19,"is_accepted":false,"score":19,"last_activity_date":1562963895,"creation_date":1485332037,"answer_id":41846442,"question_id":16246675,"body_markdown":"I agree with @Hemant Kumar, thank you very much. According his solution, I solved my problem.\r\n\r\nFor example\r\n  \r\n    @Test\r\n    public void testSavePerson() {\r\n        try (Session session = sessionFactory.openSession()) {\r\n            Transaction tx = session.beginTransaction();\r\n            Person person1 = new Person();\r\n            Person person2 = new Person();\r\n            person1.setName(&quot;222&quot;);\r\n            person2.setName(&quot;111&quot;);\r\n            session.save(person1);\r\n            session.save(person2);\r\n            tx.commit();\r\n        }\r\n    }\r\n\r\nPerson.java\r\n\r\n    public class Person {\r\n        private int id;\r\n        private String name;\r\n    \r\n        @Id\r\n        @Column(name = &quot;id&quot;)\r\n        public int getId() {\r\n            return id;\r\n        }\r\n    \r\n        public void setId(int id) {\r\n            this.id = id;\r\n        }\r\n    \r\n        @Basic\r\n        @Column(name = &quot;name&quot;)\r\n        public String getName() {\r\n            return name;\r\n        }\r\n    \r\n        public void setName(String name) {\r\n            this.name = name;\r\n        }\r\n    \r\n    }\r\n\r\n\r\nThis code always make mistake in my application:\r\n`A different object with the same identifier value was already associated with the session`, later I found out that I forgot\r\nto **autoincrease my primary key!** \r\n\r\nMy solution is to add this code on your primary key:\r\n\r\n    @GeneratedValue(strategy = GenerationType.AUTO)\r\n","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>I agree with @Hemant Kumar, thank you very much. According his solution, I solved my problem.</p>\n\n<p>For example</p>\n\n<pre><code>@Test\npublic void testSavePerson() {\n    try (Session session = sessionFactory.openSession()) {\n        Transaction tx = session.beginTransaction();\n        Person person1 = new Person();\n        Person person2 = new Person();\n        person1.setName(\"222\");\n        person2.setName(\"111\");\n        session.save(person1);\n        session.save(person2);\n        tx.commit();\n    }\n}\n</code></pre>\n\n<p>Person.java</p>\n\n<pre><code>public class Person {\n    private int id;\n    private String name;\n\n    @Id\n    @Column(name = \"id\")\n    public int getId() {\n        return id;\n    }\n\n    public void setId(int id) {\n        this.id = id;\n    }\n\n    @Basic\n    @Column(name = \"name\")\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n}\n</code></pre>\n\n<p>This code always make mistake in my application:\n<code>A different object with the same identifier value was already associated with the session</code>, later I found out that I forgot\nto <strong>autoincrease my primary key!</strong> </p>\n\n<p>My solution is to add this code on your primary key:</p>\n\n<pre><code>@GeneratedValue(strategy = GenerationType.AUTO)\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4609492,"reputation":139,"user_id":3738027,"accept_rate":50,"display_name":"juldeh"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1486712449,"creation_date":1486712449,"answer_id":42153978,"question_id":16246675,"body_markdown":"Try to place the code of your query before.\r\nThat fix my problem.\r\ne.g. change this:\r\n\r\n    query1 \r\n    query2 - get the error \r\n    update\r\n\r\nto this:\r\n\r\n    query2\r\n    query1\r\n    update","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>Try to place the code of your query before.\nThat fix my problem.\ne.g. change this:</p>\n\n<pre><code>query1 \nquery2 - get the error \nupdate\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>query2\nquery1\nupdate\n</code></pre>\n"},{"tags":[],"owner":{"account_id":10679943,"reputation":831,"user_id":7862350,"display_name":"Nguyen Vu Quang"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1492091509,"creation_date":1492091509,"answer_id":43394132,"question_id":16246675,"body_markdown":"Find the &quot;Cascade&quot; atribute in Hibernate and delete it. When you set &quot;Cascade&quot; available, it will call other operations (save, update and delete) on another entities which has relationship with related classes. So same identities value will be  happened. \r\nIt worked with me.","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>Find the \"Cascade\" atribute in Hibernate and delete it. When you set \"Cascade\" available, it will call other operations (save, update and delete) on another entities which has relationship with related classes. So same identities value will be  happened. \nIt worked with me.</p>\n"},{"tags":[],"owner":{"account_id":10661176,"reputation":1,"user_id":7849096,"display_name":""},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1513233661,"creation_date":1513232911,"answer_id":47807138,"question_id":16246675,"body_markdown":"I met the problem because of the primary key generation is wrong,when I insert a row like this:\r\n\r\n    public void addTerminal(String typeOfDevice,Map&lt;Byte,Integer&gt; map) {\r\n    \t\t// TODO Auto-generated method stub\r\n    \t\ttry {\r\n    \t\t\tSet&lt;Byte&gt; keySet = map.keySet();\r\n    \t\t\tfor (Byte byte1 : keySet) {\r\n    \t\t\t\tDevice device=new Device();\r\n    \t\t\t\tdevice.setNumDevice(DeviceCount.map.get(byte1));\r\n    \t\t\t\tdevice.setTimestamp(System.currentTimeMillis());\r\n    \t\t\t\tdevice.setTypeDevice(byte1);\r\n    \t\t\t\tthis.getHibernateTemplate().save(device);\r\n    \t\t\t}\r\n    \t\t\tSystem.out.println(&quot;hah&quot;);\r\n    \t\t}catch (Exception e) {\r\n    \t\t\t// TODO: handle exception\r\n    \t\t\tlogger.warn(&quot;wrong&quot;);\r\n    \t\t\tlogger.warn(e.getStackTrace()+e.getMessage());\r\n    \t\t}\r\n    }\r\n\r\nI change the id generator class to identity\r\n\r\n    &lt;id name=&quot;id&quot; type=&quot;int&quot;&gt;\r\n        &lt;column name=&quot;id&quot; /&gt;\r\n        &lt;generator class=&quot;identity&quot;  /&gt;\r\n     &lt;/id&gt;","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>I met the problem because of the primary key generation is wrong,when I insert a row like this:</p>\n\n<pre><code>public void addTerminal(String typeOfDevice,Map&lt;Byte,Integer&gt; map) {\n        // TODO Auto-generated method stub\n        try {\n            Set&lt;Byte&gt; keySet = map.keySet();\n            for (Byte byte1 : keySet) {\n                Device device=new Device();\n                device.setNumDevice(DeviceCount.map.get(byte1));\n                device.setTimestamp(System.currentTimeMillis());\n                device.setTypeDevice(byte1);\n                this.getHibernateTemplate().save(device);\n            }\n            System.out.println(\"hah\");\n        }catch (Exception e) {\n            // TODO: handle exception\n            logger.warn(\"wrong\");\n            logger.warn(e.getStackTrace()+e.getMessage());\n        }\n}\n</code></pre>\n\n<p>I change the id generator class to identity</p>\n\n<pre><code>&lt;id name=\"id\" type=\"int\"&gt;\n    &lt;column name=\"id\" /&gt;\n    &lt;generator class=\"identity\"  /&gt;\n &lt;/id&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":8695701,"reputation":409,"user_id":6507129,"display_name":"shubhranshu"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1521464421,"creation_date":1521464421,"answer_id":49363634,"question_id":16246675,"body_markdown":"In my case only flush() did not work. I had to use a clear() after flush().\r\n\r\n    public Object merge(final Object detachedInstance)\r\n        {\r\n            this.getHibernateTemplate().flush();\r\n            this.getHibernateTemplate().clear();\r\n            try\r\n            {\r\n                this.getHibernateTemplate().evict(detachedInstance);\r\n            }\r\n    }\r\n\r\n","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>In my case only flush() did not work. I had to use a clear() after flush().</p>\n\n<pre><code>public Object merge(final Object detachedInstance)\n    {\n        this.getHibernateTemplate().flush();\n        this.getHibernateTemplate().clear();\n        try\n        {\n            this.getHibernateTemplate().evict(detachedInstance);\n        }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":6329781,"reputation":1049,"user_id":4915001,"display_name":"rex roy"},"down_vote_count":0,"up_vote_count":10,"is_accepted":false,"score":10,"last_activity_date":1521789596,"creation_date":1521789596,"answer_id":49444349,"question_id":16246675,"body_markdown":"This means you are trying to save multiple rows in your table with the reference to the same object.\r\n\r\ncheck your Entity Class&#39; id property.\r\n\r\n    @Id\r\n    private Integer id;\r\nto\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(unique = true, nullable = false)\r\n    private Integer id;","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>This means you are trying to save multiple rows in your table with the reference to the same object.</p>\n\n<p>check your Entity Class' id property.</p>\n\n<pre><code>@Id\nprivate Integer id;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>@Id\n@GeneratedValue(strategy = GenerationType.IDENTITY)\n@Column(unique = true, nullable = false)\nprivate Integer id;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4296016,"reputation":407,"user_id":3511090,"display_name":"Jayen Chondigara"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695367497,"creation_date":1542723260,"answer_id":53394945,"question_id":16246675,"body_markdown":"If you use `EntityRepository` then use `saveAndFlush` instead of `save`.","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>If you use <code>EntityRepository</code> then use <code>saveAndFlush</code> instead of <code>save</code>.</p>\n"},{"tags":[],"owner":{"account_id":15840283,"reputation":1,"user_id":11428939,"display_name":"Aaron Byrnes"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1556569142,"creation_date":1556568728,"answer_id":55910186,"question_id":16246675,"body_markdown":"If left an expressions tab in my IDE open which was making a hibernate get call on the object causing this exception. I was trying to delete this same object. Also I had a breakpoint on the delete call which seems to be necessary to get this error to happen. Simply making another expressions tab to be the front tab or changing the setting so that the ide does not stop on breakpoints solved this problem.","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>If left an expressions tab in my IDE open which was making a hibernate get call on the object causing this exception. I was trying to delete this same object. Also I had a breakpoint on the delete call which seems to be necessary to get this error to happen. Simply making another expressions tab to be the front tab or changing the setting so that the ide does not stop on breakpoints solved this problem.</p>\n"},{"tags":[],"owner":{"account_id":13406436,"reputation":2189,"user_id":9895452,"display_name":"Sandeep Patel"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1574154522,"creation_date":1574154198,"answer_id":58930164,"question_id":16246675,"body_markdown":"Make Sure, your entity have same Generation Type with all Mapped Entitys\r\n\r\nEx : UserRole \r\n\r\n    public class UserRole extends AbstractDomain {\r\n    \r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.AUTO)\r\n    private Long id;\r\n    \r\n    private String longName;\r\n    \r\n    private String shortName;\r\n    \r\n    @Enumerated(EnumType.STRING)\r\n    private CommonStatus status;\r\n    \r\n    private String roleCode;\r\n    \r\n    private Long level;\r\n    \r\n    @Column(columnDefinition = &quot;integer default 0&quot;)\r\n    private Integer subRoleCount;\r\n    \r\n    private String modification;\r\n    \r\n    @ManyToOne(fetch = FetchType.LAZY)\r\n    private TypeOfUsers licenseType;\r\n    \r\n}\r\n\r\nModule : \r\n\r\n    public class Modules implements Serializable {\r\n    \r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.AUTO)\r\n    private Long id;\r\n    \r\n    private String longName;\r\n    \r\n    private String shortName;\r\n    \r\n}\r\n\r\nMain Entity with Mapping\r\n\r\n    public class RoleModules implements Serializable{\r\n        \r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.AUTO)\r\n    private Long id;\r\n    \r\n    @ManyToOne(fetch = FetchType.LAZY, cascade = CascadeType.MERGE)\r\n    private UserRole role;\r\n    \r\n    @ManyToOne(fetch = FetchType.LAZY, cascade = CascadeType.MERGE)\r\n    private Modules modules;\r\n    \r\n    @Type(type = &quot;yes_no&quot;)\r\n    private boolean isPrimaryModule;\r\n\r\n    public boolean getIsPrimaryModule() {\r\n        return isPrimaryModule;\r\n    }\r\n}\r\n\r\n\r\n","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>Make Sure, your entity have same Generation Type with all Mapped Entitys</p>\n\n<p>Ex : UserRole </p>\n\n<pre><code>public class UserRole extends AbstractDomain {\n\n@Id\n@GeneratedValue(strategy = GenerationType.AUTO)\nprivate Long id;\n\nprivate String longName;\n\nprivate String shortName;\n\n@Enumerated(EnumType.STRING)\nprivate CommonStatus status;\n\nprivate String roleCode;\n\nprivate Long level;\n\n@Column(columnDefinition = \"integer default 0\")\nprivate Integer subRoleCount;\n\nprivate String modification;\n\n@ManyToOne(fetch = FetchType.LAZY)\nprivate TypeOfUsers licenseType;\n</code></pre>\n\n<p>}</p>\n\n<p>Module : </p>\n\n<pre><code>public class Modules implements Serializable {\n\n@Id\n@GeneratedValue(strategy = GenerationType.AUTO)\nprivate Long id;\n\nprivate String longName;\n\nprivate String shortName;\n</code></pre>\n\n<p>}</p>\n\n<p>Main Entity with Mapping</p>\n\n<pre><code>public class RoleModules implements Serializable{\n\n@Id\n@GeneratedValue(strategy = GenerationType.AUTO)\nprivate Long id;\n\n@ManyToOne(fetch = FetchType.LAZY, cascade = CascadeType.MERGE)\nprivate UserRole role;\n\n@ManyToOne(fetch = FetchType.LAZY, cascade = CascadeType.MERGE)\nprivate Modules modules;\n\n@Type(type = \"yes_no\")\nprivate boolean isPrimaryModule;\n\npublic boolean getIsPrimaryModule() {\n    return isPrimaryModule;\n}\n</code></pre>\n\n<p>}</p>\n"},{"tags":[],"owner":{"account_id":17564422,"reputation":1,"user_id":12741607,"display_name":"George Michael"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1579430661,"creation_date":1579430661,"answer_id":59809268,"question_id":16246675,"body_markdown":"In addition to all the previous answers, a possible fix to this problem in a large scale project, if your using a Value Object for your classes don&#39;t set the id attribute in the VO Transformer class.","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>In addition to all the previous answers, a possible fix to this problem in a large scale project, if your using a Value Object for your classes don't set the id attribute in the VO Transformer class.</p>\n"},{"tags":[],"owner":{"account_id":14668216,"reputation":47,"user_id":10593431,"display_name":"Mahdi"},"down_vote_count":4,"up_vote_count":0,"is_accepted":false,"score":-4,"last_activity_date":1582630997,"creation_date":1582614370,"answer_id":60389154,"question_id":16246675,"body_markdown":"just commit current transaction. &lt;/br&gt;\r\n\r\n    currentSession.getTransaction().commit();\r\n\r\n&lt;/br&gt;\r\nnow you can begin another Transaction and do anything on entity","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>just commit current transaction. </p>\n\n<pre><code>currentSession.getTransaction().commit();\n</code></pre>\n\n<p>\nnow you can begin another Transaction and do anything on entity</p>\n"},{"tags":[],"owner":{"account_id":52873,"reputation":2689,"user_id":158037,"display_name":"user158037"},"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1602167391,"creation_date":1602167391,"answer_id":64264730,"question_id":16246675,"body_markdown":"Another case when same error message can by generated, custom `allocationSize`:\r\n\r\n    @Id\r\n    @Column(name = &quot;idpar&quot;)\r\n    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = &quot;paramsSequence&quot;)\r\n    @SequenceGenerator(name = &quot;paramsSequence&quot;, sequenceName = &quot;par_idpar_seq&quot;, allocationSize = 20)\r\n    private Long id;\r\n\r\nwithout matching\r\n\r\n    alter sequence par_idpar_seq increment 20;\r\n\r\ncan cause constraint validation during insert(that one is easy to understand) or ths &quot;a different object with the same identifier value was already associated with the session&quot; - this case was less obvious.","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>Another case when same error message can by generated, custom <code>allocationSize</code>:</p>\n<pre><code>@Id\n@Column(name = &quot;idpar&quot;)\n@GeneratedValue(strategy = GenerationType.SEQUENCE, generator = &quot;paramsSequence&quot;)\n@SequenceGenerator(name = &quot;paramsSequence&quot;, sequenceName = &quot;par_idpar_seq&quot;, allocationSize = 20)\nprivate Long id;\n</code></pre>\n<p>without matching</p>\n<pre><code>alter sequence par_idpar_seq increment 20;\n</code></pre>\n<p>can cause constraint validation during insert(that one is easy to understand) or ths &quot;a different object with the same identifier value was already associated with the session&quot; - this case was less obvious.</p>\n"},{"tags":[],"owner":{"account_id":13580955,"reputation":3,"user_id":9796970,"display_name":"Pradeepa Mendis"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1628111627,"creation_date":1628111627,"answer_id":68658097,"question_id":16246675,"body_markdown":"The reason for this issue is you have have different copies of objects referring into same raw in your child table, so spring trying to treat your object as new object but while saving it identifies there is a raw with same primary key. So it gives above error.\r\n\r\nBest solution for this issue is to load the whole object (parent entity with child entities) from DB (you already know the primary key of parent object), then update values in the object loaded from DB from your new object(which you were trying to save) and then save the object you loaded from the DB which has new values.\r\n\r\nThis will update your values in the DB without giving above error.\r\n\r\nPS- Do not need to update ids as they already exist in object loaded from DB, update only the values need to be changed ","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>The reason for this issue is you have have different copies of objects referring into same raw in your child table, so spring trying to treat your object as new object but while saving it identifies there is a raw with same primary key. So it gives above error.</p>\n<p>Best solution for this issue is to load the whole object (parent entity with child entities) from DB (you already know the primary key of parent object), then update values in the object loaded from DB from your new object(which you were trying to save) and then save the object you loaded from the DB which has new values.</p>\n<p>This will update your values in the DB without giving above error.</p>\n<p>PS- Do not need to update ids as they already exist in object loaded from DB, update only the values need to be changed</p>\n"},{"tags":[],"owner":{"account_id":1734438,"reputation":36245,"user_id":1587329,"accept_rate":94,"display_name":"serv-inc"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1640252570,"creation_date":1640252570,"answer_id":70460246,"question_id":16246675,"body_markdown":"Another way to solve this if you are using spring data:\r\n\r\n- replace calls to `entityManager.persist()` with calls to `repository.save()`, and\r\n- replace calls to `entityManager.query().getResultList()` etc with calls to `repository.findBy...`\r\n\r\nThis way, spring data keeps track of the objects. It enables multiple get and persist  calls.","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>Another way to solve this if you are using spring data:</p>\n<ul>\n<li>replace calls to <code>entityManager.persist()</code> with calls to <code>repository.save()</code>, and</li>\n<li>replace calls to <code>entityManager.query().getResultList()</code> etc with calls to <code>repository.findBy...</code></li>\n</ul>\n<p>This way, spring data keeps track of the objects. It enables multiple get and persist  calls.</p>\n"},{"tags":[],"owner":{"account_id":22721239,"reputation":1,"user_id":16885722,"display_name":"Asharudheen Mt"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695367516,"creation_date":1643796467,"answer_id":70953701,"question_id":16246675,"body_markdown":"instead of just `@Id`\r\ntry \r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.AUTO)\r\n\r\nit worked for me\r\n\r\n","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>instead of just <code>@Id</code>\ntry</p>\n<pre><code>@Id\n@GeneratedValue(strategy = GenerationType.AUTO)\n</code></pre>\n<p>it worked for me</p>\n"},{"tags":[],"owner":{"account_id":4195407,"reputation":456,"user_id":3436941,"accept_rate":75,"display_name":"Khasan 24-7"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1645077797,"creation_date":1645077797,"answer_id":71153182,"question_id":16246675,"body_markdown":"In my case, I had OneToOne relationship and after saving one row with a foreign key, attempt to save another row with the same foreign key throw the same exception. It means that requirement was not OneToOne relationship, but should be ManyToOne. So I have changed it to ManyToOne and it started working.","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>In my case, I had OneToOne relationship and after saving one row with a foreign key, attempt to save another row with the same foreign key throw the same exception. It means that requirement was not OneToOne relationship, but should be ManyToOne. So I have changed it to ManyToOne and it started working.</p>\n"},{"tags":[],"owner":{"account_id":20833834,"reputation":1,"user_id":15795723,"display_name":"Blas Albir"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1647283021,"creation_date":1647283021,"answer_id":71472673,"question_id":16246675,"body_markdown":"This error commonly occurs because you are violating a column of unique type or primary key when trying to insert repeated data.","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>This error commonly occurs because you are violating a column of unique type or primary key when trying to insert repeated data.</p>\n"},{"tags":[],"owner":{"account_id":19503564,"reputation":311,"user_id":14269062,"display_name":"Ritunjay kumar"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1653297949,"creation_date":1653297949,"answer_id":72346175,"question_id":16246675,"body_markdown":"make sure primary key is different for every entity.\r\n&gt; primary key must be unique","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>make sure primary key is different for every entity.</p>\n<blockquote>\n<p>primary key must be unique</p>\n</blockquote>\n"},{"tags":[],"owner":{"account_id":7661721,"reputation":545,"user_id":5806811,"accept_rate":50,"display_name":"Sultan Zhumatayev"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1680266019,"creation_date":1680266019,"answer_id":75898577,"question_id":16246675,"body_markdown":"Faced this error too.\r\nIn my case problem was in row which has somehow zero id.","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>Faced this error too.\nIn my case problem was in row which has somehow zero id.</p>\n"},{"tags":[],"owner":{"account_id":10460859,"reputation":1,"user_id":7711645,"display_name":"Lobots"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684449316,"creation_date":1684449316,"answer_id":76284900,"question_id":16246675,"body_markdown":"not using saveorupdate, as the experts say, is an aberration, using save and update or delete separately for Hibernate 5, for 6, this function is no longer used flush an clear","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>not using saveorupdate, as the experts say, is an aberration, using save and update or delete separately for Hibernate 5, for 6, this function is no longer used flush an clear</p>\n"},{"tags":[],"owner":{"account_id":3098417,"reputation":1074,"user_id":2623162,"accept_rate":67,"display_name":"Alex"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1686319905,"creation_date":1686317754,"answer_id":76440802,"question_id":16246675,"body_markdown":"I had this same error with JPA repository.\r\n\r\nThe save operation returns a completely different instance. Use that one.\r\n\r\nIn JPA repository, the javadoc of `CrudRepository.save()` operation states:\r\n\r\n&gt; Use the returned instance for further operations as the save operation\r\n&gt; might have changed the entity instance completely.\r\n\r\nSo, instead of:\r\n    \r\n    repository.save(fooEntity);\r\n    buzEntity.setFoo(fooEntity);\r\n\r\nUse the returned instance which is the one that is now merged into the EntityManager, for further operations:\r\n\r\n    Foo mergedFooEntity = repository.save(fooEntity);\r\n    buzEntity.setFoo(mergedFooEntity);\r\n","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>I had this same error with JPA repository.</p>\n<p>The save operation returns a completely different instance. Use that one.</p>\n<p>In JPA repository, the javadoc of <code>CrudRepository.save()</code> operation states:</p>\n<blockquote>\n<p>Use the returned instance for further operations as the save operation\nmight have changed the entity instance completely.</p>\n</blockquote>\n<p>So, instead of:</p>\n<pre><code>repository.save(fooEntity);\nbuzEntity.setFoo(fooEntity);\n</code></pre>\n<p>Use the returned instance which is the one that is now merged into the EntityManager, for further operations:</p>\n<pre><code>Foo mergedFooEntity = repository.save(fooEntity);\nbuzEntity.setFoo(mergedFooEntity);\n</code></pre>\n"},{"tags":[],"owner":{"account_id":21662503,"reputation":69,"user_id":15981431,"display_name":"Jonathan Mark Mwigo"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1686376605,"creation_date":1686376605,"answer_id":76444923,"question_id":16246675,"body_markdown":"Faced the same error, In my case B has a bi~directional one-to-many relationship with A and a `Cascade.ALL`.&lt;br /&gt;\r\nThe cause of this error in my case was me trying to insert B(I update A which auto saves B due to `Cascade.ALL`) to an existing row.&lt;br /&gt;\r\nTo solve this I had to check if B was updated then relate it to A and update or else don&#39;t relate B to A then update(Add an if condition to do the checks). This solve the issue in my case.","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>Faced the same error, In my case B has a bi~directional one-to-many relationship with A and a <code>Cascade.ALL</code>.<br />\nThe cause of this error in my case was me trying to insert B(I update A which auto saves B due to <code>Cascade.ALL</code>) to an existing row.<br />\nTo solve this I had to check if B was updated then relate it to A and update or else don't relate B to A then update(Add an if condition to do the checks). This solve the issue in my case.</p>\n"}],"owner":{"account_id":1697926,"reputation":1471,"user_id":1558877,"accept_rate":88,"display_name":"John"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":410825,"favorite_count":0,"down_vote_count":1,"up_vote_count":124,"accepted_answer_id":16246858,"answer_count":31,"score":123,"last_activity_date":1695367516,"creation_date":1367019335,"question_id":16246675,"body_markdown":"I essentially have some objects in this configuration (the real data model is a bit more complex):\r\n\r\n - A has a many-to-many relationship with B. (B has `inverse=&quot;true&quot;`)\r\n - B has a many-to-one relationship with C. (I have `cascade` set to `&quot;save-update&quot;`)\r\n - C is a kind of type/category table.\r\n\r\nAlso, I should probably mention that the primary keys are generated by the database on save.\r\n\r\nWith my data, I sometimes run into problems where A has a set of different B objects, and these B objects refer to the same C object.\r\n\r\nWhen I call `session.saveOrUpdate(myAObject)`, I get a hibernate error saying: `&quot;a different object with the same identifier value was already associated with the session: C&quot;`. I know that hibernate can&#39;t insert/update/delete the same object twice in the same session, but is there some way around this? This doesn&#39;t seem like it would be that uncommon of a situation.\r\n\r\nDuring my research of this problem, I have seen folks suggest the use of `session.merge()`, but when I do that, any &quot;conflicting&quot; objects get inserted into the database as blank objects with all values set to null. Clearly that isn&#39;t what we want.\r\n\r\n[Edit] Another thing I forgot to mention is that (for architectural reasons beyond my control), each read or write needs to be done in a separate session.","title":"Hibernate Error: a different object with the same identifier value was already associated with the session","body":"<p>I essentially have some objects in this configuration (the real data model is a bit more complex):</p>\n\n<ul>\n<li>A has a many-to-many relationship with B. (B has <code>inverse=\"true\"</code>)</li>\n<li>B has a many-to-one relationship with C. (I have <code>cascade</code> set to <code>\"save-update\"</code>)</li>\n<li>C is a kind of type/category table.</li>\n</ul>\n\n<p>Also, I should probably mention that the primary keys are generated by the database on save.</p>\n\n<p>With my data, I sometimes run into problems where A has a set of different B objects, and these B objects refer to the same C object.</p>\n\n<p>When I call <code>session.saveOrUpdate(myAObject)</code>, I get a hibernate error saying: <code>\"a different object with the same identifier value was already associated with the session: C\"</code>. I know that hibernate can't insert/update/delete the same object twice in the same session, but is there some way around this? This doesn't seem like it would be that uncommon of a situation.</p>\n\n<p>During my research of this problem, I have seen folks suggest the use of <code>session.merge()</code>, but when I do that, any \"conflicting\" objects get inserted into the database as blank objects with all values set to null. Clearly that isn't what we want.</p>\n\n<p>[Edit] Another thing I forgot to mention is that (for architectural reasons beyond my control), each read or write needs to be done in a separate session.</p>\n"},{"tags":["java","android","flutter","dart","nfc"],"owner":{"account_id":18582630,"reputation":61,"user_id":13541808,"display_name":"BatoulAlani"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":99,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1695367428,"creation_date":1675843253,"question_id":75382798,"body_markdown":"I am trying to use NFC Manager Plugin in my flutter app when I used Lock Nfc Function using these functions:\r\n\r\n*Handle Tag Function for locking card:*\r\n[![Handle Tag Function for locking card][1]][1]\r\n\r\n*Start session to use handle tag function:*\r\n\r\n[![Start session to use handle tag function][2]][2]\r\n\r\n\r\n[![using start session on screen][3]][3]\r\n\r\nBut on some android devices which have Android 13, when we try to use the lock function we face an error :\r\n[![enter image description here][4]][4]\r\n\r\nand we can&#39;t turn off The Nfc on the device until about 1 minute, then this error is shown:\r\n\r\n[![enter image description here][5]][5]\r\n\r\nalso, we try to use the example project on the plugin but it has the same problem.\r\n\r\nFlutter Doctor:\r\n[![Flutter doctor][6]][6]\r\n\r\nwe are still on this error trying to fix the issue, any solutions to fix this issue?\r\n\r\n  [1]: https://i.stack.imgur.com/2IAH3.png\r\n  [2]: https://i.stack.imgur.com/3btQe.png\r\n  [3]: https://i.stack.imgur.com/e4Pag.png\r\n  [4]: https://i.stack.imgur.com/MKDtf.jpg\r\n  [5]: https://i.stack.imgur.com/O5ntY.jpg\r\n  [6]: https://i.stack.imgur.com/0gkF1.jpg","title":"Wrote stack traces to tombstoned on Android 13 using NFC Manager plugin in flutter app","body":"<p>I am trying to use NFC Manager Plugin in my flutter app when I used Lock Nfc Function using these functions:</p>\n<p><em>Handle Tag Function for locking card:</em>\n<a href=\"https://i.stack.imgur.com/2IAH3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2IAH3.png\" alt=\"Handle Tag Function for locking card\" /></a></p>\n<p><em>Start session to use handle tag function:</em></p>\n<p><a href=\"https://i.stack.imgur.com/3btQe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3btQe.png\" alt=\"Start session to use handle tag function\" /></a></p>\n<p><a href=\"https://i.stack.imgur.com/e4Pag.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e4Pag.png\" alt=\"using start session on screen\" /></a></p>\n<p>But on some android devices which have Android 13, when we try to use the lock function we face an error :\n<a href=\"https://i.stack.imgur.com/MKDtf.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MKDtf.jpg\" alt=\"enter image description here\" /></a></p>\n<p>and we can't turn off The Nfc on the device until about 1 minute, then this error is shown:</p>\n<p><a href=\"https://i.stack.imgur.com/O5ntY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O5ntY.jpg\" alt=\"enter image description here\" /></a></p>\n<p>also, we try to use the example project on the plugin but it has the same problem.</p>\n<p>Flutter Doctor:\n<a href=\"https://i.stack.imgur.com/0gkF1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0gkF1.jpg\" alt=\"Flutter doctor\" /></a></p>\n<p>we are still on this error trying to fix the issue, any solutions to fix this issue?</p>\n"},{"tags":["java","maven"],"comments":[{"owner":{"account_id":8616011,"reputation":2950,"user_id":6452829,"display_name":"Mario Santini"},"score":0,"creation_date":1695122637,"post_id":77133878,"comment_id":135979139,"body_markdown":"I found some documentation by Maven: https://maven.apache.org/plugins/maven-jar-plugin/examples/create-test-jar.html","body":"I found some documentation by Maven: <a href=\"https://maven.apache.org/plugins/maven-jar-plugin/examples/create-test-jar.html\" rel=\"nofollow noreferrer\">maven.apache.org/plugins/maven-jar-plugin/examples/&hellip;</a>"},{"owner":{"account_id":888714,"reputation":34077,"user_id":927493,"accept_rate":61,"display_name":"J Fabian Meier"},"score":1,"creation_date":1695123287,"post_id":77133878,"comment_id":135979248,"body_markdown":"What is this for? Tests in `src/test/java` are meant to be run during the build. There is no need to package them into a JAR.","body":"What is this for? Tests in <code>src&#47;test&#47;java</code> are meant to be run during the build. There is no need to package them into a JAR."},{"owner":{"account_id":1712713,"reputation":223,"user_id":1570402,"accept_rate":44,"display_name":"Anand Murugan"},"score":0,"creation_date":1695123707,"post_id":77133878,"comment_id":135979327,"body_markdown":"This is some specific requirement to create the jar and run in on some different environment, because in that particular environment we can&#39;t build and bundle the jars.. so our aim is to create this jar as a executable one..","body":"This is some specific requirement to create the jar and run in on some different environment, because in that particular environment we can&#39;t build and bundle the jars.. so our aim is to create this jar as a executable one.."},{"owner":{"account_id":29073167,"reputation":1013,"user_id":22270964,"display_name":"Maksim Eliseev"},"score":0,"creation_date":1695131516,"post_id":77133878,"comment_id":135980994,"body_markdown":"Do you want to create a test jar for some testing purposes?","body":"Do you want to create a test jar for some testing purposes?"},{"owner":{"account_id":1712713,"reputation":223,"user_id":1570402,"accept_rate":44,"display_name":"Anand Murugan"},"score":0,"creation_date":1695142062,"post_id":77133878,"comment_id":135983304,"body_markdown":"Yes Maksim.. As said already this jar will be running in some different env.. Creating jars in diff env, push it another and run there..","body":"Yes Maksim.. As said already this jar will be running in some different env.. Creating jars in diff env, push it another and run there.."}],"answers":[{"tags":[],"owner":{"account_id":18182,"reputation":33673,"user_id":41423,"accept_rate":100,"display_name":"Nick Holt"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695123832,"creation_date":1695123832,"answer_id":77134261,"question_id":77133878,"body_markdown":"See [skipIfEmpty][1] configuration for the `maven-jar-plugin`.\r\n\r\nYou need something like:\r\n\r\n```\r\n&lt;plugin&gt;\r\n  &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n  &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;\r\n  &lt;configuration&gt;\r\n    &lt;skipIfEmpty&gt;true&lt;/skipIfEmpty&gt;\r\n  &lt;/configuration&gt;\r\n  &lt;executions&gt;\r\n    &lt;execution&gt;\r\n      &lt;goals&gt;\r\n        &lt;goal&gt;test-jar&lt;/goal&gt;\r\n      &lt;/goals&gt;\r\n    &lt;/execution&gt;\r\n  &lt;/executions&gt;\r\n&lt;/plugin&gt;\r\n```\r\n\r\nAnd you should stick to the default jar naming (remove the `finalName` from the configuration shown in your question) - messing with the jar names can have unexpected consequences.\r\n\r\n  [1]: https://maven.apache.org/plugins/maven-jar-plugin/jar-mojo.html#skipIfEmpty","title":"How to build the jar for the project having only test classes using maven build","body":"<p>See <a href=\"https://maven.apache.org/plugins/maven-jar-plugin/jar-mojo.html#skipIfEmpty\" rel=\"nofollow noreferrer\">skipIfEmpty</a> configuration for the <code>maven-jar-plugin</code>.</p>\n<p>You need something like:</p>\n<pre><code>&lt;plugin&gt;\n  &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n  &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;\n  &lt;configuration&gt;\n    &lt;skipIfEmpty&gt;true&lt;/skipIfEmpty&gt;\n  &lt;/configuration&gt;\n  &lt;executions&gt;\n    &lt;execution&gt;\n      &lt;goals&gt;\n        &lt;goal&gt;test-jar&lt;/goal&gt;\n      &lt;/goals&gt;\n    &lt;/execution&gt;\n  &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre>\n<p>And you should stick to the default jar naming (remove the <code>finalName</code> from the configuration shown in your question) - messing with the jar names can have unexpected consequences.</p>\n"},{"tags":[],"owner":{"account_id":1712713,"reputation":223,"user_id":1570402,"accept_rate":44,"display_name":"Anand Murugan"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695366891,"creation_date":1695366891,"answer_id":77155536,"question_id":77133878,"body_markdown":"The issue is solved by creating an assembly.xml and adding maven-assembly-plugin in the pom.xml. Now the jar is created with all the test classes along with the dependency classes too. \r\n\r\n    &lt;plugin&gt;\r\n                    &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;\r\n                    &lt;version&gt;3.6.0&lt;/version&gt;\r\n                    &lt;configuration&gt;\r\n                        &lt;descriptors&gt;src/main/assembly/assembly.xml&lt;/descriptors&gt;\r\n                    &lt;/configuration&gt;\r\n                    &lt;executions&gt;\r\n                        &lt;execution&gt;\r\n                            &lt;id&gt;make-assembly&lt;/id&gt;\r\n                            &lt;phase&gt;package&lt;/phase&gt;\r\n                            &lt;goals&gt;\r\n                                &lt;goal&gt;single&lt;/goal&gt;\r\n                            &lt;/goals&gt;\r\n                            &lt;configuration&gt;\r\n                                &lt;archive&gt;\r\n                                    &lt;manifest&gt;\r\n                                        &lt;mainClass&gt;mainclassName&lt;/mainClass&gt;\r\n                                    &lt;/manifest&gt;\r\n                                &lt;/archive&gt;\r\n                            &lt;/configuration&gt;\r\n                        &lt;/execution&gt;\r\n                    &lt;/executions&gt;\r\n                &lt;/plugin&gt;\r\n\r\n","title":"How to build the jar for the project having only test classes using maven build","body":"<p>The issue is solved by creating an assembly.xml and adding maven-assembly-plugin in the pom.xml. Now the jar is created with all the test classes along with the dependency classes too.</p>\n<pre><code>&lt;plugin&gt;\n                &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.6.0&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;descriptors&gt;src/main/assembly/assembly.xml&lt;/descriptors&gt;\n                &lt;/configuration&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;id&gt;make-assembly&lt;/id&gt;\n                        &lt;phase&gt;package&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;single&lt;/goal&gt;\n                        &lt;/goals&gt;\n                        &lt;configuration&gt;\n                            &lt;archive&gt;\n                                &lt;manifest&gt;\n                                    &lt;mainClass&gt;mainclassName&lt;/mainClass&gt;\n                                &lt;/manifest&gt;\n                            &lt;/archive&gt;\n                        &lt;/configuration&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n</code></pre>\n"}],"owner":{"account_id":1712713,"reputation":223,"user_id":1570402,"accept_rate":44,"display_name":"Anand Murugan"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":38,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1695366891,"creation_date":1695120436,"question_id":77133878,"body_markdown":"My Project is having only test classes inside src/test/java (No src/main/java folder). I want to build the project using maven and create the jar &lt;jarname&gt;-1.0.0-SNAPSHOT.jar file including all the classes.\r\nI am using the following pom.xml \r\n\r\n**pom.xml**\r\n\r\n        &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n    &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\r\n             xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n             xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n        &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n        &lt;build&gt;\r\n            &lt;plugins&gt;\r\n                &lt;plugin&gt;\r\n                    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n                    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\r\n                    &lt;configuration&gt;\r\n                        &lt;source&gt;11&lt;/source&gt;\r\n                        &lt;target&gt;11&lt;/target&gt;\r\n                    &lt;/configuration&gt;\r\n                &lt;/plugin&gt;\r\n                &lt;plugin&gt;\r\n                    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n                    &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;\r\n                    &lt;version&gt;3.3.0&lt;/version&gt;\r\n                    &lt;executions&gt;\r\n                        &lt;execution&gt;\r\n                            &lt;goals&gt;\r\n                                &lt;goal&gt;test-jar&lt;/goal&gt;\r\n                            &lt;/goals&gt;\r\n                            &lt;configuration&gt;\r\n                                &lt;finalName&gt;jarName&lt;/finalName&gt;&lt;!-- Name of the resulting JAR file --&gt;\r\n                                &lt;archive&gt;\r\n                                    &lt;manifest&gt;\r\n                                        &lt;addClasspath&gt;true&lt;/addClasspath&gt;\r\n                                        &lt;mainClass&gt;ClassNameWithPackageStructure&lt;/mainClass&gt;\r\n                                    &lt;/manifest&gt;\r\n                                &lt;/archive&gt;\r\n                            &lt;/configuration&gt;\r\n                        &lt;/execution&gt;\r\n                    &lt;/executions&gt;\r\n                &lt;/plugin&gt;\r\n            &lt;/plugins&gt;\r\n        &lt;/build&gt;\r\n    \r\n        &lt;parent&gt;\r\n            &lt;groupId&gt;GroupPackage&lt;/groupId&gt;\r\n            &lt;artifactId&gt;xxxxxxxxx&lt;/artifactId&gt;\r\n            &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;\r\n        &lt;/parent&gt;\r\n    \r\n        &lt;artifactId&gt;integration-tests&lt;/artifactId&gt;\r\n    \r\n        &lt;properties&gt;\r\n    \t\t........\r\n        &lt;/properties&gt;\r\n    \r\n        &lt;dependencies&gt;\r\n    \t\t..........\r\n        &lt;/dependencies&gt;\r\n    &lt;/project&gt;\r\n\r\n\r\nI am using maven package command and the build is success, but inside target folder, two jars (***jarName-tests.jar*** and ***jarName-1.0.0.SNAPSHOT.jar***) are generated with warning ***JAR will be empty - no content was marked for inclusion!***. When I checked the jars, ***jarName-tests.jar*** has the compiled classes inside and ***jarName-1.0.0.SNAPSHOT.jar*** not having the compiled classes. But my goal is to generate the ***jarName-1.0.0.SNAPSHOT.jar*** including all the classes.\r\n\r\nPlease correct me what I am doing wrong to get the proper jar.\r\n\r\n","title":"How to build the jar for the project having only test classes using maven build","body":"<p>My Project is having only test classes inside src/test/java (No src/main/java folder). I want to build the project using maven and create the jar -1.0.0-SNAPSHOT.jar file including all the classes.\nI am using the following pom.xml</p>\n<p><strong>pom.xml</strong></p>\n<pre><code>    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\n         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                &lt;configuration&gt;\n                    &lt;source&gt;11&lt;/source&gt;\n                    &lt;target&gt;11&lt;/target&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.3.0&lt;/version&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;test-jar&lt;/goal&gt;\n                        &lt;/goals&gt;\n                        &lt;configuration&gt;\n                            &lt;finalName&gt;jarName&lt;/finalName&gt;&lt;!-- Name of the resulting JAR file --&gt;\n                            &lt;archive&gt;\n                                &lt;manifest&gt;\n                                    &lt;addClasspath&gt;true&lt;/addClasspath&gt;\n                                    &lt;mainClass&gt;ClassNameWithPackageStructure&lt;/mainClass&gt;\n                                &lt;/manifest&gt;\n                            &lt;/archive&gt;\n                        &lt;/configuration&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n    &lt;parent&gt;\n        &lt;groupId&gt;GroupPackage&lt;/groupId&gt;\n        &lt;artifactId&gt;xxxxxxxxx&lt;/artifactId&gt;\n        &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;\n    &lt;/parent&gt;\n\n    &lt;artifactId&gt;integration-tests&lt;/artifactId&gt;\n\n    &lt;properties&gt;\n        ........\n    &lt;/properties&gt;\n\n    &lt;dependencies&gt;\n        ..........\n    &lt;/dependencies&gt;\n&lt;/project&gt;\n</code></pre>\n<p>I am using maven package command and the build is success, but inside target folder, two jars (<em><strong>jarName-tests.jar</strong></em> and <em><strong>jarName-1.0.0.SNAPSHOT.jar</strong></em>) are generated with warning <em><strong>JAR will be empty - no content was marked for inclusion!</strong></em>. When I checked the jars, <em><strong>jarName-tests.jar</strong></em> has the compiled classes inside and <em><strong>jarName-1.0.0.SNAPSHOT.jar</strong></em> not having the compiled classes. But my goal is to generate the <em><strong>jarName-1.0.0.SNAPSHOT.jar</strong></em> including all the classes.</p>\n<p>Please correct me what I am doing wrong to get the proper jar.</p>\n"},{"tags":["java","spring-boot","reactive","server-sent-events","flux"],"owner":{"account_id":14207449,"reputation":309,"user_id":10263578,"display_name":"Thomas P&#246;tzsch"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":22,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1695366849,"creation_date":1695366849,"question_id":77155530,"body_markdown":"I want to achieve the following:\r\n\r\n * Provide an endpoint &quot;/sse/bus&quot; that my frontend can use to subscribe to server sent events\r\n * Publish useful events to all subscribers\r\n * Subscribers only get the latest events, only the ones that were published _after_ they subscribed\r\n\r\nI created the following Flux sink:\r\n\r\n```java\r\nimport java.util.concurrent.BlockingQueue;\r\nimport java.util.concurrent.Executor;\r\nimport java.util.concurrent.LinkedBlockingQueue;\r\nimport java.util.concurrent.TimeUnit;\r\nimport java.util.function.Consumer;\r\nimport org.springframework.beans.factory.annotation.Qualifier;\r\nimport org.springframework.context.event.EventListener;\r\nimport org.springframework.stereotype.Service;\r\nimport reactor.core.publisher.FluxSink;\r\n\r\n@Service\r\npublic class FEBus implements Consumer&lt;FluxSink&lt;FEMessage&gt;&gt; {\r\n\r\n  private final Executor executor;\r\n  private final BlockingQueue&lt;FEMessage&gt; queue = new LinkedBlockingQueue&lt;&gt;();\r\n\r\n  FEBus(@Qualifier(&quot;applicationTaskExecutor&quot;) Executor executor) {\r\n    this.executor = executor;\r\n  }\r\n\r\n  @EventListener\r\n  public void on(FEMessage message) {\r\n    try {\r\n      this.queue.offer(message, 3, TimeUnit.SECONDS);\r\n    } catch (InterruptedException e) {\r\n      throw new IllegalStateException(&quot;Unable to offer the message to the FEBus: %s&quot;.formatted(e));\r\n    }\r\n  }\r\n\r\n  @Override\r\n  public void accept(FluxSink&lt;FEMessage&gt; sink) {\r\n\r\n    this.executor.execute(() -&gt; {\r\n      while (true) {\r\n        try {\r\n          final var message = queue.take();\r\n          sink.next(message);\r\n        } catch (InterruptedException e) {\r\n          throw new IllegalStateException(\r\n              &quot;Unable to take a message from the FEBus: %s&quot;.formatted(e));\r\n        }\r\n      }\r\n    });\r\n  }\r\n}\r\n```\r\n\r\nand a controller for the frontend:\r\n\r\n```java\r\nimport org.springframework.http.MediaType;\r\nimport org.springframework.stereotype.Controller;\r\nimport org.springframework.web.bind.annotation.GetMapping;\r\nimport reactor.core.publisher.Flux;\r\n\r\n@Controller\r\npublic class FEBusController {\r\n\r\n  private final Flux&lt;FEMessage&gt; notifications;\r\n\r\n  public FEBusController(FEBus febus) {\r\n    this.notifications = Flux.create(febus).share();\r\n    // this.notifications.subscribe().dispose();\r\n\r\n  }\r\n\r\n  @GetMapping(path = &quot;/sse/bus&quot;, produces = MediaType.TEXT_EVENT_STREAM_VALUE)\r\n  public Flux&lt;FEMessage&gt; streamNotifications() {\r\n    return notifications;\r\n  }\r\n\r\n}\r\n```\r\n\r\nMy frontend can successfully subscribe and receives all events, nearly everything works as expected, however:\r\n\r\nUntil the first subscriber subscribes via the endpoint, the data is cached. The moment the first frontend subscribes, he receives all messages that built up until that moment.\r\n\r\nI am aware that [the documentation states][1] &quot;Nothing Happens Until You subscribe()&quot; -- this is confirmed by uncommenting l.13 in the controller.\r\n\r\nBut it is not clear to me\r\n* how/where the data is cached?\r\n* how to circumvent the behaviour correctly?\r\n\r\nAgain, the goal is to provide the events that occur _after_ the frontend subscribes and ignore all that happened before that.\r\n\r\n  [1]: https://projectreactor.io/docs/core/release/reference/index.html#reactive.subscribe","title":"Flux seems to cache until the first SSE subscriber","body":"<p>I want to achieve the following:</p>\n<ul>\n<li>Provide an endpoint &quot;/sse/bus&quot; that my frontend can use to subscribe to server sent events</li>\n<li>Publish useful events to all subscribers</li>\n<li>Subscribers only get the latest events, only the ones that were published <em>after</em> they subscribed</li>\n</ul>\n<p>I created the following Flux sink:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.util.concurrent.BlockingQueue;\nimport java.util.concurrent.Executor;\nimport java.util.concurrent.LinkedBlockingQueue;\nimport java.util.concurrent.TimeUnit;\nimport java.util.function.Consumer;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.springframework.context.event.EventListener;\nimport org.springframework.stereotype.Service;\nimport reactor.core.publisher.FluxSink;\n\n@Service\npublic class FEBus implements Consumer&lt;FluxSink&lt;FEMessage&gt;&gt; {\n\n  private final Executor executor;\n  private final BlockingQueue&lt;FEMessage&gt; queue = new LinkedBlockingQueue&lt;&gt;();\n\n  FEBus(@Qualifier(&quot;applicationTaskExecutor&quot;) Executor executor) {\n    this.executor = executor;\n  }\n\n  @EventListener\n  public void on(FEMessage message) {\n    try {\n      this.queue.offer(message, 3, TimeUnit.SECONDS);\n    } catch (InterruptedException e) {\n      throw new IllegalStateException(&quot;Unable to offer the message to the FEBus: %s&quot;.formatted(e));\n    }\n  }\n\n  @Override\n  public void accept(FluxSink&lt;FEMessage&gt; sink) {\n\n    this.executor.execute(() -&gt; {\n      while (true) {\n        try {\n          final var message = queue.take();\n          sink.next(message);\n        } catch (InterruptedException e) {\n          throw new IllegalStateException(\n              &quot;Unable to take a message from the FEBus: %s&quot;.formatted(e));\n        }\n      }\n    });\n  }\n}\n</code></pre>\n<p>and a controller for the frontend:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import org.springframework.http.MediaType;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport reactor.core.publisher.Flux;\n\n@Controller\npublic class FEBusController {\n\n  private final Flux&lt;FEMessage&gt; notifications;\n\n  public FEBusController(FEBus febus) {\n    this.notifications = Flux.create(febus).share();\n    // this.notifications.subscribe().dispose();\n\n  }\n\n  @GetMapping(path = &quot;/sse/bus&quot;, produces = MediaType.TEXT_EVENT_STREAM_VALUE)\n  public Flux&lt;FEMessage&gt; streamNotifications() {\n    return notifications;\n  }\n\n}\n</code></pre>\n<p>My frontend can successfully subscribe and receives all events, nearly everything works as expected, however:</p>\n<p>Until the first subscriber subscribes via the endpoint, the data is cached. The moment the first frontend subscribes, he receives all messages that built up until that moment.</p>\n<p>I am aware that <a href=\"https://projectreactor.io/docs/core/release/reference/index.html#reactive.subscribe\" rel=\"nofollow noreferrer\">the documentation states</a> &quot;Nothing Happens Until You subscribe()&quot; -- this is confirmed by uncommenting l.13 in the controller.</p>\n<p>But it is not clear to me</p>\n<ul>\n<li>how/where the data is cached?</li>\n<li>how to circumvent the behaviour correctly?</li>\n</ul>\n<p>Again, the goal is to provide the events that occur <em>after</em> the frontend subscribes and ignore all that happened before that.</p>\n"},{"tags":["java","spring","spring-boot","micrometer","spring-micrometer"],"comments":[{"owner":{"account_id":11377012,"reputation":12762,"user_id":8340997,"display_name":"Anish B."},"score":0,"creation_date":1695019685,"post_id":77100008,"comment_id":135962774,"body_markdown":"Does your app use spring-boot?","body":"Does your app use spring-boot?"},{"owner":{"account_id":2519985,"reputation":3670,"user_id":2190546,"accept_rate":83,"display_name":"J Freebird"},"score":1,"creation_date":1695032053,"post_id":77100008,"comment_id":135965088,"body_markdown":"@AnishB. Yes, it&#39;s a spring boot app.","body":"@AnishB. Yes, it&#39;s a spring boot app."},{"owner":{"account_id":22562332,"reputation":582,"user_id":16749821,"display_name":"Hans-Christian"},"score":0,"creation_date":1695121895,"post_id":77100008,"comment_id":135978999,"body_markdown":"I would say the first option since Micrometer has a Map of all the Meters. The register method will either create a new Gauge or return an existing one if the combination of the name and tags already was used.\n(see the JavaDoc on the register method for more details)\n\nInstead of using the Gauge builder directly, you can use the gauge method on the registry\n\nExample:\nmeterRegistry.gauge(&quot;withdraw.cycle&quot;, \n    Tags.of(&quot;currency&quot;, currency),\n    minutes);","body":"I would say the first option since Micrometer has a Map of all the Meters. The register method will either create a new Gauge or return an existing one if the combination of the name and tags already was used. (see the JavaDoc on the register method for more details)  Instead of using the Gauge builder directly, you can use the gauge method on the registry  Example: meterRegistry.gauge(&quot;withdraw.cycle&quot;,      Tags.of(&quot;currency&quot;, currency),     minutes);"}],"answers":[{"tags":[],"owner":{"account_id":4470098,"reputation":284,"user_id":3636639,"display_name":"silh"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1695123764,"creation_date":1695123764,"answer_id":77134255,"question_id":77100008,"body_markdown":"You are right about micrometer not storing the reference to a gauge, so your second approach looks correct and in order with what is mentioned in micrometer [documentation][1]:\r\n```java\r\n// maintain a reference to myGauge\r\nAtomicInteger myGauge = registry.gauge(&quot;numberGauge&quot;, new AtomicInteger(0));\r\n\r\n// ... elsewhere you can update the value it holds using the object reference\r\nmyGauge.set(27);\r\nmyGauge.set(11);\r\n```\r\nI would, however, change that code a bit, as it has come race conditions:\r\n```java\r\n  private final ConcurrentMap&lt;String, AtomicLong&gt; cycleGaugeMap = new ConcurrentHashMap&lt;&gt;();\r\n  // Use cycleGaugeMap to hold the reference to the gauge\r\n  private void updateGauge(String currency, int minutes) {\r\n    cycleGaugeMap.compute(currency, (k, v) -&gt; {\r\n      if (v == null) {\r\n        v = meterRegistry.gauge(&quot;withdraw.cycle&quot;, Tags.of(&quot;currency&quot;, currency), new AtomicLong(minutes));\r\n      } else {\r\n        v.set(minutes);\r\n      }\r\n      return v;\r\n    });\r\n  }\r\n```\r\n\r\n  [1]: https://micrometer.io/docs/concepts#_gauges","title":"Java Update Micrometer Gauge with Dynamic Labels","body":"<p>You are right about micrometer not storing the reference to a gauge, so your second approach looks correct and in order with what is mentioned in micrometer <a href=\"https://micrometer.io/docs/concepts#_gauges\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>// maintain a reference to myGauge\nAtomicInteger myGauge = registry.gauge(&quot;numberGauge&quot;, new AtomicInteger(0));\n\n// ... elsewhere you can update the value it holds using the object reference\nmyGauge.set(27);\nmyGauge.set(11);\n</code></pre>\n<p>I would, however, change that code a bit, as it has come race conditions:</p>\n<pre class=\"lang-java prettyprint-override\"><code>  private final ConcurrentMap&lt;String, AtomicLong&gt; cycleGaugeMap = new ConcurrentHashMap&lt;&gt;();\n  // Use cycleGaugeMap to hold the reference to the gauge\n  private void updateGauge(String currency, int minutes) {\n    cycleGaugeMap.compute(currency, (k, v) -&gt; {\n      if (v == null) {\n        v = meterRegistry.gauge(&quot;withdraw.cycle&quot;, Tags.of(&quot;currency&quot;, currency), new AtomicLong(minutes));\n      } else {\n        v.set(minutes);\n      }\n      return v;\n    });\n  }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":11377012,"reputation":12762,"user_id":8340997,"display_name":"Anish B."},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1695174515,"creation_date":1695141831,"answer_id":77136467,"question_id":77100008,"body_markdown":"Kindly follow this github issue [here][1]. \r\n\r\n**To Summarize:**\r\n\r\n- First approach to update gauge is via [MultiGauge][2]:\r\n\r\n&gt; By definition, Micrometer supports one special type of Gauge, called a\r\n&gt; `MultiGauge`, to help manage gauging a growing or shrinking list of\r\n&gt; criteria. This feature lets you select a set of well-bounded but\r\n&gt; slightly changing set of criteria from something like an SQL query and\r\n&gt; report some metric for each row as a Gauge.\r\n\r\nWorking example:\r\n\r\n    public class Example {\r\n    \r\n        private static final SimpleMeterRegistry registry = new SimpleMeterRegistry();\r\n        private static final MultiGauge gauge = MultiGauge.builder(&quot;withdraw.cycle&quot;).register(registry);\r\n\r\n        private static final Map&lt;String, Number&gt; values = new ConcurrentHashMap&lt;&gt;(); \r\n    \r\n        private static void updateGauge(String currency, int minutes) {\r\n            values.put(currency, minutes);\r\n            List&lt;MultiGauge.Row&lt;?&gt;&gt; rows = values.entrySet()\r\n                .stream()\r\n                .map(row -&gt; MultiGauge.Row.of(Tags.of(&quot;currency&quot;, row.getKey()), row.getValue()))\r\n                .collect(Collectors.toList());\r\n            gauge.register(rows, true);\r\n        }\r\n    \r\n        public static void main(String[] args) throws InterruptedException {\r\n           updateGauge(&quot;Rupee&quot;, 1);\r\n           System.out.println(registry.getMetersAsString());\r\n           System.out.println(&quot;--------&quot;);\r\n           updateGauge(&quot;Dollar&quot;, 2);\r\n           System.out.println(registry.getMetersAsString());\r\n           System.out.println(&quot;--------&quot;);\r\n           updateGauge(&quot;Rupee&quot;, 3);\r\n           System.out.println(registry.getMetersAsString());\r\n        }\r\nOutput:\r\n\r\n    withdraw.cycle(GAUGE)[currency=&#39;Rupee&#39;]; value=1.0\r\n    --------\r\n    withdraw.cycle(GAUGE)[currency=&#39;Dollar&#39;]; value=2.0\r\n    withdraw.cycle(GAUGE)[currency=&#39;Rupee&#39;]; value=1.0\r\n    --------\r\n    withdraw.cycle(GAUGE)[currency=&#39;Dollar&#39;]; value=2.0\r\n    withdraw.cycle(GAUGE)[currency=&#39;Rupee&#39;]; value=3.0\r\n\r\n- Second Approach to update gauge via `Gauge` itself.\r\n\r\nWorking example:\r\n\r\n    public class Example {\r\n    \r\n        private static final SimpleMeterRegistry registry = new SimpleMeterRegistry();\r\n    \r\n        private static final Map&lt;String, Number&gt; values = new ConcurrentHashMap&lt;&gt;();\r\n    \r\n        private static void updateGauge(String currency, int minutes) {\r\n            Tags tags = Tags.of(&quot;currency&quot;, currency);\r\n            values.put(currency, minutes);\r\n            if (registry.find(&quot;withdraw.cycle&quot;).tags(tags).gauge() == null) {\r\n                Gauge.builder(&quot;withdraw.cycle&quot;, () -&gt; values.get(currency))\r\n                        .tags(tags)\r\n                        .register(registry);\r\n            }\r\n        }\r\n    \r\n    \r\n        public static void main(String[] args) throws InterruptedException {\r\n            updateGauge(&quot;Rupee&quot;, 1);\r\n            System.out.println(registry.getMetersAsString());\r\n            System.out.println(&quot;--------&quot;);\r\n            updateGauge(&quot;Dollar&quot;, 2);\r\n            System.out.println(registry.getMetersAsString());\r\n            System.out.println(&quot;--------&quot;);\r\n            updateGauge(&quot;Rupee&quot;, 3);\r\n            System.out.println(registry.getMetersAsString());\r\n        }\r\n    }\r\n\r\n\r\nOutput:\r\n\r\n    withdraw.cycle(GAUGE)[currency=&#39;Rupee&#39;]; value=1.0\r\n    --------\r\n    withdraw.cycle(GAUGE)[currency=&#39;Dollar&#39;]; value=2.0\r\n    withdraw.cycle(GAUGE)[currency=&#39;Rupee&#39;]; value=1.0\r\n    --------\r\n    withdraw.cycle(GAUGE)[currency=&#39;Dollar&#39;]; value=2.0\r\n    withdraw.cycle(GAUGE)[currency=&#39;Rupee&#39;]; value=3.0\r\n\r\nI guess this is the optimal approach that you were looking for.\r\n\r\n\r\n  [1]: https://github.com/micrometer-metrics/micrometer/issues/3826\r\n  [2]: https://micrometer.io/docs/concepts#_multi_gauge\r\n","title":"Java Update Micrometer Gauge with Dynamic Labels","body":"<p>Kindly follow this github issue <a href=\"https://github.com/micrometer-metrics/micrometer/issues/3826\" rel=\"nofollow noreferrer\">here</a>.</p>\n<p><strong>To Summarize:</strong></p>\n<ul>\n<li>First approach to update gauge is via <a href=\"https://micrometer.io/docs/concepts#_multi_gauge\" rel=\"nofollow noreferrer\">MultiGauge</a>:</li>\n</ul>\n<blockquote>\n<p>By definition, Micrometer supports one special type of Gauge, called a\n<code>MultiGauge</code>, to help manage gauging a growing or shrinking list of\ncriteria. This feature lets you select a set of well-bounded but\nslightly changing set of criteria from something like an SQL query and\nreport some metric for each row as a Gauge.</p>\n</blockquote>\n<p>Working example:</p>\n<pre><code>public class Example {\n\n    private static final SimpleMeterRegistry registry = new SimpleMeterRegistry();\n    private static final MultiGauge gauge = MultiGauge.builder(&quot;withdraw.cycle&quot;).register(registry);\n\n    private static final Map&lt;String, Number&gt; values = new ConcurrentHashMap&lt;&gt;(); \n\n    private static void updateGauge(String currency, int minutes) {\n        values.put(currency, minutes);\n        List&lt;MultiGauge.Row&lt;?&gt;&gt; rows = values.entrySet()\n            .stream()\n            .map(row -&gt; MultiGauge.Row.of(Tags.of(&quot;currency&quot;, row.getKey()), row.getValue()))\n            .collect(Collectors.toList());\n        gauge.register(rows, true);\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n       updateGauge(&quot;Rupee&quot;, 1);\n       System.out.println(registry.getMetersAsString());\n       System.out.println(&quot;--------&quot;);\n       updateGauge(&quot;Dollar&quot;, 2);\n       System.out.println(registry.getMetersAsString());\n       System.out.println(&quot;--------&quot;);\n       updateGauge(&quot;Rupee&quot;, 3);\n       System.out.println(registry.getMetersAsString());\n    }\n</code></pre>\n<p>Output:</p>\n<pre><code>withdraw.cycle(GAUGE)[currency='Rupee']; value=1.0\n--------\nwithdraw.cycle(GAUGE)[currency='Dollar']; value=2.0\nwithdraw.cycle(GAUGE)[currency='Rupee']; value=1.0\n--------\nwithdraw.cycle(GAUGE)[currency='Dollar']; value=2.0\nwithdraw.cycle(GAUGE)[currency='Rupee']; value=3.0\n</code></pre>\n<ul>\n<li>Second Approach to update gauge via <code>Gauge</code> itself.</li>\n</ul>\n<p>Working example:</p>\n<pre><code>public class Example {\n\n    private static final SimpleMeterRegistry registry = new SimpleMeterRegistry();\n\n    private static final Map&lt;String, Number&gt; values = new ConcurrentHashMap&lt;&gt;();\n\n    private static void updateGauge(String currency, int minutes) {\n        Tags tags = Tags.of(&quot;currency&quot;, currency);\n        values.put(currency, minutes);\n        if (registry.find(&quot;withdraw.cycle&quot;).tags(tags).gauge() == null) {\n            Gauge.builder(&quot;withdraw.cycle&quot;, () -&gt; values.get(currency))\n                    .tags(tags)\n                    .register(registry);\n        }\n    }\n\n\n    public static void main(String[] args) throws InterruptedException {\n        updateGauge(&quot;Rupee&quot;, 1);\n        System.out.println(registry.getMetersAsString());\n        System.out.println(&quot;--------&quot;);\n        updateGauge(&quot;Dollar&quot;, 2);\n        System.out.println(registry.getMetersAsString());\n        System.out.println(&quot;--------&quot;);\n        updateGauge(&quot;Rupee&quot;, 3);\n        System.out.println(registry.getMetersAsString());\n    }\n}\n</code></pre>\n<p>Output:</p>\n<pre><code>withdraw.cycle(GAUGE)[currency='Rupee']; value=1.0\n--------\nwithdraw.cycle(GAUGE)[currency='Dollar']; value=2.0\nwithdraw.cycle(GAUGE)[currency='Rupee']; value=1.0\n--------\nwithdraw.cycle(GAUGE)[currency='Dollar']; value=2.0\nwithdraw.cycle(GAUGE)[currency='Rupee']; value=3.0\n</code></pre>\n<p>I guess this is the optimal approach that you were looking for.</p>\n"},{"tags":[],"owner":{"account_id":2730061,"reputation":1242,"user_id":2867361,"accept_rate":100,"display_name":"CHHIBI AMOR"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1695220733,"creation_date":1695220733,"answer_id":77143541,"question_id":77100008,"body_markdown":"Micrometer doesn&#39;t provide a direct API for updating the value of a gauge with dynamically retrieved labels, so your approaches are reasonable workarounds. However, your second approach using a `ConcurrentHashMap` to hold references to the gauges can be improved for clarity and safety. Here&#39;s an updated version of your second approach:\r\n\r\n```java\r\nprivate final ConcurrentMap&lt;Tags, AtomicLong&gt; cycleGaugeMap = new ConcurrentHashMap&lt;&gt;();\r\n\r\nprivate void updateGauge(String currency, int minutes) {\r\n    Tags tags = Tags.of(&quot;currency&quot;, currency);\r\n    AtomicLong gaugeValue = cycleGaugeMap.computeIfAbsent(tags, key -&gt; {\r\n        AtomicLong gauge = new AtomicLong(minutes);\r\n        meterRegistry.gauge(&quot;withdraw.cycle&quot;, tags, gauge);\r\n        return gauge;\r\n    });\r\n\r\n    gaugeValue.set(minutes);\r\n}\r\n```\r\n\r\nIn this updated version, `computeIfAbsent` is used to atomically check if the gauge already exists in the `cycleGaugeMap`. If it doesn&#39;t exist, it creates the gauge and registers it with Micrometer before returning the reference to it. This ensures that gauge creation and retrieval are done atomically and avoids the need to separately check and putIfAbsent.\r\n\r\nThis approach is more concise and still thread-safe. It also clearly conveys your intention of creating and managing gauges dynamically while keeping track of them for future updates.\r\n\r\nOverall, this updated version of your second approach is a reasonable and elegant way to manage dynamically labeled gauges in Micrometer.","title":"Java Update Micrometer Gauge with Dynamic Labels","body":"<p>Micrometer doesn't provide a direct API for updating the value of a gauge with dynamically retrieved labels, so your approaches are reasonable workarounds. However, your second approach using a <code>ConcurrentHashMap</code> to hold references to the gauges can be improved for clarity and safety. Here's an updated version of your second approach:</p>\n<pre class=\"lang-java prettyprint-override\"><code>private final ConcurrentMap&lt;Tags, AtomicLong&gt; cycleGaugeMap = new ConcurrentHashMap&lt;&gt;();\n\nprivate void updateGauge(String currency, int minutes) {\n    Tags tags = Tags.of(&quot;currency&quot;, currency);\n    AtomicLong gaugeValue = cycleGaugeMap.computeIfAbsent(tags, key -&gt; {\n        AtomicLong gauge = new AtomicLong(minutes);\n        meterRegistry.gauge(&quot;withdraw.cycle&quot;, tags, gauge);\n        return gauge;\n    });\n\n    gaugeValue.set(minutes);\n}\n</code></pre>\n<p>In this updated version, <code>computeIfAbsent</code> is used to atomically check if the gauge already exists in the <code>cycleGaugeMap</code>. If it doesn't exist, it creates the gauge and registers it with Micrometer before returning the reference to it. This ensures that gauge creation and retrieval are done atomically and avoids the need to separately check and putIfAbsent.</p>\n<p>This approach is more concise and still thread-safe. It also clearly conveys your intention of creating and managing gauges dynamically while keeping track of them for future updates.</p>\n<p>Overall, this updated version of your second approach is a reasonable and elegant way to manage dynamically labeled gauges in Micrometer.</p>\n"}],"owner":{"account_id":2519985,"reputation":3670,"user_id":2190546,"accept_rate":83,"display_name":"J Freebird"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":520,"favorite_count":0,"down_vote_count":0,"up_vote_count":4,"accepted_answer_id":77136467,"answer_count":3,"score":4,"last_activity_date":1695366678,"creation_date":1694633377,"question_id":77100008,"body_markdown":"I&#39;m using Java Micrometer gauge to measure a metric that has a range of labels. The label values are dynamically retrieved but bounded. \r\n\r\nFor example: I have `withdraw.cycle` metric with label `currency`.\r\n\r\nBecause Micrometer doesn&#39;t hold the reference to the gauge itself, it makes the code look quite cumbersome. \r\n\r\nI&#39;ve got two ways to do it:\r\n\r\n\r\n    private void updateGauge(String currency, int minutes) {\r\n        Tags tags = Tags.of(&quot;currency&quot;, currency);\r\n        Gauge.builder(&quot;withdraw.cycle&quot;,() -&gt; minutes)\r\n             .tags(tags)\r\n             .strongReference(true)\r\n             .register(meterRegistry);\r\n    }\r\n\r\n**OR**\r\n\r\n\r\n    private final Map&lt;Tags, AtomicLong&gt; cycleGaugeMap = new ConcurrentHashMap&lt;&gt;();\r\n    \r\n    // Use cycleGaugeMap to hold the reference to the gauge\r\n    private void updateGauge(String currency, int minutes) {\r\n        Tags tags = Tags.of(&quot;currency&quot;, currency);\r\n        if (cycleGaugeMap.containsKey(tags)) {\r\n            cycleGaugeMap.get(tags).set(minutes);\r\n        } else {\r\n            AtomicLong old = cycleGaugeMap.putIfAbsent(tags, meterRegistry.gauge(&quot;withdraw.cycle&quot;, tags,\r\n                                                                                         new AtomicLong(minutes)));\r\n            if (old != null) {\r\n                old.set(minutes);\r\n            }\r\n        }\r\n     }\r\n\r\n\r\n**Question:** Are they the right ways to do it or does Micrometer have an API that I&#39;m not aware of for such cases? I&#39;d really want to know a &quot;standard&quot; and elegant way to do it.","title":"Java Update Micrometer Gauge with Dynamic Labels","body":"<p>I'm using Java Micrometer gauge to measure a metric that has a range of labels. The label values are dynamically retrieved but bounded.</p>\n<p>For example: I have <code>withdraw.cycle</code> metric with label <code>currency</code>.</p>\n<p>Because Micrometer doesn't hold the reference to the gauge itself, it makes the code look quite cumbersome.</p>\n<p>I've got two ways to do it:</p>\n<pre><code>private void updateGauge(String currency, int minutes) {\n    Tags tags = Tags.of(&quot;currency&quot;, currency);\n    Gauge.builder(&quot;withdraw.cycle&quot;,() -&gt; minutes)\n         .tags(tags)\n         .strongReference(true)\n         .register(meterRegistry);\n}\n</code></pre>\n<p><strong>OR</strong></p>\n<pre><code>private final Map&lt;Tags, AtomicLong&gt; cycleGaugeMap = new ConcurrentHashMap&lt;&gt;();\n\n// Use cycleGaugeMap to hold the reference to the gauge\nprivate void updateGauge(String currency, int minutes) {\n    Tags tags = Tags.of(&quot;currency&quot;, currency);\n    if (cycleGaugeMap.containsKey(tags)) {\n        cycleGaugeMap.get(tags).set(minutes);\n    } else {\n        AtomicLong old = cycleGaugeMap.putIfAbsent(tags, meterRegistry.gauge(&quot;withdraw.cycle&quot;, tags,\n                                                                                     new AtomicLong(minutes)));\n        if (old != null) {\n            old.set(minutes);\n        }\n    }\n }\n</code></pre>\n<p><strong>Question:</strong> Are they the right ways to do it or does Micrometer have an API that I'm not aware of for such cases? I'd really want to know a &quot;standard&quot; and elegant way to do it.</p>\n"},{"tags":["java","apache-poi"],"comments":[{"owner":{"account_id":4853829,"reputation":57305,"user_id":3915431,"display_name":"Axel Richter"},"score":0,"creation_date":1520765638,"post_id":49219092,"comment_id":85442033,"body_markdown":"See https://stackoverflow.com/questions/34647624/how-to-colspan-a-table-in-word-with-apache-poi/34663420#34663420","body":"See <a href=\"https://stackoverflow.com/questions/34647624/how-to-colspan-a-table-in-word-with-apache-poi/34663420#34663420\" title=\"how to colspan a table in word with apache poi\">stackoverflow.com/questions/34647624/&hellip;</a>"},{"owner":{"account_id":11401943,"reputation":72,"user_id":8358646,"accept_rate":75,"display_name":"Joel George"},"score":0,"creation_date":1520766306,"post_id":49219092,"comment_id":85442208,"body_markdown":"@AxelRichter. I also tried this method. I got the output as row 0, col 0 as verticaly merged. I need columns to be vertically merged. I am using WPS writer for the docx file. Will that be the problem?","body":"@AxelRichter. I also tried this method. I got the output as row 0, col 0 as verticaly merged. I need columns to be vertically merged. I am using WPS writer for the docx file. Will that be the problem?"},{"owner":{"account_id":4853829,"reputation":57305,"user_id":3915431,"display_name":"Axel Richter"},"score":0,"creation_date":1520766850,"post_id":49219092,"comment_id":85442361,"body_markdown":"Sure because the code does exactly this using `mergeCellVertically(table, 0, 0, 1);`. But it also does merging horizontally row 1, col 2 using `mergeCellHorizontally(table, 1, 2, 3);` and row 2, col 1 using `mergeCellHorizontally(table, 2, 1, 4);`.","body":"Sure because the code does exactly this using <code>mergeCellVertically(table, 0, 0, 1);</code>. But it also does merging horizontally row 1, col 2 using <code>mergeCellHorizontally(table, 1, 2, 3);</code> and row 2, col 1 using <code>mergeCellHorizontally(table, 2, 1, 4);</code>."},{"owner":{"account_id":11401943,"reputation":72,"user_id":8358646,"accept_rate":75,"display_name":"Joel George"},"score":0,"creation_date":1520767537,"post_id":49219092,"comment_id":85442552,"body_markdown":"@AxelRichter. Yes. Vertical merging is happening. But horizontal merging is not happening. This is the output i got after commenting the vertical merging code. [Pic](https://prnt.sc/ipn0ic)","body":"@AxelRichter. Yes. Vertical merging is happening. But horizontal merging is not happening. This is the output i got after commenting the vertical merging code. <a href=\"https://prnt.sc/ipn0ic\" rel=\"nofollow noreferrer\">Pic</a>"},{"owner":{"account_id":4853829,"reputation":57305,"user_id":3915431,"display_name":"Axel Richter"},"score":0,"creation_date":1520767818,"post_id":49219092,"comment_id":85442609,"body_markdown":"The code in my linked answer works (tested) for Microsoft Office Word from 2007 on upwards. Please show the exact code you are using and the exact result in your  `WPS writer` as a screen shot.","body":"The code in my linked answer works (tested) for Microsoft Office Word from 2007 on upwards. Please show the exact code you are using and the exact result in your  <code>WPS writer</code> as a screen shot."},{"owner":{"account_id":11401943,"reputation":72,"user_id":8358646,"accept_rate":75,"display_name":"Joel George"},"score":0,"creation_date":1520768093,"post_id":49219092,"comment_id":85442676,"body_markdown":"@AxelRichter i used the same code provided in the link. except commented (mergeCellVertically(table, 0, 0, 1); ).This is the ouptui I got in WPS writer:[PIC] https://prnt.sc/ipn0ic","body":"@AxelRichter i used the same code provided in the link. except commented (mergeCellVertically(table, 0, 0, 1); ).This is the ouptui I got in WPS writer:[PIC] <a href=\"https://prnt.sc/ipn0ic\" rel=\"nofollow noreferrer\">prnt.sc/ipn0ic</a>"},{"owner":{"account_id":11401943,"reputation":72,"user_id":8358646,"accept_rate":75,"display_name":"Joel George"},"score":0,"creation_date":1520769155,"post_id":49219092,"comment_id":85442944,"body_markdown":"@AxelRichter the same output without any data","body":"@AxelRichter the same output without any data"},{"owner":{"account_id":4853829,"reputation":57305,"user_id":3915431,"display_name":"Axel Richter"},"score":0,"creation_date":1520773002,"post_id":49219092,"comment_id":85444015,"body_markdown":"I have updated the code in my linked answer by creating table grid and deleting the content of the merged cells to support `Libreoffice Writer` too. Maybe this also will already support `WPS Writer`? Can you please try again?","body":"I have updated the code in my linked answer by creating table grid and deleting the content of the merged cells to support <code>Libreoffice Writer</code> too. Maybe this also will already support <code>WPS Writer</code>? Can you please try again?"},{"owner":{"account_id":11401943,"reputation":72,"user_id":8358646,"accept_rate":75,"display_name":"Joel George"},"score":0,"creation_date":1520775965,"post_id":49219092,"comment_id":85444842,"body_markdown":"@AxelRichter Still horizontal merge is not happening. This was the output I got. [Picture](https://prnt.sc/ipoaai)","body":"@AxelRichter Still horizontal merge is not happening. This was the output I got. <a href=\"https://prnt.sc/ipoaai\" rel=\"nofollow noreferrer\">Picture</a>"},{"owner":{"account_id":4853829,"reputation":57305,"user_id":3915431,"display_name":"Axel Richter"},"score":0,"creation_date":1520776518,"post_id":49219092,"comment_id":85444989,"body_markdown":"Well then `WPS Writer` must be the problem. Later I will try installing this software to detect where the problem comes from. Now it is not possible since currenty my Windows 10 virtual machine runs Windows 10 Update Assistant and this seems taking for ever ;-).","body":"Well then <code>WPS Writer</code> must be the problem. Later I will try installing this software to detect where the problem comes from. Now it is not possible since currenty my Windows 10 virtual machine runs Windows 10 Update Assistant and this seems taking for ever ;-)."},{"owner":{"account_id":11401943,"reputation":72,"user_id":8358646,"accept_rate":75,"display_name":"Joel George"},"score":0,"creation_date":1520778364,"post_id":49219092,"comment_id":85445615,"body_markdown":"@AxelRichter Thanks Axel. Please let me know if you find a solution.","body":"@AxelRichter Thanks Axel. Please let me know if you find a solution."}],"answers":[{"tags":[],"owner":{"account_id":4853829,"reputation":57305,"user_id":3915431,"display_name":"Axel Richter"},"down_vote_count":0,"up_vote_count":7,"is_accepted":true,"score":7,"last_activity_date":1695366647,"creation_date":1520784414,"answer_id":49222078,"question_id":49219092,"body_markdown":"There are two methods setting horizontally merging. The first is using `CTHMerge` which is similar to the vertically merging using `CTVMerge` and it does not explicitly need a table grid. The second is using grid span properties. This method needs a table grid and the cells which are merged with the first one must be removed.\r\n\r\n`Microsoft Word` supports all methods.\r\n\r\n`Libreoffice Writer` supports `CTHMerge` too but a table grid must be set because of the correct rendering the table.\r\n\r\n`WPS Writer` supports only setting grid span.\r\n\r\nSo this should be the most compatible solution:\r\n\r\n    import java.io.File;\r\n    import java.io.FileOutputStream;\r\n    \r\n    import java.math.BigInteger;\r\n    \r\n    import org.apache.poi.xwpf.usermodel.XWPFDocument;\r\n    import org.apache.poi.xwpf.usermodel.XWPFTable;\r\n    import org.apache.poi.xwpf.usermodel.XWPFTableCell;\r\n    import org.apache.poi.xwpf.usermodel.XWPFParagraph;\r\n    import org.apache.poi.xwpf.usermodel.XWPFRun;\r\n    \r\n    import org.openxmlformats.schemas.wordprocessingml.x2006.main.CTTcPr;\r\n    import org.openxmlformats.schemas.wordprocessingml.x2006.main.CTTblWidth;\r\n    import org.openxmlformats.schemas.wordprocessingml.x2006.main.STTblWidth;\r\n    import org.openxmlformats.schemas.wordprocessingml.x2006.main.CTVMerge;\r\n    import org.openxmlformats.schemas.wordprocessingml.x2006.main.STMerge;\r\n    \r\n    public class CreateWordTableMerge {\r\n    \r\n     static void mergeCellVertically(XWPFTable table, int col, int fromRow, int toRow) {\r\n      for(int rowIndex = fromRow; rowIndex &lt;= toRow; rowIndex++) {\r\n       XWPFTableCell cell = table.getRow(rowIndex).getCell(col);\r\n       CTVMerge vmerge = CTVMerge.Factory.newInstance();\r\n       if(rowIndex == fromRow){\r\n        // The first merged cell is set with RESTART merge value\r\n        vmerge.setVal(STMerge.RESTART);\r\n       } else {\r\n        // Cells which join (merge) the first one, are set with CONTINUE\r\n        vmerge.setVal(STMerge.CONTINUE);\r\n        // and the content should be removed\r\n        for (int i = cell.getParagraphs().size(); i &gt; 0; i--) {\r\n         cell.removeParagraph(0);\r\n        }\r\n        cell.addParagraph();\r\n       }\r\n       // Try getting the TcPr. Not simply setting an new one every time.\r\n       CTTcPr tcPr = cell.getCTTc().getTcPr();\r\n       if (tcPr == null) tcPr = cell.getCTTc().addNewTcPr();\r\n       tcPr.setVMerge(vmerge);\r\n      }\r\n     }\r\n    \r\n     //merging horizontally by setting grid span instead of using CTHMerge\r\n     static void mergeCellHorizontally(XWPFTable table, int row, int fromCol, int toCol) {\r\n      XWPFTableCell cell = table.getRow(row).getCell(fromCol);\r\n      // Try getting the TcPr. Not simply setting an new one every time.\r\n      CTTcPr tcPr = cell.getCTTc().getTcPr();\r\n      if (tcPr == null) tcPr = cell.getCTTc().addNewTcPr();\r\n      // The first merged cell has grid span property set\r\n      if (tcPr.isSetGridSpan()) {\r\n       tcPr.getGridSpan().setVal(BigInteger.valueOf(toCol-fromCol+1));\r\n      } else {\r\n       tcPr.addNewGridSpan().setVal(BigInteger.valueOf(toCol-fromCol+1));\r\n      }\r\n      // Cells which join (merge) the first one, must be removed\r\n      for(int colIndex = toCol; colIndex &gt; fromCol; colIndex--) {\r\n       table.getRow(row).removeCell(colIndex); // use only this for apache poi versions greater than 4.1.1\r\n       //table.getRow(row).getCtRow().removeTc(colIndex); // use this for apache poi versions up to 4.1.1\r\n       //table.getRow(row).removeCell(colIndex);\r\n      }\r\n     }\r\n    \r\n     public static void main(String[] args) throws Exception {\r\n    \r\n      XWPFDocument document= new XWPFDocument();\r\n    \r\n      XWPFParagraph paragraph = document.createParagraph();\r\n      XWPFRun run=paragraph.createRun();  \r\n      run.setText(&quot;The table:&quot;);\r\n    \r\n      //create table\r\n      XWPFTable table = document.createTable(3,5);\r\n    \r\n      for (int row = 0; row &lt; 3; row++) {\r\n       for (int col = 0; col &lt; 5; col++) {\r\n        table.getRow(row).getCell(col).setText(&quot;row &quot; + row + &quot;, col &quot; + col);\r\n       }\r\n      }\r\n    \r\n      //create CTTblGrid for this table with widths of the 5 columns. \r\n      //necessary for Libreoffice/Openoffice to accept the column widths.\r\n      //values are in unit twentieths of a point (1/1440 of an inch)\r\n      //first column = 1 inches width\r\n      table.getCTTbl().addNewTblGrid().addNewGridCol().setW(BigInteger.valueOf(1*1440));\r\n      //other columns (2 in this case) also each 1 inches width\r\n      for (int col = 1 ; col &lt; 5; col++) {\r\n       table.getCTTbl().getTblGrid().addNewGridCol().setW(BigInteger.valueOf(1*1440));\r\n      }\r\n    \r\n      //create and set column widths for all columns in all rows\r\n      //most examples don&#39;t set the type of the CTTblWidth but this\r\n      //is necessary for working in all office versions\r\n      for (int col = 0; col &lt; 5; col++) {\r\n       CTTblWidth tblWidth = CTTblWidth.Factory.newInstance();\r\n       tblWidth.setW(BigInteger.valueOf(1*1440));\r\n       tblWidth.setType(STTblWidth.DXA);\r\n       for (int row = 0; row &lt; 3; row++) {\r\n        CTTcPr tcPr = table.getRow(row).getCell(col).getCTTc().getTcPr();\r\n        if (tcPr != null) {\r\n         tcPr.setTcW(tblWidth);\r\n        } else {\r\n         tcPr = CTTcPr.Factory.newInstance();\r\n         tcPr.setTcW(tblWidth);\r\n         table.getRow(row).getCell(col).getCTTc().setTcPr(tcPr);\r\n        }\r\n       }\r\n      }\r\n    \r\n      //using the merge methods\r\n      mergeCellVertically(table, 0, 0, 1); \r\n      mergeCellHorizontally(table, 1, 2, 3); \r\n      mergeCellHorizontally(table, 2, 1, 4); \r\n    \r\n      paragraph = document.createParagraph();\r\n    \r\n      FileOutputStream out = new FileOutputStream(&quot;create_table.docx&quot;); \r\n      document.write(out);\r\n      out.close();\r\n    \r\n      System.out.println(&quot;create_table.docx written successully&quot;);\r\n     }\r\n    }","title":"How to horizontally merge XWPFTable using POI in Java","body":"<p>There are two methods setting horizontally merging. The first is using <code>CTHMerge</code> which is similar to the vertically merging using <code>CTVMerge</code> and it does not explicitly need a table grid. The second is using grid span properties. This method needs a table grid and the cells which are merged with the first one must be removed.</p>\n<p><code>Microsoft Word</code> supports all methods.</p>\n<p><code>Libreoffice Writer</code> supports <code>CTHMerge</code> too but a table grid must be set because of the correct rendering the table.</p>\n<p><code>WPS Writer</code> supports only setting grid span.</p>\n<p>So this should be the most compatible solution:</p>\n<pre><code>import java.io.File;\nimport java.io.FileOutputStream;\n\nimport java.math.BigInteger;\n\nimport org.apache.poi.xwpf.usermodel.XWPFDocument;\nimport org.apache.poi.xwpf.usermodel.XWPFTable;\nimport org.apache.poi.xwpf.usermodel.XWPFTableCell;\nimport org.apache.poi.xwpf.usermodel.XWPFParagraph;\nimport org.apache.poi.xwpf.usermodel.XWPFRun;\n\nimport org.openxmlformats.schemas.wordprocessingml.x2006.main.CTTcPr;\nimport org.openxmlformats.schemas.wordprocessingml.x2006.main.CTTblWidth;\nimport org.openxmlformats.schemas.wordprocessingml.x2006.main.STTblWidth;\nimport org.openxmlformats.schemas.wordprocessingml.x2006.main.CTVMerge;\nimport org.openxmlformats.schemas.wordprocessingml.x2006.main.STMerge;\n\npublic class CreateWordTableMerge {\n\n static void mergeCellVertically(XWPFTable table, int col, int fromRow, int toRow) {\n  for(int rowIndex = fromRow; rowIndex &lt;= toRow; rowIndex++) {\n   XWPFTableCell cell = table.getRow(rowIndex).getCell(col);\n   CTVMerge vmerge = CTVMerge.Factory.newInstance();\n   if(rowIndex == fromRow){\n    // The first merged cell is set with RESTART merge value\n    vmerge.setVal(STMerge.RESTART);\n   } else {\n    // Cells which join (merge) the first one, are set with CONTINUE\n    vmerge.setVal(STMerge.CONTINUE);\n    // and the content should be removed\n    for (int i = cell.getParagraphs().size(); i &gt; 0; i--) {\n     cell.removeParagraph(0);\n    }\n    cell.addParagraph();\n   }\n   // Try getting the TcPr. Not simply setting an new one every time.\n   CTTcPr tcPr = cell.getCTTc().getTcPr();\n   if (tcPr == null) tcPr = cell.getCTTc().addNewTcPr();\n   tcPr.setVMerge(vmerge);\n  }\n }\n\n //merging horizontally by setting grid span instead of using CTHMerge\n static void mergeCellHorizontally(XWPFTable table, int row, int fromCol, int toCol) {\n  XWPFTableCell cell = table.getRow(row).getCell(fromCol);\n  // Try getting the TcPr. Not simply setting an new one every time.\n  CTTcPr tcPr = cell.getCTTc().getTcPr();\n  if (tcPr == null) tcPr = cell.getCTTc().addNewTcPr();\n  // The first merged cell has grid span property set\n  if (tcPr.isSetGridSpan()) {\n   tcPr.getGridSpan().setVal(BigInteger.valueOf(toCol-fromCol+1));\n  } else {\n   tcPr.addNewGridSpan().setVal(BigInteger.valueOf(toCol-fromCol+1));\n  }\n  // Cells which join (merge) the first one, must be removed\n  for(int colIndex = toCol; colIndex &gt; fromCol; colIndex--) {\n   table.getRow(row).removeCell(colIndex); // use only this for apache poi versions greater than 4.1.1\n   //table.getRow(row).getCtRow().removeTc(colIndex); // use this for apache poi versions up to 4.1.1\n   //table.getRow(row).removeCell(colIndex);\n  }\n }\n\n public static void main(String[] args) throws Exception {\n\n  XWPFDocument document= new XWPFDocument();\n\n  XWPFParagraph paragraph = document.createParagraph();\n  XWPFRun run=paragraph.createRun();  \n  run.setText(&quot;The table:&quot;);\n\n  //create table\n  XWPFTable table = document.createTable(3,5);\n\n  for (int row = 0; row &lt; 3; row++) {\n   for (int col = 0; col &lt; 5; col++) {\n    table.getRow(row).getCell(col).setText(&quot;row &quot; + row + &quot;, col &quot; + col);\n   }\n  }\n\n  //create CTTblGrid for this table with widths of the 5 columns. \n  //necessary for Libreoffice/Openoffice to accept the column widths.\n  //values are in unit twentieths of a point (1/1440 of an inch)\n  //first column = 1 inches width\n  table.getCTTbl().addNewTblGrid().addNewGridCol().setW(BigInteger.valueOf(1*1440));\n  //other columns (2 in this case) also each 1 inches width\n  for (int col = 1 ; col &lt; 5; col++) {\n   table.getCTTbl().getTblGrid().addNewGridCol().setW(BigInteger.valueOf(1*1440));\n  }\n\n  //create and set column widths for all columns in all rows\n  //most examples don't set the type of the CTTblWidth but this\n  //is necessary for working in all office versions\n  for (int col = 0; col &lt; 5; col++) {\n   CTTblWidth tblWidth = CTTblWidth.Factory.newInstance();\n   tblWidth.setW(BigInteger.valueOf(1*1440));\n   tblWidth.setType(STTblWidth.DXA);\n   for (int row = 0; row &lt; 3; row++) {\n    CTTcPr tcPr = table.getRow(row).getCell(col).getCTTc().getTcPr();\n    if (tcPr != null) {\n     tcPr.setTcW(tblWidth);\n    } else {\n     tcPr = CTTcPr.Factory.newInstance();\n     tcPr.setTcW(tblWidth);\n     table.getRow(row).getCell(col).getCTTc().setTcPr(tcPr);\n    }\n   }\n  }\n\n  //using the merge methods\n  mergeCellVertically(table, 0, 0, 1); \n  mergeCellHorizontally(table, 1, 2, 3); \n  mergeCellHorizontally(table, 2, 1, 4); \n\n  paragraph = document.createParagraph();\n\n  FileOutputStream out = new FileOutputStream(&quot;create_table.docx&quot;); \n  document.write(out);\n  out.close();\n\n  System.out.println(&quot;create_table.docx written successully&quot;);\n }\n}\n</code></pre>\n"}],"owner":{"account_id":11401943,"reputation":72,"user_id":8358646,"accept_rate":75,"display_name":"Joel George"},"comment_count":11,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":3438,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":49222078,"answer_count":1,"score":0,"last_activity_date":1695366647,"creation_date":1520764945,"question_id":49219092,"body_markdown":"I want to horizontally merge columns of the row in a XWPFTable. I tried the answer in this link. \r\n https://stackoverflow.com/questions/15984896/how-to-merge-cells-or-apply-colspan-using-xwpftable-in-poi-in-java \r\nand also of this link \r\nhttps://stackoverflow.com/questions/35554185/how-to-merge-cells-horizontally-using-apache-poi?noredirect=1&amp;lq=1\r\n\r\nIt helped me to get cells merged vertically. But horizontal merge is not happening.\r\nI am attaching the sample screenshot of what I really wanted.\r\n\r\n[![excel image][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/pf7qZ.jpg\r\n\r\nThanks.","title":"How to horizontally merge XWPFTable using POI in Java","body":"<p>I want to horizontally merge columns of the row in a XWPFTable. I tried the answer in this link. \n <a href=\"https://stackoverflow.com/questions/15984896/how-to-merge-cells-or-apply-colspan-using-xwpftable-in-poi-in-java\">How to merge cells (or apply colspan) using XWPFTable in POI in Java?</a> \nand also of this link \n<a href=\"https://stackoverflow.com/questions/35554185/how-to-merge-cells-horizontally-using-apache-poi?noredirect=1&amp;lq=1\">How to merge cells horizontally using apache-poi</a></p>\n\n<p>It helped me to get cells merged vertically. But horizontal merge is not happening.\nI am attaching the sample screenshot of what I really wanted.</p>\n\n<p><a href=\"https://i.stack.imgur.com/pf7qZ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pf7qZ.jpg\" alt=\"excel image\"></a></p>\n\n<p>Thanks.</p>\n"},{"tags":["java","apache-poi"],"comments":[{"owner":{"account_id":4853829,"reputation":57305,"user_id":3915431,"display_name":"Axel Richter"},"score":1,"creation_date":1687880553,"post_id":76566277,"comment_id":134997400,"body_markdown":"[Create a Minimal, Reproducible Example](https://stackoverflow.com/help/minimal-reproducible-example) please.","body":"<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">Create a Minimal, Reproducible Example</a> please."}],"answers":[{"tags":[],"owner":{"account_id":4853829,"reputation":57305,"user_id":3915431,"display_name":"Axel Richter"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695366541,"creation_date":1688291675,"answer_id":76598323,"question_id":76566277,"body_markdown":"I would not see the table in the picture in your question to be table in table. The table-in-table-construct is not really good practice. It should be avoided if possible.\r\n\r\nI see a table having 4 columns where in rows 1, 2 and 5 columns 1 and 2 as well as 3 and 4 are merged. In rows 3 and 4 column 1 is hidden and columns 2 and 3 are merged.\r\n\r\nFollowing code produces this using Apache POI (current version 5.2.3).\r\n\r\n&lt;!-- language: java --&gt;\r\n\r\n    import java.io.FileOutputStream;\r\n    \r\n    import org.apache.poi.xwpf.usermodel.*;\r\n    \r\n    import java.util.Map;\r\n    import java.util.TreeMap;\r\n    \r\n    import java.math.BigInteger;\r\n    \r\n    public class CreateWordKeyValueTable {\r\n        \r\n     static void mergeCellHorizontally(XWPFTable table, int row, int fromCol, int toCol) {\r\n      XWPFTableCell cell = table.getRow(row).getCell(fromCol);\r\n      // Try getting the TcPr. Not simply setting an new one every time.\r\n      org.openxmlformats.schemas.wordprocessingml.x2006.main.CTTcPr tcPr = cell.getCTTc().getTcPr();\r\n      if (tcPr == null) tcPr = cell.getCTTc().addNewTcPr();\r\n      // The first merged cell has grid span property set\r\n      if (tcPr.isSetGridSpan()) {\r\n       tcPr.getGridSpan().setVal(BigInteger.valueOf(toCol-fromCol+1));\r\n      } else {\r\n       tcPr.addNewGridSpan().setVal(BigInteger.valueOf(toCol-fromCol+1));\r\n      }\r\n      // Cells which join (merge) the first one, must be removed\r\n      for(int colIndex = toCol; colIndex &gt; fromCol; colIndex--) {\r\n       table.getRow(row).removeCell(colIndex); // use only this for apache poi versions greater than 4.1.1\r\n      }\r\n     }\r\n     \r\n     static void createGrid(XWPFTable table, int[] colWidths) {\r\n      //create CTTblGrid for this table with widths of the columns. \r\n      //necessary for Libreoffice/Openoffice to accept the column widths.\r\n      //values are in unit twentieths of a point (1/1440 of an inch)\r\n      //if widths of table cells are in percent, then this is only to store the relations\r\n      org.openxmlformats.schemas.wordprocessingml.x2006.main.CTTblGrid tblGrid = table.getCTTbl().getTblGrid();\r\n      if (tblGrid == null) tblGrid = table.getCTTbl().addNewTblGrid();\r\n      for (org.openxmlformats.schemas.wordprocessingml.x2006.main.CTTblGridCol tblGridCol : tblGrid.getGridColList()) {\r\n       tblGrid.removeGridCol(0);  \r\n      }\r\n      //first column\r\n      tblGrid.addNewGridCol().setW(BigInteger.valueOf(colWidths[0]));\r\n      //other columns\r\n      for (int c = 1 ; c &lt; colWidths.length; c++) {\r\n       tblGrid.addNewGridCol().setW(BigInteger.valueOf(colWidths[c]));\r\n      }     \r\n     }\r\n     \r\n     static void hideFirstCell(XWPFTableRow tableRow) {\r\n      //set gridBefore\r\n      org.openxmlformats.schemas.wordprocessingml.x2006.main.CTTrPr trPr = tableRow.getCtRow().getTrPr();\r\n      if (trPr==null) trPr = tableRow.getCtRow().addNewTrPr();\r\n      for (org.openxmlformats.schemas.wordprocessingml.x2006.main.CTDecimalNumber gridBefore : trPr.getGridBeforeList()) {\r\n       trPr.removeGridBefore(0);  \r\n      }\r\n      org.openxmlformats.schemas.wordprocessingml.x2006.main.CTDecimalNumber gridBefore = trPr.addNewGridBefore();\r\n      gridBefore.setVal(BigInteger.valueOf(1));\r\n      //set wBefore \r\n      for (org.openxmlformats.schemas.wordprocessingml.x2006.main.CTTblWidth wBefore : trPr.getWBeforeList()) {\r\n       trPr.removeWBefore(0);  \r\n      }\r\n      org.openxmlformats.schemas.wordprocessingml.x2006.main.CTTblWidth wBefore = trPr.addNewWBefore();\r\n      XWPFTableCell tableCell = tableRow.getCell(0);\r\n      wBefore.setW(tableCell.getWidth());\r\n      wBefore.setType(org.openxmlformats.schemas.wordprocessingml.x2006.main.STTblWidth.PCT);\r\n      tableRow.removeCell(0);\r\n     }\r\n    \r\n    \r\n     static XWPFTableRow getOrCreateTableRow(XWPFTable table, int r, String[] colWidths) {\r\n      //create a row having count of cells having special width\r\n      XWPFTableRow tableRow = null;\r\n      if (r==0) {\r\n       tableRow = table.getRow(0); \r\n      } else {\r\n       tableRow = table.createRow();\r\n      }\r\n      //fill up cell list up to needed count\r\n      while (tableRow.getTableCells().size() &lt; colWidths.length) {\r\n       tableRow.createCell();\r\n      }\r\n      //set the widths\r\n      for (int c = 0 ; c &lt; colWidths.length; c++) {\r\n       tableRow.getCell(c).setWidth(colWidths[c]);   \r\n      }\r\n      return tableRow;\r\n     }\r\n    \t\r\n     public static void main(String[] args) throws Exception {\r\n         \r\n      Map&lt;String, Object&gt; keyValue = new TreeMap&lt;String, Object&gt;();\r\n      keyValue.put(&quot;Key1&quot;, &quot;Value1&quot;);\r\n      Map&lt;String, String&gt; subKeyValue = new TreeMap&lt;String, String&gt;();\r\n      subKeyValue.put(&quot;Key2a&quot;, &quot;Value2a&quot;);\r\n      subKeyValue.put(&quot;Key2b&quot;, &quot;Value2b&quot;);\r\n      keyValue.put(&quot;Key2&quot;, subKeyValue);\r\n      keyValue.put(&quot;Key3&quot;, &quot;Value3&quot;);\r\n      \r\n      System.out.println(keyValue);\r\n      \r\n      String multiValues = &quot;Multivalued Key&quot;;\r\n      \r\n      double[] dWidthsPCT = new double[]{10d, 30d, 10d, 50d};\r\n      \r\n      java.util.stream.Stream&lt;String&gt; stream = \r\n       java.util.stream.DoubleStream.of(dWidthsPCT).boxed()\r\n       .map(d -&gt; String.valueOf(d)+&quot;%&quot;);\r\n      String[] widthsPCT = stream.toArray(String[]::new);\r\n          \r\n      XWPFDocument document = new XWPFDocument();\r\n    \r\n      XWPFParagraph paragraph = document.createParagraph();\r\n      XWPFRun run = paragraph.createRun();  \r\n      run.setText(&quot;The table:&quot;);\r\n    \r\n      XWPFTable table = document.createTable();  \r\n      table.setWidth(&quot;100%&quot;);\r\n      \r\n      //set borders\r\n      table.setTopBorder(XWPFTable.XWPFBorderType.SINGLE   , 32, 0, &quot;FFFFFF&quot;);\r\n      table.setBottomBorder(XWPFTable.XWPFBorderType.SINGLE   , 32, 0, &quot;FFFFFF&quot;);\r\n      table.setLeftBorder(XWPFTable.XWPFBorderType.SINGLE   , 32, 0, &quot;FFFFFF&quot;);\r\n      table.setRightBorder(XWPFTable.XWPFBorderType.SINGLE   , 32, 0, &quot;FFFFFF&quot;);\r\n      table.setInsideHBorder(XWPFTable.XWPFBorderType.SINGLE   , 32, 0, &quot;FFFFFF&quot;);\r\n      table.setInsideVBorder(XWPFTable.XWPFBorderType.SINGLE   , 32, 0, &quot;FFFFFF&quot;);\r\n      \r\n      createGrid(table, new int[]{ // 5000 = 100%\r\n        (int)Math.round(5000d/(100d/dWidthsPCT[0])), \r\n        (int)Math.round(5000d/(100d/dWidthsPCT[1])), \r\n        (int)Math.round(5000d/(100d/dWidthsPCT[2])), \r\n        (int)Math.round(5000d/(100d/dWidthsPCT[3]))\r\n       }\r\n      ); \r\n      \r\n      XWPFTableRow tableRow;\r\n      XWPFTableCell tableCell;\r\n      String key;\r\n      Object objectValue;\r\n      String stringValue;\r\n      int r = -1;\r\n      for(Map.Entry&lt;String, Object&gt; entry : keyValue.entrySet()) {\r\n       r++;   \r\n       tableRow = getOrCreateTableRow(table, r, widthsPCT);\r\n       \r\n       key = entry.getKey();\r\n       objectValue = entry.getValue();\r\n       \r\n       tableCell = tableRow.getCell(0);\r\n       tableCell.setText(key);\r\n       mergeCellHorizontally(table, r, 0, 1);\r\n       tableCell.setWidth((int)(dWidthsPCT[0]+dWidthsPCT[1])+&quot;%&quot;); // col width 0 and 1\r\n       tableCell.setColor(&quot;00B0F0&quot;);\r\n       if (objectValue instanceof String) {\r\n        stringValue = (String)objectValue;\r\n        tableCell = tableRow.getCell(1);\r\n        tableCell.setText(stringValue);\r\n        mergeCellHorizontally(table, r, 1, 2);\r\n        tableCell.setWidth((int)(dWidthsPCT[2]+dWidthsPCT[3])+&quot;%&quot;); // col width 2 and 3\r\n        tableCell.setColor(&quot;C0C0C0&quot;);\r\n       } else if (objectValue instanceof Map) {\r\n        tableCell = tableRow.getCell(1);\r\n        tableCell.setText(multiValues);\r\n        mergeCellHorizontally(table, r, 1, 2);\r\n        tableCell.setWidth((int)(dWidthsPCT[2]+dWidthsPCT[3])+&quot;%&quot;); // col width 2 and 3\r\n        tableCell.setColor(&quot;C0C0C0&quot;);\r\n        @SuppressWarnings(&quot;unchecked&quot;)\r\n        Map&lt;String, String&gt; mapValue = (Map&lt;String, String&gt;)objectValue;  \r\n        for(Map.Entry&lt;String, String&gt; subEntry : mapValue.entrySet()) {\r\n         r++;\r\n         tableRow = getOrCreateTableRow(table, r, widthsPCT);\r\n         hideFirstCell(tableRow);\r\n         key = subEntry.getKey();\r\n         stringValue = subEntry.getValue();\r\n         tableCell = tableRow.getCell(0);\r\n         tableCell.setText(key);\r\n         mergeCellHorizontally(table, r, 0, 1);\r\n         tableCell.setWidth((int)(dWidthsPCT[1]+dWidthsPCT[2])+&quot;%&quot;); // col width 1 and 2\r\n         tableCell.setColor(&quot;00B0F0&quot;);\r\n         tableCell = tableRow.getCell(1);\r\n         tableCell.setText(stringValue);\r\n         tableCell.setWidth(widthsPCT[3]); // col width 3\r\n         tableCell.setColor(&quot;C0C0C0&quot;);\r\n        }         \r\n       }\r\n      }\r\n      paragraph = document.createParagraph();\r\n    \r\n      FileOutputStream out = new FileOutputStream(&quot;./CreateWordKeyValueTable.docx&quot;);\r\n      document.write(out);\r\n      out.close();\r\n      document.close();\r\n    \r\n     }\r\n    }\r\n\r\nIt produces:\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/RrNLs.png\r\n","title":"How to properly size nested tables in a .DOCX?","body":"<p>I would not see the table in the picture in your question to be table in table. The table-in-table-construct is not really good practice. It should be avoided if possible.</p>\n<p>I see a table having 4 columns where in rows 1, 2 and 5 columns 1 and 2 as well as 3 and 4 are merged. In rows 3 and 4 column 1 is hidden and columns 2 and 3 are merged.</p>\n<p>Following code produces this using Apache POI (current version 5.2.3).</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.io.FileOutputStream;\n\nimport org.apache.poi.xwpf.usermodel.*;\n\nimport java.util.Map;\nimport java.util.TreeMap;\n\nimport java.math.BigInteger;\n\npublic class CreateWordKeyValueTable {\n    \n static void mergeCellHorizontally(XWPFTable table, int row, int fromCol, int toCol) {\n  XWPFTableCell cell = table.getRow(row).getCell(fromCol);\n  // Try getting the TcPr. Not simply setting an new one every time.\n  org.openxmlformats.schemas.wordprocessingml.x2006.main.CTTcPr tcPr = cell.getCTTc().getTcPr();\n  if (tcPr == null) tcPr = cell.getCTTc().addNewTcPr();\n  // The first merged cell has grid span property set\n  if (tcPr.isSetGridSpan()) {\n   tcPr.getGridSpan().setVal(BigInteger.valueOf(toCol-fromCol+1));\n  } else {\n   tcPr.addNewGridSpan().setVal(BigInteger.valueOf(toCol-fromCol+1));\n  }\n  // Cells which join (merge) the first one, must be removed\n  for(int colIndex = toCol; colIndex &gt; fromCol; colIndex--) {\n   table.getRow(row).removeCell(colIndex); // use only this for apache poi versions greater than 4.1.1\n  }\n }\n \n static void createGrid(XWPFTable table, int[] colWidths) {\n  //create CTTblGrid for this table with widths of the columns. \n  //necessary for Libreoffice/Openoffice to accept the column widths.\n  //values are in unit twentieths of a point (1/1440 of an inch)\n  //if widths of table cells are in percent, then this is only to store the relations\n  org.openxmlformats.schemas.wordprocessingml.x2006.main.CTTblGrid tblGrid = table.getCTTbl().getTblGrid();\n  if (tblGrid == null) tblGrid = table.getCTTbl().addNewTblGrid();\n  for (org.openxmlformats.schemas.wordprocessingml.x2006.main.CTTblGridCol tblGridCol : tblGrid.getGridColList()) {\n   tblGrid.removeGridCol(0);  \n  }\n  //first column\n  tblGrid.addNewGridCol().setW(BigInteger.valueOf(colWidths[0]));\n  //other columns\n  for (int c = 1 ; c &lt; colWidths.length; c++) {\n   tblGrid.addNewGridCol().setW(BigInteger.valueOf(colWidths[c]));\n  }     \n }\n \n static void hideFirstCell(XWPFTableRow tableRow) {\n  //set gridBefore\n  org.openxmlformats.schemas.wordprocessingml.x2006.main.CTTrPr trPr = tableRow.getCtRow().getTrPr();\n  if (trPr==null) trPr = tableRow.getCtRow().addNewTrPr();\n  for (org.openxmlformats.schemas.wordprocessingml.x2006.main.CTDecimalNumber gridBefore : trPr.getGridBeforeList()) {\n   trPr.removeGridBefore(0);  \n  }\n  org.openxmlformats.schemas.wordprocessingml.x2006.main.CTDecimalNumber gridBefore = trPr.addNewGridBefore();\n  gridBefore.setVal(BigInteger.valueOf(1));\n  //set wBefore \n  for (org.openxmlformats.schemas.wordprocessingml.x2006.main.CTTblWidth wBefore : trPr.getWBeforeList()) {\n   trPr.removeWBefore(0);  \n  }\n  org.openxmlformats.schemas.wordprocessingml.x2006.main.CTTblWidth wBefore = trPr.addNewWBefore();\n  XWPFTableCell tableCell = tableRow.getCell(0);\n  wBefore.setW(tableCell.getWidth());\n  wBefore.setType(org.openxmlformats.schemas.wordprocessingml.x2006.main.STTblWidth.PCT);\n  tableRow.removeCell(0);\n }\n\n\n static XWPFTableRow getOrCreateTableRow(XWPFTable table, int r, String[] colWidths) {\n  //create a row having count of cells having special width\n  XWPFTableRow tableRow = null;\n  if (r==0) {\n   tableRow = table.getRow(0); \n  } else {\n   tableRow = table.createRow();\n  }\n  //fill up cell list up to needed count\n  while (tableRow.getTableCells().size() &lt; colWidths.length) {\n   tableRow.createCell();\n  }\n  //set the widths\n  for (int c = 0 ; c &lt; colWidths.length; c++) {\n   tableRow.getCell(c).setWidth(colWidths[c]);   \n  }\n  return tableRow;\n }\n    \n public static void main(String[] args) throws Exception {\n     \n  Map&lt;String, Object&gt; keyValue = new TreeMap&lt;String, Object&gt;();\n  keyValue.put(&quot;Key1&quot;, &quot;Value1&quot;);\n  Map&lt;String, String&gt; subKeyValue = new TreeMap&lt;String, String&gt;();\n  subKeyValue.put(&quot;Key2a&quot;, &quot;Value2a&quot;);\n  subKeyValue.put(&quot;Key2b&quot;, &quot;Value2b&quot;);\n  keyValue.put(&quot;Key2&quot;, subKeyValue);\n  keyValue.put(&quot;Key3&quot;, &quot;Value3&quot;);\n  \n  System.out.println(keyValue);\n  \n  String multiValues = &quot;Multivalued Key&quot;;\n  \n  double[] dWidthsPCT = new double[]{10d, 30d, 10d, 50d};\n  \n  java.util.stream.Stream&lt;String&gt; stream = \n   java.util.stream.DoubleStream.of(dWidthsPCT).boxed()\n   .map(d -&gt; String.valueOf(d)+&quot;%&quot;);\n  String[] widthsPCT = stream.toArray(String[]::new);\n      \n  XWPFDocument document = new XWPFDocument();\n\n  XWPFParagraph paragraph = document.createParagraph();\n  XWPFRun run = paragraph.createRun();  \n  run.setText(&quot;The table:&quot;);\n\n  XWPFTable table = document.createTable();  \n  table.setWidth(&quot;100%&quot;);\n  \n  //set borders\n  table.setTopBorder(XWPFTable.XWPFBorderType.SINGLE   , 32, 0, &quot;FFFFFF&quot;);\n  table.setBottomBorder(XWPFTable.XWPFBorderType.SINGLE   , 32, 0, &quot;FFFFFF&quot;);\n  table.setLeftBorder(XWPFTable.XWPFBorderType.SINGLE   , 32, 0, &quot;FFFFFF&quot;);\n  table.setRightBorder(XWPFTable.XWPFBorderType.SINGLE   , 32, 0, &quot;FFFFFF&quot;);\n  table.setInsideHBorder(XWPFTable.XWPFBorderType.SINGLE   , 32, 0, &quot;FFFFFF&quot;);\n  table.setInsideVBorder(XWPFTable.XWPFBorderType.SINGLE   , 32, 0, &quot;FFFFFF&quot;);\n  \n  createGrid(table, new int[]{ // 5000 = 100%\n    (int)Math.round(5000d/(100d/dWidthsPCT[0])), \n    (int)Math.round(5000d/(100d/dWidthsPCT[1])), \n    (int)Math.round(5000d/(100d/dWidthsPCT[2])), \n    (int)Math.round(5000d/(100d/dWidthsPCT[3]))\n   }\n  ); \n  \n  XWPFTableRow tableRow;\n  XWPFTableCell tableCell;\n  String key;\n  Object objectValue;\n  String stringValue;\n  int r = -1;\n  for(Map.Entry&lt;String, Object&gt; entry : keyValue.entrySet()) {\n   r++;   \n   tableRow = getOrCreateTableRow(table, r, widthsPCT);\n   \n   key = entry.getKey();\n   objectValue = entry.getValue();\n   \n   tableCell = tableRow.getCell(0);\n   tableCell.setText(key);\n   mergeCellHorizontally(table, r, 0, 1);\n   tableCell.setWidth((int)(dWidthsPCT[0]+dWidthsPCT[1])+&quot;%&quot;); // col width 0 and 1\n   tableCell.setColor(&quot;00B0F0&quot;);\n   if (objectValue instanceof String) {\n    stringValue = (String)objectValue;\n    tableCell = tableRow.getCell(1);\n    tableCell.setText(stringValue);\n    mergeCellHorizontally(table, r, 1, 2);\n    tableCell.setWidth((int)(dWidthsPCT[2]+dWidthsPCT[3])+&quot;%&quot;); // col width 2 and 3\n    tableCell.setColor(&quot;C0C0C0&quot;);\n   } else if (objectValue instanceof Map) {\n    tableCell = tableRow.getCell(1);\n    tableCell.setText(multiValues);\n    mergeCellHorizontally(table, r, 1, 2);\n    tableCell.setWidth((int)(dWidthsPCT[2]+dWidthsPCT[3])+&quot;%&quot;); // col width 2 and 3\n    tableCell.setColor(&quot;C0C0C0&quot;);\n    @SuppressWarnings(&quot;unchecked&quot;)\n    Map&lt;String, String&gt; mapValue = (Map&lt;String, String&gt;)objectValue;  \n    for(Map.Entry&lt;String, String&gt; subEntry : mapValue.entrySet()) {\n     r++;\n     tableRow = getOrCreateTableRow(table, r, widthsPCT);\n     hideFirstCell(tableRow);\n     key = subEntry.getKey();\n     stringValue = subEntry.getValue();\n     tableCell = tableRow.getCell(0);\n     tableCell.setText(key);\n     mergeCellHorizontally(table, r, 0, 1);\n     tableCell.setWidth((int)(dWidthsPCT[1]+dWidthsPCT[2])+&quot;%&quot;); // col width 1 and 2\n     tableCell.setColor(&quot;00B0F0&quot;);\n     tableCell = tableRow.getCell(1);\n     tableCell.setText(stringValue);\n     tableCell.setWidth(widthsPCT[3]); // col width 3\n     tableCell.setColor(&quot;C0C0C0&quot;);\n    }         \n   }\n  }\n  paragraph = document.createParagraph();\n\n  FileOutputStream out = new FileOutputStream(&quot;./CreateWordKeyValueTable.docx&quot;);\n  document.write(out);\n  out.close();\n  document.close();\n\n }\n}\n</code></pre>\n<p>It produces:</p>\n<p><a href=\"https://i.stack.imgur.com/RrNLs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RrNLs.png\" alt=\"enter image description here\" /></a></p>\n"}],"owner":{"account_id":1086374,"reputation":1,"user_id":15506927,"display_name":"Anderson"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":120,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1695366541,"creation_date":1687878495,"question_id":76566277,"body_markdown":"I&#39;m trying to create a .docx document, using Apache POI, which is expected to contain a table of Key-Value pairs. Some keys may have another set of Key-Value pair (instead of a single string value), which means I need to create a table inside another table.\r\n\r\nExample table\r\n[![enter image description here][1]][1]\r\n\r\nI hoped that this would be easy to implement if I started from a document template, created in MS Word, so that it already has all the desired formatting. And, it kind of works, for the most part. The only problem is that in cases when there is a nested table in the generated document, MS Word will show a message about the file having some errors and whether he wants Word to recover it, when the user tries to open the file. After clicking &#39;Yes&#39;, the &quot;recovered&quot; file will appear correct. \r\n\r\nAs you can see in the above example image, I want it to have an &quot;indent&quot; for the next level (nested table). Which is achieved by having the template table formatted with 97% width and right alignment.\r\n\r\nFrom what I could find, the differences in the document.xml from the &quot;recovered&quot; document to the one I created are only in the values for column width in the \\&lt;w:tblGrid\\&gt; element. However, It still unclear to me how those values are calculated.\r\n\r\nI have tried adjusting the \\&lt;w:tblGrid\\&gt; in the nested table by setting the width to 97% of those in the parent table, and played a bit around that idea. But, still no lucky.\r\n\r\nIf I force it to be generated with the exact same values, then it will be opened by MS Word without any errors. So this confirms the grid sizes are the problem. But, of course, I can&#39;t rely on hard-coded values.\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/uvYgu.png","title":"How to properly size nested tables in a .DOCX?","body":"<p>I'm trying to create a .docx document, using Apache POI, which is expected to contain a table of Key-Value pairs. Some keys may have another set of Key-Value pair (instead of a single string value), which means I need to create a table inside another table.</p>\n<p>Example table\n<a href=\"https://i.stack.imgur.com/uvYgu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uvYgu.png\" alt=\"enter image description here\" /></a></p>\n<p>I hoped that this would be easy to implement if I started from a document template, created in MS Word, so that it already has all the desired formatting. And, it kind of works, for the most part. The only problem is that in cases when there is a nested table in the generated document, MS Word will show a message about the file having some errors and whether he wants Word to recover it, when the user tries to open the file. After clicking 'Yes', the &quot;recovered&quot; file will appear correct.</p>\n<p>As you can see in the above example image, I want it to have an &quot;indent&quot; for the next level (nested table). Which is achieved by having the template table formatted with 97% width and right alignment.</p>\n<p>From what I could find, the differences in the document.xml from the &quot;recovered&quot; document to the one I created are only in the values for column width in the &lt;w:tblGrid&gt; element. However, It still unclear to me how those values are calculated.</p>\n<p>I have tried adjusting the &lt;w:tblGrid&gt; in the nested table by setting the width to 97% of those in the parent table, and played a bit around that idea. But, still no lucky.</p>\n<p>If I force it to be generated with the exact same values, then it will be opened by MS Word without any errors. So this confirms the grid sizes are the problem. But, of course, I can't rely on hard-coded values.</p>\n"},{"tags":["java","singly-linked-list"],"comments":[{"owner":{"account_id":2011141,"reputation":7317,"user_id":1799530,"accept_rate":47,"display_name":"SomeJavaGuy"},"score":1,"creation_date":1492004357,"post_id":43371172,"comment_id":73804238,"body_markdown":"`if (userInputNumber &lt; 0)`? Also i might check how the native implementation of a `LinkedList` does work. there no chance for you to iterate through it,","body":"<code>if (userInputNumber &lt; 0)</code>? Also i might check how the native implementation of a <code>LinkedList</code> does work. there no chance for you to iterate through it,"},{"owner":{"account_id":10662772,"reputation":23,"user_id":7850267,"display_name":"Prem"},"score":0,"creation_date":1492004509,"post_id":43371172,"comment_id":73804365,"body_markdown":"Can you give me the code for this and linking the numbers? It will be very helpful for me.","body":"Can you give me the code for this and linking the numbers? It will be very helpful for me."},{"owner":{"account_id":4942701,"reputation":665,"user_id":3978990,"display_name":"Vladimir Parfenov"},"score":0,"creation_date":1492004580,"post_id":43371172,"comment_id":73804416,"body_markdown":"Your class MyList isn&#39;t implementation of Linked List structure. Now you have list of lists of lists...","body":"Your class MyList isn&#39;t implementation of Linked List structure. Now you have list of lists of lists..."},{"owner":{"account_id":10662772,"reputation":23,"user_id":7850267,"display_name":"Prem"},"score":0,"creation_date":1492004747,"post_id":43371172,"comment_id":73804562,"body_markdown":"here I want to make linked list of input numbers given by user. for example a use wants to make a singly linked list of 10  positive number. but if he gives any negative number it will warn the user to input positive number. I am unable to create linking between numbers or making the linked list.","body":"here I want to make linked list of input numbers given by user. for example a use wants to make a singly linked list of 10  positive number. but if he gives any negative number it will warn the user to input positive number. I am unable to create linking between numbers or making the linked list."},{"owner":{"account_id":10662772,"reputation":23,"user_id":7850267,"display_name":"Prem"},"score":0,"creation_date":1492004913,"post_id":43371172,"comment_id":73804692,"body_markdown":"can you give me proper solution @VladimirParfenov","body":"can you give me proper solution @VladimirParfenov"},{"owner":{"account_id":4942701,"reputation":665,"user_id":3978990,"display_name":"Vladimir Parfenov"},"score":0,"creation_date":1492005483,"post_id":43371172,"comment_id":73805155,"body_markdown":"@Prem First, you need to learn linked lists as data structures in theory. You can read Sedgewick&#39;s or Lafore&#39;s books about data structures and algorithms in java.","body":"@Prem First, you need to learn linked lists as data structures in theory. You can read Sedgewick&#39;s or Lafore&#39;s books about data structures and algorithms in java."}],"answers":[{"tags":[],"owner":{"account_id":4034273,"reputation":383,"user_id":3319324,"display_name":"M. Haverbier"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1492074803,"creation_date":1492074803,"answer_id":43388118,"question_id":43371172,"body_markdown":"This could help you understand Linked Lists:\r\n[LinkedList in wikipedia][1]\r\n\r\nA LinkedList consists of Nodes. A node could look like this:\r\n\r\n    class Node {\r\n      Node previousNode, nextNode;\r\n      int value;\r\n\r\n      public Node getLastNode() {\r\n        // traverse nextNode till it is null.. return the Node before.\r\n      }\r\n    }\r\n\r\nMake a method for reading the user input, which returns the number entered.\r\n\r\n    private int getUserInput() {\r\n      int result = -1;\r\n      Scanner userInput= new Scanner(System.in);\r\n      while ( result &lt; 0) {\r\n        result = userInput.nextInt();\r\n      }\r\n      return result;\r\n    }\r\n\r\nAfter that you can create your LinkedList by creating Nodes as much as needed.\r\n\r\n    Node myLinkedList = new Node();\r\n    myLinkedList.value = 0;\r\n    for (int i = 1; i &lt; getUserInputResult; i++) {\r\n      var newNode = new Node();\r\n      newNode.value = i;\r\n      // concat new Node to last Node in List;\r\n      var lastNodeInList = myLinkedList.getLastNode();\r\n      lastNodeInList .NextNode = newNode;\r\n      newNode.previousNode = lastNodeInList;\r\n    }\r\n\r\n  [1]: https://en.wikipedia.org/wiki/Linked_list","title":"Linked List User Input","body":"<p>This could help you understand Linked Lists:\n<a href=\"https://en.wikipedia.org/wiki/Linked_list\" rel=\"nofollow noreferrer\">LinkedList in wikipedia</a></p>\n\n<p>A LinkedList consists of Nodes. A node could look like this:</p>\n\n<pre><code>class Node {\n  Node previousNode, nextNode;\n  int value;\n\n  public Node getLastNode() {\n    // traverse nextNode till it is null.. return the Node before.\n  }\n}\n</code></pre>\n\n<p>Make a method for reading the user input, which returns the number entered.</p>\n\n<pre><code>private int getUserInput() {\n  int result = -1;\n  Scanner userInput= new Scanner(System.in);\n  while ( result &lt; 0) {\n    result = userInput.nextInt();\n  }\n  return result;\n}\n</code></pre>\n\n<p>After that you can create your LinkedList by creating Nodes as much as needed.</p>\n\n<pre><code>Node myLinkedList = new Node();\nmyLinkedList.value = 0;\nfor (int i = 1; i &lt; getUserInputResult; i++) {\n  var newNode = new Node();\n  newNode.value = i;\n  // concat new Node to last Node in List;\n  var lastNodeInList = myLinkedList.getLastNode();\n  lastNodeInList .NextNode = newNode;\n  newNode.previousNode = lastNodeInList;\n}\n</code></pre>\n"}],"owner":{"account_id":10662772,"reputation":23,"user_id":7850267,"display_name":"Prem"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":9907,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":1,"score":0,"last_activity_date":1695366445,"creation_date":1492004215,"question_id":43371172,"body_markdown":"I am trying to make a linked list which will take input from user that how many number he wants to make the linked list not using the built in LinkedList function. but if the user input a negative number it will give message the user to input a positive number. I have done the code for user input but finding very difficulty for other parts-negative input and linking the numbers.can anyone please give me these parts of codes. \r\n\r\n   \r\n\r\n     import java.io.*;\r\n    import java.util.Scanner;\r\n    \r\n        class MyList{\r\n    \tpublic MyList firstLink,lastLink;\r\n    \tint info,size;\r\n    \tMyList link;\r\n    \tprivate MyList next;\r\n    \t\r\n    \tMyList(){\r\n    \t\tthis.link=null;\r\n    \t\tfirstLink = null;\r\n    \t\tlastLink=null;\r\n    \t}\r\n    \tpublic boolean isEmpty(){\r\n    \t\t return(firstLink == null);\r\n    \t }\r\n    \t \r\n    \t public void showMyList() {\r\n    \t\t MyList currentLink = firstLink;\r\n    \t        System.out.print(&quot;List: &quot;);\r\n    \t        while(currentLink != null) {\r\n    \t            currentLink.showMyList();\r\n    \t            currentLink = currentLink.lastLink;\r\n    \t        }\r\n    \t        System.out.println(&quot;&quot;);\r\n    \t    }\r\n    }\r\n    \r\n        public class MyLinkedList {\r\n    \t\r\n    \tpublic static void main(String[] args){\r\n    \t\t\r\n    \t\tMyList newMyList=new MyList();\r\n    \t\tScanner userInput= new Scanner(System.in);\r\n    \t\t\r\n    \t\tint userInputNumber;\r\n    \t\tSystem.out.println(&quot;Enter Total Data&quot;);\r\n    \t\tuserInputNumber = userInput.nextInt();\r\n    \t\t\tint i=1;\r\n    \t\t\twhile(i&lt;=userInputNumber){\r\n    \t\t\tSystem.out.println(&quot;Enter Data &quot;+ i +&quot;:&quot;);\r\n    \t\t\ti++; \r\n    \t\t\tnewMyList.info=userInput.nextInt();\r\n    \t\t\t}\r\n    \t\t\tif(newMyList.firstLink!=null){\r\n    \t\t\t\tnewMyList=newMyList.firstLink;\r\n    \t\t\t\tnewMyList=newMyList.lastLink;\r\n    \t\t\t\tnewMyList.firstLink=newMyList.firstLink.link;\r\n        \t}\r\n    \t}\r\n    }\r\n\r\n","title":"Linked List User Input","body":"<p>I am trying to make a linked list which will take input from user that how many number he wants to make the linked list not using the built in LinkedList function. but if the user input a negative number it will give message the user to input a positive number. I have done the code for user input but finding very difficulty for other parts-negative input and linking the numbers.can anyone please give me these parts of codes. </p>\n\n<pre><code> import java.io.*;\nimport java.util.Scanner;\n\n    class MyList{\n    public MyList firstLink,lastLink;\n    int info,size;\n    MyList link;\n    private MyList next;\n\n    MyList(){\n        this.link=null;\n        firstLink = null;\n        lastLink=null;\n    }\n    public boolean isEmpty(){\n         return(firstLink == null);\n     }\n\n     public void showMyList() {\n         MyList currentLink = firstLink;\n            System.out.print(\"List: \");\n            while(currentLink != null) {\n                currentLink.showMyList();\n                currentLink = currentLink.lastLink;\n            }\n            System.out.println(\"\");\n        }\n}\n\n    public class MyLinkedList {\n\n    public static void main(String[] args){\n\n        MyList newMyList=new MyList();\n        Scanner userInput= new Scanner(System.in);\n\n        int userInputNumber;\n        System.out.println(\"Enter Total Data\");\n        userInputNumber = userInput.nextInt();\n            int i=1;\n            while(i&lt;=userInputNumber){\n            System.out.println(\"Enter Data \"+ i +\":\");\n            i++; \n            newMyList.info=userInput.nextInt();\n            }\n            if(newMyList.firstLink!=null){\n                newMyList=newMyList.firstLink;\n                newMyList=newMyList.lastLink;\n                newMyList.firstLink=newMyList.firstLink.link;\n        }\n    }\n}\n</code></pre>\n"},{"tags":["java","arrays","if-statement"],"comments":[{"owner":{"account_id":6077988,"reputation":1434,"user_id":4744661,"accept_rate":75,"display_name":"IAspireToBeGladOS"},"score":0,"creation_date":1428030636,"post_id":29424984,"comment_id":47022491,"body_markdown":"@HovercraftFullOfEels No, actually... my question specifically (as stated in the beginning of the post) is that I don&#39;t know how to compare the given user input with the array of correct answers. For example, if the answers are [1,2,3,4,5] and the user input is [1,2,3,8,5] it should report that one element differed. What I need to know is what is a way I could do that?","body":"@HovercraftFullOfEels No, actually... my question specifically (as stated in the beginning of the post) is that I don&#39;t know how to compare the given user input with the array of correct answers. For example, if the answers are [1,2,3,4,5] and the user input is [1,2,3,8,5] it should report that one element differed. What I need to know is what is a way I could do that?"},{"owner":{"account_id":247613,"reputation":284089,"user_id":522444,"accept_rate":100,"display_name":"Hovercraft Full Of Eels"},"score":0,"creation_date":1428030854,"post_id":29424984,"comment_id":47022527,"body_markdown":"Inside your for-loop if boolean check, you&#39;re hard-coding the array item checked in the answer array to be the 0th item only and not the answer item corresponding to the ith question: `if (answer.compareTo(answerkey[0])==0){`. Shouldn&#39;t it be `if (answer.compareTo(answerkey[i]) == 0) {` or `if (answer.equals(answerkey[i])) {`?","body":"Inside your for-loop if boolean check, you&#39;re hard-coding the array item checked in the answer array to be the 0th item only and not the answer item corresponding to the ith question: <code>if (answer.compareTo(answerkey[0])==0){</code>. Shouldn&#39;t it be <code>if (answer.compareTo(answerkey[i]) == 0) {</code> or <code>if (answer.equals(answerkey[i])) {</code>?"},{"owner":{"account_id":6077988,"reputation":1434,"user_id":4744661,"accept_rate":75,"display_name":"IAspireToBeGladOS"},"score":0,"creation_date":1428031234,"post_id":29424984,"comment_id":47022589,"body_markdown":"AH. Unsure how I missed that, thank you so much.","body":"AH. Unsure how I missed that, thank you so much."},{"owner":{"account_id":247613,"reputation":284089,"user_id":522444,"accept_rate":100,"display_name":"Hovercraft Full Of Eels"},"score":0,"creation_date":1428031353,"post_id":29424984,"comment_id":47022605,"body_markdown":"And I totally missed your question -- sorry about that.","body":"And I totally missed your question -- sorry about that."}],"answers":[{"tags":[],"owner":{"account_id":4070058,"reputation":132,"user_id":3738337,"accept_rate":75,"display_name":"mrfixij"},"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1428032462,"creation_date":1428032462,"answer_id":29425874,"question_id":29424984,"body_markdown":"Use a dynamic index accessing variable.  Right now, every answer you have will be compared to the first answer (&quot;b&quot;)\r\n\r\nAn example of this would be\r\n\r\n    String[] myArray = { //initialize values here\r\n                           };\r\n\r\n    for (int index = 0; index &lt;= myArray.length-1; index++){\r\n        if (answer.equals(myArray[index]){\r\n            correct++;}\r\n        else{\r\n            incorrect++;}\r\n        }","title":"Making a quiz with Java using arrays. Need pointers with grading answers","body":"<p>Use a dynamic index accessing variable.  Right now, every answer you have will be compared to the first answer (\"b\")</p>\n\n<p>An example of this would be</p>\n\n<pre><code>String[] myArray = { //initialize values here\n                       };\n\nfor (int index = 0; index &lt;= myArray.length-1; index++){\n    if (answer.equals(myArray[index]){\n        correct++;}\n    else{\n        incorrect++;}\n    }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":12677226,"reputation":1,"user_id":9212435,"display_name":"HopingToPassITCourse"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1515842280,"creation_date":1515841234,"answer_id":48239208,"question_id":29424984,"body_markdown":"Try this code on comparing the user input with the array `myArray`.\r\n\r\nHope this helps.\r\n\r\n    String[] myArray= { //initialize values here \r\n    };\r\n    \r\n\r\n    if ((myArray[0]).equals(answer)){\r\n        correct++;\r\n    } else{\r\n        incorrect++;\r\n    } ","title":"Making a quiz with Java using arrays. Need pointers with grading answers","body":"<p>Try this code on comparing the user input with the array <code>myArray</code>.</p>\n\n<p>Hope this helps.</p>\n\n<pre><code>String[] myArray= { //initialize values here \n};\n\n\nif ((myArray[0]).equals(answer)){\n    correct++;\n} else{\n    incorrect++;\n} \n</code></pre>\n"}],"owner":{"account_id":6077988,"reputation":1434,"user_id":4744661,"accept_rate":75,"display_name":"IAspireToBeGladOS"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":17904,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":2,"score":0,"last_activity_date":1695366445,"creation_date":1428024350,"question_id":29424984,"body_markdown":"This is for a class. I&#39;m having trouble figuring out how to best compare the user input with the array answerkey and consequently grade the answers given. I tried searching for a while but wasn&#39;t able to find what I needed, so any pointers would be much appreciated!\r\n\r\nThe prompt for the exercise is: \r\n\r\nWrite a DMV program that grades the written portion of the driver&#39;s license exam. It should have 20 multiple choice questions. It should ask the user to enter the students answers for each of the 20 questions, which should be stored in another array. After the students answer have been entered, the program should display a message indicating whether the student passed or failed the exam.( A student must correctly answer 15 of the 20 questions to pas the exam). It should then display the total number of correctly answered questions, and the total number of incorrectly answered questions. Input validation: Only accept the letters A, B, C or D.\r\n\r\nMy code so far:\r\n\r\n    public static void main(String[] args) {\r\n        Scanner input = new Scanner(System.in);\r\n            \r\n        String[] answerkey = {&quot;b&quot;,&quot;d&quot;,&quot;a&quot;,&quot;a&quot;,&quot;c&quot;,&quot;a&quot;,&quot;a&quot;,&quot;d&quot;,&quot;b&quot;,&quot;b&quot;,&quot;b&quot;,&quot;d&quot;,&quot;c&quot;,&quot;a&quot;,&quot;c&quot;,&quot;c&quot;,&quot;a&quot;,&quot;d&quot;,&quot;a&quot;,&quot;a&quot;};\r\n        int n = 0;\r\n            \r\n            int correct = 0;\r\n            int incorrect = 0;\r\n            String answer = &quot;&quot;;\r\n\r\n            for (int i = 0; i &lt; 20; i++){\r\n                System.out.println(&quot;Please enter your answers. Acceptable input is limited to A,B,C and D.\\n&quot;);\r\n                answer = input.next();\r\n\r\n                if (answer.compareTo(answerkey[0])==0){\r\n                    correct++;} \r\n                else {incorrect++;}\r\n            }\r\n                \r\n            if (correct &gt; 14){\r\n                System.out.println(&quot;You passed.&quot;);\r\n            } else {\r\n               System.out.println(&quot;You failed.&quot;);\r\n            }\r\n            System.out.println(&quot;You have &quot; + correct + &quot; correct answers.&quot;);\r\n            System.out.println(&quot;You have &quot; + incorrect + &quot; incorrect answers.&quot;);\r\n        \r\n    }","title":"Making a quiz with Java using arrays. Need pointers with grading answers","body":"<p>This is for a class. I'm having trouble figuring out how to best compare the user input with the array answerkey and consequently grade the answers given. I tried searching for a while but wasn't able to find what I needed, so any pointers would be much appreciated!</p>\n\n<p>The prompt for the exercise is: </p>\n\n<p>Write a DMV program that grades the written portion of the driver's license exam. It should have 20 multiple choice questions. It should ask the user to enter the students answers for each of the 20 questions, which should be stored in another array. After the students answer have been entered, the program should display a message indicating whether the student passed or failed the exam.( A student must correctly answer 15 of the 20 questions to pas the exam). It should then display the total number of correctly answered questions, and the total number of incorrectly answered questions. Input validation: Only accept the letters A, B, C or D.</p>\n\n<p>My code so far:</p>\n\n<pre><code>public static void main(String[] args) {\n    Scanner input = new Scanner(System.in);\n\n    String[] answerkey = {\"b\",\"d\",\"a\",\"a\",\"c\",\"a\",\"a\",\"d\",\"b\",\"b\",\"b\",\"d\",\"c\",\"a\",\"c\",\"c\",\"a\",\"d\",\"a\",\"a\"};\n    int n = 0;\n\n        int correct = 0;\n        int incorrect = 0;\n        String answer = \"\";\n\n        for (int i = 0; i &lt; 20; i++){\n            System.out.println(\"Please enter your answers. Acceptable input is limited to A,B,C and D.\\n\");\n            answer = input.next();\n\n            if (answer.compareTo(answerkey[0])==0){\n                correct++;} \n            else {incorrect++;}\n        }\n\n        if (correct &gt; 14){\n            System.out.println(\"You passed.\");\n        } else {\n           System.out.println(\"You failed.\");\n        }\n        System.out.println(\"You have \" + correct + \" correct answers.\");\n        System.out.println(\"You have \" + incorrect + \" incorrect answers.\");\n\n}\n</code></pre>\n"},{"tags":["java","mysql","tomcat","jdbc","amazon-web-services"],"comments":[{"owner":{"account_id":407817,"reputation":2467,"user_id":778109,"accept_rate":36,"display_name":"Garreth McDaid"},"score":0,"creation_date":1397127276,"post_id":22985904,"comment_id":35102171,"body_markdown":"Where is the Tomcat server? In Amazon EC2 or elsewhere? Amazon RDS instances are protected by Security Groups. You need to ensure your Security Group is set up correctly.","body":"Where is the Tomcat server? In Amazon EC2 or elsewhere? Amazon RDS instances are protected by Security Groups. You need to ensure your Security Group is set up correctly."},{"owner":{"account_id":1916207,"reputation":2821,"user_id":1728753,"accept_rate":71,"display_name":"teekib"},"score":0,"creation_date":1397127698,"post_id":22985904,"comment_id":35102454,"body_markdown":"@GarrethMcDaid yes tomcat is in EC2, in security groups gave all permission also Added my IP for MYSQl rule","body":"@GarrethMcDaid yes tomcat is in EC2, in security groups gave all permission also Added my IP for MYSQl rule"},{"owner":{"account_id":407817,"reputation":2467,"user_id":778109,"accept_rate":36,"display_name":"Garreth McDaid"},"score":0,"creation_date":1397139622,"post_id":22985904,"comment_id":35111168,"body_markdown":"It could be that your instance is in a VPC and your RDS isn&#39;t set up with a VPC subnet.","body":"It could be that your instance is in a VPC and your RDS isn&#39;t set up with a VPC subnet."}],"answers":[{"tags":[],"owner":{"account_id":407817,"reputation":2467,"user_id":778109,"accept_rate":36,"display_name":"Garreth McDaid"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1397139744,"creation_date":1397139744,"answer_id":22990835,"question_id":22985904,"body_markdown":"It could be that your instance is in a VPC and your RDS instance isn&#39;t set up in a VPC subnet group.\r\n\r\nIf you want to connect to an RDS instance from a server instance in a VPC, your RDS instance has to be deployed in a VPC subnet.\r\n\r\nhttp://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_VPC.CreateDBSubnetGroup.html","title":"Unable to Access RDS with JDBC in AWS","body":"<p>It could be that your instance is in a VPC and your RDS instance isn't set up in a VPC subnet group.</p>\n\n<p>If you want to connect to an RDS instance from a server instance in a VPC, your RDS instance has to be deployed in a VPC subnet.</p>\n\n<p><a href=\"http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_VPC.CreateDBSubnetGroup.html\" rel=\"nofollow\">http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_VPC.CreateDBSubnetGroup.html</a></p>\n"}],"owner":{"account_id":1916207,"reputation":2821,"user_id":1728753,"accept_rate":71,"display_name":"teekib"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":12228,"favorite_count":0,"down_vote_count":0,"up_vote_count":6,"answer_count":1,"score":6,"last_activity_date":1695366445,"creation_date":1397126992,"question_id":22985904,"body_markdown":"I am finding hard time connecting to RDS using JDBC connection, I am able to connect through MYSQL workbench, I deployed my WAR file in A WSwhich is running tomcat, this WAR file has my JDBCcode connecting to RDS, but I am not even able to establish connection.\r\nMy code is as below:-\r\n\r\n    public static Connection getconnection(){\r\n    \r\n    \t String connectionUrl = &quot;jdbc:mysql://testinstance.cj3ixhryi3fb.us-west-2.rds.amazonaws.com:3306/testDB&quot;;\r\n    \t    String dbUser = &quot;testuser&quot;;\r\n    \t    String dbPwd = &quot;usertest&quot;;\r\n    \t    Connection conn = null;\r\n    \t    \r\n    \t    try {\r\n    \t\t\tconn = (Connection) DriverManager.getConnection(connectionUrl, dbUser, dbPwd);\r\n    \t\t\tSystem.out.println(&quot;conn Available&quot;);\r\n    \t\t} catch (SQLException e) {\r\n    \t\t\t// TODO Auto-generated catch block\r\n    \t\t\te.printStackTrace();\r\n    \t\t\tSystem.out.println(&quot;fetch otion error&quot;+e.getLocalizedMessage());\r\n    \t\t}\r\n    \t    \r\n    \t    return conn;\r\n    }   \r\n\r\nI included all the necessary jar files, and rules security groups but no luck.\r\n\r\n**I am using the EC2 security group for RDS. Does RDS will use ec2 security groups?**\r\nor I need to have different security group for RDS?\r\n\r\n\r\nthe testinstance is a working link if any one wanna test.","title":"Unable to Access RDS with JDBC in AWS","body":"<p>I am finding hard time connecting to RDS using JDBC connection, I am able to connect through MYSQL workbench, I deployed my WAR file in A WSwhich is running tomcat, this WAR file has my JDBCcode connecting to RDS, but I am not even able to establish connection.\nMy code is as below:-</p>\n\n<pre><code>public static Connection getconnection(){\n\n     String connectionUrl = \"jdbc:mysql://testinstance.cj3ixhryi3fb.us-west-2.rds.amazonaws.com:3306/testDB\";\n        String dbUser = \"testuser\";\n        String dbPwd = \"usertest\";\n        Connection conn = null;\n\n        try {\n            conn = (Connection) DriverManager.getConnection(connectionUrl, dbUser, dbPwd);\n            System.out.println(\"conn Available\");\n        } catch (SQLException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n            System.out.println(\"fetch otion error\"+e.getLocalizedMessage());\n        }\n\n        return conn;\n}   \n</code></pre>\n\n<p>I included all the necessary jar files, and rules security groups but no luck.</p>\n\n<p><strong>I am using the EC2 security group for RDS. Does RDS will use ec2 security groups?</strong>\nor I need to have different security group for RDS?</p>\n\n<p>the testinstance is a working link if any one wanna test.</p>\n"},{"tags":["java","spring","jpa"],"comments":[{"owner":{"account_id":15178500,"reputation":4190,"user_id":10952503,"display_name":"Elikill58"},"score":0,"creation_date":1695364295,"post_id":77155291,"comment_id":136016978,"body_markdown":"What do you mean with &quot;distinct&quot;? like &quot;onetable&quot; and &quot;twotable&quot; could be the same object?","body":"What do you mean with &quot;distinct&quot;? like &quot;onetable&quot; and &quot;twotable&quot; could be the same object?"}],"answers":[{"tags":[],"owner":{"account_id":29506577,"reputation":56,"user_id":22612418,"display_name":"coderMan"},"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1695364250,"creation_date":1695364250,"answer_id":77155306,"question_id":77155291,"body_markdown":"To distinct the results based on the &quot;tid&quot; column and get a unique result set, you can use a Set to keep track of unique tid values while iterating through the datasetresults. Here&#39;s how you can modify your code to achieve this:\r\n\r\n&lt;!-- begin snippet: js hide: false console: true babel: false --&gt;\r\n\r\n&lt;!-- language: lang-python --&gt;\r\n\r\n    Page&lt;Object[]&gt; datasetresults = repository.findtest(tid, PageRequest.of(page, per_page, Sort.by(s, sort)));\r\n\r\n    // Create a Set to keep track of unique tid values\r\n    Set&lt;Long&gt; uniqueTids = new HashSet&lt;&gt;();\r\n\r\n    for (Object[] object : datasetresults.getContent()) {\r\n        if (object[0] instanceof onetable &amp;&amp; object[1] instanceof twotable) {\r\n            onetable onetable = (onetable) object[0];\r\n            twotable twotable = (twotable) object[1];\r\n\r\n            // Check if the tid is unique\r\n            if (uniqueTids.add(onetable.getTid())) {\r\n                // This tid is unique, process the result\r\n                TestBean test = new TestBean();\r\n\r\n                // Add your code here to process the unique result\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n&lt;!-- end snippet --&gt;\r\n\r\nIn this code, we use a Set&lt;Long&gt; called uniqueTids to keep track of unique &quot;tid&quot; values. Before processing each result, we check if the &quot;tid&quot; is already in the set using uniqueTids.add(onetable.getTid()). If it&#39;s a new &quot;tid,&quot; we process the result. This ensures that only unique &quot;tid&quot; values are processed, giving you a distinct result set based on &quot;tid.&quot;\r\n","title":"how to distinct below result using java","body":"<p>To distinct the results based on the &quot;tid&quot; column and get a unique result set, you can use a Set to keep track of unique tid values while iterating through the datasetresults. Here's how you can modify your code to achieve this:</p>\n<pre class=\"lang-python prettyprint-override\"><code>Page&lt;Object[]&gt; datasetresults = repository.findtest(tid, PageRequest.of(page, per_page, Sort.by(s, sort)));\n\n// Create a Set to keep track of unique tid values\nSet&lt;Long&gt; uniqueTids = new HashSet&lt;&gt;();\n\nfor (Object[] object : datasetresults.getContent()) {\n    if (object[0] instanceof onetable &amp;&amp; object[1] instanceof twotable) {\n        onetable onetable = (onetable) object[0];\n        twotable twotable = (twotable) object[1];\n\n        // Check if the tid is unique\n        if (uniqueTids.add(onetable.getTid())) {\n            // This tid is unique, process the result\n            TestBean test = new TestBean();\n\n            // Add your code here to process the unique result\n        }\n    }\n}\n</code></pre>\n<p>In this code, we use a Set called uniqueTids to keep track of unique &quot;tid&quot; values. Before processing each result, we check if the &quot;tid&quot; is already in the set using uniqueTids.add(onetable.getTid()). If it's a new &quot;tid,&quot; we process the result. This ensures that only unique &quot;tid&quot; values are processed, giving you a distinct result set based on &quot;tid.&quot;</p>\n"}],"owner":{"account_id":22951251,"reputation":23,"user_id":17082496,"display_name":"new001"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":38,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":77155306,"answer_count":1,"score":2,"last_activity_date":1695365417,"creation_date":1695364017,"question_id":77155291,"body_markdown":"How to distinct below result using java? My code is as per below:\r\n\r\n    Page&lt;Object[]&gt; datasetresults=repository.findtest(tid,\r\n    \t\t\t\t\tPageRequest.of(page, per_page, Sort.by(s, sort)));\r\n\r\n\tfor (Object[] object : datasetresults.getContent()) {\r\n\t\tif (object[0] instanceof onetable ) {\r\n\t\t\tonetable onetable = (onetable) object[0];\r\n\t\t\tTestBean test = new TestBean();\r\n\t\t}\t\r\n\t}\r\n\r\nI need to distinct using `tid` to get one unique result set.\r\n","title":"how to distinct below result using java","body":"<p>How to distinct below result using java? My code is as per below:</p>\n<pre><code>Page&lt;Object[]&gt; datasetresults=repository.findtest(tid,\n                    PageRequest.of(page, per_page, Sort.by(s, sort)));\n\nfor (Object[] object : datasetresults.getContent()) {\n    if (object[0] instanceof onetable ) {\n        onetable onetable = (onetable) object[0];\n        TestBean test = new TestBean();\n    }   \n}\n</code></pre>\n<p>I need to distinct using <code>tid</code> to get one unique result set.</p>\n"},{"tags":["java","mysql","docker","docker-compose"],"comments":[{"owner":{"account_id":28965224,"reputation":321,"user_id":22186847,"display_name":"JoreJoh"},"score":0,"creation_date":1695321579,"post_id":77152819,"comment_id":136012486,"body_markdown":"In case it&#39;s relevant, Windows Task Manager shows two `mysqld` processes (maybe it has something to do with 3306 being occupied). No other MySQL-related processes were discovered","body":"In case it&#39;s relevant, Windows Task Manager shows two <code>mysqld</code> processes (maybe it has something to do with 3306 being occupied). No other MySQL-related processes were discovered"},{"owner":{"account_id":28965224,"reputation":321,"user_id":22186847,"display_name":"JoreJoh"},"score":0,"creation_date":1695321920,"post_id":77152819,"comment_id":136012545,"body_markdown":"Maybe, I need to add and run some additional image (Tomcat, for example)?","body":"Maybe, I need to add and run some additional image (Tomcat, for example)?"},{"owner":{"account_id":16744354,"reputation":504,"user_id":12103109,"display_name":"CaptainAye"},"score":0,"creation_date":1695326959,"post_id":77152819,"comment_id":136013373,"body_markdown":"You&#39;re declaring env variables like SPRING_DATASOURCE_URL but you&#39;re not using them anywhere. Uncomment your application.properties file and configure the properties like spring.datasource.url=${SPRING_DATASOURCE_URL} and see if it works.","body":"You&#39;re declaring env variables like SPRING_DATASOURCE_URL but you&#39;re not using them anywhere. Uncomment your application.properties file and configure the properties like spring.datasource.url=${SPRING_DATASOURCE_URL} and see if it works."},{"owner":{"account_id":16744354,"reputation":504,"user_id":12103109,"display_name":"CaptainAye"},"score":0,"creation_date":1695327093,"post_id":77152819,"comment_id":136013399,"body_markdown":"Alternatively, you can check the answer in here https://stackoverflow.com/questions/66169935/how-to-set-spring-datasource-url-inside-a-docker-container","body":"Alternatively, you can check the answer in here <a href=\"https://stackoverflow.com/questions/66169935/how-to-set-spring-datasource-url-inside-a-docker-container\" title=\"how to set spring datasource url inside a docker container\">stackoverflow.com/questions/66169935/&hellip;</a>"},{"owner":{"account_id":13863020,"reputation":137023,"user_id":10008173,"display_name":"David Maze"},"score":0,"creation_date":1695340365,"post_id":77152819,"comment_id":136014988,"body_markdown":"Connections between containers don&#39;t use (or require) `ports:`.  In the Compose file setting `SPRING_DATASOURCE_URL`, does changing the port number back to the standard MySQL port 3306 help?  (Spring knows how to set the `spring.datasource.url` property from that environment variable, you don&#39;t need to change your jar file at all.)  Also see _e.g._ [Docker MySQL connection refused on different port](https://stackoverflow.com/questions/54993731/docker-mysql-connection-refused-on-different-port).","body":"Connections between containers don&#39;t use (or require) <code>ports:</code>.  In the Compose file setting <code>SPRING_DATASOURCE_URL</code>, does changing the port number back to the standard MySQL port 3306 help?  (Spring knows how to set the <code>spring.datasource.url</code> property from that environment variable, you don&#39;t need to change your jar file at all.)  Also see <i>e.g.</i> <a href=\"https://stackoverflow.com/questions/54993731/docker-mysql-connection-refused-on-different-port\">Docker MySQL connection refused on different port</a>."},{"owner":{"account_id":28965224,"reputation":321,"user_id":22186847,"display_name":"JoreJoh"},"score":0,"creation_date":1695361868,"post_id":77152819,"comment_id":136016687,"body_markdown":"@CaptainAye thank you, you helped me a lot. See the answer","body":"@CaptainAye thank you, you helped me a lot. See the answer"},{"owner":{"account_id":28965224,"reputation":321,"user_id":22186847,"display_name":"JoreJoh"},"score":0,"creation_date":1695361873,"post_id":77152819,"comment_id":136016688,"body_markdown":"@DavidMaze thank you, you helped me a lot. See the answer","body":"@DavidMaze thank you, you helped me a lot. See the answer"},{"owner":{"account_id":28965224,"reputation":321,"user_id":22186847,"display_name":"JoreJoh"},"score":0,"creation_date":1695361998,"post_id":77152819,"comment_id":136016697,"body_markdown":"It seems to work, but I&#39;m not 100% certain. I now can&#39;t just open Workbench and make sure the changes in the UI are actually reflected in the database with a simple `SELECT` query. Can I somehow access that database data from outside the Docker container? I can&#39;t just type `localhost:3307` in my browser and get some web interface to perform my queries (in fact, I don&#39;t get any meaningful response at all when I do that)","body":"It seems to work, but I&#39;m not 100% certain. I now can&#39;t just open Workbench and make sure the changes in the UI are actually reflected in the database with a simple <code>SELECT</code> query. Can I somehow access that database data from outside the Docker container? I can&#39;t just type <code>localhost:3307</code> in my browser and get some web interface to perform my queries (in fact, I don&#39;t get any meaningful response at all when I do that)"},{"owner":{"account_id":28965224,"reputation":321,"user_id":22186847,"display_name":"JoreJoh"},"score":0,"creation_date":1695363886,"post_id":77152819,"comment_id":136016936,"body_markdown":"Once I open MySQL 8.0 Command Line Client, I&#39;m simply prompted to enter a password, presumably from my root user. At this point, I can&#39;t execute any commands relating to my Docker db. Once I enter the password, I&#39;m automatically connected to my local MySQL server and the only thing I can do is to execute queries. Can MySQL Command Line Client even help me in achieving my goal (to connect to the Docker db and execute a query to check my web app updates database data, not just the UI)? `mysql` doesn&#39;t work in a regular Powershell","body":"Once I open MySQL 8.0 Command Line Client, I&#39;m simply prompted to enter a password, presumably from my root user. At this point, I can&#39;t execute any commands relating to my Docker db. Once I enter the password, I&#39;m automatically connected to my local MySQL server and the only thing I can do is to execute queries. Can MySQL Command Line Client even help me in achieving my goal (to connect to the Docker db and execute a query to check my web app updates database data, not just the UI)? <code>mysql</code> doesn&#39;t work in a regular Powershell"},{"owner":{"account_id":28965224,"reputation":321,"user_id":22186847,"display_name":"JoreJoh"},"score":0,"creation_date":1695364846,"post_id":77152819,"comment_id":136017051,"body_markdown":"Oh, I figured that out. See the answer&#39;s edit","body":"Oh, I figured that out. See the answer&#39;s edit"},{"owner":{"account_id":28965224,"reputation":321,"user_id":22186847,"display_name":"JoreJoh"},"score":0,"creation_date":1695369112,"post_id":77152819,"comment_id":136017834,"body_markdown":"What kinda annoys me a bit, though, is that 3307:3306 mismatch. Is that the right way to do it after all? 3306:3306 doesn&#39;t work, but maybe I was supposed to resolve that some other way","body":"What kinda annoys me a bit, though, is that 3307:3306 mismatch. Is that the right way to do it after all? 3306:3306 doesn&#39;t work, but maybe I was supposed to resolve that some other way"}],"answers":[{"tags":[],"owner":{"account_id":28965224,"reputation":321,"user_id":22186847,"display_name":"JoreJoh"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695365235,"creation_date":1695361789,"answer_id":77155120,"question_id":77152819,"body_markdown":"My problem had to do with these mistakes\r\n\r\n#### 1. Not including the properties\r\nI had to reference the `docker-compose.yml` properties in my `application.properties` file\r\n```properties\r\nspring.datasource.url=${SPRING_DATASOURCE_URL}\r\nspring.datasource.username=${SPRING_DATASOURCE_USERNAME}\r\nspring.datasource.password=${SPRING_DATASOURCE_PASSWORD}\r\n```\r\n\r\n#### 2. Specifying a wrong port\r\n\r\nEven though the host port was 3307, I still needed to specify 3306 in my property\r\n```yml\r\n# the correct version\r\n\r\nversion: &#39;3&#39;\r\n\r\nservices:\r\n  app:\r\n    build:\r\n      context: .\r\n      dockerfile: Dockerfile\r\n    ports:\r\n      - &quot;8080:8080&quot;\r\n    depends_on:\r\n      - db\r\n    environment:\r\n      # note the change in the following line\r\n      SPRING_DATASOURCE_URL: jdbc:mysql://db:3306/users_db?useSSL=false&amp;serverTimezone=UTC&amp;allowPublicKeyRetrieval=true\r\n      SPRING_DATASOURCE_USERNAME: pp_user\r\n      SPRING_DATASOURCE_PASSWORD: pp_user\r\n\r\n  db:\r\n    image: mysql:latest\r\n    ports:\r\n      - &quot;3307:3306&quot;\r\n    environment:\r\n      MYSQL_DATABASE: users_db\r\n      MYSQL_USER: pp_user\r\n      MYSQL_PASSWORD: pp_user\r\n      MYSQL_ROOT_PASSWORD: root_password\r\n```\r\nIf you want to access the database running inside the Docker container and check that the data is actually modified, you can install MySQL Shell (I used MySQL Installer), run it, and execute something like this\r\n```\r\nMySQL Shell 8.0.34 \r\nCopyright (c) 2016, 2023, Oracle and/or its affiliates.\r\nOracle is a registered trademark of Oracle Corporation and/or its affiliates.                                           \r\nOther names may be trademarks of their respective owners.                                                                                                                                                                               \r\nType &#39;\\help&#39; or &#39;\\?&#39; for help; &#39;\\quit&#39; to exit.                                                                           \r\nMySQL  JS &gt; \\connect --mysql -h localhost -P 3307 -u pp_user -p                                                        \r\nCreating a Classic session to &#39;pp_user@localhost:3307&#39;                                                                  \r\nPlease provide the password for &#39;pp_user@localhost:3307&#39;: *******                                                       \r\nSave password for &#39;pp_user@localhost:3307&#39;? [Y]es/[N]o/Ne[v]er (default No): Y                                          \r\nFetching schema names for auto-completion... Press ^C to stop.                                                          \r\nYour MySQL connection id is 44                                                                                          \r\nServer version: 8.1.0 MySQL Community Server - GPL                                                                      \r\nNo default schema selected; type \\use &lt;schema&gt; to set one.                                                               \r\nMySQL  localhost:3307 ssl  JS &gt; \\sql                                                                                   \r\nSwitching to SQL mode... Commands end with ;                                                                            \r\nFetching global names for auto-completion... Press ^C to stop.                                                          \r\nError during auto-completion cache update: Access denied; you need (at least one of) the PROCESS privilege(s) for this operation                                                                                                                 \r\nMySQL  localhost:3307 ssl  SQL &gt; select * from users_db.users;\r\n````\r\n\r\nI appreciate the help from *CaptainAye* and *David Maze*. They helped me a great deal","title":"Can&#39;t dockerize a web app: java.net.ConnectException","body":"<p>My problem had to do with these mistakes</p>\n<h4>1. Not including the properties</h4>\n<p>I had to reference the <code>docker-compose.yml</code> properties in my <code>application.properties</code> file</p>\n<pre><code>spring.datasource.url=${SPRING_DATASOURCE_URL}\nspring.datasource.username=${SPRING_DATASOURCE_USERNAME}\nspring.datasource.password=${SPRING_DATASOURCE_PASSWORD}\n</code></pre>\n<h4>2. Specifying a wrong port</h4>\n<p>Even though the host port was 3307, I still needed to specify 3306 in my property</p>\n<pre class=\"lang-yaml prettyprint-override\"><code># the correct version\n\nversion: '3'\n\nservices:\n  app:\n    build:\n      context: .\n      dockerfile: Dockerfile\n    ports:\n      - &quot;8080:8080&quot;\n    depends_on:\n      - db\n    environment:\n      # note the change in the following line\n      SPRING_DATASOURCE_URL: jdbc:mysql://db:3306/users_db?useSSL=false&amp;serverTimezone=UTC&amp;allowPublicKeyRetrieval=true\n      SPRING_DATASOURCE_USERNAME: pp_user\n      SPRING_DATASOURCE_PASSWORD: pp_user\n\n  db:\n    image: mysql:latest\n    ports:\n      - &quot;3307:3306&quot;\n    environment:\n      MYSQL_DATABASE: users_db\n      MYSQL_USER: pp_user\n      MYSQL_PASSWORD: pp_user\n      MYSQL_ROOT_PASSWORD: root_password\n</code></pre>\n<p>If you want to access the database running inside the Docker container and check that the data is actually modified, you can install MySQL Shell (I used MySQL Installer), run it, and execute something like this</p>\n<pre><code>MySQL Shell 8.0.34 \nCopyright (c) 2016, 2023, Oracle and/or its affiliates.\nOracle is a registered trademark of Oracle Corporation and/or its affiliates.                                           \nOther names may be trademarks of their respective owners.                                                                                                                                                                               \nType '\\help' or '\\?' for help; '\\quit' to exit.                                                                           \nMySQL  JS &gt; \\connect --mysql -h localhost -P 3307 -u pp_user -p                                                        \nCreating a Classic session to 'pp_user@localhost:3307'                                                                  \nPlease provide the password for 'pp_user@localhost:3307': *******                                                       \nSave password for 'pp_user@localhost:3307'? [Y]es/[N]o/Ne[v]er (default No): Y                                          \nFetching schema names for auto-completion... Press ^C to stop.                                                          \nYour MySQL connection id is 44                                                                                          \nServer version: 8.1.0 MySQL Community Server - GPL                                                                      \nNo default schema selected; type \\use &lt;schema&gt; to set one.                                                               \nMySQL  localhost:3307 ssl  JS &gt; \\sql                                                                                   \nSwitching to SQL mode... Commands end with ;                                                                            \nFetching global names for auto-completion... Press ^C to stop.                                                          \nError during auto-completion cache update: Access denied; you need (at least one of) the PROCESS privilege(s) for this operation                                                                                                                 \nMySQL  localhost:3307 ssl  SQL &gt; select * from users_db.users;\n</code></pre>\n<p>I appreciate the help from <em>CaptainAye</em> and <em>David Maze</em>. They helped me a great deal</p>\n"}],"owner":{"account_id":28965224,"reputation":321,"user_id":22186847,"display_name":"JoreJoh"},"comment_count":11,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":33,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1695365235,"creation_date":1695321292,"question_id":77152819,"body_markdown":"I have a web app that uses MySQL. I was hoping to &quot;dockerize&quot; it so that I learn to use Docker and at the same time make my app more &quot;shareable&quot; (anyone could check it out without downloading and setting up a MySQL server). Here&#39;s my attempt:\r\n\r\n### Step 1. Write `Dockerfile`\r\nIn the project root I created a file called Dockerfile with the following content:\r\n```\r\nFROM amazoncorretto:17-alpine-jdk\r\n\r\nWORKDIR /app\r\n\r\nCOPY target/spring_bootstrap-0.0.1-SNAPSHOT.jar .\r\n\r\nEXPOSE 8080\r\n\r\nCMD [&quot;java&quot;, &quot;-jar&quot;, &quot;spring_bootstrap-0.0.1-SNAPSHOT.jar&quot;]\r\n```\r\n### Step 2. Write `docker-compose.yml`\r\nI need to have both JDK and a MySQL server components in my container. As I understand, I need a `docker-compose.yml` file. Here&#39;s what it looks like:\r\n```yml\r\nversion: &#39;3&#39;\r\n\r\nservices:\r\n  app:\r\n    build:\r\n      context: .\r\n      dockerfile: Dockerfile\r\n    ports:\r\n      - &quot;8080:8080&quot;\r\n    depends_on:\r\n      - db\r\n    environment:\r\n      SPRING_DATASOURCE_URL: jdbc:mysql://db:3307/users_db?useSSL=false&amp;serverTimezone=UTC\r\n      SPRING_DATASOURCE_USERNAME: pp_user\r\n      SPRING_DATASOURCE_PASSWORD: pp_user\r\n\r\n  db:\r\n    image: mysql:latest\r\n    ports:\r\n      - &quot;3307:3306&quot;\r\n    environment:\r\n      MYSQL_DATABASE: users_db\r\n      MYSQL_USER: pp_user\r\n      MYSQL_PASSWORD: pp_user\r\n      MYSQL_ROOT_PASSWORD: root_password\r\n```\r\nYou might be wondering why it&#39;s 3307. It&#39;s because for some reason 3306 was already occupied (I have no idea why, MySQL server doesn&#39;t seem to be running outside the Docker container)\r\n### Step 3. Remove datasource properties from `application.properties`\r\n```properties\r\n# connection properties\r\n#spring.datasource.url=jdbc:mysql://localhost:3306/users_db?useSSL=false&amp;serverTimezone=UTC\r\n#spring.datasource.username=pp_user\r\n#spring.datasource.password=pp_user\r\n```\r\n### Step 4. Clean and package so that I have an up-to-date jar\r\n\r\n### Step 5. Navigate to the project directory and run `docker-compose up`\r\nThe command produced colossal log output. My MySQL server got up and running, but the project itself failed\r\n\r\n[![the Docker Desktop screenshot showing that MySQL is running, the app has &quot;exited&quot;][1]][1]\r\n\r\nThis was the killer. Not very informative to me, though\r\n```\r\nbootstrap_fetch-app-1  | Caused by: java.net.ConnectException: Connection refused\r\nbootstrap_fetch-app-1  |        at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]\r\nbootstrap_fetch-app-1  |        at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]\r\nbootstrap_fetch-app-1  |        at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:547) ~[na:na]\r\nbootstrap_fetch-app-1  |        at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]\r\nbootstrap_fetch-app-1  |        at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]\r\nbootstrap_fetch-app-1  |        at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]\r\nbootstrap_fetch-app-1  |        at com.mysql.cj.protocol.StandardSocketFactory.connect(StandardSocketFactory.java:153) ~[mysql-connector-j-8.0.32.jar!/:8.0.32]\r\nbootstrap_fetch-app-1  |        at com.mysql.cj.protocol.a.NativeSocketConnection.connect(NativeSocketConnection.java:63) ~[mysql-connector-j-8.0.32.jar!/:8.0.32]\r\nbootstrap_fetch-app-1  |        ... 51 common frames omitted\r\nbootstrap_fetch-app-1  |\r\nbootstrap_fetch-app-1 exited with code 1\r\n```\r\nWhat may be the problem? Please let me know if you need more details\r\n\r\n  [1]: https://i.stack.imgur.com/NLPHC.png","title":"Can&#39;t dockerize a web app: java.net.ConnectException","body":"<p>I have a web app that uses MySQL. I was hoping to &quot;dockerize&quot; it so that I learn to use Docker and at the same time make my app more &quot;shareable&quot; (anyone could check it out without downloading and setting up a MySQL server). Here's my attempt:</p>\n<h3>Step 1. Write <code>Dockerfile</code></h3>\n<p>In the project root I created a file called Dockerfile with the following content:</p>\n<pre><code>FROM amazoncorretto:17-alpine-jdk\n\nWORKDIR /app\n\nCOPY target/spring_bootstrap-0.0.1-SNAPSHOT.jar .\n\nEXPOSE 8080\n\nCMD [&quot;java&quot;, &quot;-jar&quot;, &quot;spring_bootstrap-0.0.1-SNAPSHOT.jar&quot;]\n</code></pre>\n<h3>Step 2. Write <code>docker-compose.yml</code></h3>\n<p>I need to have both JDK and a MySQL server components in my container. As I understand, I need a <code>docker-compose.yml</code> file. Here's what it looks like:</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>version: '3'\n\nservices:\n  app:\n    build:\n      context: .\n      dockerfile: Dockerfile\n    ports:\n      - &quot;8080:8080&quot;\n    depends_on:\n      - db\n    environment:\n      SPRING_DATASOURCE_URL: jdbc:mysql://db:3307/users_db?useSSL=false&amp;serverTimezone=UTC\n      SPRING_DATASOURCE_USERNAME: pp_user\n      SPRING_DATASOURCE_PASSWORD: pp_user\n\n  db:\n    image: mysql:latest\n    ports:\n      - &quot;3307:3306&quot;\n    environment:\n      MYSQL_DATABASE: users_db\n      MYSQL_USER: pp_user\n      MYSQL_PASSWORD: pp_user\n      MYSQL_ROOT_PASSWORD: root_password\n</code></pre>\n<p>You might be wondering why it's 3307. It's because for some reason 3306 was already occupied (I have no idea why, MySQL server doesn't seem to be running outside the Docker container)</p>\n<h3>Step 3. Remove datasource properties from <code>application.properties</code></h3>\n<pre><code># connection properties\n#spring.datasource.url=jdbc:mysql://localhost:3306/users_db?useSSL=false&amp;serverTimezone=UTC\n#spring.datasource.username=pp_user\n#spring.datasource.password=pp_user\n</code></pre>\n<h3>Step 4. Clean and package so that I have an up-to-date jar</h3>\n<h3>Step 5. Navigate to the project directory and run <code>docker-compose up</code></h3>\n<p>The command produced colossal log output. My MySQL server got up and running, but the project itself failed</p>\n<p><a href=\"https://i.stack.imgur.com/NLPHC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NLPHC.png\" alt=\"the Docker Desktop screenshot showing that MySQL is running, the app has &quot;exited&quot;\" /></a></p>\n<p>This was the killer. Not very informative to me, though</p>\n<pre><code>bootstrap_fetch-app-1  | Caused by: java.net.ConnectException: Connection refused\nbootstrap_fetch-app-1  |        at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]\nbootstrap_fetch-app-1  |        at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]\nbootstrap_fetch-app-1  |        at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:547) ~[na:na]\nbootstrap_fetch-app-1  |        at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]\nbootstrap_fetch-app-1  |        at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]\nbootstrap_fetch-app-1  |        at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]\nbootstrap_fetch-app-1  |        at com.mysql.cj.protocol.StandardSocketFactory.connect(StandardSocketFactory.java:153) ~[mysql-connector-j-8.0.32.jar!/:8.0.32]\nbootstrap_fetch-app-1  |        at com.mysql.cj.protocol.a.NativeSocketConnection.connect(NativeSocketConnection.java:63) ~[mysql-connector-j-8.0.32.jar!/:8.0.32]\nbootstrap_fetch-app-1  |        ... 51 common frames omitted\nbootstrap_fetch-app-1  |\nbootstrap_fetch-app-1 exited with code 1\n</code></pre>\n<p>What may be the problem? Please let me know if you need more details</p>\n"},{"tags":["java","jackson","rest-assured"],"comments":[{"owner":{"account_id":44195,"reputation":269033,"user_id":129570,"accept_rate":79,"display_name":"Oliver Charlesworth"},"score":0,"creation_date":1425340979,"post_id":28821715,"comment_id":45915145,"body_markdown":"Cannot be cast to **what**?  What is the rest of the error message?","body":"Cannot be cast to <b>what</b>?  What is the rest of the error message?"},{"owner":{"account_id":447462,"reputation":10144,"user_id":841090,"accept_rate":61,"display_name":"Passionate Engineer"},"score":1,"creation_date":1425341108,"post_id":28821715,"comment_id":45915192,"body_markdown":"@OliverCharlesworth also added entire stacktrace","body":"@OliverCharlesworth also added entire stacktrace"},{"owner":{"account_id":195854,"reputation":159194,"user_id":438992,"accept_rate":90,"display_name":"Dave Newton"},"score":2,"creation_date":1425341174,"post_id":28821715,"comment_id":45915208,"body_markdown":"What&#39;s an `Account`? Why are you trying to cast to it from a map?","body":"What&#39;s an <code>Account</code>? Why are you trying to cast to it from a map?"},{"owner":{"account_id":80775,"reputation":80356,"user_id":228171,"accept_rate":78,"display_name":"Mark Peters"},"score":0,"creation_date":1425341245,"post_id":28821715,"comment_id":45915230,"body_markdown":"For those of us who might be unfamiliar with the library, can you say what class this `given()` method is statically imported from?","body":"For those of us who might be unfamiliar with the library, can you say what class this <code>given()</code> method is statically imported from?"},{"owner":{"account_id":447462,"reputation":10144,"user_id":841090,"accept_rate":61,"display_name":"Passionate Engineer"},"score":0,"creation_date":1425341280,"post_id":28821715,"comment_id":45915246,"body_markdown":"@DaveNewton `Account` is a model from Dropwizard which uses `com.fasterxml.jackson.databind.annotations`","body":"@DaveNewton <code>Account</code> is a model from Dropwizard which uses <code>com.fasterxml.jackson.databind.annotations</code>"},{"owner":{"account_id":1007997,"reputation":2357,"user_id":1046584,"accept_rate":83,"display_name":"Lu&#237;s Bianchin"},"score":0,"creation_date":1425341285,"post_id":28821715,"comment_id":45915247,"body_markdown":"Where do you use LinkedHashMap in your code?","body":"Where do you use LinkedHashMap in your code?"},{"owner":{"account_id":447462,"reputation":10144,"user_id":841090,"accept_rate":61,"display_name":"Passionate Engineer"},"score":0,"creation_date":1425341383,"post_id":28821715,"comment_id":45915278,"body_markdown":"@MarkPeters it&#39;s `com.jayway.restassured.RestAssured.given`","body":"@MarkPeters it&#39;s <code>com.jayway.restassured.RestAssured.given</code>"},{"owner":{"account_id":447462,"reputation":10144,"user_id":841090,"accept_rate":61,"display_name":"Passionate Engineer"},"score":0,"creation_date":1425341449,"post_id":28821715,"comment_id":45915293,"body_markdown":"To library link is https://github.com/jayway/rest-assured","body":"To library link is <a href=\"https://github.com/jayway/rest-assured\" rel=\"nofollow noreferrer\">github.com/jayway/rest-assured</a>"},{"owner":{"account_id":4089780,"reputation":1489,"user_id":3358126,"accept_rate":44,"display_name":"Pavel Niedoba"},"score":0,"creation_date":1425341566,"post_id":28821715,"comment_id":45915330,"body_markdown":"Seems to me you are trying to deserialize JSON string onto Java object. The problem might be in structure mismatch. You should put here response from this URL:&quot;accounts/&quot; + newClub.getOwner().getCustId() + &quot;/clubs&quot; and Account class","body":"Seems to me you are trying to deserialize JSON string onto Java object. The problem might be in structure mismatch. You should put here response from this URL:&quot;accounts/&quot; + newClub.getOwner().getCustId() + &quot;/clubs&quot; and Account class"}],"answers":[{"tags":[],"owner":{"account_id":80775,"reputation":80356,"user_id":228171,"accept_rate":78,"display_name":"Mark Peters"},"down_vote_count":0,"up_vote_count":151,"is_accepted":true,"score":151,"last_activity_date":1551891933,"creation_date":1425341762,"answer_id":28821825,"question_id":28821715,"body_markdown":"The issue&#39;s coming from Jackson. When it doesn&#39;t have enough information on what class to deserialize to, it uses `LinkedHashMap`.  \r\n\r\nSince you&#39;re not informing Jackson of the element type of your `ArrayList`, it doesn&#39;t know that you want to deserialize into an `ArrayList` of `Account`s.  So it falls back to the default.\r\n\r\nInstead, you could probably use `as(JsonNode.class)`, and then deal with the `ObjectMapper` in a richer manner than rest-assured allows.  Something like this:\r\n\r\n    ObjectMapper mapper = new ObjectMapper();\r\n    \r\n    JsonNode accounts = given().when().expect().statusCode(expectedResponseCode)\r\n        .get(&quot;accounts/&quot; + newClub.getOwner().getCustId() + &quot;/clubs&quot;)\r\n        .as(JsonNode.class);\r\n\r\n\r\n    //Jackson&#39;s use of generics here are completely unsafe, but that&#39;s another issue\r\n    List&lt;Account&gt; accountList = mapper.convertValue(\r\n        accounts, \r\n        new TypeReference&lt;List&lt;Account&gt;&gt;(){}\r\n    );\r\n    \r\n    assertThat(accountList.get(0).getId()).isEqualTo(expectedId);","title":"java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to com.testing.models.Account","body":"<p>The issue's coming from Jackson. When it doesn't have enough information on what class to deserialize to, it uses <code>LinkedHashMap</code>.  </p>\n\n<p>Since you're not informing Jackson of the element type of your <code>ArrayList</code>, it doesn't know that you want to deserialize into an <code>ArrayList</code> of <code>Account</code>s.  So it falls back to the default.</p>\n\n<p>Instead, you could probably use <code>as(JsonNode.class)</code>, and then deal with the <code>ObjectMapper</code> in a richer manner than rest-assured allows.  Something like this:</p>\n\n<pre><code>ObjectMapper mapper = new ObjectMapper();\n\nJsonNode accounts = given().when().expect().statusCode(expectedResponseCode)\n    .get(\"accounts/\" + newClub.getOwner().getCustId() + \"/clubs\")\n    .as(JsonNode.class);\n\n\n//Jackson's use of generics here are completely unsafe, but that's another issue\nList&lt;Account&gt; accountList = mapper.convertValue(\n    accounts, \n    new TypeReference&lt;List&lt;Account&gt;&gt;(){}\n);\n\nassertThat(accountList.get(0).getId()).isEqualTo(expectedId);\n</code></pre>\n"},{"tags":[],"owner":{"account_id":5843610,"reputation":325,"user_id":4604360,"display_name":"nurb"},"down_vote_count":1,"up_vote_count":7,"is_accepted":false,"score":6,"last_activity_date":1467972143,"creation_date":1465214543,"answer_id":37656927,"question_id":28821715,"body_markdown":"I had a similar exception (but different problem) -  `java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to org.bson.Document` , and fortunately it&#39;s solved easier:\r\n\r\nInstead of \r\n\r\n    List&lt;Document&gt; docs = obj.get(&quot;documents&quot;);\r\n    Document doc = docs.get(0)\r\n\r\nwhich gives error on second line, One can use    \r\n\r\n    List&lt;Document&gt; docs = obj.get(&quot;documents&quot;);\r\n    Document doc = new Document(docs.get(0));","title":"java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to com.testing.models.Account","body":"<p>I had a similar exception (but different problem) -  <code>java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to org.bson.Document</code> , and fortunately it's solved easier:</p>\n\n<p>Instead of </p>\n\n<pre><code>List&lt;Document&gt; docs = obj.get(\"documents\");\nDocument doc = docs.get(0)\n</code></pre>\n\n<p>which gives error on second line, One can use    </p>\n\n<pre><code>List&lt;Document&gt; docs = obj.get(\"documents\");\nDocument doc = new Document(docs.get(0));\n</code></pre>\n"},{"tags":[],"owner":{"account_id":3042144,"reputation":830,"user_id":2578871,"display_name":"user2578871"},"down_vote_count":0,"up_vote_count":71,"is_accepted":false,"score":71,"last_activity_date":1537202427,"creation_date":1469601605,"answer_id":38605480,"question_id":28821715,"body_markdown":"Try the following:\r\n\r\n    POJO pojo = mapper.convertValue(singleObject, POJO.class);\r\n\r\nor:\r\n\r\n    List&lt;POJO&gt; pojos = mapper.convertValue(\r\n        listOfObjects,\r\n        new TypeReference&lt;List&lt;POJO&gt;&gt;() { });\r\n\r\nSee [conversion of LinkedHashMap][1] for more information.\r\n\r\n  [1]: http://stackoverflow.com/questions/15430715/casting-linkedhashmap-to-complex-object\r\n","title":"java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to com.testing.models.Account","body":"<p>Try the following:</p>\n\n<pre><code>POJO pojo = mapper.convertValue(singleObject, POJO.class);\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>List&lt;POJO&gt; pojos = mapper.convertValue(\n    listOfObjects,\n    new TypeReference&lt;List&lt;POJO&gt;&gt;() { });\n</code></pre>\n\n<p>See <a href=\"http://stackoverflow.com/questions/15430715/casting-linkedhashmap-to-complex-object\">conversion of LinkedHashMap</a> for more information.</p>\n"},{"tags":[],"owner":{"account_id":2154086,"reputation":2201,"user_id":1909708,"display_name":"Himadri Pant"},"down_vote_count":0,"up_vote_count":44,"is_accepted":false,"score":44,"last_activity_date":1505458349,"creation_date":1505458349,"answer_id":46233446,"question_id":28821715,"body_markdown":"The way I could mitigate the **JSON Array to collection of LinkedHashMap objects** problem was by using `CollectionType` rather than a  `TypeReference` .\r\nThis is what I did and **worked**:\r\n    \r\n\r\n    public &lt;T&gt; List&lt;T&gt; jsonArrayToObjectList(String json, Class&lt;T&gt; tClass) throws IOException {\r\n        ObjectMapper mapper = new ObjectMapper();\r\n        CollectionType listType = mapper.getTypeFactory().constructCollectionType(ArrayList.class, tClass);\r\n        List&lt;T&gt; ts = mapper.readValue(json, listType);\r\n        LOGGER.debug(&quot;class name: {}&quot;, ts.get(0).getClass().getName());\r\n        return ts;\r\n    }\r\n\r\n\r\n----------\r\n\r\n\r\nUsing the `TypeReference`, I was still getting an ArrayList of LinkedHashMaps, i.e. **does not work**:\r\n\r\n    public &lt;T&gt; List&lt;T&gt; jsonArrayToObjectList(String json, Class&lt;T&gt; tClass) throws IOException {\r\n        ObjectMapper mapper = new ObjectMapper();\r\n        List&lt;T&gt; ts = mapper.readValue(json, new TypeReference&lt;List&lt;T&gt;&gt;(){});\r\n        LOGGER.debug(&quot;class name: {}&quot;, ts.get(0).getClass().getName());\r\n        return ts;\r\n    }","title":"java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to com.testing.models.Account","body":"<p>The way I could mitigate the <strong>JSON Array to collection of LinkedHashMap objects</strong> problem was by using <code>CollectionType</code> rather than a  <code>TypeReference</code> .\nThis is what I did and <strong>worked</strong>:</p>\n\n<pre><code>public &lt;T&gt; List&lt;T&gt; jsonArrayToObjectList(String json, Class&lt;T&gt; tClass) throws IOException {\n    ObjectMapper mapper = new ObjectMapper();\n    CollectionType listType = mapper.getTypeFactory().constructCollectionType(ArrayList.class, tClass);\n    List&lt;T&gt; ts = mapper.readValue(json, listType);\n    LOGGER.debug(\"class name: {}\", ts.get(0).getClass().getName());\n    return ts;\n}\n</code></pre>\n\n<hr>\n\n<p>Using the <code>TypeReference</code>, I was still getting an ArrayList of LinkedHashMaps, i.e. <strong>does not work</strong>:</p>\n\n<pre><code>public &lt;T&gt; List&lt;T&gt; jsonArrayToObjectList(String json, Class&lt;T&gt; tClass) throws IOException {\n    ObjectMapper mapper = new ObjectMapper();\n    List&lt;T&gt; ts = mapper.readValue(json, new TypeReference&lt;List&lt;T&gt;&gt;(){});\n    LOGGER.debug(\"class name: {}\", ts.get(0).getClass().getName());\n    return ts;\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":14997432,"reputation":1,"user_id":10826324,"display_name":"Mohamed Farghaly"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1545590630,"creation_date":1545578226,"answer_id":53904766,"question_id":28821715,"body_markdown":"I have this method for deserializing an XML and converting the type:\r\n\r\n\tpublic &lt;T&gt; Object deserialize(String xml, Class objClass ,TypeReference&lt;T&gt; typeReference ) throws IOException {\r\n\t    XmlMapper xmlMapper = new XmlMapper();\r\n\t    Object obj = xmlMapper.readValue(xml,objClass);\r\n\t    return  xmlMapper.convertValue(obj,typeReference );   \r\n\t}\r\n\r\nand this is the call:\r\n\r\n    List&lt;POJO&gt; pojos = (List&lt;POJO&gt;) MyUtilClass.deserialize(xml, ArrayList.class,new TypeReference&lt; List&lt; POJO &gt;&gt;(){ });","title":"java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to com.testing.models.Account","body":"<p>I have this method for deserializing an XML and converting the type:</p>\n\n<pre><code>public &lt;T&gt; Object deserialize(String xml, Class objClass ,TypeReference&lt;T&gt; typeReference ) throws IOException {\n    XmlMapper xmlMapper = new XmlMapper();\n    Object obj = xmlMapper.readValue(xml,objClass);\n    return  xmlMapper.convertValue(obj,typeReference );   \n}\n</code></pre>\n\n<p>and this is the call:</p>\n\n<pre><code>List&lt;POJO&gt; pojos = (List&lt;POJO&gt;) MyUtilClass.deserialize(xml, ArrayList.class,new TypeReference&lt; List&lt; POJO &gt;&gt;(){ });\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4229586,"reputation":590,"user_id":3462243,"accept_rate":100,"display_name":"uncle bob"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1598610784,"creation_date":1598610784,"answer_id":63632081,"question_id":28821715,"body_markdown":"When you use jackson to map from string to your concrete class, especially if you work with generic type. then this issue may happen because of different class loader. i met it one time with below scenarior:\r\n\r\nProject B depend on Library A\r\n\r\nin Library A:\r\n\r\n    public class DocSearchResponse&lt;T&gt; {\r\n     private T data;\r\n    }\r\n\r\nit has service to query data from external source, and use jackson to convert to concrete class\r\n\r\n    public class ServiceA&lt;T&gt;{\r\n      @Autowired\r\n      private ObjectMapper mapper;\r\n      @Autowired\r\n      private ClientDocSearch searchClient;\r\n    \r\n      public DocSearchResponse&lt;T&gt; query(Criteria criteria){\r\n          String resultInString = searchClient.search(criteria);\r\n          return convertJson(resultInString)\r\n      }\r\n    }\r\n    \r\n    public DocSearchResponse&lt;T&gt; convertJson(String result){\r\n         return mapper.readValue(result, new TypeReference&lt;DocSearchResponse&lt;T&gt;&gt;() {});\r\n      }\r\n    }\r\n\r\nin Project B:\r\n\r\n    public class Account{\r\n     private String name;\r\n     //come with other attributes\r\n    }\r\n\r\nand i use ServiceA from library to make query and as well convert data\r\n\r\n    public class ServiceAImpl extends ServiceA&lt;Account&gt; {\r\n        \r\n    }\r\n\r\nand make use of that\r\n\r\n    public class MakingAccountService {\r\n        @Autowired\r\n        private ServiceA service;\r\n        public void execute(Criteria criteria){\r\n          \r\n            DocSearchResponse&lt;Account&gt; result = service.query(criteria);\r\n            Account acc = result.getData(); //  java.util.LinkedHashMap cannot be cast to com.testing.models.Account\r\n        }\r\n    }\r\n\r\nit happen because from classloader of LibraryA, jackson can not load Account class, then just override method `convertJson` in Project B to let jackson do its job\r\n\r\n    public class ServiceAImpl extends ServiceA&lt;Account&gt; {\r\n            @Override\r\n            public DocSearchResponse&lt;T&gt; convertJson(String result){\r\n             return mapper.readValue(result, new TypeReference&lt;DocSearchResponse&lt;T&gt;&gt;() {});\r\n          }\r\n        }\r\n     }","title":"java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to com.testing.models.Account","body":"<p>When you use jackson to map from string to your concrete class, especially if you work with generic type. then this issue may happen because of different class loader. i met it one time with below scenarior:</p>\n<p>Project B depend on Library A</p>\n<p>in Library A:</p>\n<pre><code>public class DocSearchResponse&lt;T&gt; {\n private T data;\n}\n</code></pre>\n<p>it has service to query data from external source, and use jackson to convert to concrete class</p>\n<pre><code>public class ServiceA&lt;T&gt;{\n  @Autowired\n  private ObjectMapper mapper;\n  @Autowired\n  private ClientDocSearch searchClient;\n\n  public DocSearchResponse&lt;T&gt; query(Criteria criteria){\n      String resultInString = searchClient.search(criteria);\n      return convertJson(resultInString)\n  }\n}\n\npublic DocSearchResponse&lt;T&gt; convertJson(String result){\n     return mapper.readValue(result, new TypeReference&lt;DocSearchResponse&lt;T&gt;&gt;() {});\n  }\n}\n</code></pre>\n<p>in Project B:</p>\n<pre><code>public class Account{\n private String name;\n //come with other attributes\n}\n</code></pre>\n<p>and i use ServiceA from library to make query and as well convert data</p>\n<pre><code>public class ServiceAImpl extends ServiceA&lt;Account&gt; {\n    \n}\n</code></pre>\n<p>and make use of that</p>\n<pre><code>public class MakingAccountService {\n    @Autowired\n    private ServiceA service;\n    public void execute(Criteria criteria){\n      \n        DocSearchResponse&lt;Account&gt; result = service.query(criteria);\n        Account acc = result.getData(); //  java.util.LinkedHashMap cannot be cast to com.testing.models.Account\n    }\n}\n</code></pre>\n<p>it happen because from classloader of LibraryA, jackson can not load Account class, then just override method <code>convertJson</code> in Project B to let jackson do its job</p>\n<pre><code>public class ServiceAImpl extends ServiceA&lt;Account&gt; {\n        @Override\n        public DocSearchResponse&lt;T&gt; convertJson(String result){\n         return mapper.readValue(result, new TypeReference&lt;DocSearchResponse&lt;T&gt;&gt;() {});\n      }\n    }\n }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":15343732,"reputation":11,"user_id":11069884,"display_name":"Love Java"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1604548077,"creation_date":1604548077,"answer_id":64690952,"question_id":28821715,"body_markdown":"Solve problem with two method parse common\r\n  1. Whith type is an object\r\n\r\n    public &lt;T&gt; T jsonToObject(String json, Class&lt;T&gt; type) {\r\n            T target = null;\r\n            try {\r\n                target = objectMapper.readValue(json, type);\r\n            } catch (Jsenter code hereonProcessingException e) {\r\n                e.printStackTrace();\r\n            }\r\n        \r\n            return target;\r\n        }\r\n  2. With type is collection wrap object\r\n\r\n    public &lt;T&gt; T jsonToObject(String json, TypeReference&lt;T&gt; type) {\r\n        T target = null;\r\n        try {\r\n            target = objectMapper.readValue(json, type);\r\n        } catch (JsonProcessingException e) {\r\n            e.printStackTrace();\r\n        }\r\n        return target;\r\n    }\r\n\r\n","title":"java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to com.testing.models.Account","body":"<p>Solve problem with two method parse common</p>\n<ol>\n<li>Whith type is an object</li>\n</ol>\n<pre><code>public &lt;T&gt; T jsonToObject(String json, Class&lt;T&gt; type) {\n        T target = null;\n        try {\n            target = objectMapper.readValue(json, type);\n        } catch (Jsenter code hereonProcessingException e) {\n            e.printStackTrace();\n        }\n    \n        return target;\n    }\n</code></pre>\n<ol start=\"2\">\n<li>With type is collection wrap object</li>\n</ol>\n<pre><code>public &lt;T&gt; T jsonToObject(String json, TypeReference&lt;T&gt; type) {\n    T target = null;\n    try {\n        target = objectMapper.readValue(json, type);\n    } catch (JsonProcessingException e) {\n        e.printStackTrace();\n    }\n    return target;\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":20570038,"reputation":9,"user_id":15098575,"display_name":"siddharth jain"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1620885597,"creation_date":1620885597,"answer_id":67514560,"question_id":28821715,"body_markdown":"This is something i used in my project, Json object was returned, i converted it to a List of POJO, List&lt;Pojo&gt; and then accessed the element.\r\nI took the input of Json object from another microservice.\r\n\r\nMain thing is:-\r\n**JsonNode stocks = restTemplate.getForObject(&quot;http://localhost:2000/stocks/qty&quot;, JsonNode.class);\r\n            List&lt;Stock_id_qty&gt; stockList = mapper.convertValue(stocks, new TypeReference&lt;List&lt;Stock_id_qty&gt;&gt;() {});**\r\n\r\n    \r\n    @GetMapping(&quot;/&quot;)\r\n        public List&lt;Stock_id_qty&gt; checkQty() throws JsonProcessingException {\r\n            ObjectMapper mapper = new ObjectMapper();\r\n            JsonNode stocks = restTemplate.getForObject(&quot;http://localhost:2000/stocks/qty&quot;, JsonNode.class);\r\n            List&lt;Stock_id_qty&gt; stockList = mapper.convertValue(stocks, new TypeReference&lt;List&lt;Stock_id_qty&gt;&gt;() {});\r\n            List&lt;Stock_id_qty&gt; result = new ArrayList&lt;&gt;();\r\n            for(Stock_id_qty s : stockList){\r\n                if(s.getStockQty() &lt; 10)\r\n                {\r\n                    result.add(s);\r\n                }\r\n            }\r\n            return result;\r\n        }","title":"java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to com.testing.models.Account","body":"<p>This is something i used in my project, Json object was returned, i converted it to a List of POJO, List and then accessed the element.\nI took the input of Json object from another microservice.</p>\n<p>Main thing is:-\n<strong>JsonNode stocks = restTemplate.getForObject(&quot;http://localhost:2000/stocks/qty&quot;, JsonNode.class);\nList&lt;Stock_id_qty&gt; stockList = mapper.convertValue(stocks, new TypeReference&lt;List&lt;Stock_id_qty&gt;&gt;() {});</strong></p>\n<pre><code>@GetMapping(&quot;/&quot;)\n    public List&lt;Stock_id_qty&gt; checkQty() throws JsonProcessingException {\n        ObjectMapper mapper = new ObjectMapper();\n        JsonNode stocks = restTemplate.getForObject(&quot;http://localhost:2000/stocks/qty&quot;, JsonNode.class);\n        List&lt;Stock_id_qty&gt; stockList = mapper.convertValue(stocks, new TypeReference&lt;List&lt;Stock_id_qty&gt;&gt;() {});\n        List&lt;Stock_id_qty&gt; result = new ArrayList&lt;&gt;();\n        for(Stock_id_qty s : stockList){\n            if(s.getStockQty() &lt; 10)\n            {\n                result.add(s);\n            }\n        }\n        return result;\n    }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":17737955,"reputation":1051,"user_id":12878982,"display_name":"CodingBee"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1643379894,"creation_date":1642486858,"answer_id":70751106,"question_id":28821715,"body_markdown":"&gt;     public class ObjectHelper {\r\n&gt;\r\n&gt;       private static ObjectMapper objectMapper = new ObjectMapper();\r\n&gt; \r\n&gt;       public static ObjectMapper getObjectMapper() {\r\n&gt;         objectMapper.setSerializationInclusion(JsonInclude.Include.NON_NULL).configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES,false);\r\n&gt;         return objectMapper;\r\n&gt;       } \r\n&gt;     }\r\n\r\nUse\r\n&gt;     FetchResponse fetchResponse =\r\n&gt;     ObjectHelper.getObjectMapper().convertValue(\r\n&gt;                         data, new TypeReference&lt;FetchResponse&gt;() {});\r\n\r\nOR\r\n\r\n    List&lt;Map&lt;String, Object&gt;&gt; responseObj = (List&lt;Map&lt;String, Object&gt;&gt;) response.get(&quot;content&quot;);\r\n\r\n    List&lt;LkAuthUserDetail&gt; responseData = ObjectHelper.getObjectMapper().convertValue(responseObj,\r\n                        new TypeReference&lt;List&lt;LkAuthUserDetail&gt;&gt;() {});","title":"java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to com.testing.models.Account","body":"<blockquote>\n<pre><code>public class ObjectHelper {\n\n  private static ObjectMapper objectMapper = new ObjectMapper();\n\n  public static ObjectMapper getObjectMapper() {\n    objectMapper.setSerializationInclusion(JsonInclude.Include.NON_NULL).configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES,false);\n    return objectMapper;\n  } \n}\n</code></pre>\n</blockquote>\n<p>Use</p>\n<blockquote>\n<pre><code>FetchResponse fetchResponse =\nObjectHelper.getObjectMapper().convertValue(\n                    data, new TypeReference&lt;FetchResponse&gt;() {});\n</code></pre>\n</blockquote>\n<p>OR</p>\n<pre><code>List&lt;Map&lt;String, Object&gt;&gt; responseObj = (List&lt;Map&lt;String, Object&gt;&gt;) response.get(&quot;content&quot;);\n\nList&lt;LkAuthUserDetail&gt; responseData = ObjectHelper.getObjectMapper().convertValue(responseObj,\n                    new TypeReference&lt;List&lt;LkAuthUserDetail&gt;&gt;() {});\n</code></pre>\n"},{"tags":[],"owner":{"account_id":9735171,"reputation":2264,"user_id":7218656,"accept_rate":75,"display_name":"Arun Sudhakaran"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695365160,"creation_date":1695365160,"answer_id":77155376,"question_id":28821715,"body_markdown":"We faced a similar sort of issue in our microservices communication. We had two services `approval` and `transfer`, so once a transfer is approved there will be a communication between the above services using `Kafka`, where the `transfer` will be the consumer.\r\n\r\nBoth the services are maintaining a common bean `Payload`, which has some fields as `Object` type\r\n\r\n    @Getter\r\n    @Setter\r\n    public class Payload extends KafkaParameters implements Serializable {\r\n    \r\n    \tprivate static final long serialVersionUID = 1L;\r\n    \r\n    \tprivate Object requestedBy;\r\n    \tprivate Object requestDetails;\r\n    \tprivate Object payload;\r\n    \tprivate Object existingPayload;\r\n    \tprivate Object payloadDifference;\r\n    }\r\n\r\nInitially from the `transfer` service we&#39;ll set the value to the `payload` attribute inside `Payload` bean which will be a reference of type `TransactionRequest`. So, once the consumer in the `transfer` service is getting the callback from the `approval` service we are getting the `Payload` and when we tried to downcast we got this error\r\n\r\n    @Service\r\n    @Slf4j\r\n    public class AdjustmentApprovalConsumer {\r\n    \r\n        @KafkaListener(topics = TransferConstants.ADJUSTMENT_APPROVAL_TOPIC, containerFactory = &quot;ApprovalConcurrentKafkaListenerContainerFactory&quot;)\r\n    \tpublic void listenCdr(@org.springframework.messaging.handler.annotation.Payload Payload approvalRequest) {\r\n    \r\n            TransactionRequest request = (TransactionRequest) approvalRequest.getPayload();\r\n        }\r\n    }\r\n\r\nWe fixed this issues by using two methods\r\n\r\n 1) Convert the payload to a JSON string\r\n\r\n```\r\n\tpublic static String asJsonString(final Object obj) {\r\n\t\ttry {\r\n\t\t\treturn new ObjectMapper().writeValueAsString(obj);\r\n\t\t} catch (Exception e) {\r\n\t\t\tthrow new RuntimeException(e);\r\n\t\t}\r\n\t}\r\n```\r\n\r\n2) Convert the JSON string to a given bean\r\n\r\n```\r\n\tpublic static &lt;T&gt; Object jsonToObject(final String json, Class&lt;T&gt; type) {\r\n\t\ttry {\r\n\t\t\tObjectMapper mapper = new ObjectMapper();\r\n\t\t\treturn mapper.readValue(json, type);\r\n\t\t} catch (Exception e) {\r\n\t\t\tthrow new RuntimeException(e);\r\n\t\t}\r\n\t}\r\n```\r\n\r\nSo the final code was like this\r\n\r\n    TransactionRequest request = (TransactionRequest) JsonUtils.jsonToObject(JsonUtils.asJsonString(approvalRequest.getPayload()), TransactionRequest.class);\r\n\r\nThis is may not be a conventional way of doing it but surely fixed the issue.","title":"java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to com.testing.models.Account","body":"<p>We faced a similar sort of issue in our microservices communication. We had two services <code>approval</code> and <code>transfer</code>, so once a transfer is approved there will be a communication between the above services using <code>Kafka</code>, where the <code>transfer</code> will be the consumer.</p>\n<p>Both the services are maintaining a common bean <code>Payload</code>, which has some fields as <code>Object</code> type</p>\n<pre><code>@Getter\n@Setter\npublic class Payload extends KafkaParameters implements Serializable {\n\n    private static final long serialVersionUID = 1L;\n\n    private Object requestedBy;\n    private Object requestDetails;\n    private Object payload;\n    private Object existingPayload;\n    private Object payloadDifference;\n}\n</code></pre>\n<p>Initially from the <code>transfer</code> service we'll set the value to the <code>payload</code> attribute inside <code>Payload</code> bean which will be a reference of type <code>TransactionRequest</code>. So, once the consumer in the <code>transfer</code> service is getting the callback from the <code>approval</code> service we are getting the <code>Payload</code> and when we tried to downcast we got this error</p>\n<pre><code>@Service\n@Slf4j\npublic class AdjustmentApprovalConsumer {\n\n    @KafkaListener(topics = TransferConstants.ADJUSTMENT_APPROVAL_TOPIC, containerFactory = &quot;ApprovalConcurrentKafkaListenerContainerFactory&quot;)\n    public void listenCdr(@org.springframework.messaging.handler.annotation.Payload Payload approvalRequest) {\n\n        TransactionRequest request = (TransactionRequest) approvalRequest.getPayload();\n    }\n}\n</code></pre>\n<p>We fixed this issues by using two methods</p>\n<ol>\n<li>Convert the payload to a JSON string</li>\n</ol>\n<pre><code>    public static String asJsonString(final Object obj) {\n        try {\n            return new ObjectMapper().writeValueAsString(obj);\n        } catch (Exception e) {\n            throw new RuntimeException(e);\n        }\n    }\n</code></pre>\n<ol start=\"2\">\n<li>Convert the JSON string to a given bean</li>\n</ol>\n<pre><code>    public static &lt;T&gt; Object jsonToObject(final String json, Class&lt;T&gt; type) {\n        try {\n            ObjectMapper mapper = new ObjectMapper();\n            return mapper.readValue(json, type);\n        } catch (Exception e) {\n            throw new RuntimeException(e);\n        }\n    }\n</code></pre>\n<p>So the final code was like this</p>\n<pre><code>TransactionRequest request = (TransactionRequest) JsonUtils.jsonToObject(JsonUtils.asJsonString(approvalRequest.getPayload()), TransactionRequest.class);\n</code></pre>\n<p>This is may not be a conventional way of doing it but surely fixed the issue.</p>\n"}],"owner":{"account_id":447462,"reputation":10144,"user_id":841090,"accept_rate":61,"display_name":"Passionate Engineer"},"comment_count":9,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":307703,"favorite_count":0,"down_vote_count":1,"up_vote_count":121,"accepted_answer_id":28821825,"answer_count":10,"score":120,"last_activity_date":1695365160,"creation_date":1425340931,"question_id":28821715,"body_markdown":"I&#39;m getting below error:\r\n\r\n    java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to com.testing.models.Account\r\n\r\nwith below code\r\n\r\n    final int expectedId = 1;\r\n\r\n    Test newTest = create();\r\n\r\n    int expectedResponseCode = Response.SC_OK;\r\n\r\n    ArrayList&lt;Account&gt; account = given().when().expect().statusCode(expectedResponseCode)\r\n        .get(&quot;accounts/&quot; + newTest.id() + &quot;/users&quot;)\r\n        .as(ArrayList.class);\r\n    assertThat(account.get(0).getId()).isEqualTo(expectedId);\r\n\r\nIs there a reason why I cannot do `get(0)`?\r\n","title":"java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to com.testing.models.Account","body":"<p>I'm getting below error:</p>\n\n<pre><code>java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to com.testing.models.Account\n</code></pre>\n\n<p>with below code</p>\n\n<pre><code>final int expectedId = 1;\n\nTest newTest = create();\n\nint expectedResponseCode = Response.SC_OK;\n\nArrayList&lt;Account&gt; account = given().when().expect().statusCode(expectedResponseCode)\n    .get(\"accounts/\" + newTest.id() + \"/users\")\n    .as(ArrayList.class);\nassertThat(account.get(0).getId()).isEqualTo(expectedId);\n</code></pre>\n\n<p>Is there a reason why I cannot do <code>get(0)</code>?</p>\n"},{"tags":["java","csv","jsf","primefaces"],"answers":[{"tags":[],"owner":{"account_id":235505,"reputation":10708,"user_id":502366,"display_name":"Melloware"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1596195487,"creation_date":1596195487,"answer_id":63191165,"question_id":63182170,"body_markdown":"You can in PF 7.0 or higher using the `options` attribute!\r\n\r\nFixed: https://github.com/primefaces/primefaces/issues/48\r\n\r\n```xml\r\n&lt;p:dataExporter type=&quot;csv&quot; target=&quot;tbl&quot; fileName=&quot;cars&quot; options=&quot;#{view.csvOptions}&quot; /&gt;\r\n```\r\n\r\nAnd your Options class looks like this to set to colon (:) for example...\r\n```java\r\npublic CSVOptions getCsvOptions() {\r\n    CSVOptions options = new CSVOptions();\r\n    options.setDelimiterChar(&quot;:&quot;);\r\n    return options;\r\n}\r\n```","title":"Exporting a csv using component fileDownload of primefaces generates problems with comma separator when data have commas","body":"<p>You can in PF 7.0 or higher using the <code>options</code> attribute!</p>\n<p>Fixed: <a href=\"https://github.com/primefaces/primefaces/issues/48\" rel=\"nofollow noreferrer\">https://github.com/primefaces/primefaces/issues/48</a></p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;p:dataExporter type=&quot;csv&quot; target=&quot;tbl&quot; fileName=&quot;cars&quot; options=&quot;#{view.csvOptions}&quot; /&gt;\n</code></pre>\n<p>And your Options class looks like this to set to colon (:) for example...</p>\n<pre class=\"lang-java prettyprint-override\"><code>public CSVOptions getCsvOptions() {\n    CSVOptions options = new CSVOptions();\n    options.setDelimiterChar(&quot;:&quot;);\n    return options;\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":7131394,"reputation":1,"user_id":5452476,"display_name":"jkl"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695364589,"creation_date":1695364589,"answer_id":77155332,"question_id":63182170,"body_markdown":"in Primefaces 11 you can&#39;t set the delimiter anymore. \r\nBut maybe \r\n\r\n    public CSVOptions getCsvOptions() {\r\n        // delimiter = ;\r\n        return CSVOptions.EXCEL_NORTHERN_EUROPE;\r\n    }\r\n\r\ndoes what you need. ","title":"Exporting a csv using component fileDownload of primefaces generates problems with comma separator when data have commas","body":"<p>in Primefaces 11 you can't set the delimiter anymore.\nBut maybe</p>\n<pre><code>public CSVOptions getCsvOptions() {\n    // delimiter = ;\n    return CSVOptions.EXCEL_NORTHERN_EUROPE;\n}\n</code></pre>\n<p>does what you need.</p>\n"}],"owner":{"account_id":13826190,"reputation":493,"user_id":9980464,"display_name":"rolo"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":819,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":2,"score":1,"last_activity_date":1695364589,"creation_date":1596147420,"question_id":63182170,"body_markdown":"I have the following problem. I am working with Primefaces, JSF and Java. I am trying to generate a csv file with data of the data base and exporting it with the component p:fileDownload of primefaces. The csv is generated without problems but some of the data are strings with commas init, so the result is that there are separated in different columns. Is there a way of setting another separator? (for example ;) .\r\n\r\nThe method that generates the byte array is this:\r\n\r\n    public byte[] generateCsv(){\r\n                    StringBuilder data = new StringBuilder();\r\n                    data.append(&quot;header1, header2, header3\\n&quot;);\r\n                    for (element elem : listElements) {\r\n                        data.append(elem.getCode()+&quot;,&quot;+elem.getName()+&quot;,&quot;+elem.getData+&quot;\\n&quot;);\r\n                    }\r\n                    byte[] bytes = String.valueOf(data).getBytes();\r\n                    return bytes;\r\n    }\r\n\r\nIn the frontend, the bean has this method:\r\n\r\n    public StreamedContent exportCsv() {\r\n            try {\r\n                \r\n                byte[] cert = businessBean.generateCsv();\r\n                if (cert != null) {\r\n                    InputStream targetStream = new ByteArrayInputStream(cert);\r\n                    StreamedContent file = new DefaultStreamedContent(targetStream, &quot;application/csv&quot;, &quot;Example.csv&quot;);\r\n                    \r\n                    return file;\r\n                } else {\r\n                   //ERROR\r\n                }\r\n    \r\n            } catch (Exception ex) {\r\n                \r\n            }\r\n            return null;\r\n        }\r\n\r\nAnd the button that generates the csv in the xhtml is this one:\r\n\r\n    &lt;p:fileDownload contentDisposition=&quot;inline&quot;   value=&quot;#{exampleBean.exportCsv()}&quot; /&gt;\r\n\r\nResult:\r\nIf the elements of each column are supposed to be:\r\n\r\n    column1= elem1\r\n    column2= elem2.1,elem2.2\r\n    column3=elem3.1,elem3.2\r\nIn the file every element appears like.\r\n\r\n    column1= elem1\r\n    column2= elem2.1\r\n    column3=elem2.2\r\n    column4=elem3.1\r\n    column5=elem3.2\r\n\r\nThere is a way to set a different separator?\r\nThanks","title":"Exporting a csv using component fileDownload of primefaces generates problems with comma separator when data have commas","body":"<p>I have the following problem. I am working with Primefaces, JSF and Java. I am trying to generate a csv file with data of the data base and exporting it with the component p:fileDownload of primefaces. The csv is generated without problems but some of the data are strings with commas init, so the result is that there are separated in different columns. Is there a way of setting another separator? (for example ;) .</p>\n<p>The method that generates the byte array is this:</p>\n<pre><code>public byte[] generateCsv(){\n                StringBuilder data = new StringBuilder();\n                data.append(&quot;header1, header2, header3\\n&quot;);\n                for (element elem : listElements) {\n                    data.append(elem.getCode()+&quot;,&quot;+elem.getName()+&quot;,&quot;+elem.getData+&quot;\\n&quot;);\n                }\n                byte[] bytes = String.valueOf(data).getBytes();\n                return bytes;\n}\n</code></pre>\n<p>In the frontend, the bean has this method:</p>\n<pre><code>public StreamedContent exportCsv() {\n        try {\n            \n            byte[] cert = businessBean.generateCsv();\n            if (cert != null) {\n                InputStream targetStream = new ByteArrayInputStream(cert);\n                StreamedContent file = new DefaultStreamedContent(targetStream, &quot;application/csv&quot;, &quot;Example.csv&quot;);\n                \n                return file;\n            } else {\n               //ERROR\n            }\n\n        } catch (Exception ex) {\n            \n        }\n        return null;\n    }\n</code></pre>\n<p>And the button that generates the csv in the xhtml is this one:</p>\n<pre><code>&lt;p:fileDownload contentDisposition=&quot;inline&quot;   value=&quot;#{exampleBean.exportCsv()}&quot; /&gt;\n</code></pre>\n<p>Result:\nIf the elements of each column are supposed to be:</p>\n<pre><code>column1= elem1\ncolumn2= elem2.1,elem2.2\ncolumn3=elem3.1,elem3.2\n</code></pre>\n<p>In the file every element appears like.</p>\n<pre><code>column1= elem1\ncolumn2= elem2.1\ncolumn3=elem2.2\ncolumn4=elem3.1\ncolumn5=elem3.2\n</code></pre>\n<p>There is a way to set a different separator?\nThanks</p>\n"},{"tags":["java","matrix","complex-numbers","polynomial-math","root-finding"],"answers":[{"tags":[],"owner":{"account_id":2237265,"reputation":26976,"user_id":1973271,"accept_rate":100,"display_name":"flup"},"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1363202261,"creation_date":1363180088,"answer_id":15386243,"question_id":15385867,"body_markdown":"The [Durand-Kerner method][1] also works for complex coefficients and does not rely on matrix computations.\r\n\r\nIt&#39;s quite simple to implement, you could google up an implementation (Stackoverflow forbids me to link the one I found) or make one of your own. You could use the [jscience][2] library for the complex data types, not for the algorithm itself.\r\n\r\nEDIT: Didn&#39;t see that you need evd too, never mind my mention of jscience as an option to do the complex matrix math.\r\n\r\n\r\n  [1]: http://en.wikipedia.org/wiki/Durand%E2%80%93Kerner_method\r\n  [2]: http://jscience.org/\r\n  [3]: http://jscience.org/api/org/jscience/mathematics/vector/Matrix.html","title":"Complex-coefficient polynomial root finding in Java","body":"<p>The <a href=\"http://en.wikipedia.org/wiki/Durand%E2%80%93Kerner_method\" rel=\"nofollow\">Durand-Kerner method</a> also works for complex coefficients and does not rely on matrix computations.</p>\n\n<p>It's quite simple to implement, you could google up an implementation (Stackoverflow forbids me to link the one I found) or make one of your own. You could use the <a href=\"http://jscience.org/\" rel=\"nofollow\">jscience</a> library for the complex data types, not for the algorithm itself.</p>\n\n<p>EDIT: Didn't see that you need evd too, never mind my mention of jscience as an option to do the complex matrix math.</p>\n"},{"tags":[],"owner":{"account_id":3710720,"reputation":25404,"user_id":3088138,"display_name":"Lutz Lehmann"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1386967186,"creation_date":1386967186,"answer_id":20575604,"question_id":15385867,"body_markdown":"If one wants to keep it real, use the `Bairstow method`. If the polynomial has odd degree, use first `Newton&#39;s method` to find a real root and reduce the polynomial to even degree. This avoids an odd singularity of the Bairstow method where it converges towards a quadratic polynomial that has infinity as one root. Information of good quality can be found at the usual places. Some of it written or edited by yours truly.\r\n\r\nDetermine an inner root radius r and use z^2-2r*cos(phi)*z+r^2 with random angle phi as initial factor for Bairstow&#39;s method. It produces in each step a quadratic factor, always in and with real coefficients, containing either a pair of real roots or a conjugate pair of complex roots. \r\n\r\nCheck in each step for speed of convergence and restart with a different initial point if necessary. Find new roots after deflation, and polish the roots or quadratic factors by executing the method with the original polynomial and the factors as starting point.","title":"Complex-coefficient polynomial root finding in Java","body":"<p>If one wants to keep it real, use the <code>Bairstow method</code>. If the polynomial has odd degree, use first <code>Newton's method</code> to find a real root and reduce the polynomial to even degree. This avoids an odd singularity of the Bairstow method where it converges towards a quadratic polynomial that has infinity as one root. Information of good quality can be found at the usual places. Some of it written or edited by yours truly.</p>\n\n<p>Determine an inner root radius r and use z^2-2r*cos(phi)*z+r^2 with random angle phi as initial factor for Bairstow's method. It produces in each step a quadratic factor, always in and with real coefficients, containing either a pair of real roots or a conjugate pair of complex roots. </p>\n\n<p>Check in each step for speed of convergence and restart with a different initial point if necessary. Find new roots after deflation, and polish the roots or quadratic factors by executing the method with the original polynomial and the factors as starting point.</p>\n"}],"owner":{"account_id":1061185,"reputation":289,"user_id":1062778,"accept_rate":83,"display_name":"Virginie"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1347,"favorite_count":0,"down_vote_count":0,"up_vote_count":15,"accepted_answer_id":15386243,"answer_count":2,"score":15,"last_activity_date":1695364052,"creation_date":1363179075,"question_id":15385867,"body_markdown":"I&#39;m trying to find a way to compute roots of a polynomial with complex coefficients in Java (i.e. an  equivalent of what is ridiculously easily done with roots() in MATLAB).\r\n\r\nI&#39;m ready to recode a root finding algorithm that builds the companion matrix and then uses generalized eigenvalue decomposition to find the roots, but for this I would need a library that handles complex-valued matrix operations.\r\n\r\nI browsed for a while and nothing convincing seems to be available out there, which I think is rather weird. Then, I&#39;d like to ask you:\r\n\r\n1. Do you know a (stable) Java library that performs root finding on polynomials defined by COMPLEX coefficients?\r\n\r\n2. Do you know a (stable) Java library that performs evd, svd, inverse, etc. on COMPLEX-valued matrices?\r\n\r\n\r\n\r\n*Note:* I already looked at JAMA (doesn&#39;t handle complex), Michael Thomas Flanagan&#39;s Java Scientific Library (not available anymore), colt (doesn&#39;t seem to handle complex), Efficient Java Matrix Library (no complex either), DDogleg Numerics (does not handle polynomial with complex coefficients), JScience (not clear if evd is available) and common-math from Apache (not clear if they allow for complex matrices, and if yes, if evd is available).\r\n\r\n\r\n","title":"Complex-coefficient polynomial root finding in Java","body":"<p>I'm trying to find a way to compute roots of a polynomial with complex coefficients in Java (i.e. an  equivalent of what is ridiculously easily done with roots() in MATLAB).</p>\n\n<p>I'm ready to recode a root finding algorithm that builds the companion matrix and then uses generalized eigenvalue decomposition to find the roots, but for this I would need a library that handles complex-valued matrix operations.</p>\n\n<p>I browsed for a while and nothing convincing seems to be available out there, which I think is rather weird. Then, I'd like to ask you:</p>\n\n<ol>\n<li><p>Do you know a (stable) Java library that performs root finding on polynomials defined by COMPLEX coefficients?</p></li>\n<li><p>Do you know a (stable) Java library that performs evd, svd, inverse, etc. on COMPLEX-valued matrices?</p></li>\n</ol>\n\n<p><em>Note:</em> I already looked at JAMA (doesn't handle complex), Michael Thomas Flanagan's Java Scientific Library (not available anymore), colt (doesn't seem to handle complex), Efficient Java Matrix Library (no complex either), DDogleg Numerics (does not handle polynomial with complex coefficients), JScience (not clear if evd is available) and common-math from Apache (not clear if they allow for complex matrices, and if yes, if evd is available).</p>\n"},{"tags":["java","excel","apache-poi","xls"],"comments":[{"owner":{"account_id":4853829,"reputation":57305,"user_id":3915431,"display_name":"Axel Richter"},"score":0,"creation_date":1695358723,"post_id":77148517,"comment_id":136016392,"body_markdown":"The issue is not reproducible from this vague problem description. To be able to reproduce, one would need the `*.xls` file and the code used and the information what Apache POI version used.","body":"The issue is not reproducible from this vague problem description. To be able to reproduce, one would need the <code>*.xls</code> file and the code used and the information what Apache POI version used."},{"owner":{"account_id":26397399,"reputation":1,"user_id":20048342,"display_name":"Vyron"},"score":0,"creation_date":1695364013,"post_id":77148517,"comment_id":136016943,"body_markdown":"Hi Axel, sorry if the problem description is too vague, I have updated with part of code I use to write in the excel, the sheet contains the data validation list is supposedly to not be changed which is index 0, the code only writes to sheet index 1 and the `*.xls` file is protected with password. Is it easier if i were able to provide the `*.xls` file?","body":"Hi Axel, sorry if the problem description is too vague, I have updated with part of code I use to write in the excel, the sheet contains the data validation list is supposedly to not be changed which is index 0, the code only writes to sheet index 1 and the <code>*.xls</code> file is protected with password. Is it easier if i were able to provide the <code>*.xls</code> file?"},{"owner":{"account_id":4853829,"reputation":57305,"user_id":3915431,"display_name":"Axel Richter"},"score":0,"creation_date":1695368656,"post_id":77148517,"comment_id":136017761,"body_markdown":"The code alone will not help. Unless cell `C11`, which gets changed is part of something special and not simply a data cell. See my first comment. There I told what would be needed.","body":"The code alone will not help. Unless cell <code>C11</code>, which gets changed is part of something special and not simply a data cell. See my first comment. There I told what would be needed."},{"owner":{"account_id":26397399,"reputation":1,"user_id":20048342,"display_name":"Vyron"},"score":0,"creation_date":1695369645,"post_id":77148517,"comment_id":136017926,"body_markdown":"The Apache POI version used is 3.15 beta 1, for the test excel file, where do I pass it? Sorry for this kind of question because I rarely ask any questions on this site.","body":"The Apache POI version used is 3.15 beta 1, for the test excel file, where do I pass it? Sorry for this kind of question because I rarely ask any questions on this site."},{"owner":{"account_id":4853829,"reputation":57305,"user_id":3915431,"display_name":"Axel Richter"},"score":0,"creation_date":1695370482,"post_id":77148517,"comment_id":136018071,"body_markdown":"This site does not provide file storage. You need upload it to some public available file storage. But be aware uploading files containing secret data. Correct way is to create a file containing only test data but nevertheless produces the issue. That&#39;s your task. Else hire a specialist and put confidentiality obligation in the contract.","body":"This site does not provide file storage. You need upload it to some public available file storage. But be aware uploading files containing secret data. Correct way is to create a file containing only test data but nevertheless produces the issue. That&#39;s your task. Else hire a specialist and put confidentiality obligation in the contract."}],"owner":{"account_id":26397399,"reputation":1,"user_id":20048342,"display_name":"Vyron"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":88,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1695363534,"creation_date":1695285428,"question_id":77148517,"body_markdown":"I need to write data to existing excel workbook (.xls) but when the workbook is created, it become corrupted with error `We found a problem with some content in...`. When yes is clicked, the excel workbook lost some of the formula and the cell style.\r\n\r\nThe excel file is protected and cannot change anything in the sheet that contains the data validation list.\r\n\r\nThere are two cells with data validation list. The first one has list of 54 items and the second one has list of 229 items and the format is custom date. The validation data list is pre-existing and protected, so cannot change anything in the sheet.\r\n\r\nIs there any workaround can be done? I cannot change any other thing to the excel except for write the data to the unprotected cell using the java code.\r\n\r\nThis is test code that I use:\r\n```\r\nFileInputStream fileInput = new FileInputStream(&quot;D:/Test/Test.xls&quot;);\r\nWorkbook wb = null;\r\nwb = new HSSFWorkbook(fileInput);\r\n\r\nfileInput.close();\r\n\r\nSheet sheet = null;\r\nCell cell = null;\r\n\r\nsheet = wb.getSheetAt(1);\r\n\r\ncell = sheet.getRow(10).getCell(2);\r\n\r\ncell.setCellValue(&quot;10.00&quot;);\r\n\r\nFileOutputStream fileOut = new FileOutputStream(&quot;D:/Out/Test_Updated.xls&quot;);\r\nworkbook.write(fileOut);\r\nfileOut.close();\r\n```","title":"Excel file become corrupted and remove existing data validation when workbook created from original file with Apache POI","body":"<p>I need to write data to existing excel workbook (.xls) but when the workbook is created, it become corrupted with error <code>We found a problem with some content in...</code>. When yes is clicked, the excel workbook lost some of the formula and the cell style.</p>\n<p>The excel file is protected and cannot change anything in the sheet that contains the data validation list.</p>\n<p>There are two cells with data validation list. The first one has list of 54 items and the second one has list of 229 items and the format is custom date. The validation data list is pre-existing and protected, so cannot change anything in the sheet.</p>\n<p>Is there any workaround can be done? I cannot change any other thing to the excel except for write the data to the unprotected cell using the java code.</p>\n<p>This is test code that I use:</p>\n<pre><code>FileInputStream fileInput = new FileInputStream(&quot;D:/Test/Test.xls&quot;);\nWorkbook wb = null;\nwb = new HSSFWorkbook(fileInput);\n\nfileInput.close();\n\nSheet sheet = null;\nCell cell = null;\n\nsheet = wb.getSheetAt(1);\n\ncell = sheet.getRow(10).getCell(2);\n\ncell.setCellValue(&quot;10.00&quot;);\n\nFileOutputStream fileOut = new FileOutputStream(&quot;D:/Out/Test_Updated.xls&quot;);\nworkbook.write(fileOut);\nfileOut.close();\n</code></pre>\n"},{"tags":["java","jackson"],"comments":[{"owner":{"account_id":322981,"reputation":310745,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"score":0,"creation_date":1695351476,"post_id":77154405,"comment_id":136015881,"body_markdown":"The *java.time* classes use the ISO 8601 standard formats when parsing/generating text. That means using a `T` in the middle rather than the SPACE seen in your text: `2023-09-22T02:11:13.855618`.  I guess you either need to correct your inputs to comply with ISO 8601 or you need to configure Jackson with a formatter to parse your particular inputs.  https://en.wikipedia.org/wiki/ISO_8601","body":"The <i>java.time</i> classes use the ISO 8601 standard formats when parsing/generating text. That means using a <code>T</code> in the middle rather than the SPACE seen in your text: <code>2023-09-22T02:11:13.855618</code>.  I guess you either need to correct your inputs to comply with ISO 8601 or you need to configure Jackson with a formatter to parse your particular inputs.  <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/ISO_8601</a>"}],"answers":[{"tags":[],"owner":{"account_id":17683470,"reputation":158,"user_id":12836822,"display_name":"Ashrik Ahamed"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695358266,"creation_date":1695358266,"answer_id":77154942,"question_id":77154405,"body_markdown":"Am no sure how you interact from front end, passing json data from the front end or when you call the end point just put this to the @PathVariable or @RequestParam like this in controller class: \r\n\r\n    @RequestMapping(method = RequestMethod.GET, path = &quot;/v{version}&quot;, produces = &quot;application/json&quot;)\r\n\tResponseEntity&lt;List&lt;Test&gt;&gt; findByDate(@RequestParam(required = false) @DateTimeFormat(iso = DateTimeFormat.ISO.DATE_TIME) LocalDateTime date)}\r\n\r\nUse this standard ISO method.\r\n\r\n\r\n","title":"com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Cannot construct instance of `java.time.LocalDateTime`","body":"<p>Am no sure how you interact from front end, passing json data from the front end or when you call the end point just put this to the @PathVariable or @RequestParam like this in controller class:</p>\n<pre><code>@RequestMapping(method = RequestMethod.GET, path = &quot;/v{version}&quot;, produces = &quot;application/json&quot;)\nResponseEntity&lt;List&lt;Test&gt;&gt; findByDate(@RequestParam(required = false) @DateTimeFormat(iso = DateTimeFormat.ISO.DATE_TIME) LocalDateTime date)}\n</code></pre>\n<p>Use this standard ISO method.</p>\n"},{"tags":[],"owner":{"account_id":20679683,"reputation":31,"user_id":15183550,"display_name":"Satya Raj Awasthi"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695363351,"creation_date":1695363351,"answer_id":77155237,"question_id":77154405,"body_markdown":"you are getting that error since Json is trying to deserialize the date sting into instance of `LocalDateTime ` but it not being able to do that due no constructor or such method on that class.\r\n\r\nYou can get to solution by creating a custom deserializer class by extending `JsonDeserializer` and override the deserializer method and return to required by Parsing.\r\n\r\n    import java.io.IOException;\r\n    import java.time.LocalDateTime;\r\n    import java.time.format.DateTimeFormatter;\r\n    import com.fasterxml.jackson.core.JsonParser;\r\n    import com.fasterxml.jackson.databind.DeserializationContext;\r\n    import com.fasterxml.jackson.databind.JsonDeserializer;\r\n    \r\n    public class CustomLocalDateTimeDeserializer extends JsonDeserializer&lt;LocalDateTime&gt; {\r\n        private static final DateTimeFormatter formatter = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss.SSSSSS&quot;);\r\n    \r\n        @Override\r\n        public LocalDateTime deserialize(JsonParser jsonParser, DeserializationContext deserializationContext) throws IOException {\r\n            String dateStr = jsonParser.getValueAsString();\r\n            return LocalDateTime.parse(dateStr, formatter);\r\n        }\r\n    }\r\n\r\nThen annotate the field with custom deserializer instead.\r\n\r\n    @JsonDeserialize(using = CustomLocalDateTimeDeserializer.class)\r\n    @JsonSerialize(using = LocalDateTimeSerializer.class)\r\n    public LocalDateTime date;\r\n\r\nI am sure that you have this dependency.\r\n\r\n\r\n    implementation(&quot;com.fasterxml.jackson.datatype:jackson-datatype-jsr310&quot;)\r\n\r\nHope this works for you. I did have get some shortcut just before 3-4 months. Sorry I forgot that.\r\n","title":"com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Cannot construct instance of `java.time.LocalDateTime`","body":"<p>you are getting that error since Json is trying to deserialize the date sting into instance of <code>LocalDateTime </code> but it not being able to do that due no constructor or such method on that class.</p>\n<p>You can get to solution by creating a custom deserializer class by extending <code>JsonDeserializer</code> and override the deserializer method and return to required by Parsing.</p>\n<pre><code>import java.io.IOException;\nimport java.time.LocalDateTime;\nimport java.time.format.DateTimeFormatter;\nimport com.fasterxml.jackson.core.JsonParser;\nimport com.fasterxml.jackson.databind.DeserializationContext;\nimport com.fasterxml.jackson.databind.JsonDeserializer;\n\npublic class CustomLocalDateTimeDeserializer extends JsonDeserializer&lt;LocalDateTime&gt; {\n    private static final DateTimeFormatter formatter = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss.SSSSSS&quot;);\n\n    @Override\n    public LocalDateTime deserialize(JsonParser jsonParser, DeserializationContext deserializationContext) throws IOException {\n        String dateStr = jsonParser.getValueAsString();\n        return LocalDateTime.parse(dateStr, formatter);\n    }\n}\n</code></pre>\n<p>Then annotate the field with custom deserializer instead.</p>\n<pre><code>@JsonDeserialize(using = CustomLocalDateTimeDeserializer.class)\n@JsonSerialize(using = LocalDateTimeSerializer.class)\npublic LocalDateTime date;\n</code></pre>\n<p>I am sure that you have this dependency.</p>\n<pre><code>implementation(&quot;com.fasterxml.jackson.datatype:jackson-datatype-jsr310&quot;)\n</code></pre>\n<p>Hope this works for you. I did have get some shortcut just before 3-4 months. Sorry I forgot that.</p>\n"}],"owner":{"account_id":1759709,"reputation":1,"user_id":1607148,"display_name":"Paulo Roberto"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":112,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1695363351,"creation_date":1695345547,"question_id":77154405,"body_markdown":"In Json return the field date time:\r\n```none\r\n&quot;date&quot;: &quot;2023-09-22 01:07:50.062477&quot;\r\n```\r\nIn class Json:\r\n```java\r\n@JsonDeserialize(using = LocalDateTimeDeserializer.class)\r\n@JsonSerialize(using = LocalDateTimeSerializer.class)\r\npublic LocalDateTime date;\r\n```\r\nReturn error:\r\n\r\n&gt;Caused by: com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Cannot construct instance of `java.time.LocalDateTime` (no Creators, like default construct, exist): no String-argument constructor/factory method to deserialize from String value (&#39;2023-09-22 02:11:13.855618&#39;)\r\n\r\nHow to solve?\r\n```java\r\n@JsonDeserialize(using = LocalDateTimeDeserializer.class)\r\n@JsonSerialize(using = LocalDateTimeSerializer.class)\r\npublic LocalDateTime date;\r\n```\r\n","title":"com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Cannot construct instance of `java.time.LocalDateTime`","body":"<p>In Json return the field date time:</p>\n<pre class=\"lang-none prettyprint-override\"><code>&quot;date&quot;: &quot;2023-09-22 01:07:50.062477&quot;\n</code></pre>\n<p>In class Json:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@JsonDeserialize(using = LocalDateTimeDeserializer.class)\n@JsonSerialize(using = LocalDateTimeSerializer.class)\npublic LocalDateTime date;\n</code></pre>\n<p>Return error:</p>\n<blockquote>\n<p>Caused by: com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Cannot construct instance of <code>java.time.LocalDateTime</code> (no Creators, like default construct, exist): no String-argument constructor/factory method to deserialize from String value ('2023-09-22 02:11:13.855618')</p>\n</blockquote>\n<p>How to solve?</p>\n<pre class=\"lang-java prettyprint-override\"><code>@JsonDeserialize(using = LocalDateTimeDeserializer.class)\n@JsonSerialize(using = LocalDateTimeSerializer.class)\npublic LocalDateTime date;\n</code></pre>\n"},{"tags":["java","multithreading","glassfish","jax-ws","executorservice"],"comments":[{"owner":{"account_id":281678,"reputation":5500,"user_id":578116,"accept_rate":68,"display_name":"smk"},"score":1,"creation_date":1360329847,"post_id":14773517,"comment_id":20681504,"body_markdown":"Im surprised the executor is making it sequential. Cannot help without any code snippets. Also take a look at Akka actors.","body":"Im surprised the executor is making it sequential. Cannot help without any code snippets. Also take a look at Akka actors."},{"owner":{"account_id":265649,"reputation":53086,"user_id":552759,"display_name":"jtahlborn"},"score":0,"creation_date":1360330122,"post_id":14773517,"comment_id":20681639,"body_markdown":"it&#39;s possible the webservice client library you are using is making the calls synchronized.  again, impossible to tell much w/out more details and code.","body":"it&#39;s possible the webservice client library you are using is making the calls synchronized.  again, impossible to tell much w/out more details and code."},{"owner":{"account_id":104539,"reputation":399,"user_id":279436,"accept_rate":73,"display_name":"AD."},"score":0,"creation_date":1360332647,"post_id":14773517,"comment_id":20682900,"body_markdown":"i have edited my question including the code inside my web method","body":"i have edited my question including the code inside my web method"},{"owner":{"account_id":258668,"reputation":3728,"user_id":540981,"accept_rate":82,"display_name":"Danish"},"score":2,"creation_date":1360332678,"post_id":14773517,"comment_id":20682920,"body_markdown":"What is the value of `size` in `ExecutorService executor = Executors.newFixedThreadPool(size);`","body":"What is the value of <code>size</code> in <code>ExecutorService executor = Executors.newFixedThreadPool(size);</code>"},{"owner":{"account_id":2130230,"reputation":15498,"user_id":1891219,"display_name":"gaborsch"},"score":1,"creation_date":1360332999,"post_id":14773517,"comment_id":20683094,"body_markdown":"IMHO there can be 2 reasons: 1) because of the load there are so many threads waiting that they will &quot;seem to be serialized&quot;, 2) there is a common resource, e.g. in `data` where the 2 threads synchronize to each other.","body":"IMHO there can be 2 reasons: 1) because of the load there are so many threads waiting that they will &quot;seem to be serialized&quot;, 2) there is a common resource, e.g. in <code>data</code> where the 2 threads synchronize to each other."},{"owner":{"account_id":2130230,"reputation":15498,"user_id":1891219,"display_name":"gaborsch"},"score":0,"creation_date":1360333423,"post_id":14773517,"comment_id":20683334,"body_markdown":"If there are 2 jobs only, maybe you could do one of the jobs *in your current thread*, and start a parallel job for the other job. This way you save the costs of keeping of half of the threads.","body":"If there are 2 jobs only, maybe you could do one of the jobs <i>in your current thread</i>, and start a parallel job for the other job. This way you save the costs of keeping of half of the threads."}],"answers":[{"tags":[],"owner":{"account_id":2130230,"reputation":15498,"user_id":1891219,"display_name":"gaborsch"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1360338843,"creation_date":1360338843,"answer_id":14776394,"question_id":14773517,"body_markdown":"As I noted in the prevoius comments, there can be 2 major reasons why it is &quot;serialized&quot;:\r\n\r\n 1. There is a huge load, it may be that too many request arrive parallelly, so your `MyThread`s are not put into the waiting queue at the same time. If the number of executing threads is small enough, you may *see* that the jobs are executes one after the other.\r\n 2. There may be a `synchronized` resource somewhere is your `data`. Both threads have access to them. \r\n\r\nBut I don&#39;t really understand why you have to run *both jobs* in a separate Thread. You could do like this:\r\n\r\n    ExecutorService executor = Executors.newFixedThreadPool(size);\r\n    Future&lt;Boolean&gt; futureOne = executor.submit(new MyThread(serviceOne, data));\r\n    Runnable jobTwo = new  MyThread(serviceTwo, data);\r\n    jobTwo.run();\r\n    bSuccessfulOne = futureOne.get();\r\n\r\nThis way you need half as much `Thread`s in your `ThreadPool`, this will surely give you better performance. \r\n\r\nIf you stick to the original version, I recommend you to *measure* (I mean prove your assumption, e.g. by log).\r\n\r\n","title":"Executing multiple threads in java web service","body":"<p>As I noted in the prevoius comments, there can be 2 major reasons why it is \"serialized\":</p>\n\n<ol>\n<li>There is a huge load, it may be that too many request arrive parallelly, so your <code>MyThread</code>s are not put into the waiting queue at the same time. If the number of executing threads is small enough, you may <em>see</em> that the jobs are executes one after the other.</li>\n<li>There may be a <code>synchronized</code> resource somewhere is your <code>data</code>. Both threads have access to them. </li>\n</ol>\n\n<p>But I don't really understand why you have to run <em>both jobs</em> in a separate Thread. You could do like this:</p>\n\n<pre><code>ExecutorService executor = Executors.newFixedThreadPool(size);\nFuture&lt;Boolean&gt; futureOne = executor.submit(new MyThread(serviceOne, data));\nRunnable jobTwo = new  MyThread(serviceTwo, data);\njobTwo.run();\nbSuccessfulOne = futureOne.get();\n</code></pre>\n\n<p>This way you need half as much <code>Thread</code>s in your <code>ThreadPool</code>, this will surely give you better performance. </p>\n\n<p>If you stick to the original version, I recommend you to <em>measure</em> (I mean prove your assumption, e.g. by log).</p>\n"},{"tags":[],"owner":{"account_id":5855624,"reputation":1,"user_id":4612972,"display_name":"satya"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1425008138,"creation_date":1425008138,"answer_id":28757087,"question_id":14773517,"body_markdown":"Your sequential execution is due to below lines:\r\nbSuccessfulOne = futureOne.get();\r\nbSuccessfulTwo = futureTwo.get();\r\n\r\nPlease make a list of future add your result there and stop the thread execution.\r\nYou may use awaitTermination or some other thing.\r\nThen get the future object from list and do get operation.","title":"Executing multiple threads in java web service","body":"<p>Your sequential execution is due to below lines:\nbSuccessfulOne = futureOne.get();\nbSuccessfulTwo = futureTwo.get();</p>\n\n<p>Please make a list of future add your result there and stop the thread execution.\nYou may use awaitTermination or some other thing.\nThen get the future object from list and do get operation.</p>\n"}],"owner":{"account_id":104539,"reputation":399,"user_id":279436,"accept_rate":73,"display_name":"AD."},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":9178,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":2,"score":2,"last_activity_date":1695362860,"creation_date":1360329651,"question_id":14773517,"body_markdown":"I have a web service which in one of its web methods creates two threads and calls two more web service for inserting data. Now, my original web service is expected to receive calls in range of 1,000 to 10,000 in parallel. So you may understand that for each such call internally my web service is going to create two more threads. I have already tuned my application server for such heavy load. trust me.\r\n\r\nI used Executor with fixed thread pool size using future objects in my original web service but i found that the calls made to the other two web services seem to be processed sequentially. I have checked all tutorials/code snippets. My code seems correct.\r\n\r\n    ExecutorService executor = Executors.newFixedThreadPool(size);\r\n    Future&lt;Boolean&gt; futureOne = executor.submit(new MyThread(serviceOne, data));\r\n    Future&lt;Boolean&gt; futureTwo = executor.submit(new  MyThread(serviceTwo, data));\r\n    bSuccessfulOne = futureOne.get();\r\n    bSuccessfulTwo = futureTwo.get();\r\n    \r\n\r\nIn view of the first para that i wrote is there any multithreading/job parallel framework/just some common-sense programming that might help process these web service calls in parallel. If any, please suggest.","title":"Executing multiple threads in java web service","body":"<p>I have a web service which in one of its web methods creates two threads and calls two more web service for inserting data. Now, my original web service is expected to receive calls in range of 1,000 to 10,000 in parallel. So you may understand that for each such call internally my web service is going to create two more threads. I have already tuned my application server for such heavy load. trust me.</p>\n\n<p>I used Executor with fixed thread pool size using future objects in my original web service but i found that the calls made to the other two web services seem to be processed sequentially. I have checked all tutorials/code snippets. My code seems correct.</p>\n\n<pre><code>ExecutorService executor = Executors.newFixedThreadPool(size);\nFuture&lt;Boolean&gt; futureOne = executor.submit(new MyThread(serviceOne, data));\nFuture&lt;Boolean&gt; futureTwo = executor.submit(new  MyThread(serviceTwo, data));\nbSuccessfulOne = futureOne.get();\nbSuccessfulTwo = futureTwo.get();\n</code></pre>\n\n<p>In view of the first para that i wrote is there any multithreading/job parallel framework/just some common-sense programming that might help process these web service calls in parallel. If any, please suggest.</p>\n"},{"tags":["java","maven","parent-pom","apache-dubbo"],"answers":[{"tags":[],"owner":{"account_id":29073167,"reputation":1013,"user_id":22270964,"display_name":"Maksim Eliseev"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1695362833,"creation_date":1695362833,"answer_id":77155209,"question_id":77154712,"body_markdown":"Perhaps the problem could be in defining dependencies in the `&lt;dependentManagement/&gt;` section in the parent `pom`. For example:\r\n\r\n```xml\r\n&lt;dependencyManagement&gt;\r\n    &lt;dependencies&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\r\n            &lt;artifactId&gt;dubbo-spring-boot-starter&lt;/artifactId&gt;\r\n            &lt;version&gt;${spring-boot-dubbo.version}&lt;/version&gt;\r\n            &lt;type&gt;pom&lt;/type&gt; &lt;!-- wrong --&gt;\r\n            &lt;scope&gt;import&lt;/scope&gt; &lt;!-- wrong --&gt;\r\n        &lt;/dependency&gt;\r\n    &lt;/dependencies&gt;\r\n&lt;/dependencyManagement&gt;\r\n```\r\n\r\nThe `&lt;type/&gt;` and `&lt;/scope&gt;` are incorrect, beacuse the `dubbo-spring-boot-starter` dependency isn&#39;t of type `pom` and you didn&#39;t should to define the scope as `import`.\r\n\r\nAccording to [official docs][1], the `import` scope is only relevant for depepndencies with type `pom`:\r\n\r\n&gt; This scope is only supported on a dependency of type `pom` in the `&lt;dependencyManagement&gt;` section. It indicates the dependency is to be replaced with the effective list of dependencies in the specified POM&#39;s `&lt;dependencyManagement&gt;` section. Since they are replaced, dependencies with a scope of `import` do not actually participate in limiting the transitivity of a dependency.\r\n\r\nTry to remove the type and scope from all dependencies in the `&lt;dependentManagement/&gt;` section in the parent `pom`.\r\n\r\n\r\nIt is just a guess.\r\n\r\n\r\n  [1]: https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html#dependency-scope","title":"why child pom create a new version","body":"<p>Perhaps the problem could be in defining dependencies in the <code>&lt;dependentManagement/&gt;</code> section in the parent <code>pom</code>. For example:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependencyManagement&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\n            &lt;artifactId&gt;dubbo-spring-boot-starter&lt;/artifactId&gt;\n            &lt;version&gt;${spring-boot-dubbo.version}&lt;/version&gt;\n            &lt;type&gt;pom&lt;/type&gt; &lt;!-- wrong --&gt;\n            &lt;scope&gt;import&lt;/scope&gt; &lt;!-- wrong --&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n&lt;/dependencyManagement&gt;\n</code></pre>\n<p>The <code>&lt;type/&gt;</code> and <code>&lt;/scope&gt;</code> are incorrect, beacuse the <code>dubbo-spring-boot-starter</code> dependency isn't of type <code>pom</code> and you didn't should to define the scope as <code>import</code>.</p>\n<p>According to <a href=\"https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html#dependency-scope\" rel=\"nofollow noreferrer\">official docs</a>, the <code>import</code> scope is only relevant for depepndencies with type <code>pom</code>:</p>\n<blockquote>\n<p>This scope is only supported on a dependency of type <code>pom</code> in the <code>&lt;dependencyManagement&gt;</code> section. It indicates the dependency is to be replaced with the effective list of dependencies in the specified POM's <code>&lt;dependencyManagement&gt;</code> section. Since they are replaced, dependencies with a scope of <code>import</code> do not actually participate in limiting the transitivity of a dependency.</p>\n</blockquote>\n<p>Try to remove the type and scope from all dependencies in the <code>&lt;dependentManagement/&gt;</code> section in the parent <code>pom</code>.</p>\n<p>It is just a guess.</p>\n"}],"owner":{"account_id":9427444,"reputation":45,"user_id":7011962,"display_name":"gfq"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":42,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":77155209,"answer_count":1,"score":2,"last_activity_date":1695362833,"creation_date":1695353382,"question_id":77154712,"body_markdown":"1. Parent pom code\r\n\r\n   ```\r\n   \r\n       &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n       &lt;groupId&gt;com.example&lt;/groupId&gt;\r\n       &lt;artifactId&gt;SpringCloudDemo&lt;/artifactId&gt;\r\n       &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\r\n       &lt;name&gt;SpringCloudDemo&lt;/name&gt;\r\n       &lt;description&gt;SpringCloudDemo&lt;/description&gt;\r\n       &lt;packaging&gt;pom&lt;/packaging&gt;\r\n   \r\n       &lt;dependencyManagement&gt;\r\n           &lt;dependencies&gt;\r\n   \r\n               &lt;dependency&gt;\r\n                   &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\r\n                   &lt;artifactId&gt;dubbo-spring-boot-starter&lt;/artifactId&gt;\r\n                   &lt;version&gt;${spring-boot-dubbo.version}&lt;/version&gt;\r\n                   &lt;type&gt;pom&lt;/type&gt;\r\n                   &lt;scope&gt;import&lt;/scope&gt;\r\n               &lt;/dependency&gt;\r\n               &lt;dependency&gt;\r\n                   &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\r\n                   &lt;artifactId&gt;dubbo&lt;/artifactId&gt;\r\n                   &lt;version&gt;${spring-boot-dubbo.version}&lt;/version&gt;\r\n                   &lt;type&gt;pom&lt;/type&gt;\r\n                   &lt;scope&gt;import&lt;/scope&gt;\r\n               &lt;/dependency&gt;\r\n         \r\n               &lt;dependency&gt;\r\n                   &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\r\n                   &lt;artifactId&gt;dubbo-registry-nacos&lt;/artifactId&gt;\r\n                   &lt;version&gt;${spring-boot-dubbo-nacos.version}&lt;/version&gt;\r\n                   &lt;type&gt;pom&lt;/type&gt;\r\n                   &lt;scope&gt;import&lt;/scope&gt;\r\n               &lt;/dependency&gt;\r\n   \r\n   \r\n           &lt;/dependencies&gt;\r\n       &lt;/dependencyManagement&gt;\r\n   \r\n   ```\r\n\r\n2. in child pom child extends parent pom In Child POM\r\n\r\n```\r\n    &lt;parent&gt;\r\n        &lt;groupId&gt;com.example&lt;/groupId&gt;\r\n        &lt;artifactId&gt;SpringCloudDemo&lt;/artifactId&gt;\r\n        &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\r\n        &lt;relativePath&gt;../pom.xml&lt;/relativePath&gt;\r\n    &lt;/parent&gt;\r\n\r\n    &lt;dependencies&gt;\r\n\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\r\n            &lt;artifactId&gt;dubbo-spring-boot-starter&lt;/artifactId&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\r\n            &lt;artifactId&gt;dubbo&lt;/artifactId&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;!-- Nacos --&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\r\n            &lt;artifactId&gt;dubbo-registry-nacos&lt;/artifactId&gt;\r\n            &lt;version&gt;3.0.1&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n\r\n\r\n    &lt;/dependencies&gt;\r\n```\r\n\r\n3. But my child pom download 2.7.4.1 versionno use Parent Pom 3.1.9 Version dubbolike picture\r\n4. I have one questions: \r\n\r\nI want use 3.1.9 Version Dubbo ,But In Child Pom download 2.7.4.1 Version Dubbowhat happening","title":"why child pom create a new version","body":"<ol>\n<li><p>Parent pom code</p>\n<pre><code>\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;SpringCloudDemo&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;SpringCloudDemo&lt;/name&gt;\n    &lt;description&gt;SpringCloudDemo&lt;/description&gt;\n    &lt;packaging&gt;pom&lt;/packaging&gt;\n\n    &lt;dependencyManagement&gt;\n        &lt;dependencies&gt;\n\n            &lt;dependency&gt;\n                &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\n                &lt;artifactId&gt;dubbo-spring-boot-starter&lt;/artifactId&gt;\n                &lt;version&gt;${spring-boot-dubbo.version}&lt;/version&gt;\n                &lt;type&gt;pom&lt;/type&gt;\n                &lt;scope&gt;import&lt;/scope&gt;\n            &lt;/dependency&gt;\n            &lt;dependency&gt;\n                &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\n                &lt;artifactId&gt;dubbo&lt;/artifactId&gt;\n                &lt;version&gt;${spring-boot-dubbo.version}&lt;/version&gt;\n                &lt;type&gt;pom&lt;/type&gt;\n                &lt;scope&gt;import&lt;/scope&gt;\n            &lt;/dependency&gt;\n\n            &lt;dependency&gt;\n                &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\n                &lt;artifactId&gt;dubbo-registry-nacos&lt;/artifactId&gt;\n                &lt;version&gt;${spring-boot-dubbo-nacos.version}&lt;/version&gt;\n                &lt;type&gt;pom&lt;/type&gt;\n                &lt;scope&gt;import&lt;/scope&gt;\n            &lt;/dependency&gt;\n\n\n        &lt;/dependencies&gt;\n    &lt;/dependencyManagement&gt;\n\n</code></pre>\n</li>\n<li><p>in child pom child extends parent pom In Child POM</p>\n</li>\n</ol>\n<pre><code>    &lt;parent&gt;\n        &lt;groupId&gt;com.example&lt;/groupId&gt;\n        &lt;artifactId&gt;SpringCloudDemo&lt;/artifactId&gt;\n        &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n        &lt;relativePath&gt;../pom.xml&lt;/relativePath&gt;\n    &lt;/parent&gt;\n\n    &lt;dependencies&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\n            &lt;artifactId&gt;dubbo-spring-boot-starter&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\n            &lt;artifactId&gt;dubbo&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;!-- Nacos --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\n            &lt;artifactId&gt;dubbo-registry-nacos&lt;/artifactId&gt;\n            &lt;version&gt;3.0.1&lt;/version&gt;\n        &lt;/dependency&gt;\n\n\n    &lt;/dependencies&gt;\n</code></pre>\n<ol start=\"3\">\n<li>But my child pom download 2.7.4.1 versionno use Parent Pom 3.1.9 Version dubbolike picture</li>\n<li>I have one questions:</li>\n</ol>\n<p>I want use 3.1.9 Version Dubbo ,But In Child Pom download 2.7.4.1 Version Dubbowhat happening</p>\n"},{"tags":["java","spring-cloud","spring-kafka","spring-cloud-config"],"comments":[{"owner":{"account_id":1368060,"reputation":24601,"user_id":2730527,"display_name":"spencergibb"},"score":0,"creation_date":1695390229,"post_id":77155183,"comment_id":136022031,"body_markdown":"You can&#39;t reference something in config server with classpath. We don&#39;t have support for what you want to do","body":"You can&#39;t reference something in config server with classpath. We don&#39;t have support for what you want to do"},{"owner":{"account_id":8928886,"reputation":1066,"user_id":9719337,"display_name":"Dred"},"score":0,"creation_date":1695612884,"post_id":77155183,"comment_id":136042857,"body_markdown":"Thank you for your answer. Anyway, what is correct way to specify each keystore and/or path for it for each environment?","body":"Thank you for your answer. Anyway, what is correct way to specify each keystore and/or path for it for each environment?"}],"owner":{"account_id":8928886,"reputation":1066,"user_id":9719337,"display_name":"Dred"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":64,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1695362472,"creation_date":1695362472,"question_id":77155183,"body_markdown":" I have spring-config-server inside which there is \r\n\r\n    main/resources/configs/app1\r\n    main/resources/configs/app2\r\n    main/resources/configs/app3\r\n\r\nAnd inside each folder there are different settings like\r\n\r\n    app1-development.yml\r\n    app1-integration.yml\r\n    app1-production.yml\r\n\r\nAnd now 1 of the applications, for example, the same app1, has certificates for Kafka, which it needs in its work.\r\n\r\nIf you put them in a container inside the application, everything works. \r\nLike this\r\n\r\n    app1/src/main/resources/certs/truststore.jks\r\n\r\nAll the keys are inside that truststore.jks, for all environments. I want to put it from app1 to spring cloud\r\n\r\n    spring-config-server/src/main/resources/configs/app1/certs/truststore.jks\r\n\r\nThe settings are something like this\r\n\r\n    spring-config-server/src/main/resources/configs/app1/app1-development.yml\r\n\r\n    ...\r\n    ssl:\r\n    trust-store-location: classpath:/certs/truststore.jks\r\n    ...\r\nBut after starting app1 it doesn&#39;t find any certs. Why?\r\n","title":"spring cloud with common trustore for kafka in configs","body":"<p>I have spring-config-server inside which there is</p>\n<pre><code>main/resources/configs/app1\nmain/resources/configs/app2\nmain/resources/configs/app3\n</code></pre>\n<p>And inside each folder there are different settings like</p>\n<pre><code>app1-development.yml\napp1-integration.yml\napp1-production.yml\n</code></pre>\n<p>And now 1 of the applications, for example, the same app1, has certificates for Kafka, which it needs in its work.</p>\n<p>If you put them in a container inside the application, everything works.\nLike this</p>\n<pre><code>app1/src/main/resources/certs/truststore.jks\n</code></pre>\n<p>All the keys are inside that truststore.jks, for all environments. I want to put it from app1 to spring cloud</p>\n<pre><code>spring-config-server/src/main/resources/configs/app1/certs/truststore.jks\n</code></pre>\n<p>The settings are something like this</p>\n<pre><code>spring-config-server/src/main/resources/configs/app1/app1-development.yml\n\n...\nssl:\ntrust-store-location: classpath:/certs/truststore.jks\n...\n</code></pre>\n<p>But after starting app1 it doesn't find any certs. Why?</p>\n"},{"tags":["java","android","text-files","delete-file"],"comments":[{"owner":{"account_id":2485939,"reputation":19426,"user_id":2164365,"accept_rate":40,"display_name":"Abra"},"score":0,"creation_date":1695362396,"post_id":77154563,"comment_id":136016741,"body_markdown":"You wrote (in your question): _I wanted to completely erase all text in it and delete the file if possible._ What exactly do you mean by _erase all text in it_? Do you want to make it an empty file before you delete it? Why would you need to do that if you are going to delete the file anyway?","body":"You wrote (in your question): <i>I wanted to completely erase all text in it and delete the file if possible.</i> What exactly do you mean by <i>erase all text in it</i>? Do you want to make it an empty file before you delete it? Why would you need to do that if you are going to delete the file anyway?"},{"owner":{"account_id":2485939,"reputation":19426,"user_id":2164365,"accept_rate":40,"display_name":"Abra"},"score":0,"creation_date":1695362672,"post_id":77154563,"comment_id":136016786,"body_markdown":"Unrelated to your problem: If possible, I recommend that you use [try-with-resources](https://stackoverflow.com/questions/47314061/android-studio-3-0-try-with-resources-requires-api-level-19)","body":"Unrelated to your problem: If possible, I recommend that you use <a href=\"https://stackoverflow.com/questions/47314061/android-studio-3-0-try-with-resources-requires-api-level-19\">try-with-resources</a>"}],"answers":[{"tags":[],"owner":{"account_id":29004116,"reputation":337,"user_id":22217083,"display_name":"Sarah"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695362407,"creation_date":1695362407,"answer_id":77155177,"question_id":77154563,"body_markdown":"This code will open the file, erase its content, and then delete the file if needed:\r\n\r\n    import java.io.File;\r\n    import java.io.FileWriter;\r\n    import java.io.IOException;\r\n    \r\n    // ...\r\n    \r\n    // Define the file name\r\n    String fileName = &quot;your_text_file.txt&quot;;\r\n    \r\n    // Get the file object\r\n    File file = new File(getFilesDir(), fileName);\r\n    \r\n    try {\r\n        // Open the file for writing, this will erase its content\r\n        FileWriter writer = new FileWriter(file);\r\n    \r\n        // Optionally, delete the file after erasing its content\r\n        boolean deleteFileAfterErase = true;\r\n    \r\n        // If you want to delete the file, uncomment the next line\r\n        // deleteFileAfterErase = file.delete();\r\n    \r\n        writer.close();\r\n    \r\n        if (deleteFileAfterErase) {\r\n            // The file is deleted after erasing its content\r\n            Toast.makeText(Home2.this, &quot;File content erased and deleted.&quot;, Toast.LENGTH_LONG).show();\r\n        } else {\r\n            // The file content is erased, but the file is not deleted\r\n            Toast.makeText(Home2.this, &quot;File content erased.&quot;, Toast.LENGTH_LONG).show();\r\n        }\r\n    } catch (IOException e) {\r\n        e.printStackTrace();\r\n        Toast.makeText(Home2.this, &quot;Error erasing file content.&quot;, Toast.LENGTH_LONG).show();\r\n    }\r\n\r\nThis code first opens the file in write mode, erasing the contents of the file. You can then choose whether to delete the file after clearing the contents by setting the `deleteFileAfterErase` variable to true or false.\r\n\r\nIf you set `deleteFileAfterErase` to true, the contents of the file are deleted, and if you set it to false, only the contents are deleted and the empty file remains.","title":"Java code in Android Studio to delete a file or erase data in it","body":"<p>This code will open the file, erase its content, and then delete the file if needed:</p>\n<pre><code>import java.io.File;\nimport java.io.FileWriter;\nimport java.io.IOException;\n\n// ...\n\n// Define the file name\nString fileName = &quot;your_text_file.txt&quot;;\n\n// Get the file object\nFile file = new File(getFilesDir(), fileName);\n\ntry {\n    // Open the file for writing, this will erase its content\n    FileWriter writer = new FileWriter(file);\n\n    // Optionally, delete the file after erasing its content\n    boolean deleteFileAfterErase = true;\n\n    // If you want to delete the file, uncomment the next line\n    // deleteFileAfterErase = file.delete();\n\n    writer.close();\n\n    if (deleteFileAfterErase) {\n        // The file is deleted after erasing its content\n        Toast.makeText(Home2.this, &quot;File content erased and deleted.&quot;, Toast.LENGTH_LONG).show();\n    } else {\n        // The file content is erased, but the file is not deleted\n        Toast.makeText(Home2.this, &quot;File content erased.&quot;, Toast.LENGTH_LONG).show();\n    }\n} catch (IOException e) {\n    e.printStackTrace();\n    Toast.makeText(Home2.this, &quot;Error erasing file content.&quot;, Toast.LENGTH_LONG).show();\n}\n</code></pre>\n<p>This code first opens the file in write mode, erasing the contents of the file. You can then choose whether to delete the file after clearing the contents by setting the <code>deleteFileAfterErase</code> variable to true or false.</p>\n<p>If you set <code>deleteFileAfterErase</code> to true, the contents of the file are deleted, and if you set it to false, only the contents are deleted and the empty file remains.</p>\n"}],"owner":{"account_id":18767908,"reputation":11,"user_id":19696722,"display_name":"jeswin kannath"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":49,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1695362407,"creation_date":1695349469,"question_id":77154563,"body_markdown":"I tried different codes but none seem to work. The deletion is going into the same directory. It can detect the file. It also gives false positive as deleted but when the file is prompted to be opened the text in the files opens without any problem. Is it that the file is not deleted or is that the file is saved in the memory? It is OK if not deleting the file. I just want to delete the content inside it, it is a text file.\r\n\r\nThis is the code that I&#39;m currently using:\r\n```java\r\nFile dir = getFilesDir();\r\nFile file = new File(dir, n);\r\ndeleteFile(n);\r\n```\r\nI tried this code earlier to erase data, or modify it, but it&#39;s not working either:\r\n```java\r\nFileOutputStream fos = null;\r\ntry {\r\n    fos = openFileOutput(name1, MODE_PRIVATE);\r\n    fos.write(save.getBytes());\r\n    Toast.makeText(Home2.this,\r\n                   &quot;Saved to &quot; + getFilesDir() + &quot;/&quot; + name1,\r\n                   Toast.LENGTH_LONG)\r\n         .show();\r\n} catch (FileNotFoundException e) {\r\n    e.printStackTrace();\r\n} catch (IOException e) {\r\n    e.printStackTrace();\r\n} finally {\r\n    if (fos != null) {\r\n        try {\r\n            fos.close();\r\n        } catch (IOException e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n}\r\n```\r\nI wanted to completely erase all text in it and delete the file if possible.","title":"Java code in Android Studio to delete a file or erase data in it","body":"<p>I tried different codes but none seem to work. The deletion is going into the same directory. It can detect the file. It also gives false positive as deleted but when the file is prompted to be opened the text in the files opens without any problem. Is it that the file is not deleted or is that the file is saved in the memory? It is OK if not deleting the file. I just want to delete the content inside it, it is a text file.</p>\n<p>This is the code that I'm currently using:</p>\n<pre class=\"lang-java prettyprint-override\"><code>File dir = getFilesDir();\nFile file = new File(dir, n);\ndeleteFile(n);\n</code></pre>\n<p>I tried this code earlier to erase data, or modify it, but it's not working either:</p>\n<pre class=\"lang-java prettyprint-override\"><code>FileOutputStream fos = null;\ntry {\n    fos = openFileOutput(name1, MODE_PRIVATE);\n    fos.write(save.getBytes());\n    Toast.makeText(Home2.this,\n                   &quot;Saved to &quot; + getFilesDir() + &quot;/&quot; + name1,\n                   Toast.LENGTH_LONG)\n         .show();\n} catch (FileNotFoundException e) {\n    e.printStackTrace();\n} catch (IOException e) {\n    e.printStackTrace();\n} finally {\n    if (fos != null) {\n        try {\n            fos.close();\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>\n<p>I wanted to completely erase all text in it and delete the file if possible.</p>\n"},{"tags":["java","unit-testing","kotlin","junit","junit5"],"answers":[{"tags":[],"owner":{"account_id":11726648,"reputation":19523,"user_id":8583692,"display_name":"Mahozad"},"down_vote_count":0,"up_vote_count":41,"is_accepted":true,"score":41,"last_activity_date":1695362332,"creation_date":1535537546,"answer_id":52074920,"question_id":52074872,"body_markdown":"Declare a parameter of type `TestInfo` in your test method and [JUnit will automatically supply an instance] of that for the method:\r\n\r\n```java\r\n@Test\r\nvoid getTestInfo(TestInfo testInfo) { // Automatically injected\r\n    System.out.println(testInfo.getDisplayName());\r\n    System.out.println(testInfo.getTestMethod());\r\n    System.out.println(testInfo.getTestClass());\r\n    System.out.println(testInfo.getTags());\r\n}\r\n```\r\n\r\nYou can get test method name (and more) from the `TestInfo` instance as shown above.\r\n\r\n[JUnit will automatically supply an instance]: https://junit.org/junit5/docs/current/user-guide/#writing-tests-dependency-injection\r\n","title":"What is the equivalent of TestName rule in JUnit 5?","body":"<p>Declare a parameter of type <code>TestInfo</code> in your test method and <a href=\"https://junit.org/junit5/docs/current/user-guide/#writing-tests-dependency-injection\" rel=\"nofollow noreferrer\">JUnit will automatically supply an instance</a> of that for the method:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Test\nvoid getTestInfo(TestInfo testInfo) { // Automatically injected\n    System.out.println(testInfo.getDisplayName());\n    System.out.println(testInfo.getTestMethod());\n    System.out.println(testInfo.getTestClass());\n    System.out.println(testInfo.getTags());\n}\n</code></pre>\n<p>You can get test method name (and more) from the <code>TestInfo</code> instance as shown above.</p>\n"},{"tags":[],"owner":{"account_id":2573819,"reputation":15175,"user_id":2231972,"display_name":"Roman-Stop RU aggression in UA"},"down_vote_count":0,"up_vote_count":29,"is_accepted":false,"score":29,"last_activity_date":1677478361,"creation_date":1591128667,"answer_id":62160598,"question_id":52074872,"body_markdown":"In addition to what is written about injecting `TestInfo` to test method it is also possible to inject `TestInfo` to methods annotated with `@BeforeEach` and `@AfterEach` which might be useful sometimes:\r\n\r\n```\r\n@BeforeEach\r\nvoid setUp(TestInfo testInfo) {\r\n  log.info(String.format(&quot;test started: %s&quot;, testInfo.getDisplayName()));\r\n}\r\n@AfterEach\r\nvoid tearDown(TestInfo testInfo) {\r\n  log.info(String.format(&quot;test finished: %s&quot;, testInfo.getDisplayName()));\r\n}\r\n```","title":"What is the equivalent of TestName rule in JUnit 5?","body":"<p>In addition to what is written about injecting <code>TestInfo</code> to test method it is also possible to inject <code>TestInfo</code> to methods annotated with <code>@BeforeEach</code> and <code>@AfterEach</code> which might be useful sometimes:</p>\n<pre><code>@BeforeEach\nvoid setUp(TestInfo testInfo) {\n  log.info(String.format(&quot;test started: %s&quot;, testInfo.getDisplayName()));\n}\n@AfterEach\nvoid tearDown(TestInfo testInfo) {\n  log.info(String.format(&quot;test finished: %s&quot;, testInfo.getDisplayName()));\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":16752149,"reputation":2993,"user_id":12109043,"display_name":"zr0gravity7"},"down_vote_count":0,"up_vote_count":7,"is_accepted":false,"score":7,"last_activity_date":1644296679,"creation_date":1644295942,"answer_id":71028762,"question_id":52074872,"body_markdown":"An alternative for having the test name globally available as was possible in JUnit 4 is to shim the functionality yourself in a setup method using the [`TestInfo`][1] interface.\r\n\r\nFrom the [JUnit documentation on &quot;Dependency Injection for Constructors and Methods&quot;][2]:\r\n\r\n&gt; The `TestInfo` can then be used to retrieve information about the current container or test such as the display name, the test class, the test method, and associated tags. \r\n\r\nHere we leverage the fact that the built-in resolvers will supply an instance of `TestInfo` corresponding to the current container or test as the value for parameters of type `TestInfo` to methods annotated as lifecycle hooks (here we use `@BeforeEach`).\r\n\r\n```java\r\nimport org.junit.jupiter.api.TestInfo;\r\n\r\npublic class MyTestClass {\r\n  String displayName;\r\n\r\n  @BeforeEach\r\n  void setUp(TestInfo testInfo) {\r\n    displayName = testInfo.getDisplayName();\r\n    // ... the rest of your setup\r\n  }\r\n}\r\n```\r\n\r\nThis for example enables you to reference the current test name in other non-test methods (such as various utility methods) without having to include the test name as a parameter to each function call from the initial test method to that utility method.\r\n\r\nYou can do the same for other information about the current container or test.\r\n\r\nSeems like the only disadvantages are:\r\n- the instance variable cannot be made `final`, as it is set dynamically\r\n- may pollute your setup code\r\n\r\n--- \r\nFor reference, here is how the [TestName-Rule][3] might be implemented in JUnit 4:\r\n\r\n```\r\npublic class MyTestClass {\r\n  @Rule\r\n  public final TestName name = new TestName();\r\n}\r\n```\r\n\r\n\r\n\r\n\r\n  [1]: https://junit.org/junit5/docs/current/api/org.junit.jupiter.api/org/junit/jupiter/api/TestInfo.html\r\n  [2]: https://junit.org/junit5/docs/current/user-guide/#writing-tests-dependency-injection\r\n  [3]: https://github.com/junit-team/junit4/wiki/Rules#testname-rule","title":"What is the equivalent of TestName rule in JUnit 5?","body":"<p>An alternative for having the test name globally available as was possible in JUnit 4 is to shim the functionality yourself in a setup method using the <a href=\"https://junit.org/junit5/docs/current/api/org.junit.jupiter.api/org/junit/jupiter/api/TestInfo.html\" rel=\"noreferrer\"><code>TestInfo</code></a> interface.</p>\n<p>From the <a href=\"https://junit.org/junit5/docs/current/user-guide/#writing-tests-dependency-injection\" rel=\"noreferrer\">JUnit documentation on &quot;Dependency Injection for Constructors and Methods&quot;</a>:</p>\n<blockquote>\n<p>The <code>TestInfo</code> can then be used to retrieve information about the current container or test such as the display name, the test class, the test method, and associated tags.</p>\n</blockquote>\n<p>Here we leverage the fact that the built-in resolvers will supply an instance of <code>TestInfo</code> corresponding to the current container or test as the value for parameters of type <code>TestInfo</code> to methods annotated as lifecycle hooks (here we use <code>@BeforeEach</code>).</p>\n<pre class=\"lang-java prettyprint-override\"><code>import org.junit.jupiter.api.TestInfo;\n\npublic class MyTestClass {\n  String displayName;\n\n  @BeforeEach\n  void setUp(TestInfo testInfo) {\n    displayName = testInfo.getDisplayName();\n    // ... the rest of your setup\n  }\n}\n</code></pre>\n<p>This for example enables you to reference the current test name in other non-test methods (such as various utility methods) without having to include the test name as a parameter to each function call from the initial test method to that utility method.</p>\n<p>You can do the same for other information about the current container or test.</p>\n<p>Seems like the only disadvantages are:</p>\n<ul>\n<li>the instance variable cannot be made <code>final</code>, as it is set dynamically</li>\n<li>may pollute your setup code</li>\n</ul>\n<hr />\n<p>For reference, here is how the <a href=\"https://github.com/junit-team/junit4/wiki/Rules#testname-rule\" rel=\"noreferrer\">TestName-Rule</a> might be implemented in JUnit 4:</p>\n<pre><code>public class MyTestClass {\n  @Rule\n  public final TestName name = new TestName();\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":242262,"reputation":3530,"user_id":513660,"accept_rate":72,"display_name":"Will"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1677870169,"creation_date":1677870169,"answer_id":75630935,"question_id":52074872,"body_markdown":"The answers here already cover what the OP asked, but for completeness sake, I am adding a link here to a [Baeldung article][1] which covers this topic for both JUnit 5 and JUnit 4, in case someone stumbles upon this question while looking for how to get the test name in JUnit 4.\r\n\r\nAs already mentioned, for JUnit 5 one can utilize the `TestInfo` class, injecting an instance of it as a parameter to either your test method or to a method annotated with the `@BeforeEach` annotation. For JUnit 4, one would use a `TestName` instance annotated with the `@Rule` annotation. The article linked here also touches on handling parameterized tests.\r\n\r\n\r\n\r\n  [1]: https://www.baeldung.com/junit-get-name-of-currently-executing-test","title":"What is the equivalent of TestName rule in JUnit 5?","body":"<p>The answers here already cover what the OP asked, but for completeness sake, I am adding a link here to a <a href=\"https://www.baeldung.com/junit-get-name-of-currently-executing-test\" rel=\"nofollow noreferrer\">Baeldung article</a> which covers this topic for both JUnit 5 and JUnit 4, in case someone stumbles upon this question while looking for how to get the test name in JUnit 4.</p>\n<p>As already mentioned, for JUnit 5 one can utilize the <code>TestInfo</code> class, injecting an instance of it as a parameter to either your test method or to a method annotated with the <code>@BeforeEach</code> annotation. For JUnit 4, one would use a <code>TestName</code> instance annotated with the <code>@Rule</code> annotation. The article linked here also touches on handling parameterized tests.</p>\n"}],"owner":{"account_id":11726648,"reputation":19523,"user_id":8583692,"display_name":"Mahozad"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":11428,"favorite_count":0,"down_vote_count":0,"up_vote_count":39,"accepted_answer_id":52074920,"answer_count":4,"score":39,"last_activity_date":1695362332,"creation_date":1535537397,"question_id":52074872,"body_markdown":"How can I get name of the test method in JUnit 5?","title":"What is the equivalent of TestName rule in JUnit 5?","body":"<p>How can I get name of the test method in JUnit 5?</p>\n"},{"tags":["java","android","kotlin","android-edittext","android-keypad"],"owner":{"account_id":27817647,"reputation":591,"user_id":21238708,"display_name":"Jatin guglani"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":21,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":0,"score":2,"last_activity_date":1695362190,"creation_date":1695362190,"question_id":77155151,"body_markdown":"For the below code:\r\n\r\n        val MyKeyListener: View.OnKeyListener\r\n\r\n        MyKeyListener = object : View.OnKeyListener {\r\n\r\n            override fun onKey (v: View?, keyCode: Int, event: KeyEvent?): Boolean\r\n            {\r\n                if (event?.action == KeyEvent.ACTION_DOWN) {\r\n\r\n                     if (keyCode == KEYCODE_DPAD_UP) {\r\n\r\n                         Log.d (&quot;Key&quot;, &quot;Up Arrow Pressed&quot;)\r\n                         MoveCursor (KEYCODE_DPAD_UP, textfeild.id, textfeild.text.length)\r\n\r\n                     } else if (keyCode == KEYCODE_DPAD_DOWN) {\r\n\r\n                         Log.d (&quot;Key&quot;, &quot;Down Arrow Pressed&quot;)\r\n                         MoveCursor (KEYCODE_DPAD_DOWN, textfeild.id, textfeild.text.length)\r\n\r\n                     } else if (keyCode == KEYCODE_DPAD_UP_LEFT) {\r\n\r\n                         Log.d (&quot;Key&quot;, &quot;Up + Left Arrow Pressed&quot;)\r\n\r\n                     } else if (keyCode == KEYCODE_DPAD_UP_RIGHT) {\r\n\r\n                         Log.d (&quot;Key&quot;, &quot;Up + Right Arrow Pressed&quot;)\r\n                     }\r\n\r\n                }\r\n                return false\r\n            }\r\n\r\n        }\r\n        textfeild.setOnKeyListener(MyKeyListener)\r\n\r\nI&#39;m able to get the log for &quot;Up Arrow Pressed&quot; and &quot;Down Arrow Pressed&quot; when I press the up/down arrow on my keyboard but I&#39;m not getting Logs for &quot;Up + Left Arrow Pressed&quot; and &quot;Up + Right Arrow Pressed&quot; when I pressing the left and up arrow together (or right and up arrow).\r\n\r\ncan someone please tell me why and how to record an up and left arrow being pressed together in android?","title":"How to detect key event KEYCODE_DPAD_UP_RIGHT and KEYCODE_DPAD_UP_LEFT in android","body":"<p>For the below code:</p>\n<pre><code>    val MyKeyListener: View.OnKeyListener\n\n    MyKeyListener = object : View.OnKeyListener {\n\n        override fun onKey (v: View?, keyCode: Int, event: KeyEvent?): Boolean\n        {\n            if (event?.action == KeyEvent.ACTION_DOWN) {\n\n                 if (keyCode == KEYCODE_DPAD_UP) {\n\n                     Log.d (&quot;Key&quot;, &quot;Up Arrow Pressed&quot;)\n                     MoveCursor (KEYCODE_DPAD_UP, textfeild.id, textfeild.text.length)\n\n                 } else if (keyCode == KEYCODE_DPAD_DOWN) {\n\n                     Log.d (&quot;Key&quot;, &quot;Down Arrow Pressed&quot;)\n                     MoveCursor (KEYCODE_DPAD_DOWN, textfeild.id, textfeild.text.length)\n\n                 } else if (keyCode == KEYCODE_DPAD_UP_LEFT) {\n\n                     Log.d (&quot;Key&quot;, &quot;Up + Left Arrow Pressed&quot;)\n\n                 } else if (keyCode == KEYCODE_DPAD_UP_RIGHT) {\n\n                     Log.d (&quot;Key&quot;, &quot;Up + Right Arrow Pressed&quot;)\n                 }\n\n            }\n            return false\n        }\n\n    }\n    textfeild.setOnKeyListener(MyKeyListener)\n</code></pre>\n<p>I'm able to get the log for &quot;Up Arrow Pressed&quot; and &quot;Down Arrow Pressed&quot; when I press the up/down arrow on my keyboard but I'm not getting Logs for &quot;Up + Left Arrow Pressed&quot; and &quot;Up + Right Arrow Pressed&quot; when I pressing the left and up arrow together (or right and up arrow).</p>\n<p>can someone please tell me why and how to record an up and left arrow being pressed together in android?</p>\n"},{"tags":["java","rest","post","quarkus"],"comments":[{"owner":{"account_id":3052937,"reputation":17914,"user_id":2587166,"accept_rate":83,"display_name":"Luca Basso Ricci"},"score":0,"creation_date":1657104293,"post_id":72881943,"comment_id":128728593,"body_markdown":"https://quarkus.io/guides/resteasy-reactive#accessing-the-request-body; you need to aggregate your `input-n` parameters in a single object and let Quarkus mapping it using JSON mapper","body":"<a href=\"https://quarkus.io/guides/resteasy-reactive#accessing-the-request-body\" rel=\"nofollow noreferrer\">quarkus.io/guides/resteasy-reactive#accessing-the-request-bo&zwnj;&#8203;dy</a>; you need to aggregate your <code>input-n</code> parameters in a single object and let Quarkus mapping it using JSON mapper"},{"owner":{"account_id":2922228,"reputation":61034,"user_id":2504224,"display_name":"geoand"},"score":0,"creation_date":1657111341,"post_id":72881943,"comment_id":128731226,"body_markdown":"Where exactly are the parameters coming from? HTTP Body, Headers, something else?","body":"Where exactly are the parameters coming from? HTTP Body, Headers, something else?"},{"owner":{"account_id":10278040,"reputation":2869,"user_id":7584240,"accept_rate":17,"display_name":"BATMAN_2008"},"score":0,"creation_date":1657112454,"post_id":72881943,"comment_id":128731758,"body_markdown":"@geoand Thanks a lot for the response. It is like I need to pass multiple parameters to my Quarkus service which will internally call the Java method by passing these parameters.  I have added an simple example code. Please see in the question.","body":"@geoand Thanks a lot for the response. It is like I need to pass multiple parameters to my Quarkus service which will internally call the Java method by passing these parameters.  I have added an simple example code. Please see in the question."},{"owner":{"account_id":2922228,"reputation":61034,"user_id":2504224,"display_name":"geoand"},"score":0,"creation_date":1657114033,"post_id":72881943,"comment_id":128732487,"body_markdown":"I see the sample code, but it&#39;s not obvious where you expect `input1`, `input2` etc to be coming from.","body":"I see the sample code, but it&#39;s not obvious where you expect <code>input1</code>, <code>input2</code> etc to be coming from."},{"owner":{"account_id":10278040,"reputation":2869,"user_id":7584240,"accept_rate":17,"display_name":"BATMAN_2008"},"score":0,"creation_date":1657117924,"post_id":72881943,"comment_id":128734299,"body_markdown":"@geoand It is user-provided meaning that users can either provide it in Quarkus Swagger-UI or using Postman or using the CURL command etc. Basically, users will provide different information.","body":"@geoand It is user-provided meaning that users can either provide it in Quarkus Swagger-UI or using Postman or using the CURL command etc. Basically, users will provide different information."},{"owner":{"account_id":2922228,"reputation":61034,"user_id":2504224,"display_name":"geoand"},"score":0,"creation_date":1657277247,"post_id":72881943,"comment_id":128778018,"body_markdown":"Sure, but where does it come from? Query parameters, headers, request body?","body":"Sure, but where does it come from? Query parameters, headers, request body?"},{"owner":{"account_id":3628785,"reputation":123,"user_id":3025610,"display_name":"stanly"},"score":0,"creation_date":1671113939,"post_id":72881943,"comment_id":132031896,"body_markdown":"I have the same issue when using `QueryParams`","body":"I have the same issue when using <code>QueryParams</code>"}],"answers":[{"tags":[],"owner":{"account_id":200258,"reputation":653,"user_id":446011,"display_name":"gschaden"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1672420364,"creation_date":1672420364,"answer_id":74964103,"question_id":72881943,"body_markdown":"Maybe a MessageBodyReader is what you are looking for.\r\n\r\nYou define a single Class for your input\r\n\r\n``` java\r\npublic class MyInput {\r\n    public List&lt;String&gt; lines;\r\n}\r\n```\r\nand a api method\r\n\r\n    @Path(&quot;/example&quot;)\r\n    @POST\r\n    @Consumes({MediaType.APPLICATION_JSON, MediaType.TEXT_PLAIN})\r\n    public String generate(@HeaderParam(&quot;Content-Type&quot;) String contentType, MyInput input){\r\n        return String.join(&quot;,&quot;, input.lines);\r\n    }\r\n\r\nand a message reader, which can convert text/plain to MyInput. In this case we just read all the lines from input.\r\n\r\n    @Provider\r\n    @Consumes(MediaType.TEXT_PLAIN)\r\n    public class MyInputReaderFromText implements MessageBodyReader {\r\n        @Override\r\n        public boolean isReadable(Class aClass, Type type, Annotation[] annotations, MediaType mediaType) {\r\n            return aClass.equals(MyInput.class);\r\n        }\r\n        @Override\r\n        public Object readFrom(Class aClass, Type type, Annotation[] annotations, MediaType mediaType, MultivaluedMap multivaluedMap, InputStream inputStream) throws IOException, WebApplicationException {\r\n            MyInput result = null;\r\n            try(BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream))) {\r\n                result = new MyInput();\r\n                result.lines = new LinkedList();\r\n                while (reader.ready()){\r\n                    result.lines.add(reader.readLine());\r\n                }\r\n            } catch (Exception e) {\r\n                throw new RuntimeException(&quot;cannot parse input&quot;);\r\n            }\r\n            return result;\r\n        }\r\n    }\r\n\r\nNow you can post a plain text with lines \r\n```\r\nline1\r\nline2\r\n```\r\nor json like\r\n``` lang-js\r\n{\r\n &quot;lines&quot;: [&quot;line1&quot;, &quot;line2&quot;]\r\n}\r\n```\r\n","title":"Is there a way to pass multiple parameters to Quarkus resource with POST request?","body":"<p>Maybe a MessageBodyReader is what you are looking for.</p>\n<p>You define a single Class for your input</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class MyInput {\n    public List&lt;String&gt; lines;\n}\n</code></pre>\n<p>and a api method</p>\n<pre><code>@Path(&quot;/example&quot;)\n@POST\n@Consumes({MediaType.APPLICATION_JSON, MediaType.TEXT_PLAIN})\npublic String generate(@HeaderParam(&quot;Content-Type&quot;) String contentType, MyInput input){\n    return String.join(&quot;,&quot;, input.lines);\n}\n</code></pre>\n<p>and a message reader, which can convert text/plain to MyInput. In this case we just read all the lines from input.</p>\n<pre><code>@Provider\n@Consumes(MediaType.TEXT_PLAIN)\npublic class MyInputReaderFromText implements MessageBodyReader {\n    @Override\n    public boolean isReadable(Class aClass, Type type, Annotation[] annotations, MediaType mediaType) {\n        return aClass.equals(MyInput.class);\n    }\n    @Override\n    public Object readFrom(Class aClass, Type type, Annotation[] annotations, MediaType mediaType, MultivaluedMap multivaluedMap, InputStream inputStream) throws IOException, WebApplicationException {\n        MyInput result = null;\n        try(BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream))) {\n            result = new MyInput();\n            result.lines = new LinkedList();\n            while (reader.ready()){\n                result.lines.add(reader.readLine());\n            }\n        } catch (Exception e) {\n            throw new RuntimeException(&quot;cannot parse input&quot;);\n        }\n        return result;\n    }\n}\n</code></pre>\n<p>Now you can post a plain text with lines</p>\n<pre><code>line1\nline2\n</code></pre>\n<p>or json like</p>\n<pre class=\"lang-js prettyprint-override\"><code>{\n &quot;lines&quot;: [&quot;line1&quot;, &quot;line2&quot;]\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":29491235,"reputation":13,"user_id":22600216,"display_name":"Martin"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695362109,"creation_date":1695362109,"answer_id":77155148,"question_id":72881943,"body_markdown":"Here you have a good How-To. \r\nThis is for resteasy-reactive, but you should be able to use it for your needs.\r\n\r\n\r\nxy-url.com/api/v1/foo?var1=111111111&amp;var2=222222&amp;var3=3333333\r\n\r\n    @GET\r\n@Path(&quot;/api/v1/foo&quot;)\r\n@Produces(MediaType.xxxxxx)\r\npublic void yourParameters(@QueryParam(&quot;code&quot;) String var1, @QueryParam(&quot;var2&quot;) String var2,@QueryParam(&quot;var3&quot;) String var3);\r\n\r\n-----------------------------------\r\n \r\nhttps://quarkus.io/guides/resteasy-reactive\r\n\r\n\r\n    @POST\r\n        public String allParams(@RestPath String type,\r\n                                @RestMatrix String variant,\r\n                                @RestQuery String age,\r\n                                @RestCookie String level,\r\n                                @RestHeader(&quot;X-Cheese-Secret-Handshake&quot;)\r\n                                String secretHandshake,\r\n                                @RestForm String smell) {\r\n            return type + &quot;/&quot; + variant + &quot;/&quot; + age + &quot;/&quot; + level + &quot;/&quot;\r\n                + secretHandshake + &quot;/&quot; + smell;\r\n\r\n\r\n-------------\r\n\r\n    @Path(&quot;/cheeses/{type}&quot;)\r\npublic class Endpoint {\r\n\r\n    public static class Parameters {\r\n        @RestPath\r\n        String type;\r\n\r\n        @RestMatrix\r\n        String variant;\r\n\r\n        @RestQuery\r\n        String age;\r\n\r\n        @RestCookie\r\n        String level;\r\n\r\n        @RestHeader(&quot;X-Cheese-Secret-Handshake&quot;)\r\n        String secretHandshake;\r\n\r\n        @RestForm\r\n        String smell;\r\n    }\r\n\r\n    @POST\r\n    public String allParams(@BeanParam Parameters parameters) { \r\n        return parameters.type + &quot;/&quot; + parameters.variant + &quot;/&quot; + parameters.age\r\n            + &quot;/&quot; + parameters.level + &quot;/&quot; + parameters.secretHandshake\r\n            + &quot;/&quot; + parameters.smell;\r\n    }\r\n\r\n\r\nGreetings.","title":"Is there a way to pass multiple parameters to Quarkus resource with POST request?","body":"<p>Here you have a good How-To.\nThis is for resteasy-reactive, but you should be able to use it for your needs.</p>\n<p>xy-url.com/api/v1/foo?var1=111111111&amp;var2=222222&amp;var3=3333333</p>\n<pre><code>@GET\n</code></pre>\n<p>@Path(&quot;/api/v1/foo&quot;)\n@Produces(MediaType.xxxxxx)\npublic void yourParameters(@QueryParam(&quot;code&quot;) String var1, @QueryParam(&quot;var2&quot;) String var2,@QueryParam(&quot;var3&quot;) String var3);</p>\n<hr />\n<p><a href=\"https://quarkus.io/guides/resteasy-reactive\" rel=\"nofollow noreferrer\">https://quarkus.io/guides/resteasy-reactive</a></p>\n<pre><code>@POST\n    public String allParams(@RestPath String type,\n                            @RestMatrix String variant,\n                            @RestQuery String age,\n                            @RestCookie String level,\n                            @RestHeader(&quot;X-Cheese-Secret-Handshake&quot;)\n                            String secretHandshake,\n                            @RestForm String smell) {\n        return type + &quot;/&quot; + variant + &quot;/&quot; + age + &quot;/&quot; + level + &quot;/&quot;\n            + secretHandshake + &quot;/&quot; + smell;\n</code></pre>\n<hr />\n<pre><code>@Path(&quot;/cheeses/{type}&quot;)\n</code></pre>\n<p>public class Endpoint {</p>\n<pre><code>public static class Parameters {\n    @RestPath\n    String type;\n\n    @RestMatrix\n    String variant;\n\n    @RestQuery\n    String age;\n\n    @RestCookie\n    String level;\n\n    @RestHeader(&quot;X-Cheese-Secret-Handshake&quot;)\n    String secretHandshake;\n\n    @RestForm\n    String smell;\n}\n\n@POST\npublic String allParams(@BeanParam Parameters parameters) { \n    return parameters.type + &quot;/&quot; + parameters.variant + &quot;/&quot; + parameters.age\n        + &quot;/&quot; + parameters.level + &quot;/&quot; + parameters.secretHandshake\n        + &quot;/&quot; + parameters.smell;\n}\n</code></pre>\n<p>Greetings.</p>\n"}],"owner":{"account_id":10278040,"reputation":2869,"user_id":7584240,"accept_rate":17,"display_name":"BATMAN_2008"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":2327,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1695362109,"creation_date":1657103419,"question_id":72881943,"body_markdown":"I am developing an application using Quarkus which is based on the Java. I have a requirement where I would like to pass multiple parameters to my `Quarkus` based REST API. As of now everything works well when I pass a single parameter but when I increase the parameter then I get the error:\r\n```\r\nquarkus java.io.IOException can only have a single body parameter:\r\n```\r\n\r\nCan someone please let me know how can I pass multiple parameters to my quarkus application?\r\n\r\nFollowing is the example code I have:\r\n```\r\n@Path(&quot;/api&quot;)\r\npublic class ExampleResource {\r\n\r\n    @Path(&quot;/example&quot;)\r\n    @POST\r\n    @Consumes({MediaType.APPLICATION_JSON, MediaType.APPLICATION_XML})\r\n    @Produces(MediaType.APPLICATION_JSON)\r\n    public String generate(@HeaderParam(&quot;Content-Type&quot;) String contentType, final String input1, final String input2, final String input3){\r\n        System.out.println(&quot;Parameter 1 : &quot; + contentType);\r\n        System.out.println(&quot;Parameter 2 : &quot; + input1);\r\n        System.out.println(&quot;Parameter 3 : &quot; + input2);\r\n        System.out.println(&quot;Parameter 4 : &quot; + input3);\r\n\r\n        final MyClass myObj = new MyClass();\r\n        return contentType.equals(&quot;application/xml&quot;) ? myObj.xmlMethod(input1, input2, input3) : myObj.jsonMethod(input1, input2, input3);\r\n    }\r\n}\r\n```","title":"Is there a way to pass multiple parameters to Quarkus resource with POST request?","body":"<p>I am developing an application using Quarkus which is based on the Java. I have a requirement where I would like to pass multiple parameters to my <code>Quarkus</code> based REST API. As of now everything works well when I pass a single parameter but when I increase the parameter then I get the error:</p>\n<pre><code>quarkus java.io.IOException can only have a single body parameter:\n</code></pre>\n<p>Can someone please let me know how can I pass multiple parameters to my quarkus application?</p>\n<p>Following is the example code I have:</p>\n<pre><code>@Path(&quot;/api&quot;)\npublic class ExampleResource {\n\n    @Path(&quot;/example&quot;)\n    @POST\n    @Consumes({MediaType.APPLICATION_JSON, MediaType.APPLICATION_XML})\n    @Produces(MediaType.APPLICATION_JSON)\n    public String generate(@HeaderParam(&quot;Content-Type&quot;) String contentType, final String input1, final String input2, final String input3){\n        System.out.println(&quot;Parameter 1 : &quot; + contentType);\n        System.out.println(&quot;Parameter 2 : &quot; + input1);\n        System.out.println(&quot;Parameter 3 : &quot; + input2);\n        System.out.println(&quot;Parameter 4 : &quot; + input3);\n\n        final MyClass myObj = new MyClass();\n        return contentType.equals(&quot;application/xml&quot;) ? myObj.xmlMethod(input1, input2, input3) : myObj.jsonMethod(input1, input2, input3);\n    }\n}\n</code></pre>\n"},{"tags":["java","java-time","archunit"],"answers":[{"tags":[],"owner":{"account_id":18069010,"reputation":2524,"user_id":13134095,"display_name":"Manfred"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1695362001,"creation_date":1695060740,"answer_id":77129517,"question_id":77127672,"body_markdown":"The following simple `ArchRule` unconditionally forbids calling these methods:\r\n\r\n```java\r\n    @ArchTest\r\n    ArchRule no_direct_date_or_instant_instantiation =\r\n        com.tngtech.archunit.lang.syntax.ArchRuleDefinition\r\n            .noClasses()\r\n            .should().callConstructor(Date.class)\r\n            .orShould().callMethod(Instant.class, &quot;now&quot;);\r\n```\r\n\r\nFor your `Demo` class, this gives:\r\n&gt; `java.lang.AssertionError`: Architecture Violation [Priority: MEDIUM] - Rule &#39;no classes should call constructor Date.&lt;init&gt;() or should call method Instant.now()&#39; was violated (2 times):  \r\nMethod &lt;`Demo.methodOne()`&gt; calls constructor &lt;`java.util.Date.&lt;init&gt;()`&gt; in (SO77127672.java:29)  \r\nMethod &lt;`Demo.methodTwo()`&gt; calls method &lt;`java.time.Instant.now()`&gt; in (SO77127672.java:34)\r\n","title":"How to enforce a restriction of using Instant.now() or new Date() in any Java Test Methods?","body":"<p>The following simple <code>ArchRule</code> unconditionally forbids calling these methods:</p>\n<pre class=\"lang-java prettyprint-override\"><code>    @ArchTest\n    ArchRule no_direct_date_or_instant_instantiation =\n        com.tngtech.archunit.lang.syntax.ArchRuleDefinition\n            .noClasses()\n            .should().callConstructor(Date.class)\n            .orShould().callMethod(Instant.class, &quot;now&quot;);\n</code></pre>\n<p>For your <code>Demo</code> class, this gives:</p>\n<blockquote>\n<p><code>java.lang.AssertionError</code>: Architecture Violation [Priority: MEDIUM] - Rule 'no classes should call constructor Date.() or should call method Instant.now()' was violated (2 times):<br />\nMethod &lt;<code>Demo.methodOne()</code>&gt; calls constructor &lt;<code>java.util.Date.&lt;init&gt;()</code>&gt; in (SO77127672.java:29)<br />\nMethod &lt;<code>Demo.methodTwo()</code>&gt; calls method &lt;<code>java.time.Instant.now()</code>&gt; in (SO77127672.java:34)</p>\n</blockquote>\n"}],"owner":{"account_id":19049159,"reputation":121,"user_id":13907719,"display_name":"Codinggeek"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":46,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1695362001,"creation_date":1695043874,"question_id":77127672,"body_markdown":"Want to enforce a restriction of using Instant.now() or new Date() in any Java Method.\r\nBelow is the sample class\r\n\r\n```java\r\nclass Demo {\r\n\r\n    void methodOne() {\r\n        Date date = new Date();\r\n        // ...\r\n    }\r\n\r\n    void methodTwo() {\r\n        Instant instant = Instant.now();\r\n        // ...\r\n    }\r\n}\r\n\r\n```","title":"How to enforce a restriction of using Instant.now() or new Date() in any Java Test Methods?","body":"<p>Want to enforce a restriction of using Instant.now() or new Date() in any Java Method.\nBelow is the sample class</p>\n<pre class=\"lang-java prettyprint-override\"><code>class Demo {\n\n    void methodOne() {\n        Date date = new Date();\n        // ...\n    }\n\n    void methodTwo() {\n        Instant instant = Instant.now();\n        // ...\n    }\n}\n\n</code></pre>\n"},{"tags":["java","oracle","hibernate","spring-data-jpa","timezone"],"comments":[{"owner":{"account_id":7612423,"reputation":82486,"user_id":5772882,"display_name":"Anonymous"},"score":1,"creation_date":1678086471,"post_id":75645452,"comment_id":133458155,"body_markdown":"Can Oracle store a time that didn&#39;t exist in your time zone? Just asking to be sure.","body":"Can Oracle store a time that didn&#39;t exist in your time zone? Just asking to be sure."},{"owner":{"account_id":5773,"reputation":3320,"user_id":9458,"accept_rate":67,"display_name":"F&#225;bio"},"score":1,"creation_date":1678100548,"post_id":75645452,"comment_id":133461790,"body_markdown":"Yes, if I do an INSERT using SQL Developer it ignores the daylight savings time.","body":"Yes, if I do an INSERT using SQL Developer it ignores the daylight savings time."}],"answers":[{"tags":[],"owner":{"account_id":179640,"reputation":15442,"user_id":412446,"accept_rate":41,"display_name":"Christian Beikov"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1678115319,"creation_date":1678115319,"answer_id":75652492,"question_id":75645452,"body_markdown":"Hibernate usually converts the `LocalDate`, `LocalDateTime` etc. types to `java.sql.Date`, `java.sql.Timestamp` etc. when binding to JDBC. The reason for that is, that not all JDBC drivers support the java.time types.\r\n\r\nI don&#39;t think that Hibernate does any time zone translation for `LocalDate`, so if the `java.sql.Date` object that is passed to the JDBC driver ends up with a timezone shift in your database, this means that the JDBC driver is doing some conversion. Consult the Oracle documentation about this. ","title":"Hibernate LocalDate conversion","body":"<p>Hibernate usually converts the <code>LocalDate</code>, <code>LocalDateTime</code> etc. types to <code>java.sql.Date</code>, <code>java.sql.Timestamp</code> etc. when binding to JDBC. The reason for that is, that not all JDBC drivers support the java.time types.</p>\n<p>I don't think that Hibernate does any time zone translation for <code>LocalDate</code>, so if the <code>java.sql.Date</code> object that is passed to the JDBC driver ends up with a timezone shift in your database, this means that the JDBC driver is doing some conversion. Consult the Oracle documentation about this.</p>\n"},{"tags":[],"owner":{"account_id":5773,"reputation":3320,"user_id":9458,"accept_rate":67,"display_name":"F&#225;bio"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1695361701,"creation_date":1678467439,"answer_id":75698972,"question_id":75645452,"body_markdown":"Even though JPA 2.2 doesn&#39;t support *ZonedDateTime*, Hibernate does. I ended changing the properties to ZonedDateTime and added `spring.jpa.properties.hibernate.jdbc.time_zone=UTC`.\r\n\r\nThis was the only way I found to force Hibernate to behave in the way I expected.\r\n\r\nInternally, Hibernate uses TimeStamp to handle OffsetDateTime and Date to handle LocalDate. No matter what I tried, it always uses the default timezone to make the conversion before sending the data to the database.\r\n\r\nI also tried setting `spring.datasource.hikari.data-source-properties.oracle.jdbc.timezoneAsRegion` but it made no difference.\r\n\r\nWorking with Hibernate is quite frustrating, this is not the first time I have to handle some buggy behavior because they re-implemented poorly something already offered by the JDBC driver.\r\n\r\nI didn&#39;t had the chance to try Hibernate 6, maybe I&#39;ll update this answer in the future.\r\n\r\n## Update for Hibernate 6.2 ##\r\nWell, it got even worse: LocalDate is still converted using the default timezone, no matter what I tried.\r\n\r\nIn addition to the previous property, now I also had to add `spring.jpa.properties.hibernate.timezone.default_storage=NORMALIZE`.\r\n\r\nDespite what the documentation says, after I tried to use `NORMALIZE_UTC`, Oracle started throwing `ORA-01878` errors.","title":"Hibernate LocalDate conversion","body":"<p>Even though JPA 2.2 doesn't support <em>ZonedDateTime</em>, Hibernate does. I ended changing the properties to ZonedDateTime and added <code>spring.jpa.properties.hibernate.jdbc.time_zone=UTC</code>.</p>\n<p>This was the only way I found to force Hibernate to behave in the way I expected.</p>\n<p>Internally, Hibernate uses TimeStamp to handle OffsetDateTime and Date to handle LocalDate. No matter what I tried, it always uses the default timezone to make the conversion before sending the data to the database.</p>\n<p>I also tried setting <code>spring.datasource.hikari.data-source-properties.oracle.jdbc.timezoneAsRegion</code> but it made no difference.</p>\n<p>Working with Hibernate is quite frustrating, this is not the first time I have to handle some buggy behavior because they re-implemented poorly something already offered by the JDBC driver.</p>\n<p>I didn't had the chance to try Hibernate 6, maybe I'll update this answer in the future.</p>\n<h2>Update for Hibernate 6.2</h2>\n<p>Well, it got even worse: LocalDate is still converted using the default timezone, no matter what I tried.</p>\n<p>In addition to the previous property, now I also had to add <code>spring.jpa.properties.hibernate.timezone.default_storage=NORMALIZE</code>.</p>\n<p>Despite what the documentation says, after I tried to use <code>NORMALIZE_UTC</code>, Oracle started throwing <code>ORA-01878</code> errors.</p>\n"}],"owner":{"account_id":5773,"reputation":3320,"user_id":9458,"accept_rate":67,"display_name":"F&#225;bio"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":887,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75698972,"answer_count":2,"score":0,"last_activity_date":1695361701,"creation_date":1678051610,"question_id":75645452,"body_markdown":"Both my application and the database are on *America/Sao_Paulo* timezone.\r\n\r\nThe database is Oracle 19c and the application is using:\r\n\r\n* Spring 2.7.8\r\n* Hibernate 5.6.15.Final\r\n* Java 11\r\n\r\nMy problem is saving LocalDate or LocalDateTime to Oracle using JPA entities.\r\n\r\nThe table columns are all using the *DATE* type and the problem happens if I map them to *LocalDate* or *LocalDateTime* properties. The problem only happens on days where Daylight Time Savings starts.\r\n\r\nLet&#39;s say I have 2 properties:\r\n\r\n    @Column(name = &quot;holiday1&quot;)\r\n    private LocalDate holiday1;\r\n    \r\n    @Column(name = &quot;holiday2&quot;)\r\n    private LocalDateTime holiday2;\r\n    ...\r\n    entity.setHoliday1(LocalDate.of(2004, 11, 2));\r\n    entity.setHoliday2(LocalDateTime.of(2004, 11, 2, 0, 0, 0));\r\n\r\nIn this example, 2004-11-02 was the start of DTS in Brazil, on this day there was no midnight, so Hibernate is changing the 00:00 time part to 01:00 whenever it does the INSERT command and I end up with 2004-11-02 01:00:00 on the database.\r\n\r\nI tried adding the property _spring.jpa.properties.hibernate.jdbc.time_zone=UTC_ and it made no difference.\r\n\r\nIf I change the properties&#39; type to *OffsetDateTime* and do:\r\n\r\n    entity.setHoliday1(LocalDateTime.of(2004, 11, 2, 0, 0, 0).atOffset(ZoneOffset.UTC));\r\n\r\nI end up with 2004-11-02 21:00:00 on the database. However if use both _spring.jpa.properties.hibernate.jdbc.time_zone=UTC_ and _OffsetDateTime_ Hibernate finally inserts 2004-11-02 00:00 on the database.\r\n\r\nIs there a way to make Hibernate ignore the local timezone settings and treat LocalDate correctly? I can&#39;t globally set the application timezone to UTC or change a huge amount of legacy code to _OffsetDateTime_.","title":"Hibernate LocalDate conversion","body":"<p>Both my application and the database are on <em>America/Sao_Paulo</em> timezone.</p>\n<p>The database is Oracle 19c and the application is using:</p>\n<ul>\n<li>Spring 2.7.8</li>\n<li>Hibernate 5.6.15.Final</li>\n<li>Java 11</li>\n</ul>\n<p>My problem is saving LocalDate or LocalDateTime to Oracle using JPA entities.</p>\n<p>The table columns are all using the <em>DATE</em> type and the problem happens if I map them to <em>LocalDate</em> or <em>LocalDateTime</em> properties. The problem only happens on days where Daylight Time Savings starts.</p>\n<p>Let's say I have 2 properties:</p>\n<pre><code>@Column(name = &quot;holiday1&quot;)\nprivate LocalDate holiday1;\n\n@Column(name = &quot;holiday2&quot;)\nprivate LocalDateTime holiday2;\n...\nentity.setHoliday1(LocalDate.of(2004, 11, 2));\nentity.setHoliday2(LocalDateTime.of(2004, 11, 2, 0, 0, 0));\n</code></pre>\n<p>In this example, 2004-11-02 was the start of DTS in Brazil, on this day there was no midnight, so Hibernate is changing the 00:00 time part to 01:00 whenever it does the INSERT command and I end up with 2004-11-02 01:00:00 on the database.</p>\n<p>I tried adding the property <em>spring.jpa.properties.hibernate.jdbc.time_zone=UTC</em> and it made no difference.</p>\n<p>If I change the properties' type to <em>OffsetDateTime</em> and do:</p>\n<pre><code>entity.setHoliday1(LocalDateTime.of(2004, 11, 2, 0, 0, 0).atOffset(ZoneOffset.UTC));\n</code></pre>\n<p>I end up with 2004-11-02 21:00:00 on the database. However if use both <em>spring.jpa.properties.hibernate.jdbc.time_zone=UTC</em> and <em>OffsetDateTime</em> Hibernate finally inserts 2004-11-02 00:00 on the database.</p>\n<p>Is there a way to make Hibernate ignore the local timezone settings and treat LocalDate correctly? I can't globally set the application timezone to UTC or change a huge amount of legacy code to <em>OffsetDateTime</em>.</p>\n"},{"tags":["java","websphere","sslsocketfactory","linkageerror"],"owner":{"account_id":29499247,"reputation":1,"user_id":22606634,"display_name":"Gaurav Nayak"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":36,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1695361569,"creation_date":1695291286,"question_id":77149300,"body_markdown":"Caused by: org.apache.kafka.common.KafkaException: java.lang.LinkageError: loading constraint violation when resolving method &quot;javax/net/ssl/SSLContext.getSocketFactory()Ljavax/net/ssl/SSLSocketFactory;&quot; : loader &quot;com/ibm/ws/classloader/CompoundClassLoader@31bff837&quot; of class &quot;org/apache/kafka/common/security/oauthbearer/secured/JaasOptionsUtils&quot; and loader &quot;com/ibm/oti/vm/BootstrapClassLoader@b46c41f7&quot; of class &quot;javax/net/ssl/SSLContext&quot; have different types for the method signature\r\n\tat org.apache.kafka.common.network.SaslChannelBuilder.configure(SaslChannelBuilder.java:184)\r\n\tat org.apache.kafka.common.network.ChannelBuilders.create(ChannelBuilders.java:192)\r\n\tat org.apache.kafka.common.network.ChannelBuilders.clientChannelBuilder(ChannelBuilders.java:81)\r\n\tat org.apache.kafka.clients.ClientUtils.createChannelBuilder(ClientUtils.java:105)\r\n\tat org.apache.kafka.clients.producer.KafkaProducer.newSender(KafkaProducer.java:484)\r\n\tat org.apache.kafka.clients.producer.KafkaProducer.&lt;init&gt;(KafkaProducer.java:428)\r\n\t... 19 more\r\nCaused by: java.lang.LinkageError: loading constraint violation when resolving method &quot;javax/net/ssl/SSLContext.getSocketFactory()Ljavax/net/ssl/SSLSocketFactory;&quot; : loader &quot;com/ibm/ws/classloader/CompoundClassLoader@31bff837&quot; of class &quot;org/apache/kafka/common/security/oauthbearer/secured/JaasOptionsUtils&quot; and loader &quot;com/ibm/oti/vm/BootstrapClassLoader@b46c41f7&quot; of class &quot;javax/net/ssl/SSLContext&quot; have different types for the method signature\r\n\tat org.apache.kafka.common.security.oauthbearer.secured.JaasOptionsUtils.createSSLSocketFactory(JaasOptionsUtils.java:77)\r\n\tat org.apache.kafka.common.security.oauthbearer.secured.AccessTokenRetrieverFactory.create(AccessTokenRetrieverFactory.java:69)\r\n\tat org.apache.kafka.common.security.oauthbearer.secured.OAuthBearerLoginCallbackHandler.configure(OAuthBearerLoginCallbackHandler.java:186)\r\n\tat org.apache.kafka.common.network.SaslChannelBuilder.configure(SaslChannelBuilder.java:151)\r\n\t... 24 more\r\n\r\nThis error comes up after adding the dependency, \r\n\r\n\r\n```\r\n        &lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.apache.kafka&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;kafka-clients&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;3.2.3&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n```\r\nThe application is using java 8 and deployed on websphere server.\r\nTheapplication is also having httpclient dependency as well\r\nDoes anybody knows what should I do? Or what I am doing wrong?\r\n\r\nMany thanks in advance.","title":"java.lang.LinkageError:when resolving method &quot;javax.net.ssl.SSLContext.getSocketFactory()","body":"<p>Caused by: org.apache.kafka.common.KafkaException: java.lang.LinkageError: loading constraint violation when resolving method &quot;javax/net/ssl/SSLContext.getSocketFactory()Ljavax/net/ssl/SSLSocketFactory;&quot; : loader &quot;com/ibm/ws/classloader/CompoundClassLoader@31bff837&quot; of class &quot;org/apache/kafka/common/security/oauthbearer/secured/JaasOptionsUtils&quot; and loader &quot;com/ibm/oti/vm/BootstrapClassLoader@b46c41f7&quot; of class &quot;javax/net/ssl/SSLContext&quot; have different types for the method signature\nat org.apache.kafka.common.network.SaslChannelBuilder.configure(SaslChannelBuilder.java:184)\nat org.apache.kafka.common.network.ChannelBuilders.create(ChannelBuilders.java:192)\nat org.apache.kafka.common.network.ChannelBuilders.clientChannelBuilder(ChannelBuilders.java:81)\nat org.apache.kafka.clients.ClientUtils.createChannelBuilder(ClientUtils.java:105)\nat org.apache.kafka.clients.producer.KafkaProducer.newSender(KafkaProducer.java:484)\nat org.apache.kafka.clients.producer.KafkaProducer.(KafkaProducer.java:428)\n... 19 more\nCaused by: java.lang.LinkageError: loading constraint violation when resolving method &quot;javax/net/ssl/SSLContext.getSocketFactory()Ljavax/net/ssl/SSLSocketFactory;&quot; : loader &quot;com/ibm/ws/classloader/CompoundClassLoader@31bff837&quot; of class &quot;org/apache/kafka/common/security/oauthbearer/secured/JaasOptionsUtils&quot; and loader &quot;com/ibm/oti/vm/BootstrapClassLoader@b46c41f7&quot; of class &quot;javax/net/ssl/SSLContext&quot; have different types for the method signature\nat org.apache.kafka.common.security.oauthbearer.secured.JaasOptionsUtils.createSSLSocketFactory(JaasOptionsUtils.java:77)\nat org.apache.kafka.common.security.oauthbearer.secured.AccessTokenRetrieverFactory.create(AccessTokenRetrieverFactory.java:69)\nat org.apache.kafka.common.security.oauthbearer.secured.OAuthBearerLoginCallbackHandler.configure(OAuthBearerLoginCallbackHandler.java:186)\nat org.apache.kafka.common.network.SaslChannelBuilder.configure(SaslChannelBuilder.java:151)\n... 24 more</p>\n<p>This error comes up after adding the dependency,</p>\n<pre><code>        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt;\n            &lt;artifactId&gt;kafka-clients&lt;/artifactId&gt;\n            &lt;version&gt;3.2.3&lt;/version&gt;\n        &lt;/dependency&gt;\n</code></pre>\n<p>The application is using java 8 and deployed on websphere server.\nTheapplication is also having httpclient dependency as well\nDoes anybody knows what should I do? Or what I am doing wrong?</p>\n<p>Many thanks in advance.</p>\n"},{"tags":["java","android","webview","filebrowse"],"comments":[{"owner":{"account_id":16768304,"reputation":8503,"user_id":12121419,"display_name":"blackapps"},"score":0,"creation_date":1684908441,"post_id":76315149,"comment_id":134584194,"body_markdown":"https://stackoverflow.com/questions/76319946/uploading-files-through-the-camera-is-0-bytes-but-if-its-via-the-gallery-its-o","body":"<a href=\"https://stackoverflow.com/questions/76319946/uploading-files-through-the-camera-is-0-bytes-but-if-its-via-the-gallery-its-o\" title=\"uploading files through the camera is 0 bytes but if its via the gallery its o\">stackoverflow.com/questions/76319946/&hellip;</a>"},{"owner":{"account_id":15414279,"reputation":13,"user_id":11120404,"display_name":"Sukh"},"score":0,"creation_date":1684930909,"post_id":76315149,"comment_id":134589078,"body_markdown":"Thank you @blackapps. That question has helped. Thankfully, that question was posted today :-) I will work on it and post the result, or ask a question, if I face some problem.","body":"Thank you @blackapps. That question has helped. Thankfully, that question was posted today :-) I will work on it and post the result, or ask a question, if I face some problem."}],"answers":[{"tags":[],"owner":{"account_id":15414279,"reputation":13,"user_id":11120404,"display_name":"Sukh"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695361367,"creation_date":1695361367,"answer_id":77155100,"question_id":76315149,"body_markdown":"I was able to solve this problem. The link provided by @blackapps has helped. This also allows file downloads, which I later realized did not work. This is partial code:\r\n\r\n     public class MainActivity extends AppCompatActivity {\r\n    \r\n        private WebView webView;\r\n        private ProgressBar progressBar;\r\n    \r\n        private ValueCallback&lt;Uri[]&gt; filePath;\r\n        private ActivityResultLauncher&lt;Intent&gt; activityResultLauncher;\r\n        private static final int PERMISSIONS_REQUEST_CODE = 1;\r\n    \r\n        protected void onCreate(Bundle savedInstanceState) {\r\n    \r\n            String webUrl = getString(R.string.hosting_url);\r\n            super.onCreate(savedInstanceState);\r\n            if (getSupportActionBar() != null) {\r\n                getSupportActionBar().hide();\r\n            }\r\n    \r\n            setContentView(R.layout.activity_main);\r\n            progressBar = findViewById(R.id.progressBar);\r\n            webView = findViewById(R.id.webView);\r\n            WebSettings webSettings = webView.getSettings();\r\n    \r\n            webView.setWebViewClient(new CustomWebViewClient());\r\n            webSettings.setJavaScriptEnabled(true);\r\n            webSettings.setDomStorageEnabled(true);\r\n            webSettings.setSupportZoom(false);\r\n    \r\n            webView.setDownloadListener(new DownloadListener() {\r\n                public void onDownloadStart(String url, String userAgent,\r\n                                            String contentDisposition, String mimetype,\r\n                                            long contentLength) {\r\n                    Intent i = new Intent(Intent.ACTION_VIEW);\r\n                    i.setData(Uri.parse(url));\r\n                    startActivity(i);\r\n                }\r\n            });\r\n            webView.addJavascriptInterface(new WebAppInterface(this), &quot;Android&quot;);\r\n    \r\n            activityResultLauncher = registerForActivityResult(\r\n                    new ActivityResultContracts.StartActivityForResult(),\r\n                    new ActivityResultCallback&lt;ActivityResult&gt;() {\r\n                        @Override\r\n                        public void onActivityResult(ActivityResult result) {\r\n    \r\n                            if (result.getResultCode() == Activity.RESULT_OK) {\r\n                                Uri[] uris;\r\n    \r\n    \r\n                                Intent data = result.getData();\r\n                                if (data != null) {\r\n                                    if (data.getClipData() != null) { // more than one file\r\n    \r\n                                        int totalFiles = data.getClipData().getItemCount();\r\n                                        uris = new Uri[totalFiles];\r\n                                        for (int i = 0; i &lt; totalFiles; i++) {\r\n                                            Uri uri = data.getClipData().getItemAt(i).getUri();\r\n                                            uris[i] = uri;\r\n                                        }\r\n                                    } else { // one file\r\n                                        uris = new Uri[]{data.getData()};\r\n                                    }\r\n                                    filePath.onReceiveValue(uris);\r\n    \r\n                                }\r\n    \r\n                            } else {\r\n                                filePath.onReceiveValue(null);\r\n                            }\r\n                        }\r\n                    }\r\n    \r\n            );\r\n    \r\n            webView.setWebChromeClient(new WebChromeClient() {\r\n                @Override\r\n                public boolean onShowFileChooser(WebView webView, ValueCallback&lt;Uri[]&gt; filePathCallback, WebChromeClient.FileChooserParams fileChooserParams) {\r\n                    filePath = filePathCallback;\r\n    \r\n                    if (checkPermissions()) {\r\n                        Intent getContent = new Intent(Intent.ACTION_GET_CONTENT);\r\n                        getContent.addCategory(Intent.CATEGORY_OPENABLE);\r\n                        getContent.setType(&quot;*/*&quot;);\r\n                        if (fileChooserParams.getMode() == FileChooserParams.MODE_OPEN_MULTIPLE) {\r\n                            getContent.putExtra(Intent.EXTRA_ALLOW_MULTIPLE, true);\r\n                        }\r\n                        Intent chooserIntent = new Intent(Intent.ACTION_CHOOSER);\r\n                        chooserIntent.putExtra(Intent.EXTRA_INTENT, getContent);\r\n                        activityResultLauncher.launch(chooserIntent);\r\n                        return true;\r\n                    }\r\n    \r\n                    return false;\r\n                }\r\n    \r\n            });\r\n    \r\n            // .....\r\n        }\r\n    \r\n        public boolean checkPermissions() {\r\n    \r\n            if (ContextCompat.checkSelfPermission(this, Manifest.permission.READ_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED\r\n    \r\n            ) {\r\n                String[] requiredPermissions = new String[]{Manifest.permission.READ_EXTERNAL_STORAGE};\r\n                ActivityCompat.requestPermissions(MainActivity.this, requiredPermissions, MainActivity.PERMISSIONS_REQUEST_CODE);\r\n                return false;\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n    \r\n        @Override\r\n        public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {\r\n            super.onRequestPermissionsResult(requestCode, permissions, grantResults);\r\n            if (requestCode == MainActivity.PERMISSIONS_REQUEST_CODE) {\r\n                if (grantResults.length &gt; 0 &amp;&amp; grantResults[0] == PackageManager.PERMISSION_GRANTED) {\r\n                    Toast.makeText(MainActivity.this, &quot;Please click the browse button again.&quot;, Toast.LENGTH_SHORT).show();\r\n                } else {\r\n                    Toast.makeText(MainActivity.this, &quot;Permission is required to upload files, otherwise browse button will not work.&quot;, Toast.LENGTH_SHORT).show();\r\n                    Toast.makeText(MainActivity.this, &quot;If permission was denied more than once, then from Settings, allow Media and file access permission for &quot; + R.string.app_name, Toast.LENGTH_SHORT).show();\r\n    \r\n                }\r\n    \r\n            }\r\n    \r\n    \r\n        }\r\n    }\r\n\r\n\r\nAndoidManifest.xml\r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\r\n    &lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\r\n        xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;\r\n    \r\n        &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;\r\n        &lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot; /&gt;\r\n        &lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot; /&gt;\r\n        &lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot; /&gt;\r\n        &lt;uses-permission android:name=&quot;android.permission.STORAGE&quot; /&gt;\r\n\r\n    &lt;!-- .... --&gt;\r\n    \r\n    &lt;/manifest&gt;","title":"Android WebView html file browse buttons are not selecting files. The ActivityResult.getResultCode() is always 0","body":"<p>I was able to solve this problem. The link provided by @blackapps has helped. This also allows file downloads, which I later realized did not work. This is partial code:</p>\n<pre><code> public class MainActivity extends AppCompatActivity {\n\n    private WebView webView;\n    private ProgressBar progressBar;\n\n    private ValueCallback&lt;Uri[]&gt; filePath;\n    private ActivityResultLauncher&lt;Intent&gt; activityResultLauncher;\n    private static final int PERMISSIONS_REQUEST_CODE = 1;\n\n    protected void onCreate(Bundle savedInstanceState) {\n\n        String webUrl = getString(R.string.hosting_url);\n        super.onCreate(savedInstanceState);\n        if (getSupportActionBar() != null) {\n            getSupportActionBar().hide();\n        }\n\n        setContentView(R.layout.activity_main);\n        progressBar = findViewById(R.id.progressBar);\n        webView = findViewById(R.id.webView);\n        WebSettings webSettings = webView.getSettings();\n\n        webView.setWebViewClient(new CustomWebViewClient());\n        webSettings.setJavaScriptEnabled(true);\n        webSettings.setDomStorageEnabled(true);\n        webSettings.setSupportZoom(false);\n\n        webView.setDownloadListener(new DownloadListener() {\n            public void onDownloadStart(String url, String userAgent,\n                                        String contentDisposition, String mimetype,\n                                        long contentLength) {\n                Intent i = new Intent(Intent.ACTION_VIEW);\n                i.setData(Uri.parse(url));\n                startActivity(i);\n            }\n        });\n        webView.addJavascriptInterface(new WebAppInterface(this), &quot;Android&quot;);\n\n        activityResultLauncher = registerForActivityResult(\n                new ActivityResultContracts.StartActivityForResult(),\n                new ActivityResultCallback&lt;ActivityResult&gt;() {\n                    @Override\n                    public void onActivityResult(ActivityResult result) {\n\n                        if (result.getResultCode() == Activity.RESULT_OK) {\n                            Uri[] uris;\n\n\n                            Intent data = result.getData();\n                            if (data != null) {\n                                if (data.getClipData() != null) { // more than one file\n\n                                    int totalFiles = data.getClipData().getItemCount();\n                                    uris = new Uri[totalFiles];\n                                    for (int i = 0; i &lt; totalFiles; i++) {\n                                        Uri uri = data.getClipData().getItemAt(i).getUri();\n                                        uris[i] = uri;\n                                    }\n                                } else { // one file\n                                    uris = new Uri[]{data.getData()};\n                                }\n                                filePath.onReceiveValue(uris);\n\n                            }\n\n                        } else {\n                            filePath.onReceiveValue(null);\n                        }\n                    }\n                }\n\n        );\n\n        webView.setWebChromeClient(new WebChromeClient() {\n            @Override\n            public boolean onShowFileChooser(WebView webView, ValueCallback&lt;Uri[]&gt; filePathCallback, WebChromeClient.FileChooserParams fileChooserParams) {\n                filePath = filePathCallback;\n\n                if (checkPermissions()) {\n                    Intent getContent = new Intent(Intent.ACTION_GET_CONTENT);\n                    getContent.addCategory(Intent.CATEGORY_OPENABLE);\n                    getContent.setType(&quot;*/*&quot;);\n                    if (fileChooserParams.getMode() == FileChooserParams.MODE_OPEN_MULTIPLE) {\n                        getContent.putExtra(Intent.EXTRA_ALLOW_MULTIPLE, true);\n                    }\n                    Intent chooserIntent = new Intent(Intent.ACTION_CHOOSER);\n                    chooserIntent.putExtra(Intent.EXTRA_INTENT, getContent);\n                    activityResultLauncher.launch(chooserIntent);\n                    return true;\n                }\n\n                return false;\n            }\n\n        });\n\n        // .....\n    }\n\n    public boolean checkPermissions() {\n\n        if (ContextCompat.checkSelfPermission(this, Manifest.permission.READ_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED\n\n        ) {\n            String[] requiredPermissions = new String[]{Manifest.permission.READ_EXTERNAL_STORAGE};\n            ActivityCompat.requestPermissions(MainActivity.this, requiredPermissions, MainActivity.PERMISSIONS_REQUEST_CODE);\n            return false;\n        } else {\n            return true;\n        }\n    }\n\n    @Override\n    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {\n        super.onRequestPermissionsResult(requestCode, permissions, grantResults);\n        if (requestCode == MainActivity.PERMISSIONS_REQUEST_CODE) {\n            if (grantResults.length &gt; 0 &amp;&amp; grantResults[0] == PackageManager.PERMISSION_GRANTED) {\n                Toast.makeText(MainActivity.this, &quot;Please click the browse button again.&quot;, Toast.LENGTH_SHORT).show();\n            } else {\n                Toast.makeText(MainActivity.this, &quot;Permission is required to upload files, otherwise browse button will not work.&quot;, Toast.LENGTH_SHORT).show();\n                Toast.makeText(MainActivity.this, &quot;If permission was denied more than once, then from Settings, allow Media and file access permission for &quot; + R.string.app_name, Toast.LENGTH_SHORT).show();\n\n            }\n\n        }\n\n\n    }\n}\n</code></pre>\n<p>AndoidManifest.xml</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;\n\n    &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;\n    &lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot; /&gt;\n    &lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot; /&gt;\n    &lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot; /&gt;\n    &lt;uses-permission android:name=&quot;android.permission.STORAGE&quot; /&gt;\n\n&lt;!-- .... --&gt;\n\n&lt;/manifest&gt;\n</code></pre>\n"}],"owner":{"account_id":15414279,"reputation":13,"user_id":11120404,"display_name":"Sukh"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":57,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1695361367,"creation_date":1684847297,"question_id":76315149,"body_markdown":"I have just started using Android, but I have used the Java language in the past.\r\n\r\nI have loaded a web application in an android WebWiew. The app was published successfully but the file browse buttons did not work. I have tried searching for many days, but most of the code that I tried, either did not work or is outdated.\r\n\r\nRelated, answers on the internet too, are for old Android versions or were answered many years ago. For example, startActivityForResult() is now deprecated.\r\n\r\n**The file selection dialog does open**, but after selecting the file nothing happens.\r\n**The ActivityResult.getResultCode() is always returned as 0) zero**.\r\n\r\nThis is the string version of the result:\r\n\r\n*ActivityResult{resultCode=RESULT_CANCELED, data=null}*\r\n\r\nFor now, I Just want the browse button file selections to work, so that these get uploaded with the form.\r\n\r\nI have tried changing the permissions, and almost everything that I could.\r\n\r\nTarget SDK version is 33\r\nMin SDK version is 25\r\n\r\nI am posting the code that I have tried. For testing, I have replaced the app with a simple html page. I have tried accept=&#39;image/*&#39; , attributes as well. Please let me know what I am missing?\r\n\r\n\r\n```\r\n\r\n    public class MainActivity extends AppCompatActivity {\r\n    \r\n        private WebView webView;\r\n        private static final int FILE_CHOOSER_ACTIVITY_CODE = 1;\r\n        private ValueCallback&lt;Uri[]&gt; filePath;\r\n        private ActivityResultLauncher&lt;Intent&gt; activityResultLauncher;\r\n    \r\n        protected void onCreate(Bundle savedInstanceState) {\r\n    \r\n            String webUrl = getString(R.string.hosting_url);\r\n            super.onCreate(savedInstanceState);\r\n            if (getSupportActionBar() != null) {\r\n                getSupportActionBar().hide();\r\n            }\r\n    \r\n            setContentView(R.layout.activity_main);\r\n            webView = findViewById(R.id.webView);\r\n            WebSettings webSettings = webView.getSettings();\r\n    \r\n            webView.setWebViewClient(new CustomWebViewClient());\r\n            webSettings.setJavaScriptEnabled(true);\r\n            webSettings.setDomStorageEnabled(true);\r\n            webSettings.setSupportZoom(false);\r\n            //webSettings.setAllowFileAccess(true);\r\n            //webSettings.setAllowContentAccess(true);\r\n    \r\n            webView.addJavascriptInterface(new WebAppInterface(this), &quot;Android&quot;);\r\n    \r\n            activityResultLauncher = registerForActivityResult(\r\n                    new ActivityResultContracts.StartActivityForResult(),\r\n                    new ActivityResultCallback&lt;ActivityResult&gt;() {\r\n                        @Override\r\n                        public void onActivityResult(ActivityResult result) {\r\n                            if (filePath != null) {\r\n                                filePath.onReceiveValue(null);\r\n                            }\r\n                            System.out.println(result);\r\n                            Log.d(&quot;info&quot;, &quot;Result code is &quot; + result.getResultCode());\r\n                            if (result.getResultCode() == FILE_CHOOSER_ACTIVITY_CODE) {\r\n                                Uri[] results = null;\r\n    \r\n                                Log.d(&quot;Info&quot;, &quot;Result code  &quot; + result.getResultCode());\r\n                                //if (result.getResultCode() == Activity.RESULT_OK) {\r\n                                Intent data = result.getData();\r\n                                //Uri uri = new Uri(data.getData());\r\n                                if (data != null) {\r\n                                    if (null == filePath) {\r\n                                        return;\r\n                                    }\r\n                                    results = new Uri[]{data.getData()};\r\n                                    filePath.onReceiveValue(results);\r\n                                    System.out.println(results.toString());\r\n                                }\r\n                                //} else {\r\n                                //    filePath = null;\r\n                                //}\r\n                            }\r\n    \r\n                        }\r\n                    }\r\n    \r\n            );\r\n    \r\n            webView.setWebChromeClient(new WebChromeClient() {\r\n                @Override\r\n                public boolean onShowFileChooser(WebView webView, ValueCallback&lt;Uri[]&gt; filePathCallback, WebChromeClient.FileChooserParams fileChooserParams) {\r\n                    filePath = filePathCallback;\r\n                    if (checkPermissions()) {\r\n                        Intent getContent = new Intent(Intent.ACTION_GET_CONTENT);\r\n                        //getContent.addCategory(Intent.CATEGORY_OPENABLE);\r\n                        getContent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\r\n                        getContent.setType(&quot;*/*&quot;);\r\n                        //String[] mimeTypes = {&quot;text/*&quot;, &quot;image/&quot;};\r\n                        //getContent.putExtra(Intent.EXTRA_MIME_TYPES, mimeTypes);\r\n                        //getContent.createChooser(getContent, &quot;Choose a File&quot;);\r\n    \r\n                        activityResultLauncher.launch(getContent);\r\n    \r\n                        return true;\r\n    \r\n                    } else {\r\n                        Toast.makeText(MainActivity.this, &quot;Permissions are required&quot;, Toast.LENGTH_SHORT);\r\n                    }\r\n    \r\n                    return false;\r\n                }\r\n    \r\n            });\r\n    \r\n    \r\n        }\r\n    \r\n        public boolean checkPermissions() {\r\n    \r\n            if (ContextCompat.checkSelfPermission(this, Manifest.permission.READ_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED\r\n                    || ContextCompat.checkSelfPermission(this, Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED\r\n                    //|| ContextCompat.checkSelfPermission(this, Manifest.permission.CAMERA) != PackageManager.PERMISSION_GRANTED\r\n            ) {\r\n                String requiredPermissions[] = new String[]{Manifest.permission.READ_EXTERNAL_STORAGE, Manifest.permission.WRITE_EXTERNAL_STORAGE, Manifest.permission.CAMERA};\r\n                ActivityCompat.requestPermissions(MainActivity.this, requiredPermissions, 1);\r\n                return false;\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n    \r\n         ....\r\n         ....\r\n    }\r\n\r\n```\r\n\r\nAndroidManifest.xml\r\n\r\n```\r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\r\n    &lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\r\n        xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;\r\n        &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot;/&gt;\r\n        &lt;uses-permission android:name=&quot;android.permission.STORAGE&quot; /&gt;\r\n        &lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot;/&gt;\r\n        &lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot; /&gt;\r\n        &lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot; /&gt;\r\n        &lt;!-- &lt;uses-feature android:name=&quot;android.hardware.camera&quot; android:required=&quot;true&quot; /&gt;\r\n        &lt;uses-permission android:name=&quot;android.permission.CAMERA&quot; /&gt; --&gt;\r\n    \r\n        &lt;application\r\n            android:allowBackup=&quot;true&quot;\r\n            android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;\r\n            android:fullBackupContent=&quot;@xml/backup_rules&quot;\r\n            android:icon=&quot;@mipmap/ic_launcher&quot;\r\n            android:label=&quot;@string/app_name&quot;\r\n            android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;\r\n            android:supportsRtl=&quot;true&quot;\r\n            android:theme=&quot;@style/Theme.abc&quot;\r\n            tools:targetApi=&quot;31&quot;\r\n            android:usesCleartextTraffic=&quot;true&quot;&gt;\r\n            &lt;activity\r\n                android:name=&quot;.MainActivity&quot;\r\n                android:exported=&quot;true&quot;\r\n                android:configChanges=&quot;orientation|screenSize&quot;\r\n                &gt;\r\n                &lt;intent-filter&gt;\r\n                    &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;\r\n                    &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;\r\n                &lt;/intent-filter&gt;\r\n            &lt;/activity&gt;\r\n    \r\n    \r\n        &lt;/application&gt;\r\n    \r\n    &lt;/manifest&gt;\r\n\r\n```\r\n\r\ntest.html\r\n```\r\n\r\n    &lt;html&gt;\r\n    &lt;head&gt;\r\n    \t&lt;title&gt;\r\n    \t\tUpload\r\n    \t&lt;/title&gt;\r\n    &lt;/head&gt;\r\n    &lt;body&gt;\r\n    \t&lt;form method=&#39;post&#39; enctype=&#39;multipart/form-data&#39; action=&#39;&#39;&gt;\r\n    &lt;input type=&quot;file&quot;/&gt;\r\n    \t\t&lt;input type=&#39;submit&#39; value=&#39;Upload Now&#39; /&gt;\r\n    \t&lt;/form&gt;\r\n    &lt;/body&gt;\r\n    &lt;/html&gt;\r\n\r\n```","title":"Android WebView html file browse buttons are not selecting files. The ActivityResult.getResultCode() is always 0","body":"<p>I have just started using Android, but I have used the Java language in the past.</p>\n<p>I have loaded a web application in an android WebWiew. The app was published successfully but the file browse buttons did not work. I have tried searching for many days, but most of the code that I tried, either did not work or is outdated.</p>\n<p>Related, answers on the internet too, are for old Android versions or were answered many years ago. For example, startActivityForResult() is now deprecated.</p>\n<p><strong>The file selection dialog does open</strong>, but after selecting the file nothing happens.\n<strong>The ActivityResult.getResultCode() is always returned as 0) zero</strong>.</p>\n<p>This is the string version of the result:</p>\n<p><em>ActivityResult{resultCode=RESULT_CANCELED, data=null}</em></p>\n<p>For now, I Just want the browse button file selections to work, so that these get uploaded with the form.</p>\n<p>I have tried changing the permissions, and almost everything that I could.</p>\n<p>Target SDK version is 33\nMin SDK version is 25</p>\n<p>I am posting the code that I have tried. For testing, I have replaced the app with a simple html page. I have tried accept='image/*' , attributes as well. Please let me know what I am missing?</p>\n<pre><code>\n    public class MainActivity extends AppCompatActivity {\n    \n        private WebView webView;\n        private static final int FILE_CHOOSER_ACTIVITY_CODE = 1;\n        private ValueCallback&lt;Uri[]&gt; filePath;\n        private ActivityResultLauncher&lt;Intent&gt; activityResultLauncher;\n    \n        protected void onCreate(Bundle savedInstanceState) {\n    \n            String webUrl = getString(R.string.hosting_url);\n            super.onCreate(savedInstanceState);\n            if (getSupportActionBar() != null) {\n                getSupportActionBar().hide();\n            }\n    \n            setContentView(R.layout.activity_main);\n            webView = findViewById(R.id.webView);\n            WebSettings webSettings = webView.getSettings();\n    \n            webView.setWebViewClient(new CustomWebViewClient());\n            webSettings.setJavaScriptEnabled(true);\n            webSettings.setDomStorageEnabled(true);\n            webSettings.setSupportZoom(false);\n            //webSettings.setAllowFileAccess(true);\n            //webSettings.setAllowContentAccess(true);\n    \n            webView.addJavascriptInterface(new WebAppInterface(this), &quot;Android&quot;);\n    \n            activityResultLauncher = registerForActivityResult(\n                    new ActivityResultContracts.StartActivityForResult(),\n                    new ActivityResultCallback&lt;ActivityResult&gt;() {\n                        @Override\n                        public void onActivityResult(ActivityResult result) {\n                            if (filePath != null) {\n                                filePath.onReceiveValue(null);\n                            }\n                            System.out.println(result);\n                            Log.d(&quot;info&quot;, &quot;Result code is &quot; + result.getResultCode());\n                            if (result.getResultCode() == FILE_CHOOSER_ACTIVITY_CODE) {\n                                Uri[] results = null;\n    \n                                Log.d(&quot;Info&quot;, &quot;Result code  &quot; + result.getResultCode());\n                                //if (result.getResultCode() == Activity.RESULT_OK) {\n                                Intent data = result.getData();\n                                //Uri uri = new Uri(data.getData());\n                                if (data != null) {\n                                    if (null == filePath) {\n                                        return;\n                                    }\n                                    results = new Uri[]{data.getData()};\n                                    filePath.onReceiveValue(results);\n                                    System.out.println(results.toString());\n                                }\n                                //} else {\n                                //    filePath = null;\n                                //}\n                            }\n    \n                        }\n                    }\n    \n            );\n    \n            webView.setWebChromeClient(new WebChromeClient() {\n                @Override\n                public boolean onShowFileChooser(WebView webView, ValueCallback&lt;Uri[]&gt; filePathCallback, WebChromeClient.FileChooserParams fileChooserParams) {\n                    filePath = filePathCallback;\n                    if (checkPermissions()) {\n                        Intent getContent = new Intent(Intent.ACTION_GET_CONTENT);\n                        //getContent.addCategory(Intent.CATEGORY_OPENABLE);\n                        getContent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\n                        getContent.setType(&quot;*/*&quot;);\n                        //String[] mimeTypes = {&quot;text/*&quot;, &quot;image/&quot;};\n                        //getContent.putExtra(Intent.EXTRA_MIME_TYPES, mimeTypes);\n                        //getContent.createChooser(getContent, &quot;Choose a File&quot;);\n    \n                        activityResultLauncher.launch(getContent);\n    \n                        return true;\n    \n                    } else {\n                        Toast.makeText(MainActivity.this, &quot;Permissions are required&quot;, Toast.LENGTH_SHORT);\n                    }\n    \n                    return false;\n                }\n    \n            });\n    \n    \n        }\n    \n        public boolean checkPermissions() {\n    \n            if (ContextCompat.checkSelfPermission(this, Manifest.permission.READ_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED\n                    || ContextCompat.checkSelfPermission(this, Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED\n                    //|| ContextCompat.checkSelfPermission(this, Manifest.permission.CAMERA) != PackageManager.PERMISSION_GRANTED\n            ) {\n                String requiredPermissions[] = new String[]{Manifest.permission.READ_EXTERNAL_STORAGE, Manifest.permission.WRITE_EXTERNAL_STORAGE, Manifest.permission.CAMERA};\n                ActivityCompat.requestPermissions(MainActivity.this, requiredPermissions, 1);\n                return false;\n            } else {\n                return true;\n            }\n        }\n    \n         ....\n         ....\n    }\n\n</code></pre>\n<p>AndroidManifest.xml</p>\n<pre><code>\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n    &lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n        xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;\n        &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot;/&gt;\n        &lt;uses-permission android:name=&quot;android.permission.STORAGE&quot; /&gt;\n        &lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot;/&gt;\n        &lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot; /&gt;\n        &lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot; /&gt;\n        &lt;!-- &lt;uses-feature android:name=&quot;android.hardware.camera&quot; android:required=&quot;true&quot; /&gt;\n        &lt;uses-permission android:name=&quot;android.permission.CAMERA&quot; /&gt; --&gt;\n    \n        &lt;application\n            android:allowBackup=&quot;true&quot;\n            android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;\n            android:fullBackupContent=&quot;@xml/backup_rules&quot;\n            android:icon=&quot;@mipmap/ic_launcher&quot;\n            android:label=&quot;@string/app_name&quot;\n            android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;\n            android:supportsRtl=&quot;true&quot;\n            android:theme=&quot;@style/Theme.abc&quot;\n            tools:targetApi=&quot;31&quot;\n            android:usesCleartextTraffic=&quot;true&quot;&gt;\n            &lt;activity\n                android:name=&quot;.MainActivity&quot;\n                android:exported=&quot;true&quot;\n                android:configChanges=&quot;orientation|screenSize&quot;\n                &gt;\n                &lt;intent-filter&gt;\n                    &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;\n                    &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;\n                &lt;/intent-filter&gt;\n            &lt;/activity&gt;\n    \n    \n        &lt;/application&gt;\n    \n    &lt;/manifest&gt;\n\n</code></pre>\n<p>test.html</p>\n<pre><code>\n    &lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;\n            Upload\n        &lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;form method='post' enctype='multipart/form-data' action=''&gt;\n    &lt;input type=&quot;file&quot;/&gt;\n            &lt;input type='submit' value='Upload Now' /&gt;\n        &lt;/form&gt;\n    &lt;/body&gt;\n    &lt;/html&gt;\n\n</code></pre>\n"},{"tags":["java","spring","spring-security","spring-boot","cors"],"comments":[{"owner":{"account_id":3592539,"reputation":2396,"user_id":2998222,"display_name":"Issam El-atif"},"score":1,"creation_date":1478252115,"post_id":40418441,"comment_id":68087372,"body_markdown":"There is an issue with Chrome it does not support localhost to go through the Access-Control-Allow-Origin. Try with another browser","body":"There is an issue with Chrome it does not support localhost to go through the Access-Control-Allow-Origin. Try with another browser"},{"owner":{"account_id":9578797,"reputation":1089,"user_id":7113955,"accept_rate":50,"display_name":"Mace"},"score":0,"creation_date":1478252425,"post_id":40418441,"comment_id":68087548,"body_markdown":"We tried with Edge and it is working... but firefox isn&#39;t working as well.","body":"We tried with Edge and it is working... but firefox isn&#39;t working as well."},{"owner":{"account_id":3592539,"reputation":2396,"user_id":2998222,"display_name":"Issam El-atif"},"score":0,"creation_date":1478252770,"post_id":40418441,"comment_id":68087739,"body_markdown":"I was having the same issue i solve it by adding `127.0.0.1   localhost local.net` to `/etc/hosts` then call http://local.net:8080/getKunden","body":"I was having the same issue i solve it by adding <code>127.0.0.1   localhost local.net</code> to <code>&#47;etc&#47;hosts</code> then call <a href=\"http://local.net:8080/getKunden\" rel=\"nofollow noreferrer\">local.net:8080/getKunden</a>"},{"owner":{"account_id":3592539,"reputation":2396,"user_id":2998222,"display_name":"Issam El-atif"},"score":0,"creation_date":1478254055,"post_id":40418441,"comment_id":68088545,"body_markdown":"see http://stackoverflow.com/questions/28547288/no-access-control-allow-origin-header-is-present-on-the-requested-resource-err it could help","body":"see <a href=\"http://stackoverflow.com/questions/28547288/no-access-control-allow-origin-header-is-present-on-the-requested-resource-err\" title=\"no access control allow origin header is present on the requested resource err\">stackoverflow.com/questions/28547288/&hellip;</a> it could help"}],"answers":[{"tags":[],"owner":{"account_id":4565974,"reputation":998,"user_id":3706986,"accept_rate":57,"display_name":"Piotr Sotysiak"},"down_vote_count":0,"up_vote_count":11,"is_accepted":false,"score":11,"last_activity_date":1549458693,"creation_date":1478250862,"answer_id":40418894,"question_id":40418441,"body_markdown":" 1. You don&#39;t need:\r\n\r\n        @Configuration\r\n        @ComponentScan(&quot;com.company.praktikant&quot;)\r\n    `@EnableWebSecurity` already has  `@Configuration` in it, and I cannot imagine why you put `@ComponentScan` there.\r\n\r\n 2. About CORS filter, I would just put this:\r\n\r\n        @Bean\r\n        public FilterRegistrationBean corsFilter() {\r\n            UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\r\n            CorsConfiguration config = new CorsConfiguration();\r\n            config.setAllowCredentials(true);\r\n            config.addAllowedOrigin(&quot;*&quot;);\r\n            config.addAllowedHeader(&quot;*&quot;);\r\n            config.addAllowedMethod(&quot;*&quot;);\r\n            source.registerCorsConfiguration(&quot;/**&quot;, config);\r\n            FilterRegistrationBean bean = new FilterRegistrationBean(new CorsFilter(source));\r\n            bean.setOrder(0); \r\n            return bean;\r\n        }\r\nInto SecurityConfiguration class and remove configure and configure global methods. You don&#39;t need to set allowde orgins, headers and methods twice. Especially if you put different properties in filter and spring security config :)\r\n\r\n 3. According to above, your &quot;MyFilter&quot; class is redundant.\r\n\r\n 4. You can also remove those:\r\n\r\n        final AnnotationConfigApplicationContext annotationConfigApplicationContext = new AnnotationConfigApplicationContext();\r\n        annotationConfigApplicationContext.register(CORSConfig.class);\r\n        annotationConfigApplicationContext.refresh();\r\nFrom Application class.\r\n\r\n 5. At the end small advice - not connected to the question. You don&#39;t want to put verbs in URI. Instead of `http://localhost:8080/getKunden` you should use HTTP GET method on `http://localhost:8080/kunden` resource. You can learn about best practices for design RESTful api here: http://www.vinaysahni.com/best-practices-for-a-pragmatic-restful-api ","title":"Spring security CORS Filter","body":"<ol>\n<li><p>You don't need:</p>\n\n<pre><code>@Configuration\n@ComponentScan(\"com.company.praktikant\")\n</code></pre>\n\n<p><code>@EnableWebSecurity</code> already has  <code>@Configuration</code> in it, and I cannot imagine why you put <code>@ComponentScan</code> there.</p></li>\n<li><p>About CORS filter, I would just put this:</p>\n\n<pre><code>@Bean\npublic FilterRegistrationBean corsFilter() {\n    UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n    CorsConfiguration config = new CorsConfiguration();\n    config.setAllowCredentials(true);\n    config.addAllowedOrigin(\"*\");\n    config.addAllowedHeader(\"*\");\n    config.addAllowedMethod(\"*\");\n    source.registerCorsConfiguration(\"/**\", config);\n    FilterRegistrationBean bean = new FilterRegistrationBean(new CorsFilter(source));\n    bean.setOrder(0); \n    return bean;\n}\n</code></pre>\n\n<p>Into SecurityConfiguration class and remove configure and configure global methods. You don't need to set allowde orgins, headers and methods twice. Especially if you put different properties in filter and spring security config :)</p></li>\n<li><p>According to above, your \"MyFilter\" class is redundant.</p></li>\n<li><p>You can also remove those:</p>\n\n<pre><code>final AnnotationConfigApplicationContext annotationConfigApplicationContext = new AnnotationConfigApplicationContext();\nannotationConfigApplicationContext.register(CORSConfig.class);\nannotationConfigApplicationContext.refresh();\n</code></pre>\n\n<p>From Application class.</p></li>\n<li><p>At the end small advice - not connected to the question. You don't want to put verbs in URI. Instead of <code>http://localhost:8080/getKunden</code> you should use HTTP GET method on <code>http://localhost:8080/kunden</code> resource. You can learn about best practices for design RESTful api here: <a href=\"http://www.vinaysahni.com/best-practices-for-a-pragmatic-restful-api\" rel=\"nofollow noreferrer\">http://www.vinaysahni.com/best-practices-for-a-pragmatic-restful-api</a> </p></li>\n</ol>\n"},{"tags":[],"owner":{"account_id":5294228,"reputation":1902,"user_id":4225803,"accept_rate":75,"display_name":"Alex Fernandez"},"down_vote_count":1,"up_vote_count":5,"is_accepted":false,"score":4,"last_activity_date":1605746161,"creation_date":1478252087,"answer_id":40419273,"question_id":40418441,"body_markdown":"In my case, I just added this class and use `@EnableAutConfiguration`:\r\n```java\r\n@Component\r\npublic class SimpleCORSFilter extends GenericFilterBean {\r\n    /**\r\n     * The Logger for this class.\r\n     */\r\n    private final Logger logger = LoggerFactory.getLogger(this.getClass());\r\n\r\n    @Override\r\n    public void doFilter(ServletRequest req, ServletResponse resp,\r\n                         FilterChain chain) throws IOException, ServletException {\r\n        logger.info(&quot;&gt; doFilter&quot;);\r\n\r\n        HttpServletResponse response = (HttpServletResponse) resp;\r\n        response.setHeader(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;);\r\n        response.setHeader(&quot;Access-Control-Allow-Methods&quot;, &quot;POST, PUT, GET, OPTIONS, DELETE&quot;);\r\n        response.setHeader(&quot;Access-Control-Max-Age&quot;, &quot;3600&quot;);\r\n        response.setHeader(&quot;Access-Control-Allow-Headers&quot;, &quot;Authorization, Content-Type&quot;);\r\n        //response.setHeader(&quot;Access-Control-Allow-Credentials&quot;, &quot;true&quot;);\r\n        chain.doFilter(req, resp);\r\n\r\n        logger.info(&quot;&lt; doFilter&quot;);\r\n    }\r\n}\r\n```\r\n","title":"Spring security CORS Filter","body":"<p>In my case, I just added this class and use <code>@EnableAutConfiguration</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Component\npublic class SimpleCORSFilter extends GenericFilterBean {\n    /**\n     * The Logger for this class.\n     */\n    private final Logger logger = LoggerFactory.getLogger(this.getClass());\n\n    @Override\n    public void doFilter(ServletRequest req, ServletResponse resp,\n                         FilterChain chain) throws IOException, ServletException {\n        logger.info(&quot;&gt; doFilter&quot;);\n\n        HttpServletResponse response = (HttpServletResponse) resp;\n        response.setHeader(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;);\n        response.setHeader(&quot;Access-Control-Allow-Methods&quot;, &quot;POST, PUT, GET, OPTIONS, DELETE&quot;);\n        response.setHeader(&quot;Access-Control-Max-Age&quot;, &quot;3600&quot;);\n        response.setHeader(&quot;Access-Control-Allow-Headers&quot;, &quot;Authorization, Content-Type&quot;);\n        //response.setHeader(&quot;Access-Control-Allow-Credentials&quot;, &quot;true&quot;);\n        chain.doFilter(req, resp);\n\n        logger.info(&quot;&lt; doFilter&quot;);\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":9578797,"reputation":1089,"user_id":7113955,"accept_rate":50,"display_name":"Mace"},"down_vote_count":1,"up_vote_count":33,"is_accepted":true,"score":32,"last_activity_date":1605632613,"creation_date":1478254147,"answer_id":40419969,"question_id":40418441,"body_markdown":"Ok, after over 2 days of searching we finally fixed the problem. We deleted all our filter and configurations and instead used this 5 lines of code in the application class.\r\n```java\r\n@SpringBootApplication\r\npublic class Application {\r\n    public static void main(String[] args) {\r\n        final ApplicationContext ctx = SpringApplication.run(Application.class, args);\r\n    }\r\n\r\n    @Bean\r\n    public WebMvcConfigurer corsConfigurer() {\r\n        return new WebMvcConfigurerAdapter() {\r\n            @Override\r\n            public void addCorsMappings(CorsRegistry registry) {\r\n                registry.addMapping(&quot;/**&quot;).allowedOrigins(&quot;http://localhost:3000&quot;);\r\n            }\r\n        };\r\n    }\r\n}\r\n```\r\n","title":"Spring security CORS Filter","body":"<p>Ok, after over 2 days of searching we finally fixed the problem. We deleted all our filter and configurations and instead used this 5 lines of code in the application class.</p>\n<pre class=\"lang-java prettyprint-override\"><code>@SpringBootApplication\npublic class Application {\n    public static void main(String[] args) {\n        final ApplicationContext ctx = SpringApplication.run(Application.class, args);\n    }\n\n    @Bean\n    public WebMvcConfigurer corsConfigurer() {\n        return new WebMvcConfigurerAdapter() {\n            @Override\n            public void addCorsMappings(CorsRegistry registry) {\n                registry.addMapping(&quot;/**&quot;).allowedOrigins(&quot;http://localhost:3000&quot;);\n            }\n        };\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":42068,"reputation":20631,"user_id":122441,"accept_rate":70,"display_name":"Hendy Irawan"},"down_vote_count":1,"up_vote_count":124,"is_accepted":false,"score":123,"last_activity_date":1492866137,"creation_date":1492864553,"answer_id":43559288,"question_id":40418441,"body_markdown":"Since Spring Security 4.1, this is the proper way to make Spring Security support CORS (also needed in Spring Boot 1.4/1.5):\r\n\r\n    @Configuration\r\n    public class WebConfig extends WebMvcConfigurerAdapter {\r\n    \r\n        @Override\r\n        public void addCorsMappings(CorsRegistry registry) {\r\n            registry.addMapping(&quot;/**&quot;)\r\n                    .allowedMethods(&quot;HEAD&quot;, &quot;GET&quot;, &quot;PUT&quot;, &quot;POST&quot;, &quot;DELETE&quot;, &quot;PATCH&quot;);\r\n        }\r\n    }\r\n\r\nand:\r\n\r\n    @Configuration\r\n    public class SecurityConfig extends WebSecurityConfigurerAdapter {\r\n        @Override\r\n        protected void configure(HttpSecurity http) throws Exception {\r\n    //        http.csrf().disable();\r\n            http.cors();\r\n        }\r\n    \r\n        @Bean\r\n        public CorsConfigurationSource corsConfigurationSource() {\r\n            final CorsConfiguration configuration = new CorsConfiguration();\r\n            configuration.setAllowedOrigins(ImmutableList.of(&quot;*&quot;));\r\n            configuration.setAllowedMethods(ImmutableList.of(&quot;HEAD&quot;,\r\n                    &quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;DELETE&quot;, &quot;PATCH&quot;));\r\n            // setAllowCredentials(true) is important, otherwise:\r\n            // The value of the &#39;Access-Control-Allow-Origin&#39; header in the response must not be the wildcard &#39;*&#39; when the request&#39;s credentials mode is &#39;include&#39;.\r\n            configuration.setAllowCredentials(true);\r\n            // setAllowedHeaders is important! Without it, OPTIONS preflight request\r\n            // will fail with 403 Invalid CORS request\r\n            configuration.setAllowedHeaders(ImmutableList.of(&quot;Authorization&quot;, &quot;Cache-Control&quot;, &quot;Content-Type&quot;));\r\n            final UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\r\n            source.registerCorsConfiguration(&quot;/**&quot;, configuration);\r\n            return source;\r\n        }\r\n    }\r\n\r\nDo _not_ do any of below, which are the wrong way to attempt solving the problem:\r\n\r\n* `http.authorizeRequests().antMatchers(HttpMethod.OPTIONS, &quot;/**&quot;).permitAll();`\r\n* `web.ignoring().antMatchers(HttpMethod.OPTIONS);`\r\n\r\nReference: http://docs.spring.io/spring-security/site/docs/4.2.x/reference/html/cors.html\r\n","title":"Spring security CORS Filter","body":"<p>Since Spring Security 4.1, this is the proper way to make Spring Security support CORS (also needed in Spring Boot 1.4/1.5):</p>\n\n<pre><code>@Configuration\npublic class WebConfig extends WebMvcConfigurerAdapter {\n\n    @Override\n    public void addCorsMappings(CorsRegistry registry) {\n        registry.addMapping(\"/**\")\n                .allowedMethods(\"HEAD\", \"GET\", \"PUT\", \"POST\", \"DELETE\", \"PATCH\");\n    }\n}\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>@Configuration\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n//        http.csrf().disable();\n        http.cors();\n    }\n\n    @Bean\n    public CorsConfigurationSource corsConfigurationSource() {\n        final CorsConfiguration configuration = new CorsConfiguration();\n        configuration.setAllowedOrigins(ImmutableList.of(\"*\"));\n        configuration.setAllowedMethods(ImmutableList.of(\"HEAD\",\n                \"GET\", \"POST\", \"PUT\", \"DELETE\", \"PATCH\"));\n        // setAllowCredentials(true) is important, otherwise:\n        // The value of the 'Access-Control-Allow-Origin' header in the response must not be the wildcard '*' when the request's credentials mode is 'include'.\n        configuration.setAllowCredentials(true);\n        // setAllowedHeaders is important! Without it, OPTIONS preflight request\n        // will fail with 403 Invalid CORS request\n        configuration.setAllowedHeaders(ImmutableList.of(\"Authorization\", \"Cache-Control\", \"Content-Type\"));\n        final UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n        source.registerCorsConfiguration(\"/**\", configuration);\n        return source;\n    }\n}\n</code></pre>\n\n<p>Do <em>not</em> do any of below, which are the wrong way to attempt solving the problem:</p>\n\n<ul>\n<li><code>http.authorizeRequests().antMatchers(HttpMethod.OPTIONS, \"/**\").permitAll();</code></li>\n<li><code>web.ignoring().antMatchers(HttpMethod.OPTIONS);</code></li>\n</ul>\n\n<p>Reference: <a href=\"http://docs.spring.io/spring-security/site/docs/4.2.x/reference/html/cors.html\" rel=\"noreferrer\">http://docs.spring.io/spring-security/site/docs/4.2.x/reference/html/cors.html</a></p>\n"},{"tags":[],"owner":{"account_id":3117470,"reputation":336,"user_id":2637940,"display_name":"David Eibensteiner"},"down_vote_count":0,"up_vote_count":29,"is_accepted":false,"score":29,"last_activity_date":1551792135,"creation_date":1509011465,"answer_id":46951171,"question_id":40418441,"body_markdown":"Since i had problems with the other solutions (especially to get it working in all browsers, for example edge doesn&#39;t recognize &quot;*&quot; as a valid value for &quot;Access-Control-Allow-Methods&quot;), i had to use a custom filter component, which in the end worked for me and did exactly what i wanted to achieve.\r\n\r\n\r\n\r\n    @Component\r\n    @Order(Ordered.HIGHEST_PRECEDENCE)\r\n    public class CorsFilter implements Filter {\r\n        public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain)\r\n                throws IOException, ServletException {\r\n            HttpServletResponse response = (HttpServletResponse) res;\r\n            HttpServletRequest request = (HttpServletRequest) req;\r\n            response.setHeader(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;);\r\n            response.setHeader(&quot;Access-Control-Allow-Credentials&quot;, &quot;true&quot;);\r\n            response.setHeader(&quot;Access-Control-Allow-Methods&quot;,\r\n                    &quot;ACL, CANCELUPLOAD, CHECKIN, CHECKOUT, COPY, DELETE, GET, HEAD, LOCK, MKCALENDAR, MKCOL, MOVE, OPTIONS, POST, PROPFIND, PROPPATCH, PUT, REPORT, SEARCH, UNCHECKOUT, UNLOCK, UPDATE, VERSION-CONTROL&quot;);\r\n            response.setHeader(&quot;Access-Control-Max-Age&quot;, &quot;3600&quot;);\r\n            response.setHeader(&quot;Access-Control-Allow-Headers&quot;,\r\n                    &quot;Origin, X-Requested-With, Content-Type, Accept, Key, Authorization&quot;);\r\n    \r\n            if (&quot;OPTIONS&quot;.equalsIgnoreCase(request.getMethod())) {\r\n                response.setStatus(HttpServletResponse.SC_OK);\r\n            } else {\r\n                chain.doFilter(req, res);\r\n            }\r\n        }\r\n    \r\n        public void init(FilterConfig filterConfig) {\r\n            // not needed\r\n        }\r\n    \r\n        public void destroy() {\r\n            //not needed\r\n        }\r\n    \r\n    }","title":"Spring security CORS Filter","body":"<p>Since i had problems with the other solutions (especially to get it working in all browsers, for example edge doesn't recognize \"*\" as a valid value for \"Access-Control-Allow-Methods\"), i had to use a custom filter component, which in the end worked for me and did exactly what i wanted to achieve.</p>\n\n<pre><code>@Component\n@Order(Ordered.HIGHEST_PRECEDENCE)\npublic class CorsFilter implements Filter {\n    public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain)\n            throws IOException, ServletException {\n        HttpServletResponse response = (HttpServletResponse) res;\n        HttpServletRequest request = (HttpServletRequest) req;\n        response.setHeader(\"Access-Control-Allow-Origin\", \"*\");\n        response.setHeader(\"Access-Control-Allow-Credentials\", \"true\");\n        response.setHeader(\"Access-Control-Allow-Methods\",\n                \"ACL, CANCELUPLOAD, CHECKIN, CHECKOUT, COPY, DELETE, GET, HEAD, LOCK, MKCALENDAR, MKCOL, MOVE, OPTIONS, POST, PROPFIND, PROPPATCH, PUT, REPORT, SEARCH, UNCHECKOUT, UNLOCK, UPDATE, VERSION-CONTROL\");\n        response.setHeader(\"Access-Control-Max-Age\", \"3600\");\n        response.setHeader(\"Access-Control-Allow-Headers\",\n                \"Origin, X-Requested-With, Content-Type, Accept, Key, Authorization\");\n\n        if (\"OPTIONS\".equalsIgnoreCase(request.getMethod())) {\n            response.setStatus(HttpServletResponse.SC_OK);\n        } else {\n            chain.doFilter(req, res);\n        }\n    }\n\n    public void init(FilterConfig filterConfig) {\n        // not needed\n    }\n\n    public void destroy() {\n        //not needed\n    }\n\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":3187759,"reputation":3112,"user_id":2692914,"accept_rate":93,"display_name":"lmiguelmh"},"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1605696013,"creation_date":1509484136,"answer_id":47044574,"question_id":40418441,"body_markdown":"According the [CORS filter documentation][1]:\r\n\r\n&gt; &quot;Spring MVC provides fine-grained support for CORS configuration\r\n&gt; through annotations on controllers. However **when used with Spring\r\n&gt; Security it is advisable to rely on the built-in CorsFilter** that must\r\n&gt; be ordered ahead of Spring Securitys chain of filters&quot;\r\n\r\nSomething like this will allow `GET` access to the `/ajaxUri`:\r\n    \r\n    @Component\r\n    @Order(Ordered.HIGHEST_PRECEDENCE)\r\n    public class AjaxCorsFilter extends CorsFilter {\r\n        public AjaxCorsFilter() {\r\n            super(configurationSource());\r\n        }\r\n    \r\n        private static UrlBasedCorsConfigurationSource configurationSource() {\r\n            CorsConfiguration config = new CorsConfiguration();\r\n    \r\n            // origins\r\n            config.addAllowedOrigin(&quot;*&quot;);\r\n    \r\n            // when using ajax: withCredentials: true, we require exact origin match\r\n            config.setAllowCredentials(true);\r\n    \r\n            // headers\r\n            config.addAllowedHeader(&quot;x-requested-with&quot;);\r\n    \r\n            // methods\r\n            config.addAllowedMethod(HttpMethod.OPTIONS);\r\n            config.addAllowedMethod(HttpMethod.GET);\r\n    \r\n            UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\r\n            source.registerCorsConfiguration(&quot;/startAsyncAuthorize&quot;, config);\r\n            source.registerCorsConfiguration(&quot;/ajaxUri&quot;, config);\r\n            return source;\r\n        }\r\n    }\r\n\r\nOf course, your SpringSecurity configuration must allow access to the URI with the listed methods. See @Hendy Irawan answer.\r\n\r\n  [1]: https://docs.spring.io/spring/docs/current/spring-framework-reference/web.html#filters-cors","title":"Spring security CORS Filter","body":"<p>According the <a href=\"https://docs.spring.io/spring/docs/current/spring-framework-reference/web.html#filters-cors\" rel=\"nofollow noreferrer\">CORS filter documentation</a>:</p>\n<blockquote>\n<p>&quot;Spring MVC provides fine-grained support for CORS configuration\nthrough annotations on controllers. However <strong>when used with Spring\nSecurity it is advisable to rely on the built-in CorsFilter</strong> that must\nbe ordered ahead of Spring Securitys chain of filters&quot;</p>\n</blockquote>\n<p>Something like this will allow <code>GET</code> access to the <code>/ajaxUri</code>:</p>\n<pre><code>@Component\n@Order(Ordered.HIGHEST_PRECEDENCE)\npublic class AjaxCorsFilter extends CorsFilter {\n    public AjaxCorsFilter() {\n        super(configurationSource());\n    }\n\n    private static UrlBasedCorsConfigurationSource configurationSource() {\n        CorsConfiguration config = new CorsConfiguration();\n\n        // origins\n        config.addAllowedOrigin(&quot;*&quot;);\n\n        // when using ajax: withCredentials: true, we require exact origin match\n        config.setAllowCredentials(true);\n\n        // headers\n        config.addAllowedHeader(&quot;x-requested-with&quot;);\n\n        // methods\n        config.addAllowedMethod(HttpMethod.OPTIONS);\n        config.addAllowedMethod(HttpMethod.GET);\n\n        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n        source.registerCorsConfiguration(&quot;/startAsyncAuthorize&quot;, config);\n        source.registerCorsConfiguration(&quot;/ajaxUri&quot;, config);\n        return source;\n    }\n}\n</code></pre>\n<p>Of course, your SpringSecurity configuration must allow access to the URI with the listed methods. See @Hendy Irawan answer.</p>\n"},{"tags":[],"owner":{"account_id":7301500,"reputation":129,"user_id":5564064,"display_name":"Garik Kalashyan"},"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1537267745,"creation_date":1537262751,"answer_id":52383283,"question_id":40418441,"body_markdown":"In many places, I see the answer that needs to add this code:   \r\n\r\n    @Bean\r\n    public FilterRegistrationBean corsFilter() {\r\n       UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\r\n       CorsConfiguration config = new CorsConfiguration();\r\n       config.setAllowCredentials(true);\r\n       config.addAllowedOrigin(&quot;*&quot;);\r\n       config.addAllowedHeader(&quot;*&quot;);\r\n       config.addAllowedMethod(&quot;*&quot;);\r\n       source.registerCorsConfiguration(&quot;/**&quot;, config);\r\n       FilterRegistrationBean bean = new FilterRegistrationBean(new CorsFilter(source));\r\n       bean.setOrder(0); \r\n       return bean;\r\n    }\r\n\r\nbut in my case, it throws an unexpected class type exception. `corsFilter()` bean requires `CorsFilter` type, so I have done this changes and put this definition of bean in my config and all is OK now.\r\n\r\n    @Bean\r\n    public CorsFilter corsFilter() {\r\n        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\r\n        CorsConfiguration config = new CorsConfiguration();\r\n        config.setAllowCredentials(true);\r\n        config.addAllowedOrigin(&quot;*&quot;);\r\n        config.addAllowedHeader(&quot;*&quot;);\r\n        config.addAllowedMethod(&quot;*&quot;);\r\n        source.registerCorsConfiguration(&quot;/**&quot;, config);\r\n        return new CorsFilter(source);\r\n    }","title":"Spring security CORS Filter","body":"<p>In many places, I see the answer that needs to add this code:   </p>\n\n<pre><code>@Bean\npublic FilterRegistrationBean corsFilter() {\n   UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n   CorsConfiguration config = new CorsConfiguration();\n   config.setAllowCredentials(true);\n   config.addAllowedOrigin(\"*\");\n   config.addAllowedHeader(\"*\");\n   config.addAllowedMethod(\"*\");\n   source.registerCorsConfiguration(\"/**\", config);\n   FilterRegistrationBean bean = new FilterRegistrationBean(new CorsFilter(source));\n   bean.setOrder(0); \n   return bean;\n}\n</code></pre>\n\n<p>but in my case, it throws an unexpected class type exception. <code>corsFilter()</code> bean requires <code>CorsFilter</code> type, so I have done this changes and put this definition of bean in my config and all is OK now.</p>\n\n<pre><code>@Bean\npublic CorsFilter corsFilter() {\n    UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n    CorsConfiguration config = new CorsConfiguration();\n    config.setAllowCredentials(true);\n    config.addAllowedOrigin(\"*\");\n    config.addAllowedHeader(\"*\");\n    config.addAllowedMethod(\"*\");\n    source.registerCorsConfiguration(\"/**\", config);\n    return new CorsFilter(source);\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":263115,"reputation":16950,"user_id":548473,"display_name":"Grigory Kislin"},"down_vote_count":0,"up_vote_count":16,"is_accepted":false,"score":16,"last_activity_date":1564249297,"creation_date":1553115411,"answer_id":55270051,"question_id":40418441,"body_markdown":"With Spring Security in Spring Boot 2 to configure CORS globally (e.g. enabled all request for development) you can do:\r\n\r\n    @Bean\r\n    protected CorsConfigurationSource corsConfigurationSource() {\r\n        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\r\n        source.registerCorsConfiguration(&quot;/**&quot;, new CorsConfiguration().applyPermitDefaultValues());\r\n        return source;\r\n    }\r\n\r\n    @Override\r\n    protected void configure(HttpSecurity http) throws Exception {\r\n        http.cors()\r\n                .and().authorizeRequests()\r\n                .anyRequest().permitAll()\r\n                .and().csrf().disable();\r\n    }\r\n","title":"Spring security CORS Filter","body":"<p>With Spring Security in Spring Boot 2 to configure CORS globally (e.g. enabled all request for development) you can do:</p>\n\n<pre><code>@Bean\nprotected CorsConfigurationSource corsConfigurationSource() {\n    UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n    source.registerCorsConfiguration(\"/**\", new CorsConfiguration().applyPermitDefaultValues());\n    return source;\n}\n\n@Override\nprotected void configure(HttpSecurity http) throws Exception {\n    http.cors()\n            .and().authorizeRequests()\n            .anyRequest().permitAll()\n            .and().csrf().disable();\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4924982,"reputation":907,"user_id":3966452,"accept_rate":57,"display_name":"mljohns89"},"down_vote_count":0,"up_vote_count":18,"is_accepted":false,"score":18,"last_activity_date":1576161601,"creation_date":1576161601,"answer_id":59306983,"question_id":40418441,"body_markdown":"There&#39;s 8 hours of my life I will never get back...\r\n\r\nMake sure that you set both Exposed Headers AND Allowed Headers in your CorsConfiguration\r\n\r\n    @Bean\r\n    CorsConfigurationSource corsConfigurationSource() {\r\n        CorsConfiguration configuration = new CorsConfiguration();\r\n        configuration.setAllowedOrigins(Collections.singletonList(&quot;http://localhost:3000&quot;));\r\n        configuration.setAllowedMethods(Arrays.asList(&quot;GET&quot;,&quot;POST&quot;, &quot;PUT&quot;, &quot;DELETE&quot;, &quot;PATCH&quot;, &quot;OPTIONS&quot;));\r\n        configuration.setExposedHeaders(Arrays.asList(&quot;Authorization&quot;, &quot;content-type&quot;));\r\n        configuration.setAllowedHeaders(Arrays.asList(&quot;Authorization&quot;, &quot;content-type&quot;));\r\n        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\r\n        source.registerCorsConfiguration(&quot;/**&quot;, configuration);\r\n        return source;\r\n    }","title":"Spring security CORS Filter","body":"<p>There's 8 hours of my life I will never get back...</p>\n\n<p>Make sure that you set both Exposed Headers AND Allowed Headers in your CorsConfiguration</p>\n\n<pre><code>@Bean\nCorsConfigurationSource corsConfigurationSource() {\n    CorsConfiguration configuration = new CorsConfiguration();\n    configuration.setAllowedOrigins(Collections.singletonList(\"http://localhost:3000\"));\n    configuration.setAllowedMethods(Arrays.asList(\"GET\",\"POST\", \"PUT\", \"DELETE\", \"PATCH\", \"OPTIONS\"));\n    configuration.setExposedHeaders(Arrays.asList(\"Authorization\", \"content-type\"));\n    configuration.setAllowedHeaders(Arrays.asList(\"Authorization\", \"content-type\"));\n    UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n    source.registerCorsConfiguration(\"/**\", configuration);\n    return source;\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":6882690,"reputation":141,"user_id":5288918,"display_name":"Theo Dury"},"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1585232888,"creation_date":1585232888,"answer_id":60869534,"question_id":40418441,"body_markdown":"This solution unlock me after couple of hours of research  : \r\n\r\nIn the configuration initialize the core() option\r\n\r\n    @Override\r\n    public void configure(HttpSecurity http) throws Exception {\r\n    http\r\n        .cors()\r\n        .and()\r\n        .etc\r\n    }\r\n\r\n\r\nInitialize your Credential, Origin, Header and Method as your wish in the corsFilter.\r\n\r\n    @Bean\r\n    public CorsFilter corsFilter() {\r\n      UrlBasedCorsConfigurationSource source = new \r\n      UrlBasedCorsConfigurationSource();\r\n      CorsConfiguration config = new CorsConfiguration();\r\n      config.setAllowCredentials(true);\r\n      config.addAllowedOrigin(&quot;*&quot;);\r\n      config.addAllowedHeader(&quot;*&quot;);\r\n      config.addAllowedMethod(&quot;*&quot;);\r\n      source.registerCorsConfiguration(&quot;/**&quot;, config);\r\n      return new CorsFilter(source);\r\n    }\r\n\r\n\r\nI didn&#39;t need to use this class: \r\n\r\n    @Bean\r\n    public CorsConfigurationSource corsConfigurationSource() {\r\n    }","title":"Spring security CORS Filter","body":"<p>This solution unlock me after couple of hours of research  : </p>\n\n<p>In the configuration initialize the core() option</p>\n\n<pre><code>@Override\npublic void configure(HttpSecurity http) throws Exception {\nhttp\n    .cors()\n    .and()\n    .etc\n}\n</code></pre>\n\n<p>Initialize your Credential, Origin, Header and Method as your wish in the corsFilter.</p>\n\n<pre><code>@Bean\npublic CorsFilter corsFilter() {\n  UrlBasedCorsConfigurationSource source = new \n  UrlBasedCorsConfigurationSource();\n  CorsConfiguration config = new CorsConfiguration();\n  config.setAllowCredentials(true);\n  config.addAllowedOrigin(\"*\");\n  config.addAllowedHeader(\"*\");\n  config.addAllowedMethod(\"*\");\n  source.registerCorsConfiguration(\"/**\", config);\n  return new CorsFilter(source);\n}\n</code></pre>\n\n<p>I didn't need to use this class: </p>\n\n<pre><code>@Bean\npublic CorsConfigurationSource corsConfigurationSource() {\n}\n</code></pre>\n"},{"tags":[],"owner":{"display_name":"user11141611"},"down_vote_count":0,"up_vote_count":7,"is_accepted":false,"score":7,"last_activity_date":1605516868,"creation_date":1587600645,"answer_id":61377195,"question_id":40418441,"body_markdown":"Class [`WebMvcConfigurerAdapter`][1] is deprecated as of 5.0 [`WebMvcConfigurer`][2] has default methods and can be implemented directly without the need for this adapter. For this case:\r\n```java\r\n@Configuration\r\n@EnableWebMvc\r\npublic class WebMvcConfig implements WebMvcConfigurer {\r\n    @Override\r\n    public void addCorsMappings(CorsRegistry registry) {\r\n        registry.addMapping(&quot;/**&quot;).allowedOrigins(&quot;http://localhost:3000&quot;);\r\n    }\r\n}\r\n```\r\n\r\n---\r\n\r\nSee also: [Same-Site flag for session cookie][3]\r\n\r\n\r\n  [1]: https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/servlet/config/annotation/WebMvcConfigurerAdapter.html\r\n  [2]: https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/servlet/config/annotation/WebMvcConfigurer.html\r\n  [3]: https://stackoverflow.com/a/64128734/11141611","title":"Spring security CORS Filter","body":"<p>Class <a href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/servlet/config/annotation/WebMvcConfigurerAdapter.html\" rel=\"noreferrer\"><code>WebMvcConfigurerAdapter</code></a> is deprecated as of 5.0 <a href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/servlet/config/annotation/WebMvcConfigurer.html\" rel=\"noreferrer\"><code>WebMvcConfigurer</code></a> has default methods and can be implemented directly without the need for this adapter. For this case:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Configuration\n@EnableWebMvc\npublic class WebMvcConfig implements WebMvcConfigurer {\n    @Override\n    public void addCorsMappings(CorsRegistry registry) {\n        registry.addMapping(&quot;/**&quot;).allowedOrigins(&quot;http://localhost:3000&quot;);\n    }\n}\n</code></pre>\n<hr />\n<p>See also: <a href=\"https://stackoverflow.com/a/64128734/11141611\">Same-Site flag for session cookie</a></p>\n"},{"tags":[],"owner":{"account_id":19787972,"reputation":1,"user_id":14491550,"display_name":"Green Bud"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1605681785,"creation_date":1603273233,"answer_id":64460812,"question_id":40418441,"body_markdown":"I had a similar problem but with the specific requirement to have the CORS header set from decorators in our endpoints, like this:\r\n```java\r\n@CrossOrigin(origins = &quot;*&quot;, allowCredentials = &quot;true&quot;)\r\n@PostMapping(value = &quot;/login&quot;)\r\n```\r\nOr\r\n```java\r\n@CrossOrigin(origins = &quot;*&quot;)\r\n@GetMapping(value = &quot;/verificationState&quot;)\r\n```\r\nSo simply intercepting the request, setting the CORS header manually and sending 200 back was not an option, because allowCredentials was needed to be true in some cases and wildcards are not allowed then. Sure, a CORS registry would have helped, but since our clients are angular in capacitor on android and iOS, there is no specific domain to register. So the clean way to do - in my opinion - is to pipe preflights directly to the endpoints to let them handle it. I solved it with this:\r\n```java\r\n@Component\r\npublic class PreflightFilter extends OncePerRequestFilter {\r\n\r\n    private static final Logger logger = LoggerFactory.getLogger(PreflightFilter.class);\r\n\r\n    @Override\r\n    protected void doFilterInternal(HttpServletRequest request,\r\n                                    HttpServletResponse response, FilterChain chain)\r\n            throws ServletException, IOException {\r\n\r\n        if (CorsUtils.isPreFlightRequest(request)) {\r\n            logger.info(&quot;Preflight request accepted&quot;);\r\n            SecurityContextHolder.getContext().setAuthentication(createPreflightToken(request));\r\n        }\r\n        chain.doFilter(request, response);\r\n    }\r\n\r\n    private UsernamePasswordAuthenticationToken createPreflightToken(HttpServletRequest request) {\r\n        UserDetails userDetails = new User(&quot;Preflight&quot;, &quot;&quot;,\r\n                true, true, true, true,\r\n                Stream.of(new SimpleGrantedAuthority(&quot;AppUser&quot;)).collect(Collectors.toSet()));\r\n        UsernamePasswordAuthenticationToken preflightToken =\r\n                new UsernamePasswordAuthenticationToken(\r\n                        userDetails, null, userDetails.getAuthorities());\r\n        preflightToken\r\n                .setDetails(new WebAuthenticationDetailsSource().buildDetails(request));\r\n        return preflightToken;\r\n    }\r\n}\r\n```\r\nKeep in mind that the endpoint decorators don&#39;t work like wildcards here as one would expect!\r\n","title":"Spring security CORS Filter","body":"<p>I had a similar problem but with the specific requirement to have the CORS header set from decorators in our endpoints, like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@CrossOrigin(origins = &quot;*&quot;, allowCredentials = &quot;true&quot;)\n@PostMapping(value = &quot;/login&quot;)\n</code></pre>\n<p>Or</p>\n<pre class=\"lang-java prettyprint-override\"><code>@CrossOrigin(origins = &quot;*&quot;)\n@GetMapping(value = &quot;/verificationState&quot;)\n</code></pre>\n<p>So simply intercepting the request, setting the CORS header manually and sending 200 back was not an option, because allowCredentials was needed to be true in some cases and wildcards are not allowed then. Sure, a CORS registry would have helped, but since our clients are angular in capacitor on android and iOS, there is no specific domain to register. So the clean way to do - in my opinion - is to pipe preflights directly to the endpoints to let them handle it. I solved it with this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Component\npublic class PreflightFilter extends OncePerRequestFilter {\n\n    private static final Logger logger = LoggerFactory.getLogger(PreflightFilter.class);\n\n    @Override\n    protected void doFilterInternal(HttpServletRequest request,\n                                    HttpServletResponse response, FilterChain chain)\n            throws ServletException, IOException {\n\n        if (CorsUtils.isPreFlightRequest(request)) {\n            logger.info(&quot;Preflight request accepted&quot;);\n            SecurityContextHolder.getContext().setAuthentication(createPreflightToken(request));\n        }\n        chain.doFilter(request, response);\n    }\n\n    private UsernamePasswordAuthenticationToken createPreflightToken(HttpServletRequest request) {\n        UserDetails userDetails = new User(&quot;Preflight&quot;, &quot;&quot;,\n                true, true, true, true,\n                Stream.of(new SimpleGrantedAuthority(&quot;AppUser&quot;)).collect(Collectors.toSet()));\n        UsernamePasswordAuthenticationToken preflightToken =\n                new UsernamePasswordAuthenticationToken(\n                        userDetails, null, userDetails.getAuthorities());\n        preflightToken\n                .setDetails(new WebAuthenticationDetailsSource().buildDetails(request));\n        return preflightToken;\n    }\n}\n</code></pre>\n<p>Keep in mind that the endpoint decorators don't work like wildcards here as one would expect!</p>\n"},{"tags":[],"owner":{"account_id":3205334,"reputation":51,"user_id":2706465,"display_name":"Nandom Gusen"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1605681770,"creation_date":1605011831,"answer_id":64769087,"question_id":40418441,"body_markdown":"With SpringBoot 2 Spring Security, The code below perfectly resolved Cors issues\r\n```java\r\n@Bean\r\npublic CorsConfigurationSource corsConfigurationSource() {\r\n    CorsConfiguration configuration = new CorsConfiguration();\r\n    configuration.setAllowedOrigins(Collections.singletonList(&quot;*&quot;)); // &lt;-- you may change &quot;*&quot;\r\n    configuration.setAllowedMethods(Arrays.asList(&quot;HEAD&quot;, &quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;DELETE&quot;, &quot;PATCH&quot;));\r\n    configuration.setAllowCredentials(true);\r\n    configuration.setAllowedHeaders(Arrays.asList(\r\n            &quot;Accept&quot;, &quot;Origin&quot;, &quot;Content-Type&quot;, &quot;Depth&quot;, &quot;User-Agent&quot;, &quot;If-Modified-Since,&quot;,\r\n            &quot;Cache-Control&quot;, &quot;Authorization&quot;, &quot;X-Req&quot;, &quot;X-File-Size&quot;, &quot;X-Requested-With&quot;, &quot;X-File-Name&quot;));\r\n    UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\r\n    source.registerCorsConfiguration(&quot;/**&quot;, configuration);\r\n    return source;\r\n}\r\n\r\n@Bean\r\npublic FilterRegistrationBean&lt;CorsFilter&gt; corsFilterRegistrationBean() {\r\n    FilterRegistrationBean&lt;CorsFilter&gt; bean = new FilterRegistrationBean&lt;&gt;(new CorsFilter(corsConfigurationSource()));\r\n    bean.setOrder(Ordered.HIGHEST_PRECEDENCE);\r\n    return bean;\r\n}\r\n```\r\n\r\nThen for the WebSecurity Configuration, I added this\r\n```java\r\n@Override\r\nprotected void configure(HttpSecurity http) throws Exception {\r\n    http.headers().frameOptions().disable()\r\n            .and()\r\n            .authorizeRequests()\r\n            .antMatchers(&quot;/oauth/tokeen&quot;).permitAll()\r\n            .antMatchers(HttpMethod.GET, &quot;/&quot;).permitAll()\r\n            .antMatchers(HttpMethod.POST, &quot;/&quot;).permitAll()\r\n            .antMatchers(HttpMethod.PUT, &quot;/&quot;).permitAll()\r\n            .antMatchers(HttpMethod.DELETE, &quot;/**&quot;).permitAll()\r\n            .antMatchers(HttpMethod.OPTIONS, &quot;*&quot;).permitAll()\r\n            .anyRequest().authenticated()\r\n            .and().cors().configurationSource(corsConfigurationSource());\r\n}\r\n```\r\n","title":"Spring security CORS Filter","body":"<p>With SpringBoot 2 Spring Security, The code below perfectly resolved Cors issues</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Bean\npublic CorsConfigurationSource corsConfigurationSource() {\n    CorsConfiguration configuration = new CorsConfiguration();\n    configuration.setAllowedOrigins(Collections.singletonList(&quot;*&quot;)); // &lt;-- you may change &quot;*&quot;\n    configuration.setAllowedMethods(Arrays.asList(&quot;HEAD&quot;, &quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;DELETE&quot;, &quot;PATCH&quot;));\n    configuration.setAllowCredentials(true);\n    configuration.setAllowedHeaders(Arrays.asList(\n            &quot;Accept&quot;, &quot;Origin&quot;, &quot;Content-Type&quot;, &quot;Depth&quot;, &quot;User-Agent&quot;, &quot;If-Modified-Since,&quot;,\n            &quot;Cache-Control&quot;, &quot;Authorization&quot;, &quot;X-Req&quot;, &quot;X-File-Size&quot;, &quot;X-Requested-With&quot;, &quot;X-File-Name&quot;));\n    UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n    source.registerCorsConfiguration(&quot;/**&quot;, configuration);\n    return source;\n}\n\n@Bean\npublic FilterRegistrationBean&lt;CorsFilter&gt; corsFilterRegistrationBean() {\n    FilterRegistrationBean&lt;CorsFilter&gt; bean = new FilterRegistrationBean&lt;&gt;(new CorsFilter(corsConfigurationSource()));\n    bean.setOrder(Ordered.HIGHEST_PRECEDENCE);\n    return bean;\n}\n</code></pre>\n<p>Then for the WebSecurity Configuration, I added this</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Override\nprotected void configure(HttpSecurity http) throws Exception {\n    http.headers().frameOptions().disable()\n            .and()\n            .authorizeRequests()\n            .antMatchers(&quot;/oauth/tokeen&quot;).permitAll()\n            .antMatchers(HttpMethod.GET, &quot;/&quot;).permitAll()\n            .antMatchers(HttpMethod.POST, &quot;/&quot;).permitAll()\n            .antMatchers(HttpMethod.PUT, &quot;/&quot;).permitAll()\n            .antMatchers(HttpMethod.DELETE, &quot;/**&quot;).permitAll()\n            .antMatchers(HttpMethod.OPTIONS, &quot;*&quot;).permitAll()\n            .anyRequest().authenticated()\n            .and().cors().configurationSource(corsConfigurationSource());\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":19376019,"reputation":31,"user_id":14168271,"display_name":"rrain"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1628814367,"creation_date":1628768523,"answer_id":68756823,"question_id":40418441,"body_markdown":"This ALLOWS ANY origin WITH CREDENTIALS for CORS:\r\n\r\n```\r\n@Component\r\npublic class FilterChainConfig implements Filter {\r\n    @Override\r\n    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {\r\n        if (servletResponse instanceof HttpServletResponse){\r\n            HttpServletResponse response = (HttpServletResponse)servletResponse;\r\n            HttpServletRequest request = (HttpServletRequest) servletRequest;\r\n            String requestOrigin = request.getHeader(&quot;Origin&quot;);\r\n            response.setHeader(&quot;Access-Control-Allow-Origin&quot;, requestOrigin);\r\n            response.setHeader(&quot;Access-Control-Allow-Credentials&quot;, &quot;true&quot;);\r\n            //response.setHeader(&quot;Access-Control-Allow-Methods&quot;, &quot;*&quot;);\r\n            response.setHeader(&quot;Access-Control-Allow-Methods&quot;, &quot;GET, POST, DELETE, PUT, OPTIONS, HEAD&quot;);\r\n            response.setHeader(&quot;Access-Control-Max-Age&quot;, &quot;3600&quot;);\r\n            response.setHeader(&quot;Access-Control-Allow-Headers&quot;, &quot;*&quot;);\r\n            filterChain.doFilter(request, response);\r\n        }\r\n    }\r\n}\r\n```","title":"Spring security CORS Filter","body":"<p>This ALLOWS ANY origin WITH CREDENTIALS for CORS:</p>\n<pre><code>@Component\npublic class FilterChainConfig implements Filter {\n    @Override\n    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {\n        if (servletResponse instanceof HttpServletResponse){\n            HttpServletResponse response = (HttpServletResponse)servletResponse;\n            HttpServletRequest request = (HttpServletRequest) servletRequest;\n            String requestOrigin = request.getHeader(&quot;Origin&quot;);\n            response.setHeader(&quot;Access-Control-Allow-Origin&quot;, requestOrigin);\n            response.setHeader(&quot;Access-Control-Allow-Credentials&quot;, &quot;true&quot;);\n            //response.setHeader(&quot;Access-Control-Allow-Methods&quot;, &quot;*&quot;);\n            response.setHeader(&quot;Access-Control-Allow-Methods&quot;, &quot;GET, POST, DELETE, PUT, OPTIONS, HEAD&quot;);\n            response.setHeader(&quot;Access-Control-Max-Age&quot;, &quot;3600&quot;);\n            response.setHeader(&quot;Access-Control-Allow-Headers&quot;, &quot;*&quot;);\n            filterChain.doFilter(request, response);\n        }\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":3620019,"reputation":5321,"user_id":3019006,"accept_rate":68,"display_name":"Deb"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1637775631,"creation_date":1637775631,"answer_id":70100619,"question_id":40418441,"body_markdown":"To enable CORS Globally you need to make changes in two places, if you are also using spring security with boot:\r\n\r\n**1. Spring Boot:**\r\n\r\n    @Configuration\r\n    public class CorsConfiguration extends WebMvcConfigurationSupport {  \r\n        @Override\r\n        public void addCorsMappings(CorsRegistry registry) {\r\n        \tregistry.addMapping(&quot;/**&quot;).allowedOrigins(&quot;*&quot;).allowedMethods(&quot;*&quot;)\r\n        \t.allowCredentials(true);\r\n        }\r\n    }\r\nYou can do the same in `WebMvcConfigurerAdapter`, or create bean of `WebMvcConfigurer`.\r\n\r\n**2. Spring Security**\r\n\r\n    @Override\r\n        protected void configure(HttpSecurity http) throws Exception {\r\n            http.cors().and()\r\n                    .authorizeRequests()\r\n                    .antMatchers(HttpMethod.OPTIONS).permitAll() //Permits your preflight request\r\n    }\r\n\r\nThis enables all methods, all paths and origins. So, use with caution and only in development.\r\nWorks as on Spring Boot 2.3.3.RELEASE","title":"Spring security CORS Filter","body":"<p>To enable CORS Globally you need to make changes in two places, if you are also using spring security with boot:</p>\n<p><strong>1. Spring Boot:</strong></p>\n<pre><code>@Configuration\npublic class CorsConfiguration extends WebMvcConfigurationSupport {  \n    @Override\n    public void addCorsMappings(CorsRegistry registry) {\n        registry.addMapping(&quot;/**&quot;).allowedOrigins(&quot;*&quot;).allowedMethods(&quot;*&quot;)\n        .allowCredentials(true);\n    }\n}\n</code></pre>\n<p>You can do the same in <code>WebMvcConfigurerAdapter</code>, or create bean of <code>WebMvcConfigurer</code>.</p>\n<p><strong>2. Spring Security</strong></p>\n<pre><code>@Override\n    protected void configure(HttpSecurity http) throws Exception {\n        http.cors().and()\n                .authorizeRequests()\n                .antMatchers(HttpMethod.OPTIONS).permitAll() //Permits your preflight request\n}\n</code></pre>\n<p>This enables all methods, all paths and origins. So, use with caution and only in development.\nWorks as on Spring Boot 2.3.3.RELEASE</p>\n"},{"tags":[],"owner":{"account_id":14681960,"reputation":346,"user_id":10603143,"display_name":"Mohsin Ejaz"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641109795,"creation_date":1641109795,"answer_id":70554397,"question_id":40418441,"body_markdown":"    import org.springframework.web.cors.CorsConfiguration;\r\n    import org.springframework.web.cors.CorsConfigurationSource;\r\n    import org.springframework.web.cors.UrlBasedCorsConfigurationSource;\r\n    \r\n        \r\n        public class SecurityConfiguration extends WebSecurityConfigurerAdapter {\r\n        .....  \r\n    \r\n        @Override\r\n        protected void configure(HttpSecurity http) throws Exception {\r\n          http.authorizeRequests().antMatchers(&quot;/api/**&quot;).authenticated().and().httpBasic().and().csrf().disable();\r\n    \r\n        }\r\n        \r\n        @Bean\r\n        protected CorsConfigurationSource corsConfigurationSource() {\r\n            UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\r\n            source.registerCorsConfiguration(&quot;/**&quot;, new CorsConfiguration().applyPermitDefaultValues());\r\n            return source;\r\n        }\r\n        ......\r\n        \r\n      }","title":"Spring security CORS Filter","body":"<pre><code>import org.springframework.web.cors.CorsConfiguration;\nimport org.springframework.web.cors.CorsConfigurationSource;\nimport org.springframework.web.cors.UrlBasedCorsConfigurationSource;\n\n    \n    public class SecurityConfiguration extends WebSecurityConfigurerAdapter {\n    .....  \n\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n      http.authorizeRequests().antMatchers(&quot;/api/**&quot;).authenticated().and().httpBasic().and().csrf().disable();\n\n    }\n    \n    @Bean\n    protected CorsConfigurationSource corsConfigurationSource() {\n        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n        source.registerCorsConfiguration(&quot;/**&quot;, new CorsConfiguration().applyPermitDefaultValues());\n        return source;\n    }\n    ......\n    \n  }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":12716296,"reputation":82,"user_id":9238226,"display_name":"Nay Oo Kyaw"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1671300114,"creation_date":1671300114,"answer_id":74836308,"question_id":40418441,"body_markdown":"Use below sample\r\n\r\n\r\n    @Configuration\r\n    @EnableConfigurationProperties(BasicAuthConfigProperties.class)\r\n    @EnableWebSecurity\r\n\r\n    public class SecurityConfiguration extends WebSecurityConfigurerAdapter {\r\n\r\n    private final BasicAuthConfigProperties basicAuth;\r\n\r\n    public SecurityConfiguration(BasicAuthConfigProperties basicAuth) {\r\n        this.basicAuth = basicAuth;\r\n    }\r\n\r\n    protected void configure(HttpSecurity http) throws Exception {\r\n        http.cors();\r\n    }\r\n    }","title":"Spring security CORS Filter","body":"<p>Use below sample</p>\n<pre><code>@Configuration\n@EnableConfigurationProperties(BasicAuthConfigProperties.class)\n@EnableWebSecurity\n\npublic class SecurityConfiguration extends WebSecurityConfigurerAdapter {\n\nprivate final BasicAuthConfigProperties basicAuth;\n\npublic SecurityConfiguration(BasicAuthConfigProperties basicAuth) {\n    this.basicAuth = basicAuth;\n}\n\nprotected void configure(HttpSecurity http) throws Exception {\n    http.cors();\n}\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":16425512,"reputation":93,"user_id":11865678,"display_name":"Shakib hasan"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695360083,"creation_date":1695360083,"answer_id":77155043,"question_id":40418441,"body_markdown":"After 2 days of research,i fix the problem.I am using spring boot 3.1.2 and spring security 6.1.2 with jwt token.Just add this class in your codebase.\r\n\r\n    @Configuration\r\n    @EnableWebMvc\r\n    public class WebConfig {\r\n    \r\n        private static final Long MAX_AGE = 3600L;\r\n        private static final int CORS_FILTER_ORDER = -102;\r\n    \r\n        @Bean\r\n        public FilterRegistrationBean corsFilter() {\r\n            UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\r\n            CorsConfiguration config = new CorsConfiguration();\r\n            config.setAllowCredentials(true);\r\n            config.addAllowedOrigin(&quot;http://localhost:5173&quot;);\r\n            config.setAllowedHeaders(Arrays.asList(\r\n                    HttpHeaders.AUTHORIZATION,\r\n                    HttpHeaders.CONTENT_TYPE,\r\n                    HttpHeaders.ACCEPT));\r\n            config.setAllowedMethods(Arrays.asList(\r\n                    HttpMethod.OPTIONS.name(),\r\n                    HttpMethod.GET.name(),\r\n                    HttpMethod.POST.name(),\r\n                    HttpMethod.PUT.name(),\r\n                    HttpMethod.DELETE.name()));\r\n            config.setMaxAge(MAX_AGE);\r\n            source.registerCorsConfiguration(&quot;/**&quot;, config);\r\n            FilterRegistrationBean bean = new FilterRegistrationBean(new CorsFilter(source));\r\n    \r\n            // should be set order to -100 because we need to CorsFilter before SpringSecurityFilter\r\n            bean.setOrder(CORS_FILTER_ORDER);\r\n            return bean;\r\n        }\r\n    }\r\nDo not use * on  config.addAllowedOrigin() method argument.Explicitly define the domain you need to allow.","title":"Spring security CORS Filter","body":"<p>After 2 days of research,i fix the problem.I am using spring boot 3.1.2 and spring security 6.1.2 with jwt token.Just add this class in your codebase.</p>\n<pre><code>@Configuration\n@EnableWebMvc\npublic class WebConfig {\n\n    private static final Long MAX_AGE = 3600L;\n    private static final int CORS_FILTER_ORDER = -102;\n\n    @Bean\n    public FilterRegistrationBean corsFilter() {\n        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n        CorsConfiguration config = new CorsConfiguration();\n        config.setAllowCredentials(true);\n        config.addAllowedOrigin(&quot;http://localhost:5173&quot;);\n        config.setAllowedHeaders(Arrays.asList(\n                HttpHeaders.AUTHORIZATION,\n                HttpHeaders.CONTENT_TYPE,\n                HttpHeaders.ACCEPT));\n        config.setAllowedMethods(Arrays.asList(\n                HttpMethod.OPTIONS.name(),\n                HttpMethod.GET.name(),\n                HttpMethod.POST.name(),\n                HttpMethod.PUT.name(),\n                HttpMethod.DELETE.name()));\n        config.setMaxAge(MAX_AGE);\n        source.registerCorsConfiguration(&quot;/**&quot;, config);\n        FilterRegistrationBean bean = new FilterRegistrationBean(new CorsFilter(source));\n\n        // should be set order to -100 because we need to CorsFilter before SpringSecurityFilter\n        bean.setOrder(CORS_FILTER_ORDER);\n        return bean;\n    }\n}\n</code></pre>\n<p>Do not use * on  config.addAllowedOrigin() method argument.Explicitly define the domain you need to allow.</p>\n"}],"owner":{"account_id":9578797,"reputation":1089,"user_id":7113955,"accept_rate":50,"display_name":"Mace"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":246556,"favorite_count":0,"down_vote_count":0,"up_vote_count":67,"accepted_answer_id":40419969,"answer_count":18,"score":67,"last_activity_date":1695360083,"creation_date":1478249212,"question_id":40418441,"body_markdown":"We added `Spring Security` to our existing project. \n\nFrom this moment on we get a 401 `No &#39;Access-Control-Allow-Origin&#39; header is present on the requested resource` error from the our server. \n\nThat&#39;s because no `Access-Control-Allow-Origin` header is attached to the response. To fix this we added our own filter which is in the `Filter` chain before the logout filter, but the filter does not apply for our requests.\n\nOur Error:\n\n&gt; XMLHttpRequest cannot load `http://localhost:8080/getKunden`. No &#39;Access-Control-Allow-Origin&#39; header is present on the requested resource. Origin `http://localhost:3000` is therefore not allowed access. The response had HTTP status code 401.\n\nOur Security configuration:\n\n    @EnableWebSecurity\n    @Configuration\n    @ComponentScan(&quot;com.company.praktikant&quot;)\n    public class SecurityConfiguration extends WebSecurityConfigurerAdapter {\n\n    @Autowired\n    private MyFilter filter;\n\n    @Override\n    public void configure(HttpSecurity http) throws Exception {\n        final UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n        final CorsConfiguration config = new CorsConfiguration();\n\n        config.addAllowedOrigin(&quot;*&quot;);\n        config.addAllowedHeader(&quot;*&quot;);\n        config.addAllowedMethod(&quot;GET&quot;);\n        config.addAllowedMethod(&quot;PUT&quot;);\n        config.addAllowedMethod(&quot;POST&quot;);\n        source.registerCorsConfiguration(&quot;/**&quot;, config);\n        http.addFilterBefore(new MyFilter(), LogoutFilter.class).authorizeRequests()\n                .antMatchers(HttpMethod.OPTIONS, &quot;/*&quot;).permitAll();\n    }\n\n    @Autowired\n    public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\n    }\n    }\n\nOur filter\n\n    @Component\n    public class MyFilter extends OncePerRequestFilter {\n\n    @Override\n    public void destroy() {\n\n    }\n\n    private String getAllowedDomainsRegex() {\n        return &quot;individual / customized Regex&quot;;\n    }\n\n    @Override\n    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)\n            throws ServletException, IOException {\n\n        final String origin = &quot;http://localhost:3000&quot;;\n\n        response.addHeader(&quot;Access-Control-Allow-Origin&quot;, origin);\n        response.setHeader(&quot;Access-Control-Allow-Methods&quot;, &quot;POST, GET, OPTIONS&quot;);\n        response.setHeader(&quot;Access-Control-Allow-Credentials&quot;, &quot;true&quot;);\n        response.setHeader(&quot;Access-Control-Allow-Headers&quot;,\n                &quot;content-type, x-gwt-module-base, x-gwt-permutation, clientid, longpush&quot;);\n\n        filterChain.doFilter(request, response);\n\n    }\n    }\n\nOur Application\n\n    @SpringBootApplication\n    public class Application {\n    public static void main(String[] args) {\n        final ApplicationContext ctx = SpringApplication.run(Application.class, args);\n        final AnnotationConfigApplicationContext annotationConfigApplicationContext = new AnnotationConfigApplicationContext();\n        annotationConfigApplicationContext.register(CORSConfig.class);\n        annotationConfigApplicationContext.refresh();\n    }\n    }\n\nOur filter is registered from spring-boot:\n\n&gt; 2016-11-04 09:19:51.494  INFO 9704 --- [ost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: &#39;myFilter&#39; to: [/*]\n\n\nOur generated filterchain:\n\n&gt; 2016-11-04 09:19:52.729  INFO 9704 --- [ost-startStop-1] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: org.springframework.security.web.util.matcher.AnyRequestMatcher@1, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@5d8c5a8a, org.springframework.security.web.context.SecurityContextPersistenceFilter@7d6938f, org.springframework.security.web.header.HeaderWriterFilter@72aa89c, org.springframework.security.web.csrf.CsrfFilter@4af4df11, com.company.praktikant.MyFilter@5ba65db2, org.springframework.security.web.authentication.logout.LogoutFilter@2330834f, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@396532d1, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@4fc0f1a2, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@2357120f, org.springframework.security.web.session.SessionManagementFilter@10867bfb, org.springframework.security.web.access.ExceptionTranslationFilter@4b8bf1fb, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@42063cf1]\n\nThe Response: \n[Response headers][1]\n\n\n  [1]: https://i.stack.imgur.com/tw8pd.png\n\nWe tried the solution from spring as well but it didn&#39;t work! The annotation @CrossOrigin in our controller didn&#39;t help either.\n\n\n# Edit 1:\nTried the solution from @Piotr Sotysiak. \nThe cors filter isn&#39;t listed in the generated filter chain and we still get the same error.\n\n&gt; 2016-11-04 10:22:49.881  INFO 8820 --- [ost-startStop-1] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: org.springframework.security.web.util.matcher.AnyRequestMatcher@1, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@4c191377, org.springframework.security.web.context.SecurityContextPersistenceFilter@28bad32a, org.springframework.security.web.header.HeaderWriterFilter@3c3ec668, org.springframework.security.web.csrf.CsrfFilter@288460dd, org.springframework.security.web.authentication.logout.LogoutFilter@1c9cd096, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@3990c331, org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter@1e8d4ac1, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@2d61d2a4, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@380d9a9b, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@abf2de3, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@2a5c161b, org.springframework.security.web.session.SessionManagementFilter@3c1fd3e5, org.springframework.security.web.access.ExceptionTranslationFilter@3d7055ef, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@5d27725a]\n\nBtw we are using spring-security version 4.1.3.!","title":"Spring security CORS Filter","body":"<p>We added <code>Spring Security</code> to our existing project.</p>\n<p>From this moment on we get a 401 <code>No 'Access-Control-Allow-Origin' header is present on the requested resource</code> error from the our server.</p>\n<p>That's because no <code>Access-Control-Allow-Origin</code> header is attached to the response. To fix this we added our own filter which is in the <code>Filter</code> chain before the logout filter, but the filter does not apply for our requests.</p>\n<p>Our Error:</p>\n<blockquote>\n<p>XMLHttpRequest cannot load <code>http://localhost:8080/getKunden</code>. No 'Access-Control-Allow-Origin' header is present on the requested resource. Origin <code>http://localhost:3000</code> is therefore not allowed access. The response had HTTP status code 401.</p>\n</blockquote>\n<p>Our Security configuration:</p>\n<pre><code>@EnableWebSecurity\n@Configuration\n@ComponentScan(&quot;com.company.praktikant&quot;)\npublic class SecurityConfiguration extends WebSecurityConfigurerAdapter {\n\n@Autowired\nprivate MyFilter filter;\n\n@Override\npublic void configure(HttpSecurity http) throws Exception {\n    final UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n    final CorsConfiguration config = new CorsConfiguration();\n\n    config.addAllowedOrigin(&quot;*&quot;);\n    config.addAllowedHeader(&quot;*&quot;);\n    config.addAllowedMethod(&quot;GET&quot;);\n    config.addAllowedMethod(&quot;PUT&quot;);\n    config.addAllowedMethod(&quot;POST&quot;);\n    source.registerCorsConfiguration(&quot;/**&quot;, config);\n    http.addFilterBefore(new MyFilter(), LogoutFilter.class).authorizeRequests()\n            .antMatchers(HttpMethod.OPTIONS, &quot;/*&quot;).permitAll();\n}\n\n@Autowired\npublic void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\n}\n}\n</code></pre>\n<p>Our filter</p>\n<pre><code>@Component\npublic class MyFilter extends OncePerRequestFilter {\n\n@Override\npublic void destroy() {\n\n}\n\nprivate String getAllowedDomainsRegex() {\n    return &quot;individual / customized Regex&quot;;\n}\n\n@Override\nprotected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)\n        throws ServletException, IOException {\n\n    final String origin = &quot;http://localhost:3000&quot;;\n\n    response.addHeader(&quot;Access-Control-Allow-Origin&quot;, origin);\n    response.setHeader(&quot;Access-Control-Allow-Methods&quot;, &quot;POST, GET, OPTIONS&quot;);\n    response.setHeader(&quot;Access-Control-Allow-Credentials&quot;, &quot;true&quot;);\n    response.setHeader(&quot;Access-Control-Allow-Headers&quot;,\n            &quot;content-type, x-gwt-module-base, x-gwt-permutation, clientid, longpush&quot;);\n\n    filterChain.doFilter(request, response);\n\n}\n}\n</code></pre>\n<p>Our Application</p>\n<pre><code>@SpringBootApplication\npublic class Application {\npublic static void main(String[] args) {\n    final ApplicationContext ctx = SpringApplication.run(Application.class, args);\n    final AnnotationConfigApplicationContext annotationConfigApplicationContext = new AnnotationConfigApplicationContext();\n    annotationConfigApplicationContext.register(CORSConfig.class);\n    annotationConfigApplicationContext.refresh();\n}\n}\n</code></pre>\n<p>Our filter is registered from spring-boot:</p>\n<blockquote>\n<p>2016-11-04 09:19:51.494  INFO 9704 --- [ost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'myFilter' to: [/*]</p>\n</blockquote>\n<p>Our generated filterchain:</p>\n<blockquote>\n<p>2016-11-04 09:19:52.729  INFO 9704 --- [ost-startStop-1] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: org.springframework.security.web.util.matcher.AnyRequestMatcher@1, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@5d8c5a8a, org.springframework.security.web.context.SecurityContextPersistenceFilter@7d6938f, org.springframework.security.web.header.HeaderWriterFilter@72aa89c, org.springframework.security.web.csrf.CsrfFilter@4af4df11, com.company.praktikant.MyFilter@5ba65db2, org.springframework.security.web.authentication.logout.LogoutFilter@2330834f, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@396532d1, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@4fc0f1a2, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@2357120f, org.springframework.security.web.session.SessionManagementFilter@10867bfb, org.springframework.security.web.access.ExceptionTranslationFilter@4b8bf1fb, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@42063cf1]</p>\n</blockquote>\n<p>The Response:\n<a href=\"https://i.stack.imgur.com/tw8pd.png\" rel=\"noreferrer\">Response headers</a></p>\n<p>We tried the solution from spring as well but it didn't work! The annotation @CrossOrigin in our controller didn't help either.</p>\n<h1>Edit 1:</h1>\n<p>Tried the solution from @Piotr Sotysiak.\nThe cors filter isn't listed in the generated filter chain and we still get the same error.</p>\n<blockquote>\n<p>2016-11-04 10:22:49.881  INFO 8820 --- [ost-startStop-1] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: org.springframework.security.web.util.matcher.AnyRequestMatcher@1, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@4c191377, org.springframework.security.web.context.SecurityContextPersistenceFilter@28bad32a, org.springframework.security.web.header.HeaderWriterFilter@3c3ec668, org.springframework.security.web.csrf.CsrfFilter@288460dd, org.springframework.security.web.authentication.logout.LogoutFilter@1c9cd096, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@3990c331, org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter@1e8d4ac1, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@2d61d2a4, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@380d9a9b, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@abf2de3, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@2a5c161b, org.springframework.security.web.session.SessionManagementFilter@3c1fd3e5, org.springframework.security.web.access.ExceptionTranslationFilter@3d7055ef, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@5d27725a]</p>\n</blockquote>\n<p>Btw we are using spring-security version 4.1.3.!</p>\n"},{"tags":["java","error-handling"],"answers":[{"tags":[],"owner":{"account_id":14207789,"reputation":2764,"user_id":10263853,"display_name":"Morpheus"},"down_vote_count":1,"up_vote_count":272,"is_accepted":true,"score":271,"last_activity_date":1541352108,"creation_date":1541344481,"answer_id":53142252,"question_id":53033899,"body_markdown":"Just delete *module-info.java* at your Project Explorer tab.","title":"must declare a named package eclipse because this compilation unit is associated to the named module","body":"<p>Just delete <em>module-info.java</em> at your Project Explorer tab.</p>\n"},{"tags":[],"owner":{"account_id":14394715,"reputation":861,"user_id":10421473,"display_name":"reben"},"down_vote_count":0,"up_vote_count":76,"is_accepted":false,"score":76,"last_activity_date":1558271697,"creation_date":1558271697,"answer_id":56208170,"question_id":53033899,"body_markdown":"The &quot;delete module-info.java at your Project Explorer tab&quot; answer is the easiest and most straightforward answer, but\r\n\r\nfor those who would want a _little_ more understanding or control of what&#39;s happening, the following alternate methods may be desirable;\r\n\r\n- make an ever so slightly more realistic application; com.YourCompany.etc\r\nor just com.HelloWorld (Project name: com.HelloWorld and class name: HelloWorld)\r\n\r\nor\r\n\r\n- when creating the java project; when in the Create Java Project dialog, don&#39;t choose Finish but Next, and deselect Create module-info.java file\r\n","title":"must declare a named package eclipse because this compilation unit is associated to the named module","body":"<p>The \"delete module-info.java at your Project Explorer tab\" answer is the easiest and most straightforward answer, but</p>\n\n<p>for those who would want a <em>little</em> more understanding or control of what's happening, the following alternate methods may be desirable;</p>\n\n<ul>\n<li>make an ever so slightly more realistic application; com.YourCompany.etc\nor just com.HelloWorld (Project name: com.HelloWorld and class name: HelloWorld)</li>\n</ul>\n\n<p>or</p>\n\n<ul>\n<li>when creating the java project; when in the Create Java Project dialog, don't choose Finish but Next, and deselect Create module-info.java file</li>\n</ul>\n"},{"tags":[],"owner":{"account_id":10307639,"reputation":1329,"user_id":7604395,"display_name":"Deepak Gautam"},"down_vote_count":0,"up_vote_count":25,"is_accepted":false,"score":25,"last_activity_date":1600945923,"creation_date":1600945923,"answer_id":64045250,"question_id":53033899,"body_markdown":"**Reason of the error:** Package name left blank while creating a class. This make use of default package. Thus causes this error.\r\n\r\n**Quick fix:** \r\n\r\n 1. Create a package eg. `helloWorld` inside the `src` folder.\r\n 2. Move `helloWorld.java` file in that package. Just drag and drop on\r\n    the package. Error should disappear. \r\n\r\n\r\n**Explanation:**\r\n - My Eclipse version: *2020-09 (4.17.0)*\r\n - My Java version: *Java 15, 2020-09-15*\r\n \r\nLatest version of *Eclipse* required *java11* or above. The `module` feature is introduced in java9 and onward. It was proposed in 2005 for Java7 but later suspended. Java is object oriented based. And module is the moduler approach which can be seen in language like C. It was harder to implement it, due to which it took long time for the release. **Source:** [Understanding Java 9 Modules][1]\r\n\r\n\r\n**W**hen you create a new project in Eclipse then by default module feature is selected. And in Eclipse-2020-09-R, a pop-up appears which ask for creation of `module-info.java` file. If you select `don&#39;t create` then `module-info.java` will not create and your project will free from this issue.\r\n\r\nBest practice is while crating project, after giving project name. Click on `next` button instead of `finish`. On next page at the bottom it ask for creation of `module-info.java` file. Select or deselect as per need.\r\n\r\n**If selected:** (by default) click on `finish` button and give name for module. Now while creating a class **don&#39;t forget to give package name**. Whenever you create a class just give package name. Any name, just don&#39;t left it blank. \r\n\r\n**If deselect:** No issue \r\n\r\n\r\n  [1]: https://www.oracle.com/corporate/features/understanding-java-9-modules.html","title":"must declare a named package eclipse because this compilation unit is associated to the named module","body":"<p><strong>Reason of the error:</strong> Package name left blank while creating a class. This make use of default package. Thus causes this error.</p>\n<p><strong>Quick fix:</strong></p>\n<ol>\n<li>Create a package eg. <code>helloWorld</code> inside the <code>src</code> folder.</li>\n<li>Move <code>helloWorld.java</code> file in that package. Just drag and drop on\nthe package. Error should disappear.</li>\n</ol>\n<p><strong>Explanation:</strong></p>\n<ul>\n<li>My Eclipse version: <em>2020-09 (4.17.0)</em></li>\n<li>My Java version: <em>Java 15, 2020-09-15</em></li>\n</ul>\n<p>Latest version of <em>Eclipse</em> required <em>java11</em> or above. The <code>module</code> feature is introduced in java9 and onward. It was proposed in 2005 for Java7 but later suspended. Java is object oriented based. And module is the moduler approach which can be seen in language like C. It was harder to implement it, due to which it took long time for the release. <strong>Source:</strong> <a href=\"https://www.oracle.com/corporate/features/understanding-java-9-modules.html\" rel=\"noreferrer\">Understanding Java 9 Modules</a></p>\n<p><strong>W</strong>hen you create a new project in Eclipse then by default module feature is selected. And in Eclipse-2020-09-R, a pop-up appears which ask for creation of <code>module-info.java</code> file. If you select <code>don't create</code> then <code>module-info.java</code> will not create and your project will free from this issue.</p>\n<p>Best practice is while crating project, after giving project name. Click on <code>next</code> button instead of <code>finish</code>. On next page at the bottom it ask for creation of <code>module-info.java</code> file. Select or deselect as per need.</p>\n<p><strong>If selected:</strong> (by default) click on <code>finish</code> button and give name for module. Now while creating a class <strong>don't forget to give package name</strong>. Whenever you create a class just give package name. Any name, just don't left it blank.</p>\n<p><strong>If deselect:</strong> No issue</p>\n"}],"owner":{"account_id":13853253,"reputation":1515,"user_id":10000669,"display_name":"J. Doe"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":345792,"favorite_count":0,"down_vote_count":1,"up_vote_count":118,"accepted_answer_id":53142252,"answer_count":3,"score":117,"last_activity_date":1695360007,"creation_date":1540745511,"question_id":53033899,"body_markdown":"I just downloaded eclipse for Java Yesterday but when I was trying to make my first program, I kept on getting this error: \r\n    \r\n&gt; must declare a named package eclipse because this compilation unit is associated to the named module x. \r\n\r\nHow do I fix this?","title":"must declare a named package eclipse because this compilation unit is associated to the named module","body":"<p>I just downloaded eclipse for Java Yesterday but when I was trying to make my first program, I kept on getting this error:</p>\n<blockquote>\n<p>must declare a named package eclipse because this compilation unit is associated to the named module x.</p>\n</blockquote>\n<p>How do I fix this?</p>\n"},{"tags":["java","json","httpurlconnection"],"answers":[{"tags":[],"owner":{"account_id":7971290,"reputation":321,"user_id":6015878,"display_name":"Bruce H"},"down_vote_count":0,"up_vote_count":13,"is_accepted":true,"score":13,"last_activity_date":1465982943,"creation_date":1465982943,"answer_id":37831434,"question_id":37831025,"body_markdown":"Perhaps try sending the header Accept: application/json\r\n\r\nIf that doesn&#39;t work, then review the documentation for the API and see if there&#39;s something else you should be sending to return json.","title":"Getting HTML response instead of Json response","body":"<p>Perhaps try sending the header Accept: application/json</p>\n\n<p>If that doesn't work, then review the documentation for the API and see if there's something else you should be sending to return json.</p>\n"},{"tags":[],"owner":{"account_id":10638952,"reputation":11,"user_id":7834737,"display_name":"Shubham gosain"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1517997087,"creation_date":1517994205,"answer_id":48659679,"question_id":37831025,"body_markdown":"For `java`\r\n\r\nSet The Request Property as the following:\r\n\r\n    con.setRequestProperty(&quot;Accept&quot;,&quot;application/json&quot;)\r\n\r\nIt will solve the issue you are facing.","title":"Getting HTML response instead of Json response","body":"<p>For <code>java</code></p>\n\n<p>Set The Request Property as the following:</p>\n\n<pre><code>con.setRequestProperty(\"Accept\",\"application/json\")\n</code></pre>\n\n<p>It will solve the issue you are facing.</p>\n"},{"tags":[],"owner":{"account_id":19685252,"reputation":11,"user_id":14411337,"display_name":"David DiRico"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695359757,"creation_date":1695359757,"answer_id":77155029,"question_id":37831025,"body_markdown":"If anyone stops here, often times receiving HTML as a response is due to `not calling a valid request method to your API in your fetch requests`","title":"Getting HTML response instead of Json response","body":"<p>If anyone stops here, often times receiving HTML as a response is due to <code>not calling a valid request method to your API in your fetch requests</code></p>\n"}],"owner":{"account_id":4110511,"reputation":301,"user_id":3373408,"accept_rate":58,"display_name":"dmaprasad"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":15313,"favorite_count":0,"down_vote_count":1,"up_vote_count":5,"accepted_answer_id":37831434,"answer_count":3,"score":4,"last_activity_date":1695359757,"creation_date":1465981856,"question_id":37831025,"body_markdown":"I&#39;m getting HTML response instead of JSON response. I&#39;m using following code and I&#39;m receiving HTML response as bf.readLine(). Is there any issue in following code or is this API issue? \r\n\r\n    String uri = &quot;http://192.168.77.6/Ivr_ABN_API/?id=&quot; + mobile;\r\n\t\tURL url;\r\n\t\tGson json = null;\r\n\t\ttry {\r\n\t\t\turl = new URL(uri);\r\n\t\t\tjson = new Gson();\r\n\r\n\t\t\tHttpURLConnection connection;\r\n\t\t\taccess_token = db.getAccessTokenFromDB();\r\n\t\t\tconnection = (HttpURLConnection) url.openConnection();\r\n\t\t\tconnection.setRequestMethod(&quot;GET&quot;);\r\n\t\t\t\r\n\t\t\tSystem.out.println(&quot;URL:&quot; + uri);\r\n\t\t\t\r\n\t\t\tconnection.setRequestProperty(&quot;Content-Type&quot;, &quot;application/json&quot;);\r\n\t\t\tint status = connection.getResponseCode();\r\n\t\t\tresCode = Integer.toString(status);\r\n\t\t\tSystem.out.println(&quot;status is &quot; + status);\r\n\t\t\tInputStream in = connection.getInputStream();\r\n\t\t\tSystem.out.println(&quot;inputStreamer &quot; + in);\r\n\t\t\tBufferedReader bf = new BufferedReader(new InputStreamReader(\r\n\t\t\t\t\tconnection.getInputStream()));\r\n\t\t\tSystem.out.println(&quot;bf.readLine() - &quot; + bf.readLine());\r\n\r\n\t\t\twhile ((output = bf.readLine()) != null) {\r\n\t\t\t\tJSONObject obj = new JSONObject(output);\r\n\t\t\t\tSystem.out.println(&quot;output is &quot; + output);\r\n\t\t\t\tresCode = obj.getString(&quot;resCode&quot;);\r\n\t\t\t\tresDesc = obj.getString(&quot;COUNT&quot;);\r\n\r\n\t\t\t}","title":"Getting HTML response instead of Json response","body":"<p>I'm getting HTML response instead of JSON response. I'm using following code and I'm receiving HTML response as bf.readLine(). Is there any issue in following code or is this API issue? </p>\n\n<pre><code>String uri = \"http://192.168.77.6/Ivr_ABN_API/?id=\" + mobile;\n    URL url;\n    Gson json = null;\n    try {\n        url = new URL(uri);\n        json = new Gson();\n\n        HttpURLConnection connection;\n        access_token = db.getAccessTokenFromDB();\n        connection = (HttpURLConnection) url.openConnection();\n        connection.setRequestMethod(\"GET\");\n\n        System.out.println(\"URL:\" + uri);\n\n        connection.setRequestProperty(\"Content-Type\", \"application/json\");\n        int status = connection.getResponseCode();\n        resCode = Integer.toString(status);\n        System.out.println(\"status is \" + status);\n        InputStream in = connection.getInputStream();\n        System.out.println(\"inputStreamer \" + in);\n        BufferedReader bf = new BufferedReader(new InputStreamReader(\n                connection.getInputStream()));\n        System.out.println(\"bf.readLine() - \" + bf.readLine());\n\n        while ((output = bf.readLine()) != null) {\n            JSONObject obj = new JSONObject(output);\n            System.out.println(\"output is \" + output);\n            resCode = obj.getString(\"resCode\");\n            resDesc = obj.getString(\"COUNT\");\n\n        }\n</code></pre>\n"},{"tags":["java","linux","spring-boot"],"comments":[{"owner":{"account_id":5814796,"reputation":268,"user_id":13027493,"display_name":"rav"},"score":0,"creation_date":1695271478,"post_id":77147190,"comment_id":136002720,"body_markdown":"Have you added the Spring JDBC dependency in pom.xml?","body":"Have you added the Spring JDBC dependency in pom.xml?"},{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1695285551,"post_id":77147190,"comment_id":136004855,"body_markdown":"Please provide enough code so others can better understand or reproduce the problem.","body":"Please provide enough code so others can better understand or reproduce the problem."},{"owner":{"account_id":26389799,"reputation":1,"user_id":20041820,"display_name":"Vignesh"},"score":0,"creation_date":1695359238,"post_id":77147190,"comment_id":136016437,"body_markdown":"Yes , i have added jdbc in my pom.xml","body":"Yes , i have added jdbc in my pom.xml"}],"owner":{"account_id":26389799,"reputation":1,"user_id":20041820,"display_name":"Vignesh"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":31,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1695359326,"creation_date":1695270204,"question_id":77147190,"body_markdown":"Error starting ApplicationContext. To display the condition evaluation report re-run your application with &#39;debug&#39; enabled.\r\n2023-09-21T09:51:20.646+05:30 ERROR 18538 --- [  restartedMain] o.s.b.d.LoggingFailureAnalysisReporter   : \r\n\r\n***************************\r\nAPPLICATION FAILED TO START\r\n***************************\r\n\r\nDescription:\r\n\r\nField jdbcTemplate in com.snigdha.snigdhahospitals.controller required a bean of type &#39;org.springframework.jdbc.core.JdbcTemplate&#39; that could not be found.\r\n\r\nThe injection point has the following annotations:\r\n        - @org.springframework.beans.factory.annotation.Autowired(required=true)\r\n\r\n\r\nAction:\r\n\r\nConsider defining a bean of type &#39;org.springframework.jdbc.core.JdbcTemplate&#39; in your configuration.\r\n\r\n\r\nI tried to run the springboot application after adding the JDBC and application failed to start\r\n\r\n\r\n\r\npom.xml\r\n\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n\txsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n\t&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n\t&lt;parent&gt;\r\n\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\r\n\t\t&lt;version&gt;3.1.3&lt;/version&gt;\r\n\t\t&lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\r\n\t&lt;/parent&gt;\r\n\t&lt;groupId&gt;com.snigdha&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;snigdhahospitals&lt;/artifactId&gt;\r\n\t&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\r\n\t&lt;name&gt;snigdhahospitals&lt;/name&gt;\r\n\t&lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\r\n\t&lt;properties&gt;\r\n\t\t&lt;java.version&gt;20&lt;/java.version&gt;\r\n\t&lt;/properties&gt;\r\n\t&lt;dependencies&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-data-jdbc&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-oauth2-client&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-webflux&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;runtime&lt;/scope&gt;\r\n\t\t\t&lt;optional&gt;true&lt;/optional&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;com.mysql&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;runtime&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;lombok&lt;/artifactId&gt;\r\n\t\t\t&lt;optional&gt;true&lt;/optional&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;io.projectreactor&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;reactor-test&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;!-- &lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;mysql&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;8.0.26&lt;/version&gt;\r\n\t\t&lt;/dependency&gt; --&gt;\r\n\t\t&lt;dependency&gt;\r\n    \t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t    &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t&lt;/dependencies&gt;\r\n\r\n\t&lt;build&gt;\r\n\t\t&lt;plugins&gt;\r\n\t\t\t&lt;plugin&gt;\r\n\t\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n\t\t\t\t&lt;configuration&gt;\r\n\t\t\t\t\t&lt;excludes&gt;\r\n\t\t\t\t\t\t&lt;exclude&gt;\r\n\t\t\t\t\t\t\t&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\r\n\t\t\t\t\t\t\t&lt;artifactId&gt;lombok&lt;/artifactId&gt;\r\n\t\t\t\t\t\t&lt;/exclude&gt;\r\n\t\t\t\t\t&lt;/excludes&gt;\r\n\t\t\t\t&lt;/configuration&gt;\r\n\t\t\t&lt;/plugin&gt;\r\n\t\t&lt;/plugins&gt;\r\n\t&lt;/build&gt;\r\n\r\n\t&lt;!-- &lt;build&gt;\r\n    \t&lt;plugins&gt;\r\n        \t&lt;plugin&gt;\r\n           \t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n            \t&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n        \t    \t&lt;executions&gt;\r\n            \t    \t\t&lt;execution&gt;\r\n                \t    \t\t&lt;goals&gt;\r\n                    \t    \t\t&lt;goal&gt;repackage&lt;/goal&gt;\r\n                    \t\t\t&lt;/goals&gt;\r\n                \t\t\t&lt;/execution&gt;\r\n            \t\t&lt;/executions&gt;\r\n     \t\t&lt;/plugin&gt;\r\n    \t&lt;/plugins&gt;\r\n\t&lt;/build&gt; --&gt;\r\n\r\n&lt;/project&gt;\r\n\r\ncontroller.java\r\n\r\n    package com.snigdha.snigdhahospitals;\r\n    \r\n    // import javax.swing.tree.RowMapper;\r\n    \r\n    // import java.util.ArrayList;\r\n    import java.util.List;\r\n    \r\n    // import javax.sql.DataSource;\r\n    \r\n    import org.springframework.beans.factory.annotation.Autowired;\r\n    // import org.springframework.context.annotation.Bean;\r\n    // import org.springframework.context.annotation.Configuration;\r\n    import org.springframework.http.HttpStatus;\r\n    import org.springframework.http.ResponseEntity;\r\n    // import org.springframework.beans.factory.annotation.Autowired;\r\n    import org.springframework.jdbc.core.BeanPropertyRowMapper;\r\n    import org.springframework.jdbc.core.JdbcTemplate;\r\n    // import org.springframework.jdbc.datasource.DriverManagerDataSource;\r\n    // import org.springframework.jdbc.core.RowMapper;\r\n    import org.springframework.web.bind.annotation.GetMapping;\r\n    import org.springframework.web.bind.annotation.RequestMapping;\r\n    // import org.springframework.stereotype.Controller;\r\n    // import org.springframework.web.bind.annotation.RequestMapping;\r\n    // import org.springframework.web.bind.annotation.ResponseBody;\r\n    import org.springframework.web.bind.annotation.RestController;\r\n    import org.springframework.web.servlet.ModelAndView;\r\n    // import org.springframework.web.servlet.ModelAndView;\r\n    \r\n    import com.snigdha.snigdhahospitals.model.Doctor;\r\n    \r\n    // import ch.qos.logback.core.model.Model;\r\n    \r\n    \r\n    \r\n    @RestController\r\n    public class controller {\r\n    \r\n    \r\n        @Autowired\r\n        JdbcTemplate jdbcTemplate;\r\n    \r\n        @GetMapping(&quot;/d&quot;)\r\n        public ResponseEntity&lt;List&lt;Doctor&gt;&gt; getDoctors(){\r\n            List&lt;Doctor&gt; doctors = jdbcTemplate.query(&quot;SELECT * FROM DOCTOR&quot;, new BeanPropertyRowMapper&lt;Doctor&gt;(Doctor.class));\r\n            return new ResponseEntity&lt;&gt;(doctors,HttpStatus.OK);\r\n        }\r\n        \r\n    \r\n        @RequestMapping(&quot;/&quot;)\r\n        public ModelAndView home(){\r\n            ModelAndView mv = new ModelAndView();\r\n            mv.setViewName(&quot;home&quot;);\r\n            return mv;\r\n        }\r\n    \r\n        @RequestMapping(&quot;/home&quot;)\r\n        public ModelAndView homepage(){\r\n            ModelAndView mv = new ModelAndView();\r\n            mv.setViewName(&quot;home&quot;);\r\n            return mv;\r\n        }\r\n    \r\n        @RequestMapping(&quot;/doctors&quot;)\r\n        public ModelAndView doctors(){\r\n            ModelAndView mv = new ModelAndView();\r\n            mv.setViewName(&quot;doctors&quot;);\r\n            return mv;\r\n        }\r\n    \r\n        @RequestMapping(&quot;/login&quot;)\r\n        public ModelAndView login(){\r\n            ModelAndView mv = new ModelAndView();\r\n            mv.setViewName(&quot;login&quot;);\r\n            return mv;\r\n        }\r\n    \r\n        @RequestMapping(&quot;/signup&quot;)\r\n        public ModelAndView signup(){\r\n            ModelAndView mv = new ModelAndView();\r\n            mv.setViewName(&quot;signup&quot;);\r\n            return mv;\r\n        }\r\n    \r\n        @RequestMapping(&quot;/appointments&quot;)\r\n        public ModelAndView appointments(){\r\n            ModelAndView mv = new ModelAndView();\r\n            mv.setViewName(&quot;appointments&quot;);\r\n            return mv;\r\n        }\r\n    \r\n        @RequestMapping(&quot;/contactus&quot;)\r\n        public ModelAndView contactus(){\r\n            ModelAndView mv = new ModelAndView();\r\n            mv.setViewName(&quot;contactus&quot;);\r\n            return mv;\r\n        }\r\n    \r\n        @RequestMapping(&quot;/grievance&quot;)\r\n        public ModelAndView grievance(){\r\n            ModelAndView mv = new ModelAndView();\r\n            mv.setViewName(&quot;grievance&quot;);\r\n            return mv;\r\n        }\r\n    \r\n        @RequestMapping(&quot;/aboutus&quot;)\r\n        public ModelAndView aboutus(){\r\n            ModelAndView mv = new ModelAndView();\r\n            mv.setViewName(&quot;aboutus&quot;);\r\n            return mv;\r\n        }\r\n        \r\n    }\r\n    \r\n     \r\n\r\n\r\n\r\n","title":"ERROR 18538 --- [ restartedMain] o.s.b.d.LoggingFailureAnalysisReporter :","body":"<p>Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.\n2023-09-21T09:51:20.646+05:30 ERROR 18538 --- [  restartedMain] o.s.b.d.LoggingFailureAnalysisReporter   :</p>\n<hr />\n<p>APPLICATION FAILED TO START</p>\n<hr />\n<p>Description:</p>\n<p>Field jdbcTemplate in com.snigdha.snigdhahospitals.controller required a bean of type 'org.springframework.jdbc.core.JdbcTemplate' that could not be found.</p>\n<p>The injection point has the following annotations:\n- @org.springframework.beans.factory.annotation.Autowired(required=true)</p>\n<p>Action:</p>\n<p>Consider defining a bean of type 'org.springframework.jdbc.core.JdbcTemplate' in your configuration.</p>\n<p>I tried to run the springboot application after adding the JDBC and application failed to start</p>\n<p>pom.xml</p>\n\n<p>\n4.0.0\n\norg.springframework.boot\nspring-boot-starter-parent\n3.1.3\n \n\ncom.snigdha\nsnigdhahospitals\n0.0.1-SNAPSHOT\nsnigdhahospitals\nDemo project for Spring Boot\n\n&lt;java.version&gt;20&lt;/java.version&gt;\n\n\n\norg.springframework.boot\nspring-boot-starter-data-jdbc\n\n\norg.springframework.boot\nspring-boot-starter-jdbc\n\n\norg.springframework.boot\nspring-boot-starter-oauth2-client\n\n\norg.springframework.boot\nspring-boot-starter-web\n\n\norg.springframework.boot\nspring-boot-starter-webflux\n</p>\n<pre><code>    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;\n        &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;optional&gt;true&lt;/optional&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;com.mysql&lt;/groupId&gt;\n        &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;\n        &lt;scope&gt;runtime&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n        &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n        &lt;optional&gt;true&lt;/optional&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n        &lt;scope&gt;test&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;io.projectreactor&lt;/groupId&gt;\n        &lt;artifactId&gt;reactor-test&lt;/artifactId&gt;\n        &lt;scope&gt;test&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;!-- &lt;dependency&gt;\n        &lt;groupId&gt;mysql&lt;/groupId&gt;\n        &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\n        &lt;version&gt;8.0.26&lt;/version&gt;\n    &lt;/dependency&gt; --&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n\n&lt;build&gt;\n    &lt;plugins&gt;\n        &lt;plugin&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;configuration&gt;\n                &lt;excludes&gt;\n                    &lt;exclude&gt;\n                        &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n                        &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n                    &lt;/exclude&gt;\n                &lt;/excludes&gt;\n            &lt;/configuration&gt;\n        &lt;/plugin&gt;\n    &lt;/plugins&gt;\n&lt;/build&gt;\n\n&lt;!-- &lt;build&gt;\n    &lt;plugins&gt;\n        &lt;plugin&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n                &lt;executions&gt;\n                        &lt;execution&gt;\n                            &lt;goals&gt;\n                                &lt;goal&gt;repackage&lt;/goal&gt;\n                            &lt;/goals&gt;\n                        &lt;/execution&gt;\n                &lt;/executions&gt;\n        &lt;/plugin&gt;\n    &lt;/plugins&gt;\n&lt;/build&gt; --&gt;\n</code></pre>\n\n<p>controller.java</p>\n<pre><code>package com.snigdha.snigdhahospitals;\n\n// import javax.swing.tree.RowMapper;\n\n// import java.util.ArrayList;\nimport java.util.List;\n\n// import javax.sql.DataSource;\n\nimport org.springframework.beans.factory.annotation.Autowired;\n// import org.springframework.context.annotation.Bean;\n// import org.springframework.context.annotation.Configuration;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.http.ResponseEntity;\n// import org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.jdbc.core.BeanPropertyRowMapper;\nimport org.springframework.jdbc.core.JdbcTemplate;\n// import org.springframework.jdbc.datasource.DriverManagerDataSource;\n// import org.springframework.jdbc.core.RowMapper;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\n// import org.springframework.stereotype.Controller;\n// import org.springframework.web.bind.annotation.RequestMapping;\n// import org.springframework.web.bind.annotation.ResponseBody;\nimport org.springframework.web.bind.annotation.RestController;\nimport org.springframework.web.servlet.ModelAndView;\n// import org.springframework.web.servlet.ModelAndView;\n\nimport com.snigdha.snigdhahospitals.model.Doctor;\n\n// import ch.qos.logback.core.model.Model;\n\n\n\n@RestController\npublic class controller {\n\n\n    @Autowired\n    JdbcTemplate jdbcTemplate;\n\n    @GetMapping(&quot;/d&quot;)\n    public ResponseEntity&lt;List&lt;Doctor&gt;&gt; getDoctors(){\n        List&lt;Doctor&gt; doctors = jdbcTemplate.query(&quot;SELECT * FROM DOCTOR&quot;, new BeanPropertyRowMapper&lt;Doctor&gt;(Doctor.class));\n        return new ResponseEntity&lt;&gt;(doctors,HttpStatus.OK);\n    }\n    \n\n    @RequestMapping(&quot;/&quot;)\n    public ModelAndView home(){\n        ModelAndView mv = new ModelAndView();\n        mv.setViewName(&quot;home&quot;);\n        return mv;\n    }\n\n    @RequestMapping(&quot;/home&quot;)\n    public ModelAndView homepage(){\n        ModelAndView mv = new ModelAndView();\n        mv.setViewName(&quot;home&quot;);\n        return mv;\n    }\n\n    @RequestMapping(&quot;/doctors&quot;)\n    public ModelAndView doctors(){\n        ModelAndView mv = new ModelAndView();\n        mv.setViewName(&quot;doctors&quot;);\n        return mv;\n    }\n\n    @RequestMapping(&quot;/login&quot;)\n    public ModelAndView login(){\n        ModelAndView mv = new ModelAndView();\n        mv.setViewName(&quot;login&quot;);\n        return mv;\n    }\n\n    @RequestMapping(&quot;/signup&quot;)\n    public ModelAndView signup(){\n        ModelAndView mv = new ModelAndView();\n        mv.setViewName(&quot;signup&quot;);\n        return mv;\n    }\n\n    @RequestMapping(&quot;/appointments&quot;)\n    public ModelAndView appointments(){\n        ModelAndView mv = new ModelAndView();\n        mv.setViewName(&quot;appointments&quot;);\n        return mv;\n    }\n\n    @RequestMapping(&quot;/contactus&quot;)\n    public ModelAndView contactus(){\n        ModelAndView mv = new ModelAndView();\n        mv.setViewName(&quot;contactus&quot;);\n        return mv;\n    }\n\n    @RequestMapping(&quot;/grievance&quot;)\n    public ModelAndView grievance(){\n        ModelAndView mv = new ModelAndView();\n        mv.setViewName(&quot;grievance&quot;);\n        return mv;\n    }\n\n    @RequestMapping(&quot;/aboutus&quot;)\n    public ModelAndView aboutus(){\n        ModelAndView mv = new ModelAndView();\n        mv.setViewName(&quot;aboutus&quot;);\n        return mv;\n    }\n    \n}\n\n \n</code></pre>\n"},{"tags":["java","sql","jpql"],"comments":[{"owner":{"account_id":17717155,"reputation":527,"user_id":12863192,"display_name":"Ishan"},"score":1,"creation_date":1694698299,"post_id":77105235,"comment_id":135927763,"body_markdown":"`AND ((:locationList) IS NULL OR customer_receiver.area IN (:locationList))` and other such uses of `List` on the left is not correct, I think.\nInstead of having a fixed query, and passing on the burden to check if the parameter is NULL or not and ignore the rest of the conditions on that parameter if it is NULL on the DB is not correct.\nInstead of this, use a StringBuilder and keep appending `AND condition` to it in IF blocks if a parameter is NOT NULL.","body":"<code>AND ((:locationList) IS NULL OR customer_receiver.area IN (:locationList))</code> and other such uses of <code>List</code> on the left is not correct, I think. Instead of having a fixed query, and passing on the burden to check if the parameter is NULL or not and ignore the rest of the conditions on that parameter if it is NULL on the DB is not correct. Instead of this, use a StringBuilder and keep appending <code>AND condition</code> to it in IF blocks if a parameter is NOT NULL."},{"owner":{"account_id":17717155,"reputation":527,"user_id":12863192,"display_name":"Ishan"},"score":1,"creation_date":1694698664,"post_id":77105235,"comment_id":135927837,"body_markdown":"https://stackoverflow.com/questions/28874135/dynamic-spring-data-jpa-repository-query-with-arbitrary-and-clauses - Like this - Have a CriteriaBuilder and add keep adding criteria to it only if the parameter is not null","body":"<a href=\"https://stackoverflow.com/questions/28874135/dynamic-spring-data-jpa-repository-query-with-arbitrary-and-clauses\" title=\"dynamic spring data jpa repository query with arbitrary and clauses\">stackoverflow.com/questions/28874135/&hellip;</a> - Like this - Have a CriteriaBuilder and add keep adding criteria to it only if the parameter is not null"},{"owner":{"account_id":17717155,"reputation":527,"user_id":12863192,"display_name":"Ishan"},"score":1,"creation_date":1694698766,"post_id":77105235,"comment_id":135927856,"body_markdown":"What I mean to say is, the final query executed should not have `AND (:isPovertyLineCheck IS NULL OR :isPovertyLineCheck = false OR customer_receiver.isEligible = :isPovertyLineCheck)` at all, if `isPovertyLineCheck` is NULL. And like this for all the ANDs. And if it is not-null, then `AND (:isPovertyLineCheck = false OR customer_receiver.isEligible = :isPovertyLineCheck)`","body":"What I mean to say is, the final query executed should not have <code>AND (:isPovertyLineCheck IS NULL OR :isPovertyLineCheck = false OR customer_receiver.isEligible = :isPovertyLineCheck)</code> at all, if <code>isPovertyLineCheck</code> is NULL. And like this for all the ANDs. And if it is not-null, then <code>AND (:isPovertyLineCheck = false OR customer_receiver.isEligible = :isPovertyLineCheck)</code>"}],"answers":[{"tags":[],"owner":{"account_id":20277505,"reputation":40,"user_id":14872179,"display_name":"Faiz Akbar"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694698348,"creation_date":1694698348,"answer_id":77105421,"question_id":77105235,"body_markdown":"There are 2 things that you have to check.\r\n 1. That you are not passing any null value parameter in query.\r\n 2. Check there parameter type as well e.g &lt; customer_receiver.isEligible &gt; make sure isEligible and all other parameters types are same.","title":"Getting Error: An expression of non-boolean type specified in a context where a condition is expected, near &#39;,&#39;&quot;, using JPQL","body":"<p>There are 2 things that you have to check.</p>\n<ol>\n<li>That you are not passing any null value parameter in query.</li>\n<li>Check there parameter type as well e.g &lt; customer_receiver.isEligible &gt; make sure isEligible and all other parameters types are same.</li>\n</ol>\n"},{"tags":[],"owner":{"account_id":10270603,"reputation":17,"user_id":7579112,"display_name":"Ashik1291"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695357803,"creation_date":1695357803,"answer_id":77154924,"question_id":77105235,"body_markdown":"I have solved the issue using JpaSpecification. Thanks all for answering.","title":"Getting Error: An expression of non-boolean type specified in a context where a condition is expected, near &#39;,&#39;&quot;, using JPQL","body":"<p>I have solved the issue using JpaSpecification. Thanks all for answering.</p>\n"}],"owner":{"account_id":10270603,"reputation":17,"user_id":7579112,"display_name":"Ashik1291"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":58,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1695357803,"creation_date":1694697065,"question_id":77105235,"body_markdown":"I have written the following JPQL query. In the query while multiple values(Male, Female etc.) come in the list like gender list or other list. It shows an error in the console like &quot;An expression of non-boolean type specified in a context where a condition is expected, near &#39;,&#39;&quot;,&quot;. Help me out please. Tried a lot to solve.\r\n\r\nQuery:\r\n\r\n```\r\n@Query(&quot;&quot;&quot;\r\n\t\t\tSELECT customer_receiver\r\n\t\t\tFROM SubsidyCustomerUserReceiverEntity customer_receiver\r\n\t\t\tWHERE customer_receiver.deleted = false\r\n\t\t\t\tAND (:isPovertyLineCheck IS NULL OR :isPovertyLineCheck = false OR customer_receiver.isEligible = :isPovertyLineCheck)\r\n\t\t\t\tAND (:incomeLowerLimit IS NULL OR :incomeUpperLimit IS NULL OR\r\n\t\t\t\t\t\t\tcustomer_receiver.receiverGrossHouseholdIncomeAmount BETWEEN :incomeLowerLimit AND :incomeUpperLimit)\r\n\t\t\t\tAND (:ageLowerLimit IS NULL OR :ageUpperLimit IS NULL OR\r\n\t\t\t\t\t\t\tcustomer_receiver.ageYear BETWEEN :ageLowerLimit AND :ageUpperLimit)\r\n\t\t\t\tAND ((:locationList) IS NULL OR customer_receiver.area IN (:locationList))\r\n\t\t\t\tAND ((:employmentTypeList) IS NULL OR customer_receiver.employmentType IN (:employmentTypeList))\r\n\t\t\t\tAND ((:occupationList) IS NULL OR customer_receiver.incomeSourceOrOccupationName IN (:occupationList))\r\n\t\t\t\tAND ((:genderList) IS NULL OR customer_receiver.gender IN (:genderList))\r\n\t\t\t&quot;&quot;&quot;)\r\n\tList&lt;SubsidyCustomerUserReceiverEntity&gt; getEligibleCustomerReceiver(BigDecimal incomeLowerLimit,\r\n\t\t\tBigDecimal incomeUpperLimit, Integer ageLowerLimit, Integer ageUpperLimit, Boolean isPovertyLineCheck,\r\n\t\t\tList&lt;String&gt; locationList, List&lt;EmploymentType&gt; employmentTypeList, List&lt;String&gt; occupationList,\r\n\t\t\tList&lt;String&gt; genderList);\r\n```\r\n\r\n\r\nI have tried tweaking queries.","title":"Getting Error: An expression of non-boolean type specified in a context where a condition is expected, near &#39;,&#39;&quot;, using JPQL","body":"<p>I have written the following JPQL query. In the query while multiple values(Male, Female etc.) come in the list like gender list or other list. It shows an error in the console like &quot;An expression of non-boolean type specified in a context where a condition is expected, near ','&quot;,&quot;. Help me out please. Tried a lot to solve.</p>\n<p>Query:</p>\n<pre><code>@Query(&quot;&quot;&quot;\n            SELECT customer_receiver\n            FROM SubsidyCustomerUserReceiverEntity customer_receiver\n            WHERE customer_receiver.deleted = false\n                AND (:isPovertyLineCheck IS NULL OR :isPovertyLineCheck = false OR customer_receiver.isEligible = :isPovertyLineCheck)\n                AND (:incomeLowerLimit IS NULL OR :incomeUpperLimit IS NULL OR\n                            customer_receiver.receiverGrossHouseholdIncomeAmount BETWEEN :incomeLowerLimit AND :incomeUpperLimit)\n                AND (:ageLowerLimit IS NULL OR :ageUpperLimit IS NULL OR\n                            customer_receiver.ageYear BETWEEN :ageLowerLimit AND :ageUpperLimit)\n                AND ((:locationList) IS NULL OR customer_receiver.area IN (:locationList))\n                AND ((:employmentTypeList) IS NULL OR customer_receiver.employmentType IN (:employmentTypeList))\n                AND ((:occupationList) IS NULL OR customer_receiver.incomeSourceOrOccupationName IN (:occupationList))\n                AND ((:genderList) IS NULL OR customer_receiver.gender IN (:genderList))\n            &quot;&quot;&quot;)\n    List&lt;SubsidyCustomerUserReceiverEntity&gt; getEligibleCustomerReceiver(BigDecimal incomeLowerLimit,\n            BigDecimal incomeUpperLimit, Integer ageLowerLimit, Integer ageUpperLimit, Boolean isPovertyLineCheck,\n            List&lt;String&gt; locationList, List&lt;EmploymentType&gt; employmentTypeList, List&lt;String&gt; occupationList,\n            List&lt;String&gt; genderList);\n</code></pre>\n<p>I have tried tweaking queries.</p>\n"},{"tags":["java","mapstruct"],"comments":[{"owner":{"account_id":18044315,"reputation":1227,"user_id":13115701,"display_name":"Paul Marcelin Bejan"},"score":0,"creation_date":1690449349,"post_id":76730024,"comment_id":135356436,"body_markdown":"have you tried to use @Mapper(unmappedTargetPolicy = ReportingPolicy.IGNORE) ?","body":"have you tried to use @Mapper(unmappedTargetPolicy = ReportingPolicy.IGNORE) ?"}],"answers":[{"tags":[],"owner":{"account_id":16051139,"reputation":83,"user_id":11584992,"display_name":"Kartik"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1695356496,"creation_date":1695356496,"answer_id":77154854,"question_id":76730024,"body_markdown":"As mentioned in [MapStruct Discussion], this is a known bug in MapStruct versions up to 1.5.5 and is fixed in main (possibly in 1.6.0 Release)\r\n\r\n\r\n  [MapStruct Discussion]: https://https:/https://github.com/mapstruct/mapstruct/discussions/3329","title":"MapStruct mapper with BeanMapping#ignoreByDefault=true and SubclassMapping doesn&#39;t ignore properties from Subclasses","body":"<p>As mentioned in <a href=\"https://https:/https://github.com/mapstruct/mapstruct/discussions/3329\" rel=\"nofollow noreferrer\">MapStruct Discussion</a>, this is a known bug in MapStruct versions up to 1.5.5 and is fixed in main (possibly in 1.6.0 Release)</p>\n"}],"owner":{"account_id":16051139,"reputation":83,"user_id":11584992,"display_name":"Kartik"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":140,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"answer_count":1,"score":3,"last_activity_date":1695356496,"creation_date":1689857055,"question_id":76730024,"body_markdown":"Below is an example of the entity to DTO mapping and mapper and generated Map Struct implementation.\r\n\r\n\r\n```java\r\n\r\npublic abstract class User {\r\n    private int id;\r\n    private String firstName;\r\n    private String lastName;\r\n    private int age;\r\n    private LocalDateTime dateOfBirth;\r\n    private List&lt;Address&gt; addresses;\r\n}\r\n\r\npublic class Address {\r\n    private int userId;\r\n    private String streetAddress;\r\n    private String city;\r\n    private String state;\r\n    private String zipCode;\r\n}\r\n\r\npublic class Employee extends User {\r\n    private String designation;\r\n    private Employee reportingManager;\r\n}\r\n\r\npublic class Contractor extends User {\r\n    private String contractingCompanyName;\r\n\r\n}\r\n\r\npublic abstract class UserDTO {\r\n    private int id;\r\n    private String firstName;\r\n    private String lastName;\r\n    private int age;\r\n    private LocalDateTime dateOfBirth;\r\n}\r\n\r\npublic class EmployeeDTO extends UserDTO {\r\n    private String designation;\r\n    private EmployeeDTO reportingManager;\r\n}\r\n\r\npublic class ContractorDTO extends UserDTO {\r\n    private String contractingCompanyName;\r\n\r\n}\r\n\r\n@Mapper(subclassExhaustiveStrategy = SubclassExhaustiveStrategy.RUNTIME_EXCEPTION)\r\npublic abstract class UserMapper {\r\n\r\n    @BeanMapping(ignoreByDefault = true)\r\n    @SubclassMapping(source = Employee.class, target = EmployeeDTO.class)\r\n    @SubclassMapping(source = Contractor.class, target = ContractorDTO.class)\r\n    @Mapping(source = &quot;id&quot;, target = &quot;id&quot;)\r\n    @Mapping(source = &quot;firstName&quot;, target = &quot;firstName&quot;)\r\n    @Mapping(source = &quot;lastName&quot;, target = &quot;lastName&quot;)\r\n    public abstract UserDTO map(User user);\r\n}\r\n\r\n\r\n\r\n```\r\n\r\nGenerated Mapper\r\n\r\n\r\n```java\r\n@Generated(\r\n    value = &quot;org.mapstruct.ap.MappingProcessor&quot;,\r\n    date = &quot;2023-07-14T12:56:15-0400&quot;,\r\n    comments = &quot;version: 1.5.5.Final, compiler: javac, environment: Java 17.0.5 (Amazon.com Inc.)&quot;\r\n)\r\npublic class UserMapperImpl extends UserMapper {\r\n\r\n    @Override\r\n    public UserDTO map(User user) {\r\n        if ( user == null ) {\r\n            return null;\r\n        }\r\n\r\n        if (user instanceof Employee) {\r\n            return employeeToEmployeeDTO( (Employee) user );\r\n        }\r\n        else if (user instanceof Contractor) {\r\n            return contractorToContractorDTO( (Contractor) user );\r\n        }\r\n        else {\r\n            throw new IllegalArgumentException(&quot;Not all subclasses are supported for this mapping. Missing for &quot; + user.getClass());\r\n        }\r\n    }\r\n\r\n    protected EmployeeDTO employeeToEmployeeDTO(Employee employee) {\r\n        if ( employee == null ) {\r\n            return null;\r\n        }\r\n\r\n        EmployeeDTO employeeDTO = new EmployeeDTO();\r\n\r\n        employeeDTO.setId( employee.getId() );\r\n        employeeDTO.setFirstName( employee.getFirstName() );\r\n        employeeDTO.setLastName( employee.getLastName() );\r\n        employeeDTO.setDesignation( employee.getDesignation() );\r\n        employeeDTO.setReportingManager( employeeToEmployeeDTO( employee.getReportingManager() ) );\r\n\r\n        return employeeDTO;\r\n    }\r\n\r\n    protected ContractorDTO contractorToContractorDTO(Contractor contractor) {\r\n        if ( contractor == null ) {\r\n            return null;\r\n        }\r\n\r\n        ContractorDTO contractorDTO = new ContractorDTO();\r\n\r\n        contractorDTO.setId( contractor.getId() );\r\n        contractorDTO.setFirstName( contractor.getFirstName() );\r\n        contractorDTO.setLastName( contractor.getLastName() );\r\n        contractorDTO.setContractingCompanyName( contractor.getContractingCompanyName() );\r\n\r\n        return contractorDTO;\r\n    }\r\n\r\n```\r\n\r\n\r\n\r\nI expected that adding `BeanMapping#ignoreByDefault=true` would only map the explicitly mapped properties. But that is not the case with the subclasses.\r\n\r\nI was hoping for a better way other than explicitly mapping each subtype and annotating with InhertConfiguration and excluding the other properties from the subclasses.","title":"MapStruct mapper with BeanMapping#ignoreByDefault=true and SubclassMapping doesn&#39;t ignore properties from Subclasses","body":"<p>Below is an example of the entity to DTO mapping and mapper and generated Map Struct implementation.</p>\n<pre class=\"lang-java prettyprint-override\"><code>\npublic abstract class User {\n    private int id;\n    private String firstName;\n    private String lastName;\n    private int age;\n    private LocalDateTime dateOfBirth;\n    private List&lt;Address&gt; addresses;\n}\n\npublic class Address {\n    private int userId;\n    private String streetAddress;\n    private String city;\n    private String state;\n    private String zipCode;\n}\n\npublic class Employee extends User {\n    private String designation;\n    private Employee reportingManager;\n}\n\npublic class Contractor extends User {\n    private String contractingCompanyName;\n\n}\n\npublic abstract class UserDTO {\n    private int id;\n    private String firstName;\n    private String lastName;\n    private int age;\n    private LocalDateTime dateOfBirth;\n}\n\npublic class EmployeeDTO extends UserDTO {\n    private String designation;\n    private EmployeeDTO reportingManager;\n}\n\npublic class ContractorDTO extends UserDTO {\n    private String contractingCompanyName;\n\n}\n\n@Mapper(subclassExhaustiveStrategy = SubclassExhaustiveStrategy.RUNTIME_EXCEPTION)\npublic abstract class UserMapper {\n\n    @BeanMapping(ignoreByDefault = true)\n    @SubclassMapping(source = Employee.class, target = EmployeeDTO.class)\n    @SubclassMapping(source = Contractor.class, target = ContractorDTO.class)\n    @Mapping(source = &quot;id&quot;, target = &quot;id&quot;)\n    @Mapping(source = &quot;firstName&quot;, target = &quot;firstName&quot;)\n    @Mapping(source = &quot;lastName&quot;, target = &quot;lastName&quot;)\n    public abstract UserDTO map(User user);\n}\n\n\n\n</code></pre>\n<p>Generated Mapper</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Generated(\n    value = &quot;org.mapstruct.ap.MappingProcessor&quot;,\n    date = &quot;2023-07-14T12:56:15-0400&quot;,\n    comments = &quot;version: 1.5.5.Final, compiler: javac, environment: Java 17.0.5 (Amazon.com Inc.)&quot;\n)\npublic class UserMapperImpl extends UserMapper {\n\n    @Override\n    public UserDTO map(User user) {\n        if ( user == null ) {\n            return null;\n        }\n\n        if (user instanceof Employee) {\n            return employeeToEmployeeDTO( (Employee) user );\n        }\n        else if (user instanceof Contractor) {\n            return contractorToContractorDTO( (Contractor) user );\n        }\n        else {\n            throw new IllegalArgumentException(&quot;Not all subclasses are supported for this mapping. Missing for &quot; + user.getClass());\n        }\n    }\n\n    protected EmployeeDTO employeeToEmployeeDTO(Employee employee) {\n        if ( employee == null ) {\n            return null;\n        }\n\n        EmployeeDTO employeeDTO = new EmployeeDTO();\n\n        employeeDTO.setId( employee.getId() );\n        employeeDTO.setFirstName( employee.getFirstName() );\n        employeeDTO.setLastName( employee.getLastName() );\n        employeeDTO.setDesignation( employee.getDesignation() );\n        employeeDTO.setReportingManager( employeeToEmployeeDTO( employee.getReportingManager() ) );\n\n        return employeeDTO;\n    }\n\n    protected ContractorDTO contractorToContractorDTO(Contractor contractor) {\n        if ( contractor == null ) {\n            return null;\n        }\n\n        ContractorDTO contractorDTO = new ContractorDTO();\n\n        contractorDTO.setId( contractor.getId() );\n        contractorDTO.setFirstName( contractor.getFirstName() );\n        contractorDTO.setLastName( contractor.getLastName() );\n        contractorDTO.setContractingCompanyName( contractor.getContractingCompanyName() );\n\n        return contractorDTO;\n    }\n\n</code></pre>\n<p>I expected that adding <code>BeanMapping#ignoreByDefault=true</code> would only map the explicitly mapped properties. But that is not the case with the subclasses.</p>\n<p>I was hoping for a better way other than explicitly mapping each subtype and annotating with InhertConfiguration and excluding the other properties from the subclasses.</p>\n"},{"tags":["java","spring-boot","aop","aspectj","spring-aop"],"answers":[{"tags":[],"owner":{"account_id":24440940,"reputation":3122,"user_id":18364656,"display_name":"Andrei Lisa"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695224964,"creation_date":1695218738,"answer_id":77143262,"question_id":77142146,"body_markdown":"I think the best answer of this question you will find in [documentation][1]\r\n\r\nAbout your topic:\r\n`* *..*Repository.find*(..)`\r\nThis pointcut matches any method starts with find with any numbers of params and is located in any classes that are invoking some method that are ending with `Repository.find`\r\n\r\n`* *Repository.find*(..)`\r\nThis pointcut mean anything that match this one and method find have any number of params\r\n\r\n\r\n\r\n  [1]: https://docs.spring.io/spring-framework/reference/core/aop/ataspectj/pointcuts.html#aop-common-pointcuts","title":"PointCut expressions in spring","body":"<p>I think the best answer of this question you will find in <a href=\"https://docs.spring.io/spring-framework/reference/core/aop/ataspectj/pointcuts.html#aop-common-pointcuts\" rel=\"nofollow noreferrer\">documentation</a></p>\n<p>About your topic:\n<code>* *..*Repository.find*(..)</code>\nThis pointcut matches any method starts with find with any numbers of params and is located in any classes that are invoking some method that are ending with <code>Repository.find</code></p>\n<p><code>* *Repository.find*(..)</code>\nThis pointcut mean anything that match this one and method find have any number of params</p>\n"},{"tags":[],"owner":{"account_id":5278004,"reputation":6696,"user_id":4214241,"display_name":"R.G"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1695353779,"creation_date":1695229220,"answer_id":77144561,"question_id":77142146,"body_markdown":"Do read through the official documentation section **&quot;Declaring a Pointcut&quot;**. See the [examples][1] for more details.\r\n\r\n```none\r\nexecution(modifiers-pattern?\r\n          ret-type-pattern\r\n          declaring-type-pattern?name-pattern(param-pattern)\r\n          throws-pattern?)\r\n```\r\n  \r\n### `* *..*Repository.find*(..)`\r\n\r\n| Pattern type | Pattern | Description |\r\n|------------------|---|-----|\r\n| ret-type-pattern | `*` | any |\r\n| declaring-type-pattern | `*..*Repository` | Type with a name that ends with `Repository` within **any package _except for_ the root (default) package** |\r\n| ?name-pattern(param-pattern) | `find*(..)` | A method with a name that starts with `find` accepting any number (zero or more) of parameters |\r\n\r\n### `* *Repository.find*(..)`\r\n\t   \r\n| Pattern type | Pattern | Description |\r\n|------------------|---|-----|\r\n| ret-type-pattern | `*` | any |\r\n| declaring-type-pattern | `*Repository` | Type with a name that ends with `Repository` within **root (default) package only** |\r\n| ?name-pattern(param-pattern) | `find*(..)` | A method with a name that starts with `find` accepting any number (zero or more) of parameters |\r\n\r\nThe difference is that the second expression is specific about the package where the type exists. Please note that the first package noes **not** include the root package, which is one of the many reasons that Java code should never be declared in the default package.\r\n\t\r\n`..` is a special wildcard to match any number of arguments and `*..*` in `declaring-type-pattern` means starting from root package and any of its sub-package.\r\n\r\n  [1]: https://docs.spring.io/spring-framework/reference/core/aop/ataspectj/pointcuts.html#aop-pointcuts-examples\r\n","title":"PointCut expressions in spring","body":"<p>Do read through the official documentation section <strong>&quot;Declaring a Pointcut&quot;</strong>. See the <a href=\"https://docs.spring.io/spring-framework/reference/core/aop/ataspectj/pointcuts.html#aop-pointcuts-examples\" rel=\"nofollow noreferrer\">examples</a> for more details.</p>\n<pre class=\"lang-none prettyprint-override\"><code>execution(modifiers-pattern?\n          ret-type-pattern\n          declaring-type-pattern?name-pattern(param-pattern)\n          throws-pattern?)\n</code></pre>\n<h3><code>* *..*Repository.find*(..)</code></h3>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>Pattern type</th>\n<th>Pattern</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ret-type-pattern</td>\n<td><code>*</code></td>\n<td>any</td>\n</tr>\n<tr>\n<td>declaring-type-pattern</td>\n<td><code>*..*Repository</code></td>\n<td>Type with a name that ends with <code>Repository</code> within <strong>any package <em>except for</em> the root (default) package</strong></td>\n</tr>\n<tr>\n<td>?name-pattern(param-pattern)</td>\n<td><code>find*(..)</code></td>\n<td>A method with a name that starts with <code>find</code> accepting any number (zero or more) of parameters</td>\n</tr>\n</tbody>\n</table>\n</div><h3><code>* *Repository.find*(..)</code></h3>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>Pattern type</th>\n<th>Pattern</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ret-type-pattern</td>\n<td><code>*</code></td>\n<td>any</td>\n</tr>\n<tr>\n<td>declaring-type-pattern</td>\n<td><code>*Repository</code></td>\n<td>Type with a name that ends with <code>Repository</code> within <strong>root (default) package only</strong></td>\n</tr>\n<tr>\n<td>?name-pattern(param-pattern)</td>\n<td><code>find*(..)</code></td>\n<td>A method with a name that starts with <code>find</code> accepting any number (zero or more) of parameters</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>The difference is that the second expression is specific about the package where the type exists. Please note that the first package noes <strong>not</strong> include the root package, which is one of the many reasons that Java code should never be declared in the default package.</p>\n<p><code>..</code> is a special wildcard to match any number of arguments and <code>*..*</code> in <code>declaring-type-pattern</code> means starting from root package and any of its sub-package.</p>\n"}],"owner":{"account_id":20010765,"reputation":27,"user_id":14667826,"display_name":"firemancer"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":97,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77144561,"answer_count":2,"score":0,"last_activity_date":1695353779,"creation_date":1695210797,"question_id":77142146,"body_markdown":"I have two pointcut expressions:\r\n1. ```* *..*Repository.find*(..)```\r\n2. ```* *Repository.find*(..)```\r\n\r\nWhat is the difference between these two and what does the ```*..```part  of the first pointcut means? ","title":"PointCut expressions in spring","body":"<p>I have two pointcut expressions:</p>\n<ol>\n<li><code>* *..*Repository.find*(..)</code></li>\n<li><code>* *Repository.find*(..)</code></li>\n</ol>\n<p>What is the difference between these two and what does the <code>*..</code>part  of the first pointcut means?</p>\n"},{"tags":["java","spring","spring-boot","jackson"],"comments":[{"owner":{"account_id":2139538,"reputation":42501,"user_id":1898563,"accept_rate":78,"display_name":"Michael"},"score":1,"creation_date":1623080073,"post_id":67874510,"comment_id":119970724,"body_markdown":"Just adding the dependency is not enough. You need to configure the object mapper to add the Jackson module","body":"Just adding the dependency is not enough. You need to configure the object mapper to add the Jackson module"},{"owner":{"account_id":1261634,"reputation":24551,"user_id":1219755,"accept_rate":84,"display_name":"alexanoid"},"score":1,"creation_date":1623080661,"post_id":67874510,"comment_id":119971027,"body_markdown":"But why it is working in SB 2.4.5 in stopped working in 2.5.0 ?","body":"But why it is working in SB 2.4.5 in stopped working in 2.5.0 ?"},{"owner":{"account_id":2139538,"reputation":42501,"user_id":1898563,"accept_rate":78,"display_name":"Michael"},"score":0,"creation_date":1623080972,"post_id":67874510,"comment_id":119971207,"body_markdown":"Could conceivably be [this](https://github.com/spring-projects/spring-boot/commit/b1f3d91f7df5dd311bf7e835cf6df003865a069c). If so, it&#39;s a bug","body":"Could conceivably be <a href=\"https://github.com/spring-projects/spring-boot/commit/b1f3d91f7df5dd311bf7e835cf6df003865a069c\" rel=\"nofollow noreferrer\">this</a>. If so, it&#39;s a bug"},{"owner":{"account_id":2139538,"reputation":42501,"user_id":1898563,"accept_rate":78,"display_name":"Michael"},"score":0,"creation_date":1623081269,"post_id":67874510,"comment_id":119971338,"body_markdown":"Kind of looks like the copy might screw things up. If you&#39;re appending your time module to the ObjectMapper after this copy happens, then the copied mapper won&#39;t pick up your change (obviously). Previously, you would just be mutating the instance held by the `JacksonClusterEnvironmentBuilderCustomizer`, which is fine so long as ObjectMapper is thread-safe, which it is","body":"Kind of looks like the copy might screw things up. If you&#39;re appending your time module to the ObjectMapper after this copy happens, then the copied mapper won&#39;t pick up your change (obviously). Previously, you would just be mutating the instance held by the <code>JacksonClusterEnvironmentBuilderCustomizer</code>, which is fine so long as ObjectMapper is thread-safe, which it is"},{"owner":{"account_id":1261634,"reputation":24551,"user_id":1219755,"accept_rate":84,"display_name":"alexanoid"},"score":0,"creation_date":1623081474,"post_id":67874510,"comment_id":119971429,"body_markdown":"Thanks. So, should I wait for the newer version of SB in order to get it solved or how ?","body":"Thanks. So, should I wait for the newer version of SB in order to get it solved or how ?"},{"owner":{"account_id":326040,"reputation":3140,"user_id":647581,"display_name":"Patrick Herrera"},"score":1,"creation_date":1623308728,"post_id":67874510,"comment_id":120043307,"body_markdown":"Personally I would wait until the next release.  In addition to this issue, 2.5.0 also broke our application due to: https://github.com/spring-projects/spring-boot/issues/26627","body":"Personally I would wait until the next release.  In addition to this issue, 2.5.0 also broke our application due to: <a href=\"https://github.com/spring-projects/spring-boot/issues/26627\" rel=\"nofollow noreferrer\">github.com/spring-projects/spring-boot/issues/26627</a>"},{"owner":{"account_id":1261634,"reputation":24551,"user_id":1219755,"accept_rate":84,"display_name":"alexanoid"},"score":0,"creation_date":1623359276,"post_id":67874510,"comment_id":120064873,"body_markdown":"@PatrickHerrera Spring Boot 2.5.1 was released. Did this release solve the mentioned bugs?","body":"@PatrickHerrera Spring Boot 2.5.1 was released. Did this release solve the mentioned bugs?"},{"owner":{"account_id":1261634,"reputation":24551,"user_id":1219755,"accept_rate":84,"display_name":"alexanoid"},"score":0,"creation_date":1623393512,"post_id":67874510,"comment_id":120071136,"body_markdown":"Looks like the issue with &#39;Java 8 date/time type&#39; has not yet been resolved","body":"Looks like the issue with &#39;Java 8 date/time type&#39; has not yet been resolved"},{"owner":{"account_id":1473276,"reputation":110999,"user_id":1384297,"accept_rate":100,"display_name":"Andy Wilkinson"},"score":0,"creation_date":1623394924,"post_id":67874510,"comment_id":120071616,"body_markdown":"2.4.5 and 2.5.1 use different versions of Jackson. I suspect that Maven may have corrupted the `jackson-datatype-jsr310` jar when it downloaded it. I would try clearing Mavens local cache and building your application again.","body":"2.4.5 and 2.5.1 use different versions of Jackson. I suspect that Maven may have corrupted the <code>jackson-datatype-jsr310</code> jar when it downloaded it. I would try clearing Mavens local cache and building your application again."},{"owner":{"account_id":1473276,"reputation":110999,"user_id":1384297,"accept_rate":100,"display_name":"Andy Wilkinson"},"score":0,"creation_date":1623395273,"post_id":67874510,"comment_id":120071761,"body_markdown":"For the record, the copying of the ObjectMapper is specific to Couchbase and, judging by the stack trace, it is JMS not Couchbase thats involved here.","body":"For the record, the copying of the ObjectMapper is specific to Couchbase and, judging by the stack trace, it is JMS not Couchbase thats involved here."},{"owner":{"account_id":1261634,"reputation":24551,"user_id":1219755,"accept_rate":84,"display_name":"alexanoid"},"score":0,"creation_date":1623404583,"post_id":67874510,"comment_id":120075339,"body_markdown":"@AndyWilkinson thanks for your answer! I completely wiped my local Maven repo and redownloaded it from scratch. After this I&#39;d like to confirm that the issue still exists","body":"@AndyWilkinson thanks for your answer! I completely wiped my local Maven repo and redownloaded it from scratch. After this I&#39;d like to confirm that the issue still exists"},{"owner":{"account_id":1473276,"reputation":110999,"user_id":1384297,"accept_rate":100,"display_name":"Andy Wilkinson"},"score":0,"creation_date":1623407134,"post_id":67874510,"comment_id":120076420,"body_markdown":"Thanks for trying that. Can you share a [minimal, reproducible example](/help/mcve)?","body":"Thanks for trying that. Can you share a <a href=\"/help/mcve\">minimal, reproducible example</a>?"},{"owner":{"account_id":1261634,"reputation":24551,"user_id":1219755,"accept_rate":84,"display_name":"alexanoid"},"score":0,"creation_date":1623421807,"post_id":67874510,"comment_id":120082522,"body_markdown":"Unfortunately, I&#39;m only able to catch such exception during execution of the application and receiving messages from Telegram API","body":"Unfortunately, I&#39;m only able to catch such exception during execution of the application and receiving messages from Telegram API"},{"owner":{"account_id":16236497,"reputation":199,"user_id":11723872,"display_name":"orid"},"score":1,"creation_date":1623671978,"post_id":67874510,"comment_id":120136769,"body_markdown":"For me - the /actuator/info endpoint stopped working after upgrading to sb 2.5.1, and fail with the same InvalidDefinitionException and jsr310 error regarding Instant type. \nIs the commit pointed by @Michael solved this issue ?","body":"For me - the /actuator/info endpoint stopped working after upgrading to sb 2.5.1, and fail with the same InvalidDefinitionException and jsr310 error regarding Instant type.  Is the commit pointed by @Michael solved this issue ?"},{"owner":{"account_id":1473276,"reputation":110999,"user_id":1384297,"accept_rate":100,"display_name":"Andy Wilkinson"},"score":0,"creation_date":1623672904,"post_id":67874510,"comment_id":120137108,"body_markdown":"The commit pointed to be @Michael is completely unrelated to the Actuator&#39;s info endpoint","body":"The commit pointed to be @Michael is completely unrelated to the Actuator&#39;s info endpoint"},{"owner":{"account_id":1261634,"reputation":24551,"user_id":1219755,"accept_rate":84,"display_name":"alexanoid"},"score":0,"creation_date":1623686245,"post_id":67874510,"comment_id":120143398,"body_markdown":"I don&#39;t have `Jackson2ObjectMappearBuilder&#39; on the application classpath in 2.4.5 and everything works correctly. Do I need to have `Jackson2ObjectMappearBuilder` on the classpath with SB 2.5.1 and if so, what Maven dependecy should I use for this purpose?","body":"I don&#39;t have <code>Jackson2ObjectMappearBuilder&#39; on the application classpath in 2.4.5 and everything works correctly. Do I need to have </code>Jackson2ObjectMappearBuilder` on the classpath with SB 2.5.1 and if so, what Maven dependecy should I use for this purpose?"},{"owner":{"account_id":1261634,"reputation":24551,"user_id":1219755,"accept_rate":84,"display_name":"alexanoid"},"score":0,"creation_date":1623687599,"post_id":67874510,"comment_id":120143988,"body_markdown":"@Andy Wilkinson I&#39;m testing right now, but looks like the issue is that I don&#39;t have `spring-web` Maven dependency on my application classpath. Anyway, I added `spring-web` Maven dependency to test this issue - but my Spring Boot application doesn&#39;t need `spring-web` because this is Telegram Bot","body":"@Andy Wilkinson I&#39;m testing right now, but looks like the issue is that I don&#39;t have <code>spring-web</code> Maven dependency on my application classpath. Anyway, I added <code>spring-web</code> Maven dependency to test this issue - but my Spring Boot application doesn&#39;t need <code>spring-web</code> because this is Telegram Bot"},{"owner":{"account_id":1261634,"reputation":24551,"user_id":1219755,"accept_rate":84,"display_name":"alexanoid"},"score":0,"creation_date":1623689010,"post_id":67874510,"comment_id":120144517,"body_markdown":"Unfortunately, adding spring-web to the classpath didn&#39;t help :(","body":"Unfortunately, adding spring-web to the classpath didn&#39;t help :("},{"owner":{"account_id":1473276,"reputation":110999,"user_id":1384297,"accept_rate":100,"display_name":"Andy Wilkinson"},"score":0,"creation_date":1623693395,"post_id":67874510,"comment_id":120146130,"body_markdown":"If you werent using `spring-web` then Spring Boot wont have been involved in configuring Jackson. Without it, `Jacskon2ObjectMapperBuilder`wont be available and Boots Jackson auto-configuration will back off.","body":"If you werent using <code>spring-web</code> then Spring Boot wont have been involved in configuring Jackson. Without it, <code>Jacskon2ObjectMapperBuilder</code>wont be available and Boots Jackson auto-configuration will back off."},{"owner":{"account_id":1261634,"reputation":24551,"user_id":1219755,"accept_rate":84,"display_name":"alexanoid"},"score":0,"creation_date":1623693491,"post_id":67874510,"comment_id":120146171,"body_markdown":"I added spring-web but it didnt help with this issue","body":"I added spring-web but it didnt help with this issue"},{"owner":{"account_id":326040,"reputation":3140,"user_id":647581,"display_name":"Patrick Herrera"},"score":0,"creation_date":1623709137,"post_id":67874510,"comment_id":120150936,"body_markdown":"@alexanoid No, 2.5.1 didn&#39;t fix it for me, but it turns out the issue was that in some tests we were creating ObjectMappers from scratch that didn&#39;t have the right modules registered.  Fixing that fixed the problem (and I didn&#39;t need to add `com.fasterxml.jackson.datatype:jackson-datatype-jsr310` as an explicit dependency either).\nStill not sure why this was never an issue before, but this fix should prevent future issues","body":"@alexanoid No, 2.5.1 didn&#39;t fix it for me, but it turns out the issue was that in some tests we were creating ObjectMappers from scratch that didn&#39;t have the right modules registered.  Fixing that fixed the problem (and I didn&#39;t need to add <code>com.fasterxml.jackson.datatype:jackson-datatype-jsr310</code> as an explicit dependency either). Still not sure why this was never an issue before, but this fix should prevent future issues"},{"owner":{"account_id":1261634,"reputation":24551,"user_id":1219755,"accept_rate":84,"display_name":"alexanoid"},"score":1,"creation_date":1626177059,"post_id":67874510,"comment_id":120818135,"body_markdown":"@AndyWilkinson you were right. After deep investigation I found the following code in the 3rdparty library `= new ObjectMapper();`  I added the following fix `ObjectMapper o = new ObjectMapper().registerModule(new JavaTimeModule());` and the issue is gone. Thank you!","body":"@AndyWilkinson you were right. After deep investigation I found the following code in the 3rdparty library <code>= new ObjectMapper();</code>  I added the following fix <code>ObjectMapper o = new ObjectMapper().registerModule(new JavaTimeModule());</code> and the issue is gone. Thank you!"}],"answers":[{"tags":[],"owner":{"account_id":51694,"reputation":1101,"user_id":1616612,"display_name":"Saifuddin Merchant"},"down_vote_count":2,"up_vote_count":35,"is_accepted":true,"score":33,"last_activity_date":1623687343,"creation_date":1623687343,"answer_id":67973800,"question_id":67874510,"body_markdown":"I saw an issue in one of my test classes. The problem there was it was creating a new ObjectMapper instance that was not adding the JavaTimeModule.\r\n\r\nHere is a sample test that works in Spring 2.4.5 but fails in 2.5.0/2.5.1 with com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Java 8 date/time type `java.time.ZonedDateTime` not supported by default\r\n\r\nIt might be due to the upgrade in the jackson-datatype-jsr310 version\r\n\r\n    package net.jpmchase.gti.gtfabric;\r\n    \r\n    import com.fasterxml.jackson.databind.ObjectMapper;\r\n    import org.junit.jupiter.api.Test;\r\n    \r\n    import java.time.ZonedDateTime;\r\n    \r\n    public class ObjectMapperTest {\r\n    \r\n        @Test\r\n        public void objectMapperTest() throws Exception{\r\n    \r\n            ZonedDateTime time = ZonedDateTime.now();\r\n            ObjectMapper o = new ObjectMapper();\r\n            o.writeValueAsString(time);\r\n        }\r\n    }\r\n\r\nTo fix this particular test case had to add an explicit\r\n\r\n    ObjectMapper o = new ObjectMapper();\r\n    o.registerModule(new JavaTimeModule()); \r\n\r\n","title":"Spring Boot 2.5.0 and InvalidDefinitionException: Java 8 date/time type `java.time.Instant` not supported by default","body":"<p>I saw an issue in one of my test classes. The problem there was it was creating a new ObjectMapper instance that was not adding the JavaTimeModule.</p>\n<p>Here is a sample test that works in Spring 2.4.5 but fails in 2.5.0/2.5.1 with com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Java 8 date/time type <code>java.time.ZonedDateTime</code> not supported by default</p>\n<p>It might be due to the upgrade in the jackson-datatype-jsr310 version</p>\n<pre><code>package net.jpmchase.gti.gtfabric;\n\nimport com.fasterxml.jackson.databind.ObjectMapper;\nimport org.junit.jupiter.api.Test;\n\nimport java.time.ZonedDateTime;\n\npublic class ObjectMapperTest {\n\n    @Test\n    public void objectMapperTest() throws Exception{\n\n        ZonedDateTime time = ZonedDateTime.now();\n        ObjectMapper o = new ObjectMapper();\n        o.writeValueAsString(time);\n    }\n}\n</code></pre>\n<p>To fix this particular test case had to add an explicit</p>\n<pre><code>ObjectMapper o = new ObjectMapper();\no.registerModule(new JavaTimeModule()); \n</code></pre>\n"},{"tags":[],"owner":{"account_id":5702783,"reputation":686,"user_id":4507281,"display_name":"Dawid wito-Maniakowski"},"down_vote_count":1,"up_vote_count":12,"is_accepted":false,"score":11,"last_activity_date":1625666000,"creation_date":1625666000,"answer_id":68287391,"question_id":67874510,"body_markdown":"Perhaps you are not using in your code Object Mapper provided by spring.\r\n\r\nWrong way:\r\n\r\n    ObjectMapper o = new ObjectMapper();\r\n\r\nCorrect way:\r\n\r\n    @Autowired\r\n    Jackson2ObjectMapperBuilder mapperBuilder;\r\n\r\n... \r\n\r\n    ObjectMapper mapper = mapperBuilder.build();\r\n\r\n","title":"Spring Boot 2.5.0 and InvalidDefinitionException: Java 8 date/time type `java.time.Instant` not supported by default","body":"<p>Perhaps you are not using in your code Object Mapper provided by spring.</p>\n<p>Wrong way:</p>\n<pre><code>ObjectMapper o = new ObjectMapper();\n</code></pre>\n<p>Correct way:</p>\n<pre><code>@Autowired\nJackson2ObjectMapperBuilder mapperBuilder;\n</code></pre>\n<p>...</p>\n<pre><code>ObjectMapper mapper = mapperBuilder.build();\n</code></pre>\n"},{"tags":[],"owner":{"account_id":38281,"reputation":2015,"user_id":109795,"accept_rate":88,"display_name":"Tom"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1642430266,"creation_date":1642430266,"answer_id":70743093,"question_id":67874510,"body_markdown":"In case you are using Spring Data Couchbase then this might be your problem:\r\nhttps://github.com/spring-projects/spring-data-couchbase/blame/4.2.x/src/main/java/org/springframework/data/couchbase/config/AbstractCouchbaseConfiguration.java#L309\r\n\r\nThe bug report is here:\r\nhttps://github.com/spring-projects/spring-data-couchbase/issues/1209\r\n\r\nThis has been fixed in Spring-Data-Couchbase 4.3","title":"Spring Boot 2.5.0 and InvalidDefinitionException: Java 8 date/time type `java.time.Instant` not supported by default","body":"<p>In case you are using Spring Data Couchbase then this might be your problem:\n<a href=\"https://github.com/spring-projects/spring-data-couchbase/blame/4.2.x/src/main/java/org/springframework/data/couchbase/config/AbstractCouchbaseConfiguration.java#L309\" rel=\"nofollow noreferrer\">https://github.com/spring-projects/spring-data-couchbase/blame/4.2.x/src/main/java/org/springframework/data/couchbase/config/AbstractCouchbaseConfiguration.java#L309</a></p>\n<p>The bug report is here:\n<a href=\"https://github.com/spring-projects/spring-data-couchbase/issues/1209\" rel=\"nofollow noreferrer\">https://github.com/spring-projects/spring-data-couchbase/issues/1209</a></p>\n<p>This has been fixed in Spring-Data-Couchbase 4.3</p>\n"},{"tags":[],"owner":{"account_id":2106266,"reputation":5117,"user_id":1872540,"display_name":"LovaBill"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1667292989,"creation_date":1667292989,"answer_id":74273536,"question_id":67874510,"body_markdown":"Posting a proper answer for the future me (that forgets):\r\n\r\n    @Configuration\r\n    public class JacksonConfig {\r\n\r\n    @Bean\r\n    public BatchConfigurer batchConfigurer(DataSource dataSource, PlatformTransactionManager transactionManager) {\r\n        return new DefaultBatchConfigurer(dataSource) {\r\n            @Override\r\n            protected JobRepository createJobRepository() throws Exception {\r\n                Jackson2ExecutionContextStringSerializer serializer = new Jackson2ExecutionContextStringSerializer();\r\n                ObjectMapper objectMapper = new ObjectMapper().registerModule(new JavaTimeModule()).findAndRegisterModules();\r\n                objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, true);\r\n                serializer.setObjectMapper(objectMapper);\r\n\r\n                JobRepositoryFactoryBean factory = new JobRepositoryFactoryBean();\r\n                factory.setDataSource(dataSource);\r\n                factory.setTransactionManager(transactionManager);\r\n                factory.setSerializer(serializer);\r\n                return factory.getObject();\r\n            }\r\n        };\r\n    }\r\n}\r\n\r\nSource: https://docs.spring.io/spring-batch/docs/current/reference/html/job.html ","title":"Spring Boot 2.5.0 and InvalidDefinitionException: Java 8 date/time type `java.time.Instant` not supported by default","body":"<p>Posting a proper answer for the future me (that forgets):</p>\n<pre><code>@Configuration\npublic class JacksonConfig {\n\n@Bean\npublic BatchConfigurer batchConfigurer(DataSource dataSource, PlatformTransactionManager transactionManager) {\n    return new DefaultBatchConfigurer(dataSource) {\n        @Override\n        protected JobRepository createJobRepository() throws Exception {\n            Jackson2ExecutionContextStringSerializer serializer = new Jackson2ExecutionContextStringSerializer();\n            ObjectMapper objectMapper = new ObjectMapper().registerModule(new JavaTimeModule()).findAndRegisterModules();\n            objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, true);\n            serializer.setObjectMapper(objectMapper);\n\n            JobRepositoryFactoryBean factory = new JobRepositoryFactoryBean();\n            factory.setDataSource(dataSource);\n            factory.setTransactionManager(transactionManager);\n            factory.setSerializer(serializer);\n            return factory.getObject();\n        }\n    };\n}\n</code></pre>\n<p>}</p>\n<p>Source: <a href=\"https://docs.spring.io/spring-batch/docs/current/reference/html/job.html\" rel=\"nofollow noreferrer\">https://docs.spring.io/spring-batch/docs/current/reference/html/job.html</a></p>\n"},{"tags":[],"owner":{"account_id":9925559,"reputation":430,"user_id":7347278,"accept_rate":86,"display_name":"V&#225;clav"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1688145205,"creation_date":1688145205,"answer_id":76591039,"question_id":67874510,"body_markdown":"While both Saifuddin Merchant and Dawid wito-Maniakowski have provided different but equally working ways to make the library \r\n\r\n```\r\n\r\n&lt;dependency&gt;\r\n    &lt;groupId&gt;com.fasterxml.jackson.datatype&lt;/groupId&gt;\r\n    &lt;artifactId&gt;jackson-datatype-jsr310&lt;/artifactId&gt;\r\n    &lt;version&gt;2.15.2&lt;/version&gt;\r\n&lt;/dependency&gt;\r\n\r\n```\r\n\r\nactually work, my proposal is to remove it from your `pom.xml` completely and to write your own serializer (_as an inner static class in this example_): \r\n\r\n```\r\npublic static class CustomDateSerializer extends com.fasterxml.jackson.databind.ser.std.StdSerializer&lt;LocalDateTime&gt; {\r\n\t    private static final long serialVersionUID = 4365897561L;\r\n\t    public CustomDateSerializer() { \r\n\t        this(null); \r\n\t    } \r\n\t    public CustomDateSerializer(Class&lt;LocalDateTime&gt; t) {\r\n\t        super(t); \r\n\t    }\r\n\t    @Override\r\n\t    public void serialize(\r\n\t    \t\tLocalDateTime value, JsonGenerator gen, SerializerProvider arg2) \r\n\t      throws IOException, JsonProcessingException {\r\n\t        gen.writeString(value.format(DateTimeFormatter.ofPattern(&quot;dd-MM-yyyy hh:mm:ss&quot;)));\r\n\t    }\r\n\t}\r\n\r\n```\r\n\r\nNext, annotate the time field of the object you want to serialize as JSON: \r\n\r\n```\r\n@JsonSerialize(using = CustomDateSerializer.class)\r\nprivate LocalDateTime time = LocalDateTime.now();\r\n\r\n```\r\n\r\nNot much of code, right? The `pom.xml` dependency is 5 lines of code itself. But then autowiring `Jackson2ObjectMapperBuilder` is 2 lines, or if you decide to go with registering `new JavaTimeModule()` then it would be much more lines of code since this JavaTimeModule provides inappropriate date time serialization (as an array of numbers!) out of the box, so you would be in need to wire your own formatter into this `JavaTimeModule` somehow... not what you want probably.\r\n\r\nWatch out for the generic type of the custom serializer - it is suited for `&lt;LocalDateTime&gt;` here. Just modify it to fit your needs.","title":"Spring Boot 2.5.0 and InvalidDefinitionException: Java 8 date/time type `java.time.Instant` not supported by default","body":"<p>While both Saifuddin Merchant and Dawid wito-Maniakowski have provided different but equally working ways to make the library</p>\n<pre><code>\n&lt;dependency&gt;\n    &lt;groupId&gt;com.fasterxml.jackson.datatype&lt;/groupId&gt;\n    &lt;artifactId&gt;jackson-datatype-jsr310&lt;/artifactId&gt;\n    &lt;version&gt;2.15.2&lt;/version&gt;\n&lt;/dependency&gt;\n\n</code></pre>\n<p>actually work, my proposal is to remove it from your <code>pom.xml</code> completely and to write your own serializer (<em>as an inner static class in this example</em>):</p>\n<pre><code>public static class CustomDateSerializer extends com.fasterxml.jackson.databind.ser.std.StdSerializer&lt;LocalDateTime&gt; {\n        private static final long serialVersionUID = 4365897561L;\n        public CustomDateSerializer() { \n            this(null); \n        } \n        public CustomDateSerializer(Class&lt;LocalDateTime&gt; t) {\n            super(t); \n        }\n        @Override\n        public void serialize(\n                LocalDateTime value, JsonGenerator gen, SerializerProvider arg2) \n          throws IOException, JsonProcessingException {\n            gen.writeString(value.format(DateTimeFormatter.ofPattern(&quot;dd-MM-yyyy hh:mm:ss&quot;)));\n        }\n    }\n\n</code></pre>\n<p>Next, annotate the time field of the object you want to serialize as JSON:</p>\n<pre><code>@JsonSerialize(using = CustomDateSerializer.class)\nprivate LocalDateTime time = LocalDateTime.now();\n\n</code></pre>\n<p>Not much of code, right? The <code>pom.xml</code> dependency is 5 lines of code itself. But then autowiring <code>Jackson2ObjectMapperBuilder</code> is 2 lines, or if you decide to go with registering <code>new JavaTimeModule()</code> then it would be much more lines of code since this JavaTimeModule provides inappropriate date time serialization (as an array of numbers!) out of the box, so you would be in need to wire your own formatter into this <code>JavaTimeModule</code> somehow... not what you want probably.</p>\n<p>Watch out for the generic type of the custom serializer - it is suited for <code>&lt;LocalDateTime&gt;</code> here. Just modify it to fit your needs.</p>\n"},{"tags":[],"owner":{"account_id":29077594,"reputation":1,"user_id":22274338,"display_name":"nerapa"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695353766,"creation_date":1695353766,"answer_id":77154727,"question_id":67874510,"body_markdown":"I faced the same issue with Spring 3.1.2, after trying different approaches the solution that worked for me was composed of 2 changes:\r\n\r\n- Adding the dependency as follows (this project uses gradle)\r\n\r\n`implementation &#39;com.fasterxml.jackson.datatype:jackson-datatype-jsr310:2.15.2&#39;`\r\n\r\n- Adding this annotation to the Instant property that was causing the problem\r\n\r\n`@JsonSerialize(using = InstantSerializer.class)`","title":"Spring Boot 2.5.0 and InvalidDefinitionException: Java 8 date/time type `java.time.Instant` not supported by default","body":"<p>I faced the same issue with Spring 3.1.2, after trying different approaches the solution that worked for me was composed of 2 changes:</p>\n<ul>\n<li>Adding the dependency as follows (this project uses gradle)</li>\n</ul>\n<p><code>implementation 'com.fasterxml.jackson.datatype:jackson-datatype-jsr310:2.15.2'</code></p>\n<ul>\n<li>Adding this annotation to the Instant property that was causing the problem</li>\n</ul>\n<p><code>@JsonSerialize(using = InstantSerializer.class)</code></p>\n"}],"owner":{"account_id":1261634,"reputation":24551,"user_id":1219755,"accept_rate":84,"display_name":"alexanoid"},"comment_count":22,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":29316,"favorite_count":0,"down_vote_count":0,"up_vote_count":17,"accepted_answer_id":67973800,"answer_count":6,"score":17,"last_activity_date":1695353766,"creation_date":1623079861,"question_id":67874510,"body_markdown":"After update from Spring Boot 2.4.5 to Spring 2.5.0 I noticed the following exceptions in the application logs:\r\n\r\n    Caused by: com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Java 8 date/time type `java.time.Instant` not supported by default: add Module &quot;com.fasterxml.jackson.datatype:jackson-datatype-jsr310&quot; to enable handling (through reference chain: org.telegram.telegrambots.meta.api.objects.Update[&quot;my_chat_member&quot;]-&gt;org.telegram.telegrambots.meta.api.objects.ChatMemberUpdated[&quot;new_chat_member&quot;]-&gt;org.telegram.telegrambots.meta.api.objects.ChatMember[&quot;untilDateAsInstant&quot;])\r\n    \tat com.fasterxml.jackson.databind.exc.InvalidDefinitionException.from(InvalidDefinitionException.java:77) ~[jackson-databind-2.12.3.jar!/:2.12.3]\r\n    \tat com.fasterxml.jackson.databind.SerializerProvider.reportBadDefinition(SerializerProvider.java:1276) ~[jackson-databind-2.12.3.jar!/:2.12.3]\r\n    \tat com.fasterxml.jackson.databind.ser.impl.UnsupportedTypeSerializer.serialize(UnsupportedTypeSerializer.java:35) ~[jackson-databind-2.12.3.jar!/:2.12.3]\r\n    \tat com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:728) ~[jackson-databind-2.12.3.jar!/:2.12.3]\r\n    \tat com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:770) ~[jackson-databind-2.12.3.jar!/:2.12.3]\r\n    \tat com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:178) ~[jackson-databind-2.12.3.jar!/:2.12.3]\r\n    \tat com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:728) ~[jackson-databind-2.12.3.jar!/:2.12.3]\r\n    \tat com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:770) ~[jackson-databind-2.12.3.jar!/:2.12.3]\r\n    \tat com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:178) ~[jackson-databind-2.12.3.jar!/:2.12.3]\r\n    \tat com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:728) ~[jackson-databind-2.12.3.jar!/:2.12.3]\r\n    \tat com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:770) ~[jackson-databind-2.12.3.jar!/:2.12.3]\r\n    \tat com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:178) ~[jackson-databind-2.12.3.jar!/:2.12.3]\r\n    \tat com.fasterxml.jackson.databind.ser.DefaultSerializerProvider._serialize(DefaultSerializerProvider.java:480) ~[jackson-databind-2.12.3.jar!/:2.12.3]\r\n    \tat com.fasterxml.jackson.databind.ser.DefaultSerializerProvider.serializeValue(DefaultSerializerProvider.java:319) ~[jackson-databind-2.12.3.jar!/:2.12.3]\r\n    \tat com.fasterxml.jackson.databind.ObjectWriter$Prefetch.serialize(ObjectWriter.java:1514) ~[jackson-databind-2.12.3.jar!/:2.12.3]\r\n    \tat com.fasterxml.jackson.databind.ObjectWriter._writeValueAndClose(ObjectWriter.java:1215) ~[jackson-databind-2.12.3.jar!/:2.12.3]\r\n    \tat com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1059) ~[jackson-databind-2.12.3.jar!/:2.12.3]\r\n    \tat org.springframework.jms.support.converter.MappingJackson2MessageConverter.mapToTextMessage(MappingJackson2MessageConverter.java:279) ~[spring-jms-5.3.7.jar!/:5.3.7]\r\n    \tat org.springframework.jms.support.converter.MappingJackson2MessageConverter.toMessage(MappingJackson2MessageConverter.java:184) ~[spring-jms-5.3.7.jar!/:5.3.7]\r\n    \t... 37 common frames omitted\r\n\r\nthis is my pom.xml:\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;com.fasterxml.jackson.datatype&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;jackson-datatype-jsr310&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;jackson-core&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;jackson-annotations&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\nI reverted to Spring Boot 2.4.5 and not everything works fine. What may be wrong with Spring Boot 2.5.0 ? \r\n\r\n**Updated**\r\n\r\nThe corresponding GitHub https://github.com/spring-projects/spring-boot/issues/26859","title":"Spring Boot 2.5.0 and InvalidDefinitionException: Java 8 date/time type `java.time.Instant` not supported by default","body":"<p>After update from Spring Boot 2.4.5 to Spring 2.5.0 I noticed the following exceptions in the application logs:</p>\n<pre><code>Caused by: com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Java 8 date/time type `java.time.Instant` not supported by default: add Module &quot;com.fasterxml.jackson.datatype:jackson-datatype-jsr310&quot; to enable handling (through reference chain: org.telegram.telegrambots.meta.api.objects.Update[&quot;my_chat_member&quot;]-&gt;org.telegram.telegrambots.meta.api.objects.ChatMemberUpdated[&quot;new_chat_member&quot;]-&gt;org.telegram.telegrambots.meta.api.objects.ChatMember[&quot;untilDateAsInstant&quot;])\n    at com.fasterxml.jackson.databind.exc.InvalidDefinitionException.from(InvalidDefinitionException.java:77) ~[jackson-databind-2.12.3.jar!/:2.12.3]\n    at com.fasterxml.jackson.databind.SerializerProvider.reportBadDefinition(SerializerProvider.java:1276) ~[jackson-databind-2.12.3.jar!/:2.12.3]\n    at com.fasterxml.jackson.databind.ser.impl.UnsupportedTypeSerializer.serialize(UnsupportedTypeSerializer.java:35) ~[jackson-databind-2.12.3.jar!/:2.12.3]\n    at com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:728) ~[jackson-databind-2.12.3.jar!/:2.12.3]\n    at com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:770) ~[jackson-databind-2.12.3.jar!/:2.12.3]\n    at com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:178) ~[jackson-databind-2.12.3.jar!/:2.12.3]\n    at com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:728) ~[jackson-databind-2.12.3.jar!/:2.12.3]\n    at com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:770) ~[jackson-databind-2.12.3.jar!/:2.12.3]\n    at com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:178) ~[jackson-databind-2.12.3.jar!/:2.12.3]\n    at com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:728) ~[jackson-databind-2.12.3.jar!/:2.12.3]\n    at com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:770) ~[jackson-databind-2.12.3.jar!/:2.12.3]\n    at com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:178) ~[jackson-databind-2.12.3.jar!/:2.12.3]\n    at com.fasterxml.jackson.databind.ser.DefaultSerializerProvider._serialize(DefaultSerializerProvider.java:480) ~[jackson-databind-2.12.3.jar!/:2.12.3]\n    at com.fasterxml.jackson.databind.ser.DefaultSerializerProvider.serializeValue(DefaultSerializerProvider.java:319) ~[jackson-databind-2.12.3.jar!/:2.12.3]\n    at com.fasterxml.jackson.databind.ObjectWriter$Prefetch.serialize(ObjectWriter.java:1514) ~[jackson-databind-2.12.3.jar!/:2.12.3]\n    at com.fasterxml.jackson.databind.ObjectWriter._writeValueAndClose(ObjectWriter.java:1215) ~[jackson-databind-2.12.3.jar!/:2.12.3]\n    at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1059) ~[jackson-databind-2.12.3.jar!/:2.12.3]\n    at org.springframework.jms.support.converter.MappingJackson2MessageConverter.mapToTextMessage(MappingJackson2MessageConverter.java:279) ~[spring-jms-5.3.7.jar!/:5.3.7]\n    at org.springframework.jms.support.converter.MappingJackson2MessageConverter.toMessage(MappingJackson2MessageConverter.java:184) ~[spring-jms-5.3.7.jar!/:5.3.7]\n    ... 37 common frames omitted\n</code></pre>\n<p>this is my pom.xml:</p>\n<pre><code>    &lt;dependency&gt;\n        &lt;groupId&gt;com.fasterxml.jackson.datatype&lt;/groupId&gt;\n        &lt;artifactId&gt;jackson-datatype-jsr310&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n        &lt;artifactId&gt;jackson-core&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n        &lt;artifactId&gt;jackson-annotations&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n        &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n</code></pre>\n<p>I reverted to Spring Boot 2.4.5 and not everything works fine. What may be wrong with Spring Boot 2.5.0 ?</p>\n<p><strong>Updated</strong></p>\n<p>The corresponding GitHub <a href=\"https://github.com/spring-projects/spring-boot/issues/26859\" rel=\"noreferrer\">https://github.com/spring-projects/spring-boot/issues/26859</a></p>\n"},{"tags":["java","rmi"],"comments":[{"owner":{"account_id":3421244,"reputation":35863,"user_id":2868801,"display_name":"dave_thompson_085"},"score":1,"creation_date":1695338139,"post_id":77153765,"comment_id":136014782,"body_markdown":"@erickson: on Unix 1..1023 are privileged (and 0 isn&#39;t used because the socket calls replace it), but I don&#39;t know any system where 1099 is. OP: I don&#39;t think you can use the same port (on the same machine) for the registry and the server, but I don&#39;t have time to test right now. What Java are you using, and on what platform (at least OS, maybe ISA)?","body":"@erickson: on Unix 1..1023 are privileged (and 0 isn&#39;t used because the socket calls replace it), but I don&#39;t know any system where 1099 is. OP: I don&#39;t think you can use the same port (on the same machine) for the registry and the server, but I don&#39;t have time to test right now. What Java are you using, and on what platform (at least OS, maybe ISA)?"},{"owner":{"account_id":71739,"reputation":307142,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":0,"creation_date":1695338888,"post_id":77153765,"comment_id":136014854,"body_markdown":"You need to tell us whether the client got that exception on the lookup or on the RMI call. @dave_thompson_085 You can only reuse the same port for Registry and server if you start the Registry in the same JVM, but the OP isn&#39;t doing that. His `Server` object will use a system-allocated port, and it is only using the port on the command line to contact the Registry which is using it.","body":"You need to tell us whether the client got that exception on the lookup or on the RMI call. @dave_thompson_085 You can only reuse the same port for Registry and server if you start the Registry in the same JVM, but the OP isn&#39;t doing that. His <code>Server</code> object will use a system-allocated port, and it is only using the port on the command line to contact the Registry which is using it."},{"owner":{"account_id":1639049,"reputation":1,"user_id":1511862,"display_name":"William Dickerson"},"score":0,"creation_date":1695352625,"post_id":77153765,"comment_id":136015961,"body_markdown":"I edited the question to answer some of your comments. I think having root start the server may be the answer but the Oracle example doesn&#39;t mention that. Thank you.","body":"I edited the question to answer some of your comments. I think having root start the server may be the answer but the Oracle example doesn&#39;t mention that. Thank you."},{"owner":{"account_id":1639049,"reputation":1,"user_id":1511862,"display_name":"William Dickerson"},"score":0,"creation_date":1695353302,"post_id":77153765,"comment_id":136015998,"body_markdown":"Also, I don&#39;t know if I tried having the server create the registry when I tried other users. I&#39;ll try that.","body":"Also, I don&#39;t know if I tried having the server create the registry when I tried other users. I&#39;ll try that."},{"owner":{"account_id":2496,"reputation":266234,"user_id":3474,"accept_rate":83,"display_name":"erickson"},"score":0,"creation_date":1695361838,"post_id":77153765,"comment_id":136016682,"body_markdown":"You&#39;re right. Not sure what I was thinking. 1099 is fine.","body":"You&#39;re right. Not sure what I was thinking. 1099 is fine."},{"owner":{"account_id":71739,"reputation":307142,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":0,"creation_date":1695365147,"post_id":77153765,"comment_id":136017094,"body_markdown":"This is the *server* getting `connection refused`, to the Registry. *Ergo* there is something wrong with the configuration of `localhost` in that host. Try `127.0.0.1`. BTW Using a `file://` codebase is a complete waste of time unless the clients are in the same host, as they won&#39;t be able to use it: and, if the clients are in the same host, you don&#39;t need the codebase feature at all.","body":"This is the <i>server</i> getting <code>connection refused</code>, to the Registry. <i>Ergo</i> there is something wrong with the configuration of <code>localhost</code> in that host. Try <code>127.0.0.1</code>. BTW Using a <code>file:&#47;&#47;</code> codebase is a complete waste of time unless the clients are in the same host, as they won&#39;t be able to use it: and, if the clients are in the same host, you don&#39;t need the codebase feature at all."},{"owner":{"account_id":1639049,"reputation":1,"user_id":1511862,"display_name":"William Dickerson"},"score":0,"creation_date":1695399052,"post_id":77153765,"comment_id":136023912,"body_markdown":"I tested on another PC (Centos 8) and it worked for the other user for both localhost and 127.0.0.1.  They will be on the same host so I took out codebase.  The first PC is Centos 7.  &quot;/etc/hosts&quot; localhost looks the same as the 2nd PC so I don&#39;t know what&#39;s wrong with localhost.  Ping returns 127.0.0.1.  Traceroute localhost or 127.0.0.1 is the same.","body":"I tested on another PC (Centos 8) and it worked for the other user for both localhost and 127.0.0.1.  They will be on the same host so I took out codebase.  The first PC is Centos 7.  &quot;/etc/hosts&quot; localhost looks the same as the 2nd PC so I don&#39;t know what&#39;s wrong with localhost.  Ping returns 127.0.0.1.  Traceroute localhost or 127.0.0.1 is the same."},{"owner":{"account_id":71739,"reputation":307142,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":0,"creation_date":1695459132,"post_id":77153765,"comment_id":136029584,"body_markdown":"Well it seems that your Registry isn&#39;t starting on some of your hosts for some reason.","body":"Well it seems that your Registry isn&#39;t starting on some of your hosts for some reason."}],"owner":{"account_id":1639049,"reputation":1,"user_id":1511862,"display_name":"William Dickerson"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":52,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1695352734,"creation_date":1695331918,"question_id":77153765,"body_markdown":"I&#39;ve been using RMI for years but now I have a problem I would like to fix on my development PC before I eliminate RMI.  (We no longer need RPCs.)  I must have mangled something and now RMI only works for me and root (firewall stopped or not).  I&#39;ve been working on this all week and finally tried a simple test program.  This was the Oracle Hello RMI example.  I stopped and disabled rmiregistry and all Java programs that were running. The other user gets &quot;host:localhost port:1099&quot; then the infamous \r\n&quot;Server exception: java.rmi.ConnectException: Connection refused to host.&quot;  Running the script with sudo connects as expected.\r\n\r\ngo script\r\n```\r\n#!/bin/bash\r\n#\r\n#\r\n\r\nport=&quot;$1&quot;\r\n[[ $port = &quot;&quot; ]] &amp;&amp; port=&quot;1099&quot;\r\n\r\nip=&quot;localhost&quot;\r\n#ip=&quot;127.0.0.1&quot;\r\n\r\n#sudo systemctl stop rmiregistry\r\n\r\nwhile true; do sudo netstat -a --numeric-ports|grep $port; if [ $? -eq 0 ]; then echo -e &quot;$port is in use - waiting&quot;; sleep 1; else break; fi; done\r\n\r\nJAVA_BIN=&quot;/usr/java/jdk/bin&quot;\r\n\r\n$JAVA_BIN/javac -d &quot;.&quot; *.java\r\n\r\n$JAVA_BIN/rmiregistry $port &amp;\r\nrmiregistryPID=$!\r\necho -n &quot;rmiregistry:&quot;;ps -p $rmiregistryPID\r\n\r\nclassDir=&quot;.&quot;\r\n\r\n#strace\r\n$JAVA_BIN/java -classpath $classDir \\\r\n    -Djava.rmi.server.codebase=file:$classDir/ \\\r\n    -Djava.rmi.server.hostname=$ip \\\r\n    example.hello.Server $ip $port &amp;\r\nserverPID=$!\r\necho\r\n\r\nsleep 5;echo -e &quot;\\nServer PID:&quot;;ps -p $serverPID\r\n\r\n$JAVA_BIN/java  -classpath $classDir example.hello.Client $ip $port\r\nclientPID=$!;kill $clientPID\r\n\r\necho\r\nkill $rmiregistryPID; ps -p $rmiregistryPID\r\nkill $serverPID;ps -p $serverPID\r\n```\r\nHello.java\r\n```\r\npackage example.hello;\r\n\r\nimport java.rmi.Remote;\r\nimport java.rmi.RemoteException;\r\n\r\npublic interface Hello extends Remote {\r\n    String sayHello() throws RemoteException;\r\n}\r\n```\r\n\r\nServer.java\r\n```\r\npackage example.hello;\r\n\r\nimport java.rmi.registry.Registry;\r\nimport java.rmi.registry.LocateRegistry;\r\nimport java.rmi.Naming;\r\nimport java.rmi.RemoteException;\r\nimport java.rmi.server.UnicastRemoteObject;\r\n\r\npublic class Server extends UnicastRemoteObject implements Hello {\r\n\r\n    public Server() throws RemoteException {}\r\n\r\n    public String sayHello() throws RemoteException {\r\n        try {\r\n            return &quot;Hello, world!&quot;;\r\n        } catch (Exception ex) {\r\n            System.err.println(&quot;Server exception: &quot; + ex.toString());\r\n            ex.printStackTrace();\r\n            return &quot;error&quot;;\r\n        }\r\n    }\r\n\r\n    public static void main(String args[]) {\r\n\r\n        try {\r\n            String host = (args.length &lt; 1) ? &quot;127.0.0.1&quot; : args[0];\r\n            String portString = (args.length &lt; 2) ? &quot;1099&quot; : args[1];\r\n            int port = Integer.parseInt(portString);\r\n            System.out.println(&quot;host:&quot;+host+&quot; port:&quot;+port);\r\n\r\n            Server obj = new Server();\r\n\r\n            //LocateRegistry.createRegistry(port);\r\n            String name = &quot;//&quot;+host+&quot;:&quot;+port+&quot;/Hello&quot;;\r\n            Naming.rebind(name, obj);\r\n            System.out.println(&quot;Server ready; host:&quot;+host+&quot; port:&quot;+port);\r\n        } catch (Exception ex) {\r\n            System.err.println(&quot;Server exception: &quot; + ex.toString());\r\n            ex.printStackTrace();\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nClient.java\r\n```\r\npackage example.hello;\r\n\r\nimport java.rmi.registry.LocateRegistry;\r\nimport java.rmi.registry.Registry;\r\n\r\npublic class Client {\r\n\r\n    private Client() {}\r\n\r\n    public static void main(String[] args) {\r\n\r\n        String host = (args.length &lt; 1) ? null : args[0];\r\n        String portString = (args.length &lt; 2) ? &quot;1099&quot; : args[1];\r\n        int port = Integer.parseInt(portString);\r\n        System.out.println(&quot;host:&quot;+host+&quot; port:&quot;+port);\r\n        try {\r\n            Registry registry = LocateRegistry.getRegistry(host, port);\r\n            Hello stub = (Hello) registry.lookup(&quot;Hello&quot;);\r\n            String response = stub.sayHello();\r\n            System.out.println(&quot;\\nresponse: &quot; + response);\r\n        } catch (Exception e) {\r\n            System.err.println(&quot;Client exception: &quot; + e.toString());\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n}\r\n```\r\nI tried copying the example directory and making everything owned by the other user.  I also tried strace on the server but the result looked the same.\r\n\r\nMore info: The example works for me or root but not for other users. The exception occurs when the server tries to bind to the rmiregistry. I tried other ports. We&#39;ve used 1099 for years and that&#39;s the default if you don&#39;t supply a port. I tried with the firewall stopped.\r\n\r\nWhen I have a chance, I&#39;m going to try having root start the server. Our system starts the registry and server at boot.\r\n\r\nThanks","title":"Why does this Hello RMI example work for me or root but not for other users?","body":"<p>I've been using RMI for years but now I have a problem I would like to fix on my development PC before I eliminate RMI.  (We no longer need RPCs.)  I must have mangled something and now RMI only works for me and root (firewall stopped or not).  I've been working on this all week and finally tried a simple test program.  This was the Oracle Hello RMI example.  I stopped and disabled rmiregistry and all Java programs that were running. The other user gets &quot;host:localhost port:1099&quot; then the infamous\n&quot;Server exception: java.rmi.ConnectException: Connection refused to host.&quot;  Running the script with sudo connects as expected.</p>\n<p>go script</p>\n<pre><code>#!/bin/bash\n#\n#\n\nport=&quot;$1&quot;\n[[ $port = &quot;&quot; ]] &amp;&amp; port=&quot;1099&quot;\n\nip=&quot;localhost&quot;\n#ip=&quot;127.0.0.1&quot;\n\n#sudo systemctl stop rmiregistry\n\nwhile true; do sudo netstat -a --numeric-ports|grep $port; if [ $? -eq 0 ]; then echo -e &quot;$port is in use - waiting&quot;; sleep 1; else break; fi; done\n\nJAVA_BIN=&quot;/usr/java/jdk/bin&quot;\n\n$JAVA_BIN/javac -d &quot;.&quot; *.java\n\n$JAVA_BIN/rmiregistry $port &amp;\nrmiregistryPID=$!\necho -n &quot;rmiregistry:&quot;;ps -p $rmiregistryPID\n\nclassDir=&quot;.&quot;\n\n#strace\n$JAVA_BIN/java -classpath $classDir \\\n    -Djava.rmi.server.codebase=file:$classDir/ \\\n    -Djava.rmi.server.hostname=$ip \\\n    example.hello.Server $ip $port &amp;\nserverPID=$!\necho\n\nsleep 5;echo -e &quot;\\nServer PID:&quot;;ps -p $serverPID\n\n$JAVA_BIN/java  -classpath $classDir example.hello.Client $ip $port\nclientPID=$!;kill $clientPID\n\necho\nkill $rmiregistryPID; ps -p $rmiregistryPID\nkill $serverPID;ps -p $serverPID\n</code></pre>\n<p>Hello.java</p>\n<pre><code>package example.hello;\n\nimport java.rmi.Remote;\nimport java.rmi.RemoteException;\n\npublic interface Hello extends Remote {\n    String sayHello() throws RemoteException;\n}\n</code></pre>\n<p>Server.java</p>\n<pre><code>package example.hello;\n\nimport java.rmi.registry.Registry;\nimport java.rmi.registry.LocateRegistry;\nimport java.rmi.Naming;\nimport java.rmi.RemoteException;\nimport java.rmi.server.UnicastRemoteObject;\n\npublic class Server extends UnicastRemoteObject implements Hello {\n\n    public Server() throws RemoteException {}\n\n    public String sayHello() throws RemoteException {\n        try {\n            return &quot;Hello, world!&quot;;\n        } catch (Exception ex) {\n            System.err.println(&quot;Server exception: &quot; + ex.toString());\n            ex.printStackTrace();\n            return &quot;error&quot;;\n        }\n    }\n\n    public static void main(String args[]) {\n\n        try {\n            String host = (args.length &lt; 1) ? &quot;127.0.0.1&quot; : args[0];\n            String portString = (args.length &lt; 2) ? &quot;1099&quot; : args[1];\n            int port = Integer.parseInt(portString);\n            System.out.println(&quot;host:&quot;+host+&quot; port:&quot;+port);\n\n            Server obj = new Server();\n\n            //LocateRegistry.createRegistry(port);\n            String name = &quot;//&quot;+host+&quot;:&quot;+port+&quot;/Hello&quot;;\n            Naming.rebind(name, obj);\n            System.out.println(&quot;Server ready; host:&quot;+host+&quot; port:&quot;+port);\n        } catch (Exception ex) {\n            System.err.println(&quot;Server exception: &quot; + ex.toString());\n            ex.printStackTrace();\n        }\n    }\n}\n</code></pre>\n<p>Client.java</p>\n<pre><code>package example.hello;\n\nimport java.rmi.registry.LocateRegistry;\nimport java.rmi.registry.Registry;\n\npublic class Client {\n\n    private Client() {}\n\n    public static void main(String[] args) {\n\n        String host = (args.length &lt; 1) ? null : args[0];\n        String portString = (args.length &lt; 2) ? &quot;1099&quot; : args[1];\n        int port = Integer.parseInt(portString);\n        System.out.println(&quot;host:&quot;+host+&quot; port:&quot;+port);\n        try {\n            Registry registry = LocateRegistry.getRegistry(host, port);\n            Hello stub = (Hello) registry.lookup(&quot;Hello&quot;);\n            String response = stub.sayHello();\n            System.out.println(&quot;\\nresponse: &quot; + response);\n        } catch (Exception e) {\n            System.err.println(&quot;Client exception: &quot; + e.toString());\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>\n<p>I tried copying the example directory and making everything owned by the other user.  I also tried strace on the server but the result looked the same.</p>\n<p>More info: The example works for me or root but not for other users. The exception occurs when the server tries to bind to the rmiregistry. I tried other ports. We've used 1099 for years and that's the default if you don't supply a port. I tried with the firewall stopped.</p>\n<p>When I have a chance, I'm going to try having root start the server. Our system starts the registry and server at boot.</p>\n<p>Thanks</p>\n"},{"tags":["java","spring","spring-boot"],"comments":[{"owner":{"account_id":4470050,"reputation":68258,"user_id":3636601,"accept_rate":75,"display_name":"Jens"},"score":0,"creation_date":1695059174,"post_id":77129318,"comment_id":135970710,"body_markdown":"Please take care of java naming conventions. package names should be lower case","body":"Please take care of java naming conventions. package names should be lower case"},{"owner":{"account_id":25505810,"reputation":29,"user_id":20370750,"display_name":"dddryinside"},"score":0,"creation_date":1695059352,"post_id":77129318,"comment_id":135970743,"body_markdown":"I didn&#39;t change anything in the package names and the application always worked correctly","body":"I didn&#39;t change anything in the package names and the application always worked correctly"},{"owner":{"account_id":4470050,"reputation":68258,"user_id":3636601,"accept_rate":75,"display_name":"Jens"},"score":0,"creation_date":1695059425,"post_id":77129318,"comment_id":135970755,"body_markdown":"Try to rebuild you project","body":"Try to rebuild you project"},{"owner":{"account_id":25505810,"reputation":29,"user_id":20370750,"display_name":"dddryinside"},"score":0,"creation_date":1695059565,"post_id":77129318,"comment_id":135970776,"body_markdown":"I&#39;ve already tried it - it doesn&#39;t help!","body":"I&#39;ve already tried it - it doesn&#39;t help!"},{"owner":{"account_id":4470050,"reputation":68258,"user_id":3636601,"accept_rate":75,"display_name":"Jens"},"score":0,"creation_date":1695059675,"post_id":77129318,"comment_id":135970796,"body_markdown":"Can you share a picture of the file structure and how you run the program?","body":"Can you share a picture of the file structure and how you run the program?"},{"owner":{"account_id":25505810,"reputation":29,"user_id":20370750,"display_name":"dddryinside"},"score":0,"creation_date":1695059883,"post_id":77129318,"comment_id":135970842,"body_markdown":"I run project using green triangle near class name","body":"I run project using green triangle near class name"},{"owner":{"account_id":4470050,"reputation":68258,"user_id":3636601,"accept_rate":75,"display_name":"Jens"},"score":0,"creation_date":1695059996,"post_id":77129318,"comment_id":135970855,"body_markdown":"https://www.geeksforgeeks.org/how-to-run-your-first-spring-boot-application-in-intellij-idea/","body":"<a href=\"https://www.geeksforgeeks.org/how-to-run-your-first-spring-boot-application-in-intellij-idea/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/&hellip;</a>"},{"owner":{"account_id":25505810,"reputation":29,"user_id":20370750,"display_name":"dddryinside"},"score":0,"creation_date":1695060191,"post_id":77129318,"comment_id":135970886,"body_markdown":"Thank you, but I know wery well how run projects in intelleje idea. Also, I taked screenshot which reflects structure of my project, pleese, look at it","body":"Thank you, but I know wery well how run projects in intelleje idea. Also, I taked screenshot which reflects structure of my project, pleese, look at it"}],"answers":[{"tags":[],"owner":{"account_id":29073167,"reputation":1013,"user_id":22270964,"display_name":"Maksim Eliseev"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695061098,"creation_date":1695061098,"answer_id":77129566,"question_id":77129318,"body_markdown":"Obviously something is wrong with your project. I can see the outer project `MusicJournal` and then the other `MusicJournal` project inside. This is kind of a weird identification of the project by Intellij IDEA. \r\n\r\nYou should delete your project from Intellij IDEA, take a look at the directory hierarchy, and then import the project again.","title":"Could not find or load main class in Spring Application","body":"<p>Obviously something is wrong with your project. I can see the outer project <code>MusicJournal</code> and then the other <code>MusicJournal</code> project inside. This is kind of a weird identification of the project by Intellij IDEA.</p>\n<p>You should delete your project from Intellij IDEA, take a look at the directory hierarchy, and then import the project again.</p>\n"},{"tags":[],"owner":{"account_id":26604716,"reputation":1,"user_id":20225791,"display_name":"etolzheesch"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695111450,"creation_date":1695111450,"answer_id":77132796,"question_id":77129318,"body_markdown":"Basically, what I see in your picture is you have two MusicJournal projects with two .idea folders which include the metainformation of you projects. They may cause conflict. Try to recreate structure with only one project so that you have only one .idea, .mvn etc. folders and build project again","title":"Could not find or load main class in Spring Application","body":"<p>Basically, what I see in your picture is you have two MusicJournal projects with two .idea folders which include the metainformation of you projects. They may cause conflict. Try to recreate structure with only one project so that you have only one .idea, .mvn etc. folders and build project again</p>\n"},{"tags":[],"owner":{"account_id":10206781,"reputation":179,"user_id":7535274,"display_name":"HaiZi"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695352439,"creation_date":1695352439,"answer_id":77154673,"question_id":77129318,"body_markdown":"You can specify the main class in the pom.xml file\r\n```xml\r\n    &lt;build&gt;\r\n        &lt;plugins&gt;\r\n            &lt;plugin&gt;\r\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n                &lt;version&gt;2.1.18.RELEASE&lt;/version&gt;\r\n                &lt;configuration&gt;\r\n                    &lt;mainClass&gt;your main class&lt;/mainClass&gt;\r\n                &lt;/configuration&gt;\r\n                &lt;executions&gt;\r\n                    &lt;execution&gt;\r\n                        &lt;id&gt;repackage&lt;/id&gt;\r\n                        &lt;goals&gt;\r\n                            &lt;goal&gt;repackage&lt;/goal&gt;\r\n                        &lt;/goals&gt;\r\n                    &lt;/execution&gt;\r\n                &lt;/executions&gt;\r\n            &lt;/plugin&gt;\r\n        &lt;/plugins&gt;\r\n    &lt;/build&gt;\r\n```","title":"Could not find or load main class in Spring Application","body":"<p>You can specify the main class in the pom.xml file</p>\n<pre class=\"lang-xml prettyprint-override\"><code>    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n                &lt;version&gt;2.1.18.RELEASE&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;mainClass&gt;your main class&lt;/mainClass&gt;\n                &lt;/configuration&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;id&gt;repackage&lt;/id&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;repackage&lt;/goal&gt;\n                        &lt;/goals&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n</code></pre>\n"}],"owner":{"account_id":25505810,"reputation":29,"user_id":20370750,"display_name":"dddryinside"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":57,"favorite_count":0,"down_vote_count":2,"up_vote_count":1,"answer_count":3,"score":-1,"last_activity_date":1695352439,"creation_date":1695058854,"question_id":77129318,"body_markdown":"I create my web site on Spring and everything was going well, but in one second my application stopped starting and I see such a mistake: \r\n```\r\nError: Could not find or load main class com.MusicJournal.MusicJournal.MusicJournalApplication\r\nCaused by: java.lang.ClassNotFoundException: com.MusicJournal.MusicJournal.MusicJournalApplication\r\n```\r\n\r\nThis is my main class:\r\n```\r\npackage com.MusicJournal.MusicJournal;\r\n\r\nimport org.springframework.boot.SpringApplication;\r\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\r\n\r\n@SpringBootApplication\r\npublic class MusicJournalApplication {\r\n\r\n\tpublic static void main(String[] args) {\r\n\t\tSpringApplication.run(MusicJournalApplication.class, args);\r\n\t}\r\n\r\n}\r\n```\r\n\r\nI tryed to rebuild project, reload IDE and PC, but it didn&#39;t help. It looks like a bug. So, how can I fix it?\r\n\r\nP.S. I use Intellije IDEA; Structure of my project on screenshot\r\n[enter image description here][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/W7MyN.png","title":"Could not find or load main class in Spring Application","body":"<p>I create my web site on Spring and everything was going well, but in one second my application stopped starting and I see such a mistake:</p>\n<pre><code>Error: Could not find or load main class com.MusicJournal.MusicJournal.MusicJournalApplication\nCaused by: java.lang.ClassNotFoundException: com.MusicJournal.MusicJournal.MusicJournalApplication\n</code></pre>\n<p>This is my main class:</p>\n<pre><code>package com.MusicJournal.MusicJournal;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class MusicJournalApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(MusicJournalApplication.class, args);\n    }\n\n}\n</code></pre>\n<p>I tryed to rebuild project, reload IDE and PC, but it didn't help. It looks like a bug. So, how can I fix it?</p>\n<p>P.S. I use Intellije IDEA; Structure of my project on screenshot\n<a href=\"https://i.stack.imgur.com/W7MyN.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"},{"tags":["java","maven","jlink","moditect"],"comments":[{"owner":{"account_id":112317,"reputation":93939,"user_id":296328,"accept_rate":60,"display_name":"khmarbaise"},"score":1,"creation_date":1685885280,"post_id":76400567,"comment_id":134720433,"body_markdown":"First why using plugins as dependencies? Second why have you defined the modules output as `modules` because a usual modul-info.class must be located into `jar/root-location`... ?","body":"First why using plugins as dependencies? Second why have you defined the modules output as <code>modules</code> because a usual modul-info.class must be located into <code>jar&#47;root-location</code>... ?"},{"owner":{"account_id":7801308,"reputation":462,"user_id":5900660,"accept_rate":100,"display_name":"Conor Egan"},"score":0,"creation_date":1685886880,"post_id":76400567,"comment_id":134720627,"body_markdown":"Good point, removed moditect from dependencies. I used this output because that was provided in the example from Moditect&#39;s GitHub. What should it be?","body":"Good point, removed moditect from dependencies. I used this output because that was provided in the example from Moditect&#39;s GitHub. What should it be?"},{"owner":{"account_id":7801308,"reputation":462,"user_id":5900660,"accept_rate":100,"display_name":"Conor Egan"},"score":0,"creation_date":1685887299,"post_id":76400567,"comment_id":134720681,"body_markdown":"Also removed other plugins from dependencies &amp; updated my question.","body":"Also removed other plugins from dependencies &amp; updated my question."},{"owner":{"account_id":15064163,"reputation":13519,"user_id":10871900,"display_name":"dan1st is crying"},"score":0,"creation_date":1695159255,"post_id":76400567,"comment_id":135986072,"body_markdown":"Can you show the jlink configuration? Does it even use `${project.build.directory}/modules`?","body":"Can you show the jlink configuration? Does it even use <code>${project.build.directory}&#47;modules</code>?"},{"owner":{"account_id":7801308,"reputation":462,"user_id":5900660,"accept_rate":100,"display_name":"Conor Egan"},"score":0,"creation_date":1695165479,"post_id":76400567,"comment_id":135986897,"body_markdown":"@dan1st The options you can provide are found here: https://github.com/openjfx/javafx-maven-plugin#javafxjlink-options. I have the maven configuration but none of the optional options. I&#39;m not sure what you mean?","body":"@dan1st The options you can provide are found here: <a href=\"https://github.com/openjfx/javafx-maven-plugin#javafxjlink-options\" rel=\"nofollow noreferrer\">github.com/openjfx/javafx-maven-plugin#javafxjlink-options</a>. I have the maven configuration but none of the optional options. I&#39;m not sure what you mean?"},{"owner":{"account_id":7801308,"reputation":462,"user_id":5900660,"accept_rate":100,"display_name":"Conor Egan"},"score":0,"creation_date":1695165835,"post_id":76400567,"comment_id":135986941,"body_markdown":"I also followed: https://openjfx.io/openjfx-docs/#maven. Runtime images &gt; Modular with Maven.","body":"I also followed: <a href=\"https://openjfx.io/openjfx-docs/#maven\" rel=\"nofollow noreferrer\">openjfx.io/openjfx-docs/#maven</a>. Runtime images &gt; Modular with Maven."}],"answers":[{"tags":[],"owner":{"account_id":13552269,"reputation":126,"user_id":9776809,"display_name":"Ian Wang"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1695352121,"creation_date":1695230214,"answer_id":77144657,"question_id":76400567,"body_markdown":"# Problem\r\n\r\n- JLink does not work with [automatic modules][1] (i.e. packages without a module-info.java file)\r\n\r\n# Steps\r\n\r\n## Copy dependencies to {build_folder}/dependency using [maven-dependency-plugin][2]\r\n\r\n```xml\r\n&lt;plugin&gt;\r\n\t&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;\r\n\t&lt;version&gt;3.6.0&lt;/version&gt;\r\n\t&lt;executions&gt;\r\n\t\t&lt;execution&gt;\r\n\t\t\t&lt;id&gt;copy&lt;/id&gt;\r\n\t\t\t&lt;phase&gt;package&lt;/phase&gt;\r\n\t\t\t&lt;goals&gt;\r\n\t\t\t\t&lt;goal&gt;copy-dependencies&lt;/goal&gt;\r\n\t\t\t&lt;/goals&gt;\r\n\t\t&lt;/execution&gt;\r\n\t&lt;/executions&gt;\r\n&lt;/plugin&gt;\r\n```\r\n\r\n## Add module-info for automatic modules using [moditect-maven-plugin][3]\r\n\r\n```xml\r\n&lt;plugin&gt;\r\n\t&lt;groupId&gt;org.moditect&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;moditect-maven-plugin&lt;/artifactId&gt;\r\n\t&lt;version&gt;1.0.0.Final&lt;/version&gt;\r\n\t&lt;executions&gt;\r\n\t\t&lt;execution&gt;\r\n\t\t\t&lt;id&gt;add-module-infos&lt;/id&gt;\r\n\t\t\t&lt;phase&gt;generate-resources&lt;/phase&gt;\r\n\t\t\t&lt;goals&gt;\r\n\t\t\t\t&lt;goal&gt;add-module-info&lt;/goal&gt;\r\n\t\t\t&lt;/goals&gt;\r\n\t\t\t&lt;configuration&gt;\r\n\t\t\t\t&lt;outputDirectory&gt;\r\n\t\t\t\t\t${project.build.directory}/dependency\r\n\t\t\t\t&lt;/outputDirectory&gt;\r\n\t\t\t\t&lt;modules&gt;\r\n\t\t\t\t\t&lt;module&gt;\r\n\t\t\t\t\t\t&lt;artifact&gt;\r\n\t\t\t\t\t\t\t&lt;groupId&gt;commons-io&lt;/groupId&gt;\r\n\t\t\t\t\t\t\t&lt;artifactId&gt;commons-io&lt;/artifactId&gt;\r\n\t\t\t\t\t\t\t&lt;version&gt;2.13.0&lt;/version&gt;\r\n\t\t\t\t\t\t&lt;/artifact&gt;\r\n\t\t\t\t\t\t&lt;moduleInfoSource&gt;\r\n\t\t\t\t\t\t\tmodule org.apache.commons.io {\r\n\t\t\t\t\t\t\texports org.apache.commons.io;\r\n\t\t\t\t\t\t\texports org.apache.commons.io.build;\r\n\t\t\t\t\t\t\texports org.apache.commons.io.charset;\r\n\t\t\t\t\t\t\texports org.apache.commons.io.comparator;\r\n\t\t\t\t\t\t\texports org.apache.commons.io.file;\r\n\t\t\t\t\t\t\texports org.apache.commons.io.file.attribute;\r\n\t\t\t\t\t\t\texports org.apache.commons.io.file.spi;\r\n\t\t\t\t\t\t\texports org.apache.commons.io.filefilter;\r\n\t\t\t\t\t\t\texports org.apache.commons.io.function;\r\n\t\t\t\t\t\t\texports org.apache.commons.io.input;\r\n\t\t\t\t\t\t\texports org.apache.commons.io.input.buffer;\r\n\t\t\t\t\t\t\texports org.apache.commons.io.monitor;\r\n\t\t\t\t\t\t\texports org.apache.commons.io.output;\r\n\t\t\t\t\t\t\texports org.apache.commons.io.serialization;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t&lt;/moduleInfoSource&gt;\r\n\t\t\t\t\t&lt;/module&gt;\r\n\t\t\t\t&lt;/modules&gt;\r\n\t\t\t\t&lt;overwriteExistingFiles&gt;true&lt;/overwriteExistingFiles&gt;\r\n\t\t\t&lt;/configuration&gt;\r\n\t\t&lt;/execution&gt;\r\n\r\n\t&lt;/executions&gt;\r\n&lt;/plugin&gt;\r\n```\r\n\r\n### How to get the `&lt;moduleInfoSource&gt;` content?\r\n\r\n- go to the folder with the required (dependency) .jar file\r\n- If you use Intellij IDEA, in project view, there&#39;s a section named `External Libraries`. Double-click on the entry, right click on the `.jar`, open in -&gt; Explorer.\r\n- open command prompt in that folder\r\n- `jdeps -generate-module-info . {jar_file_name}.jar`\r\n- Make sure the PATH environment variable is correct\r\n- open the generated `module-info.java` file with a text editor and copy the content\r\n- paste to the `&lt;moduleInfoSource&gt;` section\r\n\r\n## Create runtime image (with jlink, in the backend)\r\n\r\n- please change the `&lt;modules&gt;`, `&lt;launcher&gt;`sections according to your project information.\r\n- If your module is non-modular, it is important that the main class does not  extend `javafx.Application` directly. We can create a launcher class which looks like this (reference pending):\r\n\r\n&gt; launcher class\r\n```java\r\npublic class Launcher {  \r\n    public static void main(String[] args) {  \r\n        HelloApplication.main(args);  \r\n    }  \r\n}\r\n```\r\n\r\n&gt; pom.xml\r\n```xml\r\n&lt;execution&gt;\r\n\t&lt;id&gt;create-runtime-image&lt;/id&gt;\r\n\t&lt;phase&gt;package&lt;/phase&gt;\r\n\t&lt;goals&gt;\r\n\t\t&lt;goal&gt;create-runtime-image&lt;/goal&gt;\r\n\t&lt;/goals&gt;\r\n\t&lt;configuration&gt;\r\n\t\t&lt;jarInclusionPolicy&gt;APP_WITH_DEPENDENCIES&lt;/jarInclusionPolicy&gt;\r\n\t\t&lt;modulePath&gt;\r\n\t\t\t&lt;path&gt;${project.build.directory}/${project.artifactId}-${project.version}.${project.packaging}&lt;/path&gt;\r\n\t\t\t&lt;path&gt;${project.build.directory}/dependency&lt;/path&gt;\r\n\t\t&lt;/modulePath&gt;\r\n\t\t&lt;modules&gt;\r\n\t\t\t&lt;module&gt;com.example.soone&lt;/module&gt;\r\n\t\t&lt;/modules&gt;\r\n\t\t&lt;launcher&gt;\r\n\t\t\t&lt;name&gt;hello&lt;/name&gt;\r\n\t\t\t&lt;module&gt;com.example.soone/com.example.soone.Launcher&lt;/module&gt;\r\n\t\t&lt;/launcher&gt;\r\n\t\t&lt;outputDirectory&gt;\r\n\t\t\t${project.build.directory}/jlink-image\r\n\t\t&lt;/outputDirectory&gt;\r\n\t&lt;/configuration&gt;\r\n&lt;/execution&gt;\r\n```\r\n\r\n&gt; [link to demo repository][4]\r\n\r\n\r\n# Recommendation\r\n\r\n- I suggest changing the build system to Gradle, it works better with automatic modules and you won&#39;t have to manually figure out the dependencies, saves a lot of time especially when working with JavaFX.\r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/46741907/what-is-an-automatic-module\r\n  [2]: https://maven.apache.org/plugins/maven-dependency-plugin/\r\n  [3]: https://github.com/moditect/moditect#adding-module-descriptors-to-existing-jar-files\r\n  [4]: https://github.com/0100Light/so-javafx-moditect","title":"Using Moditect to add module-info to existing maven dependencies","body":"<h1>Problem</h1>\n<ul>\n<li>JLink does not work with <a href=\"https://stackoverflow.com/questions/46741907/what-is-an-automatic-module\">automatic modules</a> (i.e. packages without a module-info.java file)</li>\n</ul>\n<h1>Steps</h1>\n<h2>Copy dependencies to {build_folder}/dependency using <a href=\"https://maven.apache.org/plugins/maven-dependency-plugin/\" rel=\"nofollow noreferrer\">maven-dependency-plugin</a></h2>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n    &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;\n    &lt;version&gt;3.6.0&lt;/version&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;id&gt;copy&lt;/id&gt;\n            &lt;phase&gt;package&lt;/phase&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;copy-dependencies&lt;/goal&gt;\n            &lt;/goals&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre>\n<h2>Add module-info for automatic modules using <a href=\"https://github.com/moditect/moditect#adding-module-descriptors-to-existing-jar-files\" rel=\"nofollow noreferrer\">moditect-maven-plugin</a></h2>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.moditect&lt;/groupId&gt;\n    &lt;artifactId&gt;moditect-maven-plugin&lt;/artifactId&gt;\n    &lt;version&gt;1.0.0.Final&lt;/version&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;id&gt;add-module-infos&lt;/id&gt;\n            &lt;phase&gt;generate-resources&lt;/phase&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;add-module-info&lt;/goal&gt;\n            &lt;/goals&gt;\n            &lt;configuration&gt;\n                &lt;outputDirectory&gt;\n                    ${project.build.directory}/dependency\n                &lt;/outputDirectory&gt;\n                &lt;modules&gt;\n                    &lt;module&gt;\n                        &lt;artifact&gt;\n                            &lt;groupId&gt;commons-io&lt;/groupId&gt;\n                            &lt;artifactId&gt;commons-io&lt;/artifactId&gt;\n                            &lt;version&gt;2.13.0&lt;/version&gt;\n                        &lt;/artifact&gt;\n                        &lt;moduleInfoSource&gt;\n                            module org.apache.commons.io {\n                            exports org.apache.commons.io;\n                            exports org.apache.commons.io.build;\n                            exports org.apache.commons.io.charset;\n                            exports org.apache.commons.io.comparator;\n                            exports org.apache.commons.io.file;\n                            exports org.apache.commons.io.file.attribute;\n                            exports org.apache.commons.io.file.spi;\n                            exports org.apache.commons.io.filefilter;\n                            exports org.apache.commons.io.function;\n                            exports org.apache.commons.io.input;\n                            exports org.apache.commons.io.input.buffer;\n                            exports org.apache.commons.io.monitor;\n                            exports org.apache.commons.io.output;\n                            exports org.apache.commons.io.serialization;\n\n                            }\n\n                        &lt;/moduleInfoSource&gt;\n                    &lt;/module&gt;\n                &lt;/modules&gt;\n                &lt;overwriteExistingFiles&gt;true&lt;/overwriteExistingFiles&gt;\n            &lt;/configuration&gt;\n        &lt;/execution&gt;\n\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre>\n<h3>How to get the <code>&lt;moduleInfoSource&gt;</code> content?</h3>\n<ul>\n<li>go to the folder with the required (dependency) .jar file</li>\n<li>If you use Intellij IDEA, in project view, there's a section named <code>External Libraries</code>. Double-click on the entry, right click on the <code>.jar</code>, open in -&gt; Explorer.</li>\n<li>open command prompt in that folder</li>\n<li><code>jdeps -generate-module-info . {jar_file_name}.jar</code></li>\n<li>Make sure the PATH environment variable is correct</li>\n<li>open the generated <code>module-info.java</code> file with a text editor and copy the content</li>\n<li>paste to the <code>&lt;moduleInfoSource&gt;</code> section</li>\n</ul>\n<h2>Create runtime image (with jlink, in the backend)</h2>\n<ul>\n<li>please change the <code>&lt;modules&gt;</code>, <code>&lt;launcher&gt;</code>sections according to your project information.</li>\n<li>If your module is non-modular, it is important that the main class does not  extend <code>javafx.Application</code> directly. We can create a launcher class which looks like this (reference pending):</li>\n</ul>\n<blockquote>\n<p>launcher class</p>\n</blockquote>\n<pre class=\"lang-java prettyprint-override\"><code>public class Launcher {  \n    public static void main(String[] args) {  \n        HelloApplication.main(args);  \n    }  \n}\n</code></pre>\n<blockquote>\n<p>pom.xml</p>\n</blockquote>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;execution&gt;\n    &lt;id&gt;create-runtime-image&lt;/id&gt;\n    &lt;phase&gt;package&lt;/phase&gt;\n    &lt;goals&gt;\n        &lt;goal&gt;create-runtime-image&lt;/goal&gt;\n    &lt;/goals&gt;\n    &lt;configuration&gt;\n        &lt;jarInclusionPolicy&gt;APP_WITH_DEPENDENCIES&lt;/jarInclusionPolicy&gt;\n        &lt;modulePath&gt;\n            &lt;path&gt;${project.build.directory}/${project.artifactId}-${project.version}.${project.packaging}&lt;/path&gt;\n            &lt;path&gt;${project.build.directory}/dependency&lt;/path&gt;\n        &lt;/modulePath&gt;\n        &lt;modules&gt;\n            &lt;module&gt;com.example.soone&lt;/module&gt;\n        &lt;/modules&gt;\n        &lt;launcher&gt;\n            &lt;name&gt;hello&lt;/name&gt;\n            &lt;module&gt;com.example.soone/com.example.soone.Launcher&lt;/module&gt;\n        &lt;/launcher&gt;\n        &lt;outputDirectory&gt;\n            ${project.build.directory}/jlink-image\n        &lt;/outputDirectory&gt;\n    &lt;/configuration&gt;\n&lt;/execution&gt;\n</code></pre>\n<blockquote>\n<p><a href=\"https://github.com/0100Light/so-javafx-moditect\" rel=\"nofollow noreferrer\">link to demo repository</a></p>\n</blockquote>\n<h1>Recommendation</h1>\n<ul>\n<li>I suggest changing the build system to Gradle, it works better with automatic modules and you won't have to manually figure out the dependencies, saves a lot of time especially when working with JavaFX.</li>\n</ul>\n"}],"owner":{"account_id":7801308,"reputation":462,"user_id":5900660,"accept_rate":100,"display_name":"Conor Egan"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":329,"favorite_count":0,"down_vote_count":0,"up_vote_count":6,"accepted_answer_id":77144657,"answer_count":1,"score":6,"last_activity_date":1695352121,"creation_date":1685883892,"question_id":76400567,"body_markdown":"I am using JavaFX and have some dependencies that are not automatic modules.  When trying to run `mvn clean javafx:jlink` I get the following error:\r\n\r\n```\r\nError: automatic module cannot be used with jlink: org.apache.commons.io from [...]`\r\n```\r\nThis also errored for `org.apache.commons.commons-lang3` and `commons-codec.commons-codec`. Which error I was shown was random.\r\n\r\nSo I looked into using jdeps to generate a module info for the dependency, e.g.\r\n```\r\njdeps --generate-module-info tmp .../.m2/repository/commons-io/commons-io/2.12.0/commons-io-2.12.0.jar\r\n```\r\n\r\nThen I used Moditect to add the module-info to the existing jar:\r\n```xml\r\n&lt;plugin&gt;\r\n    &lt;groupId&gt;org.moditect&lt;/groupId&gt;\r\n    &lt;artifactId&gt;moditect-maven-plugin&lt;/artifactId&gt;\r\n    &lt;version&gt;1.0.0.Final&lt;/version&gt;\r\n    &lt;executions&gt;\r\n        &lt;execution&gt;\r\n            &lt;id&gt;add-module-infos&lt;/id&gt;\r\n            &lt;phase&gt;generate-resources&lt;/phase&gt;\r\n            &lt;goals&gt;\r\n                &lt;goal&gt;add-module-info&lt;/goal&gt;\r\n            &lt;/goals&gt;\r\n            &lt;configuration&gt;\r\n                &lt;outputDirectory&gt;${project.build.directory}/modules&lt;/outputDirectory&gt;\r\n                &lt;modules&gt;\r\n                    &lt;module&gt;\r\n                        &lt;artifact&gt;\r\n                            &lt;groupId&gt;commons-io&lt;/groupId&gt;\r\n                            &lt;artifactId&gt;commons-io&lt;/artifactId&gt;\r\n                            &lt;version&gt;2.12.0&lt;/version&gt;\r\n                        &lt;/artifact&gt;\r\n                        &lt;moduleInfoSource&gt;\r\n                            module org.apache.commons.io {\r\n                                exports org.apache.commons.io;\r\n                                exports org.apache.commons.io.build;\r\n                                exports org.apache.commons.io.charset;\r\n                                exports org.apache.commons.io.comparator;\r\n                                exports org.apache.commons.io.file;\r\n                                exports org.apache.commons.io.file.attribute;\r\n                                exports org.apache.commons.io.file.spi;\r\n                                exports org.apache.commons.io.filefilter;\r\n                                exports org.apache.commons.io.function;\r\n                                exports org.apache.commons.io.input;\r\n                                exports org.apache.commons.io.input.buffer;\r\n                                exports org.apache.commons.io.monitor;\r\n                                exports org.apache.commons.io.output;\r\n                                exports org.apache.commons.io.serialization;\r\n                            }\r\n                        &lt;/moduleInfoSource&gt;\r\n                    &lt;/module&gt;\r\n                    &lt;module&gt;\r\n                        &lt;artifact&gt;\r\n                            &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;\r\n                            &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;\r\n                            &lt;version&gt;3.12.0&lt;/version&gt;\r\n                        &lt;/artifact&gt;\r\n                        &lt;moduleInfoSource&gt;\r\n                            module org.apache.commons.lang3 {\r\n                                requires transitive java.desktop;\r\n\r\n                                exports org.apache.commons.lang3;\r\n                                exports org.apache.commons.lang3.arch;\r\n                                exports org.apache.commons.lang3.builder;\r\n                                exports org.apache.commons.lang3.compare;\r\n                                exports org.apache.commons.lang3.concurrent;\r\n                                exports org.apache.commons.lang3.concurrent.locks;\r\n                                exports org.apache.commons.lang3.event;\r\n                                exports org.apache.commons.lang3.exception;\r\n                                exports org.apache.commons.lang3.function;\r\n                                exports org.apache.commons.lang3.math;\r\n                                exports org.apache.commons.lang3.mutable;\r\n                                exports org.apache.commons.lang3.reflect;\r\n                                exports org.apache.commons.lang3.stream;\r\n                                exports org.apache.commons.lang3.text;\r\n                                exports org.apache.commons.lang3.text.translate;\r\n                                exports org.apache.commons.lang3.time;\r\n                                exports org.apache.commons.lang3.tuple;\r\n                            }\r\n                        &lt;/moduleInfoSource&gt;\r\n                    &lt;/module&gt;\r\n                    &lt;module&gt;\r\n                        &lt;artifact&gt;\r\n                            &lt;groupId&gt;commons-codec&lt;/groupId&gt;\r\n                            &lt;artifactId&gt;commons-codec&lt;/artifactId&gt;\r\n                            &lt;version&gt;1.15&lt;/version&gt;\r\n                        &lt;/artifact&gt;\r\n                        &lt;moduleInfoSource&gt;\r\n                            module org.apache.commons.codec {\r\n                                exports org.apache.commons.codec;\r\n                                exports org.apache.commons.codec.binary;\r\n                                exports org.apache.commons.codec.cli;\r\n                                exports org.apache.commons.codec.digest;\r\n                                exports org.apache.commons.codec.language;\r\n                                exports org.apache.commons.codec.language.bm;\r\n                                exports org.apache.commons.codec.net;\r\n                            }\r\n                        &lt;/moduleInfoSource&gt;\r\n                    &lt;/module&gt;\r\n                &lt;/modules&gt;\r\n            &lt;/configuration&gt;\r\n        &lt;/execution&gt;\r\n    &lt;/executions&gt;\r\n&lt;/plugin&gt;\r\n```\r\n\r\nBut I am still getting the same errors.\r\n\r\nMy module-info:\r\n```java\r\nmodule uk.co.conoregan.showrenamer {\r\n    requires info.movito.themoviedbapi;\r\n    requires java.prefs;\r\n    requires javafx.fxml;\r\n    requires javafx.controls;\r\n    requires org.apache.commons.io;\r\n    requires org.slf4j;\r\n\r\n    opens uk.co.conoregan.showrenamer to javafx.fxml, javafx.graphics;\r\n    opens uk.co.conoregan.showrenamer.controller to javafx.fxml;\r\n\r\n    exports uk.co.conoregan.showrenamer;\r\n    exports uk.co.conoregan.showrenamer.api;\r\n    exports uk.co.conoregan.showrenamer.config.preference;\r\n    exports uk.co.conoregan.showrenamer.config.property;\r\n    exports uk.co.conoregan.showrenamer.controller;\r\n    exports uk.co.conoregan.showrenamer.suggestion;\r\n    exports uk.co.conoregan.showrenamer.util;\r\n}\r\n```\r\n\r\nMy full pom.xml:\r\n```xml\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\r\n         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n\r\n    &lt;name&gt;ShowRenamer&lt;/name&gt;\r\n    &lt;groupId&gt;uk.co.conoregan.show-renamer&lt;/groupId&gt;\r\n    &lt;artifactId&gt;show-renamer&lt;/artifactId&gt;\r\n    &lt;version&gt;1.4.0&lt;/version&gt;\r\n\r\n    &lt;properties&gt;\r\n        &lt;maven.compiler.java.version&gt;17&lt;/maven.compiler.java.version&gt;\r\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\r\n        &lt;junit.version&gt;5.9.3&lt;/junit.version&gt;\r\n        &lt;javafx.version&gt;20.0.1&lt;/javafx.version&gt;\r\n        &lt;slf4j.version&gt;2.0.7&lt;/slf4j.version&gt;\r\n    &lt;/properties&gt;\r\n\r\n    &lt;dependencies&gt;\r\n        &lt;!-- https://mvnrepository.com/artifact/org.slf4j/slf4j-api --&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\r\n            &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;\r\n            &lt;version&gt;${slf4j.version}&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n\r\n        &lt;!-- https://mvnrepository.com/artifact/org.slf4j/slf4j-simple --&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\r\n            &lt;artifactId&gt;slf4j-simple&lt;/artifactId&gt;\r\n            &lt;version&gt;${slf4j.version}&lt;/version&gt;\r\n            &lt;scope&gt;runtime&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\n\r\n        &lt;!-- https://mvnrepository.com/artifact/org.junit.jupiter/junit-jupiter-api --&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\r\n            &lt;artifactId&gt;junit-jupiter-api&lt;/artifactId&gt;\r\n            &lt;version&gt;${junit.version}&lt;/version&gt;\r\n            &lt;scope&gt;test&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\r\n            &lt;artifactId&gt;junit-jupiter-engine&lt;/artifactId&gt;\r\n            &lt;version&gt;${junit.version}&lt;/version&gt;\r\n            &lt;scope&gt;test&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\n\r\n        &lt;!-- https://mvnrepository.com/artifact/org.mockito/mockito-core --&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.mockito&lt;/groupId&gt;\r\n            &lt;artifactId&gt;mockito-core&lt;/artifactId&gt;\r\n            &lt;version&gt;5.3.1&lt;/version&gt;\r\n            &lt;scope&gt;test&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\n\r\n        &lt;!-- JavaFX --&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.openjfx&lt;/groupId&gt;\r\n            &lt;artifactId&gt;javafx-controls&lt;/artifactId&gt;\r\n            &lt;version&gt;${javafx.version}&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.openjfx&lt;/groupId&gt;\r\n            &lt;artifactId&gt;javafx-fxml&lt;/artifactId&gt;\r\n            &lt;version&gt;${javafx.version}&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n\r\n        &lt;!-- https://mvnrepository.com/artifact/commons-io/commons-io --&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;commons-io&lt;/groupId&gt;\r\n            &lt;artifactId&gt;commons-io&lt;/artifactId&gt;\r\n            &lt;version&gt;2.12.0&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n\r\n        &lt;!-- https://search.maven.org/artifact/com.github.holgerbrandl/themoviedbapi --&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;com.github.holgerbrandl&lt;/groupId&gt;\r\n            &lt;artifactId&gt;themoviedbapi&lt;/artifactId&gt;\r\n            &lt;version&gt;1.15&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n    &lt;/dependencies&gt;\r\n\r\n    &lt;build&gt;\r\n        &lt;testResources&gt;\r\n            &lt;testResource&gt;\r\n                &lt;directory&gt;${project.basedir}/src/test/resources&lt;/directory&gt;\r\n            &lt;/testResource&gt;\r\n        &lt;/testResources&gt;\r\n\r\n        &lt;plugins&gt;\r\n            &lt;plugin&gt;\r\n                &lt;groupId&gt;org.moditect&lt;/groupId&gt;\r\n                &lt;artifactId&gt;moditect-maven-plugin&lt;/artifactId&gt;\r\n                &lt;version&gt;1.0.0.Final&lt;/version&gt;\r\n                &lt;executions&gt;\r\n                    &lt;execution&gt;\r\n                        &lt;id&gt;add-module-infos&lt;/id&gt;\r\n                        &lt;phase&gt;generate-resources&lt;/phase&gt;\r\n                        &lt;goals&gt;\r\n                            &lt;goal&gt;add-module-info&lt;/goal&gt;\r\n                        &lt;/goals&gt;\r\n                        &lt;configuration&gt;\r\n                            &lt;outputDirectory&gt;${project.build.directory}/modules&lt;/outputDirectory&gt;\r\n                            &lt;modules&gt;\r\n                                &lt;module&gt;\r\n                                    &lt;artifact&gt;\r\n                                        &lt;groupId&gt;commons-io&lt;/groupId&gt;\r\n                                        &lt;artifactId&gt;commons-io&lt;/artifactId&gt;\r\n                                        &lt;version&gt;2.12.0&lt;/version&gt;\r\n                                    &lt;/artifact&gt;\r\n                                    &lt;moduleInfoSource&gt;\r\n                                        module org.apache.commons.io {\r\n                                            exports org.apache.commons.io;\r\n                                            exports org.apache.commons.io.build;\r\n                                            exports org.apache.commons.io.charset;\r\n                                            exports org.apache.commons.io.comparator;\r\n                                            exports org.apache.commons.io.file;\r\n                                            exports org.apache.commons.io.file.attribute;\r\n                                            exports org.apache.commons.io.file.spi;\r\n                                            exports org.apache.commons.io.filefilter;\r\n                                            exports org.apache.commons.io.function;\r\n                                            exports org.apache.commons.io.input;\r\n                                            exports org.apache.commons.io.input.buffer;\r\n                                            exports org.apache.commons.io.monitor;\r\n                                            exports org.apache.commons.io.output;\r\n                                            exports org.apache.commons.io.serialization;\r\n                                        }\r\n                                    &lt;/moduleInfoSource&gt;\r\n                                &lt;/module&gt;\r\n                                &lt;module&gt;\r\n                                    &lt;artifact&gt;\r\n                                        &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;\r\n                                        &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;\r\n                                        &lt;version&gt;3.12.0&lt;/version&gt;\r\n                                    &lt;/artifact&gt;\r\n                                    &lt;moduleInfoSource&gt;\r\n                                        module org.apache.commons.lang3 {\r\n                                            requires transitive java.desktop;\r\n\r\n                                            exports org.apache.commons.lang3;\r\n                                            exports org.apache.commons.lang3.arch;\r\n                                            exports org.apache.commons.lang3.builder;\r\n                                            exports org.apache.commons.lang3.compare;\r\n                                            exports org.apache.commons.lang3.concurrent;\r\n                                            exports org.apache.commons.lang3.concurrent.locks;\r\n                                            exports org.apache.commons.lang3.event;\r\n                                            exports org.apache.commons.lang3.exception;\r\n                                            exports org.apache.commons.lang3.function;\r\n                                            exports org.apache.commons.lang3.math;\r\n                                            exports org.apache.commons.lang3.mutable;\r\n                                            exports org.apache.commons.lang3.reflect;\r\n                                            exports org.apache.commons.lang3.stream;\r\n                                            exports org.apache.commons.lang3.text;\r\n                                            exports org.apache.commons.lang3.text.translate;\r\n                                            exports org.apache.commons.lang3.time;\r\n                                            exports org.apache.commons.lang3.tuple;\r\n                                        }\r\n                                    &lt;/moduleInfoSource&gt;\r\n                                &lt;/module&gt;\r\n                                &lt;module&gt;\r\n                                    &lt;artifact&gt;\r\n                                        &lt;groupId&gt;commons-codec&lt;/groupId&gt;\r\n                                        &lt;artifactId&gt;commons-codec&lt;/artifactId&gt;\r\n                                        &lt;version&gt;1.15&lt;/version&gt;\r\n                                    &lt;/artifact&gt;\r\n                                    &lt;moduleInfoSource&gt;\r\n                                        module org.apache.commons.codec {\r\n                                            exports org.apache.commons.codec;\r\n                                            exports org.apache.commons.codec.binary;\r\n                                            exports org.apache.commons.codec.cli;\r\n                                            exports org.apache.commons.codec.digest;\r\n                                            exports org.apache.commons.codec.language;\r\n                                            exports org.apache.commons.codec.language.bm;\r\n                                            exports org.apache.commons.codec.net;\r\n                                        }\r\n                                    &lt;/moduleInfoSource&gt;\r\n                                &lt;/module&gt;\r\n                            &lt;/modules&gt;\r\n                        &lt;/configuration&gt;\r\n                    &lt;/execution&gt;\r\n                &lt;/executions&gt;\r\n            &lt;/plugin&gt;\r\n\r\n            &lt;plugin&gt;\r\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n                &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;\r\n                &lt;version&gt;3.1.0&lt;/version&gt;\r\n            &lt;/plugin&gt;\r\n\r\n            &lt;plugin&gt;\r\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\r\n                &lt;version&gt;3.11.0&lt;/version&gt;\r\n                &lt;configuration&gt;\r\n                    &lt;source&gt;${maven.compiler.java.version}&lt;/source&gt;\r\n                    &lt;target&gt;${maven.compiler.java.version}&lt;/target&gt;\r\n                    &lt;release&gt;${maven.compiler.java.version}&lt;/release&gt;\r\n                &lt;/configuration&gt;\r\n            &lt;/plugin&gt;\r\n\r\n            &lt;plugin&gt;\r\n                &lt;groupId&gt;org.openjfx&lt;/groupId&gt;\r\n                &lt;artifactId&gt;javafx-maven-plugin&lt;/artifactId&gt;\r\n                &lt;version&gt;0.0.8&lt;/version&gt;\r\n                &lt;executions&gt;\r\n                    &lt;execution&gt;\r\n                        &lt;!-- Default configuration for running with: mvn clean javafx:run --&gt;\r\n                        &lt;id&gt;default-cli&lt;/id&gt;\r\n                        &lt;configuration&gt;\r\n                            &lt;mainClass&gt;uk.co.conoregan.showrenamer/uk.co.conoregan.showrenamer.ShowRenamerApplication&lt;/mainClass&gt;\r\n                        &lt;/configuration&gt;\r\n                    &lt;/execution&gt;\r\n                &lt;/executions&gt;\r\n            &lt;/plugin&gt;\r\n        &lt;/plugins&gt;\r\n    &lt;/build&gt;\r\n&lt;/project&gt;\r\n```\r\n\r\nI also ran `mvn dependency:tree` to generate the following:\r\n```\r\n[INFO] uk.co.conoregan.show-renamer:show-renamer:jar:1.4.0\r\n[INFO] +- org.slf4j:slf4j-api:jar:2.0.7:compile\r\n[INFO] +- org.slf4j:slf4j-simple:jar:2.0.7:runtime\r\n[INFO] +- org.junit.jupiter:junit-jupiter-api:jar:5.9.3:test\r\n[INFO] |  +- org.opentest4j:opentest4j:jar:1.2.0:test\r\n[INFO] |  +- org.junit.platform:junit-platform-commons:jar:1.9.3:test\r\n[INFO] |  \\- org.apiguardian:apiguardian-api:jar:1.1.2:test\r\n[INFO] +- org.junit.jupiter:junit-jupiter-engine:jar:5.9.3:test\r\n[INFO] |  \\- org.junit.platform:junit-platform-engine:jar:1.9.3:test\r\n[INFO] +- org.mockito:mockito-core:jar:5.3.1:test\r\n[INFO] |  +- net.bytebuddy:byte-buddy:jar:1.14.4:test\r\n[INFO] |  +- net.bytebuddy:byte-buddy-agent:jar:1.14.4:test\r\n[INFO] |  \\- org.objenesis:objenesis:jar:3.3:test\r\n[INFO] +- org.openjfx:javafx-controls:jar:20.0.1:compile\r\n[INFO] |  +- org.openjfx:javafx-controls:jar:win:20.0.1:compile\r\n[INFO] |  \\- org.openjfx:javafx-graphics:jar:20.0.1:compile\r\n[INFO] |     +- org.openjfx:javafx-graphics:jar:win:20.0.1:compile\r\n[INFO] |     \\- org.openjfx:javafx-base:jar:20.0.1:compile\r\n[INFO] |        \\- org.openjfx:javafx-base:jar:win:20.0.1:compile\r\n[INFO] +- org.openjfx:javafx-fxml:jar:20.0.1:compile\r\n[INFO] |  \\- org.openjfx:javafx-fxml:jar:win:20.0.1:compile\r\n[INFO] +- commons-io:commons-io:jar:2.12.0:compile\r\n[INFO] \\- com.github.holgerbrandl:themoviedbapi:jar:1.15:compile\r\n[INFO]    +- org.slf4j:jcl-over-slf4j:jar:2.0.7:runtime\r\n[INFO]    +- com.fasterxml.jackson.core:jackson-annotations:jar:2.15.0:runtime\r\n[INFO]    +- com.fasterxml.jackson.core:jackson-core:jar:2.15.0:runtime\r\n[INFO]    +- com.fasterxml.jackson.core:jackson-databind:jar:2.15.0:runtime\r\n[INFO]    +- com.google.guava:guava:jar:31.1-jre:runtime\r\n[INFO]    |  +- com.google.guava:failureaccess:jar:1.0.1:runtime\r\n[INFO]    |  +- com.google.guava:listenablefuture:jar:9999.0-empty-to-avoid-conflict-with-guava:runtime\r\n[INFO]    |  +- com.google.code.findbugs:jsr305:jar:3.0.2:runtime\r\n[INFO]    |  +- org.checkerframework:checker-qual:jar:3.12.0:runtime\r\n[INFO]    |  +- com.google.errorprone:error_prone_annotations:jar:2.11.0:runtime\r\n[INFO]    |  \\- com.google.j2objc:j2objc-annotations:jar:1.3:runtime\r\n[INFO]    +- org.apache.commons:commons-lang3:jar:3.12.0:runtime\r\n[INFO]    \\- commons-codec:commons-codec:jar:1.15:runtime\r\n[INFO] ------------------------------------------------------------------------\r\n```\r\n","title":"Using Moditect to add module-info to existing maven dependencies","body":"<p>I am using JavaFX and have some dependencies that are not automatic modules.  When trying to run <code>mvn clean javafx:jlink</code> I get the following error:</p>\n<pre><code>Error: automatic module cannot be used with jlink: org.apache.commons.io from [...]`\n</code></pre>\n<p>This also errored for <code>org.apache.commons.commons-lang3</code> and <code>commons-codec.commons-codec</code>. Which error I was shown was random.</p>\n<p>So I looked into using jdeps to generate a module info for the dependency, e.g.</p>\n<pre><code>jdeps --generate-module-info tmp .../.m2/repository/commons-io/commons-io/2.12.0/commons-io-2.12.0.jar\n</code></pre>\n<p>Then I used Moditect to add the module-info to the existing jar:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.moditect&lt;/groupId&gt;\n    &lt;artifactId&gt;moditect-maven-plugin&lt;/artifactId&gt;\n    &lt;version&gt;1.0.0.Final&lt;/version&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;id&gt;add-module-infos&lt;/id&gt;\n            &lt;phase&gt;generate-resources&lt;/phase&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;add-module-info&lt;/goal&gt;\n            &lt;/goals&gt;\n            &lt;configuration&gt;\n                &lt;outputDirectory&gt;${project.build.directory}/modules&lt;/outputDirectory&gt;\n                &lt;modules&gt;\n                    &lt;module&gt;\n                        &lt;artifact&gt;\n                            &lt;groupId&gt;commons-io&lt;/groupId&gt;\n                            &lt;artifactId&gt;commons-io&lt;/artifactId&gt;\n                            &lt;version&gt;2.12.0&lt;/version&gt;\n                        &lt;/artifact&gt;\n                        &lt;moduleInfoSource&gt;\n                            module org.apache.commons.io {\n                                exports org.apache.commons.io;\n                                exports org.apache.commons.io.build;\n                                exports org.apache.commons.io.charset;\n                                exports org.apache.commons.io.comparator;\n                                exports org.apache.commons.io.file;\n                                exports org.apache.commons.io.file.attribute;\n                                exports org.apache.commons.io.file.spi;\n                                exports org.apache.commons.io.filefilter;\n                                exports org.apache.commons.io.function;\n                                exports org.apache.commons.io.input;\n                                exports org.apache.commons.io.input.buffer;\n                                exports org.apache.commons.io.monitor;\n                                exports org.apache.commons.io.output;\n                                exports org.apache.commons.io.serialization;\n                            }\n                        &lt;/moduleInfoSource&gt;\n                    &lt;/module&gt;\n                    &lt;module&gt;\n                        &lt;artifact&gt;\n                            &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;\n                            &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;\n                            &lt;version&gt;3.12.0&lt;/version&gt;\n                        &lt;/artifact&gt;\n                        &lt;moduleInfoSource&gt;\n                            module org.apache.commons.lang3 {\n                                requires transitive java.desktop;\n\n                                exports org.apache.commons.lang3;\n                                exports org.apache.commons.lang3.arch;\n                                exports org.apache.commons.lang3.builder;\n                                exports org.apache.commons.lang3.compare;\n                                exports org.apache.commons.lang3.concurrent;\n                                exports org.apache.commons.lang3.concurrent.locks;\n                                exports org.apache.commons.lang3.event;\n                                exports org.apache.commons.lang3.exception;\n                                exports org.apache.commons.lang3.function;\n                                exports org.apache.commons.lang3.math;\n                                exports org.apache.commons.lang3.mutable;\n                                exports org.apache.commons.lang3.reflect;\n                                exports org.apache.commons.lang3.stream;\n                                exports org.apache.commons.lang3.text;\n                                exports org.apache.commons.lang3.text.translate;\n                                exports org.apache.commons.lang3.time;\n                                exports org.apache.commons.lang3.tuple;\n                            }\n                        &lt;/moduleInfoSource&gt;\n                    &lt;/module&gt;\n                    &lt;module&gt;\n                        &lt;artifact&gt;\n                            &lt;groupId&gt;commons-codec&lt;/groupId&gt;\n                            &lt;artifactId&gt;commons-codec&lt;/artifactId&gt;\n                            &lt;version&gt;1.15&lt;/version&gt;\n                        &lt;/artifact&gt;\n                        &lt;moduleInfoSource&gt;\n                            module org.apache.commons.codec {\n                                exports org.apache.commons.codec;\n                                exports org.apache.commons.codec.binary;\n                                exports org.apache.commons.codec.cli;\n                                exports org.apache.commons.codec.digest;\n                                exports org.apache.commons.codec.language;\n                                exports org.apache.commons.codec.language.bm;\n                                exports org.apache.commons.codec.net;\n                            }\n                        &lt;/moduleInfoSource&gt;\n                    &lt;/module&gt;\n                &lt;/modules&gt;\n            &lt;/configuration&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre>\n<p>But I am still getting the same errors.</p>\n<p>My module-info:</p>\n<pre class=\"lang-java prettyprint-override\"><code>module uk.co.conoregan.showrenamer {\n    requires info.movito.themoviedbapi;\n    requires java.prefs;\n    requires javafx.fxml;\n    requires javafx.controls;\n    requires org.apache.commons.io;\n    requires org.slf4j;\n\n    opens uk.co.conoregan.showrenamer to javafx.fxml, javafx.graphics;\n    opens uk.co.conoregan.showrenamer.controller to javafx.fxml;\n\n    exports uk.co.conoregan.showrenamer;\n    exports uk.co.conoregan.showrenamer.api;\n    exports uk.co.conoregan.showrenamer.config.preference;\n    exports uk.co.conoregan.showrenamer.config.property;\n    exports uk.co.conoregan.showrenamer.controller;\n    exports uk.co.conoregan.showrenamer.suggestion;\n    exports uk.co.conoregan.showrenamer.util;\n}\n</code></pre>\n<p>My full pom.xml:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\n         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;name&gt;ShowRenamer&lt;/name&gt;\n    &lt;groupId&gt;uk.co.conoregan.show-renamer&lt;/groupId&gt;\n    &lt;artifactId&gt;show-renamer&lt;/artifactId&gt;\n    &lt;version&gt;1.4.0&lt;/version&gt;\n\n    &lt;properties&gt;\n        &lt;maven.compiler.java.version&gt;17&lt;/maven.compiler.java.version&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n        &lt;junit.version&gt;5.9.3&lt;/junit.version&gt;\n        &lt;javafx.version&gt;20.0.1&lt;/javafx.version&gt;\n        &lt;slf4j.version&gt;2.0.7&lt;/slf4j.version&gt;\n    &lt;/properties&gt;\n\n    &lt;dependencies&gt;\n        &lt;!-- https://mvnrepository.com/artifact/org.slf4j/slf4j-api --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;\n            &lt;version&gt;${slf4j.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- https://mvnrepository.com/artifact/org.slf4j/slf4j-simple --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;slf4j-simple&lt;/artifactId&gt;\n            &lt;version&gt;${slf4j.version}&lt;/version&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- https://mvnrepository.com/artifact/org.junit.jupiter/junit-jupiter-api --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\n            &lt;artifactId&gt;junit-jupiter-api&lt;/artifactId&gt;\n            &lt;version&gt;${junit.version}&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\n            &lt;artifactId&gt;junit-jupiter-engine&lt;/artifactId&gt;\n            &lt;version&gt;${junit.version}&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- https://mvnrepository.com/artifact/org.mockito/mockito-core --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.mockito&lt;/groupId&gt;\n            &lt;artifactId&gt;mockito-core&lt;/artifactId&gt;\n            &lt;version&gt;5.3.1&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- JavaFX --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.openjfx&lt;/groupId&gt;\n            &lt;artifactId&gt;javafx-controls&lt;/artifactId&gt;\n            &lt;version&gt;${javafx.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.openjfx&lt;/groupId&gt;\n            &lt;artifactId&gt;javafx-fxml&lt;/artifactId&gt;\n            &lt;version&gt;${javafx.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- https://mvnrepository.com/artifact/commons-io/commons-io --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;commons-io&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-io&lt;/artifactId&gt;\n            &lt;version&gt;2.12.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- https://search.maven.org/artifact/com.github.holgerbrandl/themoviedbapi --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.github.holgerbrandl&lt;/groupId&gt;\n            &lt;artifactId&gt;themoviedbapi&lt;/artifactId&gt;\n            &lt;version&gt;1.15&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;testResources&gt;\n            &lt;testResource&gt;\n                &lt;directory&gt;${project.basedir}/src/test/resources&lt;/directory&gt;\n            &lt;/testResource&gt;\n        &lt;/testResources&gt;\n\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.moditect&lt;/groupId&gt;\n                &lt;artifactId&gt;moditect-maven-plugin&lt;/artifactId&gt;\n                &lt;version&gt;1.0.0.Final&lt;/version&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;id&gt;add-module-infos&lt;/id&gt;\n                        &lt;phase&gt;generate-resources&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;add-module-info&lt;/goal&gt;\n                        &lt;/goals&gt;\n                        &lt;configuration&gt;\n                            &lt;outputDirectory&gt;${project.build.directory}/modules&lt;/outputDirectory&gt;\n                            &lt;modules&gt;\n                                &lt;module&gt;\n                                    &lt;artifact&gt;\n                                        &lt;groupId&gt;commons-io&lt;/groupId&gt;\n                                        &lt;artifactId&gt;commons-io&lt;/artifactId&gt;\n                                        &lt;version&gt;2.12.0&lt;/version&gt;\n                                    &lt;/artifact&gt;\n                                    &lt;moduleInfoSource&gt;\n                                        module org.apache.commons.io {\n                                            exports org.apache.commons.io;\n                                            exports org.apache.commons.io.build;\n                                            exports org.apache.commons.io.charset;\n                                            exports org.apache.commons.io.comparator;\n                                            exports org.apache.commons.io.file;\n                                            exports org.apache.commons.io.file.attribute;\n                                            exports org.apache.commons.io.file.spi;\n                                            exports org.apache.commons.io.filefilter;\n                                            exports org.apache.commons.io.function;\n                                            exports org.apache.commons.io.input;\n                                            exports org.apache.commons.io.input.buffer;\n                                            exports org.apache.commons.io.monitor;\n                                            exports org.apache.commons.io.output;\n                                            exports org.apache.commons.io.serialization;\n                                        }\n                                    &lt;/moduleInfoSource&gt;\n                                &lt;/module&gt;\n                                &lt;module&gt;\n                                    &lt;artifact&gt;\n                                        &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;\n                                        &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;\n                                        &lt;version&gt;3.12.0&lt;/version&gt;\n                                    &lt;/artifact&gt;\n                                    &lt;moduleInfoSource&gt;\n                                        module org.apache.commons.lang3 {\n                                            requires transitive java.desktop;\n\n                                            exports org.apache.commons.lang3;\n                                            exports org.apache.commons.lang3.arch;\n                                            exports org.apache.commons.lang3.builder;\n                                            exports org.apache.commons.lang3.compare;\n                                            exports org.apache.commons.lang3.concurrent;\n                                            exports org.apache.commons.lang3.concurrent.locks;\n                                            exports org.apache.commons.lang3.event;\n                                            exports org.apache.commons.lang3.exception;\n                                            exports org.apache.commons.lang3.function;\n                                            exports org.apache.commons.lang3.math;\n                                            exports org.apache.commons.lang3.mutable;\n                                            exports org.apache.commons.lang3.reflect;\n                                            exports org.apache.commons.lang3.stream;\n                                            exports org.apache.commons.lang3.text;\n                                            exports org.apache.commons.lang3.text.translate;\n                                            exports org.apache.commons.lang3.time;\n                                            exports org.apache.commons.lang3.tuple;\n                                        }\n                                    &lt;/moduleInfoSource&gt;\n                                &lt;/module&gt;\n                                &lt;module&gt;\n                                    &lt;artifact&gt;\n                                        &lt;groupId&gt;commons-codec&lt;/groupId&gt;\n                                        &lt;artifactId&gt;commons-codec&lt;/artifactId&gt;\n                                        &lt;version&gt;1.15&lt;/version&gt;\n                                    &lt;/artifact&gt;\n                                    &lt;moduleInfoSource&gt;\n                                        module org.apache.commons.codec {\n                                            exports org.apache.commons.codec;\n                                            exports org.apache.commons.codec.binary;\n                                            exports org.apache.commons.codec.cli;\n                                            exports org.apache.commons.codec.digest;\n                                            exports org.apache.commons.codec.language;\n                                            exports org.apache.commons.codec.language.bm;\n                                            exports org.apache.commons.codec.net;\n                                        }\n                                    &lt;/moduleInfoSource&gt;\n                                &lt;/module&gt;\n                            &lt;/modules&gt;\n                        &lt;/configuration&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.1.0&lt;/version&gt;\n            &lt;/plugin&gt;\n\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.11.0&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;source&gt;${maven.compiler.java.version}&lt;/source&gt;\n                    &lt;target&gt;${maven.compiler.java.version}&lt;/target&gt;\n                    &lt;release&gt;${maven.compiler.java.version}&lt;/release&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.openjfx&lt;/groupId&gt;\n                &lt;artifactId&gt;javafx-maven-plugin&lt;/artifactId&gt;\n                &lt;version&gt;0.0.8&lt;/version&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;!-- Default configuration for running with: mvn clean javafx:run --&gt;\n                        &lt;id&gt;default-cli&lt;/id&gt;\n                        &lt;configuration&gt;\n                            &lt;mainClass&gt;uk.co.conoregan.showrenamer/uk.co.conoregan.showrenamer.ShowRenamerApplication&lt;/mainClass&gt;\n                        &lt;/configuration&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n&lt;/project&gt;\n</code></pre>\n<p>I also ran <code>mvn dependency:tree</code> to generate the following:</p>\n<pre><code>[INFO] uk.co.conoregan.show-renamer:show-renamer:jar:1.4.0\n[INFO] +- org.slf4j:slf4j-api:jar:2.0.7:compile\n[INFO] +- org.slf4j:slf4j-simple:jar:2.0.7:runtime\n[INFO] +- org.junit.jupiter:junit-jupiter-api:jar:5.9.3:test\n[INFO] |  +- org.opentest4j:opentest4j:jar:1.2.0:test\n[INFO] |  +- org.junit.platform:junit-platform-commons:jar:1.9.3:test\n[INFO] |  \\- org.apiguardian:apiguardian-api:jar:1.1.2:test\n[INFO] +- org.junit.jupiter:junit-jupiter-engine:jar:5.9.3:test\n[INFO] |  \\- org.junit.platform:junit-platform-engine:jar:1.9.3:test\n[INFO] +- org.mockito:mockito-core:jar:5.3.1:test\n[INFO] |  +- net.bytebuddy:byte-buddy:jar:1.14.4:test\n[INFO] |  +- net.bytebuddy:byte-buddy-agent:jar:1.14.4:test\n[INFO] |  \\- org.objenesis:objenesis:jar:3.3:test\n[INFO] +- org.openjfx:javafx-controls:jar:20.0.1:compile\n[INFO] |  +- org.openjfx:javafx-controls:jar:win:20.0.1:compile\n[INFO] |  \\- org.openjfx:javafx-graphics:jar:20.0.1:compile\n[INFO] |     +- org.openjfx:javafx-graphics:jar:win:20.0.1:compile\n[INFO] |     \\- org.openjfx:javafx-base:jar:20.0.1:compile\n[INFO] |        \\- org.openjfx:javafx-base:jar:win:20.0.1:compile\n[INFO] +- org.openjfx:javafx-fxml:jar:20.0.1:compile\n[INFO] |  \\- org.openjfx:javafx-fxml:jar:win:20.0.1:compile\n[INFO] +- commons-io:commons-io:jar:2.12.0:compile\n[INFO] \\- com.github.holgerbrandl:themoviedbapi:jar:1.15:compile\n[INFO]    +- org.slf4j:jcl-over-slf4j:jar:2.0.7:runtime\n[INFO]    +- com.fasterxml.jackson.core:jackson-annotations:jar:2.15.0:runtime\n[INFO]    +- com.fasterxml.jackson.core:jackson-core:jar:2.15.0:runtime\n[INFO]    +- com.fasterxml.jackson.core:jackson-databind:jar:2.15.0:runtime\n[INFO]    +- com.google.guava:guava:jar:31.1-jre:runtime\n[INFO]    |  +- com.google.guava:failureaccess:jar:1.0.1:runtime\n[INFO]    |  +- com.google.guava:listenablefuture:jar:9999.0-empty-to-avoid-conflict-with-guava:runtime\n[INFO]    |  +- com.google.code.findbugs:jsr305:jar:3.0.2:runtime\n[INFO]    |  +- org.checkerframework:checker-qual:jar:3.12.0:runtime\n[INFO]    |  +- com.google.errorprone:error_prone_annotations:jar:2.11.0:runtime\n[INFO]    |  \\- com.google.j2objc:j2objc-annotations:jar:1.3:runtime\n[INFO]    +- org.apache.commons:commons-lang3:jar:3.12.0:runtime\n[INFO]    \\- commons-codec:commons-codec:jar:1.15:runtime\n[INFO] ------------------------------------------------------------------------\n</code></pre>\n"},{"tags":["java","spring","spring-boot","hibernate","jpa"],"comments":[{"owner":{"account_id":231721,"reputation":20460,"user_id":496099,"display_name":"Chris"},"score":1,"creation_date":1695319922,"post_id":77151752,"comment_id":136012177,"body_markdown":"Check out the stack trace - it shows you the issue is in your User.hashCode method. The problem is with your Lombok generated hashcode, which just like the JSON issue&#39;s you&#39;ve been researching, has its hashcode implementation set to go through ALL your relationships to calculate equality and the hashcode, and it does so recursively on all these objects in the entire object graph. Don&#39;t use Lombok.. or don&#39;t use it for anything you don&#39;t explicitly need anyway. Check out the known issues with &#39;@Data&#39; annotations.","body":"Check out the stack trace - it shows you the issue is in your User.hashCode method. The problem is with your Lombok generated hashcode, which just like the JSON issue&#39;s you&#39;ve been researching, has its hashcode implementation set to go through ALL your relationships to calculate equality and the hashcode, and it does so recursively on all these objects in the entire object graph. Don&#39;t use Lombok.. or don&#39;t use it for anything you don&#39;t explicitly need anyway. Check out the known issues with &#39;@Data&#39; annotations."}],"answers":[{"tags":[],"owner":{"account_id":10770525,"reputation":526,"user_id":7924110,"display_name":"Kenany"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1695329076,"creation_date":1695329076,"answer_id":77153556,"question_id":77151752,"body_markdown":"Your **following** attribute is mapped to **followers**, end the end they have the same value. But since you do this:\r\n\r\n    follower.getFollowing().add(followee);\r\n    followee.getFollowers().add(follower);\r\n\r\nYou add the **followee** as a following and the **follower** as a follower. But the follower already contains a followee. So when you will try to load each, It will try to load the other and so on until StackOverflow.\r\n\r\nAccording to me, you don&#39;t really need to have both **following** and **followers** list. According to your design, if a user is your follower, you are also his follower. So you just have to keep one list. But if **following** and **followers** lists should be different, you have to remove the **mappedBy** attribute.","title":"Self Join many to many relationship leads to Stack overflow","body":"<p>Your <strong>following</strong> attribute is mapped to <strong>followers</strong>, end the end they have the same value. But since you do this:</p>\n<pre><code>follower.getFollowing().add(followee);\nfollowee.getFollowers().add(follower);\n</code></pre>\n<p>You add the <strong>followee</strong> as a following and the <strong>follower</strong> as a follower. But the follower already contains a followee. So when you will try to load each, It will try to load the other and so on until StackOverflow.</p>\n<p>According to me, you don't really need to have both <strong>following</strong> and <strong>followers</strong> list. According to your design, if a user is your follower, you are also his follower. So you just have to keep one list. But if <strong>following</strong> and <strong>followers</strong> lists should be different, you have to remove the <strong>mappedBy</strong> attribute.</p>\n"}],"owner":{"account_id":6414502,"reputation":69,"user_id":4973124,"accept_rate":27,"display_name":"cornstar94"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":56,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":77153556,"answer_count":1,"score":1,"last_activity_date":1695351624,"creation_date":1695311023,"question_id":77151752,"body_markdown":"I am new to spring boot and Java and I am trying to establish a follower-following relationship by self joining my `tb_user` table.\r\n\r\nHowever I am getting a stackoverflow error. I tried to solve it but using `@JsonIgnore` and `@JsonIdentityInfo` like what many answers suggested but it doesn&#39;t seem to work. \r\n\r\nBelow is my code:\r\n\r\n\r\n**User.java**\r\n```\r\npackage com.codaholic.shop.models.security.user;\r\n\r\nimport com.codaholic.shop.models.Article;\r\nimport com.fasterxml.jackson.annotation.*;\r\nimport jakarta.persistence.*;\r\nimport lombok.*;\r\nimport org.springframework.security.core.GrantedAuthority;\r\nimport org.springframework.security.core.authority.SimpleGrantedAuthority;\r\nimport org.springframework.security.core.userdetails.UserDetails;\r\n\r\nimport java.util.Set;\r\nimport java.util.UUID;\r\nimport java.util.List;\r\nimport java.util.Collection;\r\n\r\n@Data\r\n@Builder\r\n@NoArgsConstructor\r\n@AllArgsConstructor\r\n@Entity\r\n@Table(name = &quot;tb_user&quot;)\r\npublic class User implements UserDetails{\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.UUID)\r\n    private UUID id;\r\n\r\n    private String firstName;\r\n    private String lastName;\r\n    private String email;\r\n    private String password;\r\n\r\n    @Enumerated(EnumType.STRING)\r\n    private Role role;\r\n\r\n    @Enumerated(EnumType.STRING)\r\n    @Builder.Default\r\n    private UserStatus status = UserStatus.ACTIVE;\r\n\r\n    @Override\r\n    public Collection&lt;? extends GrantedAuthority&gt; getAuthorities() {\r\n        return List.of(new SimpleGrantedAuthority(role.name()));\r\n    }\r\n\r\n    @Override\r\n    public String getUsername() {\r\n        return email;\r\n    }\r\n\r\n    @Override\r\n    public String getPassword(){\r\n        return password;\r\n    }\r\n\r\n    @Override\r\n    public boolean isAccountNonExpired(){\r\n        return true;\r\n    }\r\n\r\n    @Override\r\n    public boolean isAccountNonLocked(){\r\n        return true;\r\n    }\r\n\r\n    @Override\r\n    public boolean isCredentialsNonExpired(){\r\n        return true;\r\n    }\r\n\r\n    @Override\r\n    public boolean isEnabled() {\r\n        return true;\r\n    }\r\n\r\n    @OneToMany\r\n    private List&lt;Article&gt; articles;\r\n\r\n\r\n    @ManyToMany(\r\n            cascade={CascadeType.MERGE, CascadeType.DETACH, CascadeType.REFRESH},\r\n            fetch = FetchType.LAZY)\r\n    @JoinTable(\r\n            name = &quot;tb_follower_following&quot;,\r\n            joinColumns = @JoinColumn(name=&quot;followee_id&quot;, referencedColumnName = &quot;id&quot;), // the owning side of the r/s is this user\r\n            inverseJoinColumns = @JoinColumn(name=&quot;follower_id&quot;, referencedColumnName = &quot;id&quot;)\r\n    )\r\n    @JsonIgnore\r\n    private Set&lt;User&gt; followers;\r\n\r\n\r\n    @ManyToMany(mappedBy=&quot;followers&quot;)\r\n    @JsonIgnore\r\n    private Set&lt;User&gt; following;\r\n\r\n}\r\n```\r\n\r\n**UserRepository.java**\r\n\r\n```\r\npackage com.codaholic.shop.repository;\r\nimport com.codaholic.shop.models.security.user.User;\r\nimport com.codaholic.shop.models.security.user.UserStatus;\r\nimport org.springframework.data.jpa.repository.JpaRepository;\r\nimport org.springframework.data.repository.query.Param;\r\n\r\nimport java.util.Optional;\r\nimport java.util.UUID;\r\n\r\npublic interface UserRepository extends JpaRepository&lt;User, UUID&gt; {\r\n\r\n    Optional&lt;User&gt; findByEmail(String email);\r\n    Optional&lt;User&gt; findById(UUID id);\r\n    Optional&lt;User&gt; findByIdAndStatus(@Param(&quot;id&quot;) UUID id, UserStatus status);\r\n}\r\n```\r\n\r\n**FollowingService.java**\r\n```\r\npackage com.codaholic.shop.services;\r\n\r\nimport com.codaholic.shop.dto.FollowingResponseDTO;\r\nimport com.codaholic.shop.exceptions.ResourceNotFoundException;\r\nimport com.codaholic.shop.models.security.user.FollowingRequest;\r\nimport com.codaholic.shop.models.security.user.User;\r\nimport com.codaholic.shop.models.security.user.UserStatus;\r\nimport com.codaholic.shop.repository.UserRepository;\r\nimport org.springframework.stereotype.Service;\r\n\r\nimport java.util.UUID;\r\n\r\n@Service\r\npublic class FollowingService {\r\n\r\n    private final UserRepository userRepository;\r\n\r\n    FollowingService(UserRepository userRepository){\r\n        this.userRepository = userRepository;\r\n    }\r\n\r\n    public FollowingResponseDTO createFollowing(FollowingRequest request) throws ResourceNotFoundException {\r\n        UUID followerId = request.getFollowerId();\r\n        User follower = userRepository.findByIdAndStatus(followerId, UserStatus.ACTIVE)\r\n            .orElseThrow(\r\n                ()-&gt; new ResourceNotFoundException(String.format(&quot;User %s is not found&quot;, followerId))\r\n            );\r\n        UUID followingId = request.getFollowingId();\r\n\r\n        User followee = userRepository.findByIdAndStatus(followingId, UserStatus.ACTIVE)\r\n            .orElseThrow(\r\n                () -&gt; new ResourceNotFoundException(String.format(&quot;User %s is not found&quot;, followingId))\r\n            );\r\n\r\n        // Next create a new relation by setting their status to ACTIVE\r\n        follower.getFollowing().add(followee);\r\n        followee.getFollowers().add(follower);\r\n\r\n        userRepository.save(follower);\r\n        userRepository.save(followee);\r\n\r\n        FollowingResponseDTO followingResult = new FollowingResponseDTO();\r\n        followingResult.setFollowerId(followerId);\r\n        followingResult.setFollowingId(followingId);\r\n        followingResult.setSuccess(true);\r\n\r\n        return followingResult;\r\n\r\n    }\r\n\r\n}\r\n```\r\n\r\n**FollowingController**\r\n```\r\npackage com.codaholic.shop.controllers;\r\n\r\nimport com.codaholic.shop.dto.FollowingResponseDTO;\r\nimport com.codaholic.shop.exceptions.ResourceNotFoundException;\r\nimport com.codaholic.shop.models.security.user.FollowingRequest;\r\nimport com.codaholic.shop.services.FollowingService;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.http.ResponseEntity;\r\nimport org.springframework.web.bind.annotation.PostMapping;\r\nimport org.springframework.web.bind.annotation.RequestBody;\r\nimport org.springframework.web.bind.annotation.RequestMapping;\r\nimport org.springframework.web.bind.annotation.RestController;\r\n\r\n@RestController\r\n@RequestMapping(&quot;/api/v1/following&quot;)\r\npublic class FollowingController {\r\n    private final FollowingService followingService;\r\n\r\n    @Autowired\r\n    public FollowingController(FollowingService followingService) {\r\n        this.followingService = followingService;\r\n    }\r\n\r\n    @PostMapping\r\n    public ResponseEntity&lt;FollowingResponseDTO&gt; createFollowing(@RequestBody FollowingRequest request) throws ResourceNotFoundException {\r\n        FollowingResponseDTO result = followingService.createFollowing(request);\r\n        return ResponseEntity.ok().body(result);\r\n\r\n    }\r\n}\r\n\r\n```\r\n\r\n\r\nStack trace:\r\n```\r\n2023-09-21T23:41:46.787+08:00 DEBUG 75113 --- [nio-3000-exec-2] org.hibernate.SQL                        : \r\n    select\r\n        u1_0.id,\r\n        u1_0.email,\r\n        u1_0.first_name,\r\n        u1_0.last_name,\r\n        u1_0.password,\r\n        u1_0.role,\r\n        u1_0.status \r\n    from\r\n        tb_user u1_0 \r\n    where\r\n        u1_0.id=? \r\n        and u1_0.status=?\r\nHibernate: \r\n    select\r\n        u1_0.id,\r\n        u1_0.email,\r\n        u1_0.first_name,\r\n        u1_0.last_name,\r\n        u1_0.password,\r\n        u1_0.role,\r\n        u1_0.status \r\n    from\r\n        tb_user u1_0 \r\n    where\r\n        u1_0.id=? \r\n        and u1_0.status=?\r\n2023-09-21T23:41:46.791+08:00 DEBUG 75113 --- [nio-3000-exec-2] org.hibernate.SQL                        : \r\n    select\r\n        u1_0.id,\r\n        u1_0.email,\r\n        u1_0.first_name,\r\n        u1_0.last_name,\r\n        u1_0.password,\r\n        u1_0.role,\r\n        u1_0.status \r\n    from\r\n        tb_user u1_0 \r\n    where\r\n        u1_0.id=? \r\n        and u1_0.status=?\r\nHibernate: \r\n    select\r\n        u1_0.id,\r\n        u1_0.email,\r\n        u1_0.first_name,\r\n        u1_0.last_name,\r\n        u1_0.password,\r\n        u1_0.role,\r\n        u1_0.status \r\n    from\r\n        tb_user u1_0 \r\n    where\r\n        u1_0.id=? \r\n        and u1_0.status=?\r\n2023-09-21T23:41:46.794+08:00 DEBUG 75113 --- [nio-3000-exec-2] org.hibernate.SQL                        : \r\n    select\r\n        f1_0.follower_id,\r\n        f1_1.id,\r\n        f1_1.email,\r\n        f1_1.first_name,\r\n        f1_1.last_name,\r\n        f1_1.password,\r\n        f1_1.role,\r\n        f1_1.status \r\n    from\r\n        tb_follower_following f1_0 \r\n    join\r\n        tb_user f1_1 \r\n            on f1_1.id=f1_0.followee_id \r\n    where\r\n        f1_0.follower_id=?\r\nHibernate: \r\n    select\r\n        f1_0.follower_id,\r\n        f1_1.id,\r\n        f1_1.email,\r\n        f1_1.first_name,\r\n        f1_1.last_name,\r\n        f1_1.password,\r\n        f1_1.role,\r\n        f1_1.status \r\n    from\r\n        tb_follower_following f1_0 \r\n    join\r\n        tb_user f1_1 \r\n            on f1_1.id=f1_0.followee_id \r\n    where\r\n        f1_0.follower_id=?\r\n2023-09-21T23:41:46.796+08:00 DEBUG 75113 --- [nio-3000-exec-2] org.hibernate.SQL                        : \r\n    select\r\n        f1_0.followee_id,\r\n        f1_1.id,\r\n        f1_1.email,\r\n        f1_1.first_name,\r\n        f1_1.last_name,\r\n        f1_1.password,\r\n        f1_1.role,\r\n        f1_1.status \r\n    from\r\n        tb_follower_following f1_0 \r\n    join\r\n        tb_user f1_1 \r\n            on f1_1.id=f1_0.follower_id \r\n    where\r\n        f1_0.followee_id=?\r\nHibernate: \r\n    select\r\n        f1_0.followee_id,\r\n        f1_1.id,\r\n        f1_1.email,\r\n        f1_1.first_name,\r\n        f1_1.last_name,\r\n        f1_1.password,\r\n        f1_1.role,\r\n        f1_1.status \r\n    from\r\n        tb_follower_following f1_0 \r\n    join\r\n        tb_user f1_1 \r\n            on f1_1.id=f1_0.follower_id \r\n    where\r\n        f1_0.followee_id=?\r\n2023-09-21T23:41:46.798+08:00 DEBUG 75113 --- [nio-3000-exec-2] org.hibernate.SQL                        : \r\n    select\r\n        f1_0.follower_id,\r\n        f1_1.id,\r\n        f1_1.email,\r\n        f1_1.first_name,\r\n        f1_1.last_name,\r\n        f1_1.password,\r\n        f1_1.role,\r\n        f1_1.status \r\n    from\r\n        tb_follower_following f1_0 \r\n    join\r\n        tb_user f1_1 \r\n            on f1_1.id=f1_0.followee_id \r\n    where\r\n        f1_0.follower_id=?\r\nHibernate: \r\n    select\r\n        f1_0.follower_id,\r\n        f1_1.id,\r\n        f1_1.email,\r\n        f1_1.first_name,\r\n        f1_1.last_name,\r\n        f1_1.password,\r\n        f1_1.role,\r\n        f1_1.status \r\n    from\r\n        tb_follower_following f1_0 \r\n    join\r\n        tb_user f1_1 \r\n            on f1_1.id=f1_0.followee_id \r\n    where\r\n        f1_0.follower_id=?\r\n2023-09-21T23:41:46.800+08:00 DEBUG 75113 --- [nio-3000-exec-2] org.hibernate.SQL                        : \r\n    select\r\n        f1_0.followee_id,\r\n        f1_1.id,\r\n        f1_1.email,\r\n        f1_1.first_name,\r\n        f1_1.last_name,\r\n        f1_1.password,\r\n        f1_1.role,\r\n        f1_1.status \r\n    from\r\n        tb_follower_following f1_0 \r\n    join\r\n        tb_user f1_1 \r\n            on f1_1.id=f1_0.follower_id \r\n    where\r\n        f1_0.followee_id=?\r\nHibernate: \r\n    select\r\n        f1_0.followee_id,\r\n        f1_1.id,\r\n        f1_1.email,\r\n        f1_1.first_name,\r\n        f1_1.last_name,\r\n        f1_1.password,\r\n        f1_1.role,\r\n        f1_1.status \r\n    from\r\n        tb_follower_following f1_0 \r\n    join\r\n        tb_user f1_1 \r\n            on f1_1.id=f1_0.follower_id \r\n    where\r\n        f1_0.followee_id=?\r\n2023-09-21T23:41:46.810+08:00 DEBUG 75113 --- [nio-3000-exec-2] o.s.web.servlet.DispatcherServlet        : Failed to complete request: jakarta.servlet.ServletException: Handler dispatch failed: java.lang.StackOverflowError\r\n2023-09-21T23:41:46.811+08:00 ERROR 75113 --- [nio-3000-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Handler dispatch failed: java.lang.StackOverflowError] with root cause\r\n\r\njava.lang.StackOverflowError: null\r\n        at org.hibernate.collection.spi.PersistentSet.hashCode(PersistentSet.java:413) ~[hibernate-core-6.2.7.Final.jar:6.2.7.Final]\r\n        at com.codaholic.shop.models.security.user.User.hashCode(User.java:16) ~[main/:na]\r\n        at java.base/java.util.AbstractSet.hashCode(AbstractSet.java:124) ~[na:na]\r\n        at org.hibernate.collection.spi.PersistentSet.hashCode(PersistentSet.java:413) ~[hibernate-core-6.2.7.Final.jar:6.2.7.Final]\r\n        at com.codaholic.shop.models.security.user.User.hashCode(User.java:16) ~[main/:na]\r\n        at java.base/java.util.AbstractSet.hashCode(AbstractSet.java:124) ~[na:na]\r\n        at org.hibernate.collection.spi.PersistentSet.hashCode(PersistentSet.java:413) ~[hibernate-core-6.2.7.Final.jar:6.2.7.Final]\r\n\r\n```\r\n\r\nEdit: \r\nAs per @RomanC&#39;s explanation, I have since removed adding one side of the list and now the stackoverflow is resolved.\r\ni.e from \r\n```\r\n        follower.getFollowing().add(followee);\r\n        followee.getFollowers().add(follower);\r\n\r\n        userRepository.save(follower);\r\n        userRepository.save(followee);\r\n```\r\n\r\nto \r\n\r\n```\r\n        follower.getFollowing().add(followee);\r\n        userRepository.save(follower);\r\n```\r\n\r\nSimilarly, I also made amendments to remove the `mappedBy` as suggested since both the follower and following can &quot;own&quot; the relationship.\r\n\r\n```\r\n    @ManyToMany(\r\n            cascade={CascadeType.MERGE, CascadeType.DETACH, CascadeType.REFRESH},\r\n            fetch = FetchType.LAZY)\r\n    @JoinTable(\r\n            name = &quot;tb_follower_following&quot;,\r\n            joinColumns = @JoinColumn(name=&quot;following_id&quot;, referencedColumnName = &quot;id&quot;), // ie. the FK is the follower_id\r\n            inverseJoinColumns = @JoinColumn(name=&quot;follower_id&quot;, referencedColumnName = &quot;id&quot;)\r\n    )\r\n    private Set&lt;User&gt; followers;\r\n\r\n\r\n    @ManyToMany\r\n    @JoinTable(\r\n            name = &quot;tb_follower_following&quot;,\r\n            joinColumns = @JoinColumn(name=&quot;follower_id&quot;, referencedColumnName = &quot;id&quot;), // ie. the FK is the following_id\r\n            inverseJoinColumns = @JoinColumn(name=&quot;following_id&quot;, referencedColumnName = &quot;id&quot;)\r\n    )\r\n    private Set&lt;User&gt; following;\r\n\r\n```\r\n\r\nAlso realized that the @JsonIgnore was no longer necessary.\r\n","title":"Self Join many to many relationship leads to Stack overflow","body":"<p>I am new to spring boot and Java and I am trying to establish a follower-following relationship by self joining my <code>tb_user</code> table.</p>\n<p>However I am getting a stackoverflow error. I tried to solve it but using <code>@JsonIgnore</code> and <code>@JsonIdentityInfo</code> like what many answers suggested but it doesn't seem to work.</p>\n<p>Below is my code:</p>\n<p><strong>User.java</strong></p>\n<pre><code>package com.codaholic.shop.models.security.user;\n\nimport com.codaholic.shop.models.Article;\nimport com.fasterxml.jackson.annotation.*;\nimport jakarta.persistence.*;\nimport lombok.*;\nimport org.springframework.security.core.GrantedAuthority;\nimport org.springframework.security.core.authority.SimpleGrantedAuthority;\nimport org.springframework.security.core.userdetails.UserDetails;\n\nimport java.util.Set;\nimport java.util.UUID;\nimport java.util.List;\nimport java.util.Collection;\n\n@Data\n@Builder\n@NoArgsConstructor\n@AllArgsConstructor\n@Entity\n@Table(name = &quot;tb_user&quot;)\npublic class User implements UserDetails{\n    @Id\n    @GeneratedValue(strategy = GenerationType.UUID)\n    private UUID id;\n\n    private String firstName;\n    private String lastName;\n    private String email;\n    private String password;\n\n    @Enumerated(EnumType.STRING)\n    private Role role;\n\n    @Enumerated(EnumType.STRING)\n    @Builder.Default\n    private UserStatus status = UserStatus.ACTIVE;\n\n    @Override\n    public Collection&lt;? extends GrantedAuthority&gt; getAuthorities() {\n        return List.of(new SimpleGrantedAuthority(role.name()));\n    }\n\n    @Override\n    public String getUsername() {\n        return email;\n    }\n\n    @Override\n    public String getPassword(){\n        return password;\n    }\n\n    @Override\n    public boolean isAccountNonExpired(){\n        return true;\n    }\n\n    @Override\n    public boolean isAccountNonLocked(){\n        return true;\n    }\n\n    @Override\n    public boolean isCredentialsNonExpired(){\n        return true;\n    }\n\n    @Override\n    public boolean isEnabled() {\n        return true;\n    }\n\n    @OneToMany\n    private List&lt;Article&gt; articles;\n\n\n    @ManyToMany(\n            cascade={CascadeType.MERGE, CascadeType.DETACH, CascadeType.REFRESH},\n            fetch = FetchType.LAZY)\n    @JoinTable(\n            name = &quot;tb_follower_following&quot;,\n            joinColumns = @JoinColumn(name=&quot;followee_id&quot;, referencedColumnName = &quot;id&quot;), // the owning side of the r/s is this user\n            inverseJoinColumns = @JoinColumn(name=&quot;follower_id&quot;, referencedColumnName = &quot;id&quot;)\n    )\n    @JsonIgnore\n    private Set&lt;User&gt; followers;\n\n\n    @ManyToMany(mappedBy=&quot;followers&quot;)\n    @JsonIgnore\n    private Set&lt;User&gt; following;\n\n}\n</code></pre>\n<p><strong>UserRepository.java</strong></p>\n<pre><code>package com.codaholic.shop.repository;\nimport com.codaholic.shop.models.security.user.User;\nimport com.codaholic.shop.models.security.user.UserStatus;\nimport org.springframework.data.jpa.repository.JpaRepository;\nimport org.springframework.data.repository.query.Param;\n\nimport java.util.Optional;\nimport java.util.UUID;\n\npublic interface UserRepository extends JpaRepository&lt;User, UUID&gt; {\n\n    Optional&lt;User&gt; findByEmail(String email);\n    Optional&lt;User&gt; findById(UUID id);\n    Optional&lt;User&gt; findByIdAndStatus(@Param(&quot;id&quot;) UUID id, UserStatus status);\n}\n</code></pre>\n<p><strong>FollowingService.java</strong></p>\n<pre><code>package com.codaholic.shop.services;\n\nimport com.codaholic.shop.dto.FollowingResponseDTO;\nimport com.codaholic.shop.exceptions.ResourceNotFoundException;\nimport com.codaholic.shop.models.security.user.FollowingRequest;\nimport com.codaholic.shop.models.security.user.User;\nimport com.codaholic.shop.models.security.user.UserStatus;\nimport com.codaholic.shop.repository.UserRepository;\nimport org.springframework.stereotype.Service;\n\nimport java.util.UUID;\n\n@Service\npublic class FollowingService {\n\n    private final UserRepository userRepository;\n\n    FollowingService(UserRepository userRepository){\n        this.userRepository = userRepository;\n    }\n\n    public FollowingResponseDTO createFollowing(FollowingRequest request) throws ResourceNotFoundException {\n        UUID followerId = request.getFollowerId();\n        User follower = userRepository.findByIdAndStatus(followerId, UserStatus.ACTIVE)\n            .orElseThrow(\n                ()-&gt; new ResourceNotFoundException(String.format(&quot;User %s is not found&quot;, followerId))\n            );\n        UUID followingId = request.getFollowingId();\n\n        User followee = userRepository.findByIdAndStatus(followingId, UserStatus.ACTIVE)\n            .orElseThrow(\n                () -&gt; new ResourceNotFoundException(String.format(&quot;User %s is not found&quot;, followingId))\n            );\n\n        // Next create a new relation by setting their status to ACTIVE\n        follower.getFollowing().add(followee);\n        followee.getFollowers().add(follower);\n\n        userRepository.save(follower);\n        userRepository.save(followee);\n\n        FollowingResponseDTO followingResult = new FollowingResponseDTO();\n        followingResult.setFollowerId(followerId);\n        followingResult.setFollowingId(followingId);\n        followingResult.setSuccess(true);\n\n        return followingResult;\n\n    }\n\n}\n</code></pre>\n<p><strong>FollowingController</strong></p>\n<pre><code>package com.codaholic.shop.controllers;\n\nimport com.codaholic.shop.dto.FollowingResponseDTO;\nimport com.codaholic.shop.exceptions.ResourceNotFoundException;\nimport com.codaholic.shop.models.security.user.FollowingRequest;\nimport com.codaholic.shop.services.FollowingService;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.RequestBody;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n@RestController\n@RequestMapping(&quot;/api/v1/following&quot;)\npublic class FollowingController {\n    private final FollowingService followingService;\n\n    @Autowired\n    public FollowingController(FollowingService followingService) {\n        this.followingService = followingService;\n    }\n\n    @PostMapping\n    public ResponseEntity&lt;FollowingResponseDTO&gt; createFollowing(@RequestBody FollowingRequest request) throws ResourceNotFoundException {\n        FollowingResponseDTO result = followingService.createFollowing(request);\n        return ResponseEntity.ok().body(result);\n\n    }\n}\n\n</code></pre>\n<p>Stack trace:</p>\n<pre><code>2023-09-21T23:41:46.787+08:00 DEBUG 75113 --- [nio-3000-exec-2] org.hibernate.SQL                        : \n    select\n        u1_0.id,\n        u1_0.email,\n        u1_0.first_name,\n        u1_0.last_name,\n        u1_0.password,\n        u1_0.role,\n        u1_0.status \n    from\n        tb_user u1_0 \n    where\n        u1_0.id=? \n        and u1_0.status=?\nHibernate: \n    select\n        u1_0.id,\n        u1_0.email,\n        u1_0.first_name,\n        u1_0.last_name,\n        u1_0.password,\n        u1_0.role,\n        u1_0.status \n    from\n        tb_user u1_0 \n    where\n        u1_0.id=? \n        and u1_0.status=?\n2023-09-21T23:41:46.791+08:00 DEBUG 75113 --- [nio-3000-exec-2] org.hibernate.SQL                        : \n    select\n        u1_0.id,\n        u1_0.email,\n        u1_0.first_name,\n        u1_0.last_name,\n        u1_0.password,\n        u1_0.role,\n        u1_0.status \n    from\n        tb_user u1_0 \n    where\n        u1_0.id=? \n        and u1_0.status=?\nHibernate: \n    select\n        u1_0.id,\n        u1_0.email,\n        u1_0.first_name,\n        u1_0.last_name,\n        u1_0.password,\n        u1_0.role,\n        u1_0.status \n    from\n        tb_user u1_0 \n    where\n        u1_0.id=? \n        and u1_0.status=?\n2023-09-21T23:41:46.794+08:00 DEBUG 75113 --- [nio-3000-exec-2] org.hibernate.SQL                        : \n    select\n        f1_0.follower_id,\n        f1_1.id,\n        f1_1.email,\n        f1_1.first_name,\n        f1_1.last_name,\n        f1_1.password,\n        f1_1.role,\n        f1_1.status \n    from\n        tb_follower_following f1_0 \n    join\n        tb_user f1_1 \n            on f1_1.id=f1_0.followee_id \n    where\n        f1_0.follower_id=?\nHibernate: \n    select\n        f1_0.follower_id,\n        f1_1.id,\n        f1_1.email,\n        f1_1.first_name,\n        f1_1.last_name,\n        f1_1.password,\n        f1_1.role,\n        f1_1.status \n    from\n        tb_follower_following f1_0 \n    join\n        tb_user f1_1 \n            on f1_1.id=f1_0.followee_id \n    where\n        f1_0.follower_id=?\n2023-09-21T23:41:46.796+08:00 DEBUG 75113 --- [nio-3000-exec-2] org.hibernate.SQL                        : \n    select\n        f1_0.followee_id,\n        f1_1.id,\n        f1_1.email,\n        f1_1.first_name,\n        f1_1.last_name,\n        f1_1.password,\n        f1_1.role,\n        f1_1.status \n    from\n        tb_follower_following f1_0 \n    join\n        tb_user f1_1 \n            on f1_1.id=f1_0.follower_id \n    where\n        f1_0.followee_id=?\nHibernate: \n    select\n        f1_0.followee_id,\n        f1_1.id,\n        f1_1.email,\n        f1_1.first_name,\n        f1_1.last_name,\n        f1_1.password,\n        f1_1.role,\n        f1_1.status \n    from\n        tb_follower_following f1_0 \n    join\n        tb_user f1_1 \n            on f1_1.id=f1_0.follower_id \n    where\n        f1_0.followee_id=?\n2023-09-21T23:41:46.798+08:00 DEBUG 75113 --- [nio-3000-exec-2] org.hibernate.SQL                        : \n    select\n        f1_0.follower_id,\n        f1_1.id,\n        f1_1.email,\n        f1_1.first_name,\n        f1_1.last_name,\n        f1_1.password,\n        f1_1.role,\n        f1_1.status \n    from\n        tb_follower_following f1_0 \n    join\n        tb_user f1_1 \n            on f1_1.id=f1_0.followee_id \n    where\n        f1_0.follower_id=?\nHibernate: \n    select\n        f1_0.follower_id,\n        f1_1.id,\n        f1_1.email,\n        f1_1.first_name,\n        f1_1.last_name,\n        f1_1.password,\n        f1_1.role,\n        f1_1.status \n    from\n        tb_follower_following f1_0 \n    join\n        tb_user f1_1 \n            on f1_1.id=f1_0.followee_id \n    where\n        f1_0.follower_id=?\n2023-09-21T23:41:46.800+08:00 DEBUG 75113 --- [nio-3000-exec-2] org.hibernate.SQL                        : \n    select\n        f1_0.followee_id,\n        f1_1.id,\n        f1_1.email,\n        f1_1.first_name,\n        f1_1.last_name,\n        f1_1.password,\n        f1_1.role,\n        f1_1.status \n    from\n        tb_follower_following f1_0 \n    join\n        tb_user f1_1 \n            on f1_1.id=f1_0.follower_id \n    where\n        f1_0.followee_id=?\nHibernate: \n    select\n        f1_0.followee_id,\n        f1_1.id,\n        f1_1.email,\n        f1_1.first_name,\n        f1_1.last_name,\n        f1_1.password,\n        f1_1.role,\n        f1_1.status \n    from\n        tb_follower_following f1_0 \n    join\n        tb_user f1_1 \n            on f1_1.id=f1_0.follower_id \n    where\n        f1_0.followee_id=?\n2023-09-21T23:41:46.810+08:00 DEBUG 75113 --- [nio-3000-exec-2] o.s.web.servlet.DispatcherServlet        : Failed to complete request: jakarta.servlet.ServletException: Handler dispatch failed: java.lang.StackOverflowError\n2023-09-21T23:41:46.811+08:00 ERROR 75113 --- [nio-3000-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Handler dispatch failed: java.lang.StackOverflowError] with root cause\n\njava.lang.StackOverflowError: null\n        at org.hibernate.collection.spi.PersistentSet.hashCode(PersistentSet.java:413) ~[hibernate-core-6.2.7.Final.jar:6.2.7.Final]\n        at com.codaholic.shop.models.security.user.User.hashCode(User.java:16) ~[main/:na]\n        at java.base/java.util.AbstractSet.hashCode(AbstractSet.java:124) ~[na:na]\n        at org.hibernate.collection.spi.PersistentSet.hashCode(PersistentSet.java:413) ~[hibernate-core-6.2.7.Final.jar:6.2.7.Final]\n        at com.codaholic.shop.models.security.user.User.hashCode(User.java:16) ~[main/:na]\n        at java.base/java.util.AbstractSet.hashCode(AbstractSet.java:124) ~[na:na]\n        at org.hibernate.collection.spi.PersistentSet.hashCode(PersistentSet.java:413) ~[hibernate-core-6.2.7.Final.jar:6.2.7.Final]\n\n</code></pre>\n<p>Edit:\nAs per @RomanC's explanation, I have since removed adding one side of the list and now the stackoverflow is resolved.\ni.e from</p>\n<pre><code>        follower.getFollowing().add(followee);\n        followee.getFollowers().add(follower);\n\n        userRepository.save(follower);\n        userRepository.save(followee);\n</code></pre>\n<p>to</p>\n<pre><code>        follower.getFollowing().add(followee);\n        userRepository.save(follower);\n</code></pre>\n<p>Similarly, I also made amendments to remove the <code>mappedBy</code> as suggested since both the follower and following can &quot;own&quot; the relationship.</p>\n<pre><code>    @ManyToMany(\n            cascade={CascadeType.MERGE, CascadeType.DETACH, CascadeType.REFRESH},\n            fetch = FetchType.LAZY)\n    @JoinTable(\n            name = &quot;tb_follower_following&quot;,\n            joinColumns = @JoinColumn(name=&quot;following_id&quot;, referencedColumnName = &quot;id&quot;), // ie. the FK is the follower_id\n            inverseJoinColumns = @JoinColumn(name=&quot;follower_id&quot;, referencedColumnName = &quot;id&quot;)\n    )\n    private Set&lt;User&gt; followers;\n\n\n    @ManyToMany\n    @JoinTable(\n            name = &quot;tb_follower_following&quot;,\n            joinColumns = @JoinColumn(name=&quot;follower_id&quot;, referencedColumnName = &quot;id&quot;), // ie. the FK is the following_id\n            inverseJoinColumns = @JoinColumn(name=&quot;following_id&quot;, referencedColumnName = &quot;id&quot;)\n    )\n    private Set&lt;User&gt; following;\n\n</code></pre>\n<p>Also realized that the @JsonIgnore was no longer necessary.</p>\n"},{"tags":["java","android","flutter","android-studio","android-emulator"],"comments":[{"owner":{"account_id":251706,"reputation":5298,"user_id":529282,"display_name":"Martheen"},"score":1,"creation_date":1695347763,"post_id":77154477,"comment_id":136015621,"body_markdown":"Have you tried installing the proper gradle version?","body":"Have you tried installing the proper gradle version?"},{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1695365056,"post_id":77154477,"comment_id":136017082,"body_markdown":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking.","body":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking."}],"answers":[{"tags":[],"owner":{"account_id":21009359,"reputation":1194,"user_id":15438326,"display_name":"Priyanshu Paliwal"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695351497,"creation_date":1695351497,"answer_id":77154634,"question_id":77154477,"body_markdown":"Try these\r\n\r\nCheck if your `Gradle plugin` version and `Kotlin` version used in your project are compatible with each other.\r\n\r\nAnd\r\n\r\nCheck your `Java SDK` if it compatible with the `Gradle plugin` version \r\n\r\nif not change the `Java SDK` or `Gradle plugin` accordingly \r\n\r\nThen run the Gradle build.\r\n\r\nI hope this will resolve your issue.\r\n","title":"i can&#39;t run a flutter app on android studio emulator","body":"<p>Try these</p>\n<p>Check if your <code>Gradle plugin</code> version and <code>Kotlin</code> version used in your project are compatible with each other.</p>\n<p>And</p>\n<p>Check your <code>Java SDK</code> if it compatible with the <code>Gradle plugin</code> version</p>\n<p>if not change the <code>Java SDK</code> or <code>Gradle plugin</code> accordingly</p>\n<p>Then run the Gradle build.</p>\n<p>I hope this will resolve your issue.</p>\n"}],"owner":{"account_id":29505247,"reputation":1,"user_id":22611343,"display_name":"Mayar Ism"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":83,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1695351497,"creation_date":1695347300,"question_id":77154477,"body_markdown":"i&#39;m having a problem running the flutter app on the androidstudio emulator\r\n\r\n\r\n\r\n```\r\nFAILURE: Build failed with an exception.\r\n\r\n* What went wrong:\r\nA problem occurred configuring root project &#39;android&#39;.\r\n&gt; Could not resolve all files for configuration &#39;:classpath&#39;.\r\n   &gt; Could not find gradle-7.3.0.jar (com.android.tools.build:gradle:7.3.0).\r\n     Searched in the following locations:\r\n         https://dl.google.com/dl/android/maven2/com/android/tools/build/gradle/7.3.0/gradle-7.3.0.jar\r\n   &gt; Could not find builder-7.3.0.jar (com.android.tools.build:builder:7.3.0).\r\n     Searched in the following locations:\r\n         https://dl.google.com/dl/android/maven2/com/android/tools/build/builder/7.3.0/builder-7.3.0.jar\r\n   &gt; Could not find bundletool-1.9.0.jar (com.android.tools.build:bundletool:1.9.0).\r\n     Searched in the following locations:\r\n         https://dl.google.com/dl/android/maven2/com/android/tools/build/bundletool/1.9.0/bundletool-1.9.0.jar\r\n   &gt; Could not find protos-30.3.0.jar (com.android.tools.analytics-library:protos:30.3.0).\r\n     Searched in the following locations:\r\n         https://dl.google.com/dl/android/maven2/com/android/tools/analytics-library/protos/30.3.0/protos-30.3.0.jar\r\n\r\n* Try:\r\n&gt; Run with --stacktrace option to get the stack trace.\r\n&gt; Run with --info or --debug option to get more log output.\r\n&gt; Run with --scan to get full insights.\r\n\r\n* Get more help at https://help.gradle.org\r\n\r\nBUILD FAILED in 1s\r\nException: Gradle task assembleDebug failed with exit code 1\r\n```\r\n\r\n\r\n\r\ni tried updating java and it gave me an error ","title":"i can&#39;t run a flutter app on android studio emulator","body":"<p>i'm having a problem running the flutter app on the androidstudio emulator</p>\n<pre><code>FAILURE: Build failed with an exception.\n\n* What went wrong:\nA problem occurred configuring root project 'android'.\n&gt; Could not resolve all files for configuration ':classpath'.\n   &gt; Could not find gradle-7.3.0.jar (com.android.tools.build:gradle:7.3.0).\n     Searched in the following locations:\n         https://dl.google.com/dl/android/maven2/com/android/tools/build/gradle/7.3.0/gradle-7.3.0.jar\n   &gt; Could not find builder-7.3.0.jar (com.android.tools.build:builder:7.3.0).\n     Searched in the following locations:\n         https://dl.google.com/dl/android/maven2/com/android/tools/build/builder/7.3.0/builder-7.3.0.jar\n   &gt; Could not find bundletool-1.9.0.jar (com.android.tools.build:bundletool:1.9.0).\n     Searched in the following locations:\n         https://dl.google.com/dl/android/maven2/com/android/tools/build/bundletool/1.9.0/bundletool-1.9.0.jar\n   &gt; Could not find protos-30.3.0.jar (com.android.tools.analytics-library:protos:30.3.0).\n     Searched in the following locations:\n         https://dl.google.com/dl/android/maven2/com/android/tools/analytics-library/protos/30.3.0/protos-30.3.0.jar\n\n* Try:\n&gt; Run with --stacktrace option to get the stack trace.\n&gt; Run with --info or --debug option to get more log output.\n&gt; Run with --scan to get full insights.\n\n* Get more help at https://help.gradle.org\n\nBUILD FAILED in 1s\nException: Gradle task assembleDebug failed with exit code 1\n</code></pre>\n<p>i tried updating java and it gave me an error</p>\n"},{"tags":["java","large-files","netflix-zuul"],"comments":[{"owner":{"account_id":3583709,"reputation":1,"user_id":2991306,"display_name":"lightling"},"score":0,"creation_date":1695351440,"post_id":77154619,"comment_id":136015877,"body_markdown":"The reason I want to fix this problem is because my zuul is being brokered by nginx, which is consider this is exception package, and finally  the service times out","body":"The reason I want to fix this problem is because my zuul is being brokered by nginx, which is consider this is exception package, and finally  the service times out"},{"owner":{"account_id":372682,"reputation":22426,"user_id":721855,"display_name":"aled"},"score":0,"creation_date":1695351882,"post_id":77154619,"comment_id":136015913,"body_markdown":"Do not use images for text information. Add the information as text in the question and not as links. And what is a `response package`?","body":"Do not use images for text information. Add the information as text in the question and not as links. And what is a <code>response package</code>?"},{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1695366151,"post_id":77154619,"comment_id":136017268,"body_markdown":"Please provide enough code so others can better understand or reproduce the problem.","body":"Please provide enough code so others can better understand or reproduce the problem."}],"owner":{"account_id":3583709,"reputation":1,"user_id":2991306,"display_name":"lightling"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":15,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1695351026,"creation_date":1695351026,"question_id":77154619,"body_markdown":"My project uses zuul1, has a file upload module, and the client call interface, as others have reported, is http://zuul-proxy/zuul/upload-module/file\r\n\r\nHowever, I found that when the file is large, the response package is not normal, which causes nginx to think that the response is not normal and wait for a timeout. From this curl, you can see that the terminal will be linked\r\n[url http://ip:port/zuul/upload-module  failed](https://i.stack.imgur.com/uyovF.png)\r\n\r\n\r\nBut if the request http://zuul-proxy/upload-module/file is normal\r\n[url http://ip:port/upload-module  success](https://i.stack.imgur.com/l5S32.png)\r\n\r\nVery strange problem, after analysis when using zuul in the url will skip the DispatcherServlet, should be related to this, but do not know how to solve?\r\n\r\nuse zuul prefix will skip the DispatcherServlet, which leads to the above problem\r\n\r\nAnd if i config zuul.servlet-path = /,   Whether used or not &quot;zuul&quot; prefix will go wrong.\r\n\r\nI guess I skipped the DispatcherServlet but didn&#39;t know how to solve it\r\n\r\nPlease help ","title":"netflix zuul1, a strange phenomenon of uploading large files with multipart file?","body":"<p>My project uses zuul1, has a file upload module, and the client call interface, as others have reported, is http://zuul-proxy/zuul/upload-module/file</p>\n<p>However, I found that when the file is large, the response package is not normal, which causes nginx to think that the response is not normal and wait for a timeout. From this curl, you can see that the terminal will be linked\n<a href=\"https://i.stack.imgur.com/uyovF.png\" rel=\"nofollow noreferrer\">url http://ip:port/zuul/upload-module  failed</a></p>\n<p>But if the request http://zuul-proxy/upload-module/file is normal\n<a href=\"https://i.stack.imgur.com/l5S32.png\" rel=\"nofollow noreferrer\">url http://ip:port/upload-module  success</a></p>\n<p>Very strange problem, after analysis when using zuul in the url will skip the DispatcherServlet, should be related to this, but do not know how to solve?</p>\n<p>use zuul prefix will skip the DispatcherServlet, which leads to the above problem</p>\n<p>And if i config zuul.servlet-path = /,   Whether used or not &quot;zuul&quot; prefix will go wrong.</p>\n<p>I guess I skipped the DispatcherServlet but didn't know how to solve it</p>\n<p>Please help</p>\n"},{"tags":["java","multithreading","concurrency"],"comments":[{"owner":{"account_id":14357,"reputation":9128,"user_id":29470,"display_name":"Tim Moore"},"score":1,"creation_date":1695250240,"post_id":77139808,"comment_id":136000974,"body_markdown":"If you only want to run one task at a time, why use multiple threads at all?","body":"If you only want to run one task at a time, why use multiple threads at all?"}],"answers":[{"tags":[],"owner":{"account_id":14357,"reputation":9128,"user_id":29470,"display_name":"Tim Moore"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1695350309,"creation_date":1695350309,"answer_id":77154592,"question_id":77139808,"body_markdown":"If you wish to run each command sequentially, the simplest solution is to use a single-threaded executor:\r\n\r\n    ExecutorService executorService = Executors.newSingleThreadExecutor();\r\n    executorService.execute(command);\r\n\r\nAn `Executor` already implements an internal queue of commands or tasks, so it&#39;s unnecessary to add another queue to it.\r\n\r\nThe [documentation for `Executors.newSingleThreadExecutor`][1] describes it this way:\r\n\r\n&gt; Creates an Executor that uses a single worker thread operating off an unbounded queue. (Note however that if this single thread terminates due to a failure during execution prior to shutdown, a new one will take its place if needed to execute subsequent tasks.) Tasks are guaranteed to execute sequentially, and no more than one task will be active at any given time.\r\n\r\n  [1]: https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executors.html#newSingleThreadExecutor--","title":"how to avoid using lock primitive to ensure only one task in the queue is running until it has finished?","body":"<p>If you wish to run each command sequentially, the simplest solution is to use a single-threaded executor:</p>\n<pre><code>ExecutorService executorService = Executors.newSingleThreadExecutor();\nexecutorService.execute(command);\n</code></pre>\n<p>An <code>Executor</code> already implements an internal queue of commands or tasks, so it's unnecessary to add another queue to it.</p>\n<p>The <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executors.html#newSingleThreadExecutor--\" rel=\"nofollow noreferrer\">documentation for <code>Executors.newSingleThreadExecutor</code></a> describes it this way:</p>\n<blockquote>\n<p>Creates an Executor that uses a single worker thread operating off an unbounded queue. (Note however that if this single thread terminates due to a failure during execution prior to shutdown, a new one will take its place if needed to execute subsequent tasks.) Tasks are guaranteed to execute sequentially, and no more than one task will be active at any given time.</p>\n</blockquote>\n"}],"owner":{"account_id":15968441,"reputation":373,"user_id":11523294,"display_name":"Criwran"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":59,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1695350309,"creation_date":1695191351,"question_id":77139808,"body_markdown":"For the following code, I think using `synchronized` is expensive because thread switching consuming much resource. \r\n\r\n```\r\npublic class Queue {\r\n    public static final Executor EXECUTOR = new Executor(16, 16);\r\n\r\n    @Getter\r\n    private final long id;\r\n    @Getter\r\n    private final String name;\r\n    @Getter\r\n    private final int capacity;\r\n\r\n    private final java.util.Queue&lt;Command&gt; queue;\r\n\r\n    private boolean running = false;\r\n    @Getter\r\n    @Setter\r\n    private boolean destroy = false;\r\n\r\n\r\n    public Queue(long id, String name, int capacity) {\r\n        this.id = id;\r\n        this.name = name;\r\n        this.capacity = capacity;\r\n        this.queue = new ArrayDeque&lt;&gt;();\r\n    }\r\n\r\n    public boolean append(Command command) {\r\n        command.setQueue(this);\r\n        synchronized (this) {\r\n            if (!running &amp;&amp; !destroy) {\r\n                running = true;\r\n                EXECUTOR.execute(command);\r\n                return true;\r\n            }\r\n            return queue.offer(command);\r\n        }\r\n    }\r\n\r\n    protected void resume() {\r\n        synchronized (this) {\r\n            if (destroy) {\r\n                running = false;\r\n                return;\r\n            }\r\n            Command command = queue.poll();\r\n            if (command == null) {\r\n                running = false;\r\n                return;\r\n            }\r\n            EXECUTOR.execute(command);\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\npublic class Executor extends ThreadPoolExecutor {\r\n    public Executor(int corePoolSize, int maxPoolSize) {\r\n        super(corePoolSize, maxPoolSize, 30L, TimeUnit.SECONDS, new LinkedBlockingQueue&lt;&gt;(), new ThreadFactory() {\r\n            final AtomicInteger n = new AtomicInteger(0);\r\n            @Override\r\n            public Thread newThread(Runnable r) {\r\n                String name = &quot;queue-execute-thread-&quot; + n.incrementAndGet();\r\n                return new Thread(r, name);\r\n            }\r\n        });\r\n    }\r\n\r\n    @Override\r\n    protected void afterExecute(Runnable r, Throwable t) {\r\n        super.afterExecute(r, t);\r\n        ((Command) r).getQueue().resume();\r\n    }\r\n}\r\n```\r\n\r\nIs there any solution to avoid using lock primitive to ensure only one task in the queue is running until it has finished?","title":"how to avoid using lock primitive to ensure only one task in the queue is running until it has finished?","body":"<p>For the following code, I think using <code>synchronized</code> is expensive because thread switching consuming much resource.</p>\n<pre><code>public class Queue {\n    public static final Executor EXECUTOR = new Executor(16, 16);\n\n    @Getter\n    private final long id;\n    @Getter\n    private final String name;\n    @Getter\n    private final int capacity;\n\n    private final java.util.Queue&lt;Command&gt; queue;\n\n    private boolean running = false;\n    @Getter\n    @Setter\n    private boolean destroy = false;\n\n\n    public Queue(long id, String name, int capacity) {\n        this.id = id;\n        this.name = name;\n        this.capacity = capacity;\n        this.queue = new ArrayDeque&lt;&gt;();\n    }\n\n    public boolean append(Command command) {\n        command.setQueue(this);\n        synchronized (this) {\n            if (!running &amp;&amp; !destroy) {\n                running = true;\n                EXECUTOR.execute(command);\n                return true;\n            }\n            return queue.offer(command);\n        }\n    }\n\n    protected void resume() {\n        synchronized (this) {\n            if (destroy) {\n                running = false;\n                return;\n            }\n            Command command = queue.poll();\n            if (command == null) {\n                running = false;\n                return;\n            }\n            EXECUTOR.execute(command);\n        }\n    }\n\n}\n\n\npublic class Executor extends ThreadPoolExecutor {\n    public Executor(int corePoolSize, int maxPoolSize) {\n        super(corePoolSize, maxPoolSize, 30L, TimeUnit.SECONDS, new LinkedBlockingQueue&lt;&gt;(), new ThreadFactory() {\n            final AtomicInteger n = new AtomicInteger(0);\n            @Override\n            public Thread newThread(Runnable r) {\n                String name = &quot;queue-execute-thread-&quot; + n.incrementAndGet();\n                return new Thread(r, name);\n            }\n        });\n    }\n\n    @Override\n    protected void afterExecute(Runnable r, Throwable t) {\n        super.afterExecute(r, t);\n        ((Command) r).getQueue().resume();\n    }\n}\n</code></pre>\n<p>Is there any solution to avoid using lock primitive to ensure only one task in the queue is running until it has finished?</p>\n"},{"tags":["java","unit-testing","groovy","spock","spy"],"comments":[{"owner":{"account_id":4358,"reputation":168410,"user_id":6509,"display_name":"tim_yates"},"score":0,"creation_date":1695299111,"post_id":77147011,"comment_id":136007694,"body_markdown":"Is `method1` in your class `A`?","body":"Is <code>method1</code> in your class <code>A</code>?"},{"owner":{"account_id":67966,"reputation":12546,"user_id":2145769,"accept_rate":67,"display_name":"Leonard Br&#252;nings"},"score":2,"creation_date":1695302977,"post_id":77147011,"comment_id":136008586,"body_markdown":"Well, it is called unit-test not method-test, so you are testing a unit of code. I&#39;d argue that these private methods belong to the unit you are testing. If that is not the case, then you should refactor your code, so that you can inject them as dependencies, which will also allow you to mock them easily. More importantly you want to test for the outcome, not what happens inside the method, as that leads to over-specification.","body":"Well, it is called unit-test not method-test, so you are testing a unit of code. I&#39;d argue that these private methods belong to the unit you are testing. If that is not the case, then you should refactor your code, so that you can inject them as dependencies, which will also allow you to mock them easily. More importantly you want to test for the outcome, not what happens inside the method, as that leads to over-specification."},{"owner":{"account_id":1087271,"reputation":64101,"user_id":1082681,"accept_rate":90,"display_name":"kriegaex"},"score":0,"creation_date":1695429852,"post_id":77147011,"comment_id":136027866,"body_markdown":"Do you have any specific reason to be stuck on Spock 1.x? I recommend Spock 2.x, it has lots of improvements. Besides, for this test you do not need PowerMock. And when you need it, it is usually a sign that the code under test should be refactored.","body":"Do you have any specific reason to be stuck on Spock 1.x? I recommend Spock 2.x, it has lots of improvements. Besides, for this test you do not need PowerMock. And when you need it, it is usually a sign that the code under test should be refactored."}],"answers":[{"tags":[],"owner":{"account_id":1087271,"reputation":64101,"user_id":1082681,"accept_rate":90,"display_name":"kriegaex"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1695348933,"creation_date":1695347596,"answer_id":77154489,"question_id":77147011,"body_markdown":"Leonard is totally right: In &gt;99% of normal unit tests\r\n  * you do not mock or spy on the class under test,\r\n  * you test behaviour, not inner workings of a class.\r\n\r\nWhat you want is technically possible, but it usually is a code smell, if it is necessary. For argument&#39;s sake, let us assume your class under test looks like this:\r\n\r\n```java\r\nclass A {\r\n  void method(User user) {\r\n    if (&#39;Tom&#39; == user.name)\r\n      method1(user)\r\n    else\r\n      method2(user)\r\n  }\r\n\r\n  void method1(User user) {\r\n    println &quot;method1, doing something expensive &amp; slow with $user.name&quot;\r\n  }\r\n\r\n  void method2(User user) {\r\n    println &quot;method2, doing something expensive &amp; slow with $user.name&quot;\r\n  }\r\n}\r\n```\r\n\r\n```java\r\nclass User {\r\n  String name\r\n}\r\n```\r\n\r\nNow you can test like this:\r\n\r\n```java\r\nimport spock.lang.Specification\r\nimport spock.lang.Unroll\r\n\r\nclass ATest extends Specification {\r\n  @Unroll(&#39;user #user.name&#39;)\r\n  def &#39;expensive calculation (no mocks)&#39;() {\r\n    given:\r\n    def process = new A()\r\n\r\n    expect:\r\n    process.method(user)\r\n\r\n    where:\r\n    user &lt;&lt; [new User(name: &#39;Tom&#39;), new User(name: &#39;Tina&#39;)]\r\n  }\r\n\r\n  @Unroll(&#39;user #user.name&#39;)\r\n  def &#39;expensive calculation (spy)&#39;() {\r\n    given:\r\n    A process = Spy()\r\n\r\n    when:\r\n    process.method(user)\r\n\r\n    then:\r\n    1 * process.&quot;$calledMethod&quot;(user) &gt;&gt; null\r\n\r\n    where:\r\n    user                   | calledMethod\r\n    new User(name: &#39;Tom&#39;)  | &#39;method1&#39;\r\n    new User(name: &#39;Tina&#39;) | &#39;method2&#39;\r\n  }\r\n```\r\n\r\nWhile in the first test, you will see the log output for the called methods, for the second one you will not, because the two methods have been stubbed out. By default, a spy calls the original method, if you do not change its behaviour.\r\n\r\nLeonard also said that you should refactor, if the helper methods do something that is not the core responsibility of the class under test. Let us assume, we have this case here. Then you can refactor and test like this:\r\n\r\n```java\r\nclass B {\r\n  ExpensiveCalculation calculation\r\n\r\n  void method(User user) {\r\n    if (&#39;Tom&#39; == user.name)\r\n      this.calculation.method1(user)\r\n    else\r\n      this.calculation.method2(user)\r\n  }\r\n}\r\n```\r\n\r\n```java\r\nclass ExpensiveCalculation {\r\n  void method1(User user) {\r\n    println &quot;method1, doing something expensive &amp; slow with $user.name&quot;\r\n  }\r\n\r\n  void method2(User user) {\r\n    println &quot;method2, doing something expensive &amp; slow with $user.name&quot;\r\n  }\r\n}\r\n```\r\n\r\n```java\r\n  @Unroll(&#39;user #user.name&#39;)\r\n  def &#39;expensive calculation (factored out, mocked)&#39;() {\r\n    given:\r\n    def calculation = Mock(ExpensiveCalculation)\r\n    def process = new B(calculation: calculation)\r\n\r\n    when:\r\n    process.method(user)\r\n\r\n    then:\r\n    1 * calculation.&quot;$calledMethod&quot;(user)\r\n\r\n    where:\r\n    user                   | calledMethod\r\n    new User(name: &#39;Tom&#39;)  | &#39;method1&#39;\r\n    new User(name: &#39;Tina&#39;) | &#39;method2&#39;\r\n  }\r\n```\r\n\r\nSee how easy it is to inject a mock and verify its behaviour? No more ugly self-spying on the class under test, but clear separation of concerns. But before you use interaction testing (verifying behaviour), think about whether you need it at all. Just because it is possible, it does not mean it is always necessary.\r\n\r\nTry it in the [Groovy Web Console](https://gwc-experiment.appspot.com/?g=groovy_4_0&amp;codez=eNrdVM1r2zAUv_uveGRlkkcwcxgEQlOWjh17SnsaYwj5JRG1JU-Sk5au__sk2bNV4qzQXMZ8MLbf7-N9yTXj92yLUGBmuG6qHxUzFnVmrAuoPepNqQ7Zz_k8_zT_mOdJIqpaaQumVvw-K5ncZusaudgIzqxQciR-J7UqyyThJTMGVrdoLOCDRVkYeMGFpwTgcwunpDGo4Z2_Z5JVSFIXLHADBB9qlEbsETgreVO2XCoVVM7TpISmQQlg60ByER49s9aKo0thCRIPsKJpEkJej9sW1kGyCu1OFdS7d6jDDjW2oJDZ5SV88zJ37oX6BBdAblVF0ikcfRaSkfS74z4n51Ro6sfx4lZRaev6kQ4py9fKsj0mhw89bnLhjEssbgJ-0hLg6gpk4yc51o_j6xfEIgE52jCPJG1mORmHhQYOsBk5u5cbxq3SWIBq7DQsDhanNyemLuHGoenXP7pfhlh6YtWuaSSwiNXePKlIY3xa_8yUnvuTH3q7V6KArjrPhna32raLDdBgB8sl9MNs2wodK-_qC0e3NPgiOOuDYT0is_zYrdZC2lLCpENMoVBCbsEo_8E_DcvzHoz7EcJB2B1c9JlNRoxmrxrN3mrUtzI4eO211Z7uIUP0OoTGFjRem-S8Ybi8TRZv4V-ncwIdj6tPfzTxp_9xmr8BPE9WOg) and click on the &quot;Result&quot; tab to see the test report.","title":"how to use spock to skip some inner void methods","body":"<p>Leonard is totally right: In &gt;99% of normal unit tests</p>\n<ul>\n<li>you do not mock or spy on the class under test,</li>\n<li>you test behaviour, not inner workings of a class.</li>\n</ul>\n<p>What you want is technically possible, but it usually is a code smell, if it is necessary. For argument's sake, let us assume your class under test looks like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>class A {\n  void method(User user) {\n    if ('Tom' == user.name)\n      method1(user)\n    else\n      method2(user)\n  }\n\n  void method1(User user) {\n    println &quot;method1, doing something expensive &amp; slow with $user.name&quot;\n  }\n\n  void method2(User user) {\n    println &quot;method2, doing something expensive &amp; slow with $user.name&quot;\n  }\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>class User {\n  String name\n}\n</code></pre>\n<p>Now you can test like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import spock.lang.Specification\nimport spock.lang.Unroll\n\nclass ATest extends Specification {\n  @Unroll('user #user.name')\n  def 'expensive calculation (no mocks)'() {\n    given:\n    def process = new A()\n\n    expect:\n    process.method(user)\n\n    where:\n    user &lt;&lt; [new User(name: 'Tom'), new User(name: 'Tina')]\n  }\n\n  @Unroll('user #user.name')\n  def 'expensive calculation (spy)'() {\n    given:\n    A process = Spy()\n\n    when:\n    process.method(user)\n\n    then:\n    1 * process.&quot;$calledMethod&quot;(user) &gt;&gt; null\n\n    where:\n    user                   | calledMethod\n    new User(name: 'Tom')  | 'method1'\n    new User(name: 'Tina') | 'method2'\n  }\n</code></pre>\n<p>While in the first test, you will see the log output for the called methods, for the second one you will not, because the two methods have been stubbed out. By default, a spy calls the original method, if you do not change its behaviour.</p>\n<p>Leonard also said that you should refactor, if the helper methods do something that is not the core responsibility of the class under test. Let us assume, we have this case here. Then you can refactor and test like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>class B {\n  ExpensiveCalculation calculation\n\n  void method(User user) {\n    if ('Tom' == user.name)\n      this.calculation.method1(user)\n    else\n      this.calculation.method2(user)\n  }\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>class ExpensiveCalculation {\n  void method1(User user) {\n    println &quot;method1, doing something expensive &amp; slow with $user.name&quot;\n  }\n\n  void method2(User user) {\n    println &quot;method2, doing something expensive &amp; slow with $user.name&quot;\n  }\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>  @Unroll('user #user.name')\n  def 'expensive calculation (factored out, mocked)'() {\n    given:\n    def calculation = Mock(ExpensiveCalculation)\n    def process = new B(calculation: calculation)\n\n    when:\n    process.method(user)\n\n    then:\n    1 * calculation.&quot;$calledMethod&quot;(user)\n\n    where:\n    user                   | calledMethod\n    new User(name: 'Tom')  | 'method1'\n    new User(name: 'Tina') | 'method2'\n  }\n</code></pre>\n<p>See how easy it is to inject a mock and verify its behaviour? No more ugly self-spying on the class under test, but clear separation of concerns. But before you use interaction testing (verifying behaviour), think about whether you need it at all. Just because it is possible, it does not mean it is always necessary.</p>\n<p>Try it in the <a href=\"https://gwc-experiment.appspot.com/?g=groovy_4_0&amp;codez=eNrdVM1r2zAUv_uveGRlkkcwcxgEQlOWjh17SnsaYwj5JRG1JU-Sk5au__sk2bNV4qzQXMZ8MLbf7-N9yTXj92yLUGBmuG6qHxUzFnVmrAuoPepNqQ7Zz_k8_zT_mOdJIqpaaQumVvw-K5ncZusaudgIzqxQciR-J7UqyyThJTMGVrdoLOCDRVkYeMGFpwTgcwunpDGo4Z2_Z5JVSFIXLHADBB9qlEbsETgreVO2XCoVVM7TpISmQQlg60ByER49s9aKo0thCRIPsKJpEkJej9sW1kGyCu1OFdS7d6jDDjW2oJDZ5SV88zJ37oX6BBdAblVF0ikcfRaSkfS74z4n51Ro6sfx4lZRaev6kQ4py9fKsj0mhw89bnLhjEssbgJ-0hLg6gpk4yc51o_j6xfEIgE52jCPJG1mORmHhQYOsBk5u5cbxq3SWIBq7DQsDhanNyemLuHGoenXP7pfhlh6YtWuaSSwiNXePKlIY3xa_8yUnvuTH3q7V6KArjrPhna32raLDdBgB8sl9MNs2wodK-_qC0e3NPgiOOuDYT0is_zYrdZC2lLCpENMoVBCbsEo_8E_DcvzHoz7EcJB2B1c9JlNRoxmrxrN3mrUtzI4eO211Z7uIUP0OoTGFjRem-S8Ybi8TRZv4V-ncwIdj6tPfzTxp_9xmr8BPE9WOg\" rel=\"nofollow noreferrer\">Groovy Web Console</a> and click on the &quot;Result&quot; tab to see the test report.</p>\n"}],"owner":{"account_id":20677272,"reputation":79,"user_id":15181599,"display_name":"wu wei"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":62,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":77154489,"answer_count":1,"score":1,"last_activity_date":1695348933,"creation_date":1695266848,"question_id":77147011,"body_markdown":"code:\r\n\r\n```\r\npublic class A{\r\n    public void method(User user){\r\n        String name = user.getName();\r\n        if(&quot;Tom&quot;.equals(name)){\r\n            method1(user);\r\n        }else{\r\n            method2(user);\r\n        }\r\n    }\r\n}\r\n```\r\nI want to write a test about A#method() by using spock. As you can see,When I test method(),I don&#39;t care the execution of method1() or method2(),I just want to verify that those two methods will invoked in certain case.\r\nMy test code:\r\n```\r\n@RunWith(PowerMockRunner.class)\r\n@PowerMockRunnerDelegate(Sputnik.class)\r\nclass ASpec extends Specification {\r\n   \r\n    def &quot;method&quot;(){\r\n        given:\r\n        def process = new A()\r\n\r\n        expect:\r\n        process.method(input as User)\r\n\r\n        where:\r\n        input                || _\r\n        new User(name:&quot;Tom&quot;) || _\r\n    }\r\n}\r\n```\r\nI find that method1() does executed,but I think that the meaning of a unit test is just to verify the process is right, so I don&#39;t want method1() executed actually,but just invoked.\r\nWhat should I do?\r\n\r\np.s. \r\nI also use spy:\r\n```\r\n@RunWith(PowerMockRunner.class)\r\n@PowerMockRunnerDelegate(Sputnik.class)\r\nclass ASpec extends Specification {\r\n\r\n    def &quot;method&quot;(){\r\n        given:\r\n        A process = Spy()\r\n\r\n        expect:\r\n        process.method(input as User)\r\n\r\n        where:\r\n        input                || _\r\n        new User(name:&quot;Tom&quot;) || _\r\n    }\r\n}\r\n```\r\nbut the method1() also executed.","title":"how to use spock to skip some inner void methods","body":"<p>code:</p>\n<pre><code>public class A{\n    public void method(User user){\n        String name = user.getName();\n        if(&quot;Tom&quot;.equals(name)){\n            method1(user);\n        }else{\n            method2(user);\n        }\n    }\n}\n</code></pre>\n<p>I want to write a test about A#method() by using spock. As you can see,When I test method(),I don't care the execution of method1() or method2(),I just want to verify that those two methods will invoked in certain case.\nMy test code:</p>\n<pre><code>@RunWith(PowerMockRunner.class)\n@PowerMockRunnerDelegate(Sputnik.class)\nclass ASpec extends Specification {\n   \n    def &quot;method&quot;(){\n        given:\n        def process = new A()\n\n        expect:\n        process.method(input as User)\n\n        where:\n        input                || _\n        new User(name:&quot;Tom&quot;) || _\n    }\n}\n</code></pre>\n<p>I find that method1() does executed,but I think that the meaning of a unit test is just to verify the process is right, so I don't want method1() executed actually,but just invoked.\nWhat should I do?</p>\n<p>p.s.\nI also use spy:</p>\n<pre><code>@RunWith(PowerMockRunner.class)\n@PowerMockRunnerDelegate(Sputnik.class)\nclass ASpec extends Specification {\n\n    def &quot;method&quot;(){\n        given:\n        A process = Spy()\n\n        expect:\n        process.method(input as User)\n\n        where:\n        input                || _\n        new User(name:&quot;Tom&quot;) || _\n    }\n}\n</code></pre>\n<p>but the method1() also executed.</p>\n"}],"has_more":true,"quota_max":10000,"quota_remaining":9824,"page":168,"page_size":100}
